<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>DNS | 简约派</title>
    <link>https://jueqingsizhe66.github.io/tags/dns/</link>
      <atom:link href="https://jueqingsizhe66.github.io/tags/dns/index.xml" rel="self" type="application/rss+xml" />
    <description>DNS</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>©2020</copyright><lastBuildDate>Mon, 22 Jun 2015 16:52:20 +0800</lastBuildDate>
    <image>
      <url>https://jueqingsizhe66.github.io/img/icon-192.png</url>
      <title>DNS</title>
      <link>https://jueqingsizhe66.github.io/tags/dns/</link>
    </image>
    
    <item>
      <title>Incompact3d的Makefile及DNS算法</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dde-makefileji-dnssuan-fa/</link>
      <pubDate>Mon, 22 Jun 2015 16:52:20 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dde-makefileji-dnssuan-fa/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://code.google.com/p/incompact3d&#34;&gt;Incompact3d&lt;/a&gt;是一个开源的基于fortran语言编写的DNS求解器，也是我研究生期间使用的开源源代码。
Incompact3d整体框架的介绍可以参考软件的&lt;a href=&#34;https://code.google.com/p/incompact3d/downloads/detail?name=user_guide_incompact3d_V1-1.pdf&amp;amp;can=2&amp;amp;q=&#34;&gt;user-guide&lt;/a&gt;和文献&lt;a href=&#34;http://www.imperial.ac.uk/media/imperial-college/research-centres-and-groups/turbulence-mixing-and-flow-control-group/2009_LAIZET_JCP.pdf&#34;&gt;High-order-compact schemes for incompressible flows: a simple and effcient method with the quasi-spectral accuary&lt;/a&gt;,还可以搜索&lt;a href=&#34;http://www.imperial.ac.uk/tmfc&#34;&gt;sylvain Laziet&lt;/a&gt; 相关的文章 ，只不过他并不是成熟的软件，很多的编译和后处理都可能出现问题，下面是我使用过程遇到的一些问题。
当然主要过程是，通过makefile编译，然后运行incompact3d，最后处理计算结果。&lt;/p&gt;
&lt;p&gt;#1 如何模拟？&lt;/p&gt;
&lt;p&gt;以周期性槽道流动(当然我也就会这么一种，其他都只是走了一小半）为例。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先是得到(不得不说，我也有点忘记)一个完全发展的旋转槽道流动(注意旋转源项的添加) (一般设置20000步可以了，只要收敛即可 大概一天)&lt;/li&gt;
&lt;li&gt;然后是获得完全发展槽道流动(也就是不加上旋转源项)(估计得三万步以上 大概一天)&lt;/li&gt;
&lt;li&gt;最后是获得统计的完全发展槽道流动.因为DNS获得的结果是非定常的，所以你得进行时均处理(当然时均程序得打开时均统计项 umean等)(我统计了20万步，大概花了4天时间。)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;步骤就是这样,大概一个较小的流程需要一周左右。&lt;/p&gt;
&lt;p&gt;Incompact3d比较特殊的是收敛性判定问题，上面的几个过程都需要使用实时&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/05/31/u-plus-y-plus/&#34;&gt;监控小程序&lt;/a&gt;
来观看速度散度和质量流量(质量流量是周期性槽道流动所特有的，所以最好进行实时显示)的收敛情况.另外你可以通过python的一个小脚本
来获得实时显示的图片，这样就能看到程序模拟得怎么样了，具体查看&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/06/11/ji-yu-pythonde-ju-yu-wang-wen-jian-gong-xiang-ruan-jian-simplehttpserverwithupload/&#34;&gt;python局域网上传和下载&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;#2 后处理方法
参考我的&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dru-he-tong-guo-jie-guo-chu-li-chu-ji-xian&#34;&gt;pathline处理方法&lt;/a&gt;
一定要注意(real 8) 否则得到的结果肯定是错误的，这也是困扰我几星期的问题。&lt;/p&gt;
&lt;p&gt;#3 关于Makefile编译&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-makefile&#34; data-lang=&#34;makefile&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#=======================================================================
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Makefile for Imcompact3D
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#=======================================================================
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# Choose pre-processing options
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#   -DSHM	   - enable shared-memory implementation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#   -DDOUBLE_PREC  - use double-precision
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;OPTIONS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -DDOUBLE_PREC

&lt;span style=&#34;color:#75715e&#34;&gt;# Choose an FFT engine, available options are:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#   essl       - IBM Blue Gene ESSL Library
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#   fftw3      - FFTW version 3.x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#   generic    - A general FFT algorithm (no 3rd-party library needed)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#FFT= essl # I ignore
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;FFT &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; generic

&lt;span style=&#34;color:#75715e&#34;&gt;# Paths to FFTW 3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;FFTW3_PATH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;# full path of FFTW installation if using fftw3 engine above&lt;/span&gt;
FFTW3_INCLUDE &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -I&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFTW3_PATH&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;/include
FFTW3_LIB &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -L&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFTW3_PATH&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;/lib -lfftw3 -lfftw3f

&lt;span style=&#34;color:#75715e&#34;&gt;# Paths to ESSL
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;ESSL_PATH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;/bgsys/drivers/ppcfloor/comm/xl
ESSL_INCLUDE &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;
ESSL_LIB &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -L&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;ESSL_PATH&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;/lib -L/opt/ibmmath/lib64 -lesslbg

&lt;span style=&#34;color:#75715e&#34;&gt;# Specify Fortran and C compiler names and flags here
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Normally, use MPI wrappers rather than compilers themselves 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Supply a Fortran pre-processing flag together with optimisation level flags
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Some examples are given below:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#FC =  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#OPTFC = 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CC = 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CFLAGS = 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# PGI
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#FC = ftn
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#OPTFC = -fast -O3 -Mpreprocess
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CC = cc
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CFLAGS = -O3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# PathScale
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#FC = ftn
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#OPTFC = -Ofast -cpp
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CC = cc
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CFLAGS = -O3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# GNU 选用mpif90进行编译
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;FC &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mpif90
OPTFC &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -O0 -g  -fdefault-real-8 -fdefault-double-8 -funroll-loops -ftree-vectorize -fcray-pointer -cpp
CC &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mpicc
CFLAGS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -O0
PLATFORM&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;gnu

&lt;span style=&#34;color:#75715e&#34;&gt;#Blue Gene/Q : EDF R&amp;amp;D
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#PREP=/bgsys/drivers/ppcfloor/comm/xl/bin/
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#FC = $(PREP)mpixlf95_r
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#OPTFC= -O3 -qsuffix=cpp=f90 -qinitauto -qautodbl=dbl4
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;##OPT_LK= -O3 -qinitauto -qautodbl=dbl4
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CFLAGS= -O3 -qinitauto -qautodbl=dbl4
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CC=$(PREP)mpixlc_r
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#PLATFORM=bgq_xlf
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# Cray
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#FC = ftn
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#OPTFC = -e Fm
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CC = cc
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#CFLAGS = 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#-----------------------------------------------------------------------
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Normally no need to change anything below
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# include PATH 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
  INC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;w&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
  INC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFTW3_INCLUDE&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
  INC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;ESSL_INCLUDE&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;# library path
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
   LIBFFT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;w&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
   LIBFFT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFTW3_LIB&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
   LIBFFT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;ESSL_LIB&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;# List of source files
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 注意这边编译的模块，一般是需要的mod生成放在前面首先编译，如果不放前面会报错，解决办法 就是文件名放在前面即可,具体可以查看关于Makefile Fortran
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;SRC &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; decomp_2d.f90 glassman.f90 fft_&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;.f90 module_param.f90 io.f90 variables.f90 poisson.f90 schemes.f90 implicit.f90 convdiff.f90 user_module.f90 incompact3d.f90 navier.f90 derive.f90 parameters.f90 tools.f90 visu.f90

&lt;span style=&#34;color:#75715e&#34;&gt;#-----------------------------------------------------------------------
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Normally no need to change anything below
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;findstring DSHM,&lt;span style=&#34;color:#66d9ef&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;(&lt;/span&gt;OPTIONS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
SRC &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; FreeIPC.f90 &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;SRC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;  
OBJ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;SRC:.f90&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;.o&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; alloc_shm.o FreeIPC_c.o
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;
OBJ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;SRC:.f90&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;.o&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;	

OPTION&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;OPTIONS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
from&lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt;-D
to&lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt;-WF,-D
TMP&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;subst &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;from&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;to&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;OPTIONS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PLATFORM&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;p&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;_&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
   OPTION&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;TMP&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PLATFORM&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;q&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;_&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;)&lt;/span&gt;
   OPTION&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;TMP&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;f&lt;/span&gt;

&lt;span style=&#34;color:#a6e22e&#34;&gt;all&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; incompact3d

&lt;span style=&#34;color:#a6e22e&#34;&gt;alloc_shm.o&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; alloc_shm.c
	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -c $&amp;lt;

&lt;span style=&#34;color:#a6e22e&#34;&gt;FreeIPC_c.o&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; FreeIPC_c.c
	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -c $&amp;lt;

&lt;span style=&#34;color:#a6e22e&#34;&gt;incompact3d &lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;OBJ&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -O0 -g -o $@ &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;OBJ&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;LIBFFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color:#a6e22e&#34;&gt;%.o &lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; %.f90
	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;FC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;OPTFC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;OPTION&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;INC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -c $&amp;lt;

&lt;span style=&#34;color:#a6e22e&#34;&gt;.PHONY&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; clean 
&lt;span style=&#34;color:#a6e22e&#34;&gt;clean&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
	rm -f *~ *.o *.mod incompact3d

&lt;span style=&#34;color:#a6e22e&#34;&gt;.PHONY&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; realclean
&lt;span style=&#34;color:#a6e22e&#34;&gt;realclean&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; clean
	rm -f *~ &lt;span style=&#34;color:#ae81ff&#34;&gt;\#&lt;/span&gt;*&lt;span style=&#34;color:#ae81ff&#34;&gt;\#&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;运行方式:
我的电脑刚好是8线程，就用8线程运行，你也可以选用4或者更多.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;mpirun -np &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;  incompact3d  &amp;gt; tail.out &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#4 The Algorithm of the DNS in Incompact3d&lt;/p&gt;
&lt;p&gt;Incompact3d的执行流程基本上是下面几个(当然得仔细阅读，并反复比对).我写得这段英文大体能够对得上.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;1. Initial the velocity field with noise&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;init subroutine&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
2. Start the iterative process by guessing the pressure field. First we use convdiff subroutine take convection and diffusion of the flow into consideration.And &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt; use pre_correc subroutine to correction the velocity value with the specified boundary condition.
3. Use the values of u,v,and w to get the initialize of the pp3 in the spectral space from subroutine divergence&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;…pp3,1…&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;first sign to turbulent spot&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.Then we use poisson solver decomp_2d_poisson_stag to get the value of the pp3 in the spectral space.
4. Since they were obtained from the guessed values of u,v,w,the values pp3,when substituted into the divergence equation,will not necessarily satisfy that that equation.Hence ,using the gradp subroutine,get the pressure gradients in the physics space,then using corgp subroutine ,get the velocity correction by the pressure gradient in the physics space.Use subroutine divergence&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;…dv3,2…&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; to &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; another monitor &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; turbulent spot&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;second sign to turbulent spot&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; .At the end of the current step, we go to step2 again &lt;span style=&#34;color:#66d9ef&#34;&gt;until&lt;/span&gt; the simulation have been fully developed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Incompact3d如何通过结果处理出迹线</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dru-he-tong-guo-jie-guo-chu-li-chu-ji-xian/</link>
      <pubDate>Mon, 22 Jun 2015 16:20:48 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dru-he-tong-guo-jie-guo-chu-li-chu-ji-xian/</guid>
      <description>&lt;p&gt;Incompact3D获得的数据都是二进制的数据文件，为了获得内部的文件
需要进一步通过编程获得，下面是一个获得pathline的源代码。&lt;/p&gt;
&lt;p&gt;说明：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过 module.f90文件读取 nx ny nz的值&lt;/li&gt;
&lt;li&gt;把下面的源代码编译并放在ux uy uz所在的文件夹当中&lt;/li&gt;
&lt;li&gt;进一步的相关信息，可以参考注释。&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fortran&#34; data-lang=&#34;fortran&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;PROGRAM &lt;/span&gt;b
&lt;span style=&#34;color:#66d9ef&#34;&gt;IMPLICIT &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;NONE
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Integer&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;parameter&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;129&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;84&lt;/span&gt; 
&lt;span style=&#34;color:#66d9ef&#34;&gt;INTEGER&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; I,J,K,COUNT,LN&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;,COL&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;129&lt;/span&gt;,VOL&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;84&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;REAL&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;),&lt;span style=&#34;color:#66d9ef&#34;&gt;DIMENSION&lt;/span&gt;(nx,ny,nz) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ux,uy,uz
&lt;span style=&#34;color:#66d9ef&#34;&gt;CHARACTER&lt;/span&gt;(len&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;)&lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt;NAME1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Incompact3d&amp;#34;&lt;/span&gt;,NAME2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ux&amp;#34;&lt;/span&gt;,NAME3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;uy&amp;#34;&lt;/span&gt;,NAME4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;uz&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;character&lt;/span&gt;(len&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; temp,temp1,temp2,temp3
&lt;span style=&#34;color:#66d9ef&#34;&gt;CHARACTER&lt;/span&gt;(len&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; CFILEux
&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; num

&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(nx)&lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; y1
&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(ny)&lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; y2
&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(nz)&lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; y3

&lt;span style=&#34;color:#75715e&#34;&gt;!generation of the mesh
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
   y1(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.098174770425&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!0.8 is DX ! incompact3d.prm的配置长度除以网格尺度即可。
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo


&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
   y2(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.015503875968992248&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!0.8 is DY
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo


&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
   y3(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.04986655005702381&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!0.8 is DZ
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo


&lt;span style=&#34;color:#75715e&#34;&gt;! 下面只是对于读取文件进行的一个后处理，只是为了方便批处理而已
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(I1)
&lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(I2)
&lt;span style=&#34;color:#66d9ef&#34;&gt;DO &lt;/span&gt;num&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(num .lt. &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(temp,&lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;) num
        temp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;trim(NAME2)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;00&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(temp)
        temp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;trim(NAME3)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;00&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(temp)
        temp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;trim(NAME4)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;00&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(temp)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else 
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(temp,&lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;) num
        temp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;trim(NAME2)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(temp)
        temp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;trim(NAME3)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(temp)
        temp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;trim(NAME4)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(temp)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;
    
&lt;span style=&#34;color:#75715e&#34;&gt;! 产生实际的文件名
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;CFILEux&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;trim(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;./pathchange/&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;trim(temp1)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.dat&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!read the ux 读取ux00*的数据
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;OPEN&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;FILE&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;temp1,FORM&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;UNFORMATTED&amp;#39;&lt;/span&gt;,&amp;amp;
ACCESS&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;DIRECT&amp;#39;&lt;/span&gt;, RECL&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, STATUS&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;OLD&amp;#39;&lt;/span&gt;)

&lt;span style=&#34;color:#75715e&#34;&gt;! read the uy
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;OPEN&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;FILE&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;temp2,FORM&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;UNFORMATTED&amp;#39;&lt;/span&gt;,&amp;amp;
ACCESS&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;DIRECT&amp;#39;&lt;/span&gt;, RECL&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, STATUS&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;OLD&amp;#39;&lt;/span&gt;)
&lt;span style=&#34;color:#75715e&#34;&gt;!read the uz
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;OPEN&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;FILE&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;temp3,FORM&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;UNFORMATTED&amp;#39;&lt;/span&gt;,&amp;amp;
ACCESS&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;DIRECT&amp;#39;&lt;/span&gt;, RECL&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, STATUS&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;OLD&amp;#39;&lt;/span&gt;)

&lt;span style=&#34;color:#75715e&#34;&gt;! 新建一个结果文件，并添加上tecplot的数据头
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;OPEN&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;FILE&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;CFILEux,FORM&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;FORMATTED&amp;#39;&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;WRITE&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;(A6,A12)&amp;#39;&lt;/span&gt;)               &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;TITLE=&amp;#39;&lt;/span&gt;,TRIM(ADJUSTL(NAME1))
 &lt;span style=&#34;color:#66d9ef&#34;&gt;WRITE&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;(A36)&amp;#39;&lt;/span&gt;)    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;VARIABLES=&amp;#34;X&amp;#34;,&amp;#34;Y&amp;#34;,&amp;#34;Z&amp;#34;,&amp;#34;VX&amp;#34;,&amp;#34;VY&amp;#34;,&amp;#34;VZ&amp;#34;&amp;#39;&lt;/span&gt;
      &lt;span style=&#34;color:#66d9ef&#34;&gt;WRITE&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;(A7,I4,A1,A2,I4,A1,A2,I4,A1,A7)&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ZONE I=&amp;#39;&lt;/span&gt;,LN,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;J=&amp;#39;&lt;/span&gt;,COL,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;K=&amp;#39;&lt;/span&gt;,VOL,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;F=POINT&amp;#39;&lt;/span&gt;

COUNT &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;DO &lt;/span&gt;K&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
    &lt;span style=&#34;color:#66d9ef&#34;&gt;DO &lt;/span&gt;J&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
        &lt;span style=&#34;color:#66d9ef&#34;&gt;DO &lt;/span&gt;I&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
            &lt;span style=&#34;color:#66d9ef&#34;&gt;READ&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,REC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;COUNT) ux(I,J,K)
            &lt;span style=&#34;color:#66d9ef&#34;&gt;READ&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;,REC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;COUNT) uy(I,J,K)
            &lt;span style=&#34;color:#66d9ef&#34;&gt;READ&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;,REC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;COUNT) uz(I,J,K)
        &lt;span style=&#34;color:#75715e&#34;&gt;!    WRITE(20,30) I,J,K,ux(I,J,K),uy(I,J,K),uz(I,J,K)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;WRITE&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;) y1(i),y2(j),y3(k),ux(I,J,K),uy(I,J,K),uz(I,J,K)
            &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(I3,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;X,I3,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;X,I3,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;X,E11.&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,E11.&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,E11.&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)
            COUNT &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; COUNT &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
        ENDDO
    ENDDO
ENDDO
ENDDO
&lt;span style=&#34;color:#66d9ef&#34;&gt;CLOSE&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;CLOSE&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;CLOSE&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;CLOSE&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;END &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;PROGRAM &lt;/span&gt;b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>U&#43;-Y&#43;</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/31/u-plus-y-plus/</link>
      <pubDate>Sun, 31 May 2015 09:31:05 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/31/u-plus-y-plus/</guid>
      <description>&lt;p&gt;这个gnuplot脚本是我用于处理Incompact3d产生出来的统计结果(如何统计部分，暂时未写)的画图脚本。&lt;/p&gt;
&lt;h2 id=&#34;数据段&#34;&gt;数据段&lt;/h2&gt;
&lt;p&gt;注意gnuplot处理数据文件按照空行划分index部分。所以下面的部分总共有四个index，调用方式是&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;plot &amp;ldquo;文件名&amp;rdquo; index 0   第一部分文件信息的打印&lt;/li&gt;
&lt;li&gt;plot &amp;ldquo;文件名&amp;rdquo; index 1&lt;/li&gt;
&lt;li&gt;plot &amp;ldquo;文件名&amp;rdquo; index 2&lt;/li&gt;
&lt;li&gt;plot &amp;ldquo;文件名&amp;rdquo; index 3&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;具体看gnuplot脚本部分。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; 2.9684e-24
0.7369 0.73552
1.4746 1.4677
2.2139 2.195
2.9556 2.915
3.7005 3.6242
4.4495 4.3184
5.2034 4.9934
5.9631 5.6455
6.7295 6.2713
7.5034 6.8686
8.2859 7.4358
9.078 7.9722
9.8806 8.4777
10.695 8.9528
11.522 9.3986
12.363 9.8162
13.219 10.207
14.092 10.573
14.983 10.916
15.894 11.236
16.825 11.537
17.779 11.819
18.759 12.084
19.764 12.334
20.799 12.569
21.864 12.791
22.963 13.001
24.099 13.201
25.273 13.391
26.49 13.572
27.753 13.745
29.065 13.911
30.431 14.071
31.855 14.225
33.343 14.374
34.899 14.52
36.529 14.661
38.24 14.8
40.04 14.936
41.936 15.07
43.936 15.202
46.052 15.333
48.292 15.464
50.669 15.594
53.196 15.725
55.887 15.856
58.756 15.989
61.819 16.124
65.096 16.262
68.603 16.402
72.361 16.544
76.389 16.69
80.706 16.838
85.33 16.988
90.276 17.139
95.557 17.288
101.18 17.434
107.14 17.572
113.42 17.7
&lt;span style=&#34;color:#ae81ff&#34;&gt;120&lt;/span&gt; 17.813
126.85 17.906
133.91 17.975
141.11 18.017
148.4 18.03


&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;


&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;


&lt;span style=&#34;color:#ae81ff&#34;&gt;120&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;span style=&#34;color:#ae81ff&#34;&gt;120&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;gnuplot处理部分&#34;&gt;gnuplot处理部分&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-gnuplot&#34; data-lang=&#34;gnuplot&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; ter &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;png&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; out &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;fit1.png&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; xlabel &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Y+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; ylabel &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;U+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; xtics font &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Times-Roman, 15&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;f&lt;/span&gt;(x)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;a&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;x&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;b
&lt;span style=&#34;color:#a6e22e&#34;&gt;g&lt;/span&gt;(x)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(x)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;B
&lt;span style=&#34;color:#66d9ef&#34;&gt;fit&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;] &lt;span style=&#34;color:#a6e22e&#34;&gt;f&lt;/span&gt;(x) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;umfit.dat&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; index &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; via a&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;b
&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;a:=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;a&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;b=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;b
&lt;span style=&#34;color:#66d9ef&#34;&gt;fit&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;148&lt;/span&gt;] &lt;span style=&#34;color:#a6e22e&#34;&gt;g&lt;/span&gt;(x) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;umfit.dat&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; index &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; via k&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;B
&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;k=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;B=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;B
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; xtics &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; samples &lt;span style=&#34;color:#ae81ff&#34;&gt;1280&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; key right bottom box
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; arrow from &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt; to  &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; 
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; label  &lt;span style=&#34;color:#a6e22e&#34;&gt;sprintf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;viscous sub-layer fit:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; f(x)=%g*x +%g&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt; a&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;b)  at &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt; 
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; arrow from &lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt; to  &lt;span style=&#34;color:#ae81ff&#34;&gt;70&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; label &lt;span style=&#34;color:#a6e22e&#34;&gt;sprintf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;logarithm range fit:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; f(x)=1/%g*log(x) +%g&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;B) at &lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt; 
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;o&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;y&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;h&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;o&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;p&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;o&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;n&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;p&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;l&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;h&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;plot&lt;/span&gt;  [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;148&lt;/span&gt;][&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;]  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;umfit.dat&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; index &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; w lp pt &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  t &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;U+--Y+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;f&lt;/span&gt;(x) w l lt &lt;span style=&#34;color:#ae81ff&#34;&gt;-1&lt;/span&gt; lw &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; t &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;linear-fit&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;g&lt;/span&gt;(x)  w  l lt &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; lw &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; t &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;log-fit&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;\
 &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; index &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; w l lt &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; t &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;linear-fit-end&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; index &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; w l lt &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; t &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;log-law-start&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; index &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; w l lt &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; t &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;log-law-end&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;处理结果&#34;&gt;处理结果&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/incompact3d/fit1.png&#34; alt=&#34;处理结果&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;一些实时监测部分&#34;&gt;一些实时监测部分&lt;/h2&gt;
&lt;h3 id=&#34;执行部分&#34;&gt;执行部分：&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;a.sh&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;mpirun -np &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;  incompact3d  &amp;gt;&amp;gt; tail.out &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;获取信息部分&#34;&gt;获取信息部分&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;image.sh&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;more tail.out | grep DIV | grep U* |grep Max|sed &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/final/d&amp;#39;&lt;/span&gt;| awk -F&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;=&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{print $2}&amp;#39;&lt;/span&gt; |sed &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1,3d&amp;#39;&lt;/span&gt;&amp;gt; divu
more tail.out | grep UT | awk  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{print $4}&amp;#39;&lt;/span&gt;|sed &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1,2d&amp;#39;&lt;/span&gt; &amp;gt; flow-rate-correction-factor

&lt;span style=&#34;color:#75715e&#34;&gt;#more tail.out | grep zhao | awk &amp;#39;{print $2,$3,$4}&amp;#39; &amp;gt; stretching&lt;/span&gt;

more tail.out | grep PHI | grep max|awk -F&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;=&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{print $2}&amp;#39;&lt;/span&gt; &amp;gt; PHImax

more tail.out | grep PHI|grep MOYEN | awk  -F&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;:&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{print $2*10^4}&amp;#39;&lt;/span&gt;&amp;gt; PHImoyen
&lt;span style=&#34;color:#75715e&#34;&gt;#gnuplot monitorFLOWRATE.gnu&lt;/span&gt;

bash monitor.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;打印部分&#34;&gt;打印部分&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;monitor.sh&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;
#
&lt;span style=&#34;color:#75715e&#34;&gt;#          FILE:  monitor.sh&lt;/span&gt;
# 
&lt;span style=&#34;color:#75715e&#34;&gt;#         USAGE:  ./monitor.sh&lt;/span&gt; 
# 
&lt;span style=&#34;color:#75715e&#34;&gt;#   DESCRIPTION:&lt;/span&gt;  
# 
&lt;span style=&#34;color:#75715e&#34;&gt;#       OPTIONS:  ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#  REQUIREMENTS:  ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#          BUGS:  ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         NOTES:  ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        AUTHOR:  Ye Zhaoliang (YZL), zhaoturkkey@163.com&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#       COMPANY:  NCEPU&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#       VERSION:  1.0&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#       CREATED:  2014年10月28日 09时42分15秒 CST&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      REVISION:  ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;# set yrange [0:2]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# set xlabel&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# set ylabel&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; mainpoint&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
 &lt;span style=&#34;color:#75715e&#34;&gt;#   echo $0;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    echo $1;&lt;/span&gt;
gnuplot&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;set ter &amp;#39;png&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;set out &amp;#39;$1.png&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;set grid
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;plot &amp;#39;$1&amp;#39; w p pt 2
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; mainline&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
 &lt;span style=&#34;color:#75715e&#34;&gt;#   echo $0;&lt;/span&gt;
 &lt;span style=&#34;color:#75715e&#34;&gt;#   echo $1;&lt;/span&gt;
gnuplot&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;set ter &amp;#39;png&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;set out &amp;#39;$1.png&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;set grid
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;set yrange [0:2]
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;plot &amp;#39;$1&amp;#39; w l lt 2
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;


&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint ux2&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint uy2&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint uz2&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint ux5&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint uy5&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint uz5&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainline uy2&lt;/span&gt;
mainpoint divu
mainpoint flow-rate-correction-factor
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint stretching&lt;/span&gt;
mainpoint PHImax
mainpoint PHImoyen
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint averageux2&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint averageux5&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint rxx2&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint rxx5&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint dudy_bottom_spatial_only&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint dudy_top_spatial_only&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint dudy_bottom_spatial_time&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint dudy_top_spatial_time&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;#new add  stress&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint umean&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint vmean&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint wmean&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;##mainpoint uu&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;##mainpoint vv&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint ww&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint stressu&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint stressv&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint stressw&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint stressuv&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint stressuw&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#mainpoint stressvw&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;整合部分&#34;&gt;整合部分&lt;/h3&gt;
&lt;p&gt;cut -c的目的是获取具体对应的时间步,然后把所有的png相关信息 放到对应时间步文件夹中。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;cd /home/Cedric/diric/src &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; more tail.out |grep Time|awk &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{print $4}&amp;#39;&lt;/span&gt; |tail -1|cut -c 1-6 |awk &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{cmd=&amp;#34;mkdir step&amp;#34;$1;system(cmd);system(&amp;#34;sh image.sh&amp;#34;);cmd2=&amp;#34;mv *.png step&amp;#34;$1;system(cmd2);} &amp;#39;&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;# END{cmd3=&amp;#34;mv dudy* umean stress step&amp;#34;$1;system(cmd3)}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;实时浏览&#34;&gt;实时浏览&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;切换到对应的文件夹
$ python -m SimpleHTTPServer 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后就可以打开 127.0.0.1:8000进行浏览了。&lt;/p&gt;
&lt;h3 id=&#34;you-can-also-use-crontab-to-execute-program-in-real-time&#34;&gt;You can also use crontab to execute program in real time&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;
crontab -e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then you can copy the info below,but modified the datatime.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0 23 19 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 23 19 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 0 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 0 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 1 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 1 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 2 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 2 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 3 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 3 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 4 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 4 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 5 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 5 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 6 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 6 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
0 7 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
30 7 20 6 * sh /home/simulation2_128-117-128Re4200/main.sh 
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>poisson</title>
      <link>https://jueqingsizhe66.github.io/blog/2014/05/14/poisson/</link>
      <pubDate>Wed, 14 May 2014 02:09:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2014/05/14/poisson/</guid>
      <description>&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fortran&#34; data-lang=&#34;fortran&#34;&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;module &lt;/span&gt;decomp_2d_poisson

  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;decomp_2d
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;decomp_2d_fft

  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;param
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;variables

  &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;! Make everything private unless declared public
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!  real(mytype), private, parameter :: PI = 3.14159265358979323846_mytype
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!                                   This 0.0_mytype!!!!!!!!!!!!!1111
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DOUBLE_PREC
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;parameter&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; epsilon &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.e-16&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#else
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;parameter&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; epsilon &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.e-8&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;! boundary conditions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx, bcy, bcz

  &lt;span style=&#34;color:#75715e&#34;&gt;! decomposition object for physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;TYPE&lt;/span&gt;(DECOMP_INFO), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ph
 
  &lt;span style=&#34;color:#75715e&#34;&gt;! decomposition object for spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;TYPE&lt;/span&gt;(DECOMP_INFO), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; sp

  &lt;span style=&#34;color:#75715e&#34;&gt;! store sine/cosine factors
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; az,bz
  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ay,by
  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ax,bx

  &lt;span style=&#34;color:#75715e&#34;&gt;! wave numbers
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; kxyz
  &lt;span style=&#34;color:#75715e&#34;&gt;!wave numbers for stretching in a pentadiagonal matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; a,a2,a3
  &lt;span style=&#34;color:#75715e&#34;&gt;! work arrays,
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! naming convention: cw (complex); rw (real);
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                    1 = X-pencil; 2 = Y-pencil; 3 = Z-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rw1,rw1b,rw2,rw2b,rw3
  &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; cw1,cw1b,cw2,cw22,cw2b,cw2c

  &lt;span style=&#34;color:#75715e&#34;&gt;! underlying FFT library only needs to be initialised once
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;logical&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .false.

  &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; decomp_2d_poisson_stg, decomp_2d_poisson_init, &amp;amp;
       decomp_2d_poisson_finalize

  &lt;span style=&#34;color:#75715e&#34;&gt;! For staggered mesh where main variables are defined in the centre of
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! control volumes while boundary conditions are defined on interfaces
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;interface &lt;/span&gt;decomp_2d_poisson_stg
     &lt;span style=&#34;color:#66d9ef&#34;&gt;module &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;procedure &lt;/span&gt;poisson
  &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;interface
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;contains&lt;/span&gt;



  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Initialise Poisson solver for given boundary conditions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                               given
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                               given
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!   just for init
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_init(bcx1, bcy1, bcz1)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx1, bcy1, bcz1
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx, ny, nz, i

    bcx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bcx1
    bcy &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bcy1
    bcz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bcz1

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global
    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#75715e&#34;&gt;! pressure-grid having 1 fewer point for non-periodic directions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) nx&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) ny&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) nz&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(ax(nx),bx(nx))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(ay(ny),by(ny))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(az(nz),bz(nz))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;abxyz(ax,ay,az,bx,by,bz,nx,ny,nz,bcx,bcy,bcz)
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Initialise the ax bx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Initialise the ay by
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Initialise the az bz
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_init(nx, ny, nz, ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_init(nx, ny, nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, sp)

    &lt;span style=&#34;color:#75715e&#34;&gt;! allocate work space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#75715e&#34;&gt;! (000)  ^c  ^kxyz ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1b(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1b(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#75715e&#34;&gt;!(100)      consist :: cw1 cw1b   rw1   rw1b   rw2    ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2b(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw22(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2b(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2c(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#75715e&#34;&gt;!(010)  rw2 rw2b cw2 cw22 cw2b cw2c kxyz  ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1b(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw22(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2b(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2c(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1b(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2b(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
        &lt;span style=&#34;color:#75715e&#34;&gt;!(11*) cw1 cw1b cw2 cw2b  cw2c  rw1 rw1b rw2b
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then  
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw3(ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))    
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),nym,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))      
       &lt;span style=&#34;color:#75715e&#34;&gt;!(111) rw3  kxyz  ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;waves()

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_init


  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Release memory used by Poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_finalize

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(ax,bx,ay,by,az,bz)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_finalize(ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_finalize(sp)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_finalize
    fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .false.

    &lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(kxyz)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (000) cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1,cw1b,rw1,rw1b,rw2)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (100)   cw1 cw1b rw1 rw1b rw2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1,cw2,cw2b,rw2,rw2b)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (010)   cw1 cw2  cw2b  rw2 rw2b
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1,cw1b,cw2,cw2b,rw1,rw1b,rw2,rw2b)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (11*)   cw1,cw1b,cw2,cw2b,rw1,rw1b,rw2,rw2b
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(rw3)
        &lt;span style=&#34;color:#75715e&#34;&gt;!(111)    rw3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_finalize


  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Top level wrapper
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson(rhs, bcx, bcy, bcz)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx, bcy, bcz  &lt;span style=&#34;color:#75715e&#34;&gt;! boundary conditions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_000(rhs)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_100(rhs)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_010(rhs)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;! 110 &amp;amp; 111
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_11x(rhs, bcz)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;stop&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;boundary condition not supported&amp;#39;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson


  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Solving 3D Poisson equation with periodic B.C in all 3 dimensions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                                                      3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                                                      3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_000(rhs)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;derivX
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;derivY
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;derivZ

    &lt;span style=&#34;color:#75715e&#34;&gt;! right-hand-side of Poisson as input
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! solution of Poisson as output
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; fft_start, fft_end, fft_size

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ytt,xtt,ztt,yt1,xt1,yt2,xt2
    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xtt1,ytt1,ztt1,zt1,zt2


    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2,x ,y, z
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global
    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform   r2c:real to complex by zhaoliang
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! cw1 is 3dim data structrue
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!! only fft to transform the real data to complex data while (100) twice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!! one is tranform and then fft  (you can see poisson100
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)
    

    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!  why this below is called normalisation ??????  just divide 3dim grid number
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

             &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!post-processing in 3-direction can be
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!! set in the same cycle,because they are
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!! similar
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)   &lt;span style=&#34;color:#75715e&#34;&gt;!  get the real number of cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))               &lt;span style=&#34;color:#75715e&#34;&gt;!  get the imagenumber of cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)   &lt;span style=&#34;color:#75715e&#34;&gt;! modify the cw1 in the spectral space Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                                    &lt;span style=&#34;color:#75715e&#34;&gt;!  bz  az
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                                    &lt;span style=&#34;color:#75715e&#34;&gt;!  by  ay
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                                    &lt;span style=&#34;color:#75715e&#34;&gt;!  bx  ax
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)   &lt;span style=&#34;color:#75715e&#34;&gt;! why should be axisymmetry!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)

             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;! CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!  Yes ! division  by zero is impossible!!!-----------------------------------&amp;lt;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((tmp1.lt.epsilon).or.(tmp2.lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;!epsilon?  what does it mean?
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!                print *,&amp;#39;DIV 0&amp;#39;,i,j,k,epsilon
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw1(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

           &lt;span style=&#34;color:#75715e&#34;&gt;!Print result in spectal space after Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!     if (abs(out(i,j,k)) &amp;gt; 1.0e-4) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!        write(*,*) &amp;#39;AFTER&amp;#39;,i,j,k,out(i,j,k),xyzk
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!     end if
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;

             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
              &lt;span style=&#34;color:#75715e&#34;&gt;!                                          bz    az
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;              &lt;span style=&#34;color:#75715e&#34;&gt;!                                          by    ay
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;              &lt;span style=&#34;color:#75715e&#34;&gt;!                                          bx    ax
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)

             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)

          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
             
    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)    &lt;span style=&#34;color:#75715e&#34;&gt;!  from complex  to real!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
 &lt;span style=&#34;color:#75715e&#34;&gt;!   call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_000


  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_100(rhs)
      &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!!!! get the rhs and then modify rhs ,at last return the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2, tmp3, tmp4
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xx1,xx2,xx3,xx4,xx5,xx6,xx7,xx8
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k, itmp
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!  8 transform   from x --&amp;gt;y --&amp;gt;z then z--&amp;gt; y ---&amp;gt;x at the beginning
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!from x --&amp;gt;y --&amp;gt;z then z--&amp;gt; y ---&amp;gt;x at the endding
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!  (100 add 8 more transform than 000) while 000 is 0 transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!  so rhs is in the z pencil ,no there are not z pencil at all!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!   the program is  2-dim pm*pn decomp !  so only  xpencil and y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice real to complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transform rhs-rw2-rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rhs-----rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice complex to real
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transfrom rw1-rw2--rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rw1------rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!! post-processing operations is under the complex condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   input real rhs(:.:,:) in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT forward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   3 post-processing   z--&amp;gt;y---&amp;gt;x  direction not pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   3 post-processing backward  x---&amp;gt;y----&amp;gt;z  direction
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   output real rhs(:,:,:)  in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,a8,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;I4,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;F12.&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;)

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global
    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil(wrong!There isn&amp;#39;t Z pencil)(wrong
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!again, there is Z pencil))but requires global operations in X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! why should do the transpose!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;! why in the poisson_000 is not needed!???????????????
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!   two steps to change from z to x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)  &lt;span style=&#34;color:#75715e&#34;&gt;! z pencil in y pencil but in the physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!rw2 is the complex 3-dim data the same as rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2,rw1,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
              &lt;span style=&#34;color:#75715e&#34;&gt;!!! rw1  rw1b   1 means  x pencil   
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;              &lt;span style=&#34;color:#75715e&#34;&gt;!!! rw2  rw2b   2 means  y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)  &lt;span style=&#34;color:#75715e&#34;&gt;! the odd terms  is for the half before
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k)  &lt;span style=&#34;color:#75715e&#34;&gt;! the reverse terms is for the half after
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!3 layers data
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!! rw1b is the top lay data  xpencil     physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!! rw2  is in the middle lay data   y pencil   physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!! rw1 rhs  is in the outer lay data    z pencil  spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)    &lt;span style=&#34;color:#75715e&#34;&gt;! let x pencil rw1b to y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)     &lt;span style=&#34;color:#75715e&#34;&gt;! let y pencil rw2 to  z pencil&amp;#39;s rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!first time get what we want
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z,nx,ny,nz)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!           why should force the before pre-posting   ------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!the most key operation :::: the fft operator: decomp_2d_fft_3d
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)  &lt;span style=&#34;color:#75715e&#34;&gt;!  from real to complex!  and begin poission solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! in the z pencil we did the fft transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!! so cw1 is 3d complex data ,yeah (:,:,:)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;


    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;START&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after z&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!because (100)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!so the post processing in x is different
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!from the  y and z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#75715e&#34;&gt;!!! the 2~nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!     2~nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw1b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)  
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!  While  you set the -Debug in the compile period
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after x&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!from now on, the cw1b in x,y,z direction(not pencil)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!is calculated ,so now you can calculate cw1b in the
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!! poisson condition ,yes poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp1=real(zk2(k)+yk2(j)+xk2(i), kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp2=aimag(zk2(k)+yk2(j)+xk2(i))
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;!xyzk=cmplx(tmp1,tmp2, kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;! CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;! yes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!the most dayly processing
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!  You know cw1b is the cw1&amp;#39;s another form in the spectral
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!! space ,so you need to change the spetral space to physical
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!! space again ,yes get the cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!! from now on ,you will found that the calculate of poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!! equation is in the spectral space ,from the fft,then 3 post
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!! processing in x,y,z 3 directions, then calculate the  poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!! equation. OK,then you start next!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)        
              &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!the buterfly algorithm!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!from now on x direction ,the spectral data has been transform to
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!! physical space, but still the complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER X&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER Y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

                                    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!! by  ay
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!! bz  az
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;END&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)

    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil but requires global operations in X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2,rw1,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(i,j,k)   &lt;span style=&#34;color:#75715e&#34;&gt;! the odd terms is setted!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)  &lt;span style=&#34;color:#75715e&#34;&gt;! the even terms is setted
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)
&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!the finally outcome rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
  &lt;span style=&#34;color:#75715e&#34;&gt;!  call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_100

  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Neumann!!!!!!!!!!!!!!!!!!!!!!!!!!!111
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; 
  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Solving 3D Poisson equation: Neumann in Y; periodic in X &amp;amp; Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_010(rhs)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2, tmp3, tmp4
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xx1,xx2,xx3,xx4,xx5,xx6,xx7,xx8

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k

&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,a8,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;I4,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;F12.&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;)

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! (010)  so have fewer1 ny!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!so if (11*)  you need to ?what pencil??????
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!??
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil but requires global operations in Y  because(010)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice real to complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transform rhs-rw2-rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rhs-----rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice complex to real
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transfrom rw1-rw2--rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rw1------rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!! post-processing operations is under the complex condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   input real rhs(:.:,:) in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1+1 transform  z-&amp;gt;y y-&amp;gt;z  |destination: modify the rhs  because z-y=1  rather than z-x=2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT forward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2 post-processing   z--&amp;gt;x  direction not pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transform z-y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing   y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 matrice_refinement
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   3 inversion5_v1  inversion5_v2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing backward  Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transform y-z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2 post-processing backward  x----&amp;gt;z  direction
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1+1 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   output real rhs(:,:,:)  in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!so the key factor  a  a2  a3    ax bx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ay by
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! az bz
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2b,rhs,ph)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z,nx,ny,nz)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;START&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after z&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after x&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! NEED TO BE IN Y PENCILS!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!sp!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1,cw2,sp)

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!sp!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny      
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw2b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw2b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after y&amp;#39;&lt;/span&gt;,i,j,k,cw2b(i,j,k)
                &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,kxyz(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! doing wave number division in Y-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp1=real(zk2(k)+yk2(j)+xk2(i), kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp2=aimag(zk2(k)+yk2(j)+xk2(i))
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;!xyzk=cmplx(tmp1,tmp2, kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, &amp;amp;
                     aimag(cw2b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw2b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
       
        &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;matrice_refinement()
        &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       do k = sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do j = 1,ny/2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             do i = sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!                print *,i,j,k,a(i,j,k,3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!                if (nrank.le.1) print *,i,j,k,a(i,j,k,3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!                if (nrank.gt.1) print *,i+4,j,k,a(i,j,k,3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;     


&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!istret  !=3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;;cw2c(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
             cw2c(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)
          enddo
          enddo
          enddo

 &lt;span style=&#34;color:#75715e&#34;&gt;!   do k = sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!      do j = 1,ny/2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!         do i = sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!            if (abs(cw2(i,j,k)) &amp;gt; 1.0e-4) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!               write(*,*) &amp;#39;before IN&amp;#39;,i,j,k,cw2(i,j,k)!*2.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!!            end if
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!        end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!     end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!  end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          
  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!for the strech  grid!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a,cw2,sp)
         &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a2,cw2c,sp)

&lt;span style=&#34;color:#75715e&#34;&gt;!         cw2(1,1,1)=cw2(1,1,1)*0.5
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         
 
&lt;span style=&#34;color:#75715e&#34;&gt;!   do k = sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       do j = 1,ny/2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do i = sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             if (abs(cw2c(i,j,k)) &amp;gt; 1.0e-4) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!                write(*,*) &amp;#39;after IN&amp;#39;,i,j,k,cw2c(i,j,k)!*2.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             end if
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!    end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
          cw2b(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,(j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2c(i,j&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          enddo
          &lt;span style=&#34;color:#75715e&#34;&gt;!do k=sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!do i=sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   if ((xkx(i)==0).and.(zkz(k)==0)) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   !   cw2b(i,1,1)=0.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   !   cw2b(i,ny,1)=0.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,j,k)
          enddo
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v2(a3,cw2,sp)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,j,k)
          enddo
          enddo
          enddo
       endif

    endif

&lt;span style=&#34;color:#75715e&#34;&gt;!    print *,nrank, sp%yst(3),sp%yen(3),sp%yst(1),sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!we are in Y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)  
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((i&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).and.(k&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2b(i,:,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
       endif
    enddo
    enddo
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw2b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER&amp;#39;&lt;/span&gt;,i,j,k,cw2b(i,j,k)
                &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,kxyz(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2b(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2b(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             cw2(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
           
    &lt;span style=&#34;color:#75715e&#34;&gt;! Back to X-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2,cw1,sp)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER Y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER X&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;END&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform, back to physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)

    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil but requires global operations in Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,j,k)
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2b,rhs,ph)

  &lt;span style=&#34;color:#75715e&#34;&gt;!  call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_010

  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!Neumann!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!11x!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!Neumann Neumann Neumann!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!Neumann Neumann periodic!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Solving 3D Poisson equation: Neumann in X, Y; Neumann/periodic in Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_11x(rhs, nclz1)




                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice real to complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transform rhs-rw2-rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rhs-----rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice complex to real
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transfrom rw1-rw2--rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rw1------rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!! post-processing operations is under the complex condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   input real rhs(:.:,:) in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    z--y  y-&amp;gt;x   x-y y-z|destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT forward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing  z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  x--y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing  y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  y--x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing  x (because  he thinks he is in X pencil, Zhaoliang said no)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 matrice_refinemento
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpse   x--y  (for strecting  because strecthing is in the y direction)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 inversion5_v1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  y---x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  x-y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  y-x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   output real rhs(:,:,:)  in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;


    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nclz1    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2, tmp3, tmp4
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xx1,xx2,xx3,xx4,xx5,xx6,xx7,xx8

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k

&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,a8,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;I4,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;F12.&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;)

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;! becasuse (110)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!the free-slip boundary condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then  
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
                rw3(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
                rw3(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rw3,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then     
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! the global operations in X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2b,rw1,ph)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! back to Z-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z,nx,ny,nz)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)



    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;START&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after z&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;


    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!while  1  should be in the corresponding pencils
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!characteristic 2 : there sholud be tmp1*2*3*4
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! WE HAVE TO BE IN Y PENCILS
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;


    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!No  we should be the z pencil!  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!there is something wrong in the source code!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!But now we are in the z pencil not in
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  the x pencil!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!so,it should be
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!call transpose_z_to_y rather than transpose_x_to_y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1,cw2,sp)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw2b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)  
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! back to X-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!the same wrong ,now you should
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!go back to the z pencil rather than the x pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2b,cw1,sp)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw1b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)  
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;BEFORE&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp1=real(zk2(k)+yk2(j)+xk2(i), kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp2=aimag(zk2(k)+yk2(j)+xk2(i))
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;!xyzk=cmplx(tmp1,tmp2, kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;matrice_refinement()
       &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11so       we  should  z-&amp;gt;y pencil but not  x-&amp;gt;ypencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;! the stretching is only working in Y pencils
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!why the default the pencil is  x pencil rather than z pencil!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1b,cw2b,sp)
       &lt;span style=&#34;color:#75715e&#34;&gt;!we are now in Y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       
       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;;cw2c(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
             cw2c(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)
          enddo
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a,cw2,sp)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a2,cw2c,sp)

          cw2b(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,(j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2c(i,j&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          enddo
       &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,j,k)
          enddo
          enddo
          enddo

          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v2(a3,cw2,sp)

          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,j,k)
          enddo
          enddo
          enddo
       endif
&lt;span style=&#34;color:#75715e&#34;&gt;!we have to go back in X pencils
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2b,cw1b,sp)
    endif

&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-6&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!stop
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)        
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER X&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! NEED to be in Y-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1,cw2,sp)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             cw2b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)        
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw2b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER Y&amp;#39;&lt;/span&gt;,i,j,k,cw2b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! back to X-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2b,cw1,sp)
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;END&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform, back to physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
                rw3(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
                rw3(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,nz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rw3,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)   
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2b,rw1,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(i,j,k)
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)

  &lt;span style=&#34;color:#75715e&#34;&gt;!  call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
   

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_11x


 
  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;abxyz(ax,ay,az,bx,by,bz,nx,ny,nz,bcx,bcy,bcz)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;param

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx,bcy,bcz
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(OUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ax,bx
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(OUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ay,by
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(OUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; az,bz

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i,j,k

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!! generate the x direction coeficiency!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          ax(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bx(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!one and a half of PI
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          ax(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bx(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          ay(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          by(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          ay(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          by(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
          az(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bz(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
          az(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bz(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;abxyz

&lt;span style=&#34;color:#75715e&#34;&gt;! ***********************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;waves ()
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!***********************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivX
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivY
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivZ
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;param
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;decomp_2d
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;variables
&lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;decomp_2d_fft

&lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i,j,k
&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; w,wp,w1,w1p
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ytt,xtt,ztt,yt1,xt1,yt2,xt2
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xtt1,ytt1,ztt1,zt1,zt2,tmp1,tmp2,tmp3
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp4,tmp5,tmp6

xkx(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; xk2(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; yky(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; yk2(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
zkz(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; zk2(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!WAVE NUMBER IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nx
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;acix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bcix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      xkx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      exs(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
      xkx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xkx(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      exs(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;exs(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xk2(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nxm
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;acix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bcix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      xkx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      exs(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   xkx(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   exs(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   xk2(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
endif

&lt;span style=&#34;color:#75715e&#34;&gt;!WAVE NUMBER IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ncly&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;ny
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp,ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      eys(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
      yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yky(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      eys(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;eys(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yk2(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nym
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp,nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      eys(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   eys(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   yk2(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
endif

&lt;span style=&#34;color:#75715e&#34;&gt;!WAVE NUMBER IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nz
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      zkz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ezs(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nzm
      w1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(nzm&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nzm
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      w1p&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w1&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1)
      w1p&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;w1p&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w1))     
      zkz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1p&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ezs(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1p&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
endif
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!if (nrank==0) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   do i=1,nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!      print *,i,ezs(i)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!stop
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((nclx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;).and.(nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;).and.((ncly&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).or.(ncly&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   yt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   zt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   xyzk&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;yt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;zt2
   kxyz(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xyzk
&lt;span style=&#34;color:#75715e&#34;&gt;!   print *,i,j,k, kxyz(i,j,k)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo
enddo
enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
         xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         xt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
         yt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
         zt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
         xyzk&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;yt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;zt2
         kxyz(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xyzk
&lt;span style=&#34;color:#75715e&#34;&gt;!   print *,i,j,k, kxyz(i,j,k)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      enddo
      enddo
      enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)  
         xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         
         tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
              aimag(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;aimag(zt1), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
              &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
              &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         
         tmp4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp2, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(aimag(tmp1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(tmp2))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp3, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(aimag(tmp1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(tmp3))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp3, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp2, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(aimag(tmp3)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(tmp2))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         
         tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp4, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),aimag(tmp4)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(xk2(i)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp5, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yk2(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),aimag(tmp5)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(yk2(j)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp6, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),aimag(tmp6)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(zk2(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)

         xyzk&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp3
         kxyz(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xyzk
&lt;span style=&#34;color:#75715e&#34;&gt;!         print *,i,j,k,zt1,yt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      enddo
      enddo
      enddo
   endif
endif


&lt;span style=&#34;color:#75715e&#34;&gt;!          do k=1,1!nz
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do j=1,ny
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do i=1,1!!nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             print *,j,a(i,j,k,3),kxyz(i,j,k)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;waves

&lt;span style=&#34;color:#75715e&#34;&gt;!**************************************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;matrice_refinement()
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!**************************************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;decomp_2d
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;variables
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;param
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;var
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;MPI
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivX
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivY
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivZ

&lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i,j,k

&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype),&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; transx
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype),&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; transy
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype),&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; transz
&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xa0,xa1
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ytt,xtt,ztt,yt1,xt1,yt2,xt2
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xtt1,ytt1,ztt1,zt1,zt2,tmp1,tmp2,tmp3

&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   transx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(xtt+xtt)/xt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   transy(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(ytt+ytt)/yt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
           (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      transz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;aimag(zt1), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(ztt+ztt)/zt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
           (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      transz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;aimag(zt1), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(ztt+ztt)/zt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   enddo
endif

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).or.(istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt; 
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;alpha&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
   &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) xa1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
   &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) xa1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!construction of the pentadiagonal matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      cw22(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   enddo


   

&lt;span style=&#34;color:#75715e&#34;&gt;!main diagonal
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   
 

 

&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
      a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))),&amp;amp;
           (xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           (xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo



&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;,aimag(a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   a(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo



&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
        xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
        (xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)  
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!not to have a singular matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;).and.(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;         &lt;/span&gt;a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
         a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
      endif
   enddo
   enddo

&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;alpha&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
   xa1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!construction of the pentadiagonal matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nym
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      cw22(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yky(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(yky(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   enddo

&lt;span style=&#34;color:#75715e&#34;&gt;!main diagonal
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   enddo

   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a3(i,nym,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,nym,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,nym,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,nym,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo

   


&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))),&amp;amp;
        (xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   &lt;span style=&#34;color:#75715e&#34;&gt;!a3(i,1,k,5)=a3(i,1,k,5)*2.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;!a3(i,1,k,5)=0.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   a3(i,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a3(i,nym,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo


&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nym
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,nym
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo

&lt;span style=&#34;color:#75715e&#34;&gt;!not to have a singular matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   do k=sp%yst(3),sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   do i=sp%yst(1),sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!      if ((xkx(i)==0.).and.(zkz(k)==0)) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nrank&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;a3(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   a3(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a3(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
endif
&lt;span style=&#34;color:#75715e&#34;&gt;!      endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;endif


   


&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;matrice_refinement

&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;module &lt;/span&gt;decomp_2d_poisson
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
  </channel>
</rss>
