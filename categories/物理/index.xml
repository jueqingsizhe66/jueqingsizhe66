<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>物理 | 简约派</title>
    <link>https://jueqingsizhe66.github.io/categories/%E7%89%A9%E7%90%86/</link>
      <atom:link href="https://jueqingsizhe66.github.io/categories/%E7%89%A9%E7%90%86/index.xml" rel="self" type="application/rss+xml" />
    <description>物理</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>©2020</copyright><lastBuildDate>Thu, 29 Sep 2016 03:27:34 +0800</lastBuildDate>
    <image>
      <url>https://jueqingsizhe66.github.io/img/icon-192.png</url>
      <title>物理</title>
      <link>https://jueqingsizhe66.github.io/categories/%E7%89%A9%E7%90%86/</link>
    </image>
    
    <item>
      <title>Physics and Maths</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/09/29/physics-and-maths/</link>
      <pubDate>Thu, 29 Sep 2016 03:27:34 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/09/29/physics-and-maths/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://baike.baidu.com/link?url=EAjClF31Nh45czy0-8dYscX-hkcI8qOxCzsmWWiXN6yDdhQh18-Avf_UAiwFBNk9F3vKh0dKTSBzitXzqYgmvn6w5e9hwmZ5_yvYP7g9ARnJbDG8vH9jEkSDwL7y8rIK&#34;&gt;濮祖荫&lt;/a&gt;(歌手朴树的父亲):&amp;ldquo;数学背后有物理，物理需要通过数学来表达&amp;rdquo;。数学方程(表达式)需要你通过物理直觉去思考，去书写。&lt;/p&gt;
&lt;p&gt;濮说做研究的过程都是提出一个模型，找到问题的本质，针对围绕本质的几个变量进行研究，来近似替代现实的复杂模型（这个简化的思想对我有帮助）&lt;/p&gt;
&lt;p&gt;Only some links for physics and maths,&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://product.dangdang.com/22704132.html&#34;&gt;数学物理方程 张鲁明&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://zhidao.baidu.com/share/ffccde3e883cc1bfe96567f02492e004.html%E3%80%80&#34;&gt;数学物理方程 复旦&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://vdisk.weibo.com/s/uGXsmIpCxv5Ow&#34;&gt;数学物理 微盘丛书&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://wenku.baidu.com/link?url=zGOuK59qswS4oDW1W9aqndBgisaitwkHxeix_5_O7Elp3rBH3pidQd1V8KEubrCXeuE8p0Aw_P-FbfOK2stL3uraiUOoZiUCIcBHKUpLeHq&#34;&gt;空间物理&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://v.youku.com/v_show/id_XNzYwMDgyNjg=.html?spm=a2h0j.8191423.module_basic_relation.5~5!2~5~5!8~5!2~1~3~A&#34;&gt;梁灿彬老师的微分流形和相对论&lt;/a&gt;, &amp;ldquo;以不变应万变，找出不变量(心领神会学科技术的不变量)，从而应问题领域中变化的东西,抓住不变的东西，反复琢磨(为什么还要反复琢磨)&amp;quot;. &amp;ldquo;相似矩阵的trace迹不变(矩阵对角元不变)&amp;rdquo;
也就是需要通过不变的东西把所有变化的独立体（关系）都连接起来，形成一条链。&lt;/p&gt;
&lt;p&gt;学任何东西，都得首先明确他的重点和意义（当然首先得基于你得有大局观，大的方向，大的框架 也就是不变的东西）。&lt;/p&gt;
&lt;p&gt;从数学物理过程去解释现实中的现象，从大的误差逐步缩小他，直到能够清楚的解释现实中的现象，从理论上去解释实际的问题，也就是梁灿彬老师说的
天地连通(天:定义特别清楚地(并矢:张量积运算, ) 地:实际(现实)发生的现象,不清晰的，定义不明(并矢:两个矢量并排在一起,他是一个二阶张量,9个分量v1u1 v1u2 v1u3 v2u1 v2u2 v2u3 v3u1 v3u2 v3u3 列举出来)。 也就是说不清晰的版本肯定能够存在清晰的版本)。&lt;/p&gt;
&lt;p&gt;更要紧的是，还得考虑&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/09/28/jump-out-of-ontology/&#34;&gt;物理之内和物理之外&lt;/a&gt;的问题&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Tecplot的云图</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/27/tecplotde-yun-tu/</link>
      <pubDate>Wed, 27 May 2015 15:55:21 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/27/tecplotde-yun-tu/</guid>
      <description>&lt;p&gt;Tecplot 是工程绘图的神器。 下面是一种格式，导入tecplot即可。
前面三列是x y z后面分别是ux ，udx，一定要写好文件头。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;TITLE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;      qvalue 
VARIABLES&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Y&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Z&amp;#34;&lt;/span&gt;,  ux,udx 
ZONE I&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  1000,J&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 10,K&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 20,F&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;POINT 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4160     0.0009 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4160     0.0036 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4161     0.0081 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4162     0.0144 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4164     0.0225 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4166     0.0324 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4170     0.0441 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4175     0.0576 
    &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4182     0.0729 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4190     0.0900 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4200     0.1089 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4212     0.1296 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4226     0.1521 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4242     0.1764 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4261     0.2025 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4283     0.2304 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;17&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4307     0.2601 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;18&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4335     0.2916 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4366     0.3249 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4400     0.3600 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4438     0.3969 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4479     0.4356 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4525     0.4761 
   &lt;span style=&#34;color:#ae81ff&#34;&gt;24&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;     0.4575     0.5184 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>poisson</title>
      <link>https://jueqingsizhe66.github.io/blog/2014/05/14/poisson/</link>
      <pubDate>Wed, 14 May 2014 02:09:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2014/05/14/poisson/</guid>
      <description>&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fortran&#34; data-lang=&#34;fortran&#34;&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;module &lt;/span&gt;decomp_2d_poisson

  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;decomp_2d
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;decomp_2d_fft

  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;param
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;variables

  &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;! Make everything private unless declared public
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!  real(mytype), private, parameter :: PI = 3.14159265358979323846_mytype
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!                                   This 0.0_mytype!!!!!!!!!!!!!1111
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DOUBLE_PREC
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;parameter&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; epsilon &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.e-16&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#else
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;parameter&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; epsilon &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.e-8&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;! boundary conditions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx, bcy, bcz

  &lt;span style=&#34;color:#75715e&#34;&gt;! decomposition object for physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;TYPE&lt;/span&gt;(DECOMP_INFO), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ph
 
  &lt;span style=&#34;color:#75715e&#34;&gt;! decomposition object for spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;TYPE&lt;/span&gt;(DECOMP_INFO), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; sp

  &lt;span style=&#34;color:#75715e&#34;&gt;! store sine/cosine factors
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; az,bz
  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ay,by
  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ax,bx

  &lt;span style=&#34;color:#75715e&#34;&gt;! wave numbers
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; kxyz
  &lt;span style=&#34;color:#75715e&#34;&gt;!wave numbers for stretching in a pentadiagonal matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; a,a2,a3
  &lt;span style=&#34;color:#75715e&#34;&gt;! work arrays,
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! naming convention: cw (complex); rw (real);
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                    1 = X-pencil; 2 = Y-pencil; 3 = Z-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rw1,rw1b,rw2,rw2b,rw3
  &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;allocatable&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; cw1,cw1b,cw2,cw22,cw2b,cw2c

  &lt;span style=&#34;color:#75715e&#34;&gt;! underlying FFT library only needs to be initialised once
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;logical&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;save&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .false.

  &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; decomp_2d_poisson_stg, decomp_2d_poisson_init, &amp;amp;
       decomp_2d_poisson_finalize

  &lt;span style=&#34;color:#75715e&#34;&gt;! For staggered mesh where main variables are defined in the centre of
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! control volumes while boundary conditions are defined on interfaces
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;interface &lt;/span&gt;decomp_2d_poisson_stg
     &lt;span style=&#34;color:#66d9ef&#34;&gt;module &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;procedure &lt;/span&gt;poisson
  &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;interface
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;contains&lt;/span&gt;



  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Initialise Poisson solver for given boundary conditions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                               given
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                               given
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!   just for init
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_init(bcx1, bcy1, bcz1)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx1, bcy1, bcz1
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx, ny, nz, i

    bcx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bcx1
    bcy &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bcy1
    bcz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bcz1

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global
    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#75715e&#34;&gt;! pressure-grid having 1 fewer point for non-periodic directions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) nx&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) ny&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) nz&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(ax(nx),bx(nx))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(ay(ny),by(ny))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(az(nz),bz(nz))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;abxyz(ax,ay,az,bx,by,bz,nx,ny,nz,bcx,bcy,bcz)
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Initialise the ax bx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Initialise the ay by
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Initialise the az bz
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_init(nx, ny, nz, ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_init(nx, ny, nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, sp)

    &lt;span style=&#34;color:#75715e&#34;&gt;! allocate work space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#75715e&#34;&gt;! (000)  ^c  ^kxyz ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1b(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1b(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#75715e&#34;&gt;!(100)      consist :: cw1 cw1b   rw1   rw1b   rw2    ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2b(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw22(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2b(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2c(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#75715e&#34;&gt;!(010)  rw2 rw2b cw2 cw22 cw2b cw2c kxyz  ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw1b(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw22(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2b(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(cw2c(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
                 sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw1b(ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw2b(ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
        &lt;span style=&#34;color:#75715e&#34;&gt;!(11*) cw1 cw1b cw2 cw2b  cw2c  rw1 rw1b rw2b
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then  
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(rw3(ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(kxyz(sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), &amp;amp;
            sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)))    
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a2(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;allocate&lt;/span&gt;(a3(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),nym,sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))      
       &lt;span style=&#34;color:#75715e&#34;&gt;!(111) rw3  kxyz  ^a
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;waves()

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_init


  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Release memory used by Poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_finalize

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(ax,bx,ay,by,az,bz)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_finalize(ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_info_finalize(sp)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_finalize
    fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .false.

    &lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(kxyz)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (000) cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1,cw1b,rw1,rw1b,rw2)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (100)   cw1 cw1b rw1 rw1b rw2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1,cw2,cw2b,rw2,rw2b)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (010)   cw1 cw2  cw2b  rw2 rw2b
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(cw1,cw1b,cw2,cw2b,rw1,rw1b,rw2,rw2b)
       &lt;span style=&#34;color:#75715e&#34;&gt;! (11*)   cw1,cw1b,cw2,cw2b,rw1,rw1b,rw2,rw2b
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;deallocate&lt;/span&gt;(rw3)
        &lt;span style=&#34;color:#75715e&#34;&gt;!(111)    rw3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;decomp_2d_poisson_finalize


  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Top level wrapper
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson(rhs, bcx, bcy, bcz)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx, bcy, bcz  &lt;span style=&#34;color:#75715e&#34;&gt;! boundary conditions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_000(rhs)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_100(rhs)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_010(rhs)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; .and. bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;! 110 &amp;amp; 111
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;poisson_11x(rhs, bcz)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;stop&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;boundary condition not supported&amp;#39;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson


  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Solving 3D Poisson equation with periodic B.C in all 3 dimensions
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                                                      3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!                                                      3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_000(rhs)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;derivX
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;derivY
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;derivZ

    &lt;span style=&#34;color:#75715e&#34;&gt;! right-hand-side of Poisson as input
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! solution of Poisson as output
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; fft_start, fft_end, fft_size

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ytt,xtt,ztt,yt1,xt1,yt2,xt2
    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xtt1,ytt1,ztt1,zt1,zt2


    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2,x ,y, z
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global
    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform   r2c:real to complex by zhaoliang
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! cw1 is 3dim data structrue
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!! only fft to transform the real data to complex data while (100) twice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!! one is tranform and then fft  (you can see poisson100
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)
    

    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!  why this below is called normalisation ??????  just divide 3dim grid number
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

             &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!post-processing in 3-direction can be
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!! set in the same cycle,because they are
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!! similar
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)   &lt;span style=&#34;color:#75715e&#34;&gt;!  get the real number of cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))               &lt;span style=&#34;color:#75715e&#34;&gt;!  get the imagenumber of cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)   &lt;span style=&#34;color:#75715e&#34;&gt;! modify the cw1 in the spectral space Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                                    &lt;span style=&#34;color:#75715e&#34;&gt;!  bz  az
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                                    &lt;span style=&#34;color:#75715e&#34;&gt;!  by  ay
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                                    &lt;span style=&#34;color:#75715e&#34;&gt;!  bx  ax
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)   &lt;span style=&#34;color:#75715e&#34;&gt;! why should be axisymmetry!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)

             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;! CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!  Yes ! division  by zero is impossible!!!-----------------------------------&amp;lt;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((tmp1.lt.epsilon).or.(tmp2.lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;!epsilon?  what does it mean?
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!                print *,&amp;#39;DIV 0&amp;#39;,i,j,k,epsilon
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw1(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

           &lt;span style=&#34;color:#75715e&#34;&gt;!Print result in spectal space after Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!     if (abs(out(i,j,k)) &amp;gt; 1.0e-4) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!        write(*,*) &amp;#39;AFTER&amp;#39;,i,j,k,out(i,j,k),xyzk
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!     end if
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;

             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
              &lt;span style=&#34;color:#75715e&#34;&gt;!                                          bz    az
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;              &lt;span style=&#34;color:#75715e&#34;&gt;!                                          by    ay
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;              &lt;span style=&#34;color:#75715e&#34;&gt;!                                          bx    ax
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)

             &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)

          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
             
    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)    &lt;span style=&#34;color:#75715e&#34;&gt;!  from complex  to real!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
 &lt;span style=&#34;color:#75715e&#34;&gt;!   call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_000


  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_100(rhs)
      &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!!!! get the rhs and then modify rhs ,at last return the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2, tmp3, tmp4
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xx1,xx2,xx3,xx4,xx5,xx6,xx7,xx8
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k, itmp
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!  8 transform   from x --&amp;gt;y --&amp;gt;z then z--&amp;gt; y ---&amp;gt;x at the beginning
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!from x --&amp;gt;y --&amp;gt;z then z--&amp;gt; y ---&amp;gt;x at the endding
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!  (100 add 8 more transform than 000) while 000 is 0 transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!  so rhs is in the z pencil ,no there are not z pencil at all!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!   the program is  2-dim pm*pn decomp !  so only  xpencil and y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice real to complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transform rhs-rw2-rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rhs-----rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice complex to real
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transfrom rw1-rw2--rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rw1------rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!! post-processing operations is under the complex condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   input real rhs(:.:,:) in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT forward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   3 post-processing   z--&amp;gt;y---&amp;gt;x  direction not pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   3 post-processing backward  x---&amp;gt;y----&amp;gt;z  direction
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   output real rhs(:,:,:)  in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,a8,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;I4,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;F12.&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;)

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global
    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil(wrong!There isn&amp;#39;t Z pencil)(wrong
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;!again, there is Z pencil))but requires global operations in X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! why should do the transpose!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;! why in the poisson_000 is not needed!???????????????
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!   two steps to change from z to x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)  &lt;span style=&#34;color:#75715e&#34;&gt;! z pencil in y pencil but in the physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!rw2 is the complex 3-dim data the same as rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2,rw1,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
              &lt;span style=&#34;color:#75715e&#34;&gt;!!! rw1  rw1b   1 means  x pencil   
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;              &lt;span style=&#34;color:#75715e&#34;&gt;!!! rw2  rw2b   2 means  y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)  &lt;span style=&#34;color:#75715e&#34;&gt;! the odd terms  is for the half before
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k)  &lt;span style=&#34;color:#75715e&#34;&gt;! the reverse terms is for the half after
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!3 layers data
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!! rw1b is the top lay data  xpencil     physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!! rw2  is in the middle lay data   y pencil   physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!! rw1 rhs  is in the outer lay data    z pencil  spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)    &lt;span style=&#34;color:#75715e&#34;&gt;! let x pencil rw1b to y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)     &lt;span style=&#34;color:#75715e&#34;&gt;! let y pencil rw2 to  z pencil&amp;#39;s rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!first time get what we want
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z,nx,ny,nz)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!           why should force the before pre-posting   ------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!the most key operation :::: the fft operator: decomp_2d_fft_3d
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)  &lt;span style=&#34;color:#75715e&#34;&gt;!  from real to complex!  and begin poission solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! in the z pencil we did the fft transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!! so cw1 is 3d complex data ,yeah (:,:,:)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;


    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;START&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after z&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!because (100)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!so the post processing in x is different
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!from the  y and z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#75715e&#34;&gt;!!! the 2~nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!     2~nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw1b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)  
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!  While  you set the -Debug in the compile period
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after x&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!from now on, the cw1b in x,y,z direction(not pencil)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!is calculated ,so now you can calculate cw1b in the
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!! poisson condition ,yes poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp1=real(zk2(k)+yk2(j)+xk2(i), kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp2=aimag(zk2(k)+yk2(j)+xk2(i))
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;!xyzk=cmplx(tmp1,tmp2, kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;! CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;! yes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;
             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!the most dayly processing
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!  You know cw1b is the cw1&amp;#39;s another form in the spectral
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!! space ,so you need to change the spetral space to physical
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!! space again ,yes get the cw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!! from now on ,you will found that the calculate of poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!! equation is in the spectral space ,from the fft,then 3 post
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!! processing in x,y,z 3 directions, then calculate the  poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!! equation. OK,then you start next!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)        
              &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!the buterfly algorithm!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!from now on x direction ,the spectral data has been transform to
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!! physical space, but still the complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER X&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (j.gt.(ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER Y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

                                    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!! by  ay
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                                    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!! bz  az
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;END&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)

    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil but requires global operations in X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2,rw1,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(i,j,k)   &lt;span style=&#34;color:#75715e&#34;&gt;! the odd terms is setted!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)  &lt;span style=&#34;color:#75715e&#34;&gt;! the even terms is setted
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)
&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!the finally outcome rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
  &lt;span style=&#34;color:#75715e&#34;&gt;!  call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_100

  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Neumann!!!!!!!!!!!!!!!!!!!!!!!!!!!111
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; 
  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Solving 3D Poisson equation: Neumann in Y; periodic in X &amp;amp; Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_010(rhs)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2, tmp3, tmp4
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xx1,xx2,xx3,xx4,xx5,xx6,xx7,xx8

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k

&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,a8,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;I4,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;F12.&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;)

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global
    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! (010)  so have fewer1 ny!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!so if (11*)  you need to ?what pencil??????
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!??
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil but requires global operations in Y  because(010)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice real to complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transform rhs-rw2-rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rhs-----rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice complex to real
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transfrom rw1-rw2--rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rw1------rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!! post-processing operations is under the complex condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   input real rhs(:.:,:) in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1+1 transform  z-&amp;gt;y y-&amp;gt;z  |destination: modify the rhs  because z-y=1  rather than z-x=2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT forward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2 post-processing   z--&amp;gt;x  direction not pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transform z-y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing   y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 matrice_refinement
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   3 inversion5_v1  inversion5_v2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing backward  Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transform y-z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2 post-processing backward  x----&amp;gt;z  direction
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1+1 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   output real rhs(:,:,:)  in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!so the key factor  a  a2  a3    ax bx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ay by
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! az bz
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2b,rhs,ph)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z,nx,ny,nz)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;START&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after z&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after x&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! NEED TO BE IN Y PENCILS!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!sp!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1,cw2,sp)

    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!sp!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny      
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw2b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw2b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after y&amp;#39;&lt;/span&gt;,i,j,k,cw2b(i,j,k)
                &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,kxyz(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! doing wave number division in Y-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp1=real(zk2(k)+yk2(j)+xk2(i), kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp2=aimag(zk2(k)+yk2(j)+xk2(i))
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;!xyzk=cmplx(tmp1,tmp2, kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, &amp;amp;
                     aimag(cw2b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw2b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
       
        &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;matrice_refinement()
        &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       do k = sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do j = 1,ny/2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             do i = sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!                print *,i,j,k,a(i,j,k,3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!                if (nrank.le.1) print *,i,j,k,a(i,j,k,3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!                if (nrank.gt.1) print *,i+4,j,k,a(i,j,k,3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;     


&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!istret  !=3
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;;cw2c(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
             cw2c(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)
          enddo
          enddo
          enddo

 &lt;span style=&#34;color:#75715e&#34;&gt;!   do k = sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!      do j = 1,ny/2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!         do i = sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!            if (abs(cw2(i,j,k)) &amp;gt; 1.0e-4) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!               write(*,*) &amp;#39;before IN&amp;#39;,i,j,k,cw2(i,j,k)!*2.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;!!            end if
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!        end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!     end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!  end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          
  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!for the strech  grid!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a,cw2,sp)
         &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a2,cw2c,sp)

&lt;span style=&#34;color:#75715e&#34;&gt;!         cw2(1,1,1)=cw2(1,1,1)*0.5
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         
 
&lt;span style=&#34;color:#75715e&#34;&gt;!   do k = sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       do j = 1,ny/2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do i = sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             if (abs(cw2c(i,j,k)) &amp;gt; 1.0e-4) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!                write(*,*) &amp;#39;after IN&amp;#39;,i,j,k,cw2c(i,j,k)!*2.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             end if
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!       end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!    end do
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
          cw2b(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,(j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2c(i,j&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          enddo
          &lt;span style=&#34;color:#75715e&#34;&gt;!do k=sp%yst(3), sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!do i=sp%yst(1), sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   if ((xkx(i)==0).and.(zkz(k)==0)) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   !   cw2b(i,1,1)=0.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   !   cw2b(i,ny,1)=0.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!   endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;!enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,j,k)
          enddo
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v2(a3,cw2,sp)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,j,k)
          enddo
          enddo
          enddo
       endif

    endif

&lt;span style=&#34;color:#75715e&#34;&gt;!    print *,nrank, sp%yst(3),sp%yen(3),sp%yst(1),sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!we are in Y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)  
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((i&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).and.(k&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2b(i,:,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
       endif
    enddo
    enddo
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw2b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER&amp;#39;&lt;/span&gt;,i,j,k,cw2b(i,j,k)
                &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,kxyz(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2b(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2b(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2b(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             cw2(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
           
    &lt;span style=&#34;color:#75715e&#34;&gt;! Back to X-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2,cw1,sp)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER Y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (i.gt.(nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) cw1(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER X&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;END&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform, back to physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)

    &lt;span style=&#34;color:#75715e&#34;&gt;! rhs is in Z-pencil but requires global operations in Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,j,k)
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2b,rhs,ph)

  &lt;span style=&#34;color:#75715e&#34;&gt;!  call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_010

  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!Neumann!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!11x!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!Neumann Neumann Neumann!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!Neumann Neumann periodic!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;! Solving 3D Poisson equation: Neumann in X, Y; Neumann/periodic in Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_11x(rhs, nclz1)




                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice real to complex
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transform rhs-rw2-rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rhs-----rw1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!twice complex to real
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 1: transfrom rw1-rw2--rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!! 2: fft       rw1------rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;                   &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!! post-processing operations is under the complex condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   input real rhs(:.:,:) in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    z--y  y-&amp;gt;x   x-y y-z|destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT forward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing  z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  x--y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing  y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  y--x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing  x (because  he thinks he is in X pencil, Zhaoliang said no)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 poisson solver
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 matrice_refinemento
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpse   x--y  (for strecting  because strecthing is in the y direction)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 inversion5_v1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  y---x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  x-y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 transpose  y-x
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 post-processing z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   1 FFT backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   2+2 transform    |destination: modify the rhs
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!   output real rhs(:,:,:)  in the z pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;


    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nclz1    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:,:,:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(INOUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; rhs

    &lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp1, tmp2, tmp3, tmp4
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xx1,xx2,xx3,xx4,xx5,xx6,xx7,xx8

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz, i,j,k

&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;format&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;x,a8,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;I4,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;F12.&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;)

    nx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nx_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;! becasuse (110)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    ny &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ny_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;     &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!the free-slip boundary condition
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nz_global
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then  
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
                rw3(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
                rw3(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;nz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rw3,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then     
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
             rw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! the global operations in X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2b,rw1,ph)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
             rw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! back to Z-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (.not. fft_initialised) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_init(PHYSICAL_IN_Z,nx,ny,nz)
       fft_initialised &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; .true.
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute r2c transform
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(rhs,cw1)



    &lt;span style=&#34;color:#75715e&#34;&gt;! normalisation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    cw1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cw1 &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
         &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;START&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing in spectral space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after z&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;


    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!while  1  should be in the corresponding pencils
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!characteristic 2 : there sholud be tmp1*2*3*4
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! WE HAVE TO BE IN Y PENCILS
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;


    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!No  we should be the z pencil!  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!there is something wrong in the source code!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!But now we are in the z pencil not in
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  the x pencil!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!so,it should be
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!call transpose_z_to_y rather than transpose_x_to_y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1,cw2,sp)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw2b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)  
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! back to X-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!the same wrong ,now you should
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!go back to the z pencil rather than the x pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2b,cw1,sp)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;after y&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2._mytype&lt;/span&gt;
             cw1b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7, &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)  
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
    
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;BEFORE&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! Solve Poisson
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp1=real(zk2(k)+yk2(j)+xk2(i), kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!tmp2=aimag(zk2(k)+yk2(j)+xk2(i))
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(kxyz(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aimag(kxyz(i,j,k))
             &lt;span style=&#34;color:#75715e&#34;&gt;!xyzk=cmplx(tmp1,tmp2, kind=mytype)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#75715e&#34;&gt;!CANNOT DO A DIVISION BY ZERO
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).lt.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).lt.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &lt;span style=&#34;color:#ae81ff&#34;&gt;0._mytype&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((abs(tmp1).ge.epsilon).and.(abs(tmp2).ge.epsilon)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;cw1b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx( &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype) &amp;amp;
                     &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp1), &amp;amp;
                     aimag(cw1b(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;matrice_refinement()
       &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11so       we  should  z-&amp;gt;y pencil but not  x-&amp;gt;ypencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;! the stretching is only working in Y pencils
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!why the default the pencil is  x pencil rather than z pencil!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1b,cw2b,sp)
       &lt;span style=&#34;color:#75715e&#34;&gt;!we are now in Y pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       
       &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;;cw2c(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
             cw2c(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)
          enddo
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a,cw2,sp)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v1(a2,cw2c,sp)

          cw2b(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,(j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2c(i,j&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)
          enddo
          enddo
          enddo
       &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;cw2(:,:,:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2b(i,j,k)
          enddo
          enddo
          enddo

          &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;inversion5_v2(a3,cw2,sp)

          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             cw2b(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,j,k)
          enddo
          enddo
          enddo
       endif
&lt;span style=&#34;color:#75715e&#34;&gt;!we have to go back in X pencils
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2b,cw1b,sp)
    endif

&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-6&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER&amp;#39;&lt;/span&gt;,i,j,k,cw1b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!stop
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! post-processing backward
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          cw1(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1b(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,j,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bx(i)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ax(i)
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)        
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER X&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! NEED to be in Y-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(cw1,cw2,sp)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          cw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,j,k))
             tmp3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp4 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))
             xx1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp3&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             xx7&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;by(j)
             xx8&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp4&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ay(j)
             cw2b(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(xx1&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx4&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx6&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx7,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx3&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xx5&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xx8), &amp;amp;
                  kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)        
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw2b(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;                &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AFTER Y&amp;#39;&lt;/span&gt;,i,j,k,cw2b(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;! back to X-pencil
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(cw2b,cw1,sp)
    
    &lt;span style=&#34;color:#75715e&#34;&gt;! POST PROCESSING IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             tmp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw1(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
             tmp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; aimag(cw1(i,j,k))
             cw1(i,j,k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cmplx(tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), &amp;amp;
                  tmp2&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;bz(k)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;az(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
&lt;span style=&#34;color:#75715e&#34;&gt;#ifdef DEBUG
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;             &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (abs(cw1(i,j,k)) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1.0e-4&lt;/span&gt;) &amp;amp;
                  &lt;span style=&#34;color:#66d9ef&#34;&gt;write&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;END&amp;#39;&lt;/span&gt;,i,j,k,cw1(i,j,k)
&lt;span style=&#34;color:#75715e&#34;&gt;#endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;! compute c2r transform, back to physical space
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;decomp_2d_fft_3d(cw1,rhs)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ph%zsz(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
                rw3(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,k)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;             &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
                rw3(i,j,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rhs(i,j,nz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
             &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rw3,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz1&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_z_to_y(rhs,rw2,ph)   
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),ph%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,j,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw2b(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_x(rw2b,rw1,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
       &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ph%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),ph%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(i,j,k)
          enddo
          &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
             rw1b(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;rw1(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,j,k)
          enddo
       enddo
    &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_x_to_y(rw1b,rw2,ph)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;call &lt;/span&gt;transpose_y_to_z(rw2,rhs,ph)

  &lt;span style=&#34;color:#75715e&#34;&gt;!  call decomp_2d_fft_finalize
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
   

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;poisson_11x


 
  &lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;abxyz(ax,ay,az,bx,by,bz,nx,ny,nz,bcx,bcy,bcz)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;param

    &lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; nx,ny,nz
    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(IN) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; bcx,bcy,bcz
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(OUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ax,bx
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(OUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ay,by
    &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype), &lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(:), &lt;span style=&#34;color:#66d9ef&#34;&gt;intent&lt;/span&gt;(OUT) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; az,bz

    &lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i,j,k

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!! generate the x direction coeficiency!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          ax(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bx(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
           &lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!one and a half of PI
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          ax(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bx(i) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          ay(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          by(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcy&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
          ay(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          by(j) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ny, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
          az(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bz(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (bcz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;       &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz
          az(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sin(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
          bz(k) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;PI&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0_mytype&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &amp;amp;
               &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(nz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))
       &lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;abxyz

&lt;span style=&#34;color:#75715e&#34;&gt;! ***********************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;waves ()
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!***********************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivX
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivY
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivZ
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;param
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;decomp_2d
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;variables
&lt;span style=&#34;color:#66d9ef&#34;&gt;use &lt;/span&gt;decomp_2d_fft

&lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i,j,k
&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; w,wp,w1,w1p
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xyzk
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ytt,xtt,ztt,yt1,xt1,yt2,xt2
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xtt1,ytt1,ztt1,zt1,zt2,tmp1,tmp2,tmp3
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; tmp4,tmp5,tmp6

xkx(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; xk2(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; yky(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; yk2(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
zkz(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt; ; zk2(:)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!WAVE NUMBER IN X
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nx
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;acix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bcix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      xkx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      exs(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;nx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nx
      xkx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xkx(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      exs(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;exs(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xk2(nx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nx
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(i&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nxm
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;acix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bcix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      xkx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      exs(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx,nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nxm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xlx)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   xkx(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   exs(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   xk2(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
endif

&lt;span style=&#34;color:#75715e&#34;&gt;!WAVE NUMBER IN Y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ncly&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;ny
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp,ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      eys(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(ny&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny
      yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yky(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      eys(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;eys(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yk2(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nym
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret.ne.&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) yky(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp,nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      eys(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly,nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nym&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yly)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   eys(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   yk2(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
endif

&lt;span style=&#34;color:#75715e&#34;&gt;!WAVE NUMBER IN Z
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nz
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      zkz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ezs(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      w&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(k&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nzm
      w1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(nzm&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nzm
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w)
      wp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w))
      w1p&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;aciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(w1&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(bciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;sin(&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1)
      w1p&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;w1p&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;alcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(w1))     
      zkz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1p&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ezs(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz,nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;wp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(nzm&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w1p&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zlz)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
endif
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!if (nrank==0) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   do i=1,nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!      print *,i,ezs(i)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!stop
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((nclx&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;).and.(nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;).and.((ncly&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).or.(ncly&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   yt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   zt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   xyzk&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;yt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;zt2
   kxyz(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xyzk
&lt;span style=&#34;color:#75715e&#34;&gt;!   print *,i,j,k, kxyz(i,j,k)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo
enddo
enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
         xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         xt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xk2(i)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
         yt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;yk2(j)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
         zt2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;zk2(k)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((((xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;xt1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;((ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;yt1))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
         xyzk&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;yt2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;zt2
         kxyz(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xyzk
&lt;span style=&#34;color:#75715e&#34;&gt;!   print *,i,j,k, kxyz(i,j,k)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      enddo
      enddo
      enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%xst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%xen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)  
         xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
              ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
              (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         &lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;         xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
              (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         
         tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
              aimag(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;aimag(zt1), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
              &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
              &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         
         tmp4&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp2, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(aimag(tmp1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(tmp2))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp5&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp3, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(aimag(tmp1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(tmp3))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp6&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp3, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp2, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,(aimag(tmp3)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(tmp2))&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         
         tmp1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp4, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),aimag(tmp4)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(xk2(i)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp5, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yk2(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),aimag(tmp5)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(yk2(j)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         tmp3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(tmp6, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),aimag(tmp6)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(zk2(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)

         xyzk&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;tmp1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp2&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;tmp3
         kxyz(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xyzk
&lt;span style=&#34;color:#75715e&#34;&gt;!         print *,i,j,k,zt1,yt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      enddo
      enddo
      enddo
   endif
endif


&lt;span style=&#34;color:#75715e&#34;&gt;!          do k=1,1!nz
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do j=1,ny
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          do i=1,1!!nx
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!             print *,j,a(i,j,k,3),kxyz(i,j,k)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!          enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;waves

&lt;span style=&#34;color:#75715e&#34;&gt;!**************************************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;matrice_refinement()
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!**************************************************************************
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;decomp_2d
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;variables
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;param
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;var
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;MPI
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivX
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivY
&lt;span style=&#34;color:#66d9ef&#34;&gt;USE &lt;/span&gt;derivZ

&lt;span style=&#34;color:#66d9ef&#34;&gt;implicit &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;none
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;integer&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; i,j,k

&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype),&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; transx
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype),&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; transy
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype),&lt;span style=&#34;color:#66d9ef&#34;&gt;dimension&lt;/span&gt;(sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;):sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; transz
&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xa0,xa1
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; ytt,xtt,ztt,yt1,xt1,yt2,xt2
&lt;span style=&#34;color:#66d9ef&#34;&gt;complex&lt;/span&gt;(mytype) &lt;span style=&#34;color:#66d9ef&#34;&gt;::&lt;/span&gt; xtt1,ytt1,ztt1,zt1,zt2,tmp1,tmp2,tmp3

&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   xtt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (bicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        cicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xtt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aicix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   xt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaix6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(exs(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dx)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   transx(i)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xtt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xtt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(xtt+xtt)/xt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
   ytt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (biciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
        ciciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   ytt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
        (aiciy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   yt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)),&amp;amp;
        (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiy6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(eys(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dy)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   transy(j)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ytt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ytt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(ytt+ytt)/yt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nclz&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
           (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      transz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;aimag(zt1), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(ztt+ztt)/zt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   enddo
&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
      ztt&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (biciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&amp;amp;
           ciciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      ztt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)),&amp;amp;
           (aiciz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      zt1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ezs(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)),&amp;amp;
           (&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ailcaiz6&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cos(aimag(ezs(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;dz)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      transz(k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zt1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(ztt1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;ztt)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;aimag(zt1), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#75715e&#34;&gt;!(ztt+ztt)/zt1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   enddo
endif

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).or.(istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt; 
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;alpha&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
   &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) xa1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
   &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (istret&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) xa1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!construction of the pentadiagonal matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      cw22(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      cw2(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(yky(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   enddo


   

&lt;span style=&#34;color:#75715e&#34;&gt;!main diagonal
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(ny&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   
 

 

&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
      a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))),&amp;amp;
           (xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           (xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo



&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;,aimag(a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   a(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo



&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)   
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
        xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   a2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
        (xa0&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k)))&amp;amp;
        &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)  
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,ny&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a2(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw2(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a2(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!not to have a singular matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;).and.(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;         &lt;/span&gt;a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
         a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
         a(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
      endif
   enddo
   enddo

&lt;span style=&#34;color:#66d9ef&#34;&gt;else
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;alpha&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
   xa1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4.&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;beta&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pi
&lt;span style=&#34;color:#75715e&#34;&gt;!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!construction of the pentadiagonal matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nym
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      cw22(i,j,k)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(yky(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype),&amp;amp;
           aimag(yky(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   enddo

&lt;span style=&#34;color:#75715e&#34;&gt;!main diagonal
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(j), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(j))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
   enddo

   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
      a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
      a3(i,nym,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(xk2(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transz(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(zk2(k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transy(nym), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(transx(i), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(xk2(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transz(k)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;(aimag(zk2(k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transy(nym))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(transx(i)))&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,nym,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,nym,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa0&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&amp;amp;
           xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,nym,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo

   


&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx((xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype))),&amp;amp;
        (xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k)))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!sup diag +2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   &lt;span style=&#34;color:#75715e&#34;&gt;!a3(i,1,k,5)=a3(i,1,k,5)*2.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;!a3(i,1,k,5)=0.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   a3(i,nym&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a3(i,nym,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo


&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,nym
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&amp;amp;
           &lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)),&amp;amp;
           xa0&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(aimag(cw22(i,j,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo
&lt;span style=&#34;color:#75715e&#34;&gt;!inf diag -2
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sp%yst(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),sp%yen(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;do &lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,nym
      a3(i,j,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;real&lt;/span&gt;(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k), kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1,&amp;amp;
           &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;aimag(cw22(i,j&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;xa1, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   enddo
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a3(i,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,k,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   enddo
   enddo

&lt;span style=&#34;color:#75715e&#34;&gt;!not to have a singular matrice
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   do k=sp%yst(3),sp%yen(3)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   do i=sp%yst(1),sp%yen(1)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!      if ((xkx(i)==0.).and.(zkz(k)==0)) then
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (nrank&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;then
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;   &lt;/span&gt;a3(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cmplx(&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1.&lt;/span&gt;, kind&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mytype)
   a3(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
   a3(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;
endif
&lt;span style=&#34;color:#75715e&#34;&gt;!      endif
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;!   enddo
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;endif


   


&lt;span style=&#34;color:#66d9ef&#34;&gt;return
&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;subroutine &lt;/span&gt;matrice_refinement

&lt;span style=&#34;color:#66d9ef&#34;&gt;end &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;module &lt;/span&gt;decomp_2d_poisson
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
  </channel>
</rss>
