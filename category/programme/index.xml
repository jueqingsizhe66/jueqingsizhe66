<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>programme | 30年磨一剑</title>
    <link>https://jueqingsizhe66.github.io/category/programme/</link>
      <atom:link href="https://jueqingsizhe66.github.io/category/programme/index.xml" rel="self" type="application/rss+xml" />
    <description>programme</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><copyright>©2022</copyright><lastBuildDate>Wed, 04 Dec 2019 14:18:00 +0800</lastBuildDate>
    <image>
      <url>https://jueqingsizhe66.github.io/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_3.png</url>
      <title>programme</title>
      <link>https://jueqingsizhe66.github.io/category/programme/</link>
    </image>
    
    <item>
      <title>python提取时间序列白天和黑夜的时间段</title>
      <link>https://jueqingsizhe66.github.io/post/python%E6%8F%90%E5%8F%96%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E7%99%BD%E5%A4%A9%E5%92%8C%E9%BB%91%E5%A4%9C%E7%9A%84%E6%97%B6%E9%97%B4%E6%AE%B5/</link>
      <pubDate>Wed, 04 Dec 2019 14:18:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/post/python%E6%8F%90%E5%8F%96%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E7%99%BD%E5%A4%A9%E5%92%8C%E9%BB%91%E5%A4%9C%E7%9A%84%E6%97%B6%E9%97%B4%E6%AE%B5/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://jueqingsizhe66.github.io/post/%e7%8e%a9%e8%bd%acpython-datetime/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;玩转Python datetime&lt;/a&gt;已针对时间序列进行了相关处理，得到了满足AIWIND计算要求的测风塔时间序列&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.semanticscholar.org/paper/Atmospheric-boundary-layer-stability-and-its-to-Breedt/9bfd308031989e2a7f31dc54779182a4f8735980&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Atmospheric Boundary Layer Stability&lt;/a&gt;一文我们知道地表边界层在昼夜存在不同；白天由于地表被加热，边界层较薄，反之亦然；为此需要对雷达的测量结果提取昼夜的分布信息&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/3d1d648406f3&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Astral库计算日出日落时间&lt;/a&gt;一文解决获取当天日出日落时间，进一步可参考&lt;a href=&#34;https://astral.readthedocs.io/en/stable/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Astral手册&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;原始数据格式&#34;&gt;原始数据格式&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/aiwind/dataFormatDayNight.png&#34; alt=&#34;原始数据格式&#34;&gt;：第一列为时间序列，2,3列分别为雷达40m处的风向风速，依次类推&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd
  &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np
  &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; datetime
  &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; astral

  &lt;span style=&#34;color:#75715e&#34;&gt;##https://www.jianshu.com/p/3d1d648406f3&lt;/span&gt;
  longititude&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;21.45&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;## 城市经度信息&lt;/span&gt;
  latitude&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;112.15&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;## 城市纬度度信息&lt;/span&gt;
  location_yangjiang &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; astral&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Location((&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Yangjiang&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;China&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;21.45&lt;/span&gt; ,&lt;span style=&#34;color:#ae81ff&#34;&gt;112.15&lt;/span&gt; , &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Asia/Shanghai&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
  &lt;span style=&#34;color:#75715e&#34;&gt;#location_yangjiang = astral.Location((&amp;#39;YanDun&amp;#39;, &amp;#39;China&amp;#39;,42.3369 ,94.382 , &amp;#39;Asia/Shanghai&amp;#39;, 0))&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#location_yangjiang = astral.Location((&amp;#39;huailai&amp;#39;, &amp;#39;China&amp;#39;,42.242 ,115.35 , &amp;#39;Asia/Shanghai&amp;#39;, 0))&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#time_sunrise=location_yangjiang.sunrise(date=datetime.date.today(),local=True)&lt;/span&gt;
  time_sunrise&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;location_yangjiang&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sunrise(date&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;date(&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;),local&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
  time_sunrise_update&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;time_sunrise &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;timedelta(hours&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#75715e&#34;&gt;#提前/延后日出时间量&lt;/span&gt;
  time_sunrise_new&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;str(time_sunrise_update)
  print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;日出时间:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;time_sunrise_new&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;)

  &lt;span style=&#34;color:#75715e&#34;&gt;#time_sunset=location_yangjiang.sunset(date=datetime.date.today(),local=True)&lt;/span&gt;
  time_sunset&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;location_yangjiang&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sunset(date&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;date(&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;),local&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)

  time_sunset_update&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;time_sunset &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;timedelta(hours&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#75715e&#34;&gt;#提前/延后日落时间量&lt;/span&gt;
  time_sunset_new&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;str(time_sunset_update)
  print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;日落时间:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;time_sunset_new&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;)


  &lt;span style=&#34;color:#75715e&#34;&gt;#dongpingLidar=pd.read_excel(r&amp;#34;C:\Users\yezhaoliang\Desktop\dongpingLidar67.xlsx&amp;#34;)&lt;/span&gt;
  dongpingLidar&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_excel(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\Users\yezhaoliang\Desktop\work\AIWind\功率曲线\手算白天黑夜\dongpingLidar14WithTime.xlsx&amp;#34;&lt;/span&gt;)
  positions&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;40&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;65&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;115&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;140&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;160&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;170&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;180&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;190&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;200&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;210&lt;/span&gt;]
  windDirection&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;180&lt;/span&gt;
  minusPlus&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;
  velMean&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(positions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__())

  &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getSunriseFromDay&lt;/span&gt;(today):
      &lt;span style=&#34;color:#75715e&#34;&gt;## 日出&lt;/span&gt;
      year&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;today[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;]
      month&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;today[&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;]
      day&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;today[&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;]
      time_sunrise &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; location_yangjiang&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sunrise(date&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;date(int(year), int(month), int(day)), local&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
      time_sunrise_update &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; time_sunrise &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;timedelta(hours&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)  &lt;span style=&#34;color:#75715e&#34;&gt;# 提前/延后日出时间量&lt;/span&gt;
      time_sunrise_new &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; str(time_sunrise_update)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; time_sunrise_new[&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;]

  &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getSunsetFromDay&lt;/span&gt;(today):
      year&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;today[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;]
      month&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;today[&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;]
      day&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;today[&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;]
      &lt;span style=&#34;color:#75715e&#34;&gt;## 日落&lt;/span&gt;
      time_sunset &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; location_yangjiang&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sunset(date&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;date(int(year), int(month), int(day)), local&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
      time_sunset_update &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; time_sunset &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;timedelta(hours&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)  &lt;span style=&#34;color:#75715e&#34;&gt;# 提前/延后日落时间量&lt;/span&gt;
      time_sunset_new &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; str(time_sunset_update)
      &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; time_sunset_new[&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;]


  &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getDayArrayCursorByDay&lt;/span&gt;():
      timeseries&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;dongpingLidar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]

      &lt;span style=&#34;color:#75715e&#34;&gt;## timeSeries 9-19 为小时：分钟:秒      time_sunset_new 11:19为小时:分钟:秒&lt;/span&gt;
      &lt;span style=&#34;color:#75715e&#34;&gt;# for (idx, val) in enumerate(timeseries):&lt;/span&gt;
      &lt;span style=&#34;color:#75715e&#34;&gt;#     time_sunrise_new,time_sunset_new=getSunriseSunsetFromDay(val)&lt;/span&gt;
      &lt;span style=&#34;color:#75715e&#34;&gt;#     if(val[9:19] &amp;gt;= time_sunrise_new[11:19] and val[9:19] &amp;lt;= time_sunset_new[11:19]]):&lt;/span&gt;
      &lt;span style=&#34;color:#75715e&#34;&gt;#         dayIndex&lt;/span&gt;

      &lt;span style=&#34;color:#75715e&#34;&gt;# dayIndex = [idx for (idx, val) in enumerate(timeseries) if val[9:19] &amp;gt;= time_sunrise_new[11:19] and val[9:19] &amp;lt;=time_sunset_new[11:19]]&lt;/span&gt;
      &lt;span style=&#34;color:#75715e&#34;&gt;# nightIndex = [idx for (idx, val) in enumerate(timeseries) if val[9:19] &amp;lt; time_sunrise_new[11:19] or val[9:19] &amp;gt; time_sunset_new[11:19]]&lt;/span&gt;
      dayIndex &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [idx &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (idx, val) &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(timeseries) &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt; getSunriseFromDay(val) &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt;getSunsetFromDay(val)]
      nightIndex &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [idx &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (idx, val) &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(timeseries) &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; getSunriseFromDay(val) &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; getSunsetFromDay(val)]
      &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; dayIndex,nightIndex

  &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getDayArrayCursor&lt;/span&gt;():
      timeseries&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;dongpingLidar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]

      &lt;span style=&#34;color:#75715e&#34;&gt;## timeSeries 9-19 为小时：分钟:秒      time_sunset_new 11:19为小时:分钟:秒&lt;/span&gt;
      dayIndex &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [idx &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (idx, val) &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(timeseries) &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt; time_sunrise_new[&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt;time_sunset_new[&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;]]
      nightIndex &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [idx &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (idx, val) &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(timeseries) &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; time_sunrise_new[&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; val[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; time_sunset_new[&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;]]
      &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; dayIndex,nightIndex

&lt;span style=&#34;color:#75715e&#34;&gt;##1. 逐日跟踪日落日出&lt;/span&gt;
  dayIndex,nightIndex&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getDayArrayCursorByDay()

&lt;span style=&#34;color:#75715e&#34;&gt;##2. 测试期中间日期跟踪日落日出&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;# dayIndex,nightIndex=getDayArrayCursor()&lt;/span&gt;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(positions)):
      print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;i&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;:&amp;#34;&lt;/span&gt;)
      dir1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dongpingLidar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
      vel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dongpingLidar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]

      dayDir1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;dir1[dayIndex]
      dayVel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;vel[dayIndex]

      &lt;span style=&#34;color:#75715e&#34;&gt;# dayDir1=dir1[nightIndex]&lt;/span&gt;
      &lt;span style=&#34;color:#75715e&#34;&gt;# dayVel=vel[nightIndex]&lt;/span&gt;
      idx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [idx &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (idx, val) &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(dayDir1) &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; val &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt; (windDirection&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;minusPlus) &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; val &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt;(windDirection&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;minusPlus)]
      &lt;span style=&#34;color:#75715e&#34;&gt;## dir1[idx]  vel[idx]&lt;/span&gt;
      countVel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
      &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; cursor1 &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(idx)):
          cursor&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;idx[cursor1]
          countVel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;countVel&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;dayVel&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[cursor]

      velMean[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;countVel&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;len(idx)

  profiles&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame([velMean,positions])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;T
  profiles&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Lidar387Profiles14Day30.csv&amp;#34;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;1-2个月的雷达用中间日期即可，差别不大；如果全年的话，最好是跟踪每日。&lt;/li&gt;
&lt;li&gt;白天的计算速度边界层较薄，夜晚较厚一些，原因是白天的地表收到加热效应。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;顺便提及，我喜欢用TotalCommander对文件夹和文件进行颜色控制&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;凡是有备注的都显示粉色&lt;/li&gt;
&lt;li&gt;凡是一周之内有变动的文件和文件夹都显示蓝色&lt;/li&gt;
&lt;li&gt;凡是一天之内有变动的文件和文件夹都显示红色&lt;/li&gt;
&lt;li&gt;凡是office文件都显示灰色&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>风电场SCADA风速手算理论发电量和K值</title>
      <link>https://jueqingsizhe66.github.io/post/%E9%A3%8E%E7%94%B5%E5%9C%BAscada%E9%A3%8E%E9%80%9F%E6%89%8B%E7%AE%97%E7%90%86%E8%AE%BA%E5%8F%91%E7%94%B5%E9%87%8F/</link>
      <pubDate>Sat, 23 Nov 2019 23:16:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/post/%E9%A3%8E%E7%94%B5%E5%9C%BAscada%E9%A3%8E%E9%80%9F%E6%89%8B%E7%AE%97%E7%90%86%E8%AE%BA%E5%8F%91%E7%94%B5%E9%87%8F/</guid>
      <description>&lt;h2 id=&#34;背景分析&#34;&gt;背景分析&lt;/h2&gt;
&lt;p&gt;有时候需要根据一条功率曲线，手算scada速度序列的发电量&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;设计功率曲线&lt;/li&gt;
&lt;li&gt;scada风速序列&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np

&lt;span style=&#34;color:#75715e&#34;&gt;## Yandun&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#powerlaw=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\power12.csv&amp;#39;)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;## Dongping&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#powerlaw=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\my89_12.csv&amp;#39;)&lt;/span&gt;
powerlaw&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_csv(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C:\Users\yezhaoliang\Desktop\SL3000_121.pws.csv&amp;#39;&lt;/span&gt;)

cpVs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; powerlaw&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
cpPs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; powerlaw&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
&lt;span style=&#34;color:#75715e&#34;&gt;#velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\nacWindsim2.csv&amp;#39;)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\lidar.csv&amp;#39;)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\nac1.csv&amp;#39;,skiprows=1)&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;# nac1= velocitySet.iloc[:,0]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac2= velocitySet.iloc[:,1]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac4= velocitySet.iloc[:,2]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac7= velocitySet.iloc[:,3]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac8= velocitySet.iloc[:,4]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac12= velocitySet.iloc[:,5]&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;find&lt;/span&gt;(vel, cpVs):
    count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; cpV &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; cpVs:
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(cpV &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; vel):
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; count
        count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getMean&lt;/span&gt;(cpVs,cpPs,vel):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):
        rePower&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; rePower
    index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; find(vel, cpVs)
    v1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpVs[index&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
    v2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpVs[index]
    p1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpPs[index&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
    p2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpPs[index]
    rePower &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; p1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(p2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;p1)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(v2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;v1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;v1)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; rePower
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;modify&lt;/span&gt;(vel):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (vel&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.7081&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.9869&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;##  Velocity linear interpolation Method ####################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getPower&lt;/span&gt;(nac,i):
    calPower&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    calVel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; nac:
        calPower[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getMean(cpVs,cpPs,modify(vel))
        &lt;span style=&#34;color:#75715e&#34;&gt;#calPower[count]=getMean(cpVs,cpPs,vel)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#calPower[count]=getMean(cpVs,cpPs,vel)&lt;/span&gt;
        calVel[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;modify(vel)
        count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame([calVel,calPower])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;T
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(str(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-power.csv&amp;#34;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(calPower)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;6000&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;##  Velocity Bin Method ####################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;powerLawIntoZones&lt;/span&gt;(zones):
    velocityZones&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;linspace(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;,zones)
    powerZones&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(velocityZones&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__())
    velocityBinMag&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zones
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(zones):
        velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;velocityBinMag
        powerZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getMean(cpVs,cpPs,i&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;velocityBinMag)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; velocityZones,powerZones

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;whichZones&lt;/span&gt;(vel,velocityZones,powerZones,zones):
    velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;25.0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zones
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(zones):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;i):
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;):
                power&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;(velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;)  &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt;
                    vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;) ):
                power &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; powerZones[i]
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; power


&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getPowerVelocityBin&lt;/span&gt;(nac,i,zones&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;):
    calPower&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    calVel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    [velocityZones,powerZones]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerLawIntoZones(zones)
    cps&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame([velocityZones,powerZones])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;T
    cps&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_excel(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;powerVelocityBin&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;zones&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.xlsx&amp;#34;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; nac:
        &lt;span style=&#34;color:#75715e&#34;&gt;#calPower[count]=getMean(cpVs,cpPs,vel)&lt;/span&gt;
        calVel[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;vel
        calPower[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;whichZones(modify(vel),velocityZones,powerZones,zones)
        count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame([calVel,calPower])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;T
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(str(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-powerBin.csv&amp;#34;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(calPower)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;6000&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac8 = velocitySet.iloc[:, 0]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# power1 = getPower(nac8,0)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# print(power1)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# 烟墩6台机组 ：0-6&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\nacVelocity.csv&amp;#39;,skiprows=1)&lt;/span&gt;
velocitySet&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_csv(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C:\Users\yezhaoliang\Desktop\nacVelocity220.csv&amp;#39;&lt;/span&gt;,skiprows&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;span style=&#34;color:#75715e&#34;&gt;# 东平10台机组 ： 0-10&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\VP.csv&amp;#39;,skiprows=1)&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;):
&lt;span style=&#34;color:#75715e&#34;&gt;#for i in range(0,10):&lt;/span&gt;
    nac8 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; velocitySet&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, i]
    power1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; getPower(nac8,i)
    &lt;span style=&#34;color:#75715e&#34;&gt;#power1 = getPowerVelocityBin(nac8,i,50)&lt;/span&gt;
    print(power1)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;速度分仓&#34;&gt;速度分仓&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;设计功率曲线按照分仓个数bin,进行分仓&lt;/li&gt;
&lt;li&gt;按照分仓大小，设置速度范围多少归入一个仓中，比如50个分仓，仓大小为0.5, 那么第二个分仓也就是0.5，得满足所有大于等于0.25 小于0.75的速度序列术语第二个分仓&lt;/li&gt;
&lt;li&gt;结果发现速度分仓超过25仓之后，对功率曲线计算结果基本上和线性插值类似。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;悟空-条件&#34;&gt;悟空[条件]&lt;/h2&gt;
&lt;p&gt;注意判断中大于号和小于号都不能写错，涉及到判断、抉择、条件、空的时候一定得注意
思考对，曾经我就犯过错误!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;(velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;)  &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt;
        vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;) ):&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;手算两条功率的k值&#34;&gt;手算两条功率的k值&lt;/h2&gt;
&lt;p&gt;实际功率曲线[一般是scada的风速和功率的散点图]和设计功率曲线之比如果达到1，也就是k值，那么认为是最好的，如果大点也可以，但是最好不要少于，为了计算这个k值，简单编写了下面代码&lt;/p&gt;
&lt;p&gt;核心的地方在于比较提取的过程，即&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;scada的风速-功率关系散点图&lt;/li&gt;
&lt;li&gt;设计功率曲线&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(nac&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__()):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; j &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(zones):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; nac[vel]&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; nac[vel] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;):
            counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
            velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;nac[vel]
            powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;power[vel]
            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;elif&lt;/span&gt;(nac[vel]&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;(velocityZones[j]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;)  &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt;
            nac[vel]&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(velocityZones[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;)):
            counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
            velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;nac[vel]
            powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;power[vel]
            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;全部代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np

&lt;span style=&#34;color:#75715e&#34;&gt;### 规定风速范围从0-25 不能少于25&lt;/span&gt;
powerlaw&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_csv(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C:\Users\yezhaoliang\Desktop\my89_12.csv&amp;#39;&lt;/span&gt;)

cpVs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; powerlaw&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
cpPs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; powerlaw&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
&lt;span style=&#34;color:#75715e&#34;&gt;#velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\nacWindsim2.csv&amp;#39;)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\lidar.csv&amp;#39;)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# velocitySet=pd.read_csv(r&amp;#39;C:\Users\yezhaoliang\Desktop\nac1.csv&amp;#39;,skiprows=1)&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;# nac1= velocitySet.iloc[:,0]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac2= velocitySet.iloc[:,1]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac4= velocitySet.iloc[:,2]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac7= velocitySet.iloc[:,3]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac8= velocitySet.iloc[:,4]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac12= velocitySet.iloc[:,5]&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;find&lt;/span&gt;(vel, cpVs):
    count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; cpV &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; cpVs:
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(cpV &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; vel):
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; count
        count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getMean&lt;/span&gt;(cpVs,cpPs,vel):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):
        rePower&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; rePower
    index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; find(vel, cpVs)
    v1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpVs[index&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
    v2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpVs[index]
    p1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpPs[index&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
    p2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cpPs[index]
    rePower &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; p1&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;(p2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;p1)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(v2&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;v1)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;v1)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; rePower

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;modify&lt;/span&gt;(vel):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (vel&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.7081&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.9869&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;##  Velocity linear interpolation Method ####################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getPower&lt;/span&gt;(nac,i):
    calPower&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    calVel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; nac:
        calPower[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getMean(cpVs,cpPs,modify(vel))
        &lt;span style=&#34;color:#75715e&#34;&gt;#calPower[count]=getMean(cpVs,cpPs,vel)&lt;/span&gt;
        calVel[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;vel
        count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame([calVel,calPower])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;T
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(str(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-power.csv&amp;#34;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(calPower)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;6000&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;##  Velocity Bin Method ####################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;############################################################&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;powerLawIntoZones&lt;/span&gt;(zones):
    velocityZones&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;linspace(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;,zones)
    powerZones&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(velocityZones&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__())
    velocityBinMag&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zones
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(zones):
        velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;velocityBinMag
        powerZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getMean(cpVs,cpPs,i&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;velocityBinMag)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; velocityZones,powerZones

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;velocitySeriesSplitIntoZones&lt;/span&gt;(nac,power,zones&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;):
    [velocityZones,powerZones]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerLawIntoZones(zones)
    velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;25.0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zones
    counts&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    probability&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    velocitySum&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    velocityMean&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    powerSum&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    powerMean&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    powerTheory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)

    AEPActual&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    AEPTheory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(zones)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(nac&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__()):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; j &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(zones):
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;j &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; nac[vel]&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; nac[vel] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;):
                counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
                velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;nac[vel]
                powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;power[vel]
                &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;
            &lt;span style=&#34;color:#66d9ef&#34;&gt;elif&lt;/span&gt;(nac[vel]&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;(velocityZones[j]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;)  &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt;
                 nac[vel]&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(velocityZones[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;)):
                counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;counts[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
                velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;velocitySum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;nac[vel]
                powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerSum[j]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;power[vel]
                &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(counts&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__()):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;counts[i]):
            &lt;span style=&#34;color:#66d9ef&#34;&gt;continue&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            probability[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;counts[i]&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;nac&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__()
            velocityMean[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;velocitySum[i]&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;counts[i]
            powerMean[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerSum[i]&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;counts[i]
            powerTheory[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getMean(cpVs,cpPs,velocityMean[i])
            AEPActual[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;probability[i]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;powerMean[i]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8760&lt;/span&gt;
            AEPTheory[i]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;probability[i]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;powerTheory[i]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8760&lt;/span&gt;


    k&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(AEPActual)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(AEPTheory)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; probability,velocityMean,powerMean,k




&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;whichZones&lt;/span&gt;(vel,velocityZones,powerZones,zones):
    velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;25.0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;zones
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(zones):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;i):
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;):
                power&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt;(velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;)  &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt;
                    vel&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(velocityZones[i]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;velocityMagnitude&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;) ):
                power &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; powerZones[i]
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; power

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getPowerVelocityBin&lt;/span&gt;(nac,i,zones&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;):
    calPower&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    calVel&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(len(nac),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float)
    count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    [velocityZones,powerZones]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;powerLawIntoZones(zones)
    cps&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame([velocityZones,powerZones])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;T
    cps&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_excel(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;powerVelocityBin&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;zones&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.xlsx&amp;#34;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; vel &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; nac:
        &lt;span style=&#34;color:#75715e&#34;&gt;#calPower[count]=getMean(cpVs,cpPs,vel)&lt;/span&gt;
        calVel[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;vel
        calPower[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;whichZones(modify(vel),velocityZones,powerZones,zones)
        count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame([calVel,calPower])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;T
    calPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(str(i)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-powerBin.csv&amp;#34;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(calPower)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;6000&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# nac8 = velocitySet.iloc[:, 0]&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# power1 = getPower(nac8,0)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# print(power1)&lt;/span&gt;
velocitySet&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_csv(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C:\Users\yezhaoliang\Desktop\nacVelocity.csv&amp;#39;&lt;/span&gt;,skiprows&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
velocityPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_csv(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C:\Users\yezhaoliang\Desktop\vp.csv&amp;#39;&lt;/span&gt;)

kvalues&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;):
    &lt;span style=&#34;color:#75715e&#34;&gt;# nac8 = velocitySet.iloc[:, i]&lt;/span&gt;
    nac8 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; velocityPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, i]
    power8 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; velocityPowerSeries&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:, i&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;]
    [probability,velocitySet,PowerSet,k] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; velocitySeriesSplitIntoZones(nac8,power8,&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;)
    kvalues[i] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; k
    print(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(probability))
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;k value is &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;k&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#power1 = getPower(nac8,i)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    power1 = getPowerVelocityBin(nac8,i,125)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#    print(power1)&lt;/span&gt;
kset&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Series(kvalues)
kset&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;kvalues.csv&amp;#34;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>python制作曲线动画</title>
      <link>https://jueqingsizhe66.github.io/post/python%E5%88%B6%E4%BD%9C%E6%9B%B2%E7%BA%BF%E5%8A%A8%E7%94%BB/</link>
      <pubDate>Sat, 23 Nov 2019 18:50:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/post/python%E5%88%B6%E4%BD%9C%E6%9B%B2%E7%BA%BF%E5%8A%A8%E7%94%BB/</guid>
      <description>&lt;p&gt;动画是一个比较直观的方式展示你的设计过程，下文的codes可以方便按照你规定的点序进行逐点绘制&lt;/p&gt;
&lt;p&gt;编写的步骤如下技术路线图&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/python/hugoAnimation.png&#34; alt=&#34;技术路线&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;text绘制添加增加动画效果&#34;&gt;text绘制添加增加动画效果&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/endlesscoding/p/10308111.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;如何在运动过程中添加背景点text&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;mp4格式导出&#34;&gt;mp4格式导出&lt;/h2&gt;
&lt;p&gt;在Ubuntu或者mac系统可以试用image
注意控制&lt;a href=&#34;https://blog.csdn.net/sailist/article/details/79502007&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ffmpeg&lt;/a&gt;的路径&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## 设置ffmpeg路径&lt;/span&gt;
  ffmpegpath &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;abspath(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./ffmpeg/bin/ffmpeg.exe&amp;#34;&lt;/span&gt;)
  plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rcParams[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;animation.ffmpeg_path&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ffmpegpath
  writer &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; animation&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;FFMpegWriter()
&lt;span style=&#34;color:#75715e&#34;&gt;## 在sava函数中设置执行者&lt;/span&gt;
  anim&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;test_animation.mp4&amp;#39;&lt;/span&gt;,writer&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;writer)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;技术实现&#34;&gt;技术实现&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; plt
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib.animation &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; animation
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; os
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; math

&lt;span style=&#34;color:#75715e&#34;&gt;#fig, ax = plt.subplots()&lt;/span&gt;
fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;))
&lt;span style=&#34;color:#75715e&#34;&gt;#https://blog.csdn.net/xiaosebi1111/article/details/50617433  控制子图&lt;/span&gt;
xdata, ydata &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [], []
ln, &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot([], [], &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;rs&amp;#39;&lt;/span&gt;,animated&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
text_pt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;, fontsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;18&lt;/span&gt;)

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;init&lt;/span&gt;():
    ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_xlim(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;18&lt;/span&gt;)
    ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_ylim(&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ln,

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;update&lt;/span&gt;(frame):
    xdata&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(frame)
    &lt;span style=&#34;color:#75715e&#34;&gt;#ydata.append(np.sin(frame))&lt;/span&gt;
    ydata&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    ln&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_data(xdata, ydata)
    ln&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_markersize(&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ln,
&lt;span style=&#34;color:#75715e&#34;&gt;# 16控制点数&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;update2&lt;/span&gt;(frame):
    xdata&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(frame&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#ydata.append(np.sin(frame))&lt;/span&gt;
    ydata&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(math&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;floor(frame&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;) )
    ln&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_data(xdata, ydata)
    text_pt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_text(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sector=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;frame&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;, VelocityBin=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;math&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;floor(frame&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; )
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ln,text_pt,
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;generateFrames&lt;/span&gt;(rows&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;,cols&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;):
   count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
   dataArray&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;)
   &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(rows):
       dataArray[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;i
       count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(rows):
       &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; j &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(cols&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;):
           dataArray[count]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(j&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;rows&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;i
           count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
   &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; dataArray

&lt;span style=&#34;color:#75715e&#34;&gt;# 16控制点数&lt;/span&gt;
ffmpegpath &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;abspath(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./ffmpeg/bin/ffmpeg.exe&amp;#34;&lt;/span&gt;)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;grid(ls&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;--&amp;#34;&lt;/span&gt;)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tick_params(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;both&amp;#39;&lt;/span&gt;, which&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;major&amp;#39;&lt;/span&gt;, labelsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;18&lt;/span&gt;)
x&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;linspace(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;)
y&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ones(&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(x,y,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;r--&amp;#39;&lt;/span&gt;)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rcParams[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;animation.ffmpeg_path&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ffmpegpath

&lt;span style=&#34;color:#75715e&#34;&gt;##https://blog.csdn.net/sailist/article/details/79502007  ffmpeg路径&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;##https://www.cnblogs.com/endlesscoding/p/10308111.html   改进&lt;/span&gt;
writer &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; animation&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;FFMpegWriter()
&lt;span style=&#34;color:#75715e&#34;&gt;#frames=np.linspace(0,16*25,16*25+1)&lt;/span&gt;
frames&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;generateFrames(&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;)
&lt;span style=&#34;color:#75715e&#34;&gt;#frames=np.linspace(-np.pi,np.pi, 16)&lt;/span&gt;
anim &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; animation&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;FuncAnimation(fig, update2, frames&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;frames,interval&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;,
                    init_func&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;init,blit&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)

&lt;span style=&#34;color:#75715e&#34;&gt;# anim = animation.FuncAnimation(fig, update, frames=np.linspace(-np.pi,np.pi, 16),interval=10,&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#                                init_func=init,blit=True)&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#anim.save(&amp;#39;test_animation.gif&amp;#39;,writer=&amp;#39;imagemagick&amp;#39;)&lt;/span&gt;
anim&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;test_animation.mp4&amp;#39;&lt;/span&gt;,writer&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;writer)
&lt;span style=&#34;color:#75715e&#34;&gt;#plt.show()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;结果展示&#34;&gt;结果展示&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/python/dotSeries.png&#34; alt=&#34;点序结果&#34;&gt;&lt;/p&gt;
&lt;p&gt;小结&lt;/p&gt;
&lt;p&gt;只要修改好update函数，使其根据你设定的frames，就可以得到符合你需要的动画&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>perl批量工作机器程序</title>
      <link>https://jueqingsizhe66.github.io/post/perl%E6%89%B9%E9%87%8F%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%99%A8%E7%A8%8B%E5%BA%8F/</link>
      <pubDate>Sun, 10 Nov 2019 00:20:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/post/perl%E6%89%B9%E9%87%8F%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%99%A8%E7%A8%8B%E5%BA%8F/</guid>
      <description>&lt;h2 id=&#34;背景分析&#34;&gt;背景分析&lt;/h2&gt;
&lt;p&gt;很多时候，我们需要执行一条命令比如`batchFluent.bat`, `cfdpost -batch \*.cse`, `fluent 3d -i batchFluent2000`等， 在执行该命令时候，我们需要打开
cmd或者terminal，然后切换到对应脚本目录，拷贝相应脚本需要的程序，甚是麻烦，可否把这个过程程序化？&lt;/p&gt;
&lt;h2 id=&#34;单个文件处理&#34;&gt;单个文件处理&lt;/h2&gt;
&lt;h3 id=&#34;管道1-转换openfoam结果为msh和dat&#34;&gt;管道1: 转换Openfoam结果为msh和dat&lt;/h3&gt;
&lt;p&gt;通过下面的程序得到一个项目文件相关的msh, 比如YangJiang ,就会得到YangJiang.msh以及YangJiang.dat等， 也就是升华技术，可提取一个技术变量，projectName=&amp;ldquo;YangJiang&amp;rdquo;&lt;/p&gt;
&lt;p&gt;batchFluent.bat(不需要修改!)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;rem 路径相应修改为电脑上的安装文件夹路径
set OPENFOAM_WIN_DIR&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;D:/Program Files &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;x86&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;/AIWind/solver/OpenFOAMv18.06
set WM_PROJECT_DIR&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;%OPENFOAM_WIN_DIR%
set PATH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;%OPENFOAM_WIN_DIR%&lt;span style=&#34;color:#ae81ff&#34;&gt;\b&lt;/span&gt;in;%OPENFOAM_WIN_DIR%&lt;span style=&#34;color:#ae81ff&#34;&gt;\b&lt;/span&gt;in/mpi;%OPENFOAM_WIN_DIR%&lt;span style=&#34;color:#ae81ff&#34;&gt;\l&lt;/span&gt;ib;
set MPI_BUFFER_SIZE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20000000&lt;/span&gt;
rem 将foamDataToFluentDict放入算例&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;oTurbine&lt;span style=&#34;color:#ae81ff&#34;&gt;\1&lt;/span&gt;0.00&lt;span style=&#34;color:#ae81ff&#34;&gt;\0\k&lt;/span&gt;h&lt;span style=&#34;color:#ae81ff&#34;&gt;\s&lt;/span&gt;ystem
rem 转换网格
foamMeshToFluent
rem 转换数据
foamDataToFluent&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;system/foamdatatofluentdict(不需要修改)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;FoamFile
&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
  version     2.0;
  format      ascii;
  note        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;OpenFOAM to Fluent interface control dictionary&amp;#34;&lt;/span&gt;;
  class       dictionary;
  object      foamDataToFluentDict;
&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;

p               1;
U               2;
//T               3;//
//h               4;//
k               5;
epsilon         6;
//alpha1          150;//&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;管道2-转换msh和dat为fluent的cas-and-dat--需要修改&#34;&gt;管道2: 转换msh和dat为fluent的cas and dat(需要修改)&lt;/h3&gt;
&lt;p&gt;YangJiang.msh 和 YangJiang2000.dat和 YangJiang20001.cas得适配，应需进行修正，把这个升级为&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;cx-gui-do cx-activate-item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*ReadSubMenu*Mesh...&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;cx-gui-do cx-set-file-dialog-entries &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Select File&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;( &amp;#34;YangJiang.msh&amp;#34;) &amp;#34;Mesh Files (*.msh* *.MSH* )&amp;#34;)
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;(cx-gui-do cx-activate-item &amp;#34;MenuBar*ReadSubMenu*Data...&amp;#34;)
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;(cx-gui-do cx-set-file-dialog-entries &amp;#34;Select File&amp;#34; &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;YangJiang2000.dat&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Data Files (*.dat* *.pdat* )&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;cx-gui-do cx-activate-item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*WriteSubMenu*Case &amp;amp; Data...&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;cx-gui-do cx-set-file-dialog-entries &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Select File&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;YangJiang20001.cas&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Case/Data Files (*.cas* *.pdat* )&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;cx-gui-do cx-activate-item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*WriteSubMenu*Stop Journal&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;cx-gui-do cx-activate-item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*FileMenu*Exit&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;运行方式为 `fluent 3d -i batchFluent2000`&lt;/p&gt;
&lt;p&gt;由此可得到YangJiang20001.cas和YangJiang20001.dat&lt;/p&gt;
&lt;h3 id=&#34;管道3-提取post结果--需要修改-修改一次-然后进行循环即可&#34;&gt;管道3: 提取post结果(需要修改, 修改一次，然后进行循环即可)&lt;/h3&gt;
&lt;p&gt;然后针对cas和dat进行线信息提取即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;!@processDir&lt;span style=&#34;color:#f92672&#34;&gt;=(&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;;

&lt;span style=&#34;color:#75715e&#34;&gt;################################################&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;## 文件过滤设置&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;################################################&lt;/span&gt;


!$length&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;@processDir; &lt;span style=&#34;color:#75715e&#34;&gt;#get the length of the processDir array&lt;/span&gt;
!for&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;$count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;0;$count&amp;lt;$length;$count++&lt;span style=&#34;color:#f92672&#34;&gt;){&lt;/span&gt;

  !$pathDir &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $processDir&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;$count&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;;
  &lt;span style=&#34;color:#75715e&#34;&gt;#!$file = &amp;#34;huailai20m220001.dat&amp;#34;; ## for 814w and 1425w&lt;/span&gt;
  !$file &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;YangJiang20001.dat&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#75715e&#34;&gt;## for 325w&lt;/span&gt;
  !$currentFilename &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;pathDir&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;//&lt;/span&gt;$file&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;;

  &lt;span style=&#34;color:#75715e&#34;&gt;###   Create output directory&lt;/span&gt;
  !$outputLine&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;forLinesOutput0&amp;#34;&lt;/span&gt;;
  !$outputLineDir&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;pathDir&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;//&lt;/span&gt;$outputLine&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;;
  !if&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;! -e $outputLineDir&lt;span style=&#34;color:#f92672&#34;&gt;){&lt;/span&gt;
    !mkdir $outputLineDir;
    !print &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$outputLineDir&lt;span style=&#34;color:#e6db74&#34;&gt; create successfully!&amp;#34;&lt;/span&gt;;
    !&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;技术分解1-批量后处理openfoam结果到dat格式&#34;&gt;技术分解1&amp;mdash;- 批量后处理Openfoam结果到dat格式&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;准备文件&lt;/li&gt;
&lt;li&gt;链接目录，切换到脚本目录，执行脚本&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;技术实现1&#34;&gt;技术实现1&lt;/h2&gt;
&lt;h3 id=&#34;基础版本--初始版本&#34;&gt;基础版本(初始版本)&lt;/h3&gt;
&lt;p&gt;事先拷贝好需要的文件放在指定位置处,使用system运行系统命令即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         FILE: batchProcess814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        USAGE: ./batchProcess814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#  DESCRIPTION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      OPTIONS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# REQUIREMENTS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         BUGS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        NOTES: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#       AUTHOR: YOUR NAME (),&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# ORGANIZATION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      VERSION: 1.0&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      CREATED: 2019/9/24 11:11:49&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#     REVISION: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; utf8;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Cwd;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $directory   &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\huaiiLaiPP\\AIWindProject1\\noTurbine\\10.00\\&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $specialDirSign&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;22.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;45&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;67.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;112.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;135&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;157.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;180&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;202.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;225&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;247.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;270&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;292.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;315&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;337.5&lt;/span&gt;];


&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $name ( @$specialDirSign ) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $tempdirectory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$directory\\$name\\huailai20m2\\&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#75715e&#34;&gt;#my  $tempBatchFile=sprintf(&amp;#34;$directory\\$name\\huailai20m2\\batchFluent.bat&amp;#34;);&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
    chdir($tempdirectory);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
    system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;batchFluent.bat&amp;#34;&lt;/span&gt;)
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;高级版本&#34;&gt;高级版本&lt;/h3&gt;
&lt;p&gt;让程序在指定的位置自己拷贝需要的文件, 采用&amp;lt;:Copy函数&amp;gt;&lt;/p&gt;
&lt;p&gt;根据目录结构可以进行对应修改&lt;/p&gt;
&lt;h4 id=&#34;下面针对的是不同风速-相同扇区-0扇区-的结果&#34;&gt;下面针对的是不同风速，相同扇区【0扇区】的结果&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;规律：找到noturbine文件夹&lt;/li&gt;
&lt;li&gt;规律：找到项目文件名kh, yandun,YangJiang等&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         FILE: batchProcess814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        USAGE: ./batchProcess814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#  DESCRIPTION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      OPTIONS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# REQUIREMENTS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         BUGS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        NOTES: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#       AUTHOR: YOUR NAME (),&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# ORGANIZATION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      VERSION: 1.0&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      CREATED: 2019/9/24 11:11:49&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#     REVISION: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; utf8;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Cwd;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Copy;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $directory   &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\NewCosMount\\noTurbine\\&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $specialDirSign&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;6.00&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;7.00&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;8.00&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;9.00&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;10.00&amp;#34;&lt;/span&gt;];

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $sourceFileDirs&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\NewCosMount\\noTurbine\\batChProcess\\&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $targetFileSign1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;foamDataToFluentDict&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $targetFileSign2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;batchFluent.bat&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $name ( @$specialDirSign ) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $tempdirectory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$directory\\$name\\0\\kh\\&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
    chdir($tempdirectory);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $dictFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory//system//$targetFileSign1&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $batchFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory//$targetFileSign2&amp;#34;&lt;/span&gt;;
    copy(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$sourceFileDirs\\$targetFileSign1&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$dictFile&amp;#34;&lt;/span&gt;);

    copy(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$sourceFileDirs\\$targetFileSign2&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$batchFile&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
    system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;batchFluent.bat&amp;#34;&lt;/span&gt;)
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;相同风速-不同扇区的结果&#34;&gt;相同风速，不同扇区的结果&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;找到noTurbine文件夹&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/env perl&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#         FILE: batchProcessHuailai814w.pl&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#        USAGE: ./batchProcessHuailai814w.pl&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#  DESCRIPTION:&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#      OPTIONS: ---&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;# REQUIREMENTS: ---&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#         BUGS: ---&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#        NOTES: ---&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#       AUTHOR: YOUR NAME (),&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;# ORGANIZATION:&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#      VERSION: 1.0&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#      CREATED: 2019/11/7 18:47:43&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#     REVISION: ---&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;

  &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; utf8;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Cwd;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Copy;

  &lt;span style=&#34;color:#75715e&#34;&gt;#my  $directory   = &amp;#34;&amp;#34;;&lt;/span&gt;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $directory   &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\YanDun20191106\\yuandun\\noTurbine\\&amp;#34;&lt;/span&gt;;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $specialDirSign&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;22.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;45&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;67.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;112.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;135&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;157.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;180&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;202.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;225&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;247.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;270&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;292.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;315&lt;/span&gt;];

  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $sourceFileDirs&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\huaiiLaiPP\\NewSolverLimit10e9KE\\noTurbine\\10.00\\0\\huailai20m2\\&amp;#34;&lt;/span&gt;;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $targetFileSign1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;foamDataToFluentDict&amp;#34;&lt;/span&gt;;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $targetFileSign2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;batchFluent.bat&amp;#34;&lt;/span&gt;;

  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $projectVelocity&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;10.00&amp;#39;&lt;/span&gt;;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $projectName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;yandun&amp;#34;&lt;/span&gt;;
  &lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $name ( @$specialDirSign ) {
      &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $tempdirectory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$directory\\$projectVelocity\\$name\\$projectName\\&amp;#34;&lt;/span&gt;);
      &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
      chdir($tempdirectory);

      &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
      &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
      &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $dictFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory//system//$targetFileSign1&amp;#34;&lt;/span&gt;;
      &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $batchFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory//$targetFileSign2&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;## bug 修复！&lt;/span&gt;
      copy(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$sourceFileDirs\\system\\$targetFileSign1&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$dictFile&amp;#34;&lt;/span&gt;);

      copy(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$sourceFileDirs\\$targetFileSign2&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$batchFile&amp;#34;&lt;/span&gt;);
      &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
      system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;batchFluent.bat&amp;#34;&lt;/span&gt;);
  }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;技术分解2-批量处理dat文件到post格式&#34;&gt;技术分解2&amp;mdash;-批量处理dat文件到post格式&lt;/h2&gt;
&lt;p&gt;需要执行fluent的journal命令核心是fluent脚本&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;读入msh&lt;/li&gt;
&lt;li&gt;读入dat&lt;/li&gt;
&lt;li&gt;保存cas &amp;amp; dat
具体文件需要修改msh和dat前缀&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;(cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;activate&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*ReadSubMenu*Mesh...&amp;#34;&lt;/span&gt;)
(cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;set&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;file&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;dialog&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;entries &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Select File&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;huailai20m2.msh&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mesh Files (*.msh* *.MSH* )&amp;#34;&lt;/span&gt;)
  (cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;activate&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*ReadSubMenu*Data...&amp;#34;&lt;/span&gt;)
  (cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;set&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;file&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;dialog&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;entries &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Select File&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;huailai20m22000.dat&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Data Files (*.dat* *.pdat* )&amp;#34;&lt;/span&gt;)
  (cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;activate&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*WriteSubMenu*Case &amp;amp; Data...&amp;#34;&lt;/span&gt;)
  (cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;set&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;file&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;dialog&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;entries &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Select File&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;huailai20m220001.cas&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Case/Data Files (*.cas* *.pdat* )&amp;#34;&lt;/span&gt;)
  (cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;activate&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*WriteSubMenu*Stop Journal&amp;#34;&lt;/span&gt;)
  (cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gui&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; cx&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;activate&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;item &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MenuBar*FileMenu*Exit&amp;#34;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;核心命令： `fluent 3d -i batchFluent2000`&lt;/p&gt;
&lt;h2 id=&#34;技术实现2&#34;&gt;技术实现2&lt;/h2&gt;
&lt;h3 id=&#34;相同风速下-不同扇区处理&#34;&gt;相同风速下，不同扇区处理&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         FILE: journalTransferAIWINDTOFluentCasDat814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        USAGE: ./journalTransferAIWINDTOFluentCasDat814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#  DESCRIPTION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      OPTIONS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# REQUIREMENTS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         BUGS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        NOTES: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#       AUTHOR: YOUR NAME (),&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# ORGANIZATION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      VERSION: 1.0&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      CREATED: 2019/9/27 15:43:35&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#     REVISION: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; utf8;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Cwd;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Copy;

&lt;span style=&#34;color:#75715e&#34;&gt;#my  $directory   = &amp;#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&amp;#34;;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $directory &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\huaiiLaiPP\\AIWindProject1\\noTurbine\\10.00\\&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,45,135,270,292.5];&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $sourceFluentBatchFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\90\\huailai20m2\\fluentInterface\\batchFluent2000&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $name ( @$specialDirSign ) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $tempdirectory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$directory\\$name\\huailai20m2\\fluentInterface\\&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $destinationFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\\batchFluent2000&amp;#34;&lt;/span&gt;;

    copy($sourceFluentBatchFile,$destinationFile) &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Copy failed: $!&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#my  $tempBatchFile=sprintf(&amp;#34;$directory\\$name\\huailai20m2\\batchFluent.bat&amp;#34;);&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
    chdir($tempdirectory);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
    system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;fluent 3d -i batchFluent2000&amp;#34;&lt;/span&gt;);
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;快速格式化项目的batchfluent2000&#34;&gt;快速格式化项目的batchFluent2000&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;

&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Slurp &lt;span style=&#34;color:#e6db74&#34;&gt;qw(read_file write_file)&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;#open(FEIJI,&amp;#34;C:\\Users\\yezhaoliang\\Desktop\\probe.cse&amp;#34;) or die &amp;#34;can&amp;#39;t open the file \n&amp;#34;;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#my $car =&amp;#34;@lidarX1&amp;#34;;&lt;/span&gt;


&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $filename &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\\Users\\yezhaoliang\\Desktop\\batchFluent2000&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $projectOld&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;huailai20m2&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $projectNew&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;YangJiang&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; read_file $filename, {binmode &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;};
&lt;span style=&#34;color:#75715e&#34;&gt;## 文件内容替换---- 也可以用IO:All-&amp;gt;slurp函数&lt;/span&gt;

$data &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/$projectOld/$projectNew/g&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;## 删除掉^M&lt;/span&gt;
$data &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/\r//g&lt;/span&gt;;
write_file $filename, {binmode &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;:utf8&amp;#39;&lt;/span&gt;},$data;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;技术升维&#34;&gt;技术升维&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;思考目录结构&lt;/li&gt;
&lt;li&gt;思考要执行命令&lt;/li&gt;
&lt;li&gt;思考命令执行的内容&amp;mdash;可升级对应文件内容的修改&lt;/li&gt;
&lt;li&gt;一个可以生成你需要的可执行程序，并具备普适性!Macro programming&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;附录&#34;&gt;附录&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/lxp90/article/details/76228104&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl单行替换文件内容&lt;/a&gt;(先temp，然后rename到原始文件名，删除temp备份)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/blog%5Fabel/article/details/40589227&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl s替换&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://cn.perlmaven.com/how-to-replace-a-string-in-a-file-with-perl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl slurp&lt;/a&gt;(输入s命令到slurp中，执行！ `cpanm &amp;lt;:Slurp&amp;gt;`)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;:Slurphttps://metacpan.org/pod/File&#34;&gt;File::Slurp&lt;/a&gt; edit_file command file&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Slurp &lt;span style=&#34;color:#e6db74&#34;&gt;qw(edit_file)&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;# perl -0777 -pi -e &amp;#39;s/foo/bar/g&amp;#39; /path/file&lt;/span&gt;
    edit_file { &lt;span style=&#34;color:#e6db74&#34;&gt;s/foo/bar/g&lt;/span&gt; } &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/path/file&amp;#39;&lt;/span&gt;;
    edit_file &lt;span style=&#34;color:#66d9ef&#34;&gt;sub&lt;/span&gt; { &lt;span style=&#34;color:#e6db74&#34;&gt;s/foo/bar/g&lt;/span&gt; }, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/path/file&amp;#39;&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;sub&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;replace_foo&lt;/span&gt; { &lt;span style=&#34;color:#e6db74&#34;&gt;s/foo/bar/g&lt;/span&gt; }
    edit_file &lt;span style=&#34;color:#f92672&#34;&gt;\&amp;amp;&lt;/span&gt;replace_foo, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/path/file&amp;#39;&lt;/span&gt;;
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://blogs.perl.org/users/leon%5Ftimmermans/2015/08/fileslurp-is-broken-and-wrong.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl slurp bugs and unmaintained&lt;/a&gt;  可以选用Slurper, &lt;a href=&#34;https://metacpan.org/pod/Path::Tiny&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Path:Tiny&lt;/a&gt;  or &lt;a href=&#34;https://metacpan.org/pod/IO::All&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Io:ALL&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;path::Tiny   `path(&amp;ldquo;foo.txt&amp;rdquo;)-&amp;gt;move(&amp;ldquo;bar.txt&amp;rdquo;);`&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;简单处理&lt;a href=&#34;https://www.perl.com/pub/2004/03/12/ioall.html/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IO::All&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;虽然slurp废弃了，但发现依然不错文件内容单行处理，所以无法循环，没有if判断等。但可以执行批处理，而IO:All使用
`my $line = $io-&amp;gt;getline` ,其实使用内置的函数即可`while(&amp;lt;$fh&amp;gt;)`即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;         &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
         &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
         &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Slurp &lt;span style=&#34;color:#e6db74&#34;&gt;qw(read_file write_file)&lt;/span&gt;;
         &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $filename &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\\Users\\yezhaoliang\\Desktop\\probe.cse&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;##gbk or gb2312&lt;/span&gt;
         &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; read_file $filename, {binmode &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;gbk&amp;#39;&lt;/span&gt;};
         &lt;span style=&#34;color:#75715e&#34;&gt;## 文件内容替换---- 也可以用IO:All-&amp;gt;slurp函数&lt;/span&gt;
         $data &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/风廓线/小心了/g&lt;/span&gt;;
         &lt;span style=&#34;color:#75715e&#34;&gt;## 删除掉^M&lt;/span&gt;
         $data &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/\r//g&lt;/span&gt;;
         write_file $filename, {binmode &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;:gbk&amp;#39;&lt;/span&gt;},$data;
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;英文替换&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Slurp &lt;span style=&#34;color:#e6db74&#34;&gt;qw(read_file write_file)&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $filename &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\\Users\\yezhaoliang\\Desktop\\probe.cse&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; read_file $filename, {binmode &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;};
    &lt;span style=&#34;color:#75715e&#34;&gt;## 文件内容替换---- 也可以用IO:All-&amp;gt;slurp函数&lt;/span&gt;
    $data &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/lidar/Leida/g&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;## 删除掉^M&lt;/span&gt;
    $data &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/\r//g&lt;/span&gt;;
    write_file $filename, {binmode &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;:utf8&amp;#39;&lt;/span&gt;},$data;
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;回归到原始程序，只用内置函数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;    open(F1,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;test.txt&amp;#39;&lt;/span&gt;);
    open(F2,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;test.txt.tmp&amp;#39;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; ($s&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;F1&amp;gt;&lt;/span&gt;){
        $s &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/1234/ABCD/g&lt;/span&gt;;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; F2, $s;
    }
    close(F2);
    close(F1);

    unlink(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;test.txt&amp;#39;&lt;/span&gt;);
    rename(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;test.txt.tmp&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;test.txt&amp;#39;&lt;/span&gt;);
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其实外置、内置的思路都是open、循环、删除、重命名的过程这样还可以不断拓展，增加判断等。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;elisp通过defmacro生成一个&lt;a href=&#34;https://emacs-china.org/t/elisp/11023/3&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 临时的defvar、defun &lt;/a&gt;等,即生成一个新的状态或者worker&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-elisp&#34;&gt;(defmacro defvar/os (name &amp;amp;rest args)
  `(defvar ,name
     (pcase system-type
       ,@(mapcar (lambda (x)
                   (let ((a (car x))
                         (b (cadr x)))
                     `(,(ecase a
                          (:windows &#39;&#39;windows-nt)
                          (:macos &#39;&#39;darwin))
                       ,b)))
                   (-partition-all 2 args)))))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;增强版的自定义功能&#34;&gt;增强版的自定义功能&lt;/h3&gt;
&lt;p&gt;如果遇到某种条件下的文件则执行对应的修正&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;


&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$input_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;qw&amp;#34;c:\users\yezhaoliang\desktop\probe1.cse&amp;#34;&lt;/span&gt;;

open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $input, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;&amp;#39;&lt;/span&gt;, $input_file_name
    &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;


&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$output_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;qw&amp;#34;c:\users\yezhaoliang\desktop\probe2.cse&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#75715e&#34;&gt;# output file name&lt;/span&gt;

open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $output, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, $output_file_name
    &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;


&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $line&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;$input&amp;gt;&lt;/span&gt;){

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (  $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/(^!\@processDir=)/xm&lt;/span&gt;) {
        $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/(^!\@processDir=)/$1She/g&lt;/span&gt;;
    }
    &lt;span style=&#34;color:#66d9ef&#34;&gt;elsif&lt;/span&gt; (   $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/(^!\$file\s=\s&amp;#34;(.*)&amp;#34;)/xm&lt;/span&gt; ) {
        $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/$2/hello.dat/g&lt;/span&gt;;
    }
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; $output $line;
}


close  $output
    &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
close  $input
    &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;案例1-批量修改batchfluent2000-替换-然后执行-完美版&#34;&gt;案例1：批量修改batchFluent2000、替换 然后执行【完美版】&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;修改&lt;/li&gt;
&lt;li&gt;执行&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; utf8;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Cwd;

&lt;span style=&#34;color:#75715e&#34;&gt;#my  $directory   = &amp;#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&amp;#34;;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $directory &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $specialDirSign&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;22.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;45&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;67.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;112.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;135&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;157.5&lt;/span&gt;];
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,45,135,270,292.5];&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $sourceFluentBatchFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\batchFluent2000&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $oldProjectName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Huailai20m2&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $projectName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;YangJiang&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $name ( @$specialDirSign ) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $tempdirectory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$directory\\$name\\$projectName\\fluentInterface\\&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $destinationFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\\batchFluent2000&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$input_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $sourceFluentBatchFile;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $input, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;&amp;#39;&lt;/span&gt;, $input_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$output_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\\batchFluent2000&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#75715e&#34;&gt;# output file name&lt;/span&gt;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $output, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, $output_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $line&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;$input&amp;gt;&lt;/span&gt;){

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/$oldProjectName/xm&lt;/span&gt;) {
            &lt;span style=&#34;color:#75715e&#34;&gt;## 要求1&lt;/span&gt;
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/$oldProjectName/$projectName/gm&lt;/span&gt;
        }
        &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; $output $line;
    }

    close  $output
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    close  $input
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;


    &lt;span style=&#34;color:#75715e&#34;&gt;#copy($sourceFluentBatchFile,$destinationFile) or die &amp;#34;Copy failed: $!&amp;#34;;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#my  $tempBatchFile=sprintf(&amp;#34;$directory\\$name\\huailai20m2\\batchFluent.bat&amp;#34;);&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
    chdir($tempdirectory);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
    system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;fluent 3d -i batchFluent2000&amp;#34;&lt;/span&gt;);
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;案例2-批量修改probelinesandexport-dot-cse-替换-然后执行-完美版&#34;&gt;案例2：批量修改probelinesAndexport.cse、替换 然后执行【完美版】&lt;/h3&gt;
&lt;p&gt;原先是使用copy命令，现在完全用perl程序，控制不同扇区或者速度的修正，并更新到对应文件后，写入到具体目录， 最终执行即可!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;修改&lt;/li&gt;
&lt;li&gt;执行&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Cwd;

&lt;span style=&#34;color:#75715e&#34;&gt;#my  $directory   = &amp;#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&amp;#34;;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $directory &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $specialDirSign&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;22.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;45&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;67.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;112.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;135&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;157.5&lt;/span&gt;];
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,45,135,270,292.5];&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $projectName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;YangJiang&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $sourceFluentBatchFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\probeLinesAndExportYangJiang.cse&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $Sectorname ( @$specialDirSign ) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $tempdirectory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$directory\\$Sectorname\\$projectName\\fluentInterface\\&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$input_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $sourceFluentBatchFile;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $input, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;&amp;#39;&lt;/span&gt;, $input_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$output_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\\probelinesAndExport.cse&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#75715e&#34;&gt;# output file name&lt;/span&gt;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $output, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, $output_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $line&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;$input&amp;gt;&lt;/span&gt;){

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/(^!\@processDir=\(&amp;#34;(.*)&amp;#34;\))/xm&lt;/span&gt;) {
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;!\@processDir=\&amp;#34;$tempdirectory\&amp;#34;;&amp;#34;&lt;/span&gt;);
            &lt;span style=&#34;color:#75715e&#34;&gt;## 要求1&lt;/span&gt;
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/\\/\\\\/gxm&lt;/span&gt;
        }
        &lt;span style=&#34;color:#66d9ef&#34;&gt;elsif&lt;/span&gt; (  $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/(^!\$file\s=\s&amp;#34;(.*)&amp;#34;)/xm&lt;/span&gt; ) {
            &lt;span style=&#34;color:#75715e&#34;&gt;## 规律&lt;/span&gt;
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/$2/${projectName}20001.dat/xg&lt;/span&gt;;
        }
        &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; $output $line;
    }

    close  $output
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    close  $input
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;#copy($sourceFluentBatchFile,$destinationFile) or die &amp;#34;Copy failed: $!&amp;#34;;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#my  $tempBatchFile=sprintf(&amp;#34;$directory\\$name\\huailai20m2\\batchFluent.bat&amp;#34;);&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
    chdir($tempdirectory);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system(&amp;#34;fluent 3d -i batchFluent2000&amp;#34;);&lt;/span&gt;
    system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cfdpost -batch probeLinesAndExport.cse&amp;#34;&lt;/span&gt;);
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;上述两个过程案例1-2可以合并&#34;&gt;上述两个过程案例1、2可以合并&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;确定处理哪个case, 烟墩? 怀来? 东平?&lt;/li&gt;
&lt;li&gt;确定源文件是否存在! 原先的BatchFluent2000和cse文件在？&lt;/li&gt;
&lt;/ol&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         FILE: journalTransferAIWINDTOFluentCasDat814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        USAGE: ./journalTransferAIWINDTOFluentCasDat814w.pl&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#  DESCRIPTION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      OPTIONS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# REQUIREMENTS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#         BUGS: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#        NOTES: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#       AUTHOR: YOUR NAME (),&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# ORGANIZATION:&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      VERSION: 1.0&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#      CREATED: 2019/9/27 15:43:35&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#     REVISION: ---&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#===============================================================================&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; strict;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; warnings;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; utf8;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Cwd;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; File::Copy;

&lt;span style=&#34;color:#75715e&#34;&gt;#my  $directory   = &amp;#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&amp;#34;;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $directory &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $specialDirSign&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;22.5&lt;/span&gt;];
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $specialDirSign=[0,45,135,270,292.5];&lt;/span&gt;

&lt;span style=&#34;color:#75715e&#34;&gt;## 确认文件是否存在&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $sourceFluentBatchFileStep2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\batchFluent2000&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#75715e&#34;&gt;## 确认文件是否存在&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $sourceFluentBatchFileStep3&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\probeLinesAndExportYangJiang.cse&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#75715e&#34;&gt;## step1&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $sourceFileDirs&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $targetFileSign1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;foamDataToFluentDict&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $targetFileSign2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;batchFluent.bat&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $projectVelocity&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;10.00&amp;#39;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $projectName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;YangJiang&amp;#34;&lt;/span&gt;;

&lt;span style=&#34;color:#75715e&#34;&gt;## step2&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $oldProjectName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Huailai20m2&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#75715e&#34;&gt;#my  $projectName=&amp;#34;YangJiang&amp;#34;;&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $name ( @$specialDirSign ) {


    &lt;span style=&#34;color:#75715e&#34;&gt;###########################STEP 2 ###########################&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $tempdirectory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$directory\\$name\\$projectName\\fluentInterface\\&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $destinationFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\\batchFluent2000&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$input_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $sourceFluentBatchFileStep2;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $input, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;&amp;#39;&lt;/span&gt;, $input_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$output_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\\batchFluent2000&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#75715e&#34;&gt;# output file name&lt;/span&gt;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $output, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, $output_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $line&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;$input&amp;gt;&lt;/span&gt;){

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/$oldProjectName/xm&lt;/span&gt;) {
            &lt;span style=&#34;color:#75715e&#34;&gt;## 要求1&lt;/span&gt;
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/$oldProjectName/$projectName/gm&lt;/span&gt;
        }
        &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; $output $line;
    }

    close  $output
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    close  $input
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;


    &lt;span style=&#34;color:#75715e&#34;&gt;#copy($sourceFluentBatchFile,$destinationFile) or die &amp;#34;Copy failed: $!&amp;#34;;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#my  $tempBatchFile=sprintf(&amp;#34;$directory\\$name\\huailai20m2\\batchFluent.bat&amp;#34;);&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
    chdir($tempdirectory);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
    system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;fluent 3d -i batchFluent2000&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#75715e&#34;&gt;###########################STEP 2 ###########################&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;###########################STEP 3 ###########################&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$input_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $sourceFluentBatchFileStep3;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $input, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;&amp;#39;&lt;/span&gt;, $input_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;	$output_file_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\\probelinesAndExport.cse&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#75715e&#34;&gt;# output file name&lt;/span&gt;
    open  &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $output, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, $output_file_name
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; die  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to open  output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $line&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;$input&amp;gt;&lt;/span&gt;){

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/(^!\@processDir=\(&amp;#34;(.*)&amp;#34;\))/xm&lt;/span&gt;) {
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sprintf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;!\@processDir=\&amp;#34;$tempdirectory\&amp;#34;;&amp;#34;&lt;/span&gt;);
            &lt;span style=&#34;color:#75715e&#34;&gt;## 要求1&lt;/span&gt;
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/\\/\\\\/gxm&lt;/span&gt;
        }
        &lt;span style=&#34;color:#66d9ef&#34;&gt;elsif&lt;/span&gt; (  $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;m/(^!\$file\s=\s&amp;#34;(.*)&amp;#34;)/xm&lt;/span&gt; ) {
            &lt;span style=&#34;color:#75715e&#34;&gt;## 规律&lt;/span&gt;
            $line &lt;span style=&#34;color:#f92672&#34;&gt;=~&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;s/$2/${projectName}20001.dat/xg&lt;/span&gt;;
        }
        &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; $output $line;
    }

    close  $output
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close output file &amp;#39;$output_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;
    close  $input
        &lt;span style=&#34;color:#f92672&#34;&gt;or&lt;/span&gt; warn &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$0 : failed to close input file &amp;#39;$input_file_name&amp;#39; : $!\n&amp;#34;&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;#copy($sourceFluentBatchFile,$destinationFile) or die &amp;#34;Copy failed: $!&amp;#34;;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#my  $tempBatchFile=sprintf(&amp;#34;$directory\\$name\\huailai20m2\\batchFluent.bat&amp;#34;);&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$tempdirectory\n&amp;#34;&lt;/span&gt;;
    chdir($tempdirectory);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt;  $mypath&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;getcwd();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Temp Director: -----------&amp;gt; $mypath\n&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system($tempBatchFile)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#system(&amp;#34;fluent 3d -i batchFluent2000&amp;#34;);&lt;/span&gt;
    system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cfdpost -batch probeLinesAndExport.cse&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#75715e&#34;&gt;###########################STEP 3 ###########################&lt;/span&gt;

}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>玩转python datetime</title>
      <link>https://jueqingsizhe66.github.io/post/%E7%8E%A9%E8%BD%ACpython-datetime/</link>
      <pubDate>Wed, 06 Nov 2019 18:44:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/post/%E7%8E%A9%E8%BD%ACpython-datetime/</guid>
      <description>&lt;h2 id=&#34;背景介绍&#34;&gt;背景介绍&lt;/h2&gt;
&lt;p&gt;需要把文本数据格式的时间转变为空格划分的时间信息，见下图
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/aiwind/t1.png&#34; alt=&#34;功能实现&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;技术分解&#34;&gt;技术分解&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;提取时间信息&lt;/li&gt;
&lt;li&gt;字符串处理，头信息组装&lt;/li&gt;
&lt;li&gt;datetime格式转变，运用&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;技术实现&#34;&gt;技术实现&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd

    &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;time
    csvFile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\Users\yezhaoliang\Desktop\ew.csv&amp;#34;&lt;/span&gt;

    csvData&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_csv(csvFile,skiprows&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

    &lt;span style=&#34;color:#75715e&#34;&gt;# print(csvData.iloc[1,0])&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# a=csvData.iloc[1,0]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# print(a)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# timeArray = time.strptime(a, &amp;#34;%Y%m%d %H:%M:%S&amp;#34;)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# print(timeArray[1])&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# print(csvDatum)&lt;/span&gt;
    versionName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;version&amp;#39;&lt;/span&gt;
    versionNumber&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;01&amp;#39;&lt;/span&gt;
    sitename&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;site name&amp;#39;&lt;/span&gt;
    measureTimeName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;measure period&amp;#39;&lt;/span&gt;
    siteposName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;site position&amp;#39;&lt;/span&gt;
    coorName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;coordinate system&amp;#39;&lt;/span&gt;
    measureHeightName&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;measurement height&amp;#39;&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;### 必须填对测风塔位置！&lt;/span&gt;
    sitePositionX&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;20379022.37&amp;#39;&lt;/span&gt;
    sitePositionY&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;4475481.11&amp;#39;&lt;/span&gt;
    bakFile &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; open(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./testOutput2.tws&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;)
  &lt;span style=&#34;color:#75715e&#34;&gt;## 用于字符串的填充！打印效果好看些&lt;/span&gt;
    NameListLength&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;
    earlistDay&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;csvData&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
    earlistDate &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strptime(earlistDay, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;%Y%m&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%d&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; %H:%M:%S&amp;#39;&lt;/span&gt;)
    latestDay&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;csvData&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[len(csvData)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
    latestDate &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strptime(latestDay, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;%Y%m&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%d&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; %H:%M:%S&amp;#39;&lt;/span&gt;)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;versionName&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ljust(NameListLength,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;versionNumber&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;sitename&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ljust(NameListLength,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;: Tower_wind_&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;earlistDate&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;year&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;04&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}{&lt;/span&gt;earlistDate&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;month&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}{&lt;/span&gt;earlistDate&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;day&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;
          &lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;-&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;latestDate&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;year&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;04&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}{&lt;/span&gt;latestDate&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;month&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}{&lt;/span&gt;latestDate&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;day&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.tim&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;measureTimeName&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ljust(NameListLength,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;earlistDate&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%m/%d/%Y %H:%M&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;latestDate&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%m/%d/%Y %H:%m&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;siteposName&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ljust(NameListLength,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;sitePositionX&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;sitePositionY&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;coorName&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ljust(NameListLength,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;: 3&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;measureHeightName&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ljust(NameListLength,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;: 90.0&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;rec nr:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;year:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;mon:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;date:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;hour:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;min:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;dir:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;speed:&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
&lt;span style=&#34;color:#75715e&#34;&gt;###正式打入需要的数据&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(csvData)):
        a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; csvData&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[i, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
        direction &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; csvData&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[i, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
        velocity &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; csvData&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[i, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]
        d1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;datetime&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strptime(a, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;%Y%m&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%d&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; %H:%M:%S&amp;#39;&lt;/span&gt;)
        print(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;i&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;d1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;year&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;04&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;d1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;month&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;d1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;day&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;d1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;hour&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;d1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;minute&lt;span style=&#34;color:#e6db74&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;02&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;direction&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;velocity&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;bakFile)
    bakFile&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;close()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;附录&#34;&gt;附录&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csdn.net/qq%5F35711912/article/details/80477950&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;补全字符串&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csdn.net/sunxb10/article/details/81036693&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Python格式化字符串f-string概览&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://segmentfault.com/a/1190000010310346&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;输出print信息到文件&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>python pandas数据结构转化</title>
      <link>https://jueqingsizhe66.github.io/post/python-pandas%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%BD%AC%E5%8C%96/</link>
      <pubDate>Sat, 02 Nov 2019 00:44:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/post/python-pandas%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%BD%AC%E5%8C%96/</guid>
      <description>&lt;h2 id=&#34;背景介绍&#34;&gt;背景介绍&lt;/h2&gt;
&lt;p&gt;windsim已经导出所有机位点的风速风向，每个机组都有16个扇区的风速和风向信息(轮毂高度处)&lt;/p&gt;
&lt;p&gt;同时你还有fluent或者AIWIND一个扇区的CFD结果, 一个excel表包含所有机组的信息，每个机组的速度廓线放在一个sheet表中, 为了提取对应轮毂高度处的信息，&lt;/p&gt;
&lt;p&gt;AIWIND或者fluent计算得到的一个方向的速度廓线计算结果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/aiwind/dongping.png&#34; alt=&#34;dongping&#34;&gt;&lt;/p&gt;
&lt;p&gt;前面我们已经使用&lt;a href=&#34;https://jueqingsizhe66.github.io/post/python%E5%AF%B9%E6%AF%94%E4%BD%9C%E5%9B%BE%E4%B8%A4%E4%B8%AA%E9%A3%8E%E9%80%9F%E9%A3%8E%E5%90%91%E8%A1%A8/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; python对比作图 &lt;/a&gt;,可在此基础上
进行技术分解优化！&lt;/p&gt;
&lt;h2 id=&#34;技术分解&#34;&gt;技术分解&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;访问windsim的speed table&lt;/li&gt;
&lt;li&gt;遍历AIWIND或者fluent速度廓线得到的所有机位点的sheet，并选取90m高度处，存放入新的表中&lt;/li&gt;
&lt;li&gt;转化pandas的Series和list，方便实用index函数&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;技术实现&#34;&gt;技术实现&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; os
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; plt

&lt;span style=&#34;color:#75715e&#34;&gt;## 注意需要有windsim各个扇区的数据&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#fileReadyAnalysis=r&amp;#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation45.xlsx&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#fileReadyAnalysis=r&amp;#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation0.xlsx&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;## Sector: 0 22 45 67 90 112 135 157 180 202 247 270 292 315 337&lt;/span&gt;
plotSector&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;## AIWIND导出的数据需要汇总&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#fileReadyAnalysis=r&amp;#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation&amp;#34;+plotSector+&amp;#34;.xlsx&amp;#34;&lt;/span&gt;
aiwindfileReadyAnalysis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing\Results-newSimulation&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;plotSector&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.xlsx&amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; __name__ &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;:
    accordingTable &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C1566&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C2738&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C2742&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C3284&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C4179&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C4182&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K01&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K02&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K03&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K04&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K05&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K06&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K07&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K08&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K09&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K10&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X1&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X2&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X3&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X4&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X5&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X6&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X7&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X8&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X9&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X10&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X11&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X12&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X13&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X14&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X15&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X16&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X17&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X18&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X19&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X20&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X21&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X22&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X23&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X24&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X25&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X26&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X27&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X28&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X29&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X30&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X31&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X32&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X33&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X34&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X35&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X36&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X37&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X38&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X40&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X41&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X42&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X43&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X44&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X45&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X46&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X47&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X48&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X49&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X50&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X51&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X52&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X53&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X54&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X55&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X56&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X57&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X58&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X59&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X60&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X61&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X62&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X63&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X64&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X65&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X66&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X67&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X68&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X69&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X70&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X71&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X72&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X73&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X74&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X75&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X76&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X77&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X78&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X79&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X80&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X81&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X82&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X83&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X84&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X85&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X86&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X87&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X88&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X89&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X90&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X91&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X92&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X93&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X94&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X95&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X96&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X97&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X98&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X99&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X100&amp;#34;&lt;/span&gt;]
    x_axisChange &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C1566&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C2738&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C2742&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C3284&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C4179&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C4182&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K01&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K02&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K03&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K04&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K05&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K06&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K07&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K08&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K09&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;K10&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;5&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;6&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;7&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;8&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;9&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;10&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;11&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;12&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;13&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;14&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;15&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;16&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;17&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;18&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;19&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;20&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;21&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;22&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;23&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;24&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;25&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;26&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;27&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;28&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;29&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;30&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;32&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;33&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;34&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;35&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;36&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;37&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;38&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;40&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;41&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;42&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;43&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;44&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;45&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;46&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;47&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;48&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;49&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;50&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;52&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;53&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;54&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;55&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;56&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;57&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;58&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;59&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;60&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;61&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;62&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;63&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;64&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;65&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;66&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;67&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;68&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;69&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;70&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;71&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;72&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;73&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;74&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;75&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;76&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;77&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;78&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;79&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;80&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;81&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;82&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;83&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;84&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;85&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;86&amp;#34;&lt;/span&gt;,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;87&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;88&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;89&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;90&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;91&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;92&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;93&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;94&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;95&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;96&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;97&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;98&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;99&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;100&amp;#34;&lt;/span&gt;];

    windSimspeedTable&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing\ResultsDongPingSpeedTable.csv&amp;#39;&lt;/span&gt;
    speedTableData&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_csv(windSimspeedTable)
    indexMe&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[x &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; speedTableData&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]]
    &lt;span style=&#34;color:#75715e&#34;&gt;# b = pd.read_excel(fileReadyAnalysis,None)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# sheetnames=b.keys()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# sheetvalues=b.values()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#hubVelocities=np.zeros(sheetvalues.__len__())&lt;/span&gt;

    xlsxAiwind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ExcelFile(aiwindfileReadyAnalysis)
    turbines&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Series([&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;accordingTable&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__())
    turbineVelocity&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Series([&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;accordingTable&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__(),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;float&amp;#39;&lt;/span&gt;)
    windSimVelocity&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Series([&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;accordingTable&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__len__(),dtype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;float&amp;#39;&lt;/span&gt;)
    count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;## 读取通过程序汇总的各个扇区的数据(各个机位点存储在相应sheet表中&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; sheetname &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; xlsxAiwind&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sheet_names:
        pdtemp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;xlsxAiwind&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;parse(sheetname)
        &lt;span style=&#34;color:#75715e&#34;&gt;#print(pdtemp.iloc[5:20,2])&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#linreg = LinearRegression()&lt;/span&gt;

        newCount&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;accordingTable&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;index(sheetname[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:])
        newCountST&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;indexMe&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;index(sheetname[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;_Velocity&amp;#34;&lt;/span&gt;)
        turbines[newCount]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;sheetname[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:]
        windSimVelocity[newCount]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; speedTableData&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[newCountST,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]

        &lt;span style=&#34;color:#75715e&#34;&gt;## 机位点名字&lt;/span&gt;
        print(sheetname[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;])
        &lt;span style=&#34;color:#75715e&#34;&gt;## 数据提取  AIWIND  单个扇区下的处理&lt;/span&gt;
        text1&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pdtemp&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]
        text2&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pdtemp&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]
        iMax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[i &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(text1)) &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; text1[i]&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;]

        neededIndex&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;iMax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
        neededIndexSmaller&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;iMax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
        smallZ&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;text1[neededIndexSmaller]
        smallV&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;text2[neededIndexSmaller]

        bigZ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; text1[neededIndex]
        bigV &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; text2[neededIndex]
       &lt;span style=&#34;color:#75715e&#34;&gt;# yi=[y for y in pdtemp.iloc[0:100,1]]&lt;/span&gt;
       &lt;span style=&#34;color:#75715e&#34;&gt;# linreg.fit(pdtemp.iloc[5:20,2], pdtemp.iloc[5:20,1])&lt;/span&gt;
        hub_height&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;
        velocityPredict&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(bigV&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;smallV)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(bigZ&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;smallZ)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(hub_height&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;smallZ)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;smallV
&lt;span style=&#34;color:#75715e&#34;&gt;#        velocityPredict= linreg.predict(hub_height)&lt;/span&gt;
        print(velocityPredict)
        turbineVelocity[newCount]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;velocityPredict
        count&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;count&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    df&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;concat([turbines,turbineVelocity,windSimVelocity],axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#df.to_excel(&amp;#39;hello45.xlsx&amp;#39;)&lt;/span&gt;
    df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_excel(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;plotSector&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.xlsx&amp;#39;&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;# speeTableSeries=pd.Series(speedTableData.values())&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# tempArray=pd.concat(turbineVelocity[0:23],speeTableSeries)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#temp1=[x for x in speedTableData]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#temp2=[y for y in turbineVelocity]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#tempArray=[temp1,temp2]&lt;/span&gt;
    aiwindYaxis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; turbineVelocity
    windsimYaxis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;windSimVelocity
    &lt;span style=&#34;color:#75715e&#34;&gt;#ylimMax=max(tempArray[1])&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#ylimMin=min(tempArray[1])&lt;/span&gt;

    ylimMax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;
    ylimMin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# 开始画图&lt;/span&gt;

    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;figure(figsize &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;))
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;title(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Sector-&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;plotSector&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39; Analysis&amp;#39;&lt;/span&gt;,fontsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;32&lt;/span&gt; )
    &lt;span style=&#34;color:#75715e&#34;&gt;#plt.plot(x_axix, aiwindYaxis, marker=&amp;#39;o&amp;#39;, color=&amp;#39;black&amp;#39;, label=&amp;#39;AIWIND&amp;#39;)&lt;/span&gt;
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(x_axisChange, aiwindYaxis, marker&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;o&amp;#39;&lt;/span&gt;,markersize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;9&amp;#39;&lt;/span&gt;, color&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;,markerfacecolor&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;grey&amp;#39;&lt;/span&gt;,markeredgecolor&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;,linestyle&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;solid&amp;#39;&lt;/span&gt;, label&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;AIWIND&amp;#39;&lt;/span&gt;,linewidth&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#plt.plot(sub_axix, test_acys,marker=&amp;#39;*&amp;#39;, color=&amp;#39;red&amp;#39;, label=&amp;#39;testing accuracy&amp;#39;)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#plt.plot(x_axix, windsimYaxis,marker=&amp;#39;*&amp;#39;, color=&amp;#39;blue&amp;#39;, label=&amp;#39;WindSiM&amp;#39;)&lt;/span&gt;
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(x_axisChange, windsimYaxis,marker&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;,markersize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;9&amp;#39;&lt;/span&gt;, color&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;,markerfacecolor&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;grey&amp;#39;&lt;/span&gt;,markeredgecolor&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;,label&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;WindSiM&amp;#39;&lt;/span&gt;,linewidth&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#plt.plot(x_axix, thresholds, color=&amp;#39;blue&amp;#39;, label=&amp;#39;threshold&amp;#39;)&lt;/span&gt;
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;legend()  &lt;span style=&#34;color:#75715e&#34;&gt;# 显示图例&lt;/span&gt;
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;margins(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;grid()
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ylim(ylimMin&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,ylimMax&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;xlabel(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Turbine Names&amp;#39;&lt;/span&gt;,fontsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;24&lt;/span&gt; )
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ylabel(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Velocity&amp;#39;&lt;/span&gt;,fontsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;24&lt;/span&gt; )
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tick_params(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;both&amp;#39;&lt;/span&gt;,which&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;major&amp;#39;&lt;/span&gt;,labelsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;24&lt;/span&gt;)
    plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;savefig(&lt;span style=&#34;color:#e6db74&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing\Velocity-test&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;plotSector&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.jpg&amp;#34;&lt;/span&gt;,dpi &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;900&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>阅读source Code of My World</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/08/13/yue-du-source-code-of-my-world/</link>
      <pubDate>Sun, 13 Aug 2017 22:15:41 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/08/13/yue-du-source-code-of-my-world/</guid>
      <description>&lt;p&gt;识贤者，戒游戏，做贡献，时而等闲,工程化行之。&lt;/p&gt;
&lt;h1 id=&#34;贤者&#34;&gt;贤者&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;可以读读有智慧的朋友 &lt;a href=&#34;http://home.wangjianshuo.com/cn/cat_aecccc.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 王建硕 &lt;/a&gt;(比如很多话都是&lt;a href=&#34;http://home.wangjianshuo.com/cn/20090307_aeaecaeaeec.htm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 你以为，我以为更加接近现实,奥巴马也曾经以为 &lt;/a&gt;,当知道 了太多的你以为之后，你才能成长，成熟地感受痛苦。所以最应该送上&lt;a href=&#34;http://www.huzheng.org/geniusreligion/TheSourceCodeOfMyWorld.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 批斗场 &lt;/a&gt;的词语应该是”以为”) When thinking changes your mind, that’s philosophy. When God changes your mind, that’s faith. When facts change your mind, that’s science.
That’s the soul of &lt;a href=&#34;https://www.edge.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; edge.org &lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;去&lt;a href=&#34;https://www.edge.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; edge.org &lt;/a&gt;看看thinking(比如 &lt;a href=&#34;https://www.edge.org/conversation/tania_lombrozo-learning-by-thinking&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 解释的力量 &lt;/a&gt; ) 大项目(一个项目，具有独特性、渐进明细行、临时性，最终得到一个产品、成果、服务)和
小项目智慧 参加体检的时候，会有很多项目要进行，而先排队做花时间长的大项目的人会最先体检完，
因为等你把大项目做完，再去进行小项目的时候，你会发现小项目早空了，没人排队了，而
那些先排队做小项目的人现在正排着比你开始更长的队伍进行着大项目的体检，所以你轻松
检查完小项目就可以先走了。去游乐园玩也是这样， 上午先排队玩大项目会是最优的选择，
因为虽然一开始排大项目的人会很多，但你会发现到了下午，排大项目的人的队伍会变得更
长，而那些小项目已经基本没什么人排队了，这样你轻松就最先玩完了大多数想玩的项目。
人生的学习排队也会是有这样的最佳策略，年轻的时候先把那些要花四五年时间才能精通的
大项目做完（比如Linux操作系统，软件开发技术），再去学习着装打扮这些几个月就能学
会的小项目，你就会最先达到你的人生目标了。而那些开始没学大项目的人，青春过后，会
发现再就很难拿出四五年的时间去学习大项目了，而他/她们以前学的那些小项目，别人会
很快也学会，而且因为别人有了坚实的基础，会做得比他/她们更 好。这就是抓住重点先进
行突破的秘诀了。就像往罐子里装石头和沙子一样，先放大石子，再灌沙子会充实得很满，
而先装沙子再放石头就会有很多空隙不能填满了，而且有的石头也就再也放不进去了。可见，
人生的学习排队策略也应该这样安排，这样才是有智慧的体现&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://mindhacks.cn/2008/07/07/the-importance-of-knowing-why/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Top-down &lt;/a&gt;思想(书读厚)和Bottom-up(书读薄)深入思想,and recursive the procedure in your life(life is one book)，去理解&lt;a href=&#34;http://blog.csdn.net/pongba/article/details/2412144&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 思考的背后 &lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;跨情境运用：思维法则也是知识记忆，是问题解决策略。既然是记忆，就受到提取线索的制约，
这就是为什么当波利亚告诉你要“注意未知数”之后你还是不能真正在所有需要你“注意未知数”
的地方都能提醒自己“注意未知数”。很多时候未知数是很隐蔽的，未知数并不会总是头顶一个
大帽子上面写着“我是未知数”。所以很多时候缺乏对这个策略的“提醒”线索，这也是为什么你
学会了在解决数学问题的时候“注意未知数”却不一定能在解决现实生活中的问题中时刻都能
“注意你的未知数”（《你的灯亮着吗？》整本书的价值便在于此）

&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;游戏&#34;&gt;游戏&lt;/h1&gt;
&lt;p&gt;游戏的乐趣，而致瘾，则是对快乐的超前消费、透支消费，不得不说游戏的虚拟社会由对抗、暴力和欲望主宰，玩家们因此急功近利、恩怨分明、派系林立、残酷冷漠，模拟人物的性格弱点。所谓爽，很High，只不过是提前消费快乐罢了，从第二天的疲劳你就会了解得到。就像办了信用卡，可以提前消费，但并不是增加了你的财富。如果随意刷卡，或者太过度玩乐，就 会导致麻烦(由浪费而产生缺乏)，而得不偿失&lt;/p&gt;
&lt;p&gt;#贡献&lt;/p&gt;
&lt;p&gt;万事即使无回报也得多做点贡献。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;
比如历史上有一个伟大的发明家（或许是最伟大的发明家之一），却鲜为人知。他就是
Nikola Tesla。他发现或者开发了一系列伟大创新的基础技术，从无线电信号传输，到交流
电，从特斯拉变压器到X光，荧光灯直到现代电网。他和爱迪生一起工作，却相比之下，却
回报寥寥。不但老年穷困潦倒，也很少有人听说过他。1943年，这位为人类迎来电力时代
的天才去世的时候，身边只有几只他捡来的病鸽子
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;等闲&#34;&gt;等闲&lt;/h1&gt;
&lt;p&gt;等闲，让自己有一些时间来让内心寂静, 等闲也是你的&lt;a href=&#34;http://mindhacks.cn/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 暗时间 &lt;/a&gt;,带着你关心的问题进行思考。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;
寂静指的不是外部环境，而是人的内心。渴望智慧、力量或者任何取得不朽成就的人，都会
在内在世界中找到这些。内在世界会不断为你揭示各样的奥秘。那些粗心 大意的人可能会
认为，“寂静”非常简单而且容易实现,所以要记住，只有在绝对寂静的状态下，你才能够触摸
到神本身，才能领悟到永恒不变的法则并且受益。
怎样获取智慧？ 集中精神；它将为你开启智慧之门，智慧来源于内在
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;工程&#34;&gt;工程&lt;/h1&gt;
&lt;p&gt;一个工程一个项目的去干，书要干，也要写！多书则书呆，少书则没文化，书在古代也有写的意思。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>What Vim Teaches You?</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/08/13/what-vim-teaches-you/</link>
      <pubDate>Sun, 13 Aug 2017 17:35:21 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/08/13/what-vim-teaches-you/</guid>
      <description>&lt;p&gt;vim真正教会了你什么？&lt;/p&gt;
&lt;p&gt;vim带给你激情，也给了你生活的智趣，从一开始你练习&lt;a href=&#34;http://yannesposito.com/Scratch/en/blog/Learn-Vim-Progressively/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Learn-vim-progressively &lt;/a&gt;,并且现在还在练习macro和vim’s text object. 也在不断的学习marks and tags思想，让生活轨迹有迹可循，你使用CtrlSpace来保证你的workspace保存下来，并切换文件和buffer； 随着知识的增长，你使用vimwiki来管理你的知识，并结合&lt;a href=&#34;https://github.com/mattn/calendar-vim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; calendar &lt;/a&gt;在vimwiki来管理你的日记。为了让文件查找，文件编辑更加方便，
你使用 &lt;a href=&#34;https://github.com/Shougo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; shoudo &lt;/a&gt;的&lt;a href=&#34;https://github.com/Shougo/vimfiler.vim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vimfiles &lt;/a&gt;来增强你的vim，使得你的vim变得更像一把瑞士军刀。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Ctrl-Space Plugin&lt;/li&gt;
&lt;li&gt;Knowledge tool: Vimwiki&lt;/li&gt;
&lt;li&gt;Vimfiles: file operation&lt;/li&gt;
&lt;li&gt;Menu for your vim:Startify&lt;/li&gt;
&lt;li&gt;Attach File&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;为了多一点对称美，你使用高丽棒作者&lt;a href=&#34;https://github.com/junegunn&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; junegunn &lt;/a&gt;的&lt;a href=&#34;https://github.com/junegunn/vim-easy-align&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-easy-align &lt;/a&gt; (Note: &lt;a href=&#34;https://github.com/junegunn/vim-easy-align/blob/master/EXAMPLES.md#formatting-yaml-or-json&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; many examples &lt;/a&gt;),为了少犯错误，
你加入了&lt;a href=&#34;https://github.com/chip/vim-fat-finger&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-fat-finger &lt;/a&gt;,使用iabbrev来缩写你需要写的单词，或者修正错误的单词,为了编辑更加有效,
你甚至引入了&lt;a href=&#34;https://github.com/terryma/vim-multiple-cursors&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-multiline-cursor &lt;/a&gt;.进一步的你引入了&lt;a href=&#34;https://github.com/tpope&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; tpope &lt;/a&gt;的&lt;a href=&#34;https://github.com/tpope/vim-surround&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-surround &lt;/a&gt;让你在书写
racket(当然你也可以使用&lt;a href=&#34;https://github.com/ruanyl/bigvim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; delimiteMate &lt;/a&gt;补全括号插件)或者lisp代码的时候更加方便一些，
并为了重复或者递归使用，你也引入他的&lt;a href=&#34;https://github.com/tpope/vim-repeat&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-repeat &lt;/a&gt; (vim中的很多插件都是支持增强的，比如f的增强插件&lt;a href=&#34;https://rhysd.github.io/clever-f.vim/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; clever-f &lt;/a&gt;);
为了更快捷的编辑文件行，除了使用vim text object, 你也引入了&lt;a href=&#34;https://github.com/matze/vim-move&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-move &lt;/a&gt;和&lt;a href=&#34;https://github.com/easymotion/vim-easymotion&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-easymotion &lt;/a&gt; (Very Good)来移动行,使得vim文本更加结构化。&lt;/p&gt;
&lt;p&gt;想着让你的vim运行得更快一些，你把你一直用的&lt;a href=&#34;https://github.com/VundleVim/Vundle.vim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vundle &lt;/a&gt;改为了的&lt;a href=&#34;https://github.com/junegunn/vim-plug&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; junegunn&amp;rsquo;s vim-plug &lt;/a&gt;来管理你的插件,确没见得有太大的改进，简洁地使用plugins自然就快了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/vim/fuckvim.png&#34; alt=&#34;fuckVim&#34;&gt;&lt;/p&gt;
&lt;p&gt;可以看到你也增加了 Startify 的配置。&lt;/p&gt;
&lt;p&gt;然而，上面这些都是你想让vim做的，下面要写的则是&lt;font color=&#34;red&#34;&gt;vim plugins带给你关于写作的新的概念和思想&lt;/font&gt;，这也才是本文的重点。&lt;/p&gt;
&lt;p&gt;刚开始接触vim的时候，你是用了scrooloose的&lt;a href=&#34;https://github.com/scrooloose/nerdtree&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; nerdtree &lt;/a&gt; ,&lt;a href=&#34;https://github.com/majutsushi/tagbar&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; tagbar &lt;/a&gt;,&lt;a href=&#34;https://github.com/vim-airline/vim-airline&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim airline &lt;/a&gt;等，
你也使用了各种&lt;a href=&#34;https://github.com/WolfgangMehner/vim-plugins&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; language support vim plugins &lt;/a&gt;,也知道vim使用&lt;a href=&#34;https://github.com/tpope&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; tpope &lt;/a&gt;的&lt;a href=&#34;https://github.com/airblade/vim-gitgutter&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-gitgutter &lt;/a&gt;结合git管理code, 现在让我们来看第一个vim插件ctrl-space&lt;/p&gt;
&lt;h1 id=&#34;1ctrl-space-plugin&#34;&gt;1.Ctrl-Space Plugin&lt;/h1&gt;
&lt;p&gt;Github Repo: Click &lt;a href=&#34;https://github.com/vim-ctrlspace/vim-ctrlspace&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; here &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;vim help: :h ctrlspace&lt;/p&gt;
&lt;p&gt;核心概念:&lt;/p&gt;
&lt;p&gt;当你在vim中使用:h ctrlspace时候会搜索到这些资料，&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;【1.vim desktop】: Let&#39;s imagine [ Vim ] is a writing desk. 
【2.projects draws】 : Your [ projects ] are like drawers. 
【3.Bookmark  favorite project】:  The [ Bookmark ] List simply displays your favorite projects.
【4.Buffer  paper】: A [ buffer ] is like a sheet of paper lying on the desk. 
        named buffers
        unsaved buffers
【5.workspace  an status snapshot of current project】:All your [ buffers ], [ tabs ], and [ tab ] layouts can be persisted as a workspace.
It&#39;s like taking a picture of your desk with an instant camera. You can
save multiple workspaces per project with Workspace List.
【6.workspace  session】 : The word &amp;quot;workspace&amp;quot; can be considered a synonym of a &amp;quot;session&amp;quot;. The
ability of having so many sessions available at hand creates a lot of
interesting use cases! For example, you can have a workspace for each task
or feature you are working on. It&#39;s very easy to switch from one workspace
to another.

然后以后可以使用大写的B，跳转到Bookmark标签栏，类似于CtrlSpace的哲学思想，会跳转到某个bookmark下的目录，通过C也可以，直接Enter《CR》键也是可以的。
删除觉得不需要了，就D一下即可。



&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The easiest way to think about tab pages in Vim is to consider them to be viewports, layouts, or workspaces&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;
tags是一个在编程中经常会使用
而且在git的版本中也经常涉及到很多打tag的工作 (git tag  or  git tag  -a)   git checkout某个tag等

其实tags只不过是对事物的一种抽象，这也是你在现实当中经常看到的class field method 注释等等，其实都可以把他们理解为一种tag，一种convinience tag
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在vimwiki的wiki文件的简单实用方法(经常用！！！):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;:标签名字:
[[文件名#标签名字]]即可

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;相同vim tag概念&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;&amp;quot;&amp;quot; tab encapsulation
&amp;quot; tab 操作
&amp;quot; http://vim.wikia.com/wiki/Alternative_tab_navigation
&amp;quot; http://stackoverflow.com/questions/2005214/switching-to-a-particular-tab-in-vim

&amp;quot; tab切换
map &amp;lt;leader&amp;gt;th :tabfirst&amp;lt;cr&amp;gt;
map &amp;lt;leader&amp;gt;tl :tablast&amp;lt;cr&amp;gt;

map &amp;lt;leader&amp;gt;tj :tabnext&amp;lt;cr&amp;gt;
map &amp;lt;leader&amp;gt;tk :tabprev&amp;lt;cr&amp;gt;
map &amp;lt;leader&amp;gt;tn :tabnext&amp;lt;cr&amp;gt;
map &amp;lt;leader&amp;gt;tp :tabprev&amp;lt;cr&amp;gt;

map &amp;lt;leader&amp;gt;te :tabedit&amp;lt;cr&amp;gt;
map &amp;lt;leader&amp;gt;td :tabclose&amp;lt;cr&amp;gt;
map &amp;lt;leader&amp;gt;tm :tabm&amp;lt;cr&amp;gt;

&amp;quot; normal模式下切换到确切的tab
noremap &amp;lt;leader&amp;gt;1 1gt
noremap &amp;lt;leader&amp;gt;2 2gt
noremap &amp;lt;leader&amp;gt;3 3gt
noremap &amp;lt;leader&amp;gt;4 4gt
noremap &amp;lt;leader&amp;gt;5 5gt
noremap &amp;lt;leader&amp;gt;6 6gt
noremap &amp;lt;leader&amp;gt;7 7gt
noremap &amp;lt;leader&amp;gt;8 8gt
noremap &amp;lt;leader&amp;gt;9 9gt
noremap &amp;lt;leader&amp;gt;0 :tablast&amp;lt;cr&amp;gt;


&amp;quot; Toggles between the active and last active tab &amp;quot;
&amp;quot; The first tab is always 1 &amp;quot;
let g:last_active_tab = 1
&amp;quot; nnoremap &amp;lt;leader&amp;gt;gt :execute &#39;tabnext &#39; . g:last_active_tab&amp;lt;cr&amp;gt;
&amp;quot; nnoremap &amp;lt;silent&amp;gt; &amp;lt;c-o&amp;gt; :execute &#39;tabnext &#39; . g:last_active_tab&amp;lt;cr&amp;gt;
&amp;quot; vnoremap &amp;lt;silent&amp;gt; &amp;lt;c-o&amp;gt; :execute &#39;tabnext &#39; . g:last_active_tab&amp;lt;cr&amp;gt;
nnoremap &amp;lt;silent&amp;gt; &amp;lt;leader&amp;gt;tt :execute &#39;tabnext &#39; . g:last_active_tab&amp;lt;cr&amp;gt;
autocmd TabLeave * let g:last_active_tab = tabpagenr()

&amp;quot; 新建tab  Ctrl+t
nnoremap &amp;lt;C-t&amp;gt;     :tabnew&amp;lt;CR&amp;gt;
inoremap &amp;lt;C-t&amp;gt;     &amp;lt;Esc&amp;gt;:tabnew&amp;lt;CR&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;默认工作类型目录&#34;&gt;默认工作类型目录&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;Markers will be also used as a storage for `cs_workspaces` (workspaces of
the current project) and `cs_files` (cached files of the current project).

Default value: &amp;gt;

    let g:CtrlSpaceProjectRootMarkers = [
         \ &amp;quot;.git&amp;quot;,
         \ &amp;quot;.hg&amp;quot;,
         \ &amp;quot;.svn&amp;quot;,
         \ &amp;quot;.bzr&amp;quot;,
         \ &amp;quot;_darcs&amp;quot;,
         \ &amp;quot;CVS&amp;quot;
         \ ]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;font color=&#34;red&#34;&gt;Summary:&lt;/font&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;   A buffer is the in-memory text of a file.
   A window is a viewport on a buffer.
   A tab page is a collection of windows.


A window is a viewport onto a buffer.  You can use multiple windows on one
buffer, or several windows on different buffers.

A buffer is a file loaded into memory for editing.  The original file remains
unchanged until you write the buffer to the file.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#2. Knowledge tool: Vimwiki
Github Repo: Click &lt;a href=&#34;https://github.com/vimwiki/vimwiki&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; here &lt;/a&gt;
vimwki setup in vimrc:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;• &amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&amp;quot;  
• &amp;quot; vimwiki  
• let g:vimwiki_use_mouse = 1  
• let g:vimwiki_list_ignore_newline = 0  
• let g:vimwiki_hl_headers = 0  
• &amp;quot; vimwiki打开折叠  
• &amp;quot;let g:vimwiki_folding = 1  
• let g:vimwiki_camel_case = 0  
• let g:vimwiki_list_ignore_newline = 0  
• let g:vimwiki_CJK_length = 1  
•   
• &amp;quot;设定文件浏览器目录为当前目录  
• set bsdir=buffer      
• &amp;quot;set autochdir  
•   
• &amp;quot; 日历插件  
• map ca :Calendar&amp;lt;cr&amp;gt;  
•   
• map &amp;lt;S-Space&amp;gt; :&amp;lt;C-Space&amp;gt;  
•   
• &amp;quot; vimwiki  
• let g:vimwiki_list = [{&#39;path&#39;: &#39;~/Wiki/wiki/&#39;, &#39;path_html&#39;: &#39;~/Wiki/&#39;, &#39;auto_export&#39;: 1}]  
• &amp;quot; 转化为Html文件  
• map &amp;lt;S-F4&amp;gt; :Vimwiki2HTML&amp;lt;cr&amp;gt;  
•   
• &amp;quot; 设置颜色  
• hi VimwikiHeader1 guifg=#FF0000  
• hi VimwikiHeader2 guifg=#00FF00  
• hi VimwikiHeader3 guifg=#0000FF  
• hi VimwikiHeader4 guifg=#FF00FF  
• hi VimwikiHeader5 guifg=#00FFFF  
hi VimwikiHeader6 guifg=#FFFF00  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;##vimwiki tagbar 集成&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;------------------------------------------------------------------------------
Tagbar integration                                            *vimwiki-tagbar*

As an alternative to the Table of Contents, you can use the Tagbar plugin
(http://majutsushi.github.io/tagbar/) to show the headers of your wiki files
in a side pane.
Download the Python script from
https://raw.githubusercontent.com/vimwiki/utils/master/vwtags.py and follow
the instructions in it.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;效果如下，&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/vim/tagbar.png&#34; alt=&#34;TAGBAR&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;3-vimfiles-a-tool-for-file-operations&#34;&gt;3. Vimfiles: A tool for file operations&lt;/h1&gt;
&lt;p&gt;Github Repo: click  &lt;a href=&#34;https://github.com/Shougo/vimfiler.vim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; here &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;vimfiler setup in vimrc&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;&amp;quot;for vimfiler
let g:vimfiler_enable_auto_cd=1
&amp;quot;call vimfiler#set_execute_file(&#39;txt&#39;, &#39;notepad&#39;)
call vimfiler#set_execute_file(&#39;txt&#39;, &#39;gvim&#39;)
call vimfiler#set_execute_file(&#39;c&#39;, [&#39;gvim&#39;, &#39;notepad&#39;])

let g:vimfiler_as_default_explorer = 1

&amp;quot; Enable file operation commands.
&amp;quot; Edit file by tabedit.
&amp;quot;call vimfiler#custom#profile(&#39;default&#39;, &#39;context&#39;, {
&amp;quot;      \ &#39;safe&#39; : 0,
&amp;quot;      \ &#39;edit_action&#39; : &#39;tabopen&#39;,
&amp;quot;      \ })

&amp;quot; Like Textmate icons.
let g:vimfiler_tree_leaf_icon = &#39; &#39;
&amp;quot;let g:vimfiler_tree_closed_icon = &#39;▸&#39;
&amp;quot;let g:vimfiler_tree_opened_icon = &#39;▾&#39;
let g:vimfiler_file_icon = &#39;-&#39;
let g:vimfiler_marked_file_icon = &#39;*&#39;

let g:vimfiler_safe_mode_by_default=0 
  &amp;quot; Use trashbox.
  &amp;quot; Windows only and require latest vimproc.
let g:unite_kind_file_use_trashbox = 1
&amp;quot;&amp;quot;  you can create a .vim file, then source it
&amp;quot;need everything.exe
&amp;quot;nnoremap &amp;lt;Leader&amp;gt;f :Unite file buffer file_rec file_mru everything&amp;lt;CR&amp;gt;
nnoremap &amp;lt;Leader&amp;gt;f :VimFiler&amp;lt;CR&amp;gt;
nnoremap &amp;lt;leader&amp;gt;l :Unite line&amp;lt;CR&amp;gt;
let g:unite_source_everything_limit = 100
let g:unite_source_everything_full_path_search = 1
let g:unite_source_everything_posix_regexp_search = 1
let g:unite_source_everything_async_minimum_length = 3
let g:unite_source_everything_cmd_path = &#39;C:\\Users\\YeZhao\\.vim\\es\\es.exe&#39;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由于vimfiler的使用也了解到了 &lt;a href=&#34;https://github.com/ggreer/the_silver_searcher&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; ag &lt;/a&gt;插件（一个特别好用的搜索插件,在ubuntu底下直接使用ag “expression” 找到当前文件夹所有文件内容 包含表达式的行数据 相当快速）&lt;/p&gt;
&lt;p&gt;Vimfiler常用快捷键&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;H作用打开shell  x打开文件夹的意思

L打开磁盘
Load
&amp;amp;回到project目录  那是相当有用的
~回到.vim目录

e编写文件
N 创建文件
K创建文件夹

#全选
*全部选？

c复制
d删除
m移动

先用m表示选定 然后d删除(重要操作)
m移动
c复制

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;有意思的是,&lt;/p&gt;
&lt;p&gt;使用m然后r，可以跳出一个新的编辑窗口，进行文件名的修改，这是相当好的实现。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
:Vimwiki2HTML – Convert current wiki page to HTML
:VimwikiAll2HTML – Convert all your wiki pages to HTML转化为HTML
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;4-startify-plugin&#34;&gt;4. Startify Plugin&lt;/h1&gt;
&lt;p&gt;Github Repo: click  &lt;a href=&#34;https://github.com/mhinz/vim-startify&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; here &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;##vim 全屏&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;let w:full_screen=0
    map :call FullScreen()
func! FullScreen()
    if w:full_screen==1
    let w:full_screen=0
    :simalt ~R
    else
    :simalt ~X
    let w:full_screen=1
    endif
endfunc

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;##vim-easy-align常用命令&lt;/p&gt;
&lt;p&gt;vim help: &lt;code&gt;:h easyalign&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;vip= Enter= EnterEnter=(居右，居中，居左对其选项 )&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;gaip=


 --------------+--------------------------------------------------------------------
 Delimiter key | Description/Use cases                                              ~
 --------------+--------------------------------------------------------------------
 &amp;lt;Space&amp;gt;       | General alignment around whitespaces
    `:`            | Suitable for formatting JSON or YAML
  `=`            | Operators containing equals sign ( `=` ,  `==,`  `!=` ,  `+=` ,  `&amp;amp;&amp;amp;=` , ...)
  `.`            | Multi-line method chaining
  `,`            | Multi-line method arguments
  `&amp;amp;`            | LaTeX tables (matches  `&amp;amp;`  and  `\\` )
  `#`            | Ruby/Python comments
  `&amp;quot;`            | Vim comments
 &amp;lt;Bar&amp;gt;         | Table markdown
 --------------+--------------------------------------------------------------------

  ------------------+------------------------------------+--------------------
 With visual map   | Description                        | Equivalent command ~
 ------------------+------------------------------------+--------------------
 &amp;lt;Enter&amp;gt;&amp;lt;Space&amp;gt;    | Around 1st whitespaces             | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign\
 &amp;lt;Enter&amp;gt;2&amp;lt;Space&amp;gt;   | Around 2nd whitespaces             | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign2\
 &amp;lt;Enter&amp;gt;-&amp;lt;Space&amp;gt;   | Around the last whitespaces        | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign-\
 &amp;lt;Enter&amp;gt;-2&amp;lt;Space&amp;gt;  | Around the 2nd to last whitespaces | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign-2\
 &amp;lt;Enter&amp;gt;:          | Around 1st colon ( `key:  value` )   | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign:
 &amp;lt;Enter&amp;gt;&amp;lt;Right&amp;gt;:   | Around 1st colon ( `key : value` )   | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign:&amp;lt;l1
 &amp;lt;Enter&amp;gt;=          | Around 1st operators with =        | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign=
 &amp;lt;Enter&amp;gt;3=         | Around 3rd operators with =        | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign3=
 &amp;lt;Enter&amp;gt;*=         | Around all operators with =        | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign*=
 &amp;lt;Enter&amp;gt;**=        | Left-right alternating around =    | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign**=
 &amp;lt;Enter&amp;gt;&amp;lt;Enter&amp;gt;=   | Right alignment around 1st =       | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign!=
 &amp;lt;Enter&amp;gt;&amp;lt;Enter&amp;gt;**= | Right-left alternating around =    | :&#39;&amp;lt;,&#39;&amp;gt;EasyAlign!**=
 ------------------+------------------------------------+--------------------

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;##vim-surround 常用命令&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;1. cs&amp;quot;&#39;
2. cs&#39;&amp;quot;
3. cs&#39;&amp;lt;q&amp;gt;
5. cs&amp;quot;t
4. cst&amp;quot;
6. ds&amp;quot;
7. ysiw&amp;quot;
8. yssb == yss)
9. S&amp;quot;  可视化模式选择快 然后大S，这点类似于Multiple-Cursor的Ctrl+N命令
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;vim-copy-file-name&#34;&gt;vim copy file name&lt;/h2&gt;
&lt;p&gt;你使用&lt;a href=&#34;https://github.com/AdamWhittingham/vim-copy-filename&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; vim-copy-filename &lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;&amp;quot;&amp;quot; for vim-copy-filename
nmap &amp;lt;leader&amp;gt;cp :CopyRelativePath&amp;lt;CR&amp;gt;
nmap &amp;lt;leader&amp;gt;cl :CopyRelativePathAndLine&amp;lt;CR&amp;gt;
nmap &amp;lt;leader&amp;gt;cP :CopyAbsolutePath&amp;lt;CR&amp;gt;
nmap &amp;lt;leader&amp;gt;cf :CopyFileName&amp;lt;CR&amp;gt;
nmap &amp;lt;leader&amp;gt;cd :CopyDirectoryPath&amp;lt;CR&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;额外一些插件的备注&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/haya14busa&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Haya14busa &lt;/a&gt; 提供的 &lt;a href=&#34;https://github.com/haya14busa/incsearch.vim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; incsearch &lt;/a&gt; 增加了statusline的查找词当前数 和总个数&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/itchyny/vim-cursorword&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Vim-cursorword &lt;/a&gt; 表示添加下划线。&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/AndrewRadev/splitjoin.vim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; AndrewRadev/splitjoin.vim &lt;/a&gt;  是提供类似于perl的当行模式的插件[gS gJ]。在scheme估计比较少用到。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一直遗忘的一个快捷查看命令 &lt;code&gt;Ctrl+E&lt;/code&gt; 往下滚屏 &lt;code&gt;Ctrl+Y&lt;/code&gt; 往上滚屏&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;运行的话,进入底线命令模式,用:!perl %就可以运行,或者可以绑定一个快捷键组合, %表示当前文件的意思
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后，编辑器界面展示的应全是代码，不应该有工具条、菜单、滚动条浪费空间的元素，另外，编程是种精神高度集中的脑力劳动，不应出现闪烁光标、花哨鼠标这些分散注意力的东东&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;
写到这边我去睡觉了，梦中梦到了前半辈子比较重要的三个女人，我妈以及另外两个从小长大的妇女(不说女生了),街道上偶遇她们正在端着一个冰盒沿街发送，也不像是生了孩子似的，但梦中是那么真实又带着虚的东西（所以人
是一个最精良的仪器，拥有最直觉的第六感，又拥有最会惹事的直觉），我妈骑着自行车从我们三身边走过，前方又出现一个特别活泼的&amp;quot;妇女&amp;quot;,在我的环境中还有篮球这一个概念，我的梦（由我的身体+癫痫的精神状态+疲惫产生的一种组合的事件）把我带到一个篮球场，后来我又去了

我一个哥们那边，终于有男的出现，我发现我走过的路总是不缺乏女生(所以我是趋向于好色之徒,本来也是), 我梦到了我儿时的
阴影我特别怕的一个男生，喜欢拿刀砍人，犯冲，特别好斗，但缺少脑子。我写出来了，因为我想克服它。梦向黄大仙一样，它放屁的效果具有致幻的效果，能让人陷入幻境中不得自拔，人每天晚上也像黄大仙附体一样坐着春秋大梦。

但从我身边路过的那些女生，都已经变得不真实，我身边有一个wife如胶似漆的黏着我，怎么我就不懂珍惜呢。时代的进步，需要梦的催化，世界上无德的传销机构也在利用着洗脑在铸造着同一类人，这些人把思维当作无趣，而非智趣。

匆匆而过三十载，岁月不饶人，也不等人(也就是你学会了用时间的非定常特性来观察人生）。乐观、不自信一直伴随着我成长，然而我却不知道痛苦才是生活的本源，享受
痛苦，才能拥有些许的快乐。Enjoy Painess!但我不想把pain带给亲人，身边的人。我是一个自私的人，没有团队精神，不太会
替别人考虑的人（当然自从有了她，我得替她考虑，但是考虑得还很少，我很对不起她）

也就是生活的智趣源于痛苦，痛苦的根源诞生了时代的进步，和智趣的发展。

写到这边，就先停笔把，继续回到vim当中，他也像人，能够感知到字符的变化，感知文本结构（你赋予了它思考的能力），能够
让你编辑得更顺畅些;vim像刀、人也可以像刀，磨砺你自己这把最重要的一把刀把！
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;必然对偶然，自由对随机，自由在必然中，随机在偶然中，原来这才是自由(&lt;a href=&#34;http://www.huzheng.org/geniusreligion/TheSourceCodeOfMyWorld.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 胡正自由 &lt;/a&gt;是有代价的)。&lt;/p&gt;
&lt;h1 id=&#34;在终端使用vim编辑命令的方式&#34;&gt;在终端使用vim编辑命令的方式&lt;/h1&gt;
&lt;p&gt;在~目录下创建一个.inputrc文件，内容如下&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;set editing-mode vi
Control-a: beginning-of-line
Control-b: backward-char
Control-d: delete-char
Control-e: end-of-line
Control-f: forward-char
Control-k: kill-line
Control-n: next-history
Control-p: previous-history
set keymap emacs-ctlx
v: vi-editing-mode
Control-v: &amp;quot;\C-xv\e&amp;quot;
Escape: &amp;quot;\C-xv\e&amp;quot;
set keymap emacs
$if Bash
  Control-w: unix-filename-rubout
$endif

&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>From Little Scheme to Season Scheme</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/</link>
      <pubDate>Fri, 11 Aug 2017 20:13:42 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/</guid>
      <description>&lt;p&gt;The Little Scheme(TLS) 提出了&lt;code&gt;rember&lt;/code&gt;,&lt;code&gt;multirember&lt;/code&gt;,&lt;code&gt;multirember*&lt;/code&gt;以及&lt;code&gt;multirember&amp;amp;Col collector&lt;/code&gt;等系列函数的定义，而在The Season Scheme(TSS) 进一步改进了&lt;code&gt;rember&lt;/code&gt;系列函数， 使用&lt;code&gt;let&lt;/code&gt;、&lt;code&gt;letrec&lt;/code&gt;、&lt;code&gt;letcc&lt;/code&gt;进行改写，并结合&lt;code&gt;leftmost&lt;/code&gt;和&lt;code&gt;deep&lt;/code&gt;函数的想法，又提出了&lt;code&gt;rember&lt;/code&gt;的函数，该函数表示删除最左边的函数。在此过程中，剖析每一个简单的函数(并由此带来智趣)， 并进行改进，升级，提炼，从中可以体味到&lt;a href=&#34;http://blog.sina.com.cn/s/blog_bffd70da0101f4sl.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 华罗庚老先生 &lt;/a&gt;说的”书越读越薄，并积厚薄书”的感觉,从繁杂中感受直观的本质， 借以理解事物，从另外一个角度看待事物。&lt;/p&gt;
&lt;p&gt;一、The Little Scheme
rember
multirember
multiremberStar
multiremberStarCol
二、The Season Scheme
rember-let
rember-letrec
rember-letcc
rember star
depthStar improvement&lt;/p&gt;
&lt;h1 id=&#34;一the-little-scheme&#34;&gt;一、The Little Scheme&lt;/h1&gt;
&lt;p&gt;scheme的核心数据结构是List，通过list进行算法的演算，而rember是其中的一种算法，用于去除其中的一个元素。 并在rember的同级函数中，也定义了subst，member，insert left, insert right等。在TLS书中也提出了这些函数的相同之处并最终使用insert-g来统一各个函数，这是不错的思想。&lt;/p&gt;
&lt;h2 id=&#34;11-rember&#34;&gt;1.1 rember&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define rember-f
  (lambda (test?)
          (lambda (a lat)
            (cond
              ((null? lat) &#39;())
              ((test? a (car lat))
               (cdr lat))
              (else
               (cons (car lat)
                     ((multirember-f test?) a (cdr lat))))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Another related procedures:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define insertL
  (lambda (new old lat)
    (cond
      ((null? lat)
       &#39;())
      ((eq? (car lat) old)
       (cons new (cons old (cdr lat))))
      (else
       (cons new (insertL new old (cdr lat)))))))


(define insertLR
  (lambda (new oldL oldR lat)
    (cond
      ((null? lat)
       &#39;())
      ((eq? (car lat) oldL)
       (cons new (cons oldL (cdr lat))))
      ((eq? (car lat) oldR)
       (cons oldR (cons new (cdr lat))))
      (else
       (cons (car lat) (insertLR new oldL oldR (cdr lat)))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;进一步可以参考 &lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; TLS and TSS Backup &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;为了更进一步删除一个列表(未嵌套多个list)时候所有的元素(定义为lat version)&lt;/p&gt;
&lt;h2 id=&#34;12-multirember&#34;&gt;1.2 multirember&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define multirember-f
  (lambda (test?)
          (lambda (a lat)
            (cond
              ((null? lat) &#39;())
              ((test? a (car lat))
               ((multirember-f test?) a (cdr lat)))
              (else
               (cons (car lat)
                     ((multirember-f test?) a (cdr lat))))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Another related procedures:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define multiinsertLR
  (lambda (new oldL oldR lat)
    (cond
      ((null? lat)
       &#39;())
      ((eq? (car lat) oldL)
       (cons new (cons oldL (multiinsertLR new oldL oldR (cdr lat)))))
      ((eq? (car lat) oldR)
       (cons oldR (cons new (multiinsertLR new oldL oldR (cdr lat)))))
      (else
       (cons (car lat) (multiinsertLR new oldL oldR (cdr lat)))))))


;(insertL &#39;a &#39;b &#39;(a b c (a b c)))
;&#39;(a a b c (a b c))

;(insertLR &#39;water &#39;a &#39;b &#39;(a bc b c d (a c b)))
;&#39;(water a bc b c d (a c b))

 (multiinsertLR &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (a b c d))
&amp;gt; (insertLR &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b c d a b (a b c d))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;13-multirember&#34;&gt;1.3 multirember*&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-rakcet&#34;&gt;(define multiinsertLR*
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (cond
      ((null? lat)
       &#39;())
      ((atom? (car lat))
       (cond 
         ((eq? (car lat) oldL)
          (cons new (cons oldL (multiinsertLR* new oldL oldR (cdr lat)))))
         ((eq? (car lat) oldR)
          (cons oldR (cons new (multiinsertLR* new oldL oldR (cdr lat)))))
         (else
          (cons (car lat) (multiinsertLR* new oldL oldR (cdr lat))))))
      (else
       (cons (multiinsertLR* new oldL oldR (car lat))
             (multiinsertLR* new oldL oldR (cdr lat)))))))


(define evens-only*
  (lambda (l)

    (define atom?
      (lambda (x)
        (and (not (pair? x)) (not (null? x)))))
    (cond
      ((null? l) &#39;())
      ((atom? (car l))
       (cond
         ((even? (car l))
          (cons (car l) (evens-only* (cdr l))))
         (else (evens-only* (cdr l)))))
      (else
       (cons (evens-only* (car l))
             (evens-only* (cdr l)))))))


&amp;gt; (multiinsertLR* &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (water a b water c d))
&amp;gt; (multiinsertLR &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (a b c d))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Another related procedures:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-rakect&#34;&gt;(define multiinsertLR*let
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (cond
      ((null? lat)
       &#39;())
      ((atom? (car lat))
        (let ((rest (multiinsertLR* new oldL oldR (cdr lat))))
          (cond 
            ((eq? (car lat) oldL)
             (cons new (cons oldL rest)))
            ((eq? (car lat) oldR)
             (cons oldR (cons new rest)))
            (else
             (cons (car lat) rest)))))
      (else
       (let ((first (multiinsertLR* new oldL oldR (car lat)))
             (rest (multiinsertLR* new oldL oldR (cdr lat))))
       (cons first rest))))))



(define multiinsertLR*letrec
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (define mul-help
      (lambda (lat)
        (cond
          ((null? lat)
           &#39;())
          ((atom? (car lat))
           (cond 
             ((eq? (car lat) oldL)
              (cons new (cons oldL (mul-help  (cdr lat)))))
             ((eq? (car lat) oldR)
              (cons oldR (cons new (mul-help  (cdr lat)))))
             (else
              (cons (car lat) (mul-help  (cdr lat))))))
          (else
           (cons (mul-help  (car lat))
                 (mul-help  (cdr lat)))))))
    (mul-help lat)))

&amp;gt; (multiinsertLR*let &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (water a b water c d))
&amp;gt; (multiinsertLR* &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (water a b water c d))
&amp;gt; (multiinsertLR &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (a b c d))

(multiinsertLR*letrec &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (water a b water c d))



(define multiinsertLR*letreclet
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (define mul-help
      (lambda (lat)
        (cond
          ((null? lat)
           &#39;())
          ((atom? (car lat))
           (let ((rest (mul-help  (cdr lat))))
           (cond 
             ((eq? (car lat) oldL)
              (cons new (cons oldL rest)))
             ((eq? (car lat) oldR)
              (cons oldR (cons new rest)))
             (else
              (cons (car lat) rest)))))
          (else
           (let ((first (mul-help  (car lat)))
                 (rest (mul-help  (cdr lat))))
           (cons first rest))))))
    (mul-help lat)))

(multiinsertLR*letreclet &#39;water &#39;a &#39;b &#39;(a b c d a b (a b c d)))
&#39;(water a b water c d water a b water (water a b water c d))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;14-multiremberstar-and-collector&#34;&gt;1.4 multiremberstar and collector&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define multirember*co
  (lambda (a lat col)
    (define atom?
      (lambda (x)
        (and (not (pair? x)) (not (null? x)))))
    (cond
      (( null? lat)
       (col (quote ()) (quote ())))
      ((atom? (car lat))
       (cond
         ((eq? ( car lat) a)
         (multirember*co a (cdr lat)
                        (lambda ( newlat seen)
                          (col newlat (cons (car lat)
                                            seen)))))
       (else
        (multirember*co a (cdr lat)
                       (lambda (newlat seen)
                         (col (cons (car lat) newlat) seen))))))
      (else
       (multirember*co a (car lat)
                       (lambda (al as)
                         (multirember*co a (cdr lat)
                                         (lambda (dl ds)
                                           (col (cons al dl)
                                                (cons as ds))))))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Another related procedures:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define col
   (lambda (x y)
      (null? y)))


(define a-friend
   (lambda (x y)
      (length x)))

(define a-friend-y
   (lambda (x y)
      (length y)))


(define a-friend-z
   (lambda (x y)
      (cons x (cons y &#39;()))))

(define a-friend-zp
   (lambda (x y z)
      (cons x (cons y (cons z &#39;())))))

(define evens-only*col
  (lambda (l col)

    (define atom?
      (lambda (x)
        (and (not (pair? x)) (not (null? x)))))
    (cond
      ((null? l) (col &#39;() 1 0))
      ((atom? (car l))
       (cond
         ((even? (car l))
          (evens-only*col (cdr l)
                          (lambda (newlat L R)
                            (col (cons (car l) newlat) (* (car l) L) R))))
         (else (evens-only*col (cdr l) (lambda (newlat L R)
                                      (col newlat L
                                           (+ (car l) R)))))))
      (else
       (evens-only*col (car l)
                       (lambda (al ale ari)
                         (evens-only*col (cdr l)
                                         (lambda (dl dle dri)
                                           (col (cons al dl)
                                                (* ale dle)
                                                (+ ari dri))))))))))


(define multiinsertLRo
  (lambda (new oldL oldR lat col)
    (cond
      ((null? lat) (col &#39;() 0 0))
      ((eq? (car lat) oldL)
       (multiinsertLRo new oldL oldR (cdr lat)
                       (lambda (newlat L R)
                         (col (cons new (cons oldL newlat))
                              (+ L 1) R))))
      ((eq? (car lat) oldR)
       (multiinsertLRo new oldL oldR (cdr lat)
                       (lambda (newlat L R)
                         (col (cons oldR (cons new newlat))
                              L (+ R 1)))))
      (else
       (multiinsertLRo new oldL oldR (cdr lat)
                       (lambda (newlat L R)
                         (col (cons (car lat) newlat)
                              L
                              R)))))))




(define multiinsertLR*o
  (lambda (new oldL oldR lat col)
    (define atom?
      (lambda (x)
        (and (not (pair? x)) (not (null? x)))))
    (cond
      ((null? lat) (col &#39;() 0 0))
      ((atom? (car lat))
       (cond
         ((eq? (car lat) oldL)
          (multiinsertLR*o new oldL oldR (cdr lat)
                          (lambda (newlat L R)
                            (col (cons new (cons oldL newlat))
                                 (+ L 1) R))))
         ((eq? (car lat) oldR)
          (multiinsertLR*o new oldL oldR (cdr lat)
                          (lambda (newlat L R)
                            (col (cons oldR (cons new newlat))
                                 L (+ R 1)))))
         (else
          (multiinsertLR*o new oldL oldR (cdr lat)
                          (lambda (newlat L R)
                            (col (cons (car lat) newlat)
                                 L
                                 R))))))
      (else
       (multiinsertLR*o new oldL oldR (car lat)
                        (lambda (al ale ari)
                          (multiinsertLR*o new oldL oldR (cdr lat)
                                           (lambda (dl dle dri)
                                             (col (cons al dl)
                                                  (+ ale dle)
                                                  (+ ari dri))))))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;二the-season-scheme&#34;&gt;二、The Season Scheme&lt;/h1&gt;
&lt;p&gt;由&lt;code&gt;member&lt;/code&gt;和&lt;code&gt;rember&lt;/code&gt;又可以深入进行剖析，于是引进了&lt;code&gt;member&lt;/code&gt;的升级版本&lt;code&gt;two-in-a-lat&lt;/code&gt;,未包含TSS的最后一个two-in-a-lat的实现，并通过let,letrec,letcc改写TLS中的rember系列函数，在结合leftmost和deep(Later on,deep有两外一层意思就是产生n层的pizza)函数，升级rember到删除最左边的一个元素。&lt;/p&gt;
&lt;p&gt;Member实际上在所有的函数的实现中都有对应的组成，他是一个十分重要的组成部分，包括基于member的union,intersect,intersectall函数的，一个相对基础的函数。
the definition of member&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define member?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else
       (or (eq? a (car lat))
           (member a (cdr lat)))))))

; member-letrec version
(define member?
  (lambda (a l)
    (letrec
      ((yes? (lambda (l)
               (cond
                 ((null? l) #f)
                 ((eq? (car l) a) #t)
                 (else (yes? (cdr l)))))))
      (yes? l))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;现在让我们看看two-in-a-lat的引申(通过member)
Two -in -a -lat&lt;/p&gt;
&lt;p&gt;包含two-in-a-lat(用member2代替),并附加sum-of-prefix和scramble函数的实现，目的是说如果你想让函数知道额外的信息，可以通过增加参数的方法。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define member-letrec-ju?
  (lambda (a lat)
    (letrec ((yes? (lambda (l)
                    (cond
                      ((null? l) #f)
                      (else
                       (or (eq? a (car l))
                           (yes? a (cdr l))))))))
      (yes? lat))))

(define member2?
  (lambda (preceding lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? preceding (car lat))
                (member2? (car lat) (cdr lat)))))))

;;; (member2? &#39;a &#39;(a b c))  bugs!

(define memberContinue?
  (lambda (lat)
    (define M2?
      (lambda (preceding lat)
        (cond
          ((null? lat) #f)
          (else (or (eq? preceding (car lat))
                    (M2? (car lat) (cdr lat)))))))
    (M2? &#39;() lat)))


(define memberContinueAlter?
  (lambda (lat)
    (letrec ((M2? (lambda (preceding lat)
                    (cond
                      ((null? lat) #f)
                      (else
                       (let ((pre (car lat)))
                         (or (eq? preceding pre)
                                (M2? pre (cdr lat)))))))))
             (M2? &#39;() lat))))


(define sum-of-prefixes
  (lambda (tup)
    (define sum-of-prefixes-b
      (lambda (sonssf tup)     ; sonssf stands for &#39;sum of numbers seen so far&#39;
        (cond
          ((null? tup) &#39;())
          (else (cons (+ sonssf (car tup))
                      (sum-of-prefixes-b
                       (+ sonssf (car tup))
                       (cdr tup)))))))
    (sum-of-prefixes-b 0 tup)))

;  (sum-of-prefixes &#39;(1 2 3 4))
; &#39;(1 3 6 10)


(define sum-of-prefixes1
  (lambda (tup)
    (letrec
      ((S (lambda (sss tup)
            (cond
              ((null? tup) &#39;())
              (else
               (let ((first (car tup)))
                (cons (+ sss first)
                      (S (+ sss first) (cdr tup)))))))))
(S 0 tup))))

(define scramble-b
  (lambda (tup rev-pre)
    (define one?
      (lambda (n)
        (= n  1)))
    (define sub1
      (lambda (n)
        (- n 1)))
    (define pick
      (lambda (n lat)
        (cond
          ((one? n) (car lat))
          (else (pick (sub1 n) (cdr lat))))))
    (cond
      ((null? tup) &#39;())
      (else
       (cons (pick (car tup) (cons (car tup) rev-pre))
             (scramble-b (cdr tup)
                         (cons (car tup) rev-pre)))))))


(define scramble
  (lambda (tup)
    (letrec ((scramble-b
              (lambda (tup rev-pre)
                (define one?
                  (lambda (n)
                    (= n  1)))
                (define sub1
                  (lambda (n)
                    (- n 1)))
                (define pick
                  (lambda (n lat)
                    (cond
                      ((one? n) (car lat))
                      (else (pick (sub1 n) (cdr lat))))))
                (cond
                  ((null? tup) &#39;())
                  (else
                   (let ((first (car tup)))
                     (cons (pick first (cons first rev-pre))
                     (scramble-b (cdr tup)
                                 (cons first rev-pre)))))))))
      (scramble-b tup &#39;()))))




(define scramble2
  (lambda (tup)
    (letrec ((one?
              (lambda (n)
                (= n  1)))
             (sub1
              (lambda (n)
                (- n 1)))
             (pick
              (lambda (n lat)
                (cond
                  ((one? n) (car lat))
                  (else (pick (sub1 n) (cdr lat))))))
             (scramble-b
              (lambda (tup rev-pre)
                (cond
                  ((null? tup) &#39;())
                  (else
                   (let ((first (car tup)))
                     (cons (pick first (cons first rev-pre))
                           (scramble-b (cdr tup)
                                       (cons first rev-pre)))))))))
      (scramble-b tup &#39;()))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;##2.1 rember-let&lt;/p&gt;
&lt;p&gt;Note: use let to define the repeated expression, so simplify the definition of the procedure.&lt;/p&gt;
&lt;h2 id=&#34;22-rember-letrec&#34;&gt;2.2 rember-letrec&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;;;; see at the TSS
(define rember
  (lambda (a lat)
    (letrec
        ((R (lambda (lat)
              (cond
                ((null? lat) &#39;())
                ((eq? (car lat) a) (cdr lat))
                (else
                 (cons (car lat) (R (cdr lat))))))))
      (R lat))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果我们想要进一步实现rember-beyond-first(保留删除元素之前的所有元素)和rember-upto-last(只保留删除元素之后的元素)&lt;/p&gt;
&lt;h2 id=&#34;23-rember-letcc&#34;&gt;2.3 rember-letcc&lt;/h2&gt;
&lt;p&gt;Rember-Beyond-first&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;; The rember-beyond-first function rembers everything beyond first match
;
(define rember-beyond-first
  (lambda (a lat)
    (letrec
      ((R (lambda (lat)
            (cond
              ((null? lat) &#39;())
              ((eq? (car lat) a) &#39;())
              (else
                (cons (car lat) (R (cdr lat))))))))
      (R lat))))
	

(rember-beyond-first
  &#39;roots
  &#39;(noodles spaghetti spatzle bean-thread roots potatoes yam others rice))
; ==&amp;gt; &#39;(noodles spaghetti spaghetti bean-thread)

Rember-upto-last


(define-syntax letcc
  (syntax-rules ()
    ((letcc ?k ?body ...)
     (call/cc (lambda (?k) ?body ...)))))
(define rember-upto-last
  (lambda (a lat) ; Look Ma, no cons   
    (letcc skip
      (letrec 
          ((R
            (lambda (l)
              (cond
                ((null? l) (void))
                (else (let ()
                        (R (cdr l))
                        (cond
                          ((eq? a (car l))
                           (skip (cdr l)))
                          (else (void)))))))))
        (R lat)
        lat))))

	

(rember-upto-last
  &#39;roots
  &#39;(noodles spaghetti spatzle bean-thread roots potatoes yam others rice))
; ==&amp;gt; &#39;(potatoes yam others rice)

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;24-remberstar&#34;&gt;2.4 remberstar&lt;/h2&gt;
&lt;p&gt;the definition of leftmost&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define leftmost-fixed-let
  (lambda (l)
    (cond
      ((null? l) &#39;())
      ((atom? (car l)) (car l))
      (else
       (let ((a (leftmost-fixed (car l))))
         (cond
           ((atom? a) a)
           (else (leftmost-fixed (cdr l)))))))))

;(leftmost-fixed-let &#39;((() a b) (c d))) ;; bug fixed
;
;(leftmost-fixed-let &#39;(((y) b) (c d)))   ; &#39;y
;(leftmost-fixed-let &#39;(((y) ()) () (e))) ; &#39;y
;(leftmost-fixed-let &#39;(((() y) ())))     ; &#39;y
;(leftmost-fixed-let &#39;(((()) ()))) ; &#39;()



;;letcc version

(define leftmost-letcc
  (letrec
      ((lm (lambda (l out)
             (cond
               ((null? l) &#39;())
               ((atom? (car l)) (out (car l)))
               (else
                (begin
                  (lm (car l) out)
                  (lm (cdr l) out)))))))
    (lambda (l)
      (call-with-current-continuation
       (lambda (skip)
         (lm l skip))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the definition of deep&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define deep
  (lambda (m)
    (cond
      ((zero? m) &#39;pizza)
      (else (cons (deep (sub1 m)) &#39;())))))


(define toppings 0)
(define deepB
  (lambda (m)
    (cond
      ((zero? m)
       (call-with-current-continuation
        (lambda (jump)
          (set! toppings jump)
          &#39;pizza)))
      (else
       (cons (deepB (sub1 m)) &#39;())))))

(define deep&amp;amp;co
  (lambda (m k)
    (cond
      ((zero? m) (k &#39;pizza))
      (else
       (deep&amp;amp;co (sub1 m)
                (lambda (x) (k (cons x &#39;()))))))))

(deep&amp;amp;co 0 (lambda (x) x))          ; &#39;pizza
(deep&amp;amp;co 6 (lambda (x) x))          ; &#39;((((((pizza))))))
(deep&amp;amp;co 2 (lambda (x) x)) ; &#39;((pizza))


(define deep&amp;amp;coB
  (lambda (m k)
    (cond
      ((zero? m)
       (let ()
         (set! toppings k)
         (k &#39;pizza)))
      (else
       (deep&amp;amp;coB (sub1 m)
                 (lambda (x)
                   (k (cons x &#39;()))))))))

(deep&amp;amp;coB 6 (lambda (x) x))         ; &#39;((((((pizza))))))
(deep&amp;amp;coB 4 (lambda (x) x)) ; &#39;((((pizza))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;接下来，再看看由leftmost结合rember得到rember star.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;
; The rember1* function removes the leftmost occurrence of a in l
;
(define rember1*
  (lambda (a l)
    (cond
      ((null? l) &#39;())
      ((atom? (car l))
       (cond
         ((eq? (car l) a) (cdr l))
         (else
           (cons (car l) (rember1* a (cdr l))))))
      (else
        (cond
          ((equal? (rember1* a (car l)) (car l)) ; if the list with &#39;a&#39; removed doesn&#39;t change
           (cons (car l) (rember1* a (cdr l))))  ; then recurse
          (else
            (cons (rember1* a (car l)) (cdr l)))))))) ; otherwise remove &#39;a&#39;

	


; Examples of rember1*
;
(rember1*
  &#39;salad
  &#39;((Swedish rye) (French (mustard salad turkey)) salad))
; ==&amp;gt; &#39;((Swedish rye) (French (mustard turkey)) salad)

(rember1*
  &#39;meat
  &#39;((pasta meat) pasta (noodles meat sauce) meat tomatoes))
; ==&amp;gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下面是letrec version of rember1&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;
(define rember1*-letrec
  (lambda (a l)
    (letrec
        ((R (lambda (l)
              (cond
                ((null? l) &#39;())
                ((atom? (car l))
                 (let ((first (car l))
                       (second (cdr l)))
                   (cond
                     ((eq? first a) second)
                     (else
                      (cons first (R second))))))
                 (else
                  (let ((first (car l))
                        (second (cdr l)))
                    (cond
                      ((equal? (R first) first) ; if the list with &#39;a&#39; removed doesn&#39;t change
                       (cons first (R second)))  ; then recurse
                      (else
                       (cons (R first) second))))))))) ; otherwise remove &#39;a&#39;
      (R l))))
(rember1*-letrec
  &#39;salad
  &#39;((Swedish rye) (French (mustard salad turkey)) salad))
(rember1*-letrec
  &#39;meat
  &#39;((pasta meat) pasta (noodles meat sauce) meat tomatoes))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the version of letcc (我暂时不太理解)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;; rember1* via letcc
;
(define rember1*-letcc
  (lambda (a l)
    (letrec
        ((rm (lambda (a l oh)
               (cond
                 ((null? l) (oh &#39;no))
                 ((atom? (car l))
                  (if (eq? (car l) a)
                      (cdr l)
                      (cons (car l) (rm a (cdr l) oh))))
                 (else
                  (let ((new-car
                         (call-with-current-continuation
                          (lambda (oh)
                            (rm a (car l) oh)))))
                    (if (atom? new-car)
                        (cons (car l) (rm a (cdr l) oh))
                        (cons new-car (cdr l)))))))))
      (let ((new-l
             (call-with-current-continuation
              (lambda (oh)
                (rm a l oh)))))
        (if (atom? new-l)
            l
            new-l)))))

; Tests of rember1*-letcc
;
(rember1*-letcc
 &#39;salad
 &#39;((Swedish rye) (French (mustard salad turkey)) salad))
; ==&amp;gt; &#39;((Swedish rye) (French (mustard turkey)) salad)

(rember1*-letcc
 &#39;meat
 &#39;((pasta meat) pasta (noodles meat sauce) meat tomatoes))
; ==&amp;gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)

(rember1*-letcc
 &#39;a
 &#39;((foo bar) baz))
; ==&amp;gt; &#39;((foo bar) baz)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the definition of union&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define union2
  (lambda (set1 set2)
    (letrec ((member? (lambda (a lat)
                (cond ((null? lat) #f)
                              ((eq? a (car lat)) #t)
                              (else (member? a (cdr lat))))))
             (A (lambda (set1)
                (cond
                  ((null? set1) set2)
                  (else
                   (let ((p1 (A (cdr set1))))
                     (if (member? (car set1) set2)
                         p1
                         (cons (car set1) p1))))))))
      (A set1))))
      (union2 &#39;(a b c) &#39;(c d e f))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the definition of intersect&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define intersect
  (lambda (set1 set2)
    (cond
      ((null? set1) &#39;())  ; don&#39;t forget the 1st commandment
      ((member? (car set1) set2)
       (cons (car set1) (intersect (cdr set1) set2)))
      (else
        (intersect (cdr set1) set2)))))
; Examples of intersect
;
;(intersect &#39;(a b x c d) &#39;(q w e x r t y a))     ; &#39;(a x)
;(intersect &#39;(a b x c d) &#39;())                    ; &#39;()
;(intersect &#39;() &#39;())                             ; &#39;()
;(intersect &#39;() &#39;(a b x c d))                    ; &#39;()
;(intersect &#39;(a b x c d) &#39;(a b x c d))           ; &#39;(a b x c d)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;intersect letrec version&lt;/p&gt;
&lt;p&gt;use letrec to remove arguments that do not change for recursive applications&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define intersect-letrec
  (lambda (set1 set2)
    (letrec
      ((I (lambda (set)
            (cond
              ((null? set) &#39;())
              ((member? (car set) set2)
               (cons (car set) (I (cdr set))))
              (else
                (I (cdr set)))))))
      (I set1))))

; Test of intersect-letrec
;
;(intersect-letrec &#39;(a b x c d) &#39;(q w e x r t y a))     ; &#39;(a x)
;(intersect-letrec &#39;(a b x c d) &#39;())                    ; &#39;()
;(intersect-letrec &#39;() &#39;())                             ; &#39;()
;(intersect-letrec &#39;() &#39;(a b x c d))                    ; &#39;()
;(intersect-letrec &#39;(a b x c d) &#39;(a b x c d))           ; &#39;(a b x c d)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the definition of intersectall&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;; The intersectall function finds intersect of a bunch of sets
;
(define intersectall
  (lambda (lset)
    (cond
      ((null? lset) &#39;())
      ((null? (cdr lset)) (car lset))
      (else
        (intersect (car lset)
                   (intersectall (cdr lset)))))))

; Examples of intersectall
;
;(intersectall &#39;((a) (a) (a)))                   ; &#39;(a)
;(intersectall &#39;((a) () (a)))                    ; &#39;()
;(intersectall &#39;())                              ; &#39;()
;(intersectall &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)

; Obeying the 12th commandment
;
(define intersectall-letrec
  (lambda (lset)
    (letrec
      ((A (lambda (lset)
            (cond
              ((null? (cdr lset)) (car lset))
              (else
                (intersect (car lset)
                           (A (cdr lset))))))))
      (cond
        ((null? lset) &#39;())
        (else (A lset))))))

; Tests of intersectall-letrec
;;
;(intersectall-letrec &#39;((a) (a) (a)))                   ; &#39;(a)
;(intersectall-letrec &#39;((a) () (a)))                    ; &#39;()
;(intersectall-letrec &#39;())                              ; &#39;()
;(intersectall-letrec &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)


(define intersectall-ap
  (lambda (lset)
    (call-with-current-continuation
      (lambda (hop)
        (letrec
          ((A (lambda (lset)
                (cond
                  ((null? (car lset)) (hop &#39;()))
                  ((null? (cdr lset)) (car lset))
                  (else
                    (I (car lset)
                       (A (cdr lset)))))))
           (I (lambda (s1 s2)
                (letrec
                  ((J (lambda (s1)
                        (cond
                          ((null? s1) &#39;())
                          ((member? (car s1) s2)
                           (cons (car s1) (J (cdr s1))))
                          (else
                            (J (cdr s1)))))))
                  (cond
                    ((null? s2) (hop &#39;()))
                    (else (J s1)))))))
          (cond
            ((null? lset) &#39;())
            (else (A lset))))))))

; Tests of intersectall-ap
;
;(intersectall-ap &#39;((a) (a) (a)))                   ; &#39;(a)
;(intersectall-ap &#39;((a) () (a)))                    ; &#39;()
;(intersectall-ap &#39;())                              ; &#39;()
;(intersectall-ap &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后再透过deep star的写法优化过程来体会TSS的函数精髓。
depthStar improvement&lt;/p&gt;
&lt;p&gt;通过depth进一步阐释letrec的意义（从原始的depth到depth-let 然后depth-let-if，以及更为清晰版本的depth-let-max,然后最后浓缩到最后的6行代码depth-max。
depth&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;; The depth* function finds the max depth of an s-expression

;
(define depth*
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l)) (depth* (cdr l)))
      (else
        (cond
          ((&amp;gt; (depth* (cdr l))
              (add1 (depth* (car l))))
           (depth* (cdr l)))
          (else
(add1 (depth* (car l)))))))))


(depth* &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth* &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth* &#39;(c (b (a b) a) a)) ; 3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;let version:
depth-let&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define depth*-let
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l)) (depth*-let (cdr l)))
      (else
       (let ((rightPart (depth*-let (cdr l)))
             (leftPart (add1 (depth*-let (car l)))))
         (cond
           ((&amp;gt; rightPart
               leftPart)
            rightPart)
           (else
            leftPart)))))))

(depth*-let &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-let &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-let &#39;(c (b (a b) a) a)) ; 3

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;let-if version:
depth-let-if&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define depth*-let-if
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l)) (depth*-let-if (cdr l)))
      (else
       (let ((rightPart (depth*-let-if (cdr l)))
             (leftPart (add1 (depth*-let-if (car l)))))
         (if (&amp;gt; rightPart leftPart)
            rightPart
            leftPart))))))

(depth*-let-if &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-let-if &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-let-if &#39;(c (b (a b) a) a)) ; 3

depth-let-max version:
depth-let-max
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;define depth*-let-max
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l)) (depth*-let-max (cdr l)))
      (else
       (let ((rightPart (depth*-let-max (cdr l)))
             (leftPart (add1 (depth*-let-max (car l)))))
         (max rightPart leftPart))))))

(depth*-let-max &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-let-max &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-let-max &#39;(c (b (a b) a) a)) ; 3

depth-max version:
depth-max

(define depth*-max
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l)) (depth*-max (cdr l)))
      (else
         (max (depth*-max (cdr l)) (add1 (depth*-max (car l))))))))

(depth*-max &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-max &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-max &#39;(c (b (a b) a) a)) ; 3

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;常用链接，&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/14/si-ji-mo-si-de-le-yuan-schemers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Scheme清单 &lt;/a&gt;
&lt;a href=&#34;https://groups.google.com/forum/#!forum/racket-users&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Google racket User group &lt;/a&gt;
&lt;a href=&#34;https://groups.google.com/forum/#!topic/racket-users/cPuTr8lrXCs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Gossip about the decision tree &lt;/a&gt;
GreghenderShoot 1970&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/greghendershott&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Github Repo &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/greghendershott/fear-of-macros&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Fear of macro &lt;/a&gt; Tell us the history of macro, overcome the fear of macro&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/greghendershott/frog&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; frog &lt;/a&gt; one static website generator tool&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.greghendershott.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; His Website &lt;/a&gt;
Tonyg&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/tonyg?tab=repositories&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Github Repo &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://tonyg.github.io/racket-bitsyntax/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; His opensource tools: Bitsyntax &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&#34;https://botbot.me/freenode/racket/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; racket freenote robot, Gossip Platform &lt;/a&gt;
Husk scheme&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/justinethier/husk-scheme&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; husk repo &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://justinethier.github.io/husk-scheme/manual/getting-started.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; husk get started &lt;/a&gt;
&lt;a href=&#34;https://github.com/alaricsp/chicken-scheme&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; chicken scheme &lt;/a&gt;
&lt;a href=&#34;http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-2.html#%25_toc_start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; R5RS html file &lt;/a&gt;
root of lisp&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.paulgraham.com/rootsoflisp.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; original site &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/hlpp/scheme/tree/master/tests&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; define implement &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;BTW, one very good vim tips, you can use &lt;a href=&#34;https://github.com/Shougo/vimfiler.vim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Vimfiler &lt;/a&gt;, with shortkey &lt;code&gt;m&lt;/code&gt; and then &lt;code&gt;r&lt;/code&gt; to rename the file in the editor page.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CPS Intutive</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/08/11/cps-intutive/</link>
      <pubDate>Fri, 11 Aug 2017 13:25:10 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/08/11/cps-intutive/</guid>
      <description>&lt;p&gt;通过deep&amp;amp;coB 和deepB的不同CPS实现，说明letcc版本是直接跳出surrounding，而不管周边的其他计算。 并且可以这样认为所有的scheme lambda表达式都可以理解为kn表达式的过程(好处1)，这种直观的解释方便理解 绕来绕去的过程。并且cps style尾巴的k既可以是变量也可以是函数 (好处2)。&lt;/p&gt;
&lt;h1 id=&#34;1-普通形式&#34;&gt;1. 普通形式&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;;; Normal Form
(define append2
  (lambda (lisa lisb)
    (cond
      ((null? lisa) lisb)
      (else
       (cons (car lisa) (append2 (cdr lisa) lisb))))))


(define fact
  (lambda (n)
    (if (zero? n)
         1
         (* n (fact (- n 1))))))

(fact 4)

&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;2-tail-form&#34;&gt;2. Tail form&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define append3
  (lambda (lisa lisb)
    (letrec ((ap2
              (lambda (a b)
                (cond
                  ((null? a) b)
                  (else (ap2 (cdr a) (cons (car a) b)))))))
      (ap2 (reverse lisa) lisb))))

(define fact2
  (lambda (n)
    (letrec ((fact-help (lambda (n help)
                          (if (zero? n)
                              help
                              (fact-help (- n 1) (* n help))))))
      (fact-help n 1))))
(fact2 4)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#3. deep&amp;amp;coB&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define deep&amp;amp;coB
  (lambda (m k)
    (cond
      ((zero? m)
       (let ()
         (set! toppings k)
         (k &#39;pizza)))
      (else
       (deep&amp;amp;coB (sub1 m)
                 (lambda (x)
                   (k (cons x &#39;()))))))))

(deep&amp;amp;coB 6 (lambda (x) x))         ; &#39;((((((pizza))))))
(deep&amp;amp;coB 4 (lambda (x) x)) ; &#39;((((pizza))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;cps风格 lambda(x) x ,可以使用k1 k2 k3 的风格进行替换,cps风格仅仅是编程的风格，letcc是其中的一种体现.&lt;/p&gt;
&lt;p&gt;#4. deepB&lt;/p&gt;
&lt;p&gt;letcc风格 直接跳出！！（也就是不管其他计算，直接他就是返回值！！）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;(define toppings 0)
(define deepB
  (lambda (m)
    (cond
      ((zero? m)
       (call-with-current-continuation
        (lambda (jump)
          (set! toppings jump)
          &#39;pizza)))
      (else
       (cons (deepB (sub1 m)) &#39;())))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#5. bons and kons&lt;/p&gt;
&lt;p&gt;进一步理解cps风格也可以看看kons和bons的实现&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-racket&#34;&gt;#lang racket
; kons the magnificent
;
(define kons
  (lambda (kar kdr)
    (lambda (selector)          ; returns lambda (selector)
      (selector kar kdr))))     ; calls selector with kar and kdr arguments

; kar
;
(define kar
  (lambda (c)                   ; applies selector on (a d) and returns &#39;a (car)
    (c (lambda (a d) a))))

; kdr
;
(define kdr
  (lambda (c)                   ; applies selector on (a d) and returns d (cdr)
    (c (lambda (a d) d))))

; Examples of kons kar kdr
;
(kar (kons &#39;a &#39;()))                 ; &#39;a
(kdr (kons &#39;a &#39;()))                 ; &#39;()
(kar (kdr (kons &#39;a (kons &#39;b &#39;())))) ; &#39;b
(kar (kons &#39;a (kons &#39;b &#39;()))) ; &#39;a
; Another cons
;
(define bons
  (lambda (kar)
    (let ((kdr &#39;()))
      (lambda (selector)
        (selector
         (lambda (x) (set! kdr x))
         kar
         kdr)))))

; Another kar
;
(define bar
  (lambda (c)
    (c (lambda (s a d) a))))

; Another kdr
;
(define bdr
  (lambda (c)
    (c (lambda (s a d) d))))

; set-kdr
;
(define set-kdr
  (lambda (c x)
    ((c (lambda (s a d) s)) x)))

; create kons using set-kdr and bons
;
(define kons2
  (lambda (a d)
    (let ((c (bons a)))
      (set-kdr c d)
      c)))

; Example of kons2 bar and bdr
;
(bar (kons2 &#39;a &#39;(1 2 3)))       ; &#39;a
(bdr (kons2 &#39;a &#39;(1 2 3)))       ; &#39;(1 2 3)
(define bad
  (lambda (x)
    (and (will-stop? bad)
         (eternity x))))
(define eternity
  (lambda (x)
    (eternity x)))

&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://cgi.soic.indiana.edu/~c311/lib/exe/fetch.php?media=cps-notes.scm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; cps变换教程 &lt;/a&gt;
2 &lt;a href=&#34;http://www.ece.uc.edu/~franco/C511/html/Scheme/ycomb.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Y combinator推导 &lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>批量修改pdf文件名以及创建wiki Links</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/07/05/pi-liang-xiu-gai-pdfwen-jian-ming-yi-ji-chuang-jian-wiki-links/</link>
      <pubDate>Wed, 05 Jul 2017 13:44:15 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/07/05/pi-liang-xiu-gai-pdfwen-jian-ming-yi-ji-chuang-jian-wiki-links/</guid>
      <description>&lt;p&gt;bash、awk、sed等的好处，就是可以专一的完成你的需求，但是也存在很多不足，借着批量重命令和批量导出链接到vimwiki的wiki中，形成[[local:文件名路径]]的过程，巩固学习linux命令, it is homework(learning process)。&lt;/p&gt;
&lt;h1 id=&#34;提取路径用于vimwiki中当作快速链接&#34;&gt;提取路径，用于vimwiki中，当作快速链接&lt;/h1&gt;
&lt;p&gt;如果IFS是”“，那么相当于一个文件名特别长会分成很多行显示，所以这边设置为 IFS=$‘\n’&lt;/p&gt;
&lt;p&gt;[a-z]star替换原先的star，目的是去除点号。
使用echo和管道命令传递信息给sed或者awk等
在sed中似乎用^$等位置字符进行替换,如果是文件夹则进行名字替换，并且遍历当前文件夹
使用双重for循环进行控制&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;IFS=$&#39;\n&#39;;
count=1;
countDir=1;
specialCharacter=&#39;pages&#39;;
generateChapter() # @Description : 对不同文件进行不同处理
                  # @usage       : generatechapter
{
    # 妙用find 得到当前目录的相对路径 不需要不断的进入目录
    for var2 in `find . -name &amp;quot;[a-z]*&amp;quot;`
    do
        if [[ -d  $var2 ]] # &amp;lt; cannot . Error
        then
            #echo &amp;quot;fuck&amp;quot;
            var=`echo $var2|sed &#39;s/^./F:\/ScienceBase.Attachments\/WindEnergy/g&#39;|sed &#39;s/^/[[local:/g&#39;|sed &#39;s/$/]]/g&#39;`
            printf &amp;quot;= $countDir. [ ] $var =\n&amp;quot; # 使用#号来删除之前的点号
            countDir=$(($countDir+1));

            for tempVar in `find $var2 -name &amp;quot;*.pdf&amp;quot;`
            do
                temp1=`echo $tempVar|sed &#39;s/^./F:\/ScienceBase.Attachments\/WindEnergy/g&#39;` 
    #            # echo ${var2} ${var2:0:$((${var2}-18))}.pdf  
                 varr=`echo $temp1|sed &#39;s/^/[[local:/g&#39;|sed &#39;s/$/]]/g&#39;`;
                #var=`echo $var2|sed &#39;s/^./F:\/ScienceBase.Attachments\/WindEnergy/g&#39;|sed &#39;s/^/[[local:/g&#39;|sed &#39;s/$/]]/g&#39;` 
                printf &amp;quot;\t$count. [ ] ${varr}\n&amp;quot; # 这边需要去除到第一个点号,这是才得到的处理方法
                count=$(($count+1));

            done
            count=1;
        fi
        

    done
}

generateChapter
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;删除不必要的名字特殊字符重命名&#34;&gt;删除不必要的名字特殊字符，重命名&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;删除文件pdf名字不必要的（pages 110—30）等信息。&lt;/li&gt;
&lt;li&gt;使用awk printf产生逗号分隔字符串，使用xargs -d, mv提取以逗号分隔的字段， 并且对文件名进行重命名（在我找的多种方法中，就他有效）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;xargs -n 2&lt;/code&gt; 表示按照空格划分的方式 提取两个参数，逐个进行。&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#!/bin/bash -
#===============================================================================
#
#          FILE: b.sh
#
#         USAGE: ./b.sh
#
#   DESCRIPTION: 
#
#       OPTIONS: ---
#  REQUIREMENTS: ---
#          BUGS: ---
#         NOTES: ---
#        AUTHOR: Ye Zhao Liang (Vimer), zhaoturkkey@163.com
#  ORGANIZATION: BrokenSun
#       CREATED: 2017/7/4 23:01:31
#      REVISION:  ---
#===============================================================================

IFS=$&#39;\n&#39;;
count=1;
countDir=1;
specialCharacter=&#39;pages&#39;;
generateChapter() # @Description : 对不同文件进行不同处理
                  # @usage       : generatechapter
{
    # 妙用find 得到当前目录的相对路径 不需要不断的进入目录
    #for var2 in `find . -name &amp;quot;*&amp;quot;`
    for var2 in `find . -name &amp;quot;windEnergy201*&amp;quot;`
    do
        if [[ -d  $var2 ]] # &amp;lt; cannot . Error
        then
                cd $var2;
                for var in `find . -name &amp;quot;*&amp;quot;`;do echo $var|awk &#39;/pages/{printf(&amp;quot;%s,%s&amp;quot;,$0,substr($0,0,length($0)-22)&amp;quot;.pdf&amp;quot;)|&amp;quot;xargs -d, mv &amp;quot;;}&#39;;done 
                cd ..;
        fi

    done
}

generateChapter

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意可以使用 ，学到技巧1中的检测工具，查看你的修改是否完全正确，如果出现文件名中有逗号的情况，通常pages没有删掉，原因是xargs也是按照，号进行分割，所以改进方法是使用分号输出&lt;/p&gt;
&lt;p&gt;改进代码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;for var in `find . -name &amp;quot;*&amp;quot;`;do echo $var|awk &#39;/pages/{printf(&amp;quot;%s;%s&amp;quot;,$0,substr($0,0,length($0)-22)&amp;quot;.pdf&amp;quot;)|&amp;quot;xargs -d; mv &amp;quot;;}&#39;;done 
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;最终结果&#34;&gt;最终结果&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-org&#34;&gt;= 1. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system]] =
  1. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch1.pdf]]
  2. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch10.pdf]]
  3. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch11.pdf]]
  4. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch12.pdf]]
  5. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch13.pdf]]
  6. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch14.pdf]]
  7. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch15.pdf]]
  8. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch16.pdf]]
  9. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch2.pdf]]
  10. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch3.pdf]]
  11. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch4.pdf]]
  12. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch5.pdf]]
  13. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch6.pdf]]
  14. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch7.pdf]]
  15. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch8.pdf]]
  16. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/ch9.pdf]]
  17. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/fmatter.pdf]]
  18. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/index.pdf]]
  19. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/harmonic power system/scard.pdf]]
= 2. [ ] [[local:F:/ScienceBase.Attachments/WindEnergy/Offshore Wind Energy Generation Control, Protection, and Integration to Electrical Systems/offshoreWindEnergy]] =

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#学到的技巧&lt;/p&gt;
&lt;p&gt;awk两种表示判断,if判断得用分号 &lt;a href=&#34;http://blog.csdn.net/qq_31382921/article/details/55094907&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 如果不用分号隔开会报错 &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注意分号！！&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-awk&#34;&gt;awk &#39;{if ($1==1) print &amp;quot;A&amp;quot;; else if ($1==2) print &amp;quot;B&amp;quot;; else print &amp;quot;C&amp;quot;}&#39;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;对应的bash使用的是if,then,else,fi的形式，且不用分号间隔语句&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
 for var in `find . -name &amp;quot;*&amp;quot;`
    do
        if [[ -d  $var ]] # &amp;lt; cannot . Error
        then
            printf &amp;quot;$var\n&amp;quot; # 使用#号来删除之前的点号
        else
            printf &amp;quot;\t${var}\n&amp;quot; # 这边需要去除到第一个点号,这是才得到的处理方法
        fi

    done
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;awk的’/page/{}‘等效于’if($0~/dfd/){}’
下面的命令，也是一种检查上述程序正确与否的一种工具,可以看出哪些pdf文件依然有pages的字段&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;YeZhao@DESKTOP-YeZhao /cygdrive/f/ScienceBase.Attachments/WindEnergy
$ find . -name &amp;quot;*&amp;quot;|awk &#39;{if($0~/pages/){print $0}}&#39;
./windEnergy2009-i6/Characterizing future large, rapid changes in aggregated wind power using Numerical Weather Prediction spatial fields (pages 542–555).pdf
./windEnergy2012-i1/Modeling wake effects in large wind farms in complex terrain the problem, the methods and the issues (pages 161–182).pdf
./windEnergy2012-i2/The Betz–Joukowsky limit on the contribution to rotor aerodynamics by the British, German and Russian scientific schools (pages 335–344).pdf
./windEnergy2012-i3/Computational fluid dynamics simulation of the aerodynamics of a high solidity, small-scale vertical axis wind turbine (pages 349–361).pdf
./windEnergy2012-i3/Correction factors for NRG #40 anemometers potentially affected by dry friction whip characterization, analysis, and validation (pages 489–502).pdf
./windEnergy2012-i4/Analysis of wake measurements from the ECN Wind Turbine Test Site Wieringermeer, EWTW (pages 575–591).pdf
./windEnergy2012-i5/Atmospheric stability and turbulence fluxes at Horns Rev—an intercomparison of sonic, bulk and WRF model data (pages 717–731).pdf
./windEnergy2013-11/Modeling, simulation and control of a wind turbine with a hydraulic transmission system (pages 1259–1276).pdf
./windEnergy2013-8/Indicial lift response function an empirical relation for finite-thickness airfoils, and effects on aeroelastic simulations (pages 681–693).pdf
./windEnergy2013-8/Simulating the dynamics of wind turbine blades part I, model development and verification (pages 694–710).pdf
./windEnergy2013-8/Simulating the dynamics of wind turbine blades part鈥塈I, model validation and uncertainty quantification (pages 741–758).pdf
..l
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#2. awk的&lt;a href=&#34;http://blog.csdn.net/panpan639944806/article/details/19932543&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; BEGIN &lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-awk&#34;&gt;function name()
{}

BEGIN{
}
{
    
}
END{

}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;3-awk--gsub-3&#34;&gt;3. awk &lt;a href=&#34;http://blog.sina.com.cn/s/blog_67e34ceb0100ybvg.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; gsub &lt;/a&gt;&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-awk&#34;&gt;echo &amp;quot;a b c 2011-11-22 a:d&amp;quot; | awk &#39;gsub(/-/,&amp;quot;&amp;quot;,$4)&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#4. awk变量定义&lt;/p&gt;
&lt;p&gt;BEGIN中&lt;a href=&#34;http://blog.csdn.net/shangboerds/article/details/49449291&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 定义1 &lt;/a&gt; , &lt;a href=&#34;http://jingyan.baidu.com/article/d45ad148fb46f269552b80cf.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; awk -v单行 &lt;/a&gt;定义变量&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.linuxidc.com/Linux/2015-04/115781.htm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; awk内置变量 &lt;/a&gt;, 包括FS,OFS,NR,NFR,NF,$0,$1,$2,ARGC,ARGV1等。&lt;/p&gt;
&lt;p&gt;#5.awk定义函数&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://bbs.chinaunix.net/thread-1424218-1-1.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; awk的函数定义 &lt;/a&gt;是在BEGIN{},{},END{}之外的，和他们平级的关系&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-awk&#34;&gt;#!/usr/bin/awk -f
#===============================================================================
#
#          File:  func.awk
# 
#   Description:  awk -f func.awk file
#           file内容为400
# 
#   VIM Version:  7.0+
#        Author:  Ye Zhao Liang (Vimer), zhaoturkkey@163.com
#  Organization:  BrokenSun
#       Version:  1.0
#       Created:  2017/7/5 16:06:33
#      Revision:  ---
#       License:  Copyright (c) 2017, Ye Zhao Liang
#===============================================================================
# 
function b()
{
print &amp;quot;b.in.$1=&amp;quot;$1;
}
{
v=100; y=200
print &amp;quot;a.in.v=&amp;quot;v;
print &amp;quot;a.in.y=&amp;quot;y;

a(y);
b();
print &amp;quot;a.out.v=&amp;quot;v;
print &amp;quot;a.out.y=&amp;quot;y;
}


function a(y)
{
print &amp;quot;(a)v=&amp;quot;v;
v=v+$1+y;
y=300;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;6bash四种变量截取&#34;&gt;6.bash四种变量截取&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;${var#.*} 从左到右，满足#之后条件的最小长度
${var##.*} 从左到右，满足##之后条件的最大长度
${var%.*} 从右到左，满足%之后条件的最小长度
${var%%.*} 从右到左，满足%%之后条件的最小长度
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在awk中可以使用substr($1,0,length($1)–..)实现类似的功能。&lt;/p&gt;
&lt;p&gt;#7.bash中的包含关系&lt;/p&gt;
&lt;p&gt;包含： 即一个大的部分包含小的部分（member) 等价： 即两个东西等价(equal) 比较：一般是两个数，另外也可以是字符串。&lt;/p&gt;
&lt;p&gt;bash几种&lt;a href=&#34;http://www.cnblogs.com/ginsonwang/p/5525340.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 包含关系用法  &lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;strA=&amp;quot;helloworld&amp;quot;
strB=&amp;quot;low&amp;quot;
if [[ $strA =~ $strB ]]
then
    echo &amp;quot;包含&amp;quot;
else
    echo &amp;quot;不包含&amp;quot;
fi
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#8.awk去除左右空格&lt;/p&gt;
&lt;p&gt;第5个知识点阐述了函数的定义方式,现在来运用一下， awk&lt;a href=&#34;http://www.cnblogs.com/ginsonwang/p/5525340.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 去除左右空格 &lt;/a&gt;，再一次使用中发现所有的文件名后缀中多了一个空格，于是尝试消掉空格，想着用awk实现。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-awk&#34;&gt;function ltrim(s) { sub(/^[ \t\r\n]+/, &amp;quot;&amp;quot;, s); return s }
function rtrim(s) { sub(/[ \t\r\n]+$/, &amp;quot;&amp;quot;, s); return s }
function trim(s) { return rtrim(ltrim(s)); }
BEGIN{
        FS=&amp;quot;,&amp;quot;
}

{
        $0 = rtrim($0);
        if($2!=&amp;quot;-&amp;quot; &amp;amp;&amp;amp; $3==&amp;quot;-&amp;quot;)
                a[$4]++;
        {
        if($4!=&amp;quot;-&amp;quot;)
                b[$4]++;
        else
                b[$5]++;
        }
}

END{
        print &amp;quot;   client    incr_num_day&amp;quot;;
        for(i in a) printf(&amp;quot;%10s   %d\n&amp;quot;,i,a[i])
        print &amp;quot;\n\n   client    all_num&amp;quot;;                                                                                                                                                     
        for(j in b) printf(&amp;quot;%10s   %d\n&amp;quot;,j,b[j]);
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#9.awk调用系统命令&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/cy_cai/article/details/41908921&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; MEthod &lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ready:
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;touch c.txt
touch d.txt&lt;/p&gt;
&lt;p&gt;II. a.txt:&lt;/p&gt;
&lt;p&gt;c.txt
d.txt&lt;/p&gt;
&lt;p&gt;III. code:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-awk&#34;&gt;awk &#39;{cmd=&amp;quot;rm &amp;quot;$0;system(cmd)}&#39; a.txt   
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;10awk重定向和管道&#34;&gt;10.awk重定向和管道&lt;/h1&gt;
&lt;p&gt;有时候直接可以在awk使用管道，提供给shell,比如print|Sort,&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-awk&#34;&gt;
awk &#39;{print $1, $2 | &amp;quot;sort&amp;quot; }&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#11.windows下的cygwin使用脚本&lt;/p&gt;
&lt;p&gt;必须得使用&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;dos2unix.exe *脚本名字
dos2unix.exe a.sh
dos2unix.exe func.awk


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样执行shell才有效。&lt;/p&gt;
&lt;h1 id=&#34;12awk性能比shell更高&#34;&gt;12.awk性能比shell更高&lt;/h1&gt;
&lt;p&gt;参考&lt;a href=&#34;http://www.cnblogs.com/chengmo/archive/2010/10/04/1842073.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 链接 &lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
性能比较

[chengmo@localhost nginx]# time (awk &#39;BEGIN{ total=0;for(i=0;i&amp;lt;=10000;i++){total+=i;}print total;}&#39;)
50005000

real    0m0.003s
user    0m0.003s
sys     0m0.000s
[chengmo@localhost nginx]# time(total=0;for i in $(seq 10000);do total=$(($total+i));done;echo $total;)
50005000

real    0m0.141s
user    0m0.125s
sys     0m0.008s 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结论：在awk中执行算术运算，比在bash中执行更好一些。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Racket Man Wanna Learn Datetype and Cases</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/05/30/racket-man-wanna-learn-datetype-and-cases/</link>
      <pubDate>Tue, 30 May 2017 21:11:25 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/05/30/racket-man-wanna-learn-datetype-and-cases/</guid>
      <description>&lt;p&gt;无意中，想到了 [ racket ][1] ，scheme家族中一员，那么亲切，lovely.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;Welcome to Racket v6.9.
&amp;gt; (/ 66 2)
33
&amp;gt; (/ 52.44 0.834493)
62.840551089104395
&amp;gt; (/ 52.44 0.834493)-62
62.840551089104395
-62
&amp;gt; (- (/ 52.44 0.834493) 62)
0.8405510891043946
&amp;gt; (* (- (/ 52.44 0.834493) 62) 360)
302.59839207758205
&amp;gt; exit;
#&amp;lt;procedure:exit&amp;gt;
&amp;gt; (exit)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复习列表:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;[ datetype ][2]&lt;/li&gt;
&lt;li&gt;[ cases ][3]&lt;/li&gt;
&lt;li&gt;[ First Interpreter From EOPL ][4]&lt;/li&gt;
&lt;li&gt;[ The Second Interpreter from one ][5]&lt;/li&gt;
&lt;li&gt;[ The third Interpreter with proc feature ][6]&lt;/li&gt;
&lt;li&gt;[ the fourth Interpreter with traceproc feature ][7]&lt;/li&gt;
&lt;li&gt;[ The fifth Interpreter with letrec feature ][8]
Read the EOPL book&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Deadline: 2017-06-30
[1]:http://racket-lang.org/
[2]:http://jueqingsizhe66.github.io/blog/2016/02/19/the-implementation-of-define-datetype/
[3]:http://jueqingsizhe66.github.io/blog/2016/02/23/casesde-zuo-yong/
[4]:http://jueqingsizhe66.github.io/blog/2016/02/25/first-interpreter-from-eopl/
[5]:http://jueqingsizhe66.github.io/blog/2016/02/27/the-second-interpreter-from-one/
[6]:http://jueqingsizhe66.github.io/blog/2016/02/27/the-third-interpreter-implementing-proc/
[7]:http://jueqingsizhe66.github.io/blog/2016/02/27/the-fourth-interpreter-about-the-traceproc/
[8]:http://jueqingsizhe66.github.io/blog/2016/02/28/the-fifth-interpreter-with-the-implementation-of-letrec-important/&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Ubuntu17.04 Install FAST8.16</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/05/19/ubuntu17-dot-04-install-fast8-dot-16/</link>
      <pubDate>Fri, 19 May 2017 19:31:22 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/05/19/ubuntu17-dot-04-install-fast8-dot-16/</guid>
      <description>&lt;p&gt;Something Noted in the process of installation FAST8.16 in the 32bit ubuntu17.04 system.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Download  &lt;a href=&#34;https://nwtc.nrel.gov/FAST8&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Fast8.16 &lt;/a&gt; and decompress&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
mkdir FAST-816
cd FAST-816
mv FAST*.tar.gz FAST-816
tar -xvf FAST*.tar.gz

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Download  &lt;a href=&#34;https://nwtc.nrel.gov/system/files/MAP_v1.20.10.tar.gz&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Map &lt;/a&gt; for generating map.so and decompress&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;FAST_DIR 告诉MAP FAST项目存在哪里&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
cd FAST-816
mkdir LIBMAP
cd LIBMAP
mv ../../*.MAP*.tar.gz .
tar -xvf *MAP*.tar.gz

cd compiling
vim driver_makefile&amp;lt;&amp;lt;EOF

----- FAST_DIR     = ../Source
+++++ FAST_DIR     = /paper/FAST-816/

EOF

cd ../src/

vim makefile&amp;lt;&amp;lt;EOF

----- BITS = -m64
+++++ BITS = -m32  32bit系统

EOF

make#################something error here


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;make Libmap.so something error here&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;a.o mapinit.o maperror.o lineroutines.o numeric.o outputstream.o mapapi.o lmroutines.o jacobian.o residual.o  -lm -llapacke 
/usr/bin/ld: 找不到 -llapacke
/usr/bin/ld: 找不到 -llapacke
collect2: error: ld returned 1 exit status
makefile:81: recipe for target &#39;all&#39; failed
make: *** [all] Error 1

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/04/15/ubuntu15-dot-10-32bit-an-zhuang-fastv8-dot-15/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; fixed it &lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
apt-get install lapacke-dev*

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;make again&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;make ### OK generate libmap-1.2.so

mkdir /paper/FAST-816/bin
cp libmap-1.20.10.so /paper/FAST-816/bin


&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Now Install FAST&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;
cd /paper/FAST-816/compiling/
make 
make -f makefile_DISCON_DLL ## for Test18-26.fst case


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;gcc -fbacktrack FAST_Subs&lt;/code&gt; 可能再gcc-6会有点问题，部分f90文件得删除该选项 删掉-fbacktrace测试通过&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
 2 &amp;gt; make
gfortran -I Obj_lin32 -O2 -m32 -fbacktrace -ffree-line-length-none -x f95-cpp-input -DNO_LibLoad -DUSE_DLL_INTERFACE -c ../Source/FAST_Subs.f90 -o Obj_lin32/FAST_Subs.o -J Obj_lin32 -B Obj_lin32
gfortran: internal compiler error: 已杀死 (program f951)
Please submit a full bug report,
with preprocessed source if appropriate.
See &amp;lt;file:///usr/share/doc/gcc-6/README.Bugs&amp;gt; for instructions.
makefile:416: recipe for target &#39;FAST_Subs.o&#39; failed
make: *** [FAST_Subs.o] Error 4
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Run Test1-18.fst&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You can go to /paper/FAST-816/bin to check whether FAST_Glin32 and libmap.so have been generated or not&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cd /paper/FAST-816/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
❯ ./FAST_glin32 ../CertTest/Test02.fst

 **************************************************************************************************
 FAST (v8.16.00a-bjj, 27-Jul-2016)

 Copyright (C) 2016 National Renewable Energy Laboratory

 This program comes with ABSOLUTELY NO WARRANTY. See the &amp;quot;license.txt&amp;quot; file distributed with this
 software for details.
 **************************************************************************************************

  Running FAST (v8.16.00a-bjj, 27-Jul-2016), compiled as a 32-bit application using single
  precision
  linked with NWTC Subroutine Library (v2.09.00, 23-Jul-2016)

  Heading of the FAST input file:
    FAST Certification Test #02: AWT-27CR2 with many DOFs with startup and shutdown and steady wind

  Running ElastoDyn (v1.04.00a-bjj, 26-Jul-2016).

  Running AeroDyn (v15.03.00, 27-Jul-2016).

  Running AirfoilInfo (v1.01.00a-bjj, 5-Apr-2016).

  Running BEM (v1.02.00, 29-Jun-2016).

  Running InflowWind (v3.03.00, 26-Jul-2016).
  Opening InflowWind input file:  ../CertTest/AWT27/Test02_InflowWind.dat

  Running ServoDyn (v1.06.00a-bjj, 26-Jul-2016).
  Timestep: 0 of 20 seconds.

 Timestep: 2 of 20 seconds. Estimated final completion at 16:05:13.                               
 Timestep: 4 of 20 seconds. Estimated final completion at 16:05:12.    


&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;
&lt;p&gt;Modify the ServoData for servo module
&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/10/22/fast-in-ubuntu64bit-bian-yi-zhu-yi-shi-xiang/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; DISON_DLL running &lt;/a&gt; 因为FAST在运行Test18-26.fst的case时候会去读取5MW_BASELINE[只针对的是5MW]底下的ServoData的文件, 所以对应dll-filename得修改一下。&lt;/p&gt;
&lt;p&gt;make DISCON SO file&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;❯ make -f makefile_DISCON_DLL
gfortran  -O2 -m32 -fbacktrace -ffree-line-length-none -x f95-cpp-input -C -DIMPLICIT_DLLEXPORT -fPIC -c ../CertTest/5MW_Baseline/ServoData/Source/DISCON.f90 -o Obj_lin32/DISCON.obj -J Obj_lin32 -B Obj_lin32
gfortran -shared -O2 -m32 -fbacktrace -fPIC -I Obj_lin32 -o ../CertTest/5MW_Baseline/ServoData/DISCON_glin32.so \
 Obj_lin32/DISCON.obj
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Change DLL_FileName in the configure data file
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cd /paper/FAST-816/CertTest/5MW_Baseline
vim NRELOffshrBsline5MW_Onshore_ServoDyn.dat 

修改DLL_FileName为 ServoData/DISCON_glin32.so
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Test RESULT:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
  Running BeamDyn (v1.01.04, 26-Jul-2016).

  Running AeroDyn (v15.03.00, 27-Jul-2016).

  Running AirfoilInfo (v1.01.00a-bjj, 5-Apr-2016).

  Running BEM (v1.02.00, 29-Jun-2016).
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 3

  Running InflowWind (v3.03.00, 26-Jul-2016).
  Opening InflowWind input file:  ../CertTest/5MW_Baseline/NRELOffshrBsline5MW_InflowWind_12mps.dat

    Reading a 31x31 grid (145 m wide, 17.5 m to 162.5 m above ground) with a characteristic wind
    speed of 12 m/s. This full-field file was generated by TurbSim (v1.06.00, 21-Sep-2012) on
    07-Jan-2014 at 12:50:45.

    Processed 1442 time steps of 20-Hz full-field data (72.05 seconds).

  Running ServoDyn (v1.06.00a-bjj, 26-Jul-2016).

  Running ServoDyn Interface for Bladed Controllers (using GNU Fortran for Linux, 14-Oct-2015).
  Timestep: 0 of 20 seconds.

 FAST_Solution0:CalcOutputs_And_SolveForInputs:SolveOption2:SrvD_CalcOutput:Running with torque
 and pitch control of the NREL offshore 5MW baseline wind turbine from DISCON.dll as written by J.
 Jonkman of NREL/NWTC for use in the IEA Annex XXIII OC3 studies.


 Timestep: 1 of 20 seconds. Estimated final completion at 16:20:36.                               

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Okay, All things have been done.&lt;/p&gt;
&lt;p&gt;Happy FAST programming.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>java开发nexus私服搭建</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/02/10/javakai-fa-nexussi-fu-da-jian/</link>
      <pubDate>Fri, 10 Feb 2017 00:04:33 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/02/10/javakai-fa-nexussi-fu-da-jian/</guid>
      <description>&lt;p&gt;针对一台全新的电脑，安装java开发的maven私服，记录如下，并在IDEA中进行测试。&lt;/p&gt;
&lt;p&gt;涉及到javase安装，maven安装，nexus私服安装，nexus本地配置，nexus界面介绍&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;安装JAVA jdk ,下载&lt;a href=&#34;http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;javaSE安装包&lt;/a&gt;,注意JDK和JRE不要放在同一文件夹下&lt;/li&gt;
&lt;li&gt;配置JAVA_HOME为JDk目录，并添加JDK的bin目录(%JAVA_HOME%\bin)到path中
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/java.png&#34; alt=&#34;java&#34;&gt;&lt;/li&gt;
&lt;li&gt;下载&lt;a href=&#34;http://maven.apache.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;maven&lt;/a&gt;,并解压缩，配置MAVEN_HOME为maven的根目录，并添加%MAVEN_HOME%\bin到path
中
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/home.png&#34; alt=&#34;home&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/bin.png&#34; alt=&#34;bin&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/java.png&#34; alt=&#34;mvn&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;显示了&lt;code&gt;mvn -v&lt;/code&gt;,也就表示装完了maven
4. 下载&lt;a href=&#34;https://www.sonatype.com/download-oss-sonatype&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;nexus2.14&lt;/a&gt;,在windows下使用管理员身份打开cmd，并cd到nexus的bin目录，进行安装&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nexus install
nexus start
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意一定得配置bin\jsw\wrapper.conf的java bin信息，否则出错。
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/wrapper.png&#34; alt=&#34;wrapper&#34;&gt;&lt;/p&gt;
&lt;p&gt;出现的错误为无法启动，
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/success.png&#34; alt=&#34;success&#34;&gt;&lt;/p&gt;
&lt;hr/&gt;
做完前面的几步之后只是，把配置环境弄完了，还得进行私服镜像配置。
首先打开nexus私服页面，使用`http://localhost:8089/nexus/#welcome `
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/nexus.png&#34; alt=&#34;nexus&#34;&gt;&lt;/p&gt;
&lt;p&gt;默认的登陆密码是
账号：admin
密码：admin123&lt;/p&gt;
&lt;p&gt;登陆完的界面
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/repositories.png&#34; alt=&#34;login&#34;&gt;&lt;/p&gt;
&lt;p&gt;配置中心仓库:&lt;/p&gt;
&lt;p&gt;中心仓库设置download remote indexes为真，为设置本地私服提供源。
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/central.png&#34; alt=&#34;central&#34;&gt;&lt;/p&gt;
&lt;p&gt;配置了release和snapshot仓库
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/release.png&#34; alt=&#34;release&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/snapshot.png&#34; alt=&#34;snapshot&#34;&gt;&lt;/p&gt;
&lt;p&gt;然后配置了第三方插件
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/third.png&#34; alt=&#34;third&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;进入最关键的public Repositories设置&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/public.png&#34; alt=&#34;public&#34;&gt;&lt;/p&gt;
&lt;p&gt;有时候可以使用试用Scheduled Tasks观看库的index是否正常进行。
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/schedule.png&#34; alt=&#34;scheduled&#34;&gt;&lt;/p&gt;
&lt;hr/&gt;
&lt;h2 id=&#34;imp&#34;&gt;镜像私服配置&lt;/h2&gt;
&lt;p&gt;maven中的settings.xml登陆私服的账户密码设置
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/user.png&#34; alt=&#34;user&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;servers&amp;gt;
    &amp;lt;server&amp;gt; 
        &amp;lt;id&amp;gt;nexus-release&amp;lt;/id&amp;gt;
        &amp;lt;username&amp;gt;admin&amp;lt;/username&amp;gt;
        &amp;lt;password&amp;gt;admin123&amp;lt;/password&amp;gt;
    &amp;lt;/server&amp;gt; 


    &amp;lt;server&amp;gt; 
        &amp;lt;id&amp;gt;nexus-snapshot&amp;lt;/id&amp;gt;
        &amp;lt;username&amp;gt;admin&amp;lt;/username&amp;gt;
        &amp;lt;password&amp;gt;admin123&amp;lt;/password&amp;gt;
    &amp;lt;/server&amp;gt; 


    &amp;lt;server&amp;gt; 
        &amp;lt;id&amp;gt;nexus&amp;lt;/id&amp;gt;
        &amp;lt;username&amp;gt;admin&amp;lt;/username&amp;gt;
        &amp;lt;password&amp;gt;admin123&amp;lt;/password&amp;gt;
    &amp;lt;/server&amp;gt; 
      &amp;lt;!-- server
     | Specifies the authentication information to use when connecting to a particular server, identified by
     | a unique name within the system (referred to by the &#39;id&#39; attribute below).
     |
     | NOTE: You should either specify username/password OR privateKey/passphrase, since these pairings are
     |       used together.
     |
    &amp;lt;server&amp;gt;
      &amp;lt;id&amp;gt;deploymentRepo&amp;lt;/id&amp;gt;
      &amp;lt;username&amp;gt;repouser&amp;lt;/username&amp;gt;
      &amp;lt;password&amp;gt;repopwd&amp;lt;/password&amp;gt;
    &amp;lt;/server&amp;gt;
    --&amp;gt;

    &amp;lt;!-- Another sample, using keys to authenticate.
    &amp;lt;server&amp;gt;
      &amp;lt;id&amp;gt;siteServer&amp;lt;/id&amp;gt;
      &amp;lt;privateKey&amp;gt;/path/to/private/key&amp;lt;/privateKey&amp;gt;
      &amp;lt;passphrase&amp;gt;optional; leave empty if not used.&amp;lt;/passphrase&amp;gt;
    &amp;lt;/server&amp;gt;
    --&amp;gt;
  &amp;lt;/servers&amp;gt;


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;镜像配置&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;注意url链接的端口设置&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
&amp;lt;mirrors&amp;gt;
&amp;lt;mirror&amp;gt;
    &amp;lt;id&amp;gt;nexus&amp;lt;/id&amp;gt;
    &amp;lt;mirrorOf&amp;gt;*&amp;lt;/mirrorOf&amp;gt;
    &amp;lt;url&amp;gt;http://localhost:8089/nexus/content/groups/public/&amp;lt;/url&amp;gt;
&amp;lt;/mirror&amp;gt;
&amp;lt;/mirrors&amp;gt;
&amp;lt;profiles&amp;gt;
&amp;lt;profile&amp;gt;
    &amp;lt;id&amp;gt;nexus&amp;lt;/id&amp;gt;
&amp;lt;repositories&amp;gt;
    &amp;lt;repository&amp;gt;
        &amp;lt;id&amp;gt;central&amp;lt;/id&amp;gt;
        &amp;lt;url&amp;gt;http://central&amp;lt;/url&amp;gt;
        &amp;lt;releases&amp;gt;&amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;&amp;lt;/releases&amp;gt;
        &amp;lt;snapshots&amp;gt;&amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;&amp;lt;/snapshots&amp;gt;
    &amp;lt;/repository&amp;gt;
&amp;lt;/repositories&amp;gt;
&amp;lt;pluginRepositories&amp;gt;
    &amp;lt;pluginRepository&amp;gt;
        &amp;lt;id&amp;gt;central&amp;lt;/id&amp;gt;
        &amp;lt;url&amp;gt;http://central&amp;lt;/url&amp;gt;
        &amp;lt;releases&amp;gt;&amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;&amp;lt;/releases&amp;gt;
        &amp;lt;snapshots&amp;gt;&amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;&amp;lt;/snapshots&amp;gt;
    &amp;lt;/pluginRepository&amp;gt;
&amp;lt;/pluginRepositories&amp;gt;
&amp;lt;/profile&amp;gt;
&amp;lt;/profiles&amp;gt;
&amp;lt;activeProfiles&amp;gt;
    &amp;lt;activeProfile&amp;gt;nexus&amp;lt;/activeProfile&amp;gt;
&amp;lt;/activeProfiles&amp;gt;



&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在maven中一般是需要设置下载控件jar包放在哪里,在没有私服的情况下，我一般
可以在setting.xml中设置localRepository&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   | Default: ${user.home}/.m2/repository
  &amp;lt;localRepository&amp;gt;/path/to/local/repo&amp;lt;/localRepository&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然IDEA在导入项目或者新建项目的时候都会提醒Environment Variable,设置一下setting和local repository
(类似的思路需要在myeclipse配置)
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/setting.png&#34; alt=&#34;impo&#34;&gt;
而私服nexus的存放地点，在nexus界面的时候就已经设置好了，所以也得在每台电脑操作一遍(&lt;font color=&#34;red&#34;&gt;一定不能错&lt;/font&gt;)。&lt;/p&gt;
&lt;p&gt;镜像的话，就不会执行maven的&lt;code&gt;mvn install&lt;/code&gt;等命令还一直向外部仓库访问链接，结果是访问的链接
都是本地的，可看下节测试。&lt;/p&gt;
&lt;h2 id=&#34;ida&#34;&gt;IDEA测试镜像私服&lt;/h2&gt;
现在只能通过这个激活了，下载license server
![license][20]
&lt;p&gt;测试结果如下:
&lt;code&gt;mvn site&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nexus/idea.png&#34; alt=&#34;idea&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;INFO] artifact org.springframework:spring-beans: checking for updates from nexus
[INFO] artifact org.springframework:spring-context: checking for updates from nexus
[INFO] artifact org.springframework:spring-context-support: checking for updates from nexus
[INFO] artifact org.springframework:spring-core: checking for updates from nexus
[INFO] artifact org.springframework:spring-expression: checking for updates from nexus
[INFO] artifact org.springframework:spring-instrument: checking for updates from nexus
[INFO] artifact org.springframework:spring-instrument-tomcat: checking for updates from nexus
[INFO] artifact org.springframework:spring-jdbc: checking for updates from nexus
[INFO] artifact org.springframework:spring-jms: checking for updates from nexus
[INFO] artifact org.springframework:spring-orm: checking for updates from nexus
[INFO] artifact org.springframework:spring-oxm: checking for updates from nexus
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;result&#34;&gt;结论&lt;/h2&gt;
&lt;p&gt;整个配置过程有效，测试通过，进一步可以参考&lt;a href=&#34;http://vdisk.weibo.com/s/za2TN71LdL1tl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;maven实战 许晓斌&lt;/a&gt;,里面包含了maven的坐标空间概念等，详细介绍了
maven系统的各个组成和集成测试环境的搭建。&lt;/p&gt;
&lt;p&gt;可以拓展阅读&lt;a href=&#34;http://blog.csdn.net/c1481118216/article/category/6250182&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;java blog&lt;/a&gt;
三个有用工具包:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/venusdrogon/feilong-platform&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;飞龙 javase javaee(国产)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://feilong-core.mydoc.io/?t=149471&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;飞龙特别用心的手册&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/venusdrogon/feilong-core/wiki/install&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;可以玩玩feilong-platform平台的安装 以及mvn site产生好看的javadoc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/looly/hutool&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Hutool javase(国产)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.hutool.cn/apidocs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;hutool API手册&lt;/a&gt;  &lt;a href=&#34;http://hutool.mydoc.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Hutool Wiki&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://ibeetl.com/guide/#beetl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;闲大赋 beetl 好用的模板引擎(国产)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://cn.vuejs.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;vue.js火热的前端js框架(国产)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>fortran读取csv文件</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/02/08/fortrandu-qu-csvwen-jian/</link>
      <pubDate>Wed, 08 Feb 2017 17:29:29 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/02/08/fortrandu-qu-csvwen-jian/</guid>
      <description>&lt;p&gt;本文只是简单对一个文件读取模块DFile_mod的一个运用，并读取逗号分隔的csv文件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortrandebug/csv/csv1.png&#34; alt=&#34;csvread&#34;&gt;&lt;/p&gt;
&lt;p&gt;FileMod.f90:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-fortran&#34;&gt;Module DFile_Mod
  Implicit None
  !!**************************************
  !*  识别文件的空格和逗号作为分隔符
  !!*************************************** 
contains 

subroutine binaryStreamType
implicit none
integer :: File_Unit
integer :: File_UnitOutput
   !!**************************************
    !* DFile_Mod 变量定义  100%
    !!*************************************** 
    Character(len=512) :: cLine
    integer :: nRow, nCol
    character(len=20) :: name=&amp;quot;yezhaoliang&amp;quot;,addr=&amp;quot;zhangzhou&amp;quot; 
    INTEGER :: I
type :: data_head
integer(kind=2) :: column
end type 

type(data_head) :: FileHead
!real,allocatable :: g(:,:)
real,allocatable :: firstColumn(:)
real,allocatable :: secondColumn(:)
real,allocatable :: thirdColumn(:)

 Open( NewUnit=File_Unit , File = &#39;./data/myfile.csv&#39; )
 Open( NewUnit=File_UnitOutput , File = &#39;./data/myfile12.csv&#39; )

  nRow = GetFileN( File_Unit )
  write( * , * ) &#39;文件共&#39;,nRow,&#39;行！&#39;
  read(File_Unit,*) FileHead
  write(*,*) &#39;m=&#39;,FileHead%column

  allocate(firstColumn(nRow-1))
  allocate(secondColumn(nRow-1))
  allocate(thirdColumn(nRow-1))
  
  !! 流方式读取
!  READ(File_Unit) g

250 format(3f10.4)  
251 format(I4,I4,f10.4)  
252 format (f10.4,A,f10.4,A,f10.4)
253 format (I4,A,I4,A,f10.4)
Do i = 1,nRow-1
    read(File_Unit,251) firstColumn(i),secondColumn(i),thirdColumn(i)
 end Do
  DO i = 1 ,nRow-1
   !write(*,&#39;(f10.4,A,f10.4,A,f10.4)&#39;)  firstColumn(i),&#39;,&#39;,secondColumn(i),&#39;,&#39;,thirdColumn(i)
   write(File_UnitOutput,253)  firstColumn(i)*2,&#39;,--&#39;,secondColumn(i)*2,&#39;,--&#39;,thirdColumn(i)
  end do

deallocate(firstColumn)
deallocate(secondColumn)
deallocate(thirdColumn)
close(File_Unit)
close(File_UnitOutput)

  !Do i = 1, nRow
  !  Do j = 1, FileHead%column
  !
  !  end do
  !end do
  
end subroutine binaryStreamType


subroutine testType
implicit none
integer :: File_Unit
integer :: File_UnitOutput
   !!**************************************
    !* DFile_Mod 变量定义  100%
    !!*************************************** 
    Character(len=512) :: cLine
    integer :: nRow, nCol
    character(len=20) :: name=&amp;quot;yezhaoliang&amp;quot;,addr=&amp;quot;zhangzhou&amp;quot; 
    INTEGER :: I
type :: data_head
integer(kind=2) :: column
end type 

type(data_head) :: FileHead
!real,allocatable :: g(:,:)
real,allocatable :: firstColumn(:)
real,allocatable :: secondColumn(:)
real,allocatable :: thirdColumn(:)

 Open( NewUnit=File_Unit , File = &#39;./data/A001.csv&#39; )
 Open( NewUnit=File_UnitOutput , File = &#39;./data/A0012.csv&#39; )

  nRow = GetFileN( File_Unit )
  write( * , * ) &#39;文件共&#39;,nRow,&#39;行！&#39;
  read(File_Unit,*) FileHead
  write(*,*) &#39;m=&#39;,FileHead%column

  allocate(firstColumn(nRow-1))
  allocate(secondColumn(nRow-1))
  allocate(thirdColumn(nRow-1))
  
  !! 流方式读取
!  READ(File_Unit) g

250 format(3f10.4)  
251 format(I4,I4,f10.4)  
252 format (f10.4,A,f10.4,A,f10.4)
253 format (I4,A,I4,A,f10.4)
Do i = 1,nRow-1
    read(File_Unit,251) firstColumn(i),secondColumn(i),thirdColumn(i)
 end Do
  DO i = 1 ,nRow-1
   !write(*,&#39;(f10.4,A,f10.4,A,f10.4)&#39;)  firstColumn(i),&#39;,&#39;,secondColumn(i),&#39;,&#39;,thirdColumn(i)
   write(File_UnitOutput,253)  firstColumn(i)*2,&#39;,--&#39;,secondColumn(i)*2,&#39;,--&#39;,thirdColumn(i)
  end do

deallocate(firstColumn)
deallocate(secondColumn)
deallocate(thirdColumn)
close(File_Unit)
close(File_UnitOutput)

  !Do i = 1, nRow
  !  Do j = 1, FileHead%column
  !
  !  end do
  !end do
  
end subroutine testType


  Integer Function GetDataN( cStr )
    Character( Len = * ) , Intent( IN ) :: cStr
    Integer :: i
    Logical :: bIsSeparator , bIsQuote
    GetDataN = 0
    bIsSeparator = .TRUE.
    bIsQuote = .FALSE.
    Do i = 1 , Len_Trim( cStr )
      Select Case( cStr(i:i) )
      Case( &#39;&amp;quot;&#39; , &amp;quot;&#39;&amp;quot; ) !// 如果遇到引号
        If ( .Not.bIsQuote ) GetDataN = GetDataN + 1  !//如果不在引号中，则增加一个数据
        bIsQuote = .Not.bIsQuote !// 引号结束或开始
        bIsSeparator = .FALSE.
      Case( &amp;quot; &amp;quot; , &amp;quot;,&amp;quot; , char(9) ) !// 如果遇到分隔符
        If ( .Not.bIsQuote ) then  !// 分隔符如果不在引号中
          bIsSeparator = .TRUE.
        End If
      Case Default      
        If ( bIsSeparator ) then
          GetDataN = GetDataN + 1
        End If
        bIsSeparator = .FALSE.
      End Select
    End Do
  End Function GetDataN
  
  Function f_numbervars(vars) result(numvars)
    character(len=*), intent(in) :: vars
    integer :: numvars
    character(len=len(vars)) :: tmpvars
    character(len=256) :: tmpvar
    tmpvars = trim(adjustl(vars))
    numvars = 0
    do while (len_trim(tmpvars) &amp;gt; 0)
      read(tmpvars, *) tmpvar
      numvars = numvars + 1
      tmpvars = tmpvars(index(tmpvars, trim(tmpvar))+len_trim(tmpvar):)
    end do
  End Function f_numbervars
  
  Integer Function GetFileN( iFileUnit )
  !// 此函数应在打开文件后立即调用。调用后读取位置返回文件起始位置
    Implicit None
    Integer , Intent( IN ) :: iFileUnit
    character( Len = 1 ) :: cDummy
    integer :: ierr
    GetFileN = 0
    Rewind( iFileUnit )
    Do
      Read( iFileUnit , * , ioStat = ierr ) cDummy
      If( ierr /= 0 ) Exit
      GetFileN = GetFileN + 1
    End Do
    Rewind( iFileUnit )
  End Function GetFileN 

End Module DFile_Mod


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;主函数main.f90:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-fortran&#34;&gt;program Main

use DFile_Mod
Implicit none

   INTEGER :: I
   !!**************************************
    !* DFile_Mod 变量定义  100%
    !!*************************************** 
    !Character(len=512) :: cLine
    !integer :: nRow, nCol
    !character(len=20) :: name=&amp;quot;yezhaoliang&amp;quot;,addr=&amp;quot;zhangzhou&amp;quot; 
    !**************************************
    !*  测试DFile_Mod   100%
    !*************************************** 
    
 !Open( 53 , File = &#39;./data/in.txt&#39; )
  !Open( 53 , File = &#39;./data/myfile.csv&#39; )
  !
  !nRow = GetFileN( 53 )
  !write( * , * ) &#39;文件共&#39;,nRow,&#39;行！&#39;
  !Do i = 1 , nRow
  !  read( 53 , &#39;(a512)&#39; ) cLine
  !  nCol = GetDataN( cLine )
  !  !nCol = f_numbervars( cLine )
  !  write( * , * ) i,&#39;行有&#39;,nCol,&#39;个数据&#39;
  !End Do
  call binaryStreamType

  Close( 53 )
  end program Main

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;配置文件in.txt:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1 2 3 , fsd
4 5 6 7 : asd
8 9 10 11 12
13 f sadf ! gad
14 15

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;载入visual studio基本上就能运行。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>perl读取mysql数据库</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/02/08/perldu-qu-mysqlshu-ju-ku/</link>
      <pubDate>Wed, 08 Feb 2017 17:25:49 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/02/08/perldu-qu-mysqlshu-ju-ku/</guid>
      <description>&lt;p&gt;perl中常见的文件打开关闭有open和IO模块等，而有时候涉及大量的
数据保存和打开的时候，就得借助数据库的使用，提供缓存的功能，并
使得保存的数据占用量最少，访问更快捷。下面就perl的mysql数据库访问
做一个简要的介绍。&lt;/p&gt;
&lt;h2 id=&#34;perldbi&#34;&gt;1. 数据库访问原理&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;加载对应数据库驱动&lt;/li&gt;
&lt;li&gt;获得相应的连接&lt;/li&gt;
&lt;li&gt;准备需要的查询数据 删除数据 更新数据&lt;/li&gt;
&lt;li&gt;执行sql语句&lt;/li&gt;
&lt;li&gt;获得相应的结果&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;perldbi&#34;&gt;2. perl DBI mysql实现&lt;/h2&gt;
&lt;p&gt;What is DBI?
&amp;ldquo;The DBI is the standard database interface module for Perl.
It defines a set of methods, variables and conventions that provide a
consistent database interface independent of the actual database being used.&amp;rdquo;
&amp;ndash; Tim Bunce&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;安装perl dbi&lt;/li&gt;
&lt;li&gt;安装perl dbd:mysql驱动&lt;/li&gt;
&lt;li&gt;加载数据库驱动dsn&lt;/li&gt;
&lt;li&gt;从dsn获取相应的链接connect方法&lt;/li&gt;
&lt;li&gt;执行相应的sql语句&lt;/li&gt;
&lt;li&gt;注意，处理完毕最好做一个关闭操作(&lt;font color=&#34;red&#34;&gt;&lt;strong&gt;这是一个技术问题，也是德行问题和习惯问题，编程的很多技术都是需要打开和关闭两个过程配对呈现&lt;/strong&gt;&lt;/font&gt;)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;具体可以参考&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://dbi.perl.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl dbi官网手册&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://log4think.com/perl_and_dbi/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Perl与数据库DBI快速入门&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.perl.com/pub/1999/10/DBI.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A short guid of the dbi programming&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cnblogs.com/homezzm/archive/2011/07/22/2113618.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl DBI 总结&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.sina.com.cn/s/blog_54dd80920102v8f5.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl dbi链接mysql中文乱码&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.jb51.net/article/65791.htm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;使用Perl DBI操作MySQL的一些建议&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://log4think.com/perl_fast_tutorial/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl快速入门&lt;/a&gt;&lt;font color=&#34;red&#34;&gt;** 给出了所有的技术语言都可以由main函数引出很多其他的, 把技术当成你的习惯**&lt;/font&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://vdisk.weibo.com/s/ah8r1yUxop3dO&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;一本perl参考书: Programming_the_Perl_DBI &lt;/a&gt;
该建议使用binmode解决乱码问题，&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use utf8;
binmode(STDOUT, &#39;:encoding(utf8)&#39;);
binmode(STDIN, &#39;:encoding(utf8)&#39;);
binmode(STDERR, &#39;:encoding(utf8)&#39;);
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.csdn.net/zzq900503/article/details/14454963&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl DBI使用详解&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;也可以直接在命令行使用&lt;code&gt;perldoc dbi&lt;/code&gt; 查看dbi文档信息&lt;/p&gt;
&lt;h2 id=&#34;perltest&#34;&gt; 3. 技术解决方案&lt;/h2&gt;
&lt;p&gt;feiji.txt:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;汽车在高速行驶时，根据空气动力学原理，在行驶过程中会遇到空气阻力，围绕汽车重心同时产生纵向、侧向和垂直上升的三个方向的空气动力量，其中纵向为空气阻力。
为了有效地减少并克服汽车高速行驶时空气阻力的影响，人们设计使用了汽车尾翼，其作用就是使空气对汽车产生第四种作用力，即产生较大的对地面的附着力，它能抵消一部分升力，有效控制汽车上浮，使风阻系数相应减小，使汽车能紧贴在道路地面行驶，从而提高行驶的稳定性能。

工作原理
汽车尾翼作用
汽车尾翼的作用，就是在汽车高速行驶时，使空气阻力形成一个向下的压力，尽量抵消升力，有效控制气流下压力，使风阻系数相应减小，增加汽车的高速行驶稳定性；由于尾翼能降低汽车的空气阻力，因此高速汽车加装尾翼对于节省燃油也有一定的帮助；同时也使汽车的外形更加美观，起到一定的装饰作用。
汽车尾翼分类
玻璃钢尾翼：这类尾翼造型多样，有鸭舌状的、机翼状的，也有直板式的．比较好做造型，不过玻璃钢材质比较脆，韧性和刚性都较差，价格比较便宜。
铝合金尾翼：这类尾翼导流和散热效果不错，而且价格适中，不过重量要比其他材质的尾翼稍重些。
碳纤维尾翼：碳纤维尾翼刚性和耐久性都非常好．不仅重量轻而且也是最美观的一种尾翼．现在广泛被F1赛车采用不过价格比较昂贵。[1] 

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;source code for perl:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;#!/usr/bin/env perl 
#===============================================================================
#
#         FILE: testdbi.pl
#
#        USAGE: ./testdbi.pl  
#
#  DESCRIPTION: 
#
#      OPTIONS: ---
# REQUIREMENTS: ---
#         BUGS: ---
#        NOTES: ---
#    Author:  Ye Zhaoliang
# ORGANIZATION: 
#      VERSION: 1.0
#      CREATED: 2016/12/31 1:44:24
#     REVISION: ---
#===============================================================================

use strict;
use warnings;
use utf8;

use CGI::Carp &amp;quot;fatalsToBrowser&amp;quot;;
use strict;
use warnings;
use DBI;
use CGI qw (:standard escapeHTML escape);
my ($driver_name, $db_name, $db_host, $db_sock, $db_port, $db_user, $db_pswd, $dsn);
$driver_name = &#39;mysql&#39;;
$db_name = &#39;mysql&#39;; # database name
$db_host = &#39;localhost&#39;;
$db_sock = &#39;/tmp/mysql.sock&#39;;
$db_port = &#39;3306&#39;;
$db_user = &#39;root&#39;;
$db_pswd = &#39;root&#39;;
# data source
$dsn = &amp;quot;dbi:mysql:database=${db_name};hostname=${db_host};mysql_socket=${db_sock};port=${db_port}&amp;quot;;
# ... set up connection to database (not shown) ...
# connect mysql database
my $dbh = DBI -&amp;gt; connect ($dsn, $db_user, $db_pswd,
{ RaiseError =&amp;gt; 1, PrintError =&amp;gt; 0 });
# put out initial part of page
my $title = &amp;quot;$db_name Database Browser&amp;quot;;
# html header and start_html h1
print header ();
print start_html (-titlk =&amp;gt; $title, -bgcolor =&amp;gt; &amp;quot;white&amp;quot;);
print h1 ($title);
# parameters to look for in URL
my $tbl_name = param (&amp;quot;tbl_name&amp;quot;);
my $sort_col = param (&amp;quot;sort_col&amp;quot;);
# If $tbl_name has no value, display a clickable list of tables.
# Otherwise, display contents of the given table. $sort_col, if
# set, indicates which column to sort by.

!defined ($tbl_name) ? display_table_names ($dbh, $db_name) : display_table_contents ($dbh, $tbl_name, $sort_col);
print end_html ();
sub display_table_names
{
my ($dbh, $db_name) = @_;

## html p paragraph
print p (&amp;quot;Select a table by clicking on its name:&amp;quot;);
# retrieve reference to single-column array of table names
my $ary_ref = $dbh -&amp;gt; selectcol_arrayref (qq{ SHOW TABLES FROM $db_name });
# Construct a bullet list using the ul() (unordered list) and
# li() (list item) functions. Each item is a hyperlink that
# re-invokes the script to display a particular table.
my @item;
foreach my $tbl_name (@{$ary_ref})
{
my $url = sprintf (&amp;quot;%s?tbl_name=%s&amp;quot;, url (), escape ($tbl_name));
my $link = a ({-href =&amp;gt; $url}, escapeHTML ($tbl_name));
push (@item, li ($link));
}
## list control
print ul (@item);
}
sub display_table_contents
{
my ($dbh, $tbl_name, $sort_col) = @_;
my @rows;
my @cells;
# if sort column not specified, use first column
$sort_col = &amp;quot;1&amp;quot; if !defined ($sort_col);
# present a link that returns user to table list page
# p control widget
print p (a ({-href =&amp;gt; url ()}, &amp;quot;Show Table List&amp;quot;));
print p (strong (&amp;quot;Contents of $tbl_name table:&amp;quot;));
## select from database
my $sth = $dbh -&amp;gt; prepare (qq{
SELECT * FROM $tbl_name ORDER BY $sort_col
LIMIT 200
});
$sth -&amp;gt; execute ();
# Use the names of the columns in the database table as the
# headings in an HTML table. Make each name a hyperlink that
# causes the script to be reinvoked to redisplay the table,
# sorted by the named column.
foreach my $col_name (@{$sth -&amp;gt; {NAME}})
{
my $url = sprintf (&amp;quot;%s?tbl_name=%s;sort_col=%s&amp;quot;,
url (),
escape ($tbl_name),
escape ($col_name));
my $link = a ({-href =&amp;gt; $url}, escapeHTML ($col_name));
push (@cells, th ($link));
}
push (@rows, Tr (@cells));
# display table rows
while (my @ary = $sth -&amp;gt; fetchrow_array ())
{
@cells = ();
foreach my $val (@ary)
{
# display value if non-empty, else display non-breaking space
if (defined ($val) &amp;amp;&amp;amp; $val ne &amp;quot;&amp;quot;)
{
$val = escapeHTML ($val);
}
else
{
$val = &amp;quot; &amp;quot;;
}
push (@cells, td ($val));
}
push (@rows, Tr (@cells));
}
# display table with a border
print table ({-border =&amp;gt; &amp;quot;1&amp;quot;}, @rows);
}

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>perl中文乱码问题</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/02/08/perlzhong-wen-luan-ma-wen-ti/</link>
      <pubDate>Wed, 08 Feb 2017 17:23:58 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/02/08/perlzhong-wen-luan-ma-wen-ti/</guid>
      <description>&lt;p&gt;binmode可以很好的解决perl中问题，采用&lt;a href=&#34;http://blog.chinaunix.net/uid-20735106-id-3438892.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Encode1&lt;/a&gt;,&lt;a href=&#34;http://www.jb51.net/article/16041.htm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Encode&lt;/a&gt;等方式不管用&lt;/p&gt;
&lt;p&gt;PerlFile.pl测试源码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;#!/usr/bin/env perl 
#===============================================================================
#
#         FILE: perlFile.pl
#
#        USAGE: ./perlFile.pl  
#
#  DESCRIPTION: 
#
#      OPTIONS: ---
# REQUIREMENTS: ---
#         BUGS: ---
#        NOTES: ---
#       AUTHOR: YOUR NAME (), 
# ORGANIZATION: 
#      VERSION: 1.0
#      CREATED: 2017/2/8 9:49:51
#     REVISION: ---
#===============================================================================

use strict;
use warnings;
use utf8;



binmode(STDIN,&amp;quot;:encoding(gb2312)&amp;quot;);
binmode(STDOUT,&amp;quot;:encoding(gb2312)&amp;quot;);

while ( &amp;lt;&amp;gt; ) {
    chomp;
    print $_,&amp;quot;\n&amp;quot;;
    last if $_ =~ m/q/xm;
}

open(FEIJI,&amp;quot;E:\\feiji.txt&amp;quot;) or die &amp;quot;can&#39;t open the file \n&amp;quot;;
my $car =&amp;quot;尾翼&amp;quot;;

	• binmode(FEIJI,&amp;quot;:encoding(gb2312)&amp;quot;);
# binmode( STDIN,  &#39;:encoding(gbk2312)&#39; );
 #binmode( FEIJI,  &#39;:encoding(utf8)&#39; );
 #binmode( STDOUT, &#39;:encoding(gbk2312)&#39; );   
 #binmode( STDERR, &#39;:encoding(gbk2312)&#39; ); 
#while( my $line = &amp;lt;FEIJI&amp;gt;){
#my $re = Encode::decode(&#39;GB2312&#39;,&#39;汽车&#39;);
 my $count=1;
 while( &amp;lt;FEIJI&amp;gt;){
     #print &amp;quot;$_ \n&amp;quot; ;
    #     print &amp;quot;$_ \n&amp;quot; if $_ =~ /.*$re.*/;
#    Encode::_utf8_on($_);
    #    Encode::decode_utf8($_);
    #print &amp;quot;$_\n&amp;quot; ;#if $_ =~ m/$car/xm;
    #print &amp;quot;$count: $_\n&amp;quot; if $_ =~ m/$car/xm;
    #$count +=1;

     s/汽车/风力机/g;
    print;
    }

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>FAST调试</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/02/07/fastdiao-shi/</link>
      <pubDate>Tue, 07 Feb 2017 20:01:15 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/02/07/fastdiao-shi/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://nwtc.nrel.gov/FAST8&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NREL FAST&lt;/a&gt;的调试一直存在问题，关键是不知道怎么设置选项，查阅了Visual Studio和一些基本知识整理了
NREL项目的调试方法。&lt;/p&gt;
&lt;h2 id=&#34;fortran工作路径问题&#34;&gt;fortran工作路径问题&lt;/h2&gt;
&lt;p&gt;&lt;font color=&#34;green&#34;&gt;&lt;strong&gt;工作路径对于任何的可执行文件都很重要。&lt;/strong&gt;&lt;/font&gt;
当然事先可能得了解一下软件编译链接的过程（即编写源代码&amp;ndash;调用编译器编译源代码&amp;ndash;
&amp;gt;调用链接器连接相关代码块生成可执行文件&amp;ndash;&amp;gt;运行可执行文件）(IDE隐藏了上述过程)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果不带任何路径，则被认为是当前路径(&lt;font color=&#34;green&#34;&gt;&lt;strong&gt;working directory&lt;/strong&gt;&lt;/font&gt;)。&lt;/li&gt;
&lt;li&gt;如果带相对路径，则以当前路径为基准。&lt;/li&gt;
&lt;li&gt;通过命令行执行，当前路径一般在提示符上(或&lt;font color=&#34;red&#34;&gt;pwd&lt;/font&gt;命令查看)&lt;/li&gt;
&lt;li&gt;直接&lt;font color=&#34;red&#34;&gt;&lt;strong&gt;双击&lt;/strong&gt;&lt;/font&gt;,当前路径在exe所在的文件夹。&lt;/li&gt;
&lt;li&gt;通过&lt;font color=&#34;red&#34;&gt;&lt;strong&gt;IDE&lt;/strong&gt;&lt;/font&gt;方式运行，当前路径一般在&lt;font color=&#34;red&#34;&gt;&lt;strong&gt;工程所在文件夹&lt;/strong&gt;&lt;/font&gt;&lt;/li&gt;
&lt;li&gt;一些IDE还允许设置当前路径(只对IDE方式运行有效)。&lt;/li&gt;
&lt;li&gt;右键exe名字也是可以指定运行路径的（这样就可以加载对应的配置文件)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;比如:&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortrandebug/idewd.png&#34; alt=&#34;IDE working directory&#34;&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2 id=&#34;代码层级改变文件路径&#34;&gt;代码层级改变文件路径&lt;/h2&gt;
&lt;p&gt;在程序中可以通过一些手段，动态的更改当前路径。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IVF: changeDirQQ&lt;/li&gt;
&lt;li&gt;gfortran: ChDir&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;也可以通过一些手段，获得当前路径，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IVF/gforran: GetCWD&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-fortran&#34;&gt;
program testDir
    Implicit none
    CHARACTER(len=512) ::  working_path
    call GET_COMMAND_ARGUMENT(0 , working_path);
    write(*,&#39;(a,/,a)&#39;) &#39;exe path: &#39;, trim(working_path);
    call GETCWD(working_path)
    write(*,&#39;(a,/,a)&#39;) &#39;Working Directory: &#39;, trim(working_path);
end program testDir

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;输出:&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;exe path:

D:\testCWD\Debug\test_cwd.exe

working directory:
D:\testCWD
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;调试fast&#34;&gt;调试FAST&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortrandebug/fast.jpg&#34; alt=&#34;fast&#34;&gt;
最关键的是一个对应两个设置&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一个对应指的是第二步的Linker的output File的exe名字和第三步的General底下的TargetName对应上&lt;/li&gt;
&lt;li&gt;两个设置是指在Debuging对Command Arguments和Working Directory的设置。Command Argument指定文件名字
Working Directory指定文件路径。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;设置完就可以开始调试了。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Perl_Summary</title>
      <link>https://jueqingsizhe66.github.io/blog/2017/01/22/perl-summary/</link>
      <pubDate>Sun, 22 Jan 2017 19:18:50 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2017/01/22/perl-summary/</guid>
      <description>&lt;p&gt;why need perl? If you need strong text regex processing ,use perl!&lt;/p&gt;
&lt;p&gt;One paragraph I copied from &lt;code&gt;perldoc perlintro&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;The language is intended to be &lt;font color=&#34;red&#34;&gt;practical&lt;/font&gt; (easy to use, efficient,
complete) rather than beautiful (tiny, elegant, minimal). Its major
features are that it&amp;rsquo;s easy to use, supports both procedural and
object-oriented (OO) programming, has powerful built-in support for text
processing, and has one of the world&amp;rsquo;s most impressive collections of
third-party modules.&lt;/p&gt;
&lt;p&gt;To me, perl means a report programmer with practical experience.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cnblogs.com/leezx/p/5607753.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl基础&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cnblogs.com/leezx/p/5755237.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl语法速查&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cnblogs.com/leezx/p/5617239.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl高级特性&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cnblogs.com/leezx/p/5589602.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;some difference between -&amp;gt; and =&amp;gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://storagebar.blog.51cto.com/211112/70680&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;How to Program Perl&lt;/a&gt;
You need to practice ,think, and share(your final target).&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://storagebar.blog.51cto.com/211112/70718&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Teach yourself Programming in ten years&lt;/a&gt;
You need to talk to other programmer, they are all good people(Just think they are).&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>a little java note</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/10/09/a-little-java-note/</link>
      <pubDate>Sun, 09 Oct 2016 01:58:39 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/10/09/a-little-java-note/</guid>
      <description>&lt;div align=&#34;center&#34;&gt;目录&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;1. 基础部分&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;2. 通过构造函数，构造出Natural recursion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;3. 重新设计RemAV RemFishV RemIntV&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt;4. 下一步把PieD的字段放入到对应的参数当中&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5&#34;&gt;5. 引入 this 关键字，指代访问者本身，同步修改对应的访问者类&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6&#34;&gt;6. 需要进一步提取出visitor部分的函数	&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7&#34;&gt;7. 统一bTreeVisitorI itreevisitori ttreevisitori&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#8&#34;&gt;8. 重新设计RemAV RemFishV  RemIntV 为RemV(用Object替换）	&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#9&#34;&gt;9. 然后现在把Remv 和Subst重新放入PieD&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#10&#34;&gt;10. 紧接着 我们还想着把Remv  SubstV放入参数的位置&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#11&#34;&gt;11. 紧接着我们可以进行下一步抽象	&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#12&#34;&gt;12. 紧接着我们发现rem和subst代码类似	&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#13&#34;&gt;13. 然后再实现Set集合类型&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#14&#34;&gt;14. SetEvalV直接继承IntEvalV不合理?	&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#15&#34;&gt;15. IntEvalD 和SetEvalD很多相似之处	&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#16&#34;&gt;16. 根据extends使用Override增加函数的丰富性	&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;视角没想到可以分成不同的classes，并在此基础上进行extends和implement，最终new通过constructors创造不同的value。两级在于基础元件和功能元件两部分。两级也可以分为extends和implements。集于一个class。&lt;/p&gt;
&lt;p&gt;学完&lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BALJ/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;《a little java》&lt;/a&gt;的心得,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;构造函数：new通过构造函数，产生了datatype的值；构造函数由此进行了natural recursion， 并通过一个基类退出循环（详见PieD).new create values.&lt;/li&gt;
&lt;li&gt;This,一般指向当前对象，但是在函数式编程中，this可能指代的是当前对象之后的所有剩余对象
&amp;ldquo;this&amp;quot;指代的是自指对象 也就是函数某某的实例化对象，并且是一直不变的。Just self-referential，because this is a RemV, and it is exactly what we need to complete the job. 所以this指代函数莫某的对象&lt;/li&gt;
&lt;li&gt;Top某某函数询问某种来自函数某某的forTop功能 ，并传递构造函数的fields值(properties）以及该某某函数comsumes的objects（arguments)&lt;/li&gt;
&lt;li&gt;升级版本 the method accepts a visitor(该visitor接口包含了forTop forBot抽象方法，该接口统一了不同的函数某某，所以所有函数某某统称为accept函数某某）and ask for its services， so we call it accept， 而该接口的通常实例化对象也被叫做ask， ask for services.&lt;/li&gt;
&lt;li&gt;Object类型可以抽象int boolean 其他类型&lt;/li&gt;
&lt;li&gt;函数的抽象大体表现为参数数据类型，返回值数据类型和函数body的具体实现。
a.	参数数据类型
b.	返回值数据类型
c.	body具体实现&lt;/li&gt;
&lt;li&gt;简化（简洁）、拓展性、方便&lt;/li&gt;
&lt;li&gt;当我们的参数值从method变到fields，我们就没必要在反复调用对象的方法的时候 需要不断地comsume，而同时又保证了this对象，也就是不断地自指（期间不产生新的fields）所以也就是使得计算加快了。这也是this存在的原因（并且该this对象只用在访问者对象中）&lt;/li&gt;
&lt;li&gt;We know that a visitorI contains one method each for the Circle, Square, and Trans variants,. And each of these methods
Consumes the fields of the respective kinds of objects(objects of types)
某某对象的某某函数，（携带函数某某和字段） 询问函数某某的for对象某某功能，（携带对象某某）
某某对象的accept携带ask并内部由 ask 的for对象某某携带对象某某组成，而for对象某某携带对象某某并内部由对象某某的accept携带当前ask对象构成。
某某对象的accept携带ask并内部由 ask 的for对象某某组成，而for对象某某携带对象某某并内部由对象某某的accept组成。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在对象内部，某某对象的accept携带ask并内部由 ask 的for对象某某携带对象某某组成，而在visitor内部，for对象某某携带对象某某并内部由对象某某（也就是consumes the fields of the respective kinds of objects 占据对象类型的字段属性）的accept携带当前ask对象构成。
We don&amp;rsquo;t specify fields in interfaces. And in 7 W hatever.
any case, we don&amp;rsquo;t want anybody else to
see p.
This and that在对象间传递，而consume在函数间传递（Hangs over back and forth(fields 在对象间传递，而consume在函数间传递)
10.	该书包含着TLS TSS 和prolog编程的思想(因为你要理解new Top new Bot等需要有fact and rule的意识)（仔细去品尝 go to absorb) 还有就是skeleton and techniques技术
11.	Extends interface,this extension produces an interface that contains all the obligations(i.e. names of methods and what they consume and produce) of shapeVisitorI and the additional one named forUnion(所以换个角度说，one class can implement many interfaces.
12.	重载override 相同的名字带着不同的输入类型
13.	点号可以读作 from   点号之前叫做from who  点号之后叫做service
14.	解释的重点是什么？？？ 要点是什么&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/alittlejava/duichen.png&#34; alt=&#34;duichen&#34;&gt;&lt;/p&gt;
&lt;p&gt;什么是思考力的三要素，讲这个问题之前我们先来了解一下什么是思考思维，首先思考是思维的一种探索活动，而在思维过程中产生的一种具有积极性和创造性的作用力这种就是思考力。据物理学理解，思考力具有三个基本要素：分别为大小、方向、作用点。思考力同样也离不开三个基本要素：分别为大小、方向、作用点。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;大小 ——思考力首先取决于思考者掌握的关于思考对象的知识和信息量（大小），如果没有相关的知识和信息，就不可能产生相关的思考活动。一般情况下，知识量和信息量越大，思考就越加具体、全面和完整，从而决定了思考的维度。&lt;/li&gt;
&lt;li&gt;方向 ——我们这里所说的思考有别于妄想和幻想，而是一种有目的性和有计划性的思维活动，因此，这种思考需要有一定的价值导向，也就是思路——体现为目的性、方向性和一致性。漫无目的地思考难以发挥强有力的思考力，常常会把思考引进死胡同，导致思路夭折和无果而终。目的性、方向性、一致性和价值导向，决定着思考的角度和向度。&lt;/li&gt;
&lt;li&gt;作用点 ——必须把思考集中在特定的对象上，并把握其中的关键点，这样的思考就会势如破竹。如果找不准思考的着力点，就会精力分散、思维紊乱、胡思乱想，出现东一榔头西一棒的现象。思考就会停留在事物的表面上浮光掠影，无法深刻认识事物的本质。思考在作用点上的集中性程度，决定着思考的强度和力度(广度和深度）。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;1&#34;&gt;基础部分&lt;/h3&gt;
&lt;p&gt;理解分层。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;KebabD(chapter2) 烤肉
    isVeggie();
    whatHolder();
        Holder 烤肉摆放工具
            Object;
            Holder(Object);
            isVeggie();
            whatHolder();
        Shallot  葱
            KebabD;
            Shallot(KebabD);
            isVeggie();
            whatHolder();
         
        Shrimp 虾
            KebabD;
            Shrimp (KebabD);
            isVeggie();
            whatHolder();
             
        Radish 萝卜
            KebabD;
            Radish (KebabD);
            isVeggie();
            whatHolder();
         
        Pepper 胡椒粉
            KebabD;
            Pepper (KebabD);
            isVeggie();
            whatHolder();
             
        Zucchini 西葫芦
            KebabD;
            Zucchini (KebabD);
            isVeggie();
            whatHolder();
         
 
RodD(chapter2) 杆  将烤肉串起来工具(烤肉摆放方式1）
    Dagger 匕首
    Sabre 军刀
    Sword 剑
     
PlateD(chapter2) 盘子  （烤肉摆放方式2)
    Gold 金盘子
    Silver
    Brass 黄铜盘子
    Copper 镀铜盘子
    Wood   木盘子
 
PointD(chapter1,2) 点
    distanceTo0(int,int); //可以把它们移入到构造函数中
    closerTo0();
        CartesianPt 笛卡尔坐标
            Int
            Int
            CartesianPt(int,int);
            distanceTo0();
            Closeto0();
        ManhattenPt 曼哈顿坐标
            Int
            Int
            ManhattenPt(int,int);
            distanceTo0();
            Closeto0();
         
        圆柱坐标系
        球坐标系
 
PieD
 
 
PizzaD（chapter3,4）
    remA 去除比萨饼的凤尾鱼订料（防止过咸）
    topAwC() 在凤尾鱼顶料加上奶酪顶料（盖住咸味）
    subAbC() 将所有的凤尾鱼顶料换成奶酪顶料
        Crust 面包皮
            remA();
            topAwC();
            subAbC();
        Cheese  奶酪
            pizzaD
            Cheese(PizzaD)
            remA();
            topAwC();
            subAbC();
         
        Olive   橄榄
            pizzaD
            Olive(PizzaD)
            remA();
            topAwC();
            subAbC();
             
        Anchovy 凤尾鱼
            pizzaD
            Anchovy(PizzaD)
            remA();
            topAwC();
            subAbC();
             
        Sausage 香肠
            pizzaD
            Sausage(PizzaD)
            remA();
            topAwC();
            subAbC();
        Spinach 菠菜
            pizzaD
            Spinach(PizzaD)
            remA();
            topAwC();
            subAbC();
         
 
 
 
Shape
 
Shish(chapter2，4) 羊肉串
    onlyOnions(); 
    isVegetarian();
        Skew 架子 烤肉叉子
        Onion 洋葱
        Lamb  羔羊肉
        Tomato 西红柿
         
 
Tree


SeasoningD (chapter1) 调味品
    Sage(鼠尾草)
    Pepper
    Salt
    Thyme(百里香)
 
NumD (chapter1)
    Zero
    OneMoreThan
 
LayerD
    Base
    Slice
 
FruitD

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;第二条建议&lt;/strong&gt;
When writing a function over a datatype,
place a method in each of the variants that make up the datatype.
If a field of a variant belongs to the same datatype,
the method may call the corresponding method of the field in
computing the function.（疑问子类 每继承一次父类 都得重写三个父类的抽象函数 有点费事。。 &amp;mdash;-那么访问者模式到底是如何解决的？）
&lt;strong&gt;第八条建议&lt;/strong&gt;
When extending a class, use overriding
to enrich its functionality.&lt;/p&gt;
&lt;p&gt;根据以上建议， LtdSubstV 可以直接在 SubstV 类上进行继承和扩展。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Shish(chapter2，4) 羊肉串
   OnlyOnionsV
   IsVegetarianV
   onlyOnions(); 
   isVegetarian();
        Skew 架子 烤肉叉子
            onlyOnions();
            isVegetarian();
        Onion 洋葱
            ShishD
            Onion(ShishD);
            onlyOnions();
            isVegetarian();
        Lamb  羔羊肉
            ShishD
            Lamb(ShishD);
            onlyOnions();
            isVegetarian();
             
        Tomato 西红柿
            ShishD
            Tomato(ShishD);
            onlyOnions();
            isVegetarian();


OnlyOnionsV 
    forSkew();
    forOnion(ShishD);
    forLamb(ShishD);
    forTomato(ShishD);
 
isVegetatianV
    forSkew();
    forOnion(ShishD);
    forLamb(ShishD);
    forTomato(ShishD);
     
 
ShishD
   OnlyOionsV ooFn
   IsVegeterian ivFn
   onlyOnions()a;
   isVegetarian()a;
        Skew
            onlyOnions();
            isVegetarian();
        Onion
            onlyOnions();
            isVegetarian();
        Lamb
            onlyOnions();
            isVegetarian();
        Tomato
            onlyOnions();
            isVegetarian();
         
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2&#34;&gt;通过构造函数，构造出Natural recursion部分，形成递归，递归出口为skew&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;RemAV
    forCurst();
    forCheese(PizzaD);
    forOlive(PizzaD);
    forAnchovy(PizzaD);
    forSausage(PizzaD);

TopAwCV
    forCurst();
    forCheese(PizzaD);
    forOlive(PizzaD);
    forAnchovy(PizzaD);
    forSausage(PizzaD);

SubAbCV
    forCurst();
    forCheese(PizzaD);
    forOlive(PizzaD);
    forAnchovy(PizzaD);
    forSausage(PizzaD);
 
 
PizzaD 
   RemAV remFn
   TopAwCV topFn
   SubAbCV  subFn
   remA()a;
   topAwC()a;
   subAbC()a;
        Crust
            remA();
            topAwC();
            subAwC();
        Cheese
            PizzaD
            Cheese(PizzaD)
            remA();
            topAwC();
            subAwC();
        Olive
            PizzaD
            Olive(PizzaD)
            remA();
            topAwC();
            subAwC();
        Anchovy
            PizzaD
            Anchovy(PizzaD)
            remA();
            topAwC();
            subAwC();
        Sausage
            PizzaD
            Sausage(PizzaD
            remA();
            topAwC();
            subAwC();


PieD
    RemAV raFn
    RemFish rfFn
    remA()a;
    remFish(FishD)a;
        Bot
            remA();
            remFish(FishD);
        Top
            Object
            PieD
            Top(Object, PieD)
            remA();
            remFish(FishD);
             
FishD
    Salmon 鲑鱼
    Equals(Object);
    Anchovy 凤尾鱼
    Equals(Object);
    Tuna  金枪鱼
    Equals(Object);
 
RemAV
    forBot
    fotTop(Object, PieD)
RemFishV
    forBot(FishD)
    forTop(Object, PieD,  FishD)
 
RemIntV
    forBot(int)
    forTop(Object, pieD, Integer)
     
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3&#34;&gt;重新设计RemAV RemFishV  RemIntV 为RemV(用Object替换）&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;RemV
    forBot(Object)
    forTop(Object, pieD, Object)

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4&#34;&gt;下一步把PieD的字段放入到对应的参数当中&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;
abstract class PieD {
    abstract PieD rem(RemV remFn, Object o);
    abstract PieD subst(SubstV substFn, Object n, Object o);
}
 
PieD 
    Rem()a;
    Subst()a;
        Top
            Top(Object,Object)
            Rem();
            Subst();
        Bot
            Bot(Object,Object)
            Rem();
            Subst();

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5&#34;&gt;引入 this 关键字，指代访问者本身，同步修改对应的访问者类。&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PieD 
    Rem(Remv)a;
    Subst(Subst)a;
        Top
            Top
            Rem
            Subst
        Bot
            Bot
            Rem
            Subst

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;6&#34;&gt;需要进一步提取出visitor部分的函数&lt;/h3&gt;
&lt;p&gt;这样就可以把所有&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PieVisitorI 
    forBot();
    forTop();
        Remv
            forBot();
            forTop();
        SubstV
            forBot();
            forTop();
     
pieD
    Accept(PieVisitorI)
        Bot
            Accept(pieVisitorI);
        Top
            Accept(pieVisitorI);
 
 
 
 
FruitD
    Peach
    Apple
    Pear
    Lemon
    Fig 无花果
 
TreeD
    Accept(bTreeVisitorI)
    Accept(iTreeVisitorI)
    Accept(tTreeVisitorI)
        Bub 芽
            Accept(bTreeVisitorI)
            Accept(iTreeVisitorI)
            Accept(tTreeVisitorI)
        Flat 平顶
            FruitD
            TreeD
            Flat(FruitD, TreeD)
            Accept(bTreeVisitorI)
            Accept(iTreeVisitorI)
            Accept(tTreeVisitorI)
        Split 分枝
            TreeD
            TreeD
            Split(TreeD, TreeD)
            Accept(bTreeVisitorI)
            Accept(iTreeVisitorI)
            Accept(tTreeVisitorI)
 
bTreeVisitorI
    forBud();
    forFlat(FruitD, TreeD);
    forSplit(TreeD, TreeD);
        bIsFlatV implements bTreeVisitorI
            forBud();
            forFlat(FruitD, TreeD);
            forSplit(TreeD, TreeD);
        bIsSplitV implements bTreeVisitorI
            forBud();
            forFlat(FruitD, TreeD);
            forSplit(TreeD, TreeD);
        bHasFruitV implements bTreeVisitorI
            forBud();
            forFlat(FruitD, TreeD);
            forSplit(TreeD, TreeD);

 
iTreeVisitorI
    forBud();
    forFlat(FruitD, TreeD);
    forSplit(TreeD, TreeD);
        iHeightV implements iTreeVisitorI
            forBud();
            forFlat(FruitD, TreeD);
            forSplit(TreeD, TreeD);
        iOccursV implements iTreeVisitorI
            FruitD
            iOccursV(FruitD)
            forBud();
            forFlat(FruitD, TreeD);
            forSplit(TreeD, TreeD);

       
 
tTreeVisitorI
    forBud();
    forFlat(FruitD, TreeD);
    forSplit(TreeD, TreeD);
        tSubstV implements tTreeVisitorI
            FruitD
            FruitD
            tSubstV(FruitD, FruitD)
            forBud();
            forFlat(FruitD, TreeD);
            forSplit(TreeD, TreeD);
         iOccursV implements tTreeVisitorI
            forBud();
            forFlat(FruitD, TreeD);
            forSplit(TreeD, TreeD);
  
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;7&#34;&gt;为了统一bTreeVisitorI 和 iTreeVisitorI   tTreeVisitorI&lt;/h3&gt;
（三个的不同就在于返回值分别为 boolean   int   treeD)
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;TreeVisitorI
    forBud();
    forFlat(FruitD, TreeD);
    forSplit(TreeD, TreeD);
         IsFlatV implements TreeVisitorI
            forBud();
            forFlat(FruitD, TreeD)
            forSplit(TreeD, TreeD)
         
         
        OccursV implements TreeVisitorI
            FruitD
            OccursV(FruitD)
            forBud();
            forFlat(FruitD, TreeD)
            forSplit(TreeD, TreeD)
         
         
        class OccursV implements TreeVisitorI {
            FruitD a;
            OccursV(FruitD _a) {
                a = _a;
            }
            public Object forBud() {
                return new Integer(0);
            }
            public Object forFlat(FruitD f, TreeD t) {
                if (f.equals(a))
                    return new Integer(((Integer)(t.accept(this))).intValue() + 1);
                else
                    return t.accept(this);
            }
            public int forSplit(TreeD l, TreeD r) {
                return new Integer(((Integer)(l.accept(this))).intValue()
                                   +
                                   ((Integer)(r.accept(this))).intValue());
            }
        }


TreeD
    Accept(TreeVisitorI)
        Bub 芽
            Accept(TreeVisitorI)
        Flat 平顶
            FruitD
            TreeD
            Flat(FruitD, TreeD)
            Accept(TreeVisitorI)
        Split 分枝
            TreeD
            TreeD
            Split(TreeD, TreeD)
            Accept(tTreeVisitorI)
         


PieD
    RemAV raFn
    RemFish rfFn
    remA()a;
    remFish(FishD)a;
        Bot
            remA();
            remFish(FishD);
        Top
            Object
            PieD
            Top(Object, PieD)
            remA();
            remFish(FishD);
 
FishD
    Salmon 鲑鱼
    Equals(Object);
    Anchovy 凤尾鱼
    Equals(Object);
    Tuna  金枪鱼
    Equals(Object);
 
RemAV
    forBot
    fotTop(Object, PieD)
RemFishV
    forBot(FishD)
    forTop(Object, PieD,  FishD)
     
RemIntV
    forBot(int)
    forTop(Object, pieD, Integer)
     
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;8&#34;&gt;重新设计RemAV RemFishV  RemIntV 为RemV(用Object替换）&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;RemV
    forBot(Object)
    forTop(Object, pieD, Object)
PieD
    RemV
    Rem(Object)
        Bot
            Rem(Object)
        Top
            Object
            PieD
            Top(Object, PieD)
            Rem(Object)
 
SubstFishV
    forBot(FishD, FishD)
    forTop(Object , PieD, FishD, FishO)
 
SubstIntV
    forBot(Int, Int)
    forTop(Object , PieD, Int, Int)
 
SubstV
    forBot(Object, Object)
    forTop(Object , PieD, Object, Object)
     
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;9&#34;&gt;然后现在把Remv 和Subst重新放入PieD&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PieD
    Remv
    SubstV
    Rem(Object)
    Subst(Object, Object)
        Bot
            Rem(Object)
            Subst(Object,Object)
        Top
            Object
            PieD
            Top(Object,PieD)
            Rem(Object)
            Subst(Object,Object)
 

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;9&#34;&gt;紧接着 我们还想着把Remv  SubstV放入参数的位置&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PieD
    Rem(Remv,Object)
    Subst(SubstV,Object, Object)
        Bot
            Rem(Renv,Object)
            Subst(Substv,Object,Object)
        Top
            Object
            PieD
            Top(Object,PieD)
            Rem(RemV,Object)
            Subst(Substv,Object,Object)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;10&#34;&gt;紧接着我们进一步比较RemV SubstV的实现(我们就得重新修改rem和subst了)&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;
class RemV {
    Object o;
    RemV(Object _o) {
        o = _o;
    }
    PieD forBot(Object o){
        return new Bot();
    }
    PieD forTop(Object t, PieD r){
        if (o.equals(t))
            return r.rem(this);
        else
            return new Top(t, r.rem(this));
    }


class RemV {
    PieD forBot(Object o) {
        return new Bot();
    }
    PieD forTop(Object t, PieD r, Object o) {
        if (o.equals(t))
            return r.rem(o);
        else
            return new Top(t, r.rem(o));
    }
}

class SubstV {
    PieD forBot(Object n, Object o) {
        return new Bot();
    }
    PieD forTop (Object t, PieD r, Object n, Object o) {
        if (o.equals(t))
            return new Top(n, r.subst(n, o));
        else
            return new Top(t, r.subst(n, 0));
    }
}
class SubstV {
    Object n;
    Object o;
    SubstV(Object _n, Object _o){
        n = _n;
        o = _o;
    }
    PieD forBot(Object n, Object o){
            return new Bot();
        }
    PieD forTop(Object t, PieD r){
        if (o.equals(t))
            return new Top(n, r.subst(this));
        else
            return new Top(t, r.subst(this));
    }
}

 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;11&#34;&gt;紧接着我们可以进行下一步抽象&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PieD
    Rem(RemV)
    Subst(SubstV)
        Top
            Object
            PieD
            Top(Object, PieD)
            Rem(RemV)
            Subst(SubstV)
        Bot
            Object
            PieD
            Bot(Object, PieD)
            Rem(RemV)
            Subst(SubstV)
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;12&#34;&gt;紧接着我们发现rem和subst代码类似&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PieVisitorI
    forBot
    forTop
        RemV implement PieVisitorI
            Object
            RemV(Object)
            forBot();
            forTop(Object,PieD）
        SubstV implement PieVisitorI
            Object
            Object
            SubstV(Object, Object)
            forBot();
            forTop(Object,PieD）
        LtdSubstV implement PieVisitorI
            int
            Object
            Object
            LtdSubstV(int, Object, Object)
            forBot();
            forTop(Object,PieD）
         
PieD
    Accept(PieVisitorI)
        Bob
            Accept(pieVisitorI)
        Top
            Object
            PieD
            Top(Object,PieD)
            Accept(PieVisitorI)
 


ExprVisitorI

ExprVisitorI
    forPlus(ExprD, ExprD);
    forDiff(ExprD, ExprD);
    forProd(ExprD, ExprD);
    forConst(ExprD, ExprD);
        IntEvalV implements  ExprVisitorI
            forPlus(ExprD, ExprD);
            forDiff(ExprD, ExprD);
            forProd(ExprD, ExprD);
            forConst(Object);
            Plus(Object, Object)
            Diff(Object, Object)
            Prod(Object, Object)
 

ExprD
    Accept(ExprVisitorI);
        Plus
            ExprD
            ExprD
            Plus(ExprD, ExprD);
            Accept(ExprVisitorI);
        Diff
            ExprD
            ExprD
            Diff(ExprD, ExprD);
            Accept(ExprVisitorI);
        Prod
            ExprD
            ExprD
            Prod(ExprD, ExprD);
            Accept(ExprVisitorI);
        ConstD
            Object
            ConstD(Object);
            Accept(ExprVisitorI);
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;13&#34;&gt;然后再实现Set集合的类型&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;SetD 
    Add(integer i);
    Mem(integer i);
    Plus(SetD);
    Diff(SetD);
    Prod(SetD);
        Empty
            Mem(integer i);
            Plus(SetD);
            Diff(SetD);
            Prod(SetD);
         
        Add
            Integer;
            SetD;
            Add(Integer, Integer)
            Mem(integer i);
            Plus(SetD);
            Diff(SetD);
            Prod(SetD);
 
ExprVisitorI
    forPlus(ExprD, ExprD);
    forDiff(ExprD, ExprD);
    forProd(ExprD, ExprD);
    forConst(ExprD, ExprD);
        IntEvalV implements  ExprVisitorI
            forPlus(ExprD, ExprD);
            forDiff(ExprD, ExprD);
            forProd(ExprD, ExprD);
            forConst(Object);
            Plus(Object, Object)
            Diff(Object, Object)
            Prod(Object, Object)
                SetEvalV implements IntEvalV
                    Plus(Object, Object)
                    Diff(Object, Object)
                    Prod(Object, Object)
                 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;14&#34;&gt;SetEvalV 直接集成IntEvalV不合理？&lt;/h3&gt;
&lt;p&gt;从SetEvalV 和IntEvalV抽取出一个基类&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;EvalD implements ExprVisitorI
    forPlus(ExprD, ExprD);
    forDiff(ExprD, ExprD);
    forProd(ExprD, ExprD);
    forConst(ExprD, ExprD);
    Plus(Object, Object)
    Diff(Object, Object)
    Prod(Object, Object)
        IntEvalD
            Plus(Object, 	Object)
            Diff(Object, Object)
            Prod(Object, Object)
            SetEvalD
            Plus(Object, Object)
            Diff(Object, Object)
            Prod(Object, Object)
         
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;15&#34;&gt;IntEvalD 和SetEvalD很多相似之处&lt;/h3&gt;
于是我们进一步提取
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;SubstD implements pieVisitorI
    Object
    Object
    SubstD(Object, Object)
    forBot();
    forTop(Object,PieD)
SubstV
    SubstV(Object, Object)
    forTop(Object, Object)
LtdSubstV
    int
    LtdSubstV(int,Object, Object)
    forTop(Object, Object)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;16&#34;&gt;根据extends使用override增加函数的丰富性&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;SubstV implements PieVisitorI
    Object
    Object
    SubstV(Object, Object)
    forBot()
    forTop(Object, PieD)
 
LtdSubstV
    Int
    Object
    Object
    LtdSubstV(int, Object, Object)
    forTop(Object, PieD)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;原来，抽象类可以有构造方法.抽象类只要有一个abstract函数就可以叫做抽象类
抽象类可以有构造方法，构造方法不可继承，但是可以供子类用super（）或者super（参数，参数。。。。）调用。
构造函数是对象的基本，没有构造函数就没有对象。
若果在父类中（这里就是你的抽象类）中显示的写了又参数的构造函数，在子类继承是就必须写一个构造函数来调用父类的构造函数。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PointD
PointD(chapter1,2) 点
    distanceTo0(int,int); //可以把它们移入到构造函数中
    closerTo0();
    PointD minus(PointD)
    int moveBy(int ,int)
        CartesianPt 笛卡尔坐标
            Int
            Int
            CartesianPt(int,int);
            distanceTo0();
            Closeto0();
        ManhattenPt 曼哈顿坐标
            Int
            Int
            ManhattenPt(int,int);
            distanceTo0();
            Closeto0();
        圆柱坐标系
        球坐标系



ShadowedCartesia 
    Int
    Int
    ShadowedCartesia(int, int, int, int)
    distanceTo0()
 
shapeVisitorI
    forCircle(int)
    forSquare(int)
    forTrans(pointD, ShapeD)
    UnionVisitorI
    forUnion(ShapeD, ShapeD)
        HasPtV implements ShapeVisitorI
            PointD
            HasPt(PointD)
            forCircle(int)
            forSquare(int)
            forTrans(PointD, ShapeD)
        UnionHasPtV implements ShapeVisitorI
            UnionHasPtV(PointD)
            forUnion(ShapeD, ShapeD)
            return s.accept(new HasPtV(p.minus(q)));
        HasPtV implements ShapeVisitorI
            PointD
            HasPt(PointD)
            ShapeVisitorI newHasPt(PointD)
            forCircle(int)
            forSquare(int)
            forTrans(PointD, ShapeD)
        UnionHasPtV implements unionVisitorI
            UnionHasPtV(PointD)
            ShapeVisitorI newHasPt(PointD)_o
            forUnion(ShapeD, ShapeD)
            return s.accept(newHasPtV(p.minus(q)));
 
 
ShapeD
    Accept(ShapeVisitorI)
        Circle
            Int
            Circle(int)
            Accept(ShapeVisitorI)_o
        Square
            Int
            Square(int)
            Accept(ShapeVisitorI)_o
        Trans
            PointD
            ShapeD
            Trans(int)
            Accept(ShapeVisitorI)_o
        Union
            ShapeD
            ShapeD
            Union(ShapeD, ShapeD)
            Accetp(ShapeVisitorI)_o
         
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;16&#34;&gt;newHasPt和HasPtV are eta reduction&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PieManI
    Int addTop(Object)
    Int remTop(Object)
    Int substTop(Object,Object)
    Int occTop(Object)
 
PieManM implements PieManI
    PieD
    addTop(Object) _o
    remTop(Object)_o
    substTop(Object,Object)_o
    occTop(Object)
 
 
PieVisitorI
    forBot();
    forTop(Object, Object)
        OccursV
            Object
            OccursV(Object)
            forBot()_o
            forTop(Object,PieD)_o
        SubstV
            Object
            Object
            SubstV(Object, Object)
            forBot();
            forTop(Object,PieD)_o
        RemV
            Object
            RemV(Object)
            forBot(Object)
            forTop(Object,PieD)
     
 
PieD
    Accept(PieVisitorI)
        Bot
            Accept(PieVisitorI)_o
        Top
            Object
            PieD
            Top(Object, PieD)
            Accept(PieVisitorI)_o
 
PieVisitorI
    forBot(Bot)
    foTop(Top)
        OccursV
            Object
            OccursV(Object)
            forBot(Bot that)
            forTop(Top that)
        SubstV
            Object
            Object
            SubstV(Object,Object)
            forBot(Bot that)
            forTop(Top That)
        RemV
            Object
            RemV(Object)
            forBot(Bot that)
            fotTop(Top that)
 
PieD
    Accept(PieVisitorI)
        Bot
            Accept(PieVisitorI)_o
        Top
            Object
            Object
            Top(Object, Objct)
            Accept(PieVisitor)_o
 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;每天你只能不断去思考 事情的要点和第一步和第二步 才能取得进步.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;What’s the point of the visitor pattern? What’s the point of the software design?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;亮点&lt;/li&gt;
&lt;li&gt;突破点，并按照一定的方向。。&lt;/li&gt;
&lt;li&gt;关键点&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/alittlejava/closure.png&#34; alt=&#34;closure&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Closure(Closure(this))&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;具体java源代码参考&lt;a href=&#34;https://github.com/jueqingsizhe66/ALittleJava&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the little java&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Machine Learning some search record</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/09/28/machine-learning-some-search-record/</link>
      <pubDate>Wed, 28 Sep 2016 17:20:32 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/09/28/machine-learning-some-search-record/</guid>
      <description>&lt;p&gt;学习&lt;a href=&#34;http://cs229.stanford.edu/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;stanford Cs229机器学习&lt;/a&gt;的一些资料汇总。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/alvine008/article/details/9097105&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;手把手教你实现SVM算法（一）&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/alvine008/article/details/9097109&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;详解2D-PCA （二维PCA）&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/alvine008/article/details/9097111&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;手把手教你实现SVM算法（二）&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;了解了一些机器学习，想到了prolog是一门人工智能算法，所以顺便搜索到了&lt;a href=&#34;http://blog.csdn.net/baimafujinji/article/details/49745389&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;prolog九宫格&lt;/a&gt; .
首先这段prolog代码显然是简短的、简单的（但是不友好 声明式语言一定得写的友好）。我们根本没有告诉计算机该怎么做，我们只是说现在我们有一个九宫格，并要求：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;（1）每个格都是从1到9中的一个整数；&lt;/li&gt;
&lt;li&gt;（2）九宫格中的数字不会重复；&lt;/li&gt;
&lt;li&gt;（3）每行的和都相等；&lt;/li&gt;
&lt;li&gt;（4）每列的和都相等；&lt;/li&gt;
&lt;li&gt;（5）两条对角线上的和也相等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;font color=&#34;red&#34;&gt;现在运行还有点问题！待以后解决！&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://wenku.baidu.com/link?url=H44D9f3eHZB-RqPf2tbICEIHtn3L5ZvCkLS6IcOg_uEhW-nmZocKYCoUGYBjQ6O_YXRbYptH2Yr4vsTtkwjB-36xpFnCAf1Ygyjo3zscoky&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;基于PDC_PROLOG自学习机器博弈 &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;font color=green&gt;白马负金羁&lt;/font&gt;的&lt;a href=&#34;http://blog.csdn.net/baimafujinji/article/category/6048259&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;机器学习资料&lt;/a&gt; （包含R语言，逻辑规约，HMM,卡尔曼滤波）&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/baimafujinji/article/details/6472337&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;MATLAB中进行基于SVM的数据分析&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/stark_summer/article/details/50364666&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;机器学习简史&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/stark_summer/article/details/50249943&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;机器学习概念&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.analyticsvidhya.com/blog/2015/08/common-machine-learning-algorithms/#rd?sukey=e74171513d3453dd223d8ac2deeb49e1eac3a7c7511b955187120c332b0e4df30837b86c6940bf1967a7c57107306d2c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;贝叶斯及其他常用机器学习算法 From analyticsvidhya&lt;/a&gt;（&lt;font color=red&gt;相当棒&lt;/font&gt;的一个机器学习算法介绍 好评不断  通过计算认识了贝叶斯算法）
并同时介绍了what is predicator?  what is Class Prior Probabilty?
what is Posterior Probability? what is Predictor Prior Probability?&lt;/p&gt;
&lt;p&gt;下面是我的手写笔记(需要2min看懂)
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/MachineLearning/beya1.jpg&#34; alt=&#34;bayes1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/MachineLearning/beya2.jpg&#34; alt=&#34;bayes2&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/MachineLearning/beya3.jpg&#34; alt=&#34;bayes3&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.analyticsvidhya.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Analyticsvidhya&lt;/a&gt;,一个相当不错的计算机学习网站。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Bayes%27_theorem&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;贝叶斯理论 From wikipedia&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://mindhacks.cn/2008/09/21/the-magical-bayesian-method/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;平凡而有神奇的贝叶斯 刘未鹏&lt;/a&gt;， &lt;font color=red&gt;从这里开始认识到贝叶斯的美&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.analyticsvidhya.com/blog/2016/04/complete-tutorial-tree-based-modeling-scratch-in-python/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A Complete Tutorial on Tree Based Modeling from Scratch (in R &amp;amp; Python)&lt;/a&gt;，&lt;font color=red&gt;十分清楚,需要一定时间理解&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;R语言和Python语言比较经常被人们用来做机器学习，其实包括lisp,prolog,java等都是可以的。
&lt;a href=&#34;https://www.analyticsvidhya.com/blog/2016/02/complete-tutorial-learn-data-science-scratch/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;完整的R语言教程&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.analyticsvidhya.com/blog/2016/01/complete-tutorial-learn-data-science-python-scratch-2/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;完整的python语言教程&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/u013731339/article/details/40025373&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ipython机器学习&lt;/a&gt;.Ipython是一个比较有用的python IDE界面，提供比较友好的输出调试界面(网页上操作),所以顺便也查了一下怎么用。&lt;/p&gt;
&lt;p&gt;尝试Notebook, 还需要下载一些其它咚咚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;下载安装 pyzmq, 在这里不建议使用pip, pip对pyzmq支持不太好，装不上。我尝试使用easy_install
c:&amp;gt;easy_install.exe pyzmq&lt;/li&gt;
&lt;li&gt;下载安装 jinja2,
c:&amp;gt;easy_install.exe jinja2&lt;/li&gt;
&lt;li&gt;下载安装 tornado,
c:&amp;gt;easy_install.exe tornado    &lt;br&gt;
好了，使用下面命令就可以把Notebook起来：
c:&amp;gt;ipython.exe notebook&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;十分友好的ipython notebook，在命令行敲一下会打开一个浏览器窗口，用于编写Python的语句&lt;/p&gt;
&lt;p&gt;然而python和R并不是我的选择，我还是熟悉&lt;font color=&#34;red&#34;&gt;matlab&lt;/font&gt;,打算选择matlab作为我机器学习的工具。&lt;/p&gt;
&lt;p&gt;关于机器语言的一些常用算法&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/MachineLearning/algo.jpg&#34; alt=&#34;algo&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;雷老师推荐的&lt;a href=&#34;http://www.esat.kuleuven.be/sista/lssvmlab/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;LS-SVM matlab&lt;/a&gt;, &lt;font color=&#34;red&#34;&gt;结论是选择LS-SVM&lt;/font&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.csie.ntu.edu.tw/~cjlin/libsvm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;台湾的林智仁(Lin Chih-Jen)教授等编写SVM模式识别和回归的软件包，多语言实现&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;附带dot语言图片生成&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/09/28/graphviz-notebook/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;dot reference&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;digraph G1{
    
    compound=true;
    graph[fontname=Kaiti];
    edge[fontname=SimSun]; 
    node[fontname=SimSun]; 
    MachineLearning[shape=box,style=rounded,fillcolor=&amp;quot;#1f8842&amp;quot;]; 
subgraph cluster_1{
        
//    SL[shape=ellipse,label=&amp;quot;Supervised Learning&amp;quot;];
    label=&amp;quot;Supervised Learning(This algorithm consist of a target / outcome 
    \nvariable (or dependent variable) which is to be predicted 
    \nfrom a given set of predictors (independent variables))&amp;quot;;
    node[style=filled,fillcolor=chartreuse];

    Reg[label=&amp;quot;1. Linear Regression&amp;quot;];
    LR[label=&amp;quot;2. logistic Regression&amp;quot;];
    DT[label=&amp;quot;3. Decision Tree&amp;quot;];
    SVM[label=&amp;quot;4. Supported Vector Machine&amp;quot;];
    RF[label=&amp;quot;5. Random Forest&amp;quot;];
    KNN[label=&amp;quot;6. KNN&amp;quot;];
    NB[label=&amp;quot;7. Naive Bayes&amp;quot;];

    Reg-&amp;gt;LR-&amp;gt;DT-&amp;gt;SVM-&amp;gt;RF-&amp;gt;KNN-&amp;gt;NB-&amp;gt;Reg;
    }
    subgraph cluster_2{
        
    node[style=filled,fillcolor=chartreuse];
    //USL[shape=ellipse,label=&amp;quot;UnSupervised Learning&amp;quot;];
    label=&amp;quot;UnSupervised Learning(do not have any target or outcome variable to
    \npredict / estimate.  It is used for clustering population
    \nin different groups, which is widely used for 
    \nsegmenting customers in different groups for specific intervention )&amp;quot;;
    AA[label=&amp;quot;Apriori Alogirithm&amp;quot;];
    KM[label=&amp;quot;K-means&amp;quot;];
    }
    subgraph cluster_3{
        
    node[style=filled,fillcolor=chartreuse];
    label=&amp;quot;Reinforcement Learning(It works this way: the machine is 
    \nexposed to an environment where it 
    \ntrains itself continually using trial and error. 
    \nThis machine learns from past experience 
    \nand tries to capture the best possible knowledge 
    \nto make accurate business decisions )&amp;quot;;
    MDP[label=&amp;quot;Markov Decision Process&amp;quot;]
    }


    //MachineLearning-&amp;gt;{SL USL RL};
    MachineLearning-&amp;gt;Reg[lhead=cluster_1];
    MachineLearning-&amp;gt;AA[lhead=cluster_2];
    MachineLearning-&amp;gt;MDP[lhead=cluster_3];

}

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>graphviz notebook</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/09/28/graphviz-notebook/</link>
      <pubDate>Wed, 28 Sep 2016 17:14:53 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/09/28/graphviz-notebook/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.graphviz.org&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;graphviz&lt;/a&gt;可用于帮助你绘制工具之外和工具之内的想法。关于绘图的历史可以参看&lt;a href=&#34;http://www.merl.com/publications/TR2001-49&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A short note of the graph drawing&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://graphviz.org/Download.php&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;graphviz下载链接&lt;/a&gt;, 安装很方便，一步一步进行即可，一般是在&lt;a href=&#34;http://graphviz.org/content/command-line-invocation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;命令行使用&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;下面是我记录学习的一些graphviz的笔记。只用pdf输出&lt;code&gt;dot -Tpdf *.dot -o *.pdf&lt;/code&gt;，
因为质量较好(矢量化输出)，但是特殊情况可以参考&lt;a href=&#34;http://graphviz.org/content/command-line-invocation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;output format&lt;/a&gt;,
因为不同的输出会在&lt;a href=&#34;http://graphviz.org/content/attrs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Node, Edge and Graph Attributes&lt;/a&gt; 节点、边、图中表现出不同的样式出来。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/graphviz/main1.jpg&#34; alt=&#34;main1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/graphviz/main2.jpg&#34; alt=&#34;main2&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;cfd&#34;&gt;CFD&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/graphviz/CFD.jpg&#34; alt=&#34;CFD&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;digraph G{
    compound=true; // 这样lhead ltail指向cluster才有效
    edge [fontname=&amp;quot;SimSun&amp;quot;];
    graph[fontname=&amp;quot;SimHei&amp;quot;]
    node [shape=box, fontname=&amp;quot;KaiTi&amp;quot; size=&amp;quot;5,5&amp;quot;, style=filld, color=&amp;quot;&amp;quot;];
    node[style=filled,color=&amp;quot;lightblue&amp;quot;]

    rankdir=LR;
    {
    rank=same;
    before[label=&amp;quot;前处理&amp;quot;];   
    compute[label=&amp;quot;计算&amp;quot;];   
    after[label=&amp;quot;后处理&amp;quot;];   
    }
    
    subgraph cluster1{
        geometry[label=&amp;quot;几何建模&amp;quot;];
        mesh[label=&amp;quot;网格生成&amp;quot;];
        geometry-&amp;gt;mesh;
        }

    subgraph cluster2{
        initial[label=&amp;quot;初始化&amp;quot;];
        setting[label=&amp;quot;设置&amp;quot;];
        model[label=&amp;quot;湍流模型&amp;quot;];
        output[label=&amp;quot;输出&amp;quot;];
        initial-&amp;gt;setting-&amp;gt;model-&amp;gt;output;
        }

    subgraph cluster3{
       plane[label=&amp;quot;截面&amp;quot;];
       polyline[label=&amp;quot;多边形线&amp;quot;];
       chart[label=&amp;quot;表格&amp;quot;];
       pile[label=&amp;quot;批处理&amp;quot;];
       contour[label=&amp;quot;云图&amp;quot;];
        plane-&amp;gt;polyline-&amp;gt;chart;
        plane-&amp;gt;contour;
        }
    before-&amp;gt;compute-&amp;gt;after;
    before-&amp;gt;geometry[lhead=cluster1];
    compute-&amp;gt;initial[lhead=cluster2];
    after-&amp;gt;plane[lhead=cluster3];
    
}


&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;inner-图&#34;&gt;inner 图&lt;/h2&gt;
&lt;p&gt;注意使用circo生成，需要有一个回环圆。&lt;/p&gt;
&lt;p&gt;compound用于子图的lhead属性，不设置没效果。&lt;/p&gt;
&lt;p&gt;concentrate这里没什么作用。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/graphviz/inner.jpg&#34; alt=&#34;inner&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;//circo -Tpdf inner.dot -o inner.pdf
digraph G{
    fontname=&amp;quot;SimSun&amp;quot;;
    fontsize=10;
    compound=true; // 这样lhead ltail指向cluster才有效
    edge[fontname=&amp;quot;SimSun&amp;quot;,arrowhead=vee,color=blue];
    graph[fontname=&amp;quot;SimHei&amp;quot;,color=lightgray];
    node[shape=box, fontname=&amp;quot;KaiTi&amp;quot;];
    //concentrate=true;
    //node[style=filled,color=&amp;quot;lightblue&amp;quot;];
    arrowsize=.5;

    concentrate=true;
    nodesep=0.5;
    ranksep=0.5;
    rankdir=BU;
    //rank=sink;
    //task[shape=polygon,sides=5,peripheries=2,label=&amp;quot;图像处理&amp;quot;,fillcolor=&amp;quot;#F1C40F&amp;quot;];

/*
    subgraph cluster_0{
        
    innerpoint[shape=point,width=0,height=0];
    innerpoint1[shape=point,width=0,height=0];
    innerpoint2[shape=point,width=0,height=0];
    innerpoint3[shape=point,width=0,height=0];
    innerpoint4[shape=point,width=0,height=0];
    innerpoint-&amp;gt;innerpoint1-&amp;gt;innerpoint2-&amp;gt;innerpoint3-&amp;gt;innerpoint4-&amp;gt;innerpoint[arrowsize=0.1];
    }

*/
    subgraph cluster_1{
        //rankdir=TB;
        label=&amp;quot;内&amp;quot;;
        style=filled;
        fillcolor=lightgray;
        //shape=ellpse;
        //edge[fontname=&amp;quot;SimSun&amp;quot;,arrowhead=vee,color=blue,style=dashed];
        //style=filled;
        //fillcolor=lightgray;
        //fillcolor=mintcream;
        //style=filled;

        {
            //node[style=filled,color=&amp;quot;chartreuse&amp;quot;];
            //node[style=filled,color=&amp;quot;palegreen&amp;quot;];
            //rank=same;
            node[color=red,shape=circle];
            edge[color=green,style=dashed]
            subgoal1[label=&amp;quot;内1&amp;quot;];
            step1[label=&amp;quot;内2&amp;quot;];
            step2[label=&amp;quot;内3&amp;quot;];
            step3[label=&amp;quot;内4&amp;quot;]
            step4[label=&amp;quot;内n&amp;quot;]
            subgoal1-&amp;gt; step1-&amp;gt;step2-&amp;gt;step3-&amp;gt;step4-&amp;gt;subgoal1;
        }
       
    }
 //           innerpoint-&amp;gt;{subgoal1 step1 step2 step3 step4}[color=red,style=dotted,ltail=cluster_0];

    outer1[label=&amp;quot;外1&amp;quot;];
    outer2[label=&amp;quot;外2&amp;quot;];
    outer3[label=&amp;quot;外3&amp;quot;];
    outer4[label=&amp;quot;外4&amp;quot;];
    outern[label=&amp;quot;外n&amp;quot;];

    subgoal1-&amp;gt;outern[ltail=cluster_1];
    step1-&amp;gt;outer1[ltail=cluster_1];
    step2-&amp;gt;outer2[ltail=cluster_1];
    step3-&amp;gt;outer3[ltail=cluster_1];
    step4-&amp;gt;outer4[ltail=cluster_1];
    
    outerf1[shape=point,width=0,height=0];
    outerf2[shape=point,width=0,height=0];
    outerf3[shape=point,width=0,height=0];
    outerf4[shape=point,width=0,height=0];
    outerfn[shape=point,width=0,height=0];

    outer1-&amp;gt;outerf1;
    outer2-&amp;gt;outerf2;
    outer3-&amp;gt;outerf3;
    outer4-&amp;gt;outerf4;
    outern-&amp;gt;outerfn;

    //{rank=same; innerpoint step4 outer4};

   
   

}

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;outer图&#34;&gt;outer图&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/graphviz/outer.jpg&#34; alt=&#34;outer&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;//circo -Tpdf inner.dot -o inner.pdf
digraph G{
    fontname=&amp;quot;SimSun&amp;quot;;
    fontsize=10;
    compound=true; // 这样lhead ltail指向cluster才有效
    edge[fontname=&amp;quot;SimSun&amp;quot;,arrowhead=vee,color=blue];
    graph[fontname=&amp;quot;SimHei&amp;quot;,color=lightgray];
    node[shape=box, fontname=&amp;quot;KaiTi&amp;quot;];
    //concentrate=true;
    //node[style=filled,color=&amp;quot;lightblue&amp;quot;];
    arrowsize=.5;

    nodesep=0.5;
    ranksep=0.5;
    rankdir=BU;
    //center=true;
    //rank=sink;
    //task[shape=polygon,sides=5,peripheries=2,label=&amp;quot;图像处理&amp;quot;,fillcolor=&amp;quot;#F1C40F&amp;quot;];




    subgraph cluster_1{
        //rankdir=TB;
        label=&amp;quot;内&amp;quot;;
        style=filled;
        fillcolor=chartreuse;
        //shape=ellpse;
        //edge[fontname=&amp;quot;SimSun&amp;quot;,arrowhead=vee,color=blue,style=dashed];
        //style=filled;
        //fillcolor=lightgray;
        //fillcolor=mintcream;
        //style=filled;

        {
            //node[style=filled,color=&amp;quot;chartreuse&amp;quot;];
            //node[style=filled,color=&amp;quot;palegreen&amp;quot;];
            //rank=same;
            //innerpoint[shape=point,width=0,height=0];
            node[color=red,shape=circle];
            edge[color=&amp;quot;green&amp;quot;,style=dashed]
            subgoal1[label=&amp;quot;内1&amp;quot;];
            step1[label=&amp;quot;内2&amp;quot;];
            step2[label=&amp;quot;内3&amp;quot;];
            step3[label=&amp;quot;内4&amp;quot;]
            step4[label=&amp;quot;内n&amp;quot;]
            subgoal1-&amp;gt; step1-&amp;gt;step2-&amp;gt;step3-&amp;gt;step4-&amp;gt;subgoal1;

           // {subgoal1 step1 step2 step3 step4}-&amp;gt;innerpoint[color=&amp;quot;red&amp;quot;];
        }
       
    }
subgraph cluster_0{
    outer1[label=&amp;quot;外1&amp;quot;];
    outer2[label=&amp;quot;外2&amp;quot;];
    outer3[label=&amp;quot;外3&amp;quot;];
    outer4[label=&amp;quot;外4&amp;quot;];
    outern[label=&amp;quot;外n&amp;quot;];
    //outer1-&amp;gt;outer2-&amp;gt;outer3-&amp;gt;outer4-&amp;gt;outern-&amp;gt;outer1;
}
    outern-&amp;gt;step3;
    outer1-&amp;gt;step4;
    outer2-&amp;gt;subgoal1;
    outer3-&amp;gt;step1;
    outer4-&amp;gt;step2;
    
    outerf1[shape=point,width=0,height=0];
    outerf2[shape=point,width=0,height=0];
    outerf3[shape=point,width=0,height=0];
    outerf4[shape=point,width=0,height=0];
    outerfn[shape=point,width=0,height=0];
    //outerf1-&amp;gt;outerf2-&amp;gt;outerf3-&amp;gt;outerf4-&amp;gt;outerfn-&amp;gt;outerf1;

    outerf1-&amp;gt;outer3;
    outerf2-&amp;gt;outer2;
    outerf3-&amp;gt;outer1;
    outerf4-&amp;gt;outern;
    outerfn-&amp;gt;outer4;

   
   // outer1-&amp;gt;outer2-&amp;gt;outer3-&amp;gt;outer4-&amp;gt;outern-&amp;gt;outer1;
   

}

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;算法绘制&#34;&gt;算法绘制&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/graphviz/binary.jpg&#34; alt=&#34;algo&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;digraph ast{
    size=&amp;quot;4,4&amp;quot;;
fontname=&amp;quot;Microsoft YaHei&amp;quot;;
fontsize=10;
node [shape=circle, fontname=&amp;quot;Microsoft YaHei&amp;quot;, fontsize=10];
edge [fontname=&amp;quot;Microsoft YaHei&amp;quot;, fontsize=10];
node [shape=&amp;quot;plaintext&amp;quot;];
mul [label=&amp;quot;mul(*)&amp;quot;];
add [label=&amp;quot;add(+)&amp;quot;];
add -&amp;gt; 3
add -&amp;gt; 4;
mul -&amp;gt; add;
mul -&amp;gt; 5;
}

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;时序表制作&#34;&gt;时序表制作&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/graphviz/sequence.jpg&#34; alt=&#34;sequence&#34;&gt;&lt;/p&gt;
&lt;p&gt;聪明的做法 是从图中隐藏了所有stepi（其实图像对象中是存在的，只不过打印不出来
并同时使用了plaintext的风格。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;digraph G {
rankdir=&amp;quot;LR&amp;quot;;
node[shape=&amp;quot;point&amp;quot;, width=0, height=0];
edge[arrowhead=&amp;quot;none&amp;quot;, style=&amp;quot;dashed&amp;quot;]
{
rank=&amp;quot;same&amp;quot;;
edge[style=&amp;quot;solid&amp;quot;];
LC[shape=&amp;quot;plaintext&amp;quot;];
LC -&amp;gt; step00 -&amp;gt; step01 -&amp;gt; step02 -&amp;gt; step03 -&amp;gt; step04 -&amp;gt; step05;
}
{
rank=&amp;quot;same&amp;quot;;
edge[style=&amp;quot;solid&amp;quot;];
Agency[shape=&amp;quot;plaintext&amp;quot;];
Agency -&amp;gt; step10 -&amp;gt; step11 -&amp;gt; step12 -&amp;gt; step13 -&amp;gt; step14 -&amp;gt; step15;
}
{
rank=&amp;quot;same&amp;quot;;
edge[style=&amp;quot;solid&amp;quot;];
Agent[shape=&amp;quot;plaintext&amp;quot;];
Agent -&amp;gt; step20 -&amp;gt; step21 -&amp;gt; step22 -&amp;gt; step23 -&amp;gt; step24 -&amp;gt; step25;
}
step00 -&amp;gt; step10 [label=&amp;quot;sends email new custumer&amp;quot;, arrowhead=&amp;quot;normal&amp;quot;];
step11 -&amp;gt; step01 [label=&amp;quot;declines&amp;quot;, arrowhead=&amp;quot;normal&amp;quot;];
step12 -&amp;gt; step02 [label=&amp;quot;accepts&amp;quot;, arrowhead=&amp;quot;normal&amp;quot;];
step13 -&amp;gt; step23 [label=&amp;quot;forward to&amp;quot;, arrowhead=&amp;quot;normal&amp;quot;];
step24 -&amp;gt; step14;
step14 -&amp;gt; step04 [arrowhead=&amp;quot;normal&amp;quot;];


//xinran[shape=&amp;quot;none&amp;quot;,image=&amp;quot;xinran2.jpg&amp;quot;,label=&amp;quot;&amp;quot;]
betterline[shape=&amp;quot;record&amp;quot;,style=filled,fillcolor=chartreuse];
betteredge[shape=&amp;quot;record&amp;quot;,style=filled,fillcolor=forestgreen];
}

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;reference&#34;&gt;reference&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;graphviz的&lt;a href=&#34;http://www.graphviz.org/Documentation.php&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;在线文档&lt;/a&gt;,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;dot语言的&lt;a href=&#34;http://www.graphviz.org/content/dot-language&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;在线文档&lt;/a&gt;,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.tonyballantyne.com/graphs.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;drawing Graph using dot&lt;/a&gt;介绍了一些图表中分层的概念。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.tuicool.com/articles/qeqeuyb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;使用Graphviz绘制流程图和关系图&lt;/a&gt;教会了关于图、节点、边的属性设置(attribute property predictor)，
其实也可以参考&lt;a href=&#34;http://graphviz.org/content/attrs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Node, Edge and Graph Attributes&lt;/a&gt;关于默认属性的设置，相关的还可以参考&lt;a href=&#34;http://graphviz.org/content/node-shapes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;node shapes&lt;/a&gt;,
&lt;a href=&#34;http://graphviz.org/content/arrow-shapes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Arrow Shapes&lt;/a&gt;, &lt;a href=&#34;http://graphviz.org/content/color-names&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;colors&lt;/a&gt; 这也是比较会经常查看的参数属性设置。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;注意Mrecord不支持中文，为了实现&lt;a href=&#34;http://www.graphviz.org/content/global-subgraph-style-statements&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;圆角&lt;/a&gt;你可以使用&lt;code&gt;style=rounded&lt;/code&gt;来实现(可以和filled叠加起来使用) &lt;code&gt;style=&amp;quot;rounded,filled&amp;quot;&lt;/code&gt;。
还可以参考&lt;a href=&#34;http://stackoverflow.com/questions/7115870/creating-straight-edges-in-graphviz&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Creating Straight Edges in Graphviz&lt;/a&gt;,以及&lt;a href=&#34;http://www.graphviz.org/content/attrs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;官网属性文档style section&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;node与edge公用样式：&amp;quot;dashed&amp;quot;虚线, &amp;quot;dotted&amp;quot;点, &amp;quot;solid&amp;quot;固体框, &amp;quot;invis&amp;quot;隐藏 and &amp;quot;bold&amp;quot; 加粗
edge 特有样式：&amp;quot;tapered&amp;quot; 锥形
node 特有样式：&amp;quot;filled&amp;quot;填充, &amp;quot;diagonals&amp;quot;对角线 与 &amp;quot;rounded&amp;quot; 圆角
cluster可使用样式：&amp;quot;filled&amp;quot;与&amp;quot;rounded&amp;quot;
 &amp;quot;radial&amp;quot;径向样式可被nodes, clusters 与graphs使用，如果使用需要指出一个径向渐变填充风格
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;graphviz也是支持插图的,&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;digraph G {
rankdir=&amp;quot;LR&amp;quot;;
xinran[shape=&amp;quot;none&amp;quot;,image=&amp;quot;xinran2.jpg&amp;quot;,label=&amp;quot;&amp;quot;]
betterline[shape=&amp;quot;record&amp;quot;,style=filled,fillcolor=chartreuse];
betteredge[shape=&amp;quot;record&amp;quot;,style=filled,fillcolor=forestgreen];
}

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;&lt;a href=&#34;http://www.ibm.com/developerworks/cn/aix/library/au-aix-graphviz/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;使用 Graphviz 生成自动化系统图 &lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://lockriver.blog.163.com/blog/static/487232242010101761749383/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;中文乱码&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://lockriver.blog.163.com/blog/static/487232242010101761749383/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Using graph drawing &lt;/a&gt; &lt;font color=red&gt;很详细，推荐&lt;/font&gt;&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>bash special annotation</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/09/25/bash-special-annotation/</link>
      <pubDate>Sun, 25 Sep 2016 23:15:01 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/09/25/bash-special-annotation/</guid>
      <description>&lt;p&gt;关于shell的summary参看&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/08/06/linux-shell-summary/#kernel&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linux Shell Summary&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;以下是关于bash的一些比较特殊的地方。&lt;/p&gt;
&lt;h2 id=&#34;1-bash数组再理解&#34;&gt;1. bash数组再理解&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;declare -a&lt;/code&gt;表示声明一个数组，类似于 &lt;code&gt;declare -i&lt;/code&gt; 声明一个整数和&lt;code&gt;declare -x &lt;/code&gt;声明一个环境变量。&lt;/p&gt;
&lt;p&gt;&lt;font color=&#34;red&#34;&gt;bash数组定义时候使用小括号来赋值，而在引用数组的时候反而使用中括号（不同于其他编程语言)&lt;/font&gt;&lt;/p&gt;
&lt;h3 id=&#34;定义数组&#34;&gt;定义数组&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;bash2=(&amp;quot;34&amp;quot;,&amp;quot;5&amp;quot;,&amp;quot;5&amp;quot;,&amp;quot;4&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;引用数组&#34;&gt;引用数组&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;echo ${array[n]}
遍历数组：
filename=(`ls`)
for var in ${filename[@]};do
echo $var
done

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;添加数组&#34;&gt;添加数组&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;bash1+=&amp;quot;45&amp;quot;; #赋值两边不能有空格
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2-bash变量截取和变量替换&#34;&gt;2. bash变量截取和变量替换&lt;/h2&gt;
&lt;p&gt;&lt;font color=&#34;red&#34;&gt;bash使用井号代表开头(这和正则表达式有点不同，使用caret)
而结尾则使用百分号(不同于正则表达式的dollar符号$)。并且在当使用两个重叠的井号，表示最大长度（从头开始的最大删除都删掉）
而使用两个百分号则表达反方向的最大长度删除（从尾到头删除匹配字符串）&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;#表示正向最短匹配，##表示正向最大匹配&lt;/li&gt;
&lt;li&gt;%表示反向最短匹配，%%表示反向最大匹配&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;而这一点也体现在变量替换当中，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;子串替换：
${string/substring/replacement}
使用$replacement来替换第一个匹配的$substring.

${string//substring/replacement}
使用$replacement来替换所有匹配的$substring.

${string/#substring/replacement}
如果$substring匹配$string的开头部分, 那么就用$replacement来替换$substring.

${string/%substring/replacement}
如果$substring匹配$string的结尾部分, 那么就用$replacement来替换$substring.

子串提取的方法主要有：直接到指定位置求子串，字符匹配求子串。
${string:position}
在$string中从位置$position开始提取子串.

如果$string是&amp;quot;*&amp;quot;或者&amp;quot;@&amp;quot;, 那么将会提取从位置$position开始的位置参数.[1]

${string:position:length}
在$string中从位置$position开始提取$length长度的子串.

&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;除号表示最短替换，双除号表示最长替换&lt;/li&gt;
&lt;li&gt;匹配项第一个位置出现#井号表示开头部分&lt;/li&gt;
&lt;li&gt;匹配项最后一个位置出现%百分号表示结尾部分&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;3-bash接受键盘操作&#34;&gt;3. bash接受键盘操作&lt;/h2&gt;
&lt;p&gt;用一个read命令即可(类似于matlab的input命令)
通常的风格是 &lt;code&gt;read -p &amp;quot;prompt for reminding&amp;quot; variable-name&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;接收键盘输入：
    read [选项] [变量名]
    选项：
        -p &amp;quot;提示信息&amp;quot;：在等待read输入时，输出提示信息
        -t 秒数：read命令会一直等待用户输入，使用此选项可以指定等待时间
        -n 字符数：read命令只接受指定的字符数，就会执行
        -s：隐藏输入的数据，适用于机密信息的输入

read.sh：
#!/bin/bash

read -p &amp;quot;please input your name:&amp;quot; -t 30 name
echo $name

read -p &amp;quot;please input your passwd:&amp;quot; -s passwd
echo -e &amp;quot;\n&amp;quot;
echo $passwd

read -p &amp;quot;please input your sex [M/F]:&amp;quot; sex
echo -e &amp;quot;\n&amp;quot;
echo $sex

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4-tac反向&#34;&gt;4. tac反向&lt;/h2&gt;
&lt;p&gt;cat在bash中是打印文本信息的作用，而&lt;a href=&#34;http://bbs.chinaunix.net/thread-250407-1-1.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tac&lt;/a&gt;则是反向输出文件流&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cat old_file|awk &#39;{print NR,$0}&#39;|sort -r -n|awk &#39;{print $2}&#39;

&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;添加每行的行号&lt;/li&gt;
&lt;li&gt;逆向排列&lt;/li&gt;
&lt;li&gt;输出每行&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;5-if当中也可以使用双括号进行算术判断&#34;&gt;5. if当中也可以使用双括号进行算术判断&lt;/h2&gt;
&lt;p&gt;if并不是支持正则表达式？还是只有变量支持？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;root at javazhao-N53SM [13:26:46ä��午] in /MyBashWork/clean on git:develop?
$ if [ -f &amp;quot;All.sh&amp;quot; ] ;then echo &amp;quot;hei&amp;quot;; else echo &amp;quot;no&amp;quot; ;fi;

hei

root at javazhao-N53SM [13:26:52ä��午] in /MyBashWork/clean on git:develop?
$ if [ -f &amp;quot;*.sh&amp;quot; ] ;then echo &amp;quot;hei&amp;quot;; else echo &amp;quot;no&amp;quot; ;fi;

no


但是对于变量是可以的
[root@bj_manager ~]# a=123a;if [[ $a =~ ^[0-9]+$ ]]; then echo ok; fi
[root@bj_manager ~]# a=123;if [[ $a =~ ^[0-9]+$ ]]; then echo ok; fi  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;font color=&#34;red&#34;&gt;实际情况是只有在双中括号的时候才支持正则表达式&lt;/font&gt;。&lt;font color=&#34;green&#34;&gt;一般是使用双中括号进行文件判断，目录判断，
文件大小判断等&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;if另外一个特殊地方就是使用双括号执行算术比较&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;708@708-PC MINGW64 /e/plGraphViz (master)
  if (( 1&amp;lt;2 )) ;then echo &amp;quot;zero&amp;quot;;   echo &amp;quot;a=2&amp;quot;; echo &amp;quot;a=3&amp;quot; ;else echo &amp;quot;no&amp;quot;; fi;
zero
a=2
a=3


708@708-PC MINGW64 /e/dot(1)/testByYe
$   if [[ 1&amp;lt;2 ]] ;then echo &amp;quot;zero&amp;quot;;   echo &amp;quot;a=2&amp;quot;; echo &amp;quot;a=3&amp;quot; ;else echo &amp;quot;no&amp;quot;; fi;
bash: unexpected token 284 in conditional command
bash: syntax error near `1&amp;lt;&#39;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;而bash也一般是使用&lt;code&gt;$((...))&lt;/code&gt; 进行算术的运算.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>A tool to navigate the achivement in the source tree</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/09/21/a-tool-to-navigate-the-achivement-in-the-source-tree/</link>
      <pubDate>Wed, 21 Sep 2016 02:13:20 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/09/21/a-tool-to-navigate-the-achivement-in-the-source-tree/</guid>
      <description>&lt;p&gt;We go to &lt;a href=&#34;http://github.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github&lt;/a&gt;, then download the souce code,
go on looking into the code, dame it! So many codes ,so many branches,
how to figure out the develop process?&lt;/p&gt;
&lt;p&gt;Maybe you can use the &lt;a href=&#34;https://www.sourcetreeapp.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sourceTree&lt;/a&gt; to help you visulize the source tree,
or the right below tool for helping navigating the source tree in the time
and compare with each other continually.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#compare&#34;&gt;1. 源码比较目录&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#detail&#34;&gt;2. 文件细节&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#time&#34;&gt;3. 时间变化表&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#short&#34;&gt;4. 列出简要信息&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#code&#34;&gt;5. shell code for navigating the source tree in the git repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;compare&#34;&gt;1. 比较目录&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://pygments.org/docs/lexers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;color block languages&lt;/a&gt; for modify,maybe you need sometimes in your blogs writing life.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;1: 正在比较变动前 6ced089 和变动后 3d8b517&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;2: 正在比较变动前 3d8b517 和变动后 ccd942c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;3: 正在比较变动前 ccd942c 和变动后 0b3607d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt;4: 正在比较变动前 0b3607d 和变动后 acf4ec3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5&#34;&gt;5: 正在比较变动前 acf4ec3 和变动后 c1ad93f&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6&#34;&gt;6: 正在比较变动前 c1ad93f 和变动后 c7c8226&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7&#34;&gt;7: 正在比较变动前 c7c8226 和变动后 0cd29ea&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#8&#34;&gt;8: 正在比较变动前 0cd29ea 和变动后 13f7fbf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#9&#34;&gt;9: 正在比较变动前 13f7fbf 和变动后 5520d75&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#10&#34;&gt;10: 正在比较变动前 5520d75 和变动后 8656a39&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#11&#34;&gt;11: 正在比较变动前 8656a39 和变动后 7421981&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#12&#34;&gt;12: 正在比较变动前 7421981 和变动后 bfcb63b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#13&#34;&gt;13: 正在比较变动前 bfcb63b 和变动后 84afd69&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#14&#34;&gt;14: 正在比较变动前 84afd69 和变动后 c2bfd3f&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#15&#34;&gt;15: 正在比较变动前 c2bfd3f 和变动后 fa364fc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#16&#34;&gt;16: 正在比较变动前 fa364fc 和变动后 3c900f4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#17&#34;&gt;17: 正在比较变动前 3c900f4 和变动后 65cc1c3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#18&#34;&gt;18: 正在比较变动前 65cc1c3 和变动后 20e1f21&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#19&#34;&gt;19: 正在比较变动前 20e1f21 和变动后 e2e9fc1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#20&#34;&gt;20: 正在比较变动前 e2e9fc1 和变动后 4b72d15&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#21&#34;&gt;21: 正在比较变动前 4b72d15 和变动后 54248f7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#22&#34;&gt;22: 正在比较变动前 54248f7 和变动后 3b9a773&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#23&#34;&gt;23: 正在比较变动前 3b9a773 和变动后 1e9a910&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#24&#34;&gt;24: 正在比较变动前 1e9a910 和变动后 6dc1cf5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#25&#34;&gt;25: 正在比较变动前 6dc1cf5 和变动后 76ea35d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#26&#34;&gt;26: 正在比较变动前 76ea35d 和变动后 2a2728b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#27&#34;&gt;27: 正在比较变动前 2a2728b 和变动后 7f9fc82&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#28&#34;&gt;28: 正在比较变动前 7f9fc82 和变动后 5baddb5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#29&#34;&gt;29: 正在比较变动前 5baddb5 和变动后 95bfe7f&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#30&#34;&gt;30: 正在比较变动前 95bfe7f 和变动后 f1322fa&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#31&#34;&gt;31: 正在比较变动前 f1322fa 和变动后 474bea8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#32&#34;&gt;32: 正在比较变动前 474bea8 和变动后 262cb2a&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#33&#34;&gt;33: 正在比较变动前 262cb2a 和变动后 e7e6033&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#34&#34;&gt;34: 正在比较变动前 e7e6033 和变动后 e17bf44&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#35&#34;&gt;35: 正在比较变动前 e17bf44 和变动后 6596aa1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#36&#34;&gt;36: 正在比较变动前 6596aa1 和变动后 87e8982&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#37&#34;&gt;37: 正在比较变动前 87e8982 和变动后 cb6aada&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#38&#34;&gt;38: 正在比较变动前 cb6aada 和变动后 7c8125b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#39&#34;&gt;39: 正在比较变动前 7c8125b 和变动后 6a38f95&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#40&#34;&gt;40: 正在比较变动前 6a38f95 和变动后 ebb86cd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#41&#34;&gt;41: 正在比较变动前 ebb86cd 和变动后 1549e44&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#42&#34;&gt;42: 正在比较变动前 1549e44 和变动后 61ddca2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#43&#34;&gt;43: 正在比较变动前 61ddca2 和变动后 26f07e7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#44&#34;&gt;44: 正在比较变动前 26f07e7 和变动后 f78b4f8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#45&#34;&gt;45: 正在比较变动前 f78b4f8 和变动后 3109362&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#46&#34;&gt;46: 正在比较变动前 3109362 和变动后 df0ab09&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#47&#34;&gt;47: 正在比较变动前 df0ab09 和变动后 73e976b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#48&#34;&gt;48: 正在比较变动前 73e976b 和变动后 090c25d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#49&#34;&gt;49: 正在比较变动前 090c25d 和变动后 daed8bf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#50&#34;&gt;50: 正在比较变动前 daed8bf 和变动后 528b9af&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#51&#34;&gt;51: 正在比较变动前 528b9af 和变动后 e594ae6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#52&#34;&gt;52: 正在比较变动前 e594ae6 和变动后 bbefbf7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#53&#34;&gt;53: 正在比较变动前 bbefbf7 和变动后 0cc5421&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#54&#34;&gt;54: 正在比较变动前 0cc5421 和变动后 dbc602d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#55&#34;&gt;55: 正在比较变动前 dbc602d 和变动后 a2456df&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56&#34;&gt;56: 正在比较变动前 a2456df 和变动后 20c6017&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#57&#34;&gt;57: 正在比较变动前 20c6017 和变动后 f694d77&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#58&#34;&gt;58: 正在比较变动前 f694d77 和变动后 af5d96d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#59&#34;&gt;59: 正在比较变动前 af5d96d 和变动后 ab4b616&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#60&#34;&gt;60: 正在比较变动前 ab4b616 和变动后 74bd19d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#61&#34;&gt;61: 正在比较变动前 74bd19d 和变动后 8ffff6f&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#62&#34;&gt;62: 正在比较变动前 8ffff6f 和变动后 ac3423a&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#63&#34;&gt;63: 正在比较变动前 ac3423a 和变动后 57932e4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#64&#34;&gt;64: 正在比较变动前 57932e4 和变动后 315b16e&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#65&#34;&gt;65: 正在比较变动前 315b16e 和变动后 898b5d2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#66&#34;&gt;66: 正在比较变动前 898b5d2 和变动后 4279a49&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#67&#34;&gt;67: 正在比较变动前 4279a49 和变动后 c173073&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#68&#34;&gt;68: 正在比较变动前 c173073 和变动后 107c515&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#69&#34;&gt;69: 正在比较变动前 107c515 和变动后 8f574bb&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#70&#34;&gt;70: 正在比较变动前 8f574bb 和变动后 d7088dd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#71&#34;&gt;71: 正在比较变动前 d7088dd 和变动后 94ed05d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#72&#34;&gt;72: 正在比较变动前 94ed05d 和变动后 f481060&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#73&#34;&gt;73: 正在比较变动前 f481060 和变动后 ce492ef&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#74&#34;&gt;74: 正在比较变动前 ce492ef 和变动后 ddef555&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#75&#34;&gt;75: 正在比较变动前 ddef555 和变动后 af27fdd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#76&#34;&gt;76: 正在比较变动前 af27fdd 和变动后 f390238&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#77&#34;&gt;77: 正在比较变动前 f390238 和变动后 c5f7d82&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#78&#34;&gt;78: 正在比较变动前 c5f7d82 和变动后 acf6467&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#79&#34;&gt;79: 正在比较变动前 acf6467 和变动后 6656a2d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#80&#34;&gt;80: 正在比较变动前 6656a2d 和变动后 256c9ce&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#81&#34;&gt;81: 正在比较变动前 256c9ce 和变动后 bf4ebea&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#82&#34;&gt;82: 正在比较变动前 bf4ebea 和变动后 70aec99&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#83&#34;&gt;83: 正在比较变动前 70aec99 和变动后 e06e6ba&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#84&#34;&gt;84: 正在比较变动前 e06e6ba 和变动后 0fd12ca&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#85&#34;&gt;85: 正在比较变动前 0fd12ca 和变动后 67c4157&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#86&#34;&gt;86: 正在比较变动前 67c4157 和变动后 b972e2b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#87&#34;&gt;87: 正在比较变动前 b972e2b 和变动后 8bbc84c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#88&#34;&gt;88: 正在比较变动前 8bbc84c 和变动后 033fa14&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#89&#34;&gt;89: 正在比较变动前 033fa14 和变动后 fdb5a9e&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#90&#34;&gt;90: 正在比较变动前 fdb5a9e 和变动后 6ec582e&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#91&#34;&gt;91: 正在比较变动前 6ec582e 和变动后 68b53b8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#92&#34;&gt;92: 正在比较变动前 68b53b8 和变动后 46e8f3c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#93&#34;&gt;93: 正在比较变动前 46e8f3c 和变动后 3162d88&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#94&#34;&gt;94: 正在比较变动前 3162d88 和变动后 714b2e0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#95&#34;&gt;95: 正在比较变动前 714b2e0 和变动后 af7a387&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#96&#34;&gt;96: 正在比较变动前 af7a387 和变动后 7b434e3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#97&#34;&gt;97: 正在比较变动前 7b434e3 和变动后 dcbcb4d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#98&#34;&gt;98: 正在比较变动前 dcbcb4d 和变动后 50a3dbc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#99&#34;&gt;99: 正在比较变动前 50a3dbc 和变动后 a97e8e1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#100&#34;&gt;100: 正在比较变动前 a97e8e1 和变动后 9513a9b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#101&#34;&gt;101: 正在比较变动前 9513a9b 和变动后 7163f60&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#102&#34;&gt;102: 正在比较变动前 7163f60 和变动后 b2f4aef&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#103&#34;&gt;103: 正在比较变动前 b2f4aef 和变动后 ba30c25&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#104&#34;&gt;104: 正在比较变动前 ba30c25 和变动后 0eea41b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#105&#34;&gt;105: 正在比较变动前 0eea41b 和变动后 c1691bd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#106&#34;&gt;106: 正在比较变动前 c1691bd 和变动后 3de9fc2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#107&#34;&gt;107: 正在比较变动前 3de9fc2 和变动后 cb34d89&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#108&#34;&gt;108: 正在比较变动前 cb34d89 和变动后 7f0e20f&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#109&#34;&gt;109: 正在比较变动前 7f0e20f 和变动后 c16a7a7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#110&#34;&gt;110: 正在比较变动前 c16a7a7 和变动后 8bbb08c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#111&#34;&gt;111: 正在比较变动前 8bbb08c 和变动后 34c8b1a&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#112&#34;&gt;112: 正在比较变动前 34c8b1a 和变动后 d883d06&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#113&#34;&gt;113: 正在比较变动前 d883d06 和变动后 66ac0a0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#114&#34;&gt;114: 正在比较变动前 66ac0a0 和变动后 ab5a102&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#115&#34;&gt;115: 正在比较变动前 ab5a102 和变动后 65f43b8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#116&#34;&gt;116: 正在比较变动前 65f43b8 和变动后 c6de3d1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#117&#34;&gt;117: 正在比较变动前 c6de3d1 和变动后 cab2231&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#118&#34;&gt;118: 正在比较变动前 cab2231 和变动后 008c5e6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#119&#34;&gt;119: 正在比较变动前 008c5e6 和变动后 dba5c72&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#120&#34;&gt;120: 正在比较变动前 dba5c72 和变动后 eff64ee&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#121&#34;&gt;121: 正在比较变动前 eff64ee 和变动后 89eb423&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#122&#34;&gt;122: 正在比较变动前 89eb423 和变动后 2346997&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#123&#34;&gt;123: 正在比较变动前 2346997 和变动后 d22d50e&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#124&#34;&gt;124: 正在比较变动前 d22d50e 和变动后 e64cc35&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#125&#34;&gt;125: 正在比较变动前 e64cc35 和变动后 763a529&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#126&#34;&gt;126: 正在比较变动前 763a529 和变动后 d962f81&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#127&#34;&gt;127: 正在比较变动前 d962f81 和变动后 63a5cd7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#128&#34;&gt;128: 正在比较变动前 63a5cd7 和变动后 ce95c3c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#129&#34;&gt;129: 正在比较变动前 ce95c3c 和变动后 44cd5a6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#130&#34;&gt;130: 正在比较变动前 44cd5a6 和变动后 c0c5e18&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#131&#34;&gt;131: 正在比较变动前 c0c5e18 和变动后 603344f&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#132&#34;&gt;132: 正在比较变动前 603344f 和变动后 2679253&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#133&#34;&gt;133: 正在比较变动前 2679253 和变动后 a5e20f8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#134&#34;&gt;134: 正在比较变动前 a5e20f8 和变动后 bc3c502&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#135&#34;&gt;135: 正在比较变动前 bc3c502 和变动后 7ec98aa&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#136&#34;&gt;136: 正在比较变动前 7ec98aa 和变动后 984d3b9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#137&#34;&gt;137: 正在比较变动前 984d3b9 和变动后 4401e20&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#138&#34;&gt;138: 正在比较变动前 4401e20 和变动后 2247466&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#139&#34;&gt;139: 正在比较变动前 2247466 和变动后 f4a9322&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#140&#34;&gt;140: 正在比较变动前 f4a9322 和变动后 0d2712a&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#141&#34;&gt;141: 正在比较变动前 0d2712a 和变动后 3518985&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#142&#34;&gt;142: 正在比较变动前 3518985 和变动后 322ca62&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#143&#34;&gt;143: 正在比较变动前 322ca62 和变动后 c4bf9ea&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#144&#34;&gt;144: 正在比较变动前 c4bf9ea 和变动后 2a6dafd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#145&#34;&gt;145: 正在比较变动前 2a6dafd 和变动后 145615e&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#146&#34;&gt;146: 正在比较变动前 145615e 和变动后 f16acca&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#147&#34;&gt;147: 正在比较变动前 f16acca 和变动后 4e2d9f1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#148&#34;&gt;148: 正在比较变动前 4e2d9f1 和变动后 6359c9c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#149&#34;&gt;149: 正在比较变动前 6359c9c 和变动后 00537d0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#150&#34;&gt;150: 正在比较变动前 00537d0 和变动后 acadc39&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#151&#34;&gt;151: 正在比较变动前 acadc39 和变动后 51359c6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#152&#34;&gt;152: 正在比较变动前 51359c6 和变动后 73047b3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#153&#34;&gt;153: 正在比较变动前 73047b3 和变动后 e4c4586&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#154&#34;&gt;154: 正在比较变动前 e4c4586 和变动后 7b991bb&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#155&#34;&gt;155: 正在比较变动前 7b991bb 和变动后 fa1518f&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#156&#34;&gt;156: 正在比较变动前 fa1518f 和变动后 8593ed6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#157&#34;&gt;157: 正在比较变动前 8593ed6 和变动后 cc53b1e&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#158&#34;&gt;158: 正在比较变动前 cc53b1e 和变动后 202a241&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#159&#34;&gt;159: 正在比较变动前 202a241 和变动后 858b5fb&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#160&#34;&gt;160: 正在比较变动前 858b5fb 和变动后 260b62d&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#161&#34;&gt;161: 正在比较变动前 260b62d 和变动后 a6886ca&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#162&#34;&gt;162: 正在比较变动前 a6886ca 和变动后 41914a2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#163&#34;&gt;163: 正在比较变动前 41914a2 和变动后 05a5fd2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#164&#34;&gt;164: 正在比较变动前 05a5fd2 和变动后 fd6c59b&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#165&#34;&gt;165: 正在比较变动前 fd6c59b 和变动后 121e68f&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;detail&#34;&gt;2. 文件细节&lt;/h2&gt;
&lt;h2 id=&#34;1&#34;&gt; 1: 正在比较变动前 6ced089 和变动后 3d8b517 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
index f1b9cf5..a63cbff 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,3 +1,6 @@
 [submodule &amp;quot;Prolog-Library-Collection&amp;quot;]
 	path = Prolog-Library-Collection
 	url = https://github.com/wouterbeek/Prolog-Library-Collection.git
+[submodule &amp;quot;plHtml&amp;quot;]
+	path = plHtml
+	url = https://github.com/wouterbeek/plHtml.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 4a51c6e..184c33e 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 4a51c6e0936179bff57fda23686219e6a6cd3c9b
+Subproject commit 184c33eecf561c109919a7f765de0b1e53d99d00
diff --git a/plHtml b/plHtml
new file mode 160000
index 0000000..2c45ebc
--- /dev/null
+++ b/plHtml
@@ -0,0 +1 @@
+Subproject commit 2c45ebcd3f946c1e207a69ece1e2d730d4d090ed
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt; 2: 正在比较变动前 3d8b517 和变动后 ccd942c &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 184c33e..03d4b46 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 184c33eecf561c109919a7f765de0b1e53d99d00
+Subproject commit 03d4b46ba9c6f658828ff843e5785c221ffc3a57
diff --git a/plHtml b/plHtml
index 2c45ebc..50743da 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 2c45ebcd3f946c1e207a69ece1e2d730d4d090ed
+Subproject commit 50743daad8dd0f3664e1cafbc14523a423314f84
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3&#34;&gt; 3: 正在比较变动前 ccd942c 和变动后 0b3607d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index c62d146..200c034 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -41,7 +41,7 @@
   ]
 ).
 :- reexport(
-  gv(gv_color),
+  plGraphViz(gv_color),
   [
     color//1, % +Color:compound
     colorList//1 % +ColorList:list(compound)
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 81d51df..728640e 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -68,7 +68,7 @@ check_minimum(V, Min1):-
 
 gv_attrs_download:-
   gv_attrs_url(Url),
-  download_html(Url, Dom, [html_dialect(html4)]),
+  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
 
   xpath(Dom, //table(@align=center), TableDom),
   % @tbd This does not work, since in `record_name(Element, Name)`,
diff --git a/gv_color.pl b/gv_color.pl
index fd22d35..ad18728 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -81,7 +81,7 @@ gv_color_url(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
 
 gv_color_download:-
   gv_color_url(Url),
-  download_html(Url, Dom, [html_dialect(html4)]),
+  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
   xpath(Dom, //table(1), TableDom1),
   xpath(Dom, //table(2), TableDom2),
   maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2]).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4&#34;&gt; 4: 正在比较变动前 0b3607d 和变动后 acf4ec3 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 728640e..b360039 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -14,16 +14,21 @@
 */
 
 :- use_module(library(apply)).
+:- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
 :- use_module(dcg(dcg_content)).
 :- use_module(dcg(dcg_generic)).
+:- use_module(generics(db_ext)).
+:- use_module(os(file_ext)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
 :- use_module(plGraphViz(gv_attr_type)). % DCGs implementing attribute types.
 
+:- db_add_novel(user:prolog_file_type(log, logging)).
+
 %! gv_attr(
 %!   ?Name:atom,
 %!   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
@@ -33,9 +38,18 @@
 %!   ?Notes:atom
 %! ) is nondet.
 
-:- dynamic(gv_attr/6).
+:- persistent(
+  gv_attr(
+    name:atom,
+    used_by:list(oneof([cluster,edge,graph,node,subgraph])),
+    types:list(atom),
+    default,
+    minimum,
+    notes:atom
+  )
+).
 
-:- initialization(gv_attrs_download).
+:- initialization(gv_attrs_init).
 
 
 
@@ -64,7 +78,20 @@ check_minimum(V, Min1):-
 
 
 
-% Download attributes from graphviz.org
+% INITIALIZATION
+
+%! assert_gv_attr_row(+Row:list(atom)) is det.
+
+assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
+  dcg_phrase(translate_usedby(UsedBy2), UsedBy1),
+  once(dcg_phrase(translate_type(Types2), Types1)),
+  sort(UsedBy2, UsedBy3),
+  translate_default(Default1, Default2),
+  assert_gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes).
+
+
+%! gv_attrs_downloads is det.
+% Downloads the table describing GraphViz attributes from `graphviz.org`.
 
 gv_attrs_download:-
   gv_attrs_url(Url),
@@ -76,16 +103,56 @@ gv_attrs_download:-
   %%%%xpath(Dom, /html/body/table, TableDom),
 
   html_to_table(TableDom, _, Rows),
-  maplist(assert_gv_attr, Rows).
+  maplist(assert_gv_attr_row, Rows).
+
+
+%! gv_attrs_file(-File:atom) is det.
+
+gv_attrs_file(File):-
+  absolute_file_name(
+    data(gv_attrs),
+    File,
+    [access(write),file_type(logging)]
+  ).
+
+
+%! gv_attrs_init is det.
+
+gv_attrs_init:-
+  gv_attrs_file(File),
+  safe_db_attach(File),
+  file_age(File, Age),
+  gv_attrs_update(Age).
+
+
+%! gv_attrs_update(+Age:float) is det.
+
+% The persistent store is still fresh.
+gv_attrs_update(Age):-
+  once(gv_attr(_, _, _, _, _, _)),
+  Age &amp;lt; 3600, !.
+% The persistent store has become stale, so refresh it.
+gv_attrs_update(_):-
+  retractall_gv_attr(_, _, _, _, _, _),
+  gv_attrs_download.
+
+
+%! gv_attrs_url(-Url:url) is det.
 
 gv_attrs_url(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
 
-assert_gv_attr([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
-  dcg_phrase(translate_usedby(UsedBy2), UsedBy1),
-  once(dcg_phrase(translate_type(Types2), Types1)),
-  sort(UsedBy2, UsedBy3),
-  translate_default(Default1, Default2),
-  assert(gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes)).
+
+%! safe_db_attach(+File:atom) is det.
+
+safe_db_attach(File):-
+  exists_file(File), !,
+  db_attach(File, []).
+safe_db_attach(File):-
+  touch_file(File),
+  safe_db_attach(File).
+
+
+%! translate_default(+Default1:atom, -Default2:atom) is det.
 
 % The empty string is represented by the empty atom.
 translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
@@ -93,12 +160,20 @@ translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
 translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
 translate_default(Default, Default).
 
+
+%! translate_type(-Types:list(atom))// is det.
+
 translate_type([H|T]) --&amp;gt;
   {gv_attr_type(H)},
   atom(H),
   whites,
   translate_type(T).
-translate_type([]) --&amp;gt; [].
+translate_type([]) --&amp;gt; !, [].
+
+
+%! translated_usedby(
+%!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
+%! )// is det.
 
 translate_usedby([cluster|T]) --&amp;gt; `C`, !, translate_usedby(T).
 translate_usedby([edge|T]) --&amp;gt; `E`, !, translate_usedby(T).
diff --git a/gv_color.pl b/gv_color.pl
index ad18728..cf92f56 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -18,20 +18,25 @@
 
 :- use_module(library(apply)).
 :- use_module(library(lists)).
+:- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
 :- use_module(dcg(dcg_abnf)).
 :- use_module(dcg(dcg_cardinal)).
+:- use_module(generics(db_ext)).
+:- use_module(os(file_ext)).
 :- use_module(sparql(sparql_char)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
+:- db_add_novel(user:prolog_file_type(log, logging)).
+
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
 
-:- dynamic(gv_color/2).
+:- persistent(gv_color(colorscheme:oneof([svg,x11]),color:atom)).
 
-:- initialization(gv_color_download).
+:- initialization(gv_color_init).
 
 
 
@@ -75,9 +80,9 @@ wc_weight(Float) --&amp;gt;
 
 
 
-% Initialization.
+% INITIALIZATION
 
-gv_color_url(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
+%! gv_color_download is det.
 
 gv_color_download:-
   gv_color_url(Url),
@@ -91,6 +96,52 @@ assert_color_table(Colorscheme, TableDom):-
   append(Rows, Cells),
   forall(
     member(Cell, Cells),
-    assert(gv_color(Colorscheme, Cell))
+    assert_gv_color(Colorscheme, Cell)
+  ).
+
+
+%! gv_color_file(-File:atom) is det.
+
+gv_color_file(File):-
+  absolute_file_name(
+    data(gv_color),
+    File,
+    [access(write),file_type(logging)]
   ).
 
+
+%! gv_color_init is det.
+
+gv_color_init:-
+  gv_color_file(File),
+  safe_db_attach(File),
+  file_age(File, Age),
+  gv_color_update(Age).
+
+
+%! gv_color_update(+Age:float) is det.
+
+% The persistent store is still fresh.
+gv_color_update(Age):-
+  once(gv_color(_, _)),
+  Age &amp;lt; 3600, !.
+% The persistent store has become stale, so refresh it.
+gv_color_update(_):-
+  retractall_gv_color(_, _),
+  gv_color_download.
+
+
+%! gv_color_url(-Url:url) is det.
+
+gv_color_url(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
+
+
+%! safe_db_attach(+File:atom) is det.
+
+safe_db_attach(File):-
+  exists_file(File), !,
+  db_attach(File, []).
+safe_db_attach(File):-
+  touch_file(File),
+  safe_db_attach(File).
+
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5&#34;&gt; 5: 正在比较变动前 acf4ec3 和变动后 c1ad93f &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index b360039..fa499d0 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -130,7 +130,7 @@ gv_attrs_init:-
 % The persistent store is still fresh.
 gv_attrs_update(Age):-
   once(gv_attr(_, _, _, _, _, _)),
-  Age &amp;lt; 3600, !.
+  Age &amp;lt; 8640000, !.
 % The persistent store has become stale, so refresh it.
 gv_attrs_update(_):-
   retractall_gv_attr(_, _, _, _, _, _),
diff --git a/gv_color.pl b/gv_color.pl
index cf92f56..70e0495 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -124,7 +124,7 @@ gv_color_init:-
 % The persistent store is still fresh.
 gv_color_update(Age):-
   once(gv_color(_, _)),
-  Age &amp;lt; 3600, !.
+  Age &amp;lt; 8640000, !.
 % The persistent store has become stale, so refresh it.
 gv_color_update(_):-
   retractall_gv_color(_, _),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;6&#34;&gt; 6: 正在比较变动前 c1ad93f 和变动后 c7c8226 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 03d4b46..af1a250 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 03d4b46ba9c6f658828ff843e5785c221ffc3a57
+Subproject commit af1a250d6074d0ab61a525fd064bfd555c5815a1
diff --git a/plHtml b/plHtml
index 50743da..81eb731 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 50743daad8dd0f3664e1cafbc14523a423314f84
+Subproject commit 81eb731eb46d98979c8f2862cfbf0e0aca9c1ef8
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;7&#34;&gt; 7: 正在比较变动前 c7c8226 和变动后 0cd29ea &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/load.pl b/load.pl
index d502d58..4b117d1 100644
--- a/load.pl
+++ b/load.pl
@@ -1,11 +1,11 @@
 % Load file for plGraphViz.
 
-:- multifile(user:prolog/3).
 :- dynamic(user:prolog/3).
-user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
+:- multifile(user:prolog/3).
+   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
 
 :- use_module(load_project).
-:- load_project([
+:- load_project(plGraphViz, [
     plc-&#39;Prolog-Library-Collection&#39;,
     plHtml
 ]).
diff --git a/load_project.pl b/load_project.pl
index 3eae83d..5599b5e 100644
--- a/load_project.pl
+++ b/load_project.pl
@@ -1,7 +1,8 @@
 :- module(
   load_project,
   [
-    load_project/1, % +ChildProjects:list(or([atom,pair(atom)]))
+    load_project/2, % +Parent:atom
+                    % +ChildProjects:list(or([atom,pair(atom)]))
     load_subproject/2, % +ParentFileSearchPath:atom
                        % +Child:or([atom,pair(atom)])
     set_data_subdirectory/1 % +ParentDirectory:atom
@@ -16,19 +17,24 @@ Generic code for loading a project:
   * Load the index of subprojects onto the file search path.
 
 @author Wouter Beek
-@version 2014/05/27
+@version 2014/06/14
 */
 
-:- use_module(library(ansi_term)).
+:- use_module(library(ansi_term)). % Colorized terminal messages.
 :- use_module(library(apply)).
 
+:- dynamic(user:project/2).
+:- multifile(user:project/2).
+:- dynamic(user:project/3).
+:- multifile(user:project/3).
 
 
-load_project(ChildProjects):-
-  user:project(_, _, ParentFsp),
+
+load_project(Parent, ChildProjects):-
+  parent_alias(Parent, ParentFsp),
 
   % Entry point.
-  source_file(load_project(_), ThisFile),
+  source_file(load_project(_,_), ThisFile),
   file_directory_name(ThisFile, ThisDir),
   assert(user:file_search_path(ParentFsp, ThisDir)),
   assert(user:file_search_path(project, ThisDir)),
@@ -38,7 +44,7 @@ load_project(ChildProjects):-
 
   % Load the root of submodules onto the file search path.
   maplist(load_subproject(ParentFsp), ChildProjects),
-  
+
   % Load the index into the file search path.
   load_project_index(ParentFsp).
 
@@ -77,8 +83,20 @@ load_subproject_file_search_path(_, ChildFsp, ChildDir):-
 
 load_project_index(Fsp):-
   Spec =.. [Fsp,index],
-  absolute_file_name(Spec, File, [access(read),file_type(prolog)]),
+  absolute_file_name(
+    Spec,
+    File,
+    [access(read),file_errors(fail),file_type(prolog)]
+  ), !,
   ensure_loaded(File).
+load_project_index(_).
+
+
+%! parent_alias(+Parent:atom, -ParentFsp:atom) is det.
+
+parent_alias(Parent, ParentFsp):-
+  user:project(Parent, _, ParentFsp), !.
+parent_alias(Parent, Parent).
 
 
 %! set_data_subdirectory(+ParentDirectory:atom) is det.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;8&#34;&gt; 8: 正在比较变动前 0cd29ea 和变动后 13f7fbf &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index af1a250..5b34b01 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit af1a250d6074d0ab61a525fd064bfd555c5815a1
+Subproject commit 5b34b01ab0cc82a56e6fd90fc26e75da22f5a0fe
diff --git a/plHtml b/plHtml
index 81eb731..08480c4 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 81eb731eb46d98979c8f2862cfbf0e0aca9c1ef8
+Subproject commit 08480c40acaee5f70bfb21e3c641bef1e7d258bd
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;9&#34;&gt; 9: 正在比较变动前 13f7fbf 和变动后 5520d75 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 200c034..f9a0e7f 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -29,18 +29,13 @@
     smoothType//1, % +SmoothType:atom
     %splineType//1,
     %startType//1,
+    string//1, % ?Content:atom
     style//2 % +Context:oneof([cluster,edge,node])
              % +Style:atom
     %viewPort//1
   ]
 ).
 :- reexport(
-  library(dcg/basics),
-  [
-    string//1 % +String:atom
-  ]
-).
-:- reexport(
   plGraphViz(gv_color),
   [
     color//1, % +Color:compound
@@ -383,6 +378,13 @@ smoothType(triangle).
 % @tbd startType
 
 
+%! string(?Content:atom)// .
+% A GraphViz string.
+
+string(Content) --&amp;gt;
+  atom(Content).
+
+
 %! style(?Context:oneof([cluster,edge,node]), ?Style:atom) is nondet.
 
 style(Context, Style) --&amp;gt;
diff --git a/gv_attrs.pl b/gv_attrs.pl
index fa499d0..dd0145a 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -68,7 +68,7 @@ gv_attr(Context, N=V1, N=V2):-
   ;
     Dcg =.. [Type,V1]
   ),
-  dcg_phrase(Dcg, V2),
+  once(dcg_phrase(Dcg, V2)),
   check_minimum(V1, Minimum).
 
 check_minimum(_, &#39;&#39;):- !.
diff --git a/gv_color.pl b/gv_color.pl
index 70e0495..19d6e05 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -23,6 +23,7 @@
 
 :- use_module(dcg(dcg_abnf)).
 :- use_module(dcg(dcg_cardinal)).
+:- use_module(dcg(dcg_content)).
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(sparql(sparql_char)).
@@ -46,14 +47,17 @@
 %   2. `rgba(Red:nonneg,Green:nonneg,Blue:nonneg,Alpha:nonneg)`
 %   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
 
-color(rgb(Red,Green,Blue)) --&amp;gt;
+color(rgb(Red,Green,Blue)) --&amp;gt; !,
   `#`,
   &#39;#&#39;(3, hex_color, [Red,Green,Blue]).
-color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt;
+color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
   `#`,
   &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha]).
-color(hsv(Hue,Saturation,Value)) --&amp;gt;
+color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
   &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value]).
+color(Name) --&amp;gt;
+  {gv_color(_, Name)},
+  atom(Name).
 
 hex_color(I) --&amp;gt;
   {W1 is I / 16},
diff --git a/gv_file.pl b/gv_file.pl
index 827f680..fe63e28 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -1,16 +1,13 @@
 :- module(
   gv_file,
   [
-    graph_to_gv_file/3, % +Options:list(nvpair)
+    gif_to_gv_file/3, % +Options:list(nvpair)
                         % +GraphInterchangeFormat:compound
                         % ?ToFile:atom
     graph_to_svg_dom/3, % +Options:list(nvpair)
                         % +GraphInterchangeFormat:compound
                         % -SvgDom:list(compound)
-    open_dot/1, % +File:file
-    tree_to_gv_file/3 % +Options:list(nvpair)
-                      % +Tree:compound
-                      % ?ToFile:atom
+    open_dot/1 % +File:file
   ]
 ).
 
@@ -81,7 +78,7 @@ user:prolog_file_type(xdot, xdot).
 
 
 
-%! graph_to_gv_file(
+%! gif_to_gv_file(
 %!   +Options:list(nvpair),
 %!   +GIF:compound,
 %!   -ToFile:atom
@@ -99,7 +96,7 @@ user:prolog_file_type(xdot, xdot).
 % @arg GIF A compound term representing a graph.
 % @arg ToFile The atomic name of a file.
 
-graph_to_gv_file(O1, GIF, ToFile):-
+gif_to_gv_file(O1, GIF, ToFile):-
   once(phrase(gv_graph(GIF), Codes)),
   to_gv_file(O1, Codes, ToFile).
 
@@ -117,7 +114,7 @@ graph_to_gv_file(O1, GIF, ToFile):-
 graph_to_svg_dom(O1, GIF, SvgDom):-
   % Make sure the file type of the output file is SvgDom.
   merge_options([to_file_type=svg], O1, O2),
-  graph_to_gv_file(O2, GIF, ToFile),
+  gif_to_gv_file(O2, GIF, ToFile),
   file_to_svg(ToFile, SvgDom),
   safe_delete_file(ToFile).
 
@@ -133,33 +130,6 @@ open_dot(File):-
   run_program(Program, [File]).
 
 
-%! tree_to_gv_file(+Options:list(nvpair), +Tree:compound, ?ToFile:atom) is det.
-% Stores the given tree term into a GraphViz file.
-%
-% The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([jpeg,pdf,svg,xdot])|=
-%     The file type of the generated GraphViz file.
-%
-% @arg Options A list of name-value pairs.
-% @arg Tree A compound term representing a tree.
-% @arg ToFile The atomic name of the generated file.
-
-tree_to_gv_file(O1, Tree, ToFile):-
-  once(phrase(gv_tree(O1, Tree), Codes)),
-  to_gv_file(O1, Codes, ToFile).
-
-gv_tree(O1, T) --&amp;gt;
-  {
-    tree_to_ugraph(T, UG),
-    merge_options([edge_labels(false)], O1, O2),
-    export_ugraph(O2, UG, G_Term)
-  },
-  gv_graph(G_Term).
-
-
 
 % SUPPORT PREDICATES %
 
diff --git a/gv_gif.pl b/gv_gif.pl
new file mode 100644
index 0000000..becf7e2
--- /dev/null
+++ b/gv_gif.pl
@@ -0,0 +1,109 @@
+:- module(
+  gv_gif,
+  [
+    create_gif/3, % +Edges:ordset
+                  % -Gif:compound
+                  % +Options:list(nvpair)
+    create_gif/4 % +Vertices:ordset
+                 % +Edges:ordset
+                 % -Gif:compound
+                 % +Options:list(nvpair)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz Graph Interchange Format (GIF)
+
+Support for creating GIF representations.
+
+@author Wouter Beek
+@version 2014/06
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(ordsets)).
+
+:- use_module(generics(list_ext)).
+
+:- use_module(plRdf(rdf_name)). % Meta-DCG.
+
+
+
+%! create_gif(+Edges:ordset, -Gif:compound, +Options:list(nvpair)) is det.
+
+create_gif(Es, Gif, Options):-
+  edges_to_vertices(Es, Vs),
+  create_gif(Vs, Es, Gif, Options).
+
+%! create_gif(
+%!   +Vertices:ordset,
+%!   +Edges:ordset,
+%!   -Gif:compound,
+%!   +Options:list(nvpair)
+%! ) is det.
+
+create_gif(Vs, Es, graph(V_Terms,E_Terms,G_Attrs), Options):-
+  maplist(vertex_term0(Vs, Options), Vs, V_Terms),
+  maplist(edge_term0(Vs, Options), Es, E_Terms),
+  G_Attrs = [directed=true].
+
+edge_term0(Vs, Options, E, E_Term):-
+  edge_term(Vs, E, E_Term, Options).
+
+vertex_term0(Vs, Options, V, V_Term):-
+  vertex_term(Vs, V, V_Term, Options).
+
+
+%! edge_term(
+%!   +Vertices:ordset,
+%!   +Edge:pair,
+%!   -EdgeTerm:compound,
+%!   +Options:list(nvpair)
+%! ) is det.
+
+edge_term(Vs, E, edge(FromId,ToId,E_Attrs), _):-
+  edge_components(E, FromV, _, ToV),
+  nth0chk(FromId, Vs, FromV),
+  nth0chk(ToId, Vs, ToV),
+  E_Attrs = [].
+
+
+%! vertex_term(
+%!   +Vertices:ordset,
+%!   +Vertex,
+%!   -VertexTerm:compound,
+%!   +Options:list(nvpair)
+%! ) is det.
+
+vertex_term(Vs, V, vertex(Id,V,V_Attrs), Options):-
+  nth0chk(Id, Vs, V),
+  
+  % Label.
+  option(vertex_label(VertexLabel), Options, =),
+  call(VertexLabel, V, V_Label),
+  
+  V_Attrs = [label=V_Label].
+
+vertex_label(V, V_Label):-
+  dcg_with_output_to(atom(V_Label), rdf_term_name([literal_ellipsis(50)], V)).
+
+
+
+% Helpers
+
+%! edge_components(+Edge:compound, -FromVertex, -EdgeType, -ToVertex) is det.
+%! edge_components(-Edge:compound, +FromVertex, ?EdgeType, +ToVertex) is det.
+
+edge_components(FromV-EdgeType-ToV, FromV, EdgeType, ToV):-
+  nonvar(EdgeType).
+edge_components(FromV-ToV, FromV, EdgeType, ToV):-
+  var(EdgeType).
+
+
+%! edges_to_vertices(+Edges:ordset, -Vertices:ordset) is det.
+
+edges_to_vertices([], []):- !.
+edges_to_vertices([S-_-O|T], S3):-
+  edges_to_vertices(T, S1),
+  ord_add_element(S1, S, S2),
+  ord_add_element(S2, O, S3).
+
diff --git a/gv_tree.pl b/gv_tree.pl
new file mode 100644
index 0000000..4412a90
--- /dev/null
+++ b/gv_tree.pl
@@ -0,0 +1,39 @@
+:- module(
+  gv_tree,
+  [
+    tree_to_gv_file/3 % +Options:list(nvpair)
+                      % +Tree:compound
+                      % ?ToFile:atom
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz tree
+
+Export trees to GraphViz.
+
+@author Wouter Beek
+@version 2014/06
+*/
+
+:- use_module(library(aggregate)).
+
+:- use_module(generics(trees)).
+
+:- use_module(plGraphViz(gv_file)).
+:- use_module(plGraphViz(gv_gif)).
+
+
+%! tree_to_gv_file(+Options:list(nvpair), +Tree:compound, ?ToFile:atom) is det.
+% Stores the given tree term into a GraphViz file.
+%
+% Options are passed on to create_gif/3 and gif_to_gv_file/3.
+
+tree_to_gv_file(Options, Tree, ToFile):-
+  tree_to_gif(Tree, Gif, Options),
+  gif_to_gv_file(Options, Gif, ToFile).
+
+
+tree_to_gif(H-T, Gif, Options):-
+  tree_to_vertices_edges(Tree, Vs, Es),
+  create_gif(Vs, Es, Gif, Options).
+
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;10&#34;&gt; 10: 正在比较变动前 5520d75 和变动后 8656a39 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index f9a0e7f..7a64c82 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -191,7 +191,7 @@ doubleList1(Float) --&amp;gt;
   double(Float).
 
 
-%! escString(+String:atom)// ,
+%! escString(+String:atom)// .
 % @tbd Support for context-dependent replacements.
 
 escString(String) --&amp;gt;
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;11&#34;&gt; 11: 正在比较变动前 8656a39 和变动后 7421981 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index fe63e28..c780692 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -1,12 +1,12 @@
 :- module(
   gv_file,
   [
-    gif_to_gv_file/3, % +Options:list(nvpair)
-                        % +GraphInterchangeFormat:compound
-                        % ?ToFile:atom
-    graph_to_svg_dom/3, % +Options:list(nvpair)
-                        % +GraphInterchangeFormat:compound
+    gif_to_gv_file/3, % +GraphInterchangeFormat:compound
+                      % ?ToFile:atom
+                      % +Options:list(nvpair)
+    graph_to_svg_dom/3, % +GraphInterchangeFormat:compound
                         % -SvgDom:list(compound)
+                        % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -20,11 +20,12 @@ Also converts between GraphViz DOT formatted files
 and GraphViz output files or SVG DOM structures.
 
 @author Wouter Beek
-@version 2011-2013/09, 2013/11-2014/01, 2014/05
+@version 2011-2013/09, 2013/11-2014/01, 2014/05, 2014/07
 */
 
 :- use_module(library(option)).
 :- use_module(library(process)).
+:- use_module(library(predicate_options)). % Declarations.
 
 :- use_module(generics(codes_ext)).
 :- use_module(generics(db_ext)).
@@ -48,73 +49,76 @@ and GraphViz output files or SVG DOM structures.
 :- multifile(user:prolog_file_type/2).
 
 % Register DOT.
-user:prolog_file_type(dot, dot).
-user:prolog_file_type(dot, graphviz).
-user:file_type_program(dot, dotty).
-user:file_type_program(dot, dotx).
-user:module_uses(gv_file, file_type(dot)).
+:- db_add_novel(user:prolog_file_type(dot, dot)).
+:- db_add_novel(user:prolog_file_type(dot, graphviz)).
+:- db_add_novel(user:file_type_program(dot, dotty)).
+:- db_add_novel(user:file_type_program(dot, dotx)).
+:- db_add_novel(user:module_uses(gv_file, file_type(dot))).
 
 % Register JPG/JPEG.
-user:prolog_file_type(jpeg, jpeg).
-user:prolog_file_type(jpeg, graphviz_output).
-user:prolog_file_type(jpg, jpeg).
-user:prolog_file_type(jpg, graphviz_output).
+:- db_add_novel(user:prolog_file_type(jpeg, jpeg)).
+:- db_add_novel(user:prolog_file_type(jpeg, graphviz_output)).
+:- db_add_novel(user:prolog_file_type(jpg, jpeg)).
+:- db_add_novel(user:prolog_file_type(jpg, graphviz_output)).
 
 % Register PDF.
-user:prolog_file_type(pdf, pdf).
-user:prolog_file_type(pdf, graphviz_output).
+:- db_add_novel(user:prolog_file_type(pdf, pdf)).
+:- db_add_novel(user:prolog_file_type(pdf, graphviz_output)).
 
 % Register PNG.
-user:prolog_file_type(png, png).
-user:prolog_file_type(png, graphviz_output).
+:- db_add_novel(user:prolog_file_type(png, png)).
+:- db_add_novel(user:prolog_file_type(png, graphviz_output)).
 
 % Register SVG.
-user:prolog_file_type(svg, graphviz_output).
-user:prolog_file_type(svg, svg).
+:- db_add_novel(user:prolog_file_type(svg, graphviz_output)).
+:- db_add_novel(user:prolog_file_type(svg, svg)).
 
 % Register XDOT.
-user:prolog_file_type(xdot, graphviz_output).
-user:prolog_file_type(xdot, xdot).
-
-
-
-%! gif_to_gv_file(
-%!   +Options:list(nvpair),
-%!   +GIF:compound,
-%!   -ToFile:atom
-%! ) is det.
+:- db_add_novel(user:prolog_file_type(xdot, graphviz_output)).
+:- db_add_novel(user:prolog_file_type(xdot, xdot)).
+
+:- predicate_options(graph_to_svg_dom/3, 3, [
+     pass_to(gif_to_gv_file/3, 3)
+   ]).
+:- predicate_options(gif_to_gv_file/3, 3, [
+     pass_to(to_gv_file/3, 3)
+   ]).
+:- predicate_options(to_gv_file/3, 3, [
+     pass_to(convert_gv/3, 3)
+   ]).
+:- predicate_options(convert_gv/3, 3, [
+     method(+oneof([dot,sfdp])),
+     to_file_type(+oneof([dot,jpeg,pdf,svg,xdot]))
+   ]).
+
+
+
+%! gif_to_gv_file(+Gif:compound, -ToFile:atom, +Options:list(nvpair)) is det.
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
 %   * =|method(+Method:oneof([dot,sfdp])|=
 %     The algorithm used by GraphViz for positioning the tree nodes.
 %     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([jpeg,pdf,svg,xdot])|=
+%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
 %     The file type of the generated GraphViz file.
-%
-% @arg Options A list of name-value pairs.
-% @arg GIF A compound term representing a graph.
-% @arg ToFile The atomic name of a file.
+%     Default: `pdf`.
 
-gif_to_gv_file(O1, GIF, ToFile):-
-  once(phrase(gv_graph(GIF), Codes)),
-  to_gv_file(O1, Codes, ToFile).
+gif_to_gv_file(Gif, ToFile, Options):-
+  once(phrase(gv_graph(Gif), Codes)),
+  to_gv_file(Codes, ToFile, Options).
 
 
 %! graph_to_svg_dom(
-%!   +Options:list(nvpair),
 %!   +GraphInterchangeFormat:compound,
-%!   -SvgDom:list(compound)
+%!   -SvgDom:list(compound),
+%!   +Options:list(nvpair)
 %! ) is det.
-% The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
 
-graph_to_svg_dom(O1, GIF, SvgDom):-
+graph_to_svg_dom(Gif, SvgDom, Options1):-
   % Make sure the file type of the output file is SvgDom.
-  merge_options([to_file_type=svg], O1, O2),
-  gif_to_gv_file(O2, GIF, ToFile),
+  merge_options([to_file_type=svg], Options1, Options2),
+  gif_to_gv_file(Gif, ToFile, Options2),
   file_to_svg(ToFile, SvgDom),
   safe_delete_file(ToFile).
 
@@ -133,31 +137,23 @@ open_dot(File):-
 
 % SUPPORT PREDICATES %
 
-%! convert_gv(+Options:list(nvpair), +FromFile:atom, ?ToFile:atom) is det.
+%! convert_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
 % Converts a GraphViz DOT file to an image file, using a specific
 % visualization method.
-%
-% The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([jpeg,pdf,svg,xdot])|=
-%     The file type of the generated GraphViz file.
-%
-% @arg Options
-% @arg FromFile
-% @arg ToFile
 
-convert_gv(O1, FromFile, ToFile):-
+convert_gv(FromFile, ToFile, Options):-
+  option(to_file_type(dot), Options), !,
+  rename_file(FromFile, ToFile).
+convert_gv(FromFile, ToFile, Options):-
   % The input file must be readable.
   access_file(FromFile, read),
 
   % The method option.
-  option(method(Method), O1, dot),
+  option(method(Method), Options, dot),
   must_be(oneof([dot,sfdp]), Method),
 
   % The file type option.
-  option(to_file_type(ToFileType), O1, pdf),
+  option(to_file_type(ToFileType), Options, pdf),
   prolog_file_type(ToExtension, ToFileType),
   prolog_file_type(ToExtension, graphviz_output), !,
 
@@ -189,15 +185,10 @@ convert_gv(O1, FromFile, ToFile):-
   process_wait(PID, exit(ShellStatus)),
   exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
 
-%! to_gv_file(+Options:list(nvpair), +Codes:list(code), ?ToFile:atom) is det.
-% The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([jpeg,pdf,svg,xdot])|=
-%     The file type of the generated GraphViz file.
 
-to_gv_file(O1, Codes, ToFile):-
+%! to_gv_file(+Codes:list(code), ?ToFile:atom, +Options:list(nvpair)) is det.
+
+to_gv_file(Codes, ToFile, Options):-
   absolute_file_name(
     data(tmp),
     FromFile,
@@ -208,13 +199,13 @@ to_gv_file(O1, Codes, ToFile):-
     put_codes(Out, Codes),
     close(Out)
   ),
-  convert_gv(O1, FromFile, ToFile),
+  convert_gv(FromFile, ToFile, Options),
 
-  % DEB: Store DOT file.
-  ignore((
-    file_type_alternative(ToFile, graphviz, DOT_File),
-    safe_copy_file(FromFile, DOT_File)
-  )),
+  %%%%% DEB: Store DOT file.
+  %%%%ignore((
+  %%%%  file_type_alternative(ToFile, graphviz, DOT_File),
+  %%%%  safe_copy_file(FromFile, DOT_File)
+  %%%%)),
 
   safe_delete_file(FromFile).
 
diff --git a/gv_tree.pl b/gv_tree.pl
index 4412a90..afeb8f6 100644
--- a/gv_tree.pl
+++ b/gv_tree.pl
@@ -1,9 +1,9 @@
 :- module(
   gv_tree,
   [
-    tree_to_gv_file/3 % +Options:list(nvpair)
-                      % +Tree:compound
+    tree_to_gv_file/3 % +Tree:compound
                       % ?ToFile:atom
+                      % +Options:list(nvpair)
   ]
 ).
 
@@ -12,7 +12,7 @@
 Export trees to GraphViz.
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06-2014/07
 */
 
 :- use_module(library(aggregate)).
@@ -23,14 +23,18 @@ Export trees to GraphViz.
 :- use_module(plGraphViz(gv_gif)).
 
 
-%! tree_to_gv_file(+Options:list(nvpair), +Tree:compound, ?ToFile:atom) is det.
+%! tree_to_gv_file(
+%!   +Tree:compound,
+%!   ?ToFile:atom,
+%!   +Options:list(nvpair)
+%! ) is det.
 % Stores the given tree term into a GraphViz file.
 %
 % Options are passed on to create_gif/3 and gif_to_gv_file/3.
 
-tree_to_gv_file(Options, Tree, ToFile):-
+tree_to_gv_file(Tree, ToFile, Options):-
   tree_to_gif(Tree, Gif, Options),
-  gif_to_gv_file(Options, Gif, ToFile).
+  gif_to_gv_file(Gif, ToFile, Options).
 
 
 tree_to_gif(H-T, Gif, Options):-
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;12&#34;&gt; 12: 正在比较变动前 7421981 和变动后 bfcb63b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index c780692..9cb1f95 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -4,9 +4,9 @@
     gif_to_gv_file/3, % +GraphInterchangeFormat:compound
                       % ?ToFile:atom
                       % +Options:list(nvpair)
-    graph_to_svg_dom/3, % +GraphInterchangeFormat:compound
-                        % -SvgDom:list(compound)
-                        % +Options:list(nvpair)
+    gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
+                      % -SvgDom:list(compound)
+                      % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -77,7 +77,7 @@ and GraphViz output files or SVG DOM structures.
 :- db_add_novel(user:prolog_file_type(xdot, graphviz_output)).
 :- db_add_novel(user:prolog_file_type(xdot, xdot)).
 
-:- predicate_options(graph_to_svg_dom/3, 3, [
+:- predicate_options(gif_to_svg_dom/3, 3, [
      pass_to(gif_to_gv_file/3, 3)
    ]).
 :- predicate_options(gif_to_gv_file/3, 3, [
@@ -109,13 +109,13 @@ gif_to_gv_file(Gif, ToFile, Options):-
   to_gv_file(Codes, ToFile, Options).
 
 
-%! graph_to_svg_dom(
+%! gif_to_svg_dom(
 %!   +GraphInterchangeFormat:compound,
 %!   -SvgDom:list(compound),
 %!   +Options:list(nvpair)
 %! ) is det.
 
-graph_to_svg_dom(Gif, SvgDom, Options1):-
+gif_to_svg_dom(Gif, SvgDom, Options1):-
   % Make sure the file type of the output file is SvgDom.
   merge_options([to_file_type=svg], Options1, Options2),
   gif_to_gv_file(Gif, ToFile, Options2),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;13&#34;&gt; 13: 正在比较变动前 bfcb63b 和变动后 84afd69 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 9cb1f95..98cb0a2 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -1,8 +1,13 @@
 :- module(
   gv_file,
   [
+    file_to_gv/2, % +File:atom
+                  % +Options:list(nvpair)
+    file_to_gv/3, % +FromFile:atom
+                  % ?ToFile:atom
+                  % +Options:list(nvpair)
     gif_to_gv_file/3, % +GraphInterchangeFormat:compound
-                      % ?ToFile:atom
+                      % +ToFile:atom
                       % +Options:list(nvpair)
     gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
                       % -SvgDom:list(compound)
@@ -23,6 +28,7 @@ and GraphViz output files or SVG DOM structures.
 @version 2011-2013/09, 2013/11-2014/01, 2014/05, 2014/07
 */
 
+:- use_module(library(memfile)).
 :- use_module(library(option)).
 :- use_module(library(process)).
 :- use_module(library(predicate_options)). % Declarations.
@@ -77,74 +83,60 @@ and GraphViz output files or SVG DOM structures.
 :- db_add_novel(user:prolog_file_type(xdot, graphviz_output)).
 :- db_add_novel(user:prolog_file_type(xdot, xdot)).
 
-:- predicate_options(gif_to_svg_dom/3, 3, [
-     pass_to(gif_to_gv_file/3, 3)
-   ]).
-:- predicate_options(gif_to_gv_file/3, 3, [
-     pass_to(to_gv_file/3, 3)
+:- predicate_options(codes_to_gv_file/3, 3, [
+     pass_to(file_to_gv/3, 3)
    ]).
-:- predicate_options(to_gv_file/3, 3, [
-     pass_to(convert_gv/3, 3)
+:- predicate_options(file_to_gv/2, 2, [
+     pass_to(file_to_gv/3, 3)
    ]).
-:- predicate_options(convert_gv/3, 3, [
+:- predicate_options(file_to_gv/3, 3, [
      method(+oneof([dot,sfdp])),
      to_file_type(+oneof([dot,jpeg,pdf,svg,xdot]))
    ]).
+:- predicate_options(gif_to_svg_dom/3, 3, [
+     pass_to(gif_to_gv_file/3, 3)
+   ]).
+:- predicate_options(gif_to_gv_file/3, 3, [
+     pass_to(codes_to_gv_file/3, 3)
+   ]).
 
 
 
-%! gif_to_gv_file(+Gif:compound, -ToFile:atom, +Options:list(nvpair)) is det.
-% Returns a file containing a GraphViz visualization of the given graph.
-%
-% The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
-%     The file type of the generated GraphViz file.
-%     Default: `pdf`.
-
-gif_to_gv_file(Gif, ToFile, Options):-
-  once(phrase(gv_graph(Gif), Codes)),
-  to_gv_file(Codes, ToFile, Options).
-
-
-%! gif_to_svg_dom(
-%!   +GraphInterchangeFormat:compound,
-%!   -SvgDom:list(compound),
+%! codes_to_gv_file(
+%!   +Codes:list(code),
+%!   +ToFile:atom,
 %!   +Options:list(nvpair)
 %! ) is det.
 
-gif_to_svg_dom(Gif, SvgDom, Options1):-
-  % Make sure the file type of the output file is SvgDom.
-  merge_options([to_file_type=svg], Options1, Options2),
-  gif_to_gv_file(Gif, ToFile, Options2),
-  file_to_svg(ToFile, SvgDom),
-  safe_delete_file(ToFile).
-
-
-%! open_dot(+File:atom) is det.
-% Opens the given DOT file.
-%
-% @tbd Test support on Windows.
-% @tbd Test support on OS-X.
-
-open_dot(File):-
-  once(find_program_by_file_type(dot, Program)),
-  run_program(Program, [File]).
+codes_to_gv_file(Codes, ToFile, Options):-
+  access_file(ToFile, write),
+  setup_call_cleanup(
+    new_memory_file(MemFile),
+    (
+      setup_call_cleanup(
+        open(MemFile, write, Write, [encoding(utf8),type(test)]),
+        put_codes(Write, Codes),
+        close(Write)
+      ),
+      file_to_gv(MemFile, ToFile, Options)
+    ),
+    free_memory_file(MemFile)
+  ).
 
 
+%! file_to_gv(+FromFile:atom, +Options:list(nvpair)) is det.
 
-% SUPPORT PREDICATES %
+file_to_gv(FromFile, Options):-
+  file_to_gv(FromFile, _, Options).
 
-%! convert_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
+%! file_to_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
 % Converts a GraphViz DOT file to an image file, using a specific
 % visualization method.
 
-convert_gv(FromFile, ToFile, Options):-
+file_to_gv(FromFile, ToFile, Options):-
   option(to_file_type(dot), Options), !,
   rename_file(FromFile, ToFile).
-convert_gv(FromFile, ToFile, Options):-
+file_to_gv(FromFile, ToFile, Options):-
   % The input file must be readable.
   access_file(FromFile, read),
 
@@ -186,26 +178,43 @@ convert_gv(FromFile, ToFile, Options):-
   exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
 
 
-%! to_gv_file(+Codes:list(code), ?ToFile:atom, +Options:list(nvpair)) is det.
+%! gif_to_gv_file(+Gif:compound, +ToFile:atom, +Options:list(nvpair)) is det.
+% Returns a file containing a GraphViz visualization of the given graph.
+%
+% The following options are supported:
+%   * =|method(+Method:oneof([dot,sfdp])|=
+%     The algorithm used by GraphViz for positioning the tree nodes.
+%     Either =dot= (default) or =sfdp=.
+%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
+%     The file type of the generated GraphViz file.
+%     Default: `pdf`.
+
+gif_to_gv_file(Gif, ToFile, Options):-
+  once(phrase(gv_graph(Gif), Codes)),
+  codes_to_gv_file(Codes, ToFile, Options).
+
+
+%! gif_to_svg_dom(
+%!   +GraphInterchangeFormat:compound,
+%!   -SvgDom:list(compound),
+%!   +Options:list(nvpair)
+%! ) is det.
+
+gif_to_svg_dom(Gif, SvgDom, Options1):-
+  % Make sure the file type of the output file is SvgDom.
+  merge_options([to_file_type=svg], Options1, Options2),
+  gif_to_gv_file(Gif, ToFile, Options2),
+  file_to_svg(ToFile, SvgDom),
+  safe_delete_file(ToFile).
 
-to_gv_file(Codes, ToFile, Options):-
-  absolute_file_name(
-    data(tmp),
-    FromFile,
-    [access(write),file_type(graphviz)]
-  ),
-  setup_call_cleanup(
-    open(FromFile, write, Out, [encoding(utf8),type(test)]),
-    put_codes(Out, Codes),
-    close(Out)
-  ),
-  convert_gv(FromFile, ToFile, Options),
 
-  %%%%% DEB: Store DOT file.
-  %%%%ignore((
-  %%%%  file_type_alternative(ToFile, graphviz, DOT_File),
-  %%%%  safe_copy_file(FromFile, DOT_File)
-  %%%%)),
+%! open_dot(+File:atom) is det.
+% Opens the given DOT file.
+%
+% @tbd Test support on Windows.
+% @tbd Test support on OS-X.
 
-  safe_delete_file(FromFile).
+open_dot(File):-
+  once(find_program_by_file_type(dot, Program)),
+  run_program(Program, [File]).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;14&#34;&gt; 14: 正在比较变动前 84afd69 和变动后 c2bfd3f &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_gif.pl b/gv_gif.pl
index becf7e2..908b9bc 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -16,16 +16,35 @@
 Support for creating GIF representations.
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06-2014/07
 */
 
 :- use_module(library(apply)).
+:- use_module(library(lambda)).
+:- use_module(library(option)).
 :- use_module(library(ordsets)).
+:- use_module(library(predicate_options)). % Declarations.
 
 :- use_module(generics(list_ext)).
+:- use_module(generics(option_ext)).
+:- use_module(graph_theory(graph_generic)).
 
 :- use_module(plRdf(rdf_name)). % Meta-DCG.
 
+:- predicate_options(create_gif/3, 3, [
+     pass_to(create_gif/4, 4)
+   ]).
+:- predicate_options(create_gif/4, 4, [
+     pass_to(vertex_term/3, 3),
+     pass_to(edge_term/3, 3),
+     graph_label(+atom)
+   ]).
+:- predicate_options(edge_term/3, 3, [
+   ]).
+:- predicate_options(vertex_term/3, 3, [
+     vertex_label(+atom)
+   ]).
+
 
 
 %! create_gif(+Edges:ordset, -Gif:compound, +Options:list(nvpair)) is det.
@@ -40,17 +59,28 @@ create_gif(Es, Gif, Options):-
 %!   -Gif:compound,
 %!   +Options:list(nvpair)
 %! ) is det.
-
-create_gif(Vs, Es, graph(V_Terms,E_Terms,G_Attrs), Options):-
-  maplist(vertex_term0(Vs, Options), Vs, V_Terms),
-  maplist(edge_term0(Vs, Options), Es, E_Terms),
-  G_Attrs = [directed=true].
-
-edge_term0(Vs, Options, E, E_Term):-
-  edge_term(Vs, E, E_Term, Options).
-
-vertex_term0(Vs, Options, V, V_Term):-
-  vertex_term(Vs, V, V_Term, Options).
+% The following options are supported:
+%   * =|graph_label(+LabelFunction)|=
+%     The functions that assigns names to graphs.
+%     No default.
+
+create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
+  % Vertex terms.
+  maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Options), Vs, VTerms),
+  
+  % Edge terms.
+  maplist(\E^ETerm^edge_term(Vs, E, ETerm, Options), Es, ETerms),
+  
+  % Graph attributes.
+  (
+    option(graph_label(LabelFunction), Options)
+  -&amp;gt;
+    call(LabelFunction, Graph, GraphLabel)
+  ;
+    true
+  ),
+  
+  merge_options([directed=true,label=GraphLabel], GAttrs).
 
 
 %! edge_term(
@@ -60,11 +90,13 @@ vertex_term0(Vs, Options, V, V_Term):-
 %!   +Options:list(nvpair)
 %! ) is det.
 
-edge_term(Vs, E, edge(FromId,ToId,E_Attrs), _):-
-  edge_components(E, FromV, _, ToV),
+edge_term(Vs, E, edge(FromId,ToId,EAttrs), _):-
+  edge_components(E, FromV, ToV),
+  
   nth0chk(FromId, Vs, FromV),
   nth0chk(ToId, Vs, ToV),
-  E_Attrs = [].
+  
+  EAttrs = [].
 
 
 %! vertex_term(
@@ -73,37 +105,16 @@ edge_term(Vs, E, edge(FromId,ToId,E_Attrs), _):-
 %!   -VertexTerm:compound,
 %!   +Options:list(nvpair)
 %! ) is det.
+% The following options are supported:
+%   * =|vertex_label(+LabelFunction)|=
+%     A function that assigns labels to vertices.
 
-vertex_term(Vs, V, vertex(Id,V,V_Attrs), Options):-
+vertex_term(Vs, V, vertex(Id,V,VAttrs), Options):-
   nth0chk(Id, Vs, V),
   
   % Label.
-  option(vertex_label(VertexLabel), Options, =),
-  call(VertexLabel, V, V_Label),
+  option(vertex_label(LabelFunction), Options, =),
+  call(LabelFunction, V, VLabel),
   
-  V_Attrs = [label=V_Label].
-
-vertex_label(V, V_Label):-
-  dcg_with_output_to(atom(V_Label), rdf_term_name([literal_ellipsis(50)], V)).
-
-
-
-% Helpers
-
-%! edge_components(+Edge:compound, -FromVertex, -EdgeType, -ToVertex) is det.
-%! edge_components(-Edge:compound, +FromVertex, ?EdgeType, +ToVertex) is det.
-
-edge_components(FromV-EdgeType-ToV, FromV, EdgeType, ToV):-
-  nonvar(EdgeType).
-edge_components(FromV-ToV, FromV, EdgeType, ToV):-
-  var(EdgeType).
-
-
-%! edges_to_vertices(+Edges:ordset, -Vertices:ordset) is det.
-
-edges_to_vertices([], []):- !.
-edges_to_vertices([S-_-O|T], S3):-
-  edges_to_vertices(T, S1),
-  ord_add_element(S1, S, S2),
-  ord_add_element(S2, O, S3).
+  VAttrs = [label=VLabel].
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;15&#34;&gt; 15: 正在比较变动前 c2bfd3f 和变动后 fa364fc &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index 9888973..68443ba 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -76,13 +76,13 @@ gv_compass_pt(sw) --&amp;gt; `sw`.
 gv_compass_pt(w) --&amp;gt; `w`.
 
 
-%! gv_edge_operator(+Directed:boolean)// .
+%! gv_edge_operator(+Directedness:boolean)// .
 % The binary edge operator between two vertices.
 % The operator that is used depends on whether the graph is directed or
 % undirected.
 %
-% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
-%               undirected (operator `--`).
+% @arg Directedness Whether an edge is directed (operator `-&amp;gt;`) or
+%                   undirected (operator `--`).
 
 gv_edge_operator(false) --&amp;gt; !, `--`.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
@@ -90,14 +90,14 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 %! gv_edge_statement(
 %!   +Indent:nonneg,
-%!   +Directed:boolean,
+%!   +Directedness:boolean,
 %!   +GraphAttributes:list(nvpair),
 %!   +EdgeTerm:compound
 %! )// is det.
 % A GraphViz statement describing an edge.
 %
 % @arg Indent The indentation level at which the edge statement is written.
-% @arg Directed Whether the graph is directed or not.
+% @arg Directedness Whether the graph is directed or not.
 % @arg GraphAttributes The attributes of the graph. Some of these attributes
 %      may be used in the edge statement (e.g., the colorscheme).
 % @arg EdgeTerm A compound term in the GIFormat, representing an edge.
@@ -106,11 +106,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 %      at the from and/or to location.
 % @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
 
-gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
+gv_edge_statement(I, Directedness, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
   gv_node_id(FromId), ` `,
 
-  gv_edge_operator(Directed), ` `,
+  gv_edge_operator(Directedness), ` `,
 
   gv_node_id(ToId), ` `,
 
@@ -148,11 +148,11 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 %! gv_graph(+GraphTerm:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
-%   1. `directonality(+Directed:oneof([directed,undirected]))`
-%      A directed graph uses the keyword `digraph`.
-%      An undirected graph uses the keyword `graph`.
-%   2. `name(+GraphName:atom)`
-%   3. `strict(+StrictGraph:boolean)`
+%   * `directedness(+boolean)`
+%      Whether the graph is directed (`true`) or undirected (`false`).
+%      Default: `false`.
+%   * `name(+GraphName:atom)`
+%   * `strict(+StrictGraph:boolean)`
 %      This forbids the creation of self-arcs and multi-edges;
 %      they are ignored in the input file.
 %      Only in combinattion with directionality `directed`.
@@ -185,7 +185,7 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
     select_nvpair(strict=Strict, GAttrs1, GAttrs2, false),
-    select_nvpair(directed=Directed, GAttrs2, GAttrs3, true),
+    select_nvpair(directedness=Directedness, GAttrs2, GAttrs3, true),
     select_nvpair(name=GName, GAttrs3, GAttrs4, noname),
     add_default_nvpair(GAttrs4, overlap, false, GAttrs5),
     I = 0
@@ -195,24 +195,24 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), ` `,
+  gv_graph_type(Directedness), ` `,
   gv_id(GName), ` `,
   bracketed(
     curly,
-    gv_graph1(
+    gv_graph0(
       I,
       NewVTerms, SharedVAttrs, RankedVTerms,
       NewETerms, SharedEAttrs,
-      Directed, GAttrs5
+      Directedness, GAttrs5
     )
-  ),
+  ),                                                      
   newline.
 
-gv_graph1(
+gv_graph0(
   I,
   NewVTerms, SharedVAttrs, RankedVTerms,
   NewETerms, SharedEAttrs,
-  Directed, GAttrs
+  Directedness, GAttrs
 ) --&amp;gt;
   newline,
 
@@ -254,10 +254,10 @@ gv_graph1(
   },
 
   % The rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), RankEdges),
+  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), RankEdges),
 
   % The non-rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), NewETerms),
+  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), NewETerms),
 
   % Note that we do not include a newline here.
 
@@ -265,7 +265,7 @@ gv_graph1(
   indent(I).
 
 
-%! gv_graph_type(+Directed:boolean)// .
+%! gv_graph_type(+Directedness:boolean)// .
 % The type of graph that is represented.
 
 gv_graph_type(false) --&amp;gt; `graph`.
diff --git a/gv_gif.pl b/gv_gif.pl
index 908b9bc..4a3e75f 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -35,14 +35,25 @@ Support for creating GIF representations.
      pass_to(create_gif/4, 4)
    ]).
 :- predicate_options(create_gif/4, 4, [
-     pass_to(vertex_term/3, 3),
      pass_to(edge_term/3, 3),
-     graph_label(+atom)
+     pass_to(graph_attributes/2, 2),
+     pass_to(vertex_term/3, 3)
    ]).
 :- predicate_options(edge_term/3, 3, [
    ]).
+:- predicate_options(graph_attributes/2, 2, [
+     directedness(+boolean),
+     graph_colorscheme(+oneof([none,svg,x11]),
+     graph_label(+atom)
+   ]).
+
 :- predicate_options(vertex_term/3, 3, [
-     vertex_label(+atom)
+     vertex_color(+atom),
+     vertex_coordinates(+atom),
+     vertex_image(+atom),
+     vertex_label(+atom),
+     vertex_peripheries(+atom),
+     vertex_shape(+atom)
    ]).
 
 
@@ -60,6 +71,8 @@ create_gif(Es, Gif, Options):-
 %!   +Options:list(nvpair)
 %! ) is det.
 % The following options are supported:
+%   * =|graph_colorscheme(+oneof([none,svg,x11]))
+%     No default.
 %   * =|graph_label(+LabelFunction)|=
 %     The functions that assigns names to graphs.
 %     No default.
@@ -72,15 +85,7 @@ create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
   maplist(\E^ETerm^edge_term(Vs, E, ETerm, Options), Es, ETerms),
   
   % Graph attributes.
-  (
-    option(graph_label(LabelFunction), Options)
-  -&amp;gt;
-    call(LabelFunction, Graph, GraphLabel)
-  ;
-    true
-  ),
-  
-  merge_options([directed=true,label=GraphLabel], GAttrs).
+  graph_attributes(GAttrs, Options).
 
 
 %! edge_term(
@@ -89,14 +94,69 @@ create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
 %!   -EdgeTerm:compound,
 %!   +Options:list(nvpair)
 %! ) is det.
+% The following options are supported:
+%   * =|edge_arrowhead(+atom)|=
+%   * =|edge_color(+atom)|=
+%   * =|edge_label(+atom)|=
+%   * =|edge_style(+atom)|=
 
 edge_term(Vs, E, edge(FromId,ToId,EAttrs), _):-
   edge_components(E, FromV, ToV),
-  
   nth0chk(FromId, Vs, FromV),
   nth0chk(ToId, Vs, ToV),
   
-  EAttrs = [].
+  % Arrowhead
+  if_option(edge_arrowhead(ArrowheadFunction), Options,
+    call(ArrowheadFunction, E, EArrowhead)
+  ),
+  
+  % Color.
+  if_option(edge_color(ColorFunction), Options,
+    call(ColorFunction, E, EColor)
+  ),
+  
+  % Label.
+  if_option(edge_label(LabelFunction), Options,
+    call(LabelFunction, E, ELabel)
+  ),
+  
+  % Style.
+  if_option(edge_style(StyleFunction), Options,
+    call(StyleFunction, E, EStyle)
+  ),
+  
+  EAttrs = [arrowHead=EArrowhead,color=EColor,label=ELabel,style=EStyle].
+
+
+%! graph_attributes(
+%!   -GraphAttributes:list(nvpair),
+%!   +Options:list(nvpair)
+%! ) is det.
+% The following options are supported:
+%   * =|directedness(+boolean)|=
+%     Whether the graph is directed (`true`) or undirected (`false`).
+%     Default: `false`.
+%   * =|graph_colorscheme(+oneof([none,svg,x11]))|=
+%     The colorscheme from which the color in this graph are taken.
+%     Default: `svg`.
+%   * =|graph_label(+atom)|=
+%     The graph label.
+%     No default.
+
+graph_attributes(GAttrs, Options):-
+  % Directedness.
+  option(directedness(Directedness), Options, false),
+  
+  % Colorscheme.
+  if_option(graph_colorscheme(Colorscheme), Options, true),
+  
+  % Label.
+  if_option(graph_label(GLabel), Options, true),
+  
+  merge_options(
+    [colorscheme=Colorscheme,directedness=Directedness,label=GLabel],
+    GAttrs
+  ).
 
 
 %! vertex_term(
@@ -106,15 +166,66 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), _):-
 %!   +Options:list(nvpair)
 %! ) is det.
 % The following options are supported:
+%   * =|vertex_color(+ColorFunction)|=
+%     A function that assigns colors to vertices.
+%     No default.
+%   * =|vertex_coordinate(+CoordinateFunction)|=
+%     A function that assigns coordinates to vertices.
+%     No default.
+%   * =|vertex_image(+ImageFunction)|=
+%     A function that assinges images to vertices.
+%     No default.
 %   * =|vertex_label(+LabelFunction)|=
 %     A function that assigns labels to vertices.
+%     No default.
+%   * =|vertex_peripheries(+PeripheriesFunction)|=
+%     A function that assinges peripheries to vertices.
+%     No default.
+%   * =|vertex_shape(+ShapeFunction)|=
+%     A function that assinges shapes to vertices.
+%     No default.
 
 vertex_term(Vs, V, vertex(Id,V,VAttrs), Options):-
   nth0chk(Id, Vs, V),
   
+  % Color.
+  if_option(vertex_color(ColorFunction), Options,
+    call(ColorFunction, V, VColor)
+  ),
+  
+  % Coordinates.
+  %%%%if_option(vertex_coordinate(CoordinateFunction), Options,
+  %%%%  call(CoordinateFunction, V, VCoordinates)
+  %%%%),
+  
+  % Image.
+  if_option(image(ImageFunction), Options,
+    call(ImageFunction, V, VImage)
+  ),
+  
   % Label.
-  option(vertex_label(LabelFunction), Options, =),
-  call(LabelFunction, V, VLabel),
+  if_option(vertex_label(LabelFunction), Options,
+    call(LabelFunction, V, VLabel)
+  ),
+  
+  % Peripheries.
+  if_option(vertex_peripheries(PeripheriesFunction), Options,
+    call(PeripheriesFunction, V, VPeripheries)
+  ),
+  
+  % Shape.
+  if_option(vertex_shape(ShapeFunction), Options,
+    call(ShapeFunction, V, VShape)
+  ),
   
-  VAttrs = [label=VLabel].
+  merge_options(
+    [
+      color=VColor,
+      image=VImage,
+      label=VLabel,
+      peripheries=VPeripheries,
+      shape=VShape
+    ],
+    VAttrs
+  ).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;16&#34;&gt; 16: 正在比较变动前 fa364fc 和变动后 3c900f4 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_gif.pl b/gv_gif.pl
index 4a3e75f..ef2f7f2 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -43,7 +43,7 @@ Support for creating GIF representations.
    ]).
 :- predicate_options(graph_attributes/2, 2, [
      directedness(+boolean),
-     graph_colorscheme(+oneof([none,svg,x11]),
+     graph_colorscheme(+oneof([none,svg,x11])),
      graph_label(+atom)
    ]).
 
@@ -109,23 +109,23 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), _):-
   if_option(edge_arrowhead(ArrowheadFunction), Options,
     call(ArrowheadFunction, E, EArrowhead)
   ),
-  
   % Color.
   if_option(edge_color(ColorFunction), Options,
     call(ColorFunction, E, EColor)
   ),
-  
   % Label.
   if_option(edge_label(LabelFunction), Options,
     call(LabelFunction, E, ELabel)
   ),
-  
   % Style.
   if_option(edge_style(StyleFunction), Options,
     call(StyleFunction, E, EStyle)
   ),
   
-  EAttrs = [arrowHead=EArrowhead,color=EColor,label=ELabel,style=EStyle].
+  merge_options(
+    [arrowHead=EArrowhead,color=EColor,label=ELabel,style=EStyle],
+    EAttrs
+  ).
 
 
 %! graph_attributes(
@@ -146,10 +146,8 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), _):-
 graph_attributes(GAttrs, Options):-
   % Directedness.
   option(directedness(Directedness), Options, false),
-  
   % Colorscheme.
   if_option(graph_colorscheme(Colorscheme), Options, true),
-  
   % Label.
   if_option(graph_label(GLabel), Options, true),
   
@@ -169,9 +167,6 @@ graph_attributes(GAttrs, Options):-
 %   * =|vertex_color(+ColorFunction)|=
 %     A function that assigns colors to vertices.
 %     No default.
-%   * =|vertex_coordinate(+CoordinateFunction)|=
-%     A function that assigns coordinates to vertices.
-%     No default.
 %   * =|vertex_image(+ImageFunction)|=
 %     A function that assinges images to vertices.
 %     No default.
@@ -192,27 +187,18 @@ vertex_term(Vs, V, vertex(Id,V,VAttrs), Options):-
   if_option(vertex_color(ColorFunction), Options,
     call(ColorFunction, V, VColor)
   ),
-  
-  % Coordinates.
-  %%%%if_option(vertex_coordinate(CoordinateFunction), Options,
-  %%%%  call(CoordinateFunction, V, VCoordinates)
-  %%%%),
-  
   % Image.
   if_option(image(ImageFunction), Options,
     call(ImageFunction, V, VImage)
   ),
-  
   % Label.
   if_option(vertex_label(LabelFunction), Options,
     call(LabelFunction, V, VLabel)
   ),
-  
   % Peripheries.
   if_option(vertex_peripheries(PeripheriesFunction), Options,
     call(PeripheriesFunction, V, VPeripheries)
   ),
-  
   % Shape.
   if_option(vertex_shape(ShapeFunction), Options,
     call(ShapeFunction, V, VShape)
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;17&#34;&gt; 17: 正在比较变动前 3c900f4 和变动后 65cc1c3 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_gif.pl b/gv_gif.pl
index ef2f7f2..6d78ac3 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -40,6 +40,10 @@ Support for creating GIF representations.
      pass_to(vertex_term/3, 3)
    ]).
 :- predicate_options(edge_term/3, 3, [
+     edge_arrowhead(+atom),
+     edge_color(+atom),
+     edge_label(+atom),
+     edge_style(+atom)
    ]).
 :- predicate_options(graph_attributes/2, 2, [
      directedness(+boolean),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;18&#34;&gt; 18: 正在比较变动前 65cc1c3 和变动后 20e1f21 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 98cb0a2..25b0cd3 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -110,18 +110,14 @@ and GraphViz output files or SVG DOM structures.
 
 codes_to_gv_file(Codes, ToFile, Options):-
   access_file(ToFile, write),
+  absolute_file_name(data(tmp), TmpFile, [access(write),file_type(dot)]),
   setup_call_cleanup(
-    new_memory_file(MemFile),
-    (
-      setup_call_cleanup(
-        open(MemFile, write, Write, [encoding(utf8),type(test)]),
-        put_codes(Write, Codes),
-        close(Write)
-      ),
-      file_to_gv(MemFile, ToFile, Options)
-    ),
-    free_memory_file(MemFile)
-  ).
+    open(TmpFile, write, Write, [encoding(utf8)]),
+    put_codes(Write, Codes),
+    close(Write)
+  ),
+  file_to_gv(TmpFile, ToFile, Options),
+  delete_file(TmpFile).
 
 
 %! file_to_gv(+FromFile:atom, +Options:list(nvpair)) is det.
@@ -137,9 +133,6 @@ file_to_gv(FromFile, ToFile, Options):-
   option(to_file_type(dot), Options), !,
   rename_file(FromFile, ToFile).
 file_to_gv(FromFile, ToFile, Options):-
-  % The input file must be readable.
-  access_file(FromFile, read),
-
   % The method option.
   option(method(Method), Options, dot),
   must_be(oneof([dot,sfdp]), Method),
diff --git a/gv_gif.pl b/gv_gif.pl
index 6d78ac3..e3a6933 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -84,10 +84,10 @@ create_gif(Es, Gif, Options):-
 create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
   % Vertex terms.
   maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Options), Vs, VTerms),
-  
+
   % Edge terms.
   maplist(\E^ETerm^edge_term(Vs, E, ETerm, Options), Es, ETerms),
-  
+
   % Graph attributes.
   graph_attributes(GAttrs, Options).
 
@@ -104,11 +104,11 @@ create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
 %   * =|edge_label(+atom)|=
 %   * =|edge_style(+atom)|=
 
-edge_term(Vs, E, edge(FromId,ToId,EAttrs), _):-
+edge_term(Vs, E, edge(FromId,ToId,EAttrs), Options):-
   edge_components(E, FromV, ToV),
   nth0chk(FromId, Vs, FromV),
   nth0chk(ToId, Vs, ToV),
-  
+
   % Arrowhead
   if_option(edge_arrowhead(ArrowheadFunction), Options,
     call(ArrowheadFunction, E, EArrowhead)
@@ -125,9 +125,9 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), _):-
   if_option(edge_style(StyleFunction), Options,
     call(StyleFunction, E, EStyle)
   ),
-  
+
   merge_options(
-    [arrowHead=EArrowhead,color=EColor,label=ELabel,style=EStyle],
+    [arrowhead=EArrowhead,color=EColor,label=ELabel,style=EStyle],
     EAttrs
   ).
 
@@ -154,7 +154,7 @@ graph_attributes(GAttrs, Options):-
   if_option(graph_colorscheme(Colorscheme), Options, true),
   % Label.
   if_option(graph_label(GLabel), Options, true),
-  
+
   merge_options(
     [colorscheme=Colorscheme,directedness=Directedness,label=GLabel],
     GAttrs
@@ -186,7 +186,7 @@ graph_attributes(GAttrs, Options):-
 
 vertex_term(Vs, V, vertex(Id,V,VAttrs), Options):-
   nth0chk(Id, Vs, V),
-  
+
   % Color.
   if_option(vertex_color(ColorFunction), Options,
     call(ColorFunction, V, VColor)
@@ -207,7 +207,7 @@ vertex_term(Vs, V, vertex(Id,V,VAttrs), Options):-
   if_option(vertex_shape(ShapeFunction), Options,
     call(ShapeFunction, V, VShape)
   ),
-  
+
   merge_options(
     [
       color=VColor,
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;19&#34;&gt; 19: 正在比较变动前 20e1f21 和变动后 e2e9fc1 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 25b0cd3..2d2ed12 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -146,11 +146,8 @@ file_to_gv(FromFile, ToFile, Options):-
   (
     var(ToFile)
   -&amp;gt;
-    absolute_file_name(
-      data(export),
-      ToFile,
-      [access(write),file_type(ToFileType)]
-    )
+    user:prolog_file_type(ToExtension, ToFileType),
+    file_alternative(FromFile, _, _, ToExtension, ToFile)
   ;
     is_absolute_file_name(ToFile),
     % The given output file must match a certain file extension.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;20&#34;&gt; 20: 正在比较变动前 e2e9fc1 和变动后 4b72d15 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 2d2ed12..9eaf66b 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -28,20 +28,16 @@ and GraphViz output files or SVG DOM structures.
 @version 2011-2013/09, 2013/11-2014/01, 2014/05, 2014/07
 */
 
-:- use_module(library(memfile)).
 :- use_module(library(option)).
 :- use_module(library(process)).
 :- use_module(library(predicate_options)). % Declarations.
 
 :- use_module(generics(codes_ext)).
 :- use_module(generics(db_ext)).
-:- use_module(generics(error_ext)).
-:- use_module(generics(trees)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
 :- use_module(os(safe_file)).
 :- use_module(svg(svg_file)).
-:- use_module(ugraph(ugraph_export)).
 
 :- use_module(plGraphViz(gv_dot)).
 
diff --git a/gv_gif.pl b/gv_gif.pl
index e3a6933..48ecd2f 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -27,7 +27,7 @@ Support for creating GIF representations.
 
 :- use_module(generics(list_ext)).
 :- use_module(generics(option_ext)).
-:- use_module(graph_theory(graph_generic)).
+:- use_module(graph_theory(graph_theory)).
 
 :- use_module(plRdf(rdf_name)). % Meta-DCG.
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;21&#34;&gt; 21: 正在比较变动前 4b72d15 和变动后 54248f7 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_gif.pl b/gv_gif.pl
index 48ecd2f..2fad4c4 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -105,7 +105,7 @@ create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
 %   * =|edge_style(+atom)|=
 
 edge_term(Vs, E, edge(FromId,ToId,EAttrs), Options):-
-  edge_components(E, FromV, ToV),
+  edge(E, FromV, ToV),
   nth0chk(FromId, Vs, FromV),
   nth0chk(ToId, Vs, ToV),
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;22&#34;&gt; 22: 正在比较变动前 54248f7 和变动后 3b9a773 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_gif.pl b/gv_gif.pl
index 2fad4c4..48ecd2f 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -105,7 +105,7 @@ create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
 %   * =|edge_style(+atom)|=
 
 edge_term(Vs, E, edge(FromId,ToId,EAttrs), Options):-
-  edge(E, FromV, ToV),
+  edge_components(E, FromV, ToV),
   nth0chk(FromId, Vs, FromV),
   nth0chk(ToId, Vs, ToV),
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;23&#34;&gt; 23: 正在比较变动前 3b9a773 和变动后 1e9a910 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_gif.pl b/gv_gif.pl
index 48ecd2f..d59e5f8 100644
--- a/gv_gif.pl
+++ b/gv_gif.pl
@@ -65,7 +65,7 @@ Support for creating GIF representations.
 %! create_gif(+Edges:ordset, -Gif:compound, +Options:list(nvpair)) is det.
 
 create_gif(Es, Gif, Options):-
-  edges_to_vertices(Es, Vs),
+  graph_theory:edges_to_vertices(Es, Vs),
   create_gif(Vs, Es, Gif, Options).
 
 %! create_gif(
@@ -105,7 +105,7 @@ create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
 %   * =|edge_style(+atom)|=
 
 edge_term(Vs, E, edge(FromId,ToId,EAttrs), Options):-
-  edge_components(E, FromV, ToV),
+  graph_theory:edge_components(E, FromV, ToV),
   nth0chk(FromId, Vs, FromV),
   nth0chk(ToId, Vs, ToV),
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;24&#34;&gt; 24: 正在比较变动前 1e9a910 和变动后 6dc1cf5 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index b25c15b..bd24270 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1 +1,3 @@
 *~
+*#
+*.db
diff --git a/.gitmodules b/.gitmodules
deleted file mode 100644
index a63cbff..0000000
--- a/.gitmodules
+++ /dev/null
@@ -1,6 +0,0 @@
-[submodule &amp;quot;Prolog-Library-Collection&amp;quot;]
-	path = Prolog-Library-Collection
-	url = https://github.com/wouterbeek/Prolog-Library-Collection.git
-[submodule &amp;quot;plHtml&amp;quot;]
-	path = plHtml
-	url = https://github.com/wouterbeek/plHtml.git
diff --git a/LICENSE.txt b/LICENSE.txt
new file mode 100644
index 0000000..c7b7798
--- /dev/null
+++ b/LICENSE.txt
@@ -0,0 +1,21 @@
+The MIT License (MIT)
+
+Copyright (c) 2015 Wouter Beek
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the &amp;quot;Software&amp;quot;), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED &amp;quot;AS IS&amp;quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
deleted file mode 160000
index 5b34b01..0000000
--- a/Prolog-Library-Collection
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 5b34b01ab0cc82a56e6fd90fc26e75da22f5a0fe
diff --git a/README.md b/README.md
new file mode 100644
index 0000000..23a45db
--- /dev/null
+++ b/README.md
@@ -0,0 +1,151 @@
+plGraphViz
+==========
+
+This library allows you to easily export graphs represented as Prolog terms
+using [GraphViz](http://www.graphviz.org/), an advanced graph drawing library.
+The Prolog terms have the following form:
+
+~~~prolog
+graph(Vertices, Edges, GraphAttrs)
+~~~
+
+`Vertices` and `Edges` are lists of compound terms of the following form:
+
+~~~prolog
+vertex(Id, VertexAttrs)
+edge(FromId, ToId, EdgeAttrs)
+~~~
+
+`Id` identifies a vertex and may or may not occur in any of the edges
+(i.e., unconnected vertices are allowed).
+`FromId` and `ToId` may occur in the list of vertices,
+in order to draw an edge between vertices with set attributes.
+
+Attributes have the form `Name=Value`.
+`GraphAttrs` are attributes of the graph.
+`VertexAttrs` are attributes of the vertex.
+`EdgeAttrs` are attributes of the edge.
+
+Attribute values are given as Prolog terms as well,
+and are type-checked before exporting.
+Many of the GraphViz attributes are supported.
+New ones are added on an as-needed bases
+(open an issue on Github if you want to see a specific feature added!).
+HTML-like labels are supported, allowing complex tables to be shown
+inside vertices.
+
+---
+
+### Installation
+
+~~~shell
+$ git clone https://github.com/wouterbeek/plGraphViz.git
+$ cd plGraphViz
+$ git submodule update --init
+~~~
+
+### Example
+
+~~~prolog
+$ swipl run.pl
+?- export_graph_to_gv_file(
+     graph([vertex(1,[]),vertex(2,[])],[edge(1,2,[])],[]),
+     File,
+     [method(sfdp),output(png)]
+   ).
+   File = &#39;PATH/plGraphViz/data/tmp.png&#39;
+~~~
+
+![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example1.png &amp;quot;Example graph.&amp;quot;)
+
+The graphic can be saved to a different file by instantiating
+the `File` argument.
+
+---
+
+### &#39;Method&#39; option
+
+Option `method(+atom)` sets the drawing method that is used by GraphViz
+ to place the vertices and edges.
+The following values are supported.
+
+| **Value**       | **Description**         |
+| `circo`         | Circular layout.        |
+| `dot` (default) | Directed graph.         |
+| `fdp`           | Undirected graph.       |
+| `neato`         | Undirected graph.       |
+| `osage`         | Tree map.               |
+| `sfdp`          | Large undirected graph. |
+| `twopi`         | Radical layouts.        |
+
+---
+
+### &#39;Output&#39; option
+
+Option `output(+atom)` sets the type of file the graph is written to.
+The following values are supported.
+
+| **Value**             | **Description**                       |
+|:---------------------:|:--------------------------------------|
+| `bmp`                 | Windows Bitmap Format                 |
+| `canon`               |                                       |
+| `dot`                 |                                       |
+| `gv`,  `xdot`, `xdot1.2`, `xdot1.4` | DOT                     |
+| `cgimage`             | CGImage bitmap format                 |
+| `cmap`                | Client-side imagemap (deprecated)     |
+| `eps`                 | Encapsulated PostScript               |
+| `exr`                 | OpenEXR                               |
+| `fig`                 |                                       |
+| `gd`, `gd2`           | GD/GD2 formats                        |
+| `gif`                 |                                       |
+| `gtk`                 | GTK canvas                            |
+| `ico`                 | Icon Image File Format                |
+| `imap`                |                                       |
+| `cmapx`               | Server-side and client-side imagemaps |
+| `imap_np`, `cmapx_np` | Server-side and client-side imagemaps |
+| `ismap`               | Server-side imagemap (deprecated)     |
+| `jp2`                 | JPEG 2000                             |
+| `jpg`, `jpeg`, `jpe`  | JPEG                                  |
+| `pct`, `pict`         | PICT                                  |
+| `pdf` (default)       | Portable Document Format (PDF)        |
+| `pic`                 | Kernighan&#39;s PIC graphics language     |
+| `plain`, `plain-ext`  | Simple text format                    |
+| `png`                 | Portable Network Graphics format      |
+| `pov`                 | POV-Ray markup language (prototype)   |
+| `ps`                  | PostScript                            |
+| `ps2`                 | PostScript for PDF                    |
+| `psd`                 | PSD                                   |
+| `sgi`                 | SGI                                   |
+| `svg`, `svgz`         | Scalable Vector Graphics              |
+| `tga`                 | Truevision TGA                        |
+| `tif`, `tiff`         | TIFF (Tag Image File Format)          |
+| `tk`                  | TK graphics                           |
+| `vml`, `vmlz`         | Vector Markup Language (VML)          |
+| `vrml`                | VRML                                  |
+| `wbmp`                | Wireless BitMap format                |
+| `webp`                | Image format for the Web              |
+| `xlib`, `x11`         | Xlib canvas                           |
+
+---
+
+### HTML-like labels
+
+Example of using HTML-like labels:
+
+~~~prolog
+export_graph_to_gv_file(
+  graph(
+    [vertex(1,[]),vertex(2,[label=html(table([tr([td(a),td(b)]),tr([td(c),td(d)])]))])],
+    [edge(1,2,[label=&#39;From 1 to 2.&#39;])],
+    []
+  ),
+  File,
+  []
+).
+~~~
+
+![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example2.png &amp;quot;Example graph with HTML-like labels.&amp;quot;)
+
+---
+
+Developed during 2013-2014 by [Wouter Beek](http://www.wouterbeek.com).
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
new file mode 100644
index 0000000..bcc7654
--- /dev/null
+++ b/data/gv_attrs_scrape.pl
@@ -0,0 +1,119 @@
+:- module(
+  gv_attrs_scrape,
+  [
+    gv_attrs_scrape/1 % +File
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz: Scrape attributes
+
+Writes compound terms of the following form to file:
+
+```prolog
+gv_attr(
+  ?Name,
+  ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
+  ?Types:list(atom),
+  ?Default,
+  ?Minimum,
+  ?Notes
+) is nondet.
+```
+
+@author Wouter Beek
+@version 2015/10, 2016/07
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(debug)).
+:- use_module(library(gv/gv_attr_type)).
+:- use_module(library(http/http_download)).
+:- use_module(library(lists)).
+:- use_module(library(os/io)).
+:- use_module(library(pl_term)).
+:- use_module(library(print_ext)).
+:- use_module(library(xpath)).
+:- use_module(library(xpath/xpath_table)).
+:- use_module(library(yall)).
+
+
+
+
+
+%! gv_attrs_scrape(+File) is det.
+
+gv_attrs_scrape(File):-
+  debug(gv, &amp;quot;Updating the GraphViz attributes table.&amp;quot;, []),
+  call_to_stream(File, [In,Meta,Meta]&amp;gt;&amp;gt;gv_attrs_download(In)).
+
+
+gv_attrs_download(Write):-
+  gv_attrs_iri(Iri),
+  html_download(Iri, Dom),
+  xpath_chk(Dom, //table(@align=lower_case(center)), TableDom),
+  xpath_table(TableDom, _, Rows),
+  maplist(write_attr_row(Write), Rows).
+
+
+write_attr_row(Write, [Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
+  atom_phrase(translate_usedby(UsedBy2), UsedBy1),
+  once(atom_phrase(translate_type(Types2), Types1)),
+  sort(UsedBy2, UsedBy3),
+  translate_default(Default1, Default2),
+  with_output_to(
+    Write,
+    write_fact(gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes))
+  ).
+
+gv_attrs_iri(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
+
+
+
+
+
+% HELPERS %
+
+%! translate_default(+Default1, -Default2) is det.
+
+% The empty string is represented by the empty atom.
+translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
+% The absence of a default value is represented by an uninstantiated variable.
+translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
+translate_default(Default, Default).
+
+
+
+%! translate_type(-Types:list(atom))// is det.
+
+translate_type([H|T]) --&amp;gt;
+  gv_attr_type(H),
+  whites,
+  translate_type(T).
+translate_type([H]) --&amp;gt;
+  gv_attr_type(H).
+translate_type([]) --&amp;gt; &amp;quot;&amp;quot;.
+
+
+
+%! translated_usedby(
+%!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
+%! )// is det.
+
+translate_usedby([cluster|T]) --&amp;gt;
+  &amp;quot;C&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([edge|T]) --&amp;gt;
+  &amp;quot;E&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([graph|T]) --&amp;gt;
+  &amp;quot;G&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([node|T]) --&amp;gt;
+  &amp;quot;N&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([subgraph|T]) --&amp;gt;
+  &amp;quot;S&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([]) --&amp;gt;
+  &amp;quot;&amp;quot;.
diff --git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
new file mode 100644
index 0000000..102a02a
--- /dev/null
+++ b/data/gv_color_scrape.pl
@@ -0,0 +1,52 @@
+:- module(
+  gv_color_scrape,
+  [
+    gv_color_scrape/1 % +File
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz: Scrape colors
+
+@author Wouter Beek
+@version 2015/10, 2016/07
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(debug)).
+:- use_module(library(http/http_download)).
+:- use_module(library(lists)).
+:- use_module(library(os/io)).
+:- use_module(library(pl_term)).
+:- use_module(library(print_ext)).
+:- use_module(library(xpath)).
+:- use_module(library(xpath/xpath_table)).
+:- use_module(library(yall)).
+
+
+
+
+
+%! gv_color_scrape(+File) is det.
+
+gv_color_scrape(File):-
+  debug(io, &amp;quot;Updating the GraphViz color table.&amp;quot;, []),
+  call_to_stream(File, [In,Meta,Meta]&amp;gt;&amp;gt;gv_color_download(In)).
+
+
+gv_color_download(Write):-
+  gv_color_iri(Iri),
+  html_download(Iri, Dom),
+  xpath_chk(Dom, //table(1), TableDom1),
+  xpath_chk(Dom, //table(2), TableDom2),
+  maplist(write_color_table(Write), [x11,svg], [TableDom1,TableDom2]).
+
+
+write_color_table(Write, Colorscheme, TableDom):-
+  xpath_table(TableDom, _, Rows),
+  append(Rows, Cells),
+  forall(
+    member(Cell, Cells),
+    with_output_to(Write, write_fact(gv_color(Colorscheme, Cell)))
+  ).
+
+gv_color_iri(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
diff --git a/example1.png b/example1.png
new file mode 100644
index 0000000..31e7ba6
Binary files /dev/null and b/example1.png differ
diff --git a/example2.png b/example2.png
new file mode 100644
index 0000000..6e44b16
Binary files /dev/null and b/example2.png differ
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
deleted file mode 100644
index 7a64c82..0000000
--- a/gv_attr_type.pl
+++ /dev/null
@@ -1,417 +0,0 @@
-:- module(
-  gv_attr_type,
-  [
-    gv_attr_type/1, % ?Type:atom
-    addDouble//1, % +Double:float
-    addPoint//1, % +Point:compound
-    arrowType//1, % +ArrowType:atom
-    bool//1, % +Boolean:boolean
-    clusterMode//1, % +ClusterMode:atom
-    dirType//1, % +DirectionType:oneof([back,both,forward,none])
-    double//1, % +Double:float
-    doubleList//1, % +Doubles:list(float)
-    escString//1,
-    %layerList//1,
-    %layerRange//1,
-    lblString//1,
-    int//1, % +Integer:integer
-    outputMode//1, % +OutputMode:atom
-    %packMode//1,
-    pagedir//1, % +Pagedir:atom
-    point//1, % +Point:compound
-    pointList//1, % +Points:list(compound)
-    %portPos//1,
-    quadType//1, % +QuadType:atom
-    rankType//1, % +RankType:atom
-    rankdir//1, % +RankDirection:atom
-    rect//1, % +Rectangle:compound
-    shape//1,
-    smoothType//1, % +SmoothType:atom
-    %splineType//1,
-    %startType//1,
-    string//1, % ?Content:atom
-    style//2 % +Context:oneof([cluster,edge,node])
-             % +Style:atom
-    %viewPort//1
-  ]
-).
-:- reexport(
-  plGraphViz(gv_color),
-  [
-    color//1, % +Color:compound
-    colorList//1 % +ColorList:list(compound)
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz attribute types
-
-@author Wouter Beek
-@version 2014/06
-*/
-
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_cardinal)).
-:- use_module(dcg(dcg_content)).
-
-:- use_module(plGraphViz(gv_html)).
-
-
-
-%! gv_attr_type(?Type:atom) is nondet.
-
-gv_attr_type(addDouble).
-gv_attr_type(addPoint).
-gv_attr_type(arrowType).
-gv_attr_type(bool).
-gv_attr_type(color).
-gv_attr_type(colorList).
-gv_attr_type(clusterMode).
-gv_attr_type(dirType).
-gv_attr_type(double).
-gv_attr_type(doubleList).
-gv_attr_type(escString).
-gv_attr_type(layerList).
-gv_attr_type(layerRange).
-gv_attr_type(lblString).
-gv_attr_type(int).
-gv_attr_type(outputMode).
-gv_attr_type(packMode).
-gv_attr_type(pagedir).
-gv_attr_type(point).
-gv_attr_type(pointList).
-gv_attr_type(portPos).
-gv_attr_type(quadType).
-gv_attr_type(rankType).
-gv_attr_type(rankdir).
-gv_attr_type(rect).
-gv_attr_type(shape).
-gv_attr_type(smoothType).
-gv_attr_type(splineType).
-gv_attr_type(startType).
-gv_attr_type(string).
-gv_attr_type(style).
-gv_attr_type(viewPort).
-
-
-%! addDouble(+Float:float)// .
-% An *addDouble* is represented by a Prolog float.
-
-addDouble(Float) --&amp;gt;
-  &#39;?&#39;(`+`),
-  double(Float).
-
-
-%! addPoint(+Point:compound)// .
-% An *addPoint* is represented by a compound of the following form:
-% `point(X:float,Y:float,InputOnly:boolean)`.
-
-addPoint(Point) --&amp;gt;
-  &#39;?&#39;(`+`),
-  point(Point).
-
-
-%! arrowType(+ArrowType:atom)// .
-
-arrowType(V) --&amp;gt;
-  {arrowType(V)},
-  atom(V).
-
-arrowType(V):-
-  primitive_shape(V).
-arrowType(V):-
-  derived(V).
-arrowType(V):-
-  backwards_compatible(V).
-
-primitive_shape(box).
-primitive_shape(crow).
-primitive_shape(circle).
-primitive_shape(diamond).
-primitive_shape(dot).
-primitive_shape(inv).
-primitive_shape(none).
-primitive_shape(normal).
-primitive_shape(tee).
-primitive_shape(vee).
-
-derived(odot).
-derived(invdot).
-derived(invodot).
-derived(obox).
-derived(odiamond).
-
-backwards_compatible(ediamond).
-backwards_compatible(empty).
-backwards_compatible(halfopen).
-backwards_compatible(invempty).
-backwards_compatible(open).
-
-
-bool(false) --&amp;gt; `false`.
-bool(false) --&amp;gt; `no`.
-bool(true) --&amp;gt; `true`.
-bool(true) --&amp;gt; `yes`.
-
-
-%! clusterMode(+ClusterMode:atom)// .
-
-clusterMode(V) --&amp;gt;
-  {clusterMode(V)},
-  atom(V).
-
-clusterMode(global).
-clusterMode(local).
-clusterMode(none).
-
-
-%! dirType(+DirectionType:oneof([back,both,forward,none]))// .
-
-dirType(DirType) --&amp;gt;
-  {dirType(DirType)},
-  atom(DirType).
-
-dirType(back).
-dirType(both).
-dirType(forward).
-dirType(none).
-
-
-double(Double1) --&amp;gt;
-  % float//1 will check for float type.
-  {Double2 is Double1 * 1.0},
-  float(Double2).
-
-
-doubleList([H|T]) --&amp;gt;
-  double(H),
-  &#39;*&#39;(doubleList1, T).
-
-doubleList1(Float) --&amp;gt;
-  `:`,
-  double(Float).
-
-
-%! escString(+String:atom)// .
-% @tbd Support for context-dependent replacements.
-
-escString(String) --&amp;gt;
-  atom(String).
-
-
-% @tbd layerList
-
-
-% @tbd layerRange
-
-
-lblString(V) --&amp;gt;
-  escString(V).
-lblString(V) --&amp;gt;
-  gv_html_like_label(V).
-
-
-int(V) --&amp;gt;
-  integer(V).
-
-
-outputMode(V) --&amp;gt;
-  {outputMode(V)},
-  atom(V).
-
-outputMode(breadthfirst).
-outputMode(edgesfirst).
-outputMode(nodesfirst).
-
-
-% @tbd packMode
-
-
-pagedir(V) --&amp;gt;
-  {pagedir(V)},
-  atom(V).
-
-pagedir(&#39;BL&#39;).
-pagedir(&#39;BR&#39;).
-pagedir(&#39;LB&#39;).
-pagedir(&#39;LT&#39;).
-pagedir(&#39;RB&#39;).
-pagedir(&#39;RT&#39;).
-pagedir(&#39;TL&#39;).
-pagedir(&#39;TR&#39;).
-
-
-%! point(+Point:compound)// .
-% A *point* is represented by a compound of the following form:
-% `point(X:float,Y:float,InputOnly:boolean)`.
-
-point(point(X,Y,InputOnly)) --&amp;gt;
-  float(X),
-  `,`,
-  float(Y),
-  input_only(InputOnly).
-
-input_only(false) --&amp;gt; [].
-input_only(true) --&amp;gt; `!`.
-
-
-pointList(Points) --&amp;gt;
-  &#39;*&#39;(point, Points).
-
-
-% @tbd portPos
-
-
-quadType(V) --&amp;gt;
-  {quadType(V)},
-  atom(V).
-
-quadType(fast).
-quadType(none).
-quadType(normal).
-
-
-rankType(V) --&amp;gt;
-  {rankType(V)},
-  atom(V).
-
-rankType(max).
-rankType(min).
-rankType(same).
-rankType(sink).
-rankType(source).
-
-
-rankdir(V) --&amp;gt;
-  {rankdir(V)},
-  atom(V).
-
-rankdir(&#39;BT&#39;).
-rankdir(&#39;LR&#39;).
-rankdir(&#39;RL&#39;).
-rankdir(&#39;TB&#39;).
-
-
-rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), `,`,
-  float(LowerLeftY), `,`,
-  float(UpperRightX), `,`,
-  float(UpperRightY).
-
-
-shape(V) --&amp;gt;
-  {polygon_based_shape(V)},
-  atom(V).
-
-polygon_based_shape(assembly).
-polygon_based_shape(box).
-polygon_based_shape(box3d).
-polygon_based_shape(cds).
-polygon_based_shape(circle).
-polygon_based_shape(component).
-polygon_based_shape(diamond).
-polygon_based_shape(doublecircle).
-polygon_based_shape(doubleoctagon).
-polygon_based_shape(egg).
-polygon_based_shape(ellipse).
-polygon_based_shape(fivepoverhang).
-polygon_based_shape(folder).
-polygon_based_shape(hexagon).
-polygon_based_shape(house).
-polygon_based_shape(insulator).
-polygon_based_shape(invhouse).
-polygon_based_shape(invtrapezium).
-polygon_based_shape(invtriangle).
-polygon_based_shape(larrow).
-polygon_based_shape(lpromoter).
-polygon_based_shape(&#39;Mcircle&#39;).
-polygon_based_shape(&#39;Mdiamond&#39;).
-polygon_based_shape(&#39;Msquare&#39;).
-polygon_based_shape(none).
-polygon_based_shape(note).
-polygon_based_shape(noverhang).
-polygon_based_shape(octagon).
-polygon_based_shape(oval).
-polygon_based_shape(parallelogram).
-polygon_based_shape(pentagon).
-polygon_based_shape(plaintext).
-polygon_based_shape(point).
-polygon_based_shape(polygon).
-polygon_based_shape(primersite).
-polygon_based_shape(promoter).
-polygon_based_shape(proteasesite).
-polygon_based_shape(proteinstab).
-polygon_based_shape(rarrow).
-polygon_based_shape(rect).
-polygon_based_shape(rectangle).
-polygon_based_shape(restrictionsite).
-polygon_based_shape(ribosite).
-polygon_based_shape(rnastab).
-polygon_based_shape(rpromoter).
-polygon_based_shape(septagon).
-polygon_based_shape(signature).
-polygon_based_shape(square).
-polygon_based_shape(tab).
-polygon_based_shape(terminator).
-polygon_based_shape(threepoverhang).
-polygon_based_shape(trapezium).
-polygon_based_shape(triangle).
-polygon_based_shape(tripleoctagon).
-polygon_based_shape(utr).
-
-
-smoothType(V) --&amp;gt;
-  {smoothType(V)},
-  atom(V).
-
-smoothType(avg_dist).
-smoothType(graph_dist).
-smoothType(none).
-smoothType(power_dist).
-smoothType(rng).
-smoothType(spring).
-smoothType(triangle).
-
-
-% @tbd splineType
-
-
-% @tbd startType
-
-
-%! string(?Content:atom)// .
-% A GraphViz string.
-
-string(Content) --&amp;gt;
-  atom(Content).
-
-
-%! style(?Context:oneof([cluster,edge,node]), ?Style:atom) is nondet.
-
-style(Context, Style) --&amp;gt;
-  {style(Context, Style)},
-  atom(Style).
-
-style(cluster, bold).
-style(cluster, dashed).
-style(cluster, dotted).
-style(cluster, filled).
-style(cluster, rounded).
-style(cluster, solid).
-style(cluster, striped).
-style(edge, bold).
-style(edge, dashed).
-style(edge, dotted).
-style(edge, solid).
-style(node, bold).
-style(node, dashed).
-style(node, diagonals).
-style(node, dotted).
-style(node, filled).
-style(node, rounded).
-style(node, solid).
-style(node, striped).
-style(node, wedged).
-
-
-% @tbd viewPort
-
diff --git a/gv_attrs.pl b/gv_attrs.pl
deleted file mode 100644
index dd0145a..0000000
--- a/gv_attrs.pl
+++ /dev/null
@@ -1,184 +0,0 @@
-:- module(
-  gv_attrs,
-  [
-    gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
-              % +Attr1:nvpair
-              % +Attr2:nvpair
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz attributes v2
-
-@author Wouter Beek
-@version 2014/06
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(persistency)).
-:- use_module(library(xpath)).
-
-:- use_module(dcg(dcg_content)).
-:- use_module(dcg(dcg_generic)).
-:- use_module(generics(db_ext)).
-:- use_module(os(file_ext)).
-
-:- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
-
-:- use_module(plGraphViz(gv_attr_type)). % DCGs implementing attribute types.
-
-:- db_add_novel(user:prolog_file_type(log, logging)).
-
-%! gv_attr(
-%!   ?Name:atom,
-%!   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
-%!   ?Types:list(atom),
-%!   ?Default,
-%!   ?Minimum,
-%!   ?Notes:atom
-%! ) is nondet.
-
-:- persistent(
-  gv_attr(
-    name:atom,
-    used_by:list(oneof([cluster,edge,graph,node,subgraph])),
-    types:list(atom),
-    default,
-    minimum,
-    notes:atom
-  )
-).
-
-:- initialization(gv_attrs_init).
-
-
-
-gv_attr(Context, N=V, N=V):-
-  var(V), !,
-  gv_attr(N, UsedBy, _, V, _, _),
-  memberchk(Context, UsedBy).
-gv_attr(Context, N=V1, N=V2):-
-  gv_attr(N, UsedBy, Types, _, Minimum, _),
-  memberchk(Context, UsedBy),
-  member(Type, Types),
-  (
-    Type == style
-  -&amp;gt;
-    Dcg =.. [Type,Context,V1]
-  ;
-    Dcg =.. [Type,V1]
-  ),
-  once(dcg_phrase(Dcg, V2)),
-  check_minimum(V1, Minimum).
-
-check_minimum(_, &#39;&#39;):- !.
-check_minimum(V, Min1):-
-  atom_number(Min1, Min2),
-  Min2 =&amp;lt; V.
-
-
-
-% INITIALIZATION
-
-%! assert_gv_attr_row(+Row:list(atom)) is det.
-
-assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
-  dcg_phrase(translate_usedby(UsedBy2), UsedBy1),
-  once(dcg_phrase(translate_type(Types2), Types1)),
-  sort(UsedBy2, UsedBy3),
-  translate_default(Default1, Default2),
-  assert_gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes).
-
-
-%! gv_attrs_downloads is det.
-% Downloads the table describing GraphViz attributes from `graphviz.org`.
-
-gv_attrs_download:-
-  gv_attrs_url(Url),
-  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
-
-  xpath(Dom, //table(@align=center), TableDom),
-  % @tbd This does not work, since in `record_name(Element, Name)`,
-  %      `Element` is a signleton list whereas a compound term is expected.
-  %%%%xpath(Dom, /html/body/table, TableDom),
-
-  html_to_table(TableDom, _, Rows),
-  maplist(assert_gv_attr_row, Rows).
-
-
-%! gv_attrs_file(-File:atom) is det.
-
-gv_attrs_file(File):-
-  absolute_file_name(
-    data(gv_attrs),
-    File,
-    [access(write),file_type(logging)]
-  ).
-
-
-%! gv_attrs_init is det.
-
-gv_attrs_init:-
-  gv_attrs_file(File),
-  safe_db_attach(File),
-  file_age(File, Age),
-  gv_attrs_update(Age).
-
-
-%! gv_attrs_update(+Age:float) is det.
-
-% The persistent store is still fresh.
-gv_attrs_update(Age):-
-  once(gv_attr(_, _, _, _, _, _)),
-  Age &amp;lt; 8640000, !.
-% The persistent store has become stale, so refresh it.
-gv_attrs_update(_):-
-  retractall_gv_attr(_, _, _, _, _, _),
-  gv_attrs_download.
-
-
-%! gv_attrs_url(-Url:url) is det.
-
-gv_attrs_url(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
-
-
-%! safe_db_attach(+File:atom) is det.
-
-safe_db_attach(File):-
-  exists_file(File), !,
-  db_attach(File, []).
-safe_db_attach(File):-
-  touch_file(File),
-  safe_db_attach(File).
-
-
-%! translate_default(+Default1:atom, -Default2:atom) is det.
-
-% The empty string is represented by the empty atom.
-translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
-% The absence of a default value is represented by an uninstantiated variable.
-translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
-translate_default(Default, Default).
-
-
-%! translate_type(-Types:list(atom))// is det.
-
-translate_type([H|T]) --&amp;gt;
-  {gv_attr_type(H)},
-  atom(H),
-  whites,
-  translate_type(T).
-translate_type([]) --&amp;gt; !, [].
-
-
-%! translated_usedby(
-%!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
-%! )// is det.
-
-translate_usedby([cluster|T]) --&amp;gt; `C`, !, translate_usedby(T).
-translate_usedby([edge|T]) --&amp;gt; `E`, !, translate_usedby(T).
-translate_usedby([graph|T]) --&amp;gt; `G`, !, translate_usedby(T).
-translate_usedby([node|T]) --&amp;gt; `N`, !, translate_usedby(T).
-translate_usedby([subgraph|T]) --&amp;gt; `S`, !, translate_usedby(T).
-translate_usedby([]) --&amp;gt; [].
-
diff --git a/gv_color.pl b/gv_color.pl
deleted file mode 100644
index 19d6e05..0000000
--- a/gv_color.pl
+++ /dev/null
@@ -1,151 +0,0 @@
-:- module(
-  gv_color,
-  [
-    gv_color/2, % ?Colorscheme:oneof([svg,x11])
-                % ?Color:atom
-    color//1, % +Color:compound
-    colorList//1 % +Pairs:list(pair(compound,float))
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz color
-
-@author Wouter Beek
-@tbd Color value `transparent` is only available in the output formats
-     ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(lists)).
-:- use_module(library(persistency)).
-:- use_module(library(xpath)).
-
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_cardinal)).
-:- use_module(dcg(dcg_content)).
-:- use_module(generics(db_ext)).
-:- use_module(os(file_ext)).
-:- use_module(sparql(sparql_char)).
-
-:- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
-
-:- db_add_novel(user:prolog_file_type(log, logging)).
-
-%! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
-
-:- persistent(gv_color(colorscheme:oneof([svg,x11]),color:atom)).
-
-:- initialization(gv_color_init).
-
-
-
-% color(+Color:compound)// .
-% A *color* is represented by a compound term of one of the following forms:
-%   1. `rgb(Red:nonneg,Green:nonneg,Blue:nonneg)`
-%   2. `rgba(Red:nonneg,Green:nonneg,Blue:nonneg,Alpha:nonneg)`
-%   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
-
-color(rgb(Red,Green,Blue)) --&amp;gt; !,
-  `#`,
-  &#39;#&#39;(3, hex_color, [Red,Green,Blue]).
-color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
-  `#`,
-  &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha]).
-color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
-  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value]).
-color(Name) --&amp;gt;
-  {gv_color(_, Name)},
-  atom(Name).
-
-hex_color(I) --&amp;gt;
-  {W1 is I / 16},
-  &#39;HEX&#39;(W1),
-  {W2 is I mod 16},
-  &#39;HEX&#39;(W2).
-
-hsv_color(D, Head, Tail):-
-  format(codes(Head,Tail), &#39;~2f&#39;, [D]).
-
-
-%! colorList(+Pairs:list(pair(compound,float)))// .
-
-colorList(Pairs) --&amp;gt;
-  &#39;+&#39;(wc, Pairs).
-
-wc(Color-Float) --&amp;gt;
-  color(Color),
-  &#39;?&#39;(wc_weight(Float)).
-
-wc_weight(Float) --&amp;gt;
-  `;`,
-  float(Float).
-
-
-
-% INITIALIZATION
-
-%! gv_color_download is det.
-
-gv_color_download:-
-  gv_color_url(Url),
-  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
-  xpath(Dom, //table(1), TableDom1),
-  xpath(Dom, //table(2), TableDom2),
-  maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2]).
-
-assert_color_table(Colorscheme, TableDom):-
-  html_to_table(TableDom, _, Rows),
-  append(Rows, Cells),
-  forall(
-    member(Cell, Cells),
-    assert_gv_color(Colorscheme, Cell)
-  ).
-
-
-%! gv_color_file(-File:atom) is det.
-
-gv_color_file(File):-
-  absolute_file_name(
-    data(gv_color),
-    File,
-    [access(write),file_type(logging)]
-  ).
-
-
-%! gv_color_init is det.
-
-gv_color_init:-
-  gv_color_file(File),
-  safe_db_attach(File),
-  file_age(File, Age),
-  gv_color_update(Age).
-
-
-%! gv_color_update(+Age:float) is det.
-
-% The persistent store is still fresh.
-gv_color_update(Age):-
-  once(gv_color(_, _)),
-  Age &amp;lt; 8640000, !.
-% The persistent store has become stale, so refresh it.
-gv_color_update(_):-
-  retractall_gv_color(_, _),
-  gv_color_download.
-
-
-%! gv_color_url(-Url:url) is det.
-
-gv_color_url(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
-
-
-%! safe_db_attach(+File:atom) is det.
-
-safe_db_attach(File):-
-  exists_file(File), !,
-  db_attach(File, []).
-safe_db_attach(File):-
-  touch_file(File),
-  safe_db_attach(File).
-
diff --git a/gv_dot.pl b/gv_dot.pl
deleted file mode 100644
index 68443ba..0000000
--- a/gv_dot.pl
+++ /dev/null
@@ -1,496 +0,0 @@
-:- module(
-  gv_dot,
-  [
-    gv_graph//1 % +GraphTerm:compound
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz DOT generator
-
-DCG rules for GraphViz DOT file generation.
-
-Methods for writing to the GraphViz DOT format.
-
-In GraphViz vertices are called &#39;nodes&#39;.
-
-@author Wouter Beek
-@see http://www.graphviz.org/content/dot-language
-@version 2013/07, 2013/09, 2014/03-2014/06
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(lists)).
-:- use_module(library(ordsets)).
-
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_ascii)).
-:- use_module(dcg(dcg_content)).
-:- use_module(dcg(dcg_generic)).
-:- use_module(dcg(dcg_meta)).
-:- use_module(dcg(dcg_os)).
-
-:- use_module(plGraphViz(gv_attrs)).
-:- use_module(plGraphViz(gv_html)).
-:- use_module(plGraphViz(gv_numeral)).
-
-
-
-%! gv_attribute(+Attribute:nvpair)// is det.
-% A single GraphViz attribute.
-% We assume that the attribute has already been validated.
-
-gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), `=`, gv_id(Val), `;`.
-
-
-%! gv_attribute_list(
-%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +GraphAttributes:list(nvpair),
-%!   +Attributes:list(nvpair)
-%! )// .
-% ~~~{.abnf}
-% attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
-% a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
-% ~~~
-
-% Attributes occur between square brackets.
-gv_attribute_list(Context, _, Attrs1) --&amp;gt;
-  {maplist(gv_attr(Context), Attrs1, Attrs2)},
-  bracketed(square, &#39;*&#39;(gv_attribute, Attrs2)).
-
-
-%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
-% ~~~
-% compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
-% ~~~
-
-gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
-gv_compass_pt(c) --&amp;gt; `c`.
-gv_compass_pt(e) --&amp;gt; `e`.
-gv_compass_pt(n) --&amp;gt; `n`.
-gv_compass_pt(ne) --&amp;gt; `ne`.
-gv_compass_pt(nw) --&amp;gt; `nw`.
-gv_compass_pt(s) --&amp;gt; `s`.
-gv_compass_pt(se) --&amp;gt; `se`.
-gv_compass_pt(sw) --&amp;gt; `sw`.
-gv_compass_pt(w) --&amp;gt; `w`.
-
-
-%! gv_edge_operator(+Directedness:boolean)// .
-% The binary edge operator between two vertices.
-% The operator that is used depends on whether the graph is directed or
-% undirected.
-%
-% @arg Directedness Whether an edge is directed (operator `-&amp;gt;`) or
-%                   undirected (operator `--`).
-
-gv_edge_operator(false) --&amp;gt; !, `--`.
-gv_edge_operator(true) --&amp;gt; arrow(right, 2).
-
-
-%! gv_edge_statement(
-%!   +Indent:nonneg,
-%!   +Directedness:boolean,
-%!   +GraphAttributes:list(nvpair),
-%!   +EdgeTerm:compound
-%! )// is det.
-% A GraphViz statement describing an edge.
-%
-% @arg Indent The indentation level at which the edge statement is written.
-% @arg Directedness Whether the graph is directed or not.
-% @arg GraphAttributes The attributes of the graph. Some of these attributes
-%      may be used in the edge statement (e.g., the colorscheme).
-% @arg EdgeTerm A compound term in the GIFormat, representing an edge.
-%
-% @tbd Instead of gv_node_id//1 we could have a gv_subgraph//1
-%      at the from and/or to location.
-% @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
-
-gv_edge_statement(I, Directedness, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
-  indent(I),
-  gv_node_id(FromId), ` `,
-
-  gv_edge_operator(Directedness), ` `,
-
-  gv_node_id(ToId), ` `,
-
-  % We want `colorscheme/1` from the edges and
-  % `directionality/1` from the graph.
-  gv_attribute_list(edge, GAttrs, EAttrs),
-  newline.
-
-
-%! gv_generic_attributes_statement(
-%!   +Kind:oneof([edge,graph,node]),
-%!   +Indent:integer,
-%!   +GraphAttributes:list(nvpair),
-%!   +CategoryAttributes:list(nvpair)
-%! )//
-% A GraphViz statement describing generic attributes for a category of items.
-%
-% @arg Kind The category of items for to the attributes apply.
-%      Possible values: `edge`, `graph`, and `node`.
-% @arg Indent An integer indicating the number of tabs.
-% @arg GraphAttributes A list of name-value pairs.
-% @arg CategoryAttributes A list of name-value pairs.
-%
-% ~~~
-% attr_stmt = (graph / node / edge) attr_list
-% ~~~
-
-gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
-gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
-  indent(I),
-  gv_kind(Kind), ` `,
-  gv_attribute_list(Kind, GraphAttrs, KindAttrs), newline.
-
-
-%! gv_graph(+GraphTerm:compound)//
-% The follow graph attributes are supported,
-% beyond the GraphViz attributes for graphs:
-%   * `directedness(+boolean)`
-%      Whether the graph is directed (`true`) or undirected (`false`).
-%      Default: `false`.
-%   * `name(+GraphName:atom)`
-%   * `strict(+StrictGraph:boolean)`
-%      This forbids the creation of self-arcs and multi-edges;
-%      they are ignored in the input file.
-%      Only in combinattion with directionality `directed`.
-%
-% ~~~{.abnf}
-% graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
-% ~~~
-%
-% `GraphTerm` is a compound term of the following form:
-% ~~~{.pl}
-% graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
-% ~~~
-%
-% `RankedVertexTerms` is a list of compound terms of the following form:
-% ~~~{.pl}
-% rank(RankNode,ContentNodes)
-% ~~~
-%
-% @tbd Add support for subgraphs (arbitrary nesting).
-% @tbd Add support for escape strings:
-%      http://www.graphviz.org/doc/info/attrs.html#k:escString
-% @tbd Assert attributes that are generic with respect to a subgraph.
-% @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
-
-gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
-
-gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
-  {
-    shared_attributes(VTerms, SharedVAttrs, NewVTerms),
-    shared_attributes(ETerms, SharedEAttrs, NewETerms),
-    select_nvpair(strict=Strict, GAttrs1, GAttrs2, false),
-    select_nvpair(directedness=Directedness, GAttrs2, GAttrs3, true),
-    select_nvpair(name=GName, GAttrs3, GAttrs4, noname),
-    add_default_nvpair(GAttrs4, overlap, false, GAttrs5),
-    I = 0
-  },
-
-  % The first statement in the GraphViz output.
-  % States that this file represents a graph according to the GraphViz format.
-  indent(I),
-  gv_strict(Strict),
-  gv_graph_type(Directedness), ` `,
-  gv_id(GName), ` `,
-  bracketed(
-    curly,
-    gv_graph0(
-      I,
-      NewVTerms, SharedVAttrs, RankedVTerms,
-      NewETerms, SharedEAttrs,
-      Directedness, GAttrs5
-    )
-  ),                                                      
-  newline.
-
-gv_graph0(
-  I,
-  NewVTerms, SharedVAttrs, RankedVTerms,
-  NewETerms, SharedEAttrs,
-  Directedness, GAttrs
-) --&amp;gt;
-  newline,
-
-  % The following lines are indented.
-  {NewI is I + 1},
-
-  % Attributes that apply to the graph as a whole.
-  gv_generic_attributes_statement(graph, NewI, GAttrs, GAttrs),
-
-  % Attributes that are the same for all nodes.
-  gv_generic_attributes_statement(node, NewI, GAttrs, SharedVAttrs),
-
-  % Attributes that are the same for all edges.
-  gv_generic_attributes_statement(edge, NewI, GAttrs, SharedEAttrs),
-
-  % Only add a newline if some content was written in the previous three
-  % lines.
-  ({(GAttrs == [], SharedVAttrs == [], SharedEAttrs == [])} -&amp;gt; `` ; newline),
-
-  % The list of GraphViz nodes.
-  &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms),
-  ({NewVTerms == []} -&amp;gt; `` ; newline),
-
-  % The ranked GraphViz nodes (displayed at the same height).
-  &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms),
-  ({RankedVTerms == []} -&amp;gt; `` ; newline),
-
-  {
-    findall(
-      edge(FromId,ToId,[]),
-      (
-        nth0(Index1, RankedVTerms, rank(vertex(FromId,_,_),_)),
-        nth0(Index2, RankedVTerms, rank(vertex(ToId,_,_),_)),
-        % We assume that the rank vertices are nicely ordered.
-        succ(Index1, Index2)
-      ),
-      RankEdges
-    )
-  },
-
-  % The rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), RankEdges),
-
-  % The non-rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), NewETerms),
-
-  % Note that we do not include a newline here.
-
-  % We want to indent the closing curly brace.
-  indent(I).
-
-
-%! gv_graph_type(+Directedness:boolean)// .
-% The type of graph that is represented.
-
-gv_graph_type(false) --&amp;gt; `graph`.
-gv_graph_type(true) --&amp;gt; `digraph`.
-
-
-%! gv_id(?Atom:atom)// is det.
-% Parse a GraphViz identifier.
-% There are 4 variants:
-%   1. Any string of alphabetic (`[a-zA-Z&#39;200-&#39;377]`) characters,
-%      underscores (`_`) or digits (`[0-9]`), not beginning with a digit.
-%   2. A numeral `[-]?(.[0-9]+ | [0-9]+(.[0-9]*)? )`.
-%   3. Any double-quoted string (`&amp;quot;...&amp;quot;`) possibly containing
-%      escaped quotes (`\&amp;quot;`).
-%      In quoted strings in DOT, the only escaped character is
-%      double-quote (`&amp;quot;`). That is, in quoted strings, the dyad `\&amp;quot;`
-%      is converted to `&amp;quot;`. All other characters are left unchanged.
-%      In particular, `\\` remains `\\`.
-%      Layout engines may apply additional escape sequences.
-%   4. An HTML string (`&amp;lt;...&amp;gt;`).
-%
-% @tbd Add support for HTML-like labels:
-%      http://www.graphviz.org/doc/info/shapes.html#html
-%      This requires an XML grammar!
-
-% HTML strings (variant 4).
-gv_id(Atom) --&amp;gt;
-  dcg_atom_codes(gv_html_like_label, Atom), !.
-% Alpha-numeric strings (variant 1).
-gv_id(Atom) --&amp;gt;
-  {atom_codes(Atom, [H|T])},
-  gv_id_first(H),
-  gv_id_rest(T), !,
-  % Variant 1 identifiers should not be (case-variants of) a
-  % GraphViz keyword.
-  {\+ gv_keyword([H|T])}.
-% Numerals (variant 2)
-gv_id(N) --&amp;gt;
-  {number(N)}, !,
-  gv_numeral(N).
-% Double-quoted strings (variant 3).
-% The quotes are already part of the given atom.
-gv_id(Atom) --&amp;gt;
-  {
-    atom_codes(Atom, [H|T]),
-    append(S, [H], T)
-  },
-  dcg_between(double_quote(H), gv_quoted_string(S)), !.
-% Double-quoted strings (variant 3).
-% The quotes are not in the given atom. They are written anyway.
-gv_id(Atom) --&amp;gt;
-  quoted(double_quote, dcg_atom_codes(gv_quoted_string, Atom)), !.
-
-gv_id_first(X) --&amp;gt; ascii_letter(X).
-gv_id_first(X) --&amp;gt; underscore(X).
-
-gv_id_rest([]) --&amp;gt; [].
-gv_id_rest([H|T]) --&amp;gt;
-  (ascii_alpha_numeric(H) ; underscore(H)),
-  gv_id_rest(T).
-
-
-%! gv_keyword(+Codes:list(code)) is semidet.
-% Succeeds if the given codes for a GraphViz reserved keyword.
-
-gv_keyword(Codes):-
-  % Obviously, the keywords do not occur on the difference list input.
-  % So we must use phrase/[2,3].
-  phrase(gv_keyword, Codes).
-
-%! gv_keyword// .
-% GraphViz has reserved keywords that cannot be used as identifiers.
-% GraphViz keywords are case-insensitive.
-
-gv_keyword --&amp;gt; `digraph`.
-gv_keyword --&amp;gt; `edge`.
-gv_keyword --&amp;gt; `graph`.
-gv_keyword --&amp;gt; `node`.
-gv_keyword --&amp;gt; `strict`.
-gv_keyword --&amp;gt; `subgraph`.
-
-
-%! gv_kind(+Kind:oneof([edge,graph,node]))// .
-
-gv_kind(edge) --&amp;gt; `edge`.
-gv_kind(graph) --&amp;gt; `graph`.
-gv_kind(node) --&amp;gt; `node`.
-
-
-%! gv_node_id(+NodeId:atom)// .
-% GraphViz node identifiers can be of the following two types:
-%   1. A GraphViz identifier, see gv_id//1.
-%   2. A GraphViz identifier plus a GraphViz port indicator, see gv_port//0.
-%
-% @tbd Add support for GraphViz port indicators
-%      inside GraphViz node identifiers.
-
-gv_node_id(Id) --&amp;gt;
-  gv_id(Id).
-%gv_node_id(_) --&amp;gt;
-%  gv_id(_),
-%  gv_port.
-
-
-%! gv_node_statement(
-%!   +Indent:integer,
-%!   +GraphAttributes,
-%!   +VertexTerm:compound
-%! )// .
-% A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
-
-gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
-  indent(I),
-  gv_node_id(Id), ` `,
-  gv_attribute_list(node, GraphAttrs, VAttrs), newline.
-
-
-gv_port --&amp;gt;
-  gv_port_location,
-  &#39;?&#39;(gv_port_angle).
-gv_port --&amp;gt;
-  gv_port_angle,
-  &#39;?&#39;(gv_port_location).
-gv_port --&amp;gt;
-  `:`,
-  gv_compass_pt(_).
-
-gv_port_angle --&amp;gt;
-  `@`,
-  gv_id(_).
-
-gv_port_location --&amp;gt;
-  `:`,
-  gv_id(_).
-gv_port_location --&amp;gt;
-  `:`,
-  bracketed(
-    round,
-    (
-      gv_id(_),
-      `,`,
-      gv_id(_)
-    )
-  ).
-
-
-gv_quoted_string([]) --&amp;gt; [].
-% Just to be sure, we do not allow the double quote
-% that closes the string to be escaped.
-gv_quoted_string([X]) --&amp;gt;
-  {X \== 92}, !,
-  [X].
-% A double quote is only allowed if it is escaped by a backslash.
-gv_quoted_string([92,34|T]) --&amp;gt; !,
-  gv_quoted_string(T).
-% Add the backslash escape character.
-gv_quoted_string([34|T]) --&amp;gt; !,
-  `\\\&amp;quot;`,
-  gv_quoted_string(T).
-% All other characters are allowed without escaping.
-gv_quoted_string([H|T]) --&amp;gt;
-  [H],
-  gv_quoted_string(T).
-
-
-gv_ranked_node_collection(
-  I,
-  GraphAttrs,
-  rank(Rank_V_Term,Content_V_Terms)
-) --&amp;gt;
-  indent(I),
-  bracketed(curly, (
-    newline,
-
-    % The rank attribute.
-    {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), `;`, newline,
-
-    &#39;*&#39;(gv_node_statement(NewI, GraphAttrs), [Rank_V_Term|Content_V_Terms]),
-
-    % We want to indent the closing curly brace.
-    indent(I)
-  )),
-  newline.
-
-
-%! gv_strict(+Strict:boolean)// is det.
-% The keyword denoting that the graph is strict, i.e., has no self-arcs and
-% no multi-edges.
-% This only applies to directed graphs.
-
-gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; `strict `.
-
-
-
-% Helpers
-
-add_default_nvpair(Attrs1, N, Default, Attrs2):-
-  add_default_nvpair(Attrs1, N, Default, _, Attrs2).
-
-add_default_nvpair(Attrs, N, _, V, Attrs):-
-  memberchk(N=V, Attrs), !.
-add_default_nvpair(Attrs1, N, Default, Default, Attrs2):-
-  ord_add_element(Attrs1, N=Default, Attrs2).
-
-select_nvpair(N=V, Attrs1, Attrs2, _):-
-  memberchk(N=V, Attrs1), !,
-  select(N=V, Attrs1, Attrs2).
-select_nvpair(_=Default, Attrs, Attrs, Default).
-
-
-extract_shared([], []):- !.
-extract_shared(Argss, Shared):-
-  ord_intersection(Argss, Shared).
-
-remove_shared_attributes(Shared, Args1, Args2):-
-  ord_subtract(Args1, Shared, Args2).
-
-shared_attributes(Terms1, Shared, Terms2):-
-  maplist(term_components(Func), Terms1, Args1, Args2, Args3a),
-  extract_shared(Args3a, Shared),
-  maplist(remove_shared_attributes(Shared), Args3a, Args3b),
-  maplist(term_components(Func), Terms2, Args1, Args2, Args3b).
-
-term_components(Func, Term, Arg1, Arg2, Arg3):-
-  Term =.. [Func,Arg1,Arg2,Arg3].
-
diff --git a/gv_file.pl b/gv_file.pl
deleted file mode 100644
index 9eaf66b..0000000
--- a/gv_file.pl
+++ /dev/null
@@ -1,206 +0,0 @@
-:- module(
-  gv_file,
-  [
-    file_to_gv/2, % +File:atom
-                  % +Options:list(nvpair)
-    file_to_gv/3, % +FromFile:atom
-                  % ?ToFile:atom
-                  % +Options:list(nvpair)
-    gif_to_gv_file/3, % +GraphInterchangeFormat:compound
-                      % +ToFile:atom
-                      % +Options:list(nvpair)
-    gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
-                      % -SvgDom:list(compound)
-                      % +Options:list(nvpair)
-    open_dot/1 % +File:file
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz file
-
-Predicates for converting GIF-formatted terms
-into GraphViz output files or SVG DOM structures.
-
-Also converts between GraphViz DOT formatted files
-and GraphViz output files or SVG DOM structures.
-
-@author Wouter Beek
-@version 2011-2013/09, 2013/11-2014/01, 2014/05, 2014/07
-*/
-
-:- use_module(library(option)).
-:- use_module(library(process)).
-:- use_module(library(predicate_options)). % Declarations.
-
-:- use_module(generics(codes_ext)).
-:- use_module(generics(db_ext)).
-:- use_module(os(file_ext)).
-:- use_module(os(run_ext)).
-:- use_module(os(safe_file)).
-:- use_module(svg(svg_file)).
-
-:- use_module(plGraphViz(gv_dot)).
-
-:- dynamic(user:file_type_program/2).
-:- multifile(user:file_type_program/2).
-
-:- dynamic(user:module_uses/2).
-:- multifile(user:module_uses/2).
-
-:- dynamic(user:prolog_file_type/2).
-:- multifile(user:prolog_file_type/2).
-
-% Register DOT.
-:- db_add_novel(user:prolog_file_type(dot, dot)).
-:- db_add_novel(user:prolog_file_type(dot, graphviz)).
-:- db_add_novel(user:file_type_program(dot, dotty)).
-:- db_add_novel(user:file_type_program(dot, dotx)).
-:- db_add_novel(user:module_uses(gv_file, file_type(dot))).
-
-% Register JPG/JPEG.
-:- db_add_novel(user:prolog_file_type(jpeg, jpeg)).
-:- db_add_novel(user:prolog_file_type(jpeg, graphviz_output)).
-:- db_add_novel(user:prolog_file_type(jpg, jpeg)).
-:- db_add_novel(user:prolog_file_type(jpg, graphviz_output)).
-
-% Register PDF.
-:- db_add_novel(user:prolog_file_type(pdf, pdf)).
-:- db_add_novel(user:prolog_file_type(pdf, graphviz_output)).
-
-% Register PNG.
-:- db_add_novel(user:prolog_file_type(png, png)).
-:- db_add_novel(user:prolog_file_type(png, graphviz_output)).
-
-% Register SVG.
-:- db_add_novel(user:prolog_file_type(svg, graphviz_output)).
-:- db_add_novel(user:prolog_file_type(svg, svg)).
-
-% Register XDOT.
-:- db_add_novel(user:prolog_file_type(xdot, graphviz_output)).
-:- db_add_novel(user:prolog_file_type(xdot, xdot)).
-
-:- predicate_options(codes_to_gv_file/3, 3, [
-     pass_to(file_to_gv/3, 3)
-   ]).
-:- predicate_options(file_to_gv/2, 2, [
-     pass_to(file_to_gv/3, 3)
-   ]).
-:- predicate_options(file_to_gv/3, 3, [
-     method(+oneof([dot,sfdp])),
-     to_file_type(+oneof([dot,jpeg,pdf,svg,xdot]))
-   ]).
-:- predicate_options(gif_to_svg_dom/3, 3, [
-     pass_to(gif_to_gv_file/3, 3)
-   ]).
-:- predicate_options(gif_to_gv_file/3, 3, [
-     pass_to(codes_to_gv_file/3, 3)
-   ]).
-
-
-
-%! codes_to_gv_file(
-%!   +Codes:list(code),
-%!   +ToFile:atom,
-%!   +Options:list(nvpair)
-%! ) is det.
-
-codes_to_gv_file(Codes, ToFile, Options):-
-  access_file(ToFile, write),
-  absolute_file_name(data(tmp), TmpFile, [access(write),file_type(dot)]),
-  setup_call_cleanup(
-    open(TmpFile, write, Write, [encoding(utf8)]),
-    put_codes(Write, Codes),
-    close(Write)
-  ),
-  file_to_gv(TmpFile, ToFile, Options),
-  delete_file(TmpFile).
-
-
-%! file_to_gv(+FromFile:atom, +Options:list(nvpair)) is det.
-
-file_to_gv(FromFile, Options):-
-  file_to_gv(FromFile, _, Options).
-
-%! file_to_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
-% Converts a GraphViz DOT file to an image file, using a specific
-% visualization method.
-
-file_to_gv(FromFile, ToFile, Options):-
-  option(to_file_type(dot), Options), !,
-  rename_file(FromFile, ToFile).
-file_to_gv(FromFile, ToFile, Options):-
-  % The method option.
-  option(method(Method), Options, dot),
-  must_be(oneof([dot,sfdp]), Method),
-
-  % The file type option.
-  option(to_file_type(ToFileType), Options, pdf),
-  prolog_file_type(ToExtension, ToFileType),
-  prolog_file_type(ToExtension, graphviz_output), !,
-
-  % The output file is either given or created.
-  (
-    var(ToFile)
-  -&amp;gt;
-    user:prolog_file_type(ToExtension, ToFileType),
-    file_alternative(FromFile, _, _, ToExtension, ToFile)
-  ;
-    is_absolute_file_name(ToFile),
-    % The given output file must match a certain file extension.
-    file_name_extension(_, ToExtension, ToFile)
-  ),
-  % Now that we have the output file we can prevent the
-  % file type / file extension translation predicates from bakctracking.
-  !,
-
-  % Run the GraphViz conversion command in the shell.
-  format(atom(OutputType), &#39;-T~w&#39;, [ToExtension]),
-  process_create(
-    path(Method),
-    [OutputType,FromFile,&#39;-o&#39;,ToFile],
-    [process(PID)]
-  ),
-  process_wait(PID, exit(ShellStatus)),
-  exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
-
-
-%! gif_to_gv_file(+Gif:compound, +ToFile:atom, +Options:list(nvpair)) is det.
-% Returns a file containing a GraphViz visualization of the given graph.
-%
-% The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
-%     The file type of the generated GraphViz file.
-%     Default: `pdf`.
-
-gif_to_gv_file(Gif, ToFile, Options):-
-  once(phrase(gv_graph(Gif), Codes)),
-  codes_to_gv_file(Codes, ToFile, Options).
-
-
-%! gif_to_svg_dom(
-%!   +GraphInterchangeFormat:compound,
-%!   -SvgDom:list(compound),
-%!   +Options:list(nvpair)
-%! ) is det.
-
-gif_to_svg_dom(Gif, SvgDom, Options1):-
-  % Make sure the file type of the output file is SvgDom.
-  merge_options([to_file_type=svg], Options1, Options2),
-  gif_to_gv_file(Gif, ToFile, Options2),
-  file_to_svg(ToFile, SvgDom),
-  safe_delete_file(ToFile).
-
-
-%! open_dot(+File:atom) is det.
-% Opens the given DOT file.
-%
-% @tbd Test support on Windows.
-% @tbd Test support on OS-X.
-
-open_dot(File):-
-  once(find_program_by_file_type(dot, Program)),
-  run_program(Program, [File]).
-
diff --git a/gv_gif.pl b/gv_gif.pl
deleted file mode 100644
index d59e5f8..0000000
--- a/gv_gif.pl
+++ /dev/null
@@ -1,221 +0,0 @@
-:- module(
-  gv_gif,
-  [
-    create_gif/3, % +Edges:ordset
-                  % -Gif:compound
-                  % +Options:list(nvpair)
-    create_gif/4 % +Vertices:ordset
-                 % +Edges:ordset
-                 % -Gif:compound
-                 % +Options:list(nvpair)
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz Graph Interchange Format (GIF)
-
-Support for creating GIF representations.
-
-@author Wouter Beek
-@version 2014/06-2014/07
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(lambda)).
-:- use_module(library(option)).
-:- use_module(library(ordsets)).
-:- use_module(library(predicate_options)). % Declarations.
-
-:- use_module(generics(list_ext)).
-:- use_module(generics(option_ext)).
-:- use_module(graph_theory(graph_theory)).
-
-:- use_module(plRdf(rdf_name)). % Meta-DCG.
-
-:- predicate_options(create_gif/3, 3, [
-     pass_to(create_gif/4, 4)
-   ]).
-:- predicate_options(create_gif/4, 4, [
-     pass_to(edge_term/3, 3),
-     pass_to(graph_attributes/2, 2),
-     pass_to(vertex_term/3, 3)
-   ]).
-:- predicate_options(edge_term/3, 3, [
-     edge_arrowhead(+atom),
-     edge_color(+atom),
-     edge_label(+atom),
-     edge_style(+atom)
-   ]).
-:- predicate_options(graph_attributes/2, 2, [
-     directedness(+boolean),
-     graph_colorscheme(+oneof([none,svg,x11])),
-     graph_label(+atom)
-   ]).
-
-:- predicate_options(vertex_term/3, 3, [
-     vertex_color(+atom),
-     vertex_coordinates(+atom),
-     vertex_image(+atom),
-     vertex_label(+atom),
-     vertex_peripheries(+atom),
-     vertex_shape(+atom)
-   ]).
-
-
-
-%! create_gif(+Edges:ordset, -Gif:compound, +Options:list(nvpair)) is det.
-
-create_gif(Es, Gif, Options):-
-  graph_theory:edges_to_vertices(Es, Vs),
-  create_gif(Vs, Es, Gif, Options).
-
-%! create_gif(
-%!   +Vertices:ordset,
-%!   +Edges:ordset,
-%!   -Gif:compound,
-%!   +Options:list(nvpair)
-%! ) is det.
-% The following options are supported:
-%   * =|graph_colorscheme(+oneof([none,svg,x11]))
-%     No default.
-%   * =|graph_label(+LabelFunction)|=
-%     The functions that assigns names to graphs.
-%     No default.
-
-create_gif(Vs, Es, graph(VTerms,ETerms,GAttrs), Options):-
-  % Vertex terms.
-  maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Options), Vs, VTerms),
-
-  % Edge terms.
-  maplist(\E^ETerm^edge_term(Vs, E, ETerm, Options), Es, ETerms),
-
-  % Graph attributes.
-  graph_attributes(GAttrs, Options).
-
-
-%! edge_term(
-%!   +Vertices:ordset,
-%!   +Edge:pair,
-%!   -EdgeTerm:compound,
-%!   +Options:list(nvpair)
-%! ) is det.
-% The following options are supported:
-%   * =|edge_arrowhead(+atom)|=
-%   * =|edge_color(+atom)|=
-%   * =|edge_label(+atom)|=
-%   * =|edge_style(+atom)|=
-
-edge_term(Vs, E, edge(FromId,ToId,EAttrs), Options):-
-  graph_theory:edge_components(E, FromV, ToV),
-  nth0chk(FromId, Vs, FromV),
-  nth0chk(ToId, Vs, ToV),
-
-  % Arrowhead
-  if_option(edge_arrowhead(ArrowheadFunction), Options,
-    call(ArrowheadFunction, E, EArrowhead)
-  ),
-  % Color.
-  if_option(edge_color(ColorFunction), Options,
-    call(ColorFunction, E, EColor)
-  ),
-  % Label.
-  if_option(edge_label(LabelFunction), Options,
-    call(LabelFunction, E, ELabel)
-  ),
-  % Style.
-  if_option(edge_style(StyleFunction), Options,
-    call(StyleFunction, E, EStyle)
-  ),
-
-  merge_options(
-    [arrowhead=EArrowhead,color=EColor,label=ELabel,style=EStyle],
-    EAttrs
-  ).
-
-
-%! graph_attributes(
-%!   -GraphAttributes:list(nvpair),
-%!   +Options:list(nvpair)
-%! ) is det.
-% The following options are supported:
-%   * =|directedness(+boolean)|=
-%     Whether the graph is directed (`true`) or undirected (`false`).
-%     Default: `false`.
-%   * =|graph_colorscheme(+oneof([none,svg,x11]))|=
-%     The colorscheme from which the color in this graph are taken.
-%     Default: `svg`.
-%   * =|graph_label(+atom)|=
-%     The graph label.
-%     No default.
-
-graph_attributes(GAttrs, Options):-
-  % Directedness.
-  option(directedness(Directedness), Options, false),
-  % Colorscheme.
-  if_option(graph_colorscheme(Colorscheme), Options, true),
-  % Label.
-  if_option(graph_label(GLabel), Options, true),
-
-  merge_options(
-    [colorscheme=Colorscheme,directedness=Directedness,label=GLabel],
-    GAttrs
-  ).
-
-
-%! vertex_term(
-%!   +Vertices:ordset,
-%!   +Vertex,
-%!   -VertexTerm:compound,
-%!   +Options:list(nvpair)
-%! ) is det.
-% The following options are supported:
-%   * =|vertex_color(+ColorFunction)|=
-%     A function that assigns colors to vertices.
-%     No default.
-%   * =|vertex_image(+ImageFunction)|=
-%     A function that assinges images to vertices.
-%     No default.
-%   * =|vertex_label(+LabelFunction)|=
-%     A function that assigns labels to vertices.
-%     No default.
-%   * =|vertex_peripheries(+PeripheriesFunction)|=
-%     A function that assinges peripheries to vertices.
-%     No default.
-%   * =|vertex_shape(+ShapeFunction)|=
-%     A function that assinges shapes to vertices.
-%     No default.
-
-vertex_term(Vs, V, vertex(Id,V,VAttrs), Options):-
-  nth0chk(Id, Vs, V),
-
-  % Color.
-  if_option(vertex_color(ColorFunction), Options,
-    call(ColorFunction, V, VColor)
-  ),
-  % Image.
-  if_option(image(ImageFunction), Options,
-    call(ImageFunction, V, VImage)
-  ),
-  % Label.
-  if_option(vertex_label(LabelFunction), Options,
-    call(LabelFunction, V, VLabel)
-  ),
-  % Peripheries.
-  if_option(vertex_peripheries(PeripheriesFunction), Options,
-    call(PeripheriesFunction, V, VPeripheries)
-  ),
-  % Shape.
-  if_option(vertex_shape(ShapeFunction), Options,
-    call(ShapeFunction, V, VShape)
-  ),
-
-  merge_options(
-    [
-      color=VColor,
-      image=VImage,
-      label=VLabel,
-      peripheries=VPeripheries,
-      shape=VShape
-    ],
-    VAttrs
-  ).
-
diff --git a/gv_html.pl b/gv_html.pl
deleted file mode 100644
index b8d3190..0000000
--- a/gv_html.pl
+++ /dev/null
@@ -1,60 +0,0 @@
-:- module(
-  gv_html,
-  [
-    gv_html_like_label//1 % +Codes:list(code)
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz HTML
-
-@author Wouter Beek
-@version 2013/07, 2013/09, 2014/03-2014/06
-*/
-
-:- use_module(dcg(dcg_content)).
-
-:- use_module(plHtml(html_dcg)).
-
-
-
-%! gv_html_label(+Codes:list(code))// .
-%
-% @see http://www.graphviz.org/doc/info/shapes.html#html
-
-gv_html_label --&amp;gt; gv_html_text, !.
-gv_html_label --&amp;gt; gv_html_table, !.
-gv_html_label --&amp;gt; [].
-
-gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
-
-gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
-
-gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
-gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
-
-gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row.
-
-gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
-
-gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
-gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
-
-gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
-gv_html_cells --&amp;gt; gv_html_cell.
-gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
-
-gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
-gv_html_text --&amp;gt; gv_html_textitem.
-
-gv_html_textitem --&amp;gt; html_string, !.
-gv_html_textitem --&amp;gt; html_entity, !.
-gv_html_textitem --&amp;gt; html_element(br, _), !.
-gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
-
diff --git a/gv_numeral.pl b/gv_numeral.pl
deleted file mode 100644
index 9b82fc0..0000000
--- a/gv_numeral.pl
+++ /dev/null
@@ -1,71 +0,0 @@
-:- module(
-  gv_numeral,
-  [
-    gv_numeral//1 % ?Value:number
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz numeral
-
-@author Wouter Beek
-@version 2014/05-2014/06
-*/
-
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_cardinal)).
-:- use_module(math(math_ext)).
-
-
-
-%! gv_numeral(?Value:number)// .
-% ~~~{.bnf}
-% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
-% ~~~
-
-gv_numeral(N) --&amp;gt;
-  {nonvar(N)},
-  {number_sign_parts(N, Sign, Abs)},
-  ({Sign =:= -1} -&amp;gt; `-` ; ``),
-  gv_numeral_abs(Abs).
-gv_numeral(N) --&amp;gt;
-  {var(N)},
-  &#39;sign?&#39;(Sign),
-  gv_numeral_abs(Abs),
-  {number_sign_parts(N, Sign, Abs)}.
-
-
-gv_numeral_abs(N) --&amp;gt;
-  {nonvar(N)},
-  {number_integer_parts(N, N1, N2)},
-  (
-    {N2 =:= 0}
-  -&amp;gt;
-    integer(N1)
-  ;
-    {N1 =:= 0}
-  -&amp;gt;
-    `.`,
-    integer(N2)
-  ;
-    integer(N1),
-    &#39;?&#39;((`.`, &#39;integer?&#39;(N2)))
-  ).
-gv_numeral_abs(N) --&amp;gt;
-  {var(N)},
-  (
-    `.`,
-    integer(N2)
-  -&amp;gt;
-    {N1 = 0}
-  ;
-    integer(N1),
-    (
-      `.`
-    -&amp;gt;
-      &#39;integer?&#39;(N2)
-    ;
-      {N2 = 0}
-    )
-  ),
-  {number_integer_parts(N, N1, N2)}.
-
diff --git a/gv_tree.pl b/gv_tree.pl
deleted file mode 100644
index afeb8f6..0000000
--- a/gv_tree.pl
+++ /dev/null
@@ -1,43 +0,0 @@
-:- module(
-  gv_tree,
-  [
-    tree_to_gv_file/3 % +Tree:compound
-                      % ?ToFile:atom
-                      % +Options:list(nvpair)
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz tree
-
-Export trees to GraphViz.
-
-@author Wouter Beek
-@version 2014/06-2014/07
-*/
-
-:- use_module(library(aggregate)).
-
-:- use_module(generics(trees)).
-
-:- use_module(plGraphViz(gv_file)).
-:- use_module(plGraphViz(gv_gif)).
-
-
-%! tree_to_gv_file(
-%!   +Tree:compound,
-%!   ?ToFile:atom,
-%!   +Options:list(nvpair)
-%! ) is det.
-% Stores the given tree term into a GraphViz file.
-%
-% Options are passed on to create_gif/3 and gif_to_gv_file/3.
-
-tree_to_gv_file(Tree, ToFile, Options):-
-  tree_to_gif(Tree, Gif, Options),
-  gif_to_gv_file(Gif, ToFile, Options).
-
-
-tree_to_gif(H-T, Gif, Options):-
-  tree_to_vertices_edges(Tree, Vs, Es),
-  create_gif(Vs, Es, Gif, Options).
-
diff --git a/index.pl b/index.pl
deleted file mode 100644
index 7461d13..0000000
--- a/index.pl
+++ /dev/null
@@ -1,2 +0,0 @@
-% Index of project plGraphViz (empty).
-
diff --git a/load.pl b/load.pl
deleted file mode 100644
index 4b117d1..0000000
--- a/load.pl
+++ /dev/null
@@ -1,12 +0,0 @@
-% Load file for plGraphViz.
-
-:- dynamic(user:prolog/3).
-:- multifile(user:prolog/3).
-   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
-
-:- use_module(load_project).
-:- load_project(plGraphViz, [
-    plc-&#39;Prolog-Library-Collection&#39;,
-    plHtml
-]).
-
diff --git a/load_project.pl b/load_project.pl
deleted file mode 100644
index 5599b5e..0000000
--- a/load_project.pl
+++ /dev/null
@@ -1,120 +0,0 @@
-:- module(
-  load_project,
-  [
-    load_project/2, % +Parent:atom
-                    % +ChildProjects:list(or([atom,pair(atom)]))
-    load_subproject/2, % +ParentFileSearchPath:atom
-                       % +Child:or([atom,pair(atom)])
-    set_data_subdirectory/1 % +ParentDirectory:atom
-  ]
-).
-
-/** &amp;lt;module&amp;gt; Load project
-
-Generic code for loading a project:
-  * Create a subdirectory for data.
-  * Load the root of subprojects onto the file search path.
-  * Load the index of subprojects onto the file search path.
-
-@author Wouter Beek
-@version 2014/06/14
-*/
-
-:- use_module(library(ansi_term)). % Colorized terminal messages.
-:- use_module(library(apply)).
-
-:- dynamic(user:project/2).
-:- multifile(user:project/2).
-:- dynamic(user:project/3).
-:- multifile(user:project/3).
-
-
-
-load_project(Parent, ChildProjects):-
-  parent_alias(Parent, ParentFsp),
-
-  % Entry point.
-  source_file(load_project(_,_), ThisFile),
-  file_directory_name(ThisFile, ThisDir),
-  assert(user:file_search_path(ParentFsp, ThisDir)),
-  assert(user:file_search_path(project, ThisDir)),
-
-  % Set the data subdirectory.
-  set_data_subdirectory(ThisDir),
-
-  % Load the root of submodules onto the file search path.
-  maplist(load_subproject(ParentFsp), ChildProjects),
-
-  % Load the index into the file search path.
-  load_project_index(ParentFsp).
-
-
-
-%! load_subproject(
-%!   +ParentFileSearchPath:atom,
-%!   +Child:or([atom,pair(atom)])
-%! ) is det.
-
-load_subproject(ParentFsp, ChildFsp-ChildDir):- !,
-  load_subproject_file_search_path(ParentFsp, ChildFsp, ChildDir),
-  load_project_index(ChildFsp).
-load_subproject(ParentFsp, Child):-
-  load_subproject(ParentFsp, Child-Child).
-
-
-%! load_subproject_file_search_path(
-%!   +ParentFileSearchPath:atom,
-%!   +ChildFileSearchPath:atom,
-%!   +ChildDirectory:atom
-%! ) is det.
-
-% The file search path for the subproject has already been set.
-load_subproject_file_search_path(_, ChildFsp, _):-
-  user:file_search_path(ChildFsp, _).
-load_subproject_file_search_path(ParentFsp, ChildFsp, ChildDir):-
-  Spec =.. [ParentFsp,ChildDir],
-  absolute_file_name(Spec, _, [access(read),file_type(directory)]), !,
-  assert(user:file_search_path(ChildFsp, Spec)).
-load_subproject_file_search_path(_, ChildFsp, ChildDir):-
-  print_message(warning, missing_subproject_directory(ChildFsp,ChildDir)).
-
-
-%! load_project_index(+FileSearchPath:atom) is det.
-
-load_project_index(Fsp):-
-  Spec =.. [Fsp,index],
-  absolute_file_name(
-    Spec,
-    File,
-    [access(read),file_errors(fail),file_type(prolog)]
-  ), !,
-  ensure_loaded(File).
-load_project_index(_).
-
-
-%! parent_alias(+Parent:atom, -ParentFsp:atom) is det.
-
-parent_alias(Parent, ParentFsp):-
-  user:project(Parent, _, ParentFsp), !.
-parent_alias(Parent, Parent).
-
-
-%! set_data_subdirectory(+ParentDirectory:atom) is det.
-
-set_data_subdirectory(ParentDir):-
-  directory_file_path(ParentDir, data, DataDir),
-  make_directory_path(DataDir),
-  assert(user:file_search_path(data, DataDir)).
-
-
-
-:- multifile(prolog:message//1).
-
-prolog:message(missing_subproject_directory(ChildFsp,ChildDir)) --&amp;gt;
-  [
-    &#39;The ~a submodule is not present.&#39;-[ChildFsp], nl,
-    &#39;Check whether subdirectory ~a is present in your project directory:&#39;-[ChildDir], nl,
-    &#39;    git submodule init&#39;, nl,
-    &#39;    git submodule update&#39;
-  ].
-
diff --git a/pack.pl b/pack.pl
new file mode 100644
index 0000000..989108a
--- /dev/null
+++ b/pack.pl
@@ -0,0 +1,9 @@
+author(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
+download(&#39;https://github.com/wouterbeek/plGraphViz/release/*.zip&#39;).
+home(&#39;https://github.com/wouterbeek/plGraphViz&#39;).
+maintainer(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
+name(plGraphViz).
+packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
+requires(&#39;Prolog-Library-Collection&#39;).
+title(plGraphViz).
+version(&#39;0.0.1&#39;).
diff --git a/plHtml b/plHtml
deleted file mode 160000
index 08480c4..0000000
--- a/plHtml
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 08480c40acaee5f70bfb21e3c641bef1e7d258bd
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
new file mode 100644
index 0000000..083dbb2
--- /dev/null
+++ b/prolog/fca/fca_viz.pl
@@ -0,0 +1,101 @@
+:- module(
+  fca_viz,
+  [
+    fca_export_graph/2, % +Context, -ExportGraph
+    fca_export_graph/3, % +Context, -ExportGraph, :Opts
+    fca_viz/2,          % +Context, ?File
+    fca_viz/3           % +Context, ?File, :Opts
+  ]
+).
+
+/** &amp;lt;module&amp;gt; FCA visualization
+
+@author Wouter Beek
+@version 2015/11-2016/01
+*/
+
+:- use_module(library(aggregate)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(dcg/dcg_pl)).
+:- use_module(library(fca/fca)).
+:- use_module(library(graph/build_export_graph)).
+:- use_module(library(graph/s/s_graph)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(option)).
+:- use_module(library(ordsets)).
+
+:- meta_predicate(fca_export_graph(+,?,:)).
+:- meta_predicate(fca_viz(+,?,:)).
+
+:- predicate_options(fca_export_graph/3, 3, [
+     concept_label(+callable)
+   ]).
+:- predicate_options(fca_viz/3, 3, [
+     pass_to(fca_export_graph/3, 3),
+     pass_to(graph_viz/3, 3)
+   ]).
+
+is_meta(concept_label).
+
+
+
+
+
+%! fca_export_graph(+Context:compound, -ExportGraph:compound) is det.
+% Wrapper around fca_export_graph/3 with default options.
+
+fca_export_graph(Context, ExportG):-
+  fca_export_graph(Context, ExportG, []).
+
+
+%! fca_export_graph(
+%!   +Context:compound,
+%!   -ExportGraph:compound,
+%!   :Options:list(compound)
+%! ) is det.
+% The following optios are supported:
+%   * concept_label(+callable)
+%     DCG writing the labels for individual concepts.
+
+fca_export_graph(Context, ExportG, Opts1):-
+  fca_hasse(Context, Hasse),
+  meta_options(is_meta, Opts1, Opts2),
+  option(concept_label(Label_3), Opts2, concept_label),
+  merge_options(
+    [
+      vertex_label(Label_3),
+      vertex_rank(fca:concept_cardinality)
+    ],
+    Opts2,
+    Opts3
+  ),
+  build_export_graph(Hasse, ExportG, Opts3).
+
+
+
+%! fca_viz(+Context:compound, ?File:atom) is det.
+% Wrapper around fca_viz/3 with default options.
+
+fca_viz(Context, File):-
+  fca_viz(Context, File, []).
+
+
+%! fca_viz(+Context:compound, ?File:atom, :Options:list(compound)) is det.
+
+fca_viz(Context, File, Opts1):-
+  meta_options(is_meta, Opts1, Opts2),
+  statistics(process_cputime, Time1),
+  fca_export_graph(Context, ExportG, Opts2),
+  ExportG = graph(_,_,Es,_),
+  aggregate_all(max(N), (member(edge(V1,V2,_), Es), (N = V1 ; N = V2)), N),
+  ignore(option(number_of_vertices(N), Opts2)),
+  statistics(process_cputime, Time2),
+  Time is Time2 - Time1,
+  ignore(option(process_cputime(Time), Opts2)),
+  graph_viz(ExportG, File, Opts2).
+
+
+
+%! concept_label(+Concept:compound)// is det.
+
+concept_label(concept(Os,As)) --&amp;gt; set(Os), &amp;quot; / &amp;quot;, set(As).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
new file mode 100644
index 0000000..5134069
--- /dev/null
+++ b/prolog/graph/build_export_graph.pl
@@ -0,0 +1,369 @@
+:- module(
+  build_export_graph,
+  [
+    build_export_graph/2, % +Graph, -ExportGraph
+    build_export_graph/3 % +Graph
+                         % -ExportGraph:compound
+                         % +Options:list(compound)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; Build graph representation for exporting
+
+Support for building GIF representations.
+
+# Graph Intermediate Format (GIF)
+
+## Graph
+
+```prolog
+graph(Vs:ordset(compound),Ranks,Es:compound,Attributes:list(compound))
+```
+
+### Edge
+
+```prolog
+edge(FromVertexId,ToVertexId,Attributes:list(compound))
+```
+
+### Rank
+
+```prolog
+RankVertex:compound-ContentVertices:ordset(compound)
+```
+
+### Vertex
+
+```prolog
+vertex(Id,Attributes:list(compound))
+```
+
+# Property functions
+
+Edge label:
+  1. [[graph_edge]] edge_label/2
+
+Vertex coordinates:
+  1. [[circle_coords]] circular_coord/4
+  2. [[random_coords]] random_coord/4
+
+---
+
+@author Wouter Beek
+@version 2015/07, 2015/09-2016/01
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(graph/s/s_graph)).
+:- use_module(library(list_ext)).
+:- use_module(library(option_ext)).
+:- use_module(library(ordsets)).
+:- use_module(library(pairs)).
+
+:- predicate_options(build_export_graph/4, 4, [
+     pass_to(edge_term/3, 3),
+     pass_to(graph_attributes/2, 2),
+     pass_to(vertex_term/3, 3)
+   ]).
+:- predicate_options(edge_term/3, 3, [
+     edge_arrowhead(+callable),
+     edge_color(+callable),
+     edge_id(+callable),
+     edge_label(+callable),
+     edge_penwidth(+callable),
+     edge_style(+callable)
+   ]).
+:- predicate_options(graph_attributes/2, 2, [
+     graph_charset(+oneof([&#39;iso-8859-1&#39;,&#39;Latin1&#39;,&#39;UTF-8&#39;])),
+     graph_colorscheme(+oneof([none,svg,x11])),
+     graph_directed(+boolean),
+     graph_fontsize(+float),
+     graph_label(+atom),
+     graph_overlap(+boolean)
+   ]).
+:- predicate_options(vertex_term/3, 3, [
+     vertex_color(+callable),
+     vertex_id(+callable),
+     vertex_image(+callable),
+     vertex_label(+callable),
+     vertex_peripheries(+callable),
+     vertex_position(+callable),
+     vertex_rank(+callable),
+     vertex_shape(+callable),
+     vertex_uri(+callable)
+   ]).
+
+:- meta_predicate(build_export_graph(+,-,:)).
+
+is_meta(edge_arrowhead).
+is_meta(edge_color).
+is_meta(edge_id).
+is_meta(edge_label).
+is_meta(edge_penwidth).
+is_meta(edge_style).
+is_meta(vertex_color).
+is_meta(vertex_id).
+is_meta(vertex_image).
+is_meta(vertex_label).
+is_meta(vertex_peripheries).
+is_meta(vertex_position).
+is_meta(vertex_rank).
+is_meta(vertex_shape).
+is_meta(vertex_uri).
+
+
+
+
+
+%! build_export_graph(+Graph, -ExportGraph:compound) is det.
+% Wrapper around build_export_graph/3 with default options.
+
+build_export_graph(G, ExportG):-
+  build_export_graph(G, ExportG, []).
+
+
+%! build_export_graph(
+%!   +Graph,
+%!   -ExportGraph:compound,
+%!   +Options:list(compound)
+%! ) is det.
+% Graph is either:
+%   * a coumpound term `graph(Vs,Es)`, or
+%   * an unlabeled graph as defined by `library(ugraph)`.
+%
+% The following options are supported:
+%   * `vertex_rank(:RankFunction)`
+%     Assigns a non-negative integer to each vertex.
+%     No default.
+
+build_export_graph(G, graph(VTerms2,VRanks,ETerms,GAttrs), Opts1):-
+  graph_components(G, Vs, Es),
+  meta_options(is_meta, Opts1, Opts2),
+  maplist(vertex_term0(Vs, Opts2), Vs, VTerms1),
+  build_export_ranks(Vs, VTerms1, VRanks, VTerms2, Opts2),
+  maplist(edge_term0(Vs, Opts2), Es, ETerms),
+  graph_attributes(GAttrs, Opts2).
+
+vertex_term0(Vs, Opts, V, VTerm) :- vertex_term(Vs, V, VTerm, Opts).
+
+edge_term0(Vs, Opts, E, ETerm) :- edge_term(Vs, E, ETerm, Opts).
+
+graph_components(graph(Vs,Es), Vs, Es):- !.
+graph_components(G, Vs, Es):-
+  s_graph_components(G, Vs, Es).
+
+build_export_ranks(Vs, VTerms, VRanks, [], Opts):-
+  option(vertex_rank(VRank_2), Opts), !,
+  maplist(VRank_2, Vs, Ranks),
+  pairs_keys_values(Pairs, Ranks, VTerms),
+  group_pairs_by_key(Pairs, GroupedPairs),
+  build_export_rank_terms(GroupedPairs, VRanks).
+build_export_ranks(_, VTerms, [], VTerms, _).
+
+build_export_rank_terms([N-VTerms|T1], [RankTerm-VTerms|T2]):- !,
+  build_export_rank_term(N, RankTerm),
+  build_export_rank_terms(T1, T2).
+build_export_rank_terms([], []).
+
+build_export_rank_term(N, vertex(Id,[label(&amp;quot;&amp;quot;),shape(none)])):-
+  format(atom(Id), &amp;quot;r~d&amp;quot;, [N]).
+
+
+
+%! edge_term(
+%!   +Vertices:ordset(compound),
+%!   +Edge:compound,
+%!   -EdgeTerm:compound,
+%!   +Options:list(compound)
+%! ) is det.
+% The following options are supported:
+%   * `edge_arrowhead(+callable)`
+%     No default.
+%   * `edge_color(+callable)`
+%     No default.
+%   * `edge_id(+callable)`
+%     Function that assignes the unique identifiers for an edge&#39;s
+%     incident vertices.
+%   * `edge_label(+callable)`
+%     No default.
+%   * `edge_penwidth(+callable)`
+%     No default.
+%   * `edge_style(+callable)`
+%     No default.
+
+edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
+  % Arrowhead
+  if_option(edge_arrowhead(Arrowhead_2), Opts,
+    call(Arrowhead_2, E, EArrowhead)
+  ),
+  
+  % Color.
+  if_option(edge_color(ColorFunction), Opts, call(ColorFunction, E, EColor)),
+  
+  % Id.
+  (   option(edge_id(Id_2), Opts)
+  -&amp;gt;  call(Id_2, E, FromId, ToId)
+  ;   edge_components(E, FromV, ToV),
+      nth0chk(FromId, Vs, FromV),
+      nth0chk(ToId, Vs, ToV)
+  ),
+  
+  % Label.
+  if_option(edge_label(ELabel_3), Opts, string_phrase(dcg_call(ELabel_3, E), ELabel)),
+  
+  % Penwidth.
+  if_option(edge_penwidth(Penwidth_2), Opts, call(Penwidth_2, E, EPenwidth)),
+  
+  % Style.
+  if_option(edge_style(Style_2), Opts, call(Style_2, E, EStyle)),
+  
+  exclude(
+    option_has_var_value,
+    [
+      arrowhead(EArrowhead),
+      color(EColor),
+      label(ELabel),
+      penwidth(EPenwidth),
+      style(EStyle)
+    ],
+    EAttrs
+  ).
+
+
+
+%! graph_attributes(
+%!   -GraphAttributes:list(compound),
+%!   +Options:list(compound)
+%! ) is det.
+% The following options are supported:
+%   * `graph_charset(+oneof([&#39;iso-8859-1&#39;,&#39;Latin1&#39;,&#39;UTF-8&#39;]))`
+%     The name of the character set that is used to encode text in the graph.
+%     Default: `UTF-8`.
+%   * `graph_colorscheme(+oneof([none,svg,x11]))`
+%     The colorscheme from which the color in this graph are taken.
+%     Default: `x11`.
+%   * `graph_directed(+boolean)`
+%     Whether the graph is directed (`true`) or undirected (`false`).
+%     Default: `false`.
+%   * `graph_fontsize(+float)`
+%     The font size of text in the graph.
+%     Default: `11.0`.
+%   * `graph_label(+atom)`
+%     The graph label.
+%     No default.
+%   * `graph_overlap(+boolean)`
+%     Whether the vertices are allowed to overlap.
+%     Default: `false`.
+
+graph_attributes(GAttrs, Opts):-
+  % Characer set.
+  option(graph_charset(Charset), Opts, &#39;UTF-8&#39;),
+  % Colorscheme.
+  option(graph_colorscheme(Colorscheme), Opts, x11),
+  % Directed.
+  option(graph_directed(Directed), Opts, false),
+  % Fontsize.
+  option(graph_fontsize(Fontsize), Opts, 11.0),
+  % Label.
+  % Defaults to the empty string.
+  option(graph_label(GLabel), Opts, &#39;&amp;quot;&amp;quot;&#39;),
+  % Overlap.
+  option(graph_overlap(Overlap), Opts, false),
+  exclude(
+    option_has_var_value,
+    [
+      charset(Charset),
+      colorscheme(Colorscheme),
+      directed(Directed),
+      fontsize(Fontsize),
+      label(GLabel),
+      overlap(Overlap)
+    ],
+    GAttrs
+  ).
+
+
+
+%! vertex_term(
+%!   +Vertices:ordset(compound),
+%!   +Vertex:compound,
+%!   -VertexTerm:compound,
+%!   +Options:list(compound)
+%! ) is det.
+% The following options are supported:
+%   * `vertex_color(:ColorFunction)`
+%     A function that assigns colors to vertices.
+%     No default.
+%   * `vertex_id(:ColorFunction)`
+%     A functions that assigns unique identifiers to vertices.
+%   * `vertex_image(:ImageFunction)`
+%     A function that assigns images to vertices.
+%     No default.
+%   * `vertex_label(:LabelFunction)`
+%     A function that assigns labels to vertices.
+%     No default.
+%   * `vertex_peripheries(:PeripheriesFunction)`
+%     A function that assinges peripheries to vertices.
+%     No default.
+%   * `vertex_position(:PositionFunction)`
+%     No default.
+%   * `vertex_shape(:ShapeFunction)`
+%     A function that assinges shapes to vertices.
+%     No default.
+%   * `vertex_uri(:UriFunction)`
+
+vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-
+  % Color.
+  if_option(vertex_color(Color_2), Opts, call(Color_2, V, VColor)),
+  
+  % Id.
+  (option(vertex_id(Id_2), Opts) -&amp;gt; call(Id_2, V, VId) ; nth0chk(VId, Vs, V)),
+  
+  % Image.
+  ignore(if_option(vertex_image(Image_2), Opts, call(Image_2, V, VImage))),
+
+  % Label.
+  if_option(vertex_label(VLabel_2), Opts, string_phrase(dcg_call(VLabel_2, V), VLabel)),
+
+  % Peripheries.
+  if_option(vertex_peripheries(Peripheries_2), Opts,
+    call(Peripheries_2, V, VPeripheries)
+  ),
+
+  % Position.
+  if_option(vertex_position(Position_4), Opts,
+    call(Position_4, Vs, Opts, V, VPosition)
+  ),
+
+  % Shape.
+  if_option(vertex_shape(Shape_2), Opts, call(Shape_2, V, VShape)),
+  
+  % URI
+  if_option(vertex_uri(Uri_2), Opts, call(Uri_2, V, VUri)),
+
+  exclude(
+    option_has_var_value,
+    [
+      color(VColor),
+      image(VImage),
+      label(VLabel),
+      peripheries(VPeripheries),
+      pos(VPosition),
+      shape(VShape),
+      &#39;URL&#39;(VUri)
+    ],
+    VAttrs
+  ).
+
+
+
+
+
+% HELPERS %
+
+%! edge_components(+Edge:compound, -FromV, -ToV) is det.
+
+edge_components(edge(FromV,_,ToV), FromV, ToV):- !.
+edge_components(edge(FromV,ToV), FromV, ToV):- !.
+edge_components(FromV-ToV, FromV, ToV):- !.
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
new file mode 100644
index 0000000..f55fce5
--- /dev/null
+++ b/prolog/gv/gv_attr_type.pl
@@ -0,0 +1,421 @@
+:- module(
+  gv_attr_type,
+  [
+    gv_attr_type//1, % ?Type:atom
+    addDouble//1, % +Double:float
+    addPoint//1, % +Point:compound
+    arrowType//1, % +ArrowType:atom
+    bool//1, % +Boolean:boolean
+    clusterMode//1, % +ClusterMode:atom
+    dirType//1, % +DirectionType:oneof([back,both,forward,none])
+    double//1, % +Double:float
+    doubleList//1, % +Doubles:list(float)
+    escString//1,
+    %layerList//1,
+    %layerRange//1,
+    lblString//1,
+    int//1, % +Integer:integer
+    outputMode//1, % +OutputMode:atom
+    %packMode//1,
+    pagedir//1, % +Pagedir:atom
+    point//1, % +Point:compound
+    pointList//1, % +Points:list(compound)
+    %portPos//1,
+    quadType//1, % +QuadType:atom
+    rankType//1, % +RankType:atom
+    rankdir//1, % +RankDirection:atom
+    rect//1, % +Rectangle:compound
+    shape//1,
+    smoothType//1, % +SmoothType:atom
+    %splineType//1,
+    %startType//1,
+    string//1, % ?Content:atom
+    style//2 % +Context:oneof([cluster,edge,node])
+             % +Style:atom
+    %viewPort//1
+  ]
+).
+:- reexport(
+  library(gv/gv_color),
+  [
+    color//1, % +Color:compound
+    colorList//1 % +ColorList:list(compound)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz attribute types
+
+@author Wouter Beek
+@version 2015/07, 2015/11, 2016/02
+*/
+
+:- use_module(library(dcg/dcg_ext), except([string//1])).
+:- use_module(library(gv/gv_html)).
+
+
+
+
+
+%! gv_attr_type(?Type:atom) is nondet.
+
+gv_attr_type(addDouble)   --&amp;gt; &amp;quot;addDouble&amp;quot;.
+gv_attr_type(addPoint)    --&amp;gt; &amp;quot;addPoint&amp;quot;.
+gv_attr_type(arrowType)   --&amp;gt; &amp;quot;arrowType&amp;quot;.
+gv_attr_type(bool)        --&amp;gt; &amp;quot;bool&amp;quot;.
+gv_attr_type(color)       --&amp;gt; &amp;quot;color&amp;quot;.
+gv_attr_type(colorList)   --&amp;gt; &amp;quot;colorList&amp;quot;.
+gv_attr_type(clusterMode) --&amp;gt; &amp;quot;clusterMode&amp;quot;.
+gv_attr_type(dirType)     --&amp;gt; &amp;quot;dirType&amp;quot;.
+gv_attr_type(double)      --&amp;gt; &amp;quot;double&amp;quot;.
+gv_attr_type(doubleList)  --&amp;gt; &amp;quot;doubleList&amp;quot;.
+gv_attr_type(escString)   --&amp;gt; &amp;quot;escString&amp;quot;.
+gv_attr_type(layerList)   --&amp;gt; &amp;quot;layerList&amp;quot;.
+gv_attr_type(layerRange)  --&amp;gt; &amp;quot;layerRange&amp;quot;.
+gv_attr_type(lblString)   --&amp;gt; &amp;quot;lblString&amp;quot;.
+gv_attr_type(int)         --&amp;gt; &amp;quot;int&amp;quot;.
+gv_attr_type(outputMode)  --&amp;gt; &amp;quot;outputMode&amp;quot;.
+gv_attr_type(packMode)    --&amp;gt; &amp;quot;packMode&amp;quot;.
+gv_attr_type(pagedir)     --&amp;gt; &amp;quot;pagedir&amp;quot;.
+gv_attr_type(point)       --&amp;gt; &amp;quot;point&amp;quot;.
+gv_attr_type(pointList)   --&amp;gt; &amp;quot;pointList&amp;quot;.
+gv_attr_type(portPos)     --&amp;gt; &amp;quot;portPos&amp;quot;.
+gv_attr_type(quadType)    --&amp;gt; &amp;quot;quadType&amp;quot;.
+gv_attr_type(rankType)    --&amp;gt; &amp;quot;rankType&amp;quot;.
+gv_attr_type(rankdir)     --&amp;gt; &amp;quot;rankdir&amp;quot;.
+gv_attr_type(rect)        --&amp;gt; &amp;quot;rect&amp;quot;.
+gv_attr_type(shape)       --&amp;gt; &amp;quot;shape&amp;quot;.
+gv_attr_type(smoothType)  --&amp;gt; &amp;quot;smoothType&amp;quot;.
+gv_attr_type(splineType)  --&amp;gt; &amp;quot;splineType&amp;quot;.
+gv_attr_type(startType)   --&amp;gt; &amp;quot;startType&amp;quot;.
+gv_attr_type(string)      --&amp;gt; &amp;quot;string&amp;quot;.
+gv_attr_type(style)       --&amp;gt; &amp;quot;style&amp;quot;.
+gv_attr_type(viewPort)    --&amp;gt; &amp;quot;viewPort&amp;quot;.
+
+
+
+%! addDouble(+Float:float)// .
+% An *addDouble* is represented by a Prolog float.
+
+addDouble(N) --&amp;gt; (&amp;quot;+&amp;quot;, ! ; &amp;quot;&amp;quot;), float(N).
+
+
+
+%! addPoint(+Point:compound)// .
+% An *addPoint* is represented by a compound of the following form:
+% `point(X:float,Y:float,InputOnly:boolean)`.
+
+addPoint(Point) --&amp;gt; (&amp;quot;+&amp;quot;, ! ; &amp;quot;&amp;quot;), point(Point).
+
+
+
+%! arrowType(+ArrowType:atom)// .
+
+arrowType(V) --&amp;gt; primitive_shape(V).
+arrowType(V) --&amp;gt; derived(V).
+arrowType(V) --&amp;gt; backwards_compatible(V).
+
+primitive_shape(box)     --&amp;gt; &amp;quot;box&amp;quot;.
+primitive_shape(crow)    --&amp;gt; &amp;quot;crow&amp;quot;.
+primitive_shape(circle)  --&amp;gt; &amp;quot;circle&amp;quot;.
+primitive_shape(diamond) --&amp;gt; &amp;quot;diamond&amp;quot;.
+primitive_shape(dot)     --&amp;gt; &amp;quot;dot&amp;quot;.
+primitive_shape(inv)     --&amp;gt; &amp;quot;inv&amp;quot;.
+primitive_shape(none)    --&amp;gt; &amp;quot;none&amp;quot;.
+primitive_shape(normal)  --&amp;gt; &amp;quot;normal&amp;quot;.
+primitive_shape(tee)     --&amp;gt; &amp;quot;tee&amp;quot;.
+primitive_shape(vee)     --&amp;gt; &amp;quot;vee&amp;quot;.
+
+derived(odot)     --&amp;gt; &amp;quot;odot&amp;quot;.
+derived(invdot)   --&amp;gt; &amp;quot;invdot&amp;quot;.
+derived(invodot)  --&amp;gt; &amp;quot;invodot&amp;quot;.
+derived(obox)     --&amp;gt; &amp;quot;obox&amp;quot;.
+derived(odiamond) --&amp;gt; &amp;quot;odiamond&amp;quot;.
+
+backwards_compatible(ediamond) --&amp;gt; &amp;quot;ediamond&amp;quot;.
+backwards_compatible(empty)    --&amp;gt; &amp;quot;empty&amp;quot;.
+backwards_compatible(halfopen) --&amp;gt; &amp;quot;halfopen&amp;quot;.
+backwards_compatible(invempty) --&amp;gt; &amp;quot;invempty&amp;quot;.
+backwards_compatible(open)     --&amp;gt; &amp;quot;open&amp;quot;.
+
+
+
+%! bool(+Value:boolean)// .
+
+bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
+bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
+bool(true)  --&amp;gt; &amp;quot;true&amp;quot;.
+bool(true)  --&amp;gt; &amp;quot;yes&amp;quot;.
+
+
+
+%! clusterMode(+ClusterMode:atom)// .
+
+clusterMode(global) --&amp;gt; &amp;quot;global&amp;quot;.
+clusterMode(local) --&amp;gt; &amp;quot;local&amp;quot;.
+clusterMode(none) --&amp;gt; &amp;quot;none&amp;quot;.
+
+
+
+%! dirType(+DirectionType:oneof([back,both,forward,none]))// .
+
+dirType(back) --&amp;gt; &amp;quot;back&amp;quot;.
+dirType(both) --&amp;gt; &amp;quot;both&amp;quot;.
+dirType(forward) --&amp;gt; &amp;quot;forward&amp;quot;.
+dirType(none) --&amp;gt; &amp;quot;none&amp;quot;.
+
+
+
+%! double(+Double:float)// .
+
+double(N) --&amp;gt; float(N).
+
+
+
+%! doubleList(+Doubles:list(float))// .
+
+doubleList([H|T]) --&amp;gt; double(H), (&amp;quot;:&amp;quot;, !, doubleList(T) ; {T = []}).
+
+
+
+%! escString(+String:or([atom,string]))// .
+% @tbd Support for context-dependent replacements.
+
+escString(S1) --&amp;gt;
+  {(  string(S1)
+  -&amp;gt;  string_phrase(escape_double_quotes, S1, S2)
+  ;   atom_phrase(escape_double_quotes, S1, S2)
+  )},
+  &amp;quot;\&amp;quot;&amp;quot;, atom(S2), &amp;quot;\&amp;quot;&amp;quot;.
+
+escape_double_quotes, [0&#39;\\,0&#39;&amp;quot;] --&amp;gt; [0&#39;&amp;quot;], !, escape_double_quotes.
+escape_double_quotes, [X]        --&amp;gt; [X],   !, escape_double_quotes.
+escape_double_quotes             --&amp;gt; &amp;quot;&amp;quot;.
+
+
+
+% @tbd layerList
+
+
+
+% @tbd layerRange
+
+
+
+%! lblString(+String:compound)// .
+
+lblString(html_like_label(V)) --&amp;gt; gv_html_like_label(V).
+lblString(V) --&amp;gt; escString(V).
+
+
+
+%! int(+Integer:integer)// .
+
+int(V) --&amp;gt; integer(V).
+
+
+
+%! outputMode(+OutputMode:atom)// .
+
+outputMode(breadthfirst) --&amp;gt; &amp;quot;breadthfirst&amp;quot;.
+outputMode(edgesfirst)   --&amp;gt; &amp;quot;edgesfirst&amp;quot;.
+outputMode(nodesfirst)   --&amp;gt; &amp;quot;nodesfirst&amp;quot;.
+
+
+
+% @tbd packMode
+
+
+
+%! pagedir(+PageDirection:atom)// .
+
+pagedir(&#39;BL&#39;) --&amp;gt; &amp;quot;BL&amp;quot;.
+pagedir(&#39;BR&#39;) --&amp;gt; &amp;quot;BR&amp;quot;.
+pagedir(&#39;LB&#39;) --&amp;gt; &amp;quot;LB&amp;quot;.
+pagedir(&#39;LT&#39;) --&amp;gt; &amp;quot;LT&amp;quot;.
+pagedir(&#39;RB&#39;) --&amp;gt; &amp;quot;RB&amp;quot;.
+pagedir(&#39;RT&#39;) --&amp;gt; &amp;quot;RT&amp;quot;.
+pagedir(&#39;TL&#39;) --&amp;gt; &amp;quot;TL&amp;quot;.
+pagedir(&#39;TR&#39;) --&amp;gt; &amp;quot;TR&amp;quot;.
+
+
+
+%! point(+Point:compound)// .
+% A *point* is represented by a compound of the following form:
+% `point(X:float,Y:float,Changeable:boolean)`.
+
+point(point(X,Y,Changeable)) --&amp;gt;
+  float(X), &amp;quot;,&amp;quot;, float(Y),
+  input_changeable(Changeable).
+
+input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
+input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
+
+
+
+%! pointList(+Points:list(compound))// .
+
+pointList(Points) --&amp;gt;
+  *(point, Points).
+
+
+
+% @tbd portPos
+
+
+
+%! quadType(+QuadType:atom)// .
+
+quadType(fast) --&amp;gt; &amp;quot;fast&amp;quot;.
+quadType(none) --&amp;gt; &amp;quot;none&amp;quot;.
+quadType(normal) --&amp;gt; &amp;quot;normal&amp;quot;.
+
+
+
+%! rankType(+RankType:atom)// .
+
+rankType(max) --&amp;gt; &amp;quot;max&amp;quot;.
+rankType(min) --&amp;gt; &amp;quot;min&amp;quot;.
+rankType(same) --&amp;gt; &amp;quot;same&amp;quot;.
+rankType(sink) --&amp;gt; &amp;quot;sink&amp;quot;.
+rankType(source) --&amp;gt; &amp;quot;source&amp;quot;.
+
+
+
+%! rankdir(+RankDirection:oneof([&#39;BT&#39;,&#39;LR&#39;,&#39;RL&#39;,&#39;TB&#39;]))// .
+
+rankdir(&#39;BT&#39;) --&amp;gt; &amp;quot;BT&amp;quot;.
+rankdir(&#39;LR&#39;) --&amp;gt; &amp;quot;LR&amp;quot;.
+rankdir(&#39;RL&#39;) --&amp;gt; &amp;quot;RL&amp;quot;.
+rankdir(&#39;TB&#39;) --&amp;gt; &amp;quot;TB&amp;quot;.
+
+
+
+%! rect(+Rectangle:compound)// .
+
+rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
+  float(LowerLeftX), &amp;quot;,&amp;quot;,
+  float(LowerLeftY), &amp;quot;,&amp;quot;,
+  float(UpperRightX), &amp;quot;,&amp;quot;,
+  float(UpperRightY).
+
+
+
+%! shape(+Shape:atom)// .
+
+shape(V) --&amp;gt; {polygon_based_shape(V)}, atom(V).
+
+polygon_based_shape(assembly).
+polygon_based_shape(box).
+polygon_based_shape(box3d).
+polygon_based_shape(cds).
+polygon_based_shape(circle).
+polygon_based_shape(component).
+polygon_based_shape(diamond).
+polygon_based_shape(doublecircle).
+polygon_based_shape(doubleoctagon).
+polygon_based_shape(egg).
+polygon_based_shape(ellipse).
+polygon_based_shape(fivepoverhang).
+polygon_based_shape(folder).
+polygon_based_shape(hexagon).
+polygon_based_shape(house).
+polygon_based_shape(insulator).
+polygon_based_shape(invhouse).
+polygon_based_shape(invtrapezium).
+polygon_based_shape(invtriangle).
+polygon_based_shape(larrow).
+polygon_based_shape(lpromoter).
+polygon_based_shape(&#39;Mcircle&#39;).
+polygon_based_shape(&#39;Mdiamond&#39;).
+polygon_based_shape(&#39;Msquare&#39;).
+polygon_based_shape(none).
+polygon_based_shape(note).
+polygon_based_shape(noverhang).
+polygon_based_shape(octagon).
+polygon_based_shape(oval).
+polygon_based_shape(parallelogram).
+polygon_based_shape(pentagon).
+polygon_based_shape(plaintext).
+polygon_based_shape(point).
+polygon_based_shape(polygon).
+polygon_based_shape(primersite).
+polygon_based_shape(promoter).
+polygon_based_shape(proteasesite).
+polygon_based_shape(proteinstab).
+polygon_based_shape(rarrow).
+polygon_based_shape(rect).
+polygon_based_shape(rectangle).
+polygon_based_shape(restrictionsite).
+polygon_based_shape(ribosite).
+polygon_based_shape(rnastab).
+polygon_based_shape(rpromoter).
+polygon_based_shape(septagon).
+polygon_based_shape(signature).
+polygon_based_shape(square).
+polygon_based_shape(tab).
+polygon_based_shape(terminator).
+polygon_based_shape(threepoverhang).
+polygon_based_shape(trapezium).
+polygon_based_shape(triangle).
+polygon_based_shape(tripleoctagon).
+polygon_based_shape(utr).
+
+
+
+%! smoothType(+SmoothType:atom)// .
+
+smoothType(V) --&amp;gt; {smoothType(V)}, atom(V).
+
+smoothType(avg_dist).
+smoothType(graph_dist).
+smoothType(none).
+smoothType(power_dist).
+smoothType(rng).
+smoothType(spring).
+smoothType(triangle).
+
+
+
+% @tbd splineType
+
+
+
+% @tbd startType
+
+
+
+%! string(?String:atom)// .
+% A GraphViz string.
+
+string(Content) --&amp;gt; &amp;quot;\&amp;quot;&amp;quot;, atom(Content), &amp;quot;\&amp;quot;&amp;quot;.
+
+
+
+%! style(?Context:oneof([cluster,edge,node]), ?Style:atom) is nondet.
+
+style(Context, Style) --&amp;gt; {style(Context, Style)}, atom(Style).
+
+style(cluster, bold).
+style(cluster, dashed).
+style(cluster, dotted).
+style(cluster, filled).
+style(cluster, rounded).
+style(cluster, solid).
+style(cluster, striped).
+style(edge, bold).
+style(edge, dashed).
+style(edge, dotted).
+style(edge, solid).
+style(node, bold).
+style(node, dashed).
+style(node, diagonals).
+style(node, dotted).
+style(node, filled).
+style(node, rounded).
+style(node, solid).
+style(node, striped).
+style(node, wedged).
+
+
+
+% @tbd viewPort
diff --git a/prolog/gv/gv_attrs.data b/prolog/gv/gv_attrs.data
new file mode 100644
index 0000000..95fc680
--- /dev/null
+++ b/prolog/gv/gv_attrs.data
@@ -0,0 +1,169 @@
+gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;).
+gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;).
+gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_G59448,&#39;&#39;,&#39;svg, postscript, map only&#39;).
+gv_attr(&#39;_background&#39;,[graph],[string],_G59644,&#39;&#39;,&#39;&#39;).
+gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;).
+gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;).
+gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;).
+gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(bgcolor,[cluster,graph],[color,colorList],_G60571,&#39;&#39;,&#39;&#39;).
+gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;).
+gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;).
+gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;).
+gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;).
+gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;).
+gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;).
+gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(edgetarget,[edge],[escString],_G63711,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;).
+gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;).
+gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;).
+gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;).
+gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;).
+gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;).
+gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;).
+gv_attr(headtarget,[edge],[escString],_G4892,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;).
+gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;).
+gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;).
+gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;).
+gv_attr(inputscale,[graph],[double],_G6250,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;).
+gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;).
+gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;).
+gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;).
+gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labeltarget,[edge],[escString],_G8276,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;).
+gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;).
+gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;).
+gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;).
+gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(nslimitnslimit1,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;).
+gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;).
+gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;).
+gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;).
+gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;).
+gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;).
+gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;).
+gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;).
+gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;).
+gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;).
+gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;).
+gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;).
+gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;).
+gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;).
+gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;).
+gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;).
+gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;).
+gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;).
+gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;).
+gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;).
+gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;).
+gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;).
+gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;).
+gv_attr(tailtarget,[edge],[escString],_G21528,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(target,[cluster,edge,graph,node],[escString,string],_G21878,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;).
+gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;).
+gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;).
+gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;).
+gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;).
+gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
new file mode 100644
index 0000000..4a92d5b
--- /dev/null
+++ b/prolog/gv/gv_attrs.pl
@@ -0,0 +1,76 @@
+:- module(
+  gv_attrs,
+  [
+    gv_attr_value//2 % +Context:oneof([cluster,edge,graph,node,subgraph])
+                     % +Attr
+  ]
+).
+:- ensure_loaded(library(&#39;gv/gv_attrs.data&#39;)).
+
+/** &amp;lt;module&amp;gt; GraphViz attributes
+
+@author Wouter Beek
+@version 2015/07-2015/08, 2015/10, 2016/03
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(error)).
+:- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
+:- use_module(library(lists)).
+:- use_module(library(os/file_ext)).
+
+
+
+
+
+%! gv_attr_value(+Context, +Attr)// is det.
+% Uses the default value in case Value is uninstantiated.
+% Otherwise, performs a typecheck and converts the given value.
+%
+% Context can be either `cluster`, `edge`, `graph`, `node` or `subgraph`.
+
+% Use the default if no value is given.
+gv_attr_value(Context, Name=Value) --&amp;gt;
+  {
+    var(Value),
+    gv_attr(Name, UsedBy, _, DefaultValue, _, _),
+    % Check validity of context.
+    memberchk(Context, UsedBy)
+  }, !,
+  gv_attr_value(Context, Name=DefaultValue).
+gv_attr_value(Context, Name=Value) --&amp;gt;
+  {
+    % Check the validity of the context argument.
+    gv_attr(Name, UsedBy, Types, _, Minimum, _),
+    memberchk(Context, UsedBy),
+
+    %  Pick a value type non-deterministically.
+    member(Type, Types),
+
+    % The `style` type is the only one that requires the context argument.
+    (   Type == style
+    -&amp;gt;  Dcg =.. [Type,Context]
+    ;   Dcg =.. [Type]
+    ),
+
+    % Check validity of Value w.r.t. minimum value -- if available.
+    check_minimum(Value, Minimum)
+  }, !,
+  dcg_call(gv_attr_type:Dcg, Value).
+gv_attr_value(_, Name=_) --&amp;gt;
+  {existence_error(gv_attr, Name)}.
+
+
+
+
+
+% HELPERS %
+
+%! check_minimum(+Value:atom, +Minimum:number) is semidet.
+% Trivially succeeds if no minimum value is available for a given attribute.
+
+check_minimum(_, &#39;&#39;):- !.
+check_minimum(V, Min1):-
+  atom_number(Min1, Min2),
+  Min2 =&amp;lt; V.
diff --git a/prolog/gv/gv_color.data b/prolog/gv/gv_color.data
new file mode 100644
index 0000000..166b13c
--- /dev/null
+++ b/prolog/gv/gv_color.data
@@ -0,0 +1,802 @@
+gv_color(x11,aliceblue).
+gv_color(x11,antiquewhite).
+gv_color(x11,antiquewhite1).
+gv_color(x11,antiquewhite2).
+gv_color(x11,antiquewhite3).
+gv_color(x11,antiquewhite4).
+gv_color(x11,aquamarine).
+gv_color(x11,aquamarine1).
+gv_color(x11,aquamarine2).
+gv_color(x11,aquamarine3).
+gv_color(x11,aquamarine4).
+gv_color(x11,azure).
+gv_color(x11,azure1).
+gv_color(x11,azure2).
+gv_color(x11,azure3).
+gv_color(x11,azure4).
+gv_color(x11,beige).
+gv_color(x11,bisque).
+gv_color(x11,bisque1).
+gv_color(x11,bisque2).
+gv_color(x11,bisque3).
+gv_color(x11,bisque4).
+gv_color(x11,black).
+gv_color(x11,blanchedalmond).
+gv_color(x11,blue).
+gv_color(x11,blue1).
+gv_color(x11,blue2).
+gv_color(x11,blue3).
+gv_color(x11,blue4).
+gv_color(x11,blueviolet).
+gv_color(x11,brown).
+gv_color(x11,brown1).
+gv_color(x11,brown2).
+gv_color(x11,brown3).
+gv_color(x11,brown4).
+gv_color(x11,burlywood).
+gv_color(x11,burlywood1).
+gv_color(x11,burlywood2).
+gv_color(x11,burlywood3).
+gv_color(x11,burlywood4).
+gv_color(x11,cadetblue).
+gv_color(x11,cadetblue1).
+gv_color(x11,cadetblue2).
+gv_color(x11,cadetblue3).
+gv_color(x11,cadetblue4).
+gv_color(x11,chartreuse).
+gv_color(x11,chartreuse1).
+gv_color(x11,chartreuse2).
+gv_color(x11,chartreuse3).
+gv_color(x11,chartreuse4).
+gv_color(x11,chocolate).
+gv_color(x11,chocolate1).
+gv_color(x11,chocolate2).
+gv_color(x11,chocolate3).
+gv_color(x11,chocolate4).
+gv_color(x11,coral).
+gv_color(x11,coral1).
+gv_color(x11,coral2).
+gv_color(x11,coral3).
+gv_color(x11,coral4).
+gv_color(x11,cornflowerblue).
+gv_color(x11,cornsilk).
+gv_color(x11,cornsilk1).
+gv_color(x11,cornsilk2).
+gv_color(x11,cornsilk3).
+gv_color(x11,cornsilk4).
+gv_color(x11,crimson).
+gv_color(x11,cyan).
+gv_color(x11,cyan1).
+gv_color(x11,cyan2).
+gv_color(x11,cyan3).
+gv_color(x11,cyan4).
+gv_color(x11,darkgoldenrod).
+gv_color(x11,darkgoldenrod1).
+gv_color(x11,darkgoldenrod2).
+gv_color(x11,darkgoldenrod3).
+gv_color(x11,darkgoldenrod4).
+gv_color(x11,darkgreen).
+gv_color(x11,darkkhaki).
+gv_color(x11,darkolivegreen).
+gv_color(x11,darkolivegreen1).
+gv_color(x11,darkolivegreen2).
+gv_color(x11,darkolivegreen3).
+gv_color(x11,darkolivegreen4).
+gv_color(x11,darkorange).
+gv_color(x11,darkorange1).
+gv_color(x11,darkorange2).
+gv_color(x11,darkorange3).
+gv_color(x11,darkorange4).
+gv_color(x11,darkorchid).
+gv_color(x11,darkorchid1).
+gv_color(x11,darkorchid2).
+gv_color(x11,darkorchid3).
+gv_color(x11,darkorchid4).
+gv_color(x11,darksalmon).
+gv_color(x11,darkseagreen).
+gv_color(x11,darkseagreen1).
+gv_color(x11,darkseagreen2).
+gv_color(x11,darkseagreen3).
+gv_color(x11,darkseagreen4).
+gv_color(x11,darkslateblue).
+gv_color(x11,darkslategray).
+gv_color(x11,darkslategray1).
+gv_color(x11,darkslategray2).
+gv_color(x11,darkslategray3).
+gv_color(x11,darkslategray4).
+gv_color(x11,darkslategrey).
+gv_color(x11,darkturquoise).
+gv_color(x11,darkviolet).
+gv_color(x11,deeppink).
+gv_color(x11,deeppink1).
+gv_color(x11,deeppink2).
+gv_color(x11,deeppink3).
+gv_color(x11,deeppink4).
+gv_color(x11,deepskyblue).
+gv_color(x11,deepskyblue1).
+gv_color(x11,deepskyblue2).
+gv_color(x11,deepskyblue3).
+gv_color(x11,deepskyblue4).
+gv_color(x11,dimgray).
+gv_color(x11,dimgrey).
+gv_color(x11,dodgerblue).
+gv_color(x11,dodgerblue1).
+gv_color(x11,dodgerblue2).
+gv_color(x11,dodgerblue3).
+gv_color(x11,dodgerblue4).
+gv_color(x11,firebrick).
+gv_color(x11,firebrick1).
+gv_color(x11,firebrick2).
+gv_color(x11,firebrick3).
+gv_color(x11,firebrick4).
+gv_color(x11,floralwhite).
+gv_color(x11,forestgreen).
+gv_color(x11,gainsboro).
+gv_color(x11,ghostwhite).
+gv_color(x11,gold).
+gv_color(x11,gold1).
+gv_color(x11,gold2).
+gv_color(x11,gold3).
+gv_color(x11,gold4).
+gv_color(x11,goldenrod).
+gv_color(x11,goldenrod1).
+gv_color(x11,goldenrod2).
+gv_color(x11,goldenrod3).
+gv_color(x11,goldenrod4).
+gv_color(x11,gray).
+gv_color(x11,gray0).
+gv_color(x11,gray1).
+gv_color(x11,gray10).
+gv_color(x11,gray100).
+gv_color(x11,gray11).
+gv_color(x11,gray12).
+gv_color(x11,gray13).
+gv_color(x11,gray14).
+gv_color(x11,gray15).
+gv_color(x11,gray16).
+gv_color(x11,gray17).
+gv_color(x11,gray18).
+gv_color(x11,gray19).
+gv_color(x11,gray2).
+gv_color(x11,gray20).
+gv_color(x11,gray21).
+gv_color(x11,gray22).
+gv_color(x11,gray23).
+gv_color(x11,gray24).
+gv_color(x11,gray25).
+gv_color(x11,gray26).
+gv_color(x11,gray27).
+gv_color(x11,gray28).
+gv_color(x11,gray29).
+gv_color(x11,gray3).
+gv_color(x11,gray30).
+gv_color(x11,gray31).
+gv_color(x11,gray32).
+gv_color(x11,gray33).
+gv_color(x11,gray34).
+gv_color(x11,gray35).
+gv_color(x11,gray36).
+gv_color(x11,gray37).
+gv_color(x11,gray38).
+gv_color(x11,gray39).
+gv_color(x11,gray4).
+gv_color(x11,gray40).
+gv_color(x11,gray41).
+gv_color(x11,gray42).
+gv_color(x11,gray43).
+gv_color(x11,gray44).
+gv_color(x11,gray45).
+gv_color(x11,gray46).
+gv_color(x11,gray47).
+gv_color(x11,gray48).
+gv_color(x11,gray49).
+gv_color(x11,gray5).
+gv_color(x11,gray50).
+gv_color(x11,gray51).
+gv_color(x11,gray52).
+gv_color(x11,gray53).
+gv_color(x11,gray54).
+gv_color(x11,gray55).
+gv_color(x11,gray56).
+gv_color(x11,gray57).
+gv_color(x11,gray58).
+gv_color(x11,gray59).
+gv_color(x11,gray6).
+gv_color(x11,gray60).
+gv_color(x11,gray61).
+gv_color(x11,gray62).
+gv_color(x11,gray63).
+gv_color(x11,gray64).
+gv_color(x11,gray65).
+gv_color(x11,gray66).
+gv_color(x11,gray67).
+gv_color(x11,gray68).
+gv_color(x11,gray69).
+gv_color(x11,gray7).
+gv_color(x11,gray70).
+gv_color(x11,gray71).
+gv_color(x11,gray72).
+gv_color(x11,gray73).
+gv_color(x11,gray74).
+gv_color(x11,gray75).
+gv_color(x11,gray76).
+gv_color(x11,gray77).
+gv_color(x11,gray78).
+gv_color(x11,gray79).
+gv_color(x11,gray8).
+gv_color(x11,gray80).
+gv_color(x11,gray81).
+gv_color(x11,gray82).
+gv_color(x11,gray83).
+gv_color(x11,gray84).
+gv_color(x11,gray85).
+gv_color(x11,gray86).
+gv_color(x11,gray87).
+gv_color(x11,gray88).
+gv_color(x11,gray89).
+gv_color(x11,gray9).
+gv_color(x11,gray90).
+gv_color(x11,gray91).
+gv_color(x11,gray92).
+gv_color(x11,gray93).
+gv_color(x11,gray94).
+gv_color(x11,gray95).
+gv_color(x11,gray96).
+gv_color(x11,gray97).
+gv_color(x11,gray98).
+gv_color(x11,gray99).
+gv_color(x11,green).
+gv_color(x11,green1).
+gv_color(x11,green2).
+gv_color(x11,green3).
+gv_color(x11,green4).
+gv_color(x11,greenyellow).
+gv_color(x11,grey).
+gv_color(x11,grey0).
+gv_color(x11,grey1).
+gv_color(x11,grey10).
+gv_color(x11,grey100).
+gv_color(x11,grey11).
+gv_color(x11,grey12).
+gv_color(x11,grey13).
+gv_color(x11,grey14).
+gv_color(x11,grey15).
+gv_color(x11,grey16).
+gv_color(x11,grey17).
+gv_color(x11,grey18).
+gv_color(x11,grey19).
+gv_color(x11,grey2).
+gv_color(x11,grey20).
+gv_color(x11,grey21).
+gv_color(x11,grey22).
+gv_color(x11,grey23).
+gv_color(x11,grey24).
+gv_color(x11,grey25).
+gv_color(x11,grey26).
+gv_color(x11,grey27).
+gv_color(x11,grey28).
+gv_color(x11,grey29).
+gv_color(x11,grey3).
+gv_color(x11,grey30).
+gv_color(x11,grey31).
+gv_color(x11,grey32).
+gv_color(x11,grey33).
+gv_color(x11,grey34).
+gv_color(x11,grey35).
+gv_color(x11,grey36).
+gv_color(x11,grey37).
+gv_color(x11,grey38).
+gv_color(x11,grey39).
+gv_color(x11,grey4).
+gv_color(x11,grey40).
+gv_color(x11,grey41).
+gv_color(x11,grey42).
+gv_color(x11,grey43).
+gv_color(x11,grey44).
+gv_color(x11,grey45).
+gv_color(x11,grey46).
+gv_color(x11,grey47).
+gv_color(x11,grey48).
+gv_color(x11,grey49).
+gv_color(x11,grey5).
+gv_color(x11,grey50).
+gv_color(x11,grey51).
+gv_color(x11,grey52).
+gv_color(x11,grey53).
+gv_color(x11,grey54).
+gv_color(x11,grey55).
+gv_color(x11,grey56).
+gv_color(x11,grey57).
+gv_color(x11,grey58).
+gv_color(x11,grey59).
+gv_color(x11,grey6).
+gv_color(x11,grey60).
+gv_color(x11,grey61).
+gv_color(x11,grey62).
+gv_color(x11,grey63).
+gv_color(x11,grey64).
+gv_color(x11,grey65).
+gv_color(x11,grey66).
+gv_color(x11,grey67).
+gv_color(x11,grey68).
+gv_color(x11,grey69).
+gv_color(x11,grey7).
+gv_color(x11,grey70).
+gv_color(x11,grey71).
+gv_color(x11,grey72).
+gv_color(x11,grey73).
+gv_color(x11,grey74).
+gv_color(x11,grey75).
+gv_color(x11,grey76).
+gv_color(x11,grey77).
+gv_color(x11,grey78).
+gv_color(x11,grey79).
+gv_color(x11,grey8).
+gv_color(x11,grey80).
+gv_color(x11,grey81).
+gv_color(x11,grey82).
+gv_color(x11,grey83).
+gv_color(x11,grey84).
+gv_color(x11,grey85).
+gv_color(x11,grey86).
+gv_color(x11,grey87).
+gv_color(x11,grey88).
+gv_color(x11,grey89).
+gv_color(x11,grey9).
+gv_color(x11,grey90).
+gv_color(x11,grey91).
+gv_color(x11,grey92).
+gv_color(x11,grey93).
+gv_color(x11,grey94).
+gv_color(x11,grey95).
+gv_color(x11,grey96).
+gv_color(x11,grey97).
+gv_color(x11,grey98).
+gv_color(x11,grey99).
+gv_color(x11,honeydew).
+gv_color(x11,honeydew1).
+gv_color(x11,honeydew2).
+gv_color(x11,honeydew3).
+gv_color(x11,honeydew4).
+gv_color(x11,hotpink).
+gv_color(x11,hotpink1).
+gv_color(x11,hotpink2).
+gv_color(x11,hotpink3).
+gv_color(x11,hotpink4).
+gv_color(x11,indianred).
+gv_color(x11,indianred1).
+gv_color(x11,indianred2).
+gv_color(x11,indianred3).
+gv_color(x11,indianred4).
+gv_color(x11,indigo).
+gv_color(x11,invis).
+gv_color(x11,ivory).
+gv_color(x11,ivory1).
+gv_color(x11,ivory2).
+gv_color(x11,ivory3).
+gv_color(x11,ivory4).
+gv_color(x11,khaki).
+gv_color(x11,khaki1).
+gv_color(x11,khaki2).
+gv_color(x11,khaki3).
+gv_color(x11,khaki4).
+gv_color(x11,lavender).
+gv_color(x11,lavenderblush).
+gv_color(x11,lavenderblush1).
+gv_color(x11,lavenderblush2).
+gv_color(x11,lavenderblush3).
+gv_color(x11,lavenderblush4).
+gv_color(x11,lawngreen).
+gv_color(x11,lemonchiffon).
+gv_color(x11,lemonchiffon1).
+gv_color(x11,lemonchiffon2).
+gv_color(x11,lemonchiffon3).
+gv_color(x11,lemonchiffon4).
+gv_color(x11,lightblue).
+gv_color(x11,lightblue1).
+gv_color(x11,lightblue2).
+gv_color(x11,lightblue3).
+gv_color(x11,lightblue4).
+gv_color(x11,lightcoral).
+gv_color(x11,lightcyan).
+gv_color(x11,lightcyan1).
+gv_color(x11,lightcyan2).
+gv_color(x11,lightcyan3).
+gv_color(x11,lightcyan4).
+gv_color(x11,lightgoldenrod).
+gv_color(x11,lightgoldenrod1).
+gv_color(x11,lightgoldenrod2).
+gv_color(x11,lightgoldenrod3).
+gv_color(x11,lightgoldenrod4).
+gv_color(x11,lightgoldenrodyellow).
+gv_color(x11,lightgray).
+gv_color(x11,lightgrey).
+gv_color(x11,lightpink).
+gv_color(x11,lightpink1).
+gv_color(x11,lightpink2).
+gv_color(x11,lightpink3).
+gv_color(x11,lightpink4).
+gv_color(x11,lightsalmon).
+gv_color(x11,lightsalmon1).
+gv_color(x11,lightsalmon2).
+gv_color(x11,lightsalmon3).
+gv_color(x11,lightsalmon4).
+gv_color(x11,lightseagreen).
+gv_color(x11,lightskyblue).
+gv_color(x11,lightskyblue1).
+gv_color(x11,lightskyblue2).
+gv_color(x11,lightskyblue3).
+gv_color(x11,lightskyblue4).
+gv_color(x11,lightslateblue).
+gv_color(x11,lightslategray).
+gv_color(x11,lightslategrey).
+gv_color(x11,lightsteelblue).
+gv_color(x11,lightsteelblue1).
+gv_color(x11,lightsteelblue2).
+gv_color(x11,lightsteelblue3).
+gv_color(x11,lightsteelblue4).
+gv_color(x11,lightyellow).
+gv_color(x11,lightyellow1).
+gv_color(x11,lightyellow2).
+gv_color(x11,lightyellow3).
+gv_color(x11,lightyellow4).
+gv_color(x11,limegreen).
+gv_color(x11,linen).
+gv_color(x11,magenta).
+gv_color(x11,magenta1).
+gv_color(x11,magenta2).
+gv_color(x11,magenta3).
+gv_color(x11,magenta4).
+gv_color(x11,maroon).
+gv_color(x11,maroon1).
+gv_color(x11,maroon2).
+gv_color(x11,maroon3).
+gv_color(x11,maroon4).
+gv_color(x11,mediumaquamarine).
+gv_color(x11,mediumblue).
+gv_color(x11,mediumorchid).
+gv_color(x11,mediumorchid1).
+gv_color(x11,mediumorchid2).
+gv_color(x11,mediumorchid3).
+gv_color(x11,mediumorchid4).
+gv_color(x11,mediumpurple).
+gv_color(x11,mediumpurple1).
+gv_color(x11,mediumpurple2).
+gv_color(x11,mediumpurple3).
+gv_color(x11,mediumpurple4).
+gv_color(x11,mediumseagreen).
+gv_color(x11,mediumslateblue).
+gv_color(x11,mediumspringgreen).
+gv_color(x11,mediumturquoise).
+gv_color(x11,mediumvioletred).
+gv_color(x11,midnightblue).
+gv_color(x11,mintcream).
+gv_color(x11,mistyrose).
+gv_color(x11,mistyrose1).
+gv_color(x11,mistyrose2).
+gv_color(x11,mistyrose3).
+gv_color(x11,mistyrose4).
+gv_color(x11,moccasin).
+gv_color(x11,navajowhite).
+gv_color(x11,navajowhite1).
+gv_color(x11,navajowhite2).
+gv_color(x11,navajowhite3).
+gv_color(x11,navajowhite4).
+gv_color(x11,navy).
+gv_color(x11,navyblue).
+gv_color(x11,none).
+gv_color(x11,oldlace).
+gv_color(x11,olivedrab).
+gv_color(x11,olivedrab1).
+gv_color(x11,olivedrab2).
+gv_color(x11,olivedrab3).
+gv_color(x11,olivedrab4).
+gv_color(x11,orange).
+gv_color(x11,orange1).
+gv_color(x11,orange2).
+gv_color(x11,orange3).
+gv_color(x11,orange4).
+gv_color(x11,orangered).
+gv_color(x11,orangered1).
+gv_color(x11,orangered2).
+gv_color(x11,orangered3).
+gv_color(x11,orangered4).
+gv_color(x11,orchid).
+gv_color(x11,orchid1).
+gv_color(x11,orchid2).
+gv_color(x11,orchid3).
+gv_color(x11,orchid4).
+gv_color(x11,palegoldenrod).
+gv_color(x11,palegreen).
+gv_color(x11,palegreen1).
+gv_color(x11,palegreen2).
+gv_color(x11,palegreen3).
+gv_color(x11,palegreen4).
+gv_color(x11,paleturquoise).
+gv_color(x11,paleturquoise1).
+gv_color(x11,paleturquoise2).
+gv_color(x11,paleturquoise3).
+gv_color(x11,paleturquoise4).
+gv_color(x11,palevioletred).
+gv_color(x11,palevioletred1).
+gv_color(x11,palevioletred2).
+gv_color(x11,palevioletred3).
+gv_color(x11,palevioletred4).
+gv_color(x11,papayawhip).
+gv_color(x11,peachpuff).
+gv_color(x11,peachpuff1).
+gv_color(x11,peachpuff2).
+gv_color(x11,peachpuff3).
+gv_color(x11,peachpuff4).
+gv_color(x11,peru).
+gv_color(x11,pink).
+gv_color(x11,pink1).
+gv_color(x11,pink2).
+gv_color(x11,pink3).
+gv_color(x11,pink4).
+gv_color(x11,plum).
+gv_color(x11,plum1).
+gv_color(x11,plum2).
+gv_color(x11,plum3).
+gv_color(x11,plum4).
+gv_color(x11,powderblue).
+gv_color(x11,purple).
+gv_color(x11,purple1).
+gv_color(x11,purple2).
+gv_color(x11,purple3).
+gv_color(x11,purple4).
+gv_color(x11,red).
+gv_color(x11,red1).
+gv_color(x11,red2).
+gv_color(x11,red3).
+gv_color(x11,red4).
+gv_color(x11,rosybrown).
+gv_color(x11,rosybrown1).
+gv_color(x11,rosybrown2).
+gv_color(x11,rosybrown3).
+gv_color(x11,rosybrown4).
+gv_color(x11,royalblue).
+gv_color(x11,royalblue1).
+gv_color(x11,royalblue2).
+gv_color(x11,royalblue3).
+gv_color(x11,royalblue4).
+gv_color(x11,saddlebrown).
+gv_color(x11,salmon).
+gv_color(x11,salmon1).
+gv_color(x11,salmon2).
+gv_color(x11,salmon3).
+gv_color(x11,salmon4).
+gv_color(x11,sandybrown).
+gv_color(x11,seagreen).
+gv_color(x11,seagreen1).
+gv_color(x11,seagreen2).
+gv_color(x11,seagreen3).
+gv_color(x11,seagreen4).
+gv_color(x11,seashell).
+gv_color(x11,seashell1).
+gv_color(x11,seashell2).
+gv_color(x11,seashell3).
+gv_color(x11,seashell4).
+gv_color(x11,sienna).
+gv_color(x11,sienna1).
+gv_color(x11,sienna2).
+gv_color(x11,sienna3).
+gv_color(x11,sienna4).
+gv_color(x11,skyblue).
+gv_color(x11,skyblue1).
+gv_color(x11,skyblue2).
+gv_color(x11,skyblue3).
+gv_color(x11,skyblue4).
+gv_color(x11,slateblue).
+gv_color(x11,slateblue1).
+gv_color(x11,slateblue2).
+gv_color(x11,slateblue3).
+gv_color(x11,slateblue4).
+gv_color(x11,slategray).
+gv_color(x11,slategray1).
+gv_color(x11,slategray2).
+gv_color(x11,slategray3).
+gv_color(x11,slategray4).
+gv_color(x11,slategrey).
+gv_color(x11,snow).
+gv_color(x11,snow1).
+gv_color(x11,snow2).
+gv_color(x11,snow3).
+gv_color(x11,snow4).
+gv_color(x11,springgreen).
+gv_color(x11,springgreen1).
+gv_color(x11,springgreen2).
+gv_color(x11,springgreen3).
+gv_color(x11,springgreen4).
+gv_color(x11,steelblue).
+gv_color(x11,steelblue1).
+gv_color(x11,steelblue2).
+gv_color(x11,steelblue3).
+gv_color(x11,steelblue4).
+gv_color(x11,tan).
+gv_color(x11,tan1).
+gv_color(x11,tan2).
+gv_color(x11,tan3).
+gv_color(x11,tan4).
+gv_color(x11,thistle).
+gv_color(x11,thistle1).
+gv_color(x11,thistle2).
+gv_color(x11,thistle3).
+gv_color(x11,thistle4).
+gv_color(x11,tomato).
+gv_color(x11,tomato1).
+gv_color(x11,tomato2).
+gv_color(x11,tomato3).
+gv_color(x11,tomato4).
+gv_color(x11,transparent).
+gv_color(x11,turquoise).
+gv_color(x11,turquoise1).
+gv_color(x11,turquoise2).
+gv_color(x11,turquoise3).
+gv_color(x11,turquoise4).
+gv_color(x11,violet).
+gv_color(x11,violetred).
+gv_color(x11,violetred1).
+gv_color(x11,violetred2).
+gv_color(x11,violetred3).
+gv_color(x11,violetred4).
+gv_color(x11,wheat).
+gv_color(x11,wheat1).
+gv_color(x11,wheat2).
+gv_color(x11,wheat3).
+gv_color(x11,wheat4).
+gv_color(x11,white).
+gv_color(x11,whitesmoke).
+gv_color(x11,yellow).
+gv_color(x11,yellow1).
+gv_color(x11,yellow2).
+gv_color(x11,yellow3).
+gv_color(x11,yellow4).
+gv_color(x11,yellowgreen).
+gv_color(svg,aliceblue).
+gv_color(svg,antiquewhite).
+gv_color(svg,aqua).
+gv_color(svg,aquamarine).
+gv_color(svg,azure).
+gv_color(svg,beige).
+gv_color(svg,bisque).
+gv_color(svg,black).
+gv_color(svg,blanchedalmond).
+gv_color(svg,blue).
+gv_color(svg,blueviolet).
+gv_color(svg,brown).
+gv_color(svg,burlywood).
+gv_color(svg,cadetblue).
+gv_color(svg,chartreuse).
+gv_color(svg,chocolate).
+gv_color(svg,coral).
+gv_color(svg,cornflowerblue).
+gv_color(svg,cornsilk).
+gv_color(svg,crimson).
+gv_color(svg,cyan).
+gv_color(svg,darkblue).
+gv_color(svg,darkcyan).
+gv_color(svg,darkgoldenrod).
+gv_color(svg,darkgray).
+gv_color(svg,darkgreen).
+gv_color(svg,darkgrey).
+gv_color(svg,darkkhaki).
+gv_color(svg,darkmagenta).
+gv_color(svg,darkolivegreen).
+gv_color(svg,darkorange).
+gv_color(svg,darkorchid).
+gv_color(svg,darkred).
+gv_color(svg,darksalmon).
+gv_color(svg,darkseagreen).
+gv_color(svg,darkslateblue).
+gv_color(svg,darkslategray).
+gv_color(svg,darkslategrey).
+gv_color(svg,darkturquoise).
+gv_color(svg,darkviolet).
+gv_color(svg,deeppink).
+gv_color(svg,deepskyblue).
+gv_color(svg,dimgray).
+gv_color(svg,dimgrey).
+gv_color(svg,dodgerblue).
+gv_color(svg,firebrick).
+gv_color(svg,floralwhite).
+gv_color(svg,forestgreen).
+gv_color(svg,fuchsia).
+gv_color(svg,gainsboro).
+gv_color(svg,ghostwhite).
+gv_color(svg,gold).
+gv_color(svg,goldenrod).
+gv_color(svg,gray).
+gv_color(svg,grey).
+gv_color(svg,green).
+gv_color(svg,greenyellow).
+gv_color(svg,honeydew).
+gv_color(svg,hotpink).
+gv_color(svg,indianred).
+gv_color(svg,indigo).
+gv_color(svg,ivory).
+gv_color(svg,khaki).
+gv_color(svg,lavender).
+gv_color(svg,lavenderblush).
+gv_color(svg,lawngreen).
+gv_color(svg,lemonchiffon).
+gv_color(svg,lightblue).
+gv_color(svg,lightcoral).
+gv_color(svg,lightcyan).
+gv_color(svg,lightgoldenrodyellow).
+gv_color(svg,lightgray).
+gv_color(svg,lightgreen).
+gv_color(svg,lightgrey).
+gv_color(svg,lightpink).
+gv_color(svg,lightsalmon).
+gv_color(svg,lightseagreen).
+gv_color(svg,lightskyblue).
+gv_color(svg,lightslategray).
+gv_color(svg,lightslategrey).
+gv_color(svg,lightsteelblue).
+gv_color(svg,lightyellow).
+gv_color(svg,lime).
+gv_color(svg,limegreen).
+gv_color(svg,linen).
+gv_color(svg,magenta).
+gv_color(svg,maroon).
+gv_color(svg,mediumaquamarine).
+gv_color(svg,mediumblue).
+gv_color(svg,mediumorchid).
+gv_color(svg,mediumpurple).
+gv_color(svg,mediumseagreen).
+gv_color(svg,mediumslateblue).
+gv_color(svg,mediumspringgreen).
+gv_color(svg,mediumturquoise).
+gv_color(svg,mediumvioletred).
+gv_color(svg,midnightblue).
+gv_color(svg,mintcream).
+gv_color(svg,mistyrose).
+gv_color(svg,moccasin).
+gv_color(svg,navajowhite).
+gv_color(svg,navy).
+gv_color(svg,oldlace).
+gv_color(svg,olive).
+gv_color(svg,olivedrab).
+gv_color(svg,orange).
+gv_color(svg,orangered).
+gv_color(svg,orchid).
+gv_color(svg,palegoldenrod).
+gv_color(svg,palegreen).
+gv_color(svg,paleturquoise).
+gv_color(svg,palevioletred).
+gv_color(svg,papayawhip).
+gv_color(svg,peachpuff).
+gv_color(svg,peru).
+gv_color(svg,pink).
+gv_color(svg,plum).
+gv_color(svg,powderblue).
+gv_color(svg,purple).
+gv_color(svg,red).
+gv_color(svg,rosybrown).
+gv_color(svg,royalblue).
+gv_color(svg,saddlebrown).
+gv_color(svg,salmon).
+gv_color(svg,sandybrown).
+gv_color(svg,seagreen).
+gv_color(svg,seashell).
+gv_color(svg,sienna).
+gv_color(svg,silver).
+gv_color(svg,skyblue).
+gv_color(svg,slateblue).
+gv_color(svg,slategray).
+gv_color(svg,slategrey).
+gv_color(svg,snow).
+gv_color(svg,springgreen).
+gv_color(svg,steelblue).
+gv_color(svg,tan).
+gv_color(svg,teal).
+gv_color(svg,thistle).
+gv_color(svg,tomato).
+gv_color(svg,turquoise).
+gv_color(svg,violet).
+gv_color(svg,wheat).
+gv_color(svg,white).
+gv_color(svg,whitesmoke).
+gv_color(svg,yellow).
+gv_color(svg,yellowgreen).
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
new file mode 100644
index 0000000..ac319dc
--- /dev/null
+++ b/prolog/gv/gv_color.pl
@@ -0,0 +1,68 @@
+:- module(
+  gv_color,
+  [
+    gv_color/2, % ?Colorscheme:oneof([svg,x11])
+                % ?Color:atom
+    color//1, % +Color:compound
+    colorList//1 % +Pairs:list(pair(compound,float))
+  ]
+).
+:- ensure_loaded(library(&#39;gv/gv_color.data&#39;)).
+
+/** &amp;lt;module&amp;gt; GraphViz color
+
+@author Wouter Beek
+@tbd Color value `transparent` is only available in the output formats
+     ps, svg, fig, vmrl, and the bitmap formats.
+@version 2015/08, 2015/10, 2016/02
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(lists)).
+:- use_module(library(os/file_ext)).
+
+
+
+
+
+% color(+Color:compound)// .
+% A *color* is represented by a compound term of one of the following forms:
+%   1. `rgb(Red:nonneg,Green:nonneg,Blue:nonneg)`
+%   2. `rgba(Red:nonneg,Green:nonneg,Blue:nonneg,Alpha:nonneg)`
+%   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
+
+color(rgb(Red,Green,Blue)) --&amp;gt; !,
+  &amp;quot;#&amp;quot;,
+  #(3, hex_color, [Red,Green,Blue]).
+color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
+  color(rgb(Red,Green,Blue)),
+  hex_color(Alpha).
+color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
+  #(3, hsv_color, [Hue,Saturation,Value]).
+color(Name) --&amp;gt;
+  {gv_color(_, Name)},
+  atom(Name).
+
+hex_color(I) --&amp;gt;
+  xinteger(I).
+
+hsv_color(D, Head, Tail):-
+  format(codes(Head,Tail), &#39;~2f&#39;, [D]).
+
+
+
+%! colorList(+Pairs:list(pair(compound,float)))// .
+
+colorList(L) --&amp;gt;
+  &#39;+&#39;(wc, L).
+
+wc(Color-Float) --&amp;gt;
+  color(Color),
+  (   wc_weight(Float)
+  ;   &amp;quot;&amp;quot;
+  ).
+
+wc_weight(Float) --&amp;gt;
+  &amp;quot;;&amp;quot;,
+  float(Float).
diff --git a/prolog/gv/gv_dom.pl b/prolog/gv/gv_dom.pl
new file mode 100644
index 0000000..30c4263
--- /dev/null
+++ b/prolog/gv/gv_dom.pl
@@ -0,0 +1,29 @@
+:- module(
+  gv_dom,
+  [
+    gv_dom/3 % +ExportG, -Dom, +Opts
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz DOM
+
+@author Wouter Beek
+@version 2015/07, 2016/01
+*/
+
+:- use_module(library(gv/gv_file)).
+:- use_module(library(option)).
+:- use_module(library(svg/svg_ext)).
+
+
+
+
+
+%! gv_dom(+ExportG, -Dom, +Opts) is det.
+
+gv_dom(ExportG, Dom, Opts1):-
+  % Make sure the file type of the output file is SvgDom.
+  merge_options([output(svg)], Opts1, Opts2),
+  graph_viz(ExportG, ToFile, Opts2),
+  svg_dom(ToFile, Dom),
+  delete_file(ToFile).
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
new file mode 100644
index 0000000..993fcee
--- /dev/null
+++ b/prolog/gv/gv_file.pl
@@ -0,0 +1,175 @@
+:- module(
+  gv_file,
+  [
+    graph_viz/2, % +ExportG, ?File
+    graph_viz/3  % +ExportG, ?File, +Opts
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz file
+
+@author Wouter Beek
+@version 2015/07, 2015/10-2015/11, 2016/01
+*/
+
+:- use_module(library(code_ext)).
+:- use_module(library(error)).
+:- use_module(library(gv/gv_graph)).
+:- use_module(library(option)).
+:- use_module(library(os/external_program)).
+:- use_module(library(os/process_ext)).
+:- use_module(library(string_ext)).
+
+:- predicate_options(graph_viz/3, 3, [
+     pass_to(file_to_gv/3, 3)
+   ]).
+:- predicate_options(file_to_gv/3, 3, [
+     method(+oneof([circo,dot,fdp,neato,osage,sfdp,twopi])),
+     output(+atom)
+   ]).
+
+:- dynamic(user:module_uses/2).
+:- multifile(user:module_uses/2).
+
+user:module_uses(gv_file, program(dot)).
+
+
+
+
+
+%! graph_viz(+ExportGraph:compound, ?File:atom) is det.
+%! graph_viz(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
+% Returns a file containing a GraphViz visualization of the given graph.
+%
+% The following options are supported:
+%   * method(+oneof([circo,dot,fdp,neato,osage,sfdp,twopi])
+%     The algorithm used by GraphViz for positioning the tree nodes.
+%     Default is `dot&#39;.
+%     For possible values see gv_method/1.
+%   * output(+atom)`
+%     The file type of the generated GraphViz file.
+%     Default is `pdf`.
+%     For possible values see gv_output_type/1.
+
+graph_viz(ExportG, File):-
+  graph_viz(ExportG, File, []).
+graph_viz(ExportG, File, Opts):-
+  once(phrase(gv_graph(ExportG), Cs)),
+
+  % Be thread-safe.
+  thread_self(Id),
+  string_list_concat([&amp;quot;gv_file&amp;quot;,Id], &amp;quot;_&amp;quot;, ThreadName),
+  absolute_file_name(ThreadName, TmpFile, [access(write),extensions([dot])]),
+  setup_call_cleanup(
+    open(TmpFile, write, Write, [encoding(utf8)]),
+    with_output_to(Write, put_codes(Cs)),
+    close(Write)
+  ),
+  file_to_gv(TmpFile, File, Opts).
+
+
+%! file_to_gv(
+%!   +InputFile:atom,
+%!   ?OutputFile:atom,
+%!   +Options:list(compound)
+%! ) is det.
+% Converts a GraphViz DOT file to an image file, using a specific
+% visualization method.
+
+file_to_gv(InputFile, OutputFile, Opts):-
+  var(OutputFile), !,
+  option(output(Ext), Opts, pdf),
+  file_name_extension(out, Ext, LocalName),
+  absolute_file_name(LocalName, OutputFile, Opts),
+  file_to_gv(InputFile, OutputFile, Opts).
+file_to_gv(InputFile, OutputFile, Opts):-
+  option(output(dot), Opts), !,
+  (   var(OutputFile)
+  -&amp;gt;  OutputFile = InputFile
+  ;   rename_file(InputFile, OutputFile)
+  ).
+file_to_gv(InputFile, OutputFile, Opts):-
+  % Typecheck for `method` option.
+  option(method(Method), Opts, dot),
+  findall(Method0, gv_method(Method0), Methods),
+  must_be(oneof(Methods), Method),
+
+  % Typecheck for `output` option.
+  option(output(OutputType), Opts, pdf),
+  findall(OutputType0, gv_output_type(OutputType0), OutputTypes),
+  must_be(oneof(OutputTypes), OutputType),
+
+  % Run the GraphViz conversion command in the shell.
+  format(atom(OutputTypeFlag), &amp;quot;-T~a&amp;quot;, [OutputType]),
+  format(atom(OutputFileFlag), &amp;quot;-o~a&amp;quot;, [OutputFile]),
+  run_process(
+    Method,
+    [OutputTypeFlag,file(InputFile),OutputFileFlag]
+  ).
+
+
+
+
+
+% HELPERS %
+
+gv_method(circo).
+gv_method(dot).
+gv_method(fdp).
+gv_method(neato).
+gv_method(osage).
+gv_method(sfdp).
+gv_method(twopi).
+
+
+gv_output_type(bmp).
+gv_output_type(canon).
+gv_output_type(dot).
+gv_output_type(gv).
+gv_output_type(xdot).
+gv_output_type(&#39;xdot1.2&#39;).
+gv_output_type(&#39;xdot1.4&#39;).
+gv_output_type(cgimage).
+gv_output_type(cmap).
+gv_output_type(eps).
+gv_output_type(exr).
+gv_output_type(fig).
+gv_output_type(gd).
+gv_output_type(gd2).
+gv_output_type(gif).
+gv_output_type(gtk).
+gv_output_type(ico).
+gv_output_type(imap).
+gv_output_type(cmapx).
+gv_output_type(imap_np).
+gv_output_type(cmapx_np).
+gv_output_type(ismap).
+gv_output_type(jp2).
+gv_output_type(jpg).
+gv_output_type(jpeg).
+gv_output_type(jpe).
+gv_output_type(pct).
+gv_output_type(pict).
+gv_output_type(pdf).
+gv_output_type(pic).
+gv_output_type(plain).
+gv_output_type(&#39;plain-ext&#39;).
+gv_output_type(png).
+gv_output_type(pov).
+gv_output_type(ps).
+gv_output_type(ps2).
+gv_output_type(psd).
+gv_output_type(sgi).
+gv_output_type(svg).
+gv_output_type(svgz).
+gv_output_type(tga).
+gv_output_type(tif).
+gv_output_type(tiff).
+gv_output_type(tk).
+gv_output_type(vml).
+gv_output_type(vmlz).
+gv_output_type(vrml).
+gv_output_type(wbmp).
+gv_output_type(webp).
+gv_output_type(xlib).
+gv_output_type(x11).
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
new file mode 100644
index 0000000..c95c9cc
--- /dev/null
+++ b/prolog/gv/gv_graph.pl
@@ -0,0 +1,252 @@
+:- module(
+  gv_graph,
+  [
+    gv_graph//1 % +Graph:compound
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz graph
+
+Generates GraphViz graphs in the DOT format based on
+a Prolog representation of a graph.
+
+In GraphViz vertices are called &#39;nodes&#39;.
+
+---
+
+@author Wouter Beek
+@version 2015/07, 2015/12
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(gv/gv_graph_comp)).
+:- use_module(library(lists)).
+:- use_module(library(option)).
+
+
+
+
+
+%! gv_graph(+Graph:compound)// is det.
+% Wrapper around gv_graph//2 with no indentation.
+
+gv_graph(G) --&amp;gt; gv_graph(G, 0).
+
+
+%! gv_graph(+Graph:compound, +Indent:nonneg)// is det.
+% The follow graph attributes are supported,
+% beyond the GraphViz attributes for graphs:
+%   * `directed(+boolean)`
+%      Whether the graph is directed (`true`) or undirected (`false`).
+%      Default: `false`.
+%   * `name(+GraphName:atom)`
+%   * `strict(+StrictGraph:boolean)`
+%      This forbids the creation of self-arcs and multi-edges;
+%      they are ignored in the input file.
+%      Only in combinattion with directionality `directed`.
+%
+% ```abnf
+% graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
+% ```
+%
+% `GraphTerm` is a compound term of the following form:
+% ```prolog
+% graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
+% ```
+%
+% `RankedVertexTerms` is a list of compound terms of the following form:
+% ```prolog
+% RankVertex-ContentVertices
+% ```
+%
+% @tbd Add support for subgraphs (arbitrary nesting).
+% @tbd Add support for escape strings:
+%      http://www.graphviz.org/doc/info/attrs.html#k:escString
+% @tbd Assert attributes that are generic with respect to a subgraph.
+% @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
+
+gv_graph(G1, I) --&amp;gt;
+  {
+    include_ranks(G1, G2),
+    G2 = graph(VTerms,RankedVTerms,ETerms,GAttrs1),
+    shared_attributes(VTerms, SharedVAttrs, NewVTerms),
+    shared_attributes(ETerms, SharedEAttrs, NewETerms),
+    add_default(GAttrs1, overlap(false), GAttrs2),
+    I = 0
+  },
+
+  % The first statement in the GraphViz output.
+  % States that this file represents a graph according to the GraphViz format.
+  tab(I),
+  
+  % Strictness.
+  {select_option(strict(Strict), GAttrs2, GAttrs3, false)},
+  gv_strict(Strict),
+  
+  % Directedness.
+  {select_option(directed(Directed), GAttrs3, GAttrs4, true)},
+  gv_graph_type(Directed),
+  &amp;quot; &amp;quot;,
+  
+  % Graph name.
+  (   {select_option(name(GName), GAttrs4, GAttrs5)}
+  -&amp;gt;  gv_id(GName),
+      &amp;quot; &amp;quot;
+  ;   {GAttrs5 = GAttrs4}
+  ),
+
+  % The body of the DOT file appears between curly braces.
+  &amp;quot;{\n&amp;quot;,
+
+  % The following lines are indented.
+  {NewI is I + 1},
+
+  % Attributes that apply to the graph as a whole.
+  gv_generic_attributes_statement(graph, NewI, GAttrs5),
+
+  % Attributes that are the same for all nodes.
+  gv_generic_attributes_statement(node, NewI, SharedVAttrs),
+
+  % Attributes that are the same for all edges.
+  gv_generic_attributes_statement(edge, NewI, SharedEAttrs),
+
+  % Only add a line_feed if some content was already written
+  % and some content is about to be written.
+  (   % Succeeds if no content was written.
+      {(GAttrs5 == [], SharedVAttrs == [], SharedEAttrs == [])}
+  -&amp;gt;  &amp;quot;&amp;quot;
+  ;   % Succeeds if no content is about to be written.
+      {(NewVTerms == [], RankedVTerms == [])}
+  -&amp;gt;  &amp;quot;&amp;quot;
+  ;   &amp;quot;\n&amp;quot;
+  ),
+
+  % The list of GraphViz nodes.
+  gv_node_statements(NewI, NewVTerms),
+  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; &amp;quot;\n&amp;quot;),
+
+  % The ranked GraphViz nodes (displayed at the same height).
+  gv_ranked_node_collections(NewI, RankedVTerms),
+  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; &amp;quot;\n&amp;quot;),
+
+  {
+    findall(
+      edge(FromId,ToId,[]),
+      (
+        nth0(J1, RankedVTerms, rank(vertex(FromId,_),_)),
+        nth0(J2, RankedVTerms, rank(vertex(ToId,_),_)),
+        % We assume that the rank vertices are nicely ordered.
+        succ(J1, J2)
+      ),
+      RankEdges
+    )
+  },
+
+  % The rank edges.
+  gv_edge_statements(NewI, Directed, RankEdges),
+
+  % The non-rank edges.
+  gv_edge_statements(NewI, Directed, NewETerms),
+  
+  % Note that we do not include a line_feed here.
+
+  % We want to indent the closing curly brace.
+  tab(I),
+  &amp;quot;}\n&amp;quot;.
+
+
+
+%! gv_edge_statements(
+%!   +Indent:nonneg,
+%!   +Directed:boolean,
+%!   +Statements:list(compound)
+%! )// is det.
+
+gv_edge_statements(I, Dir, L) --&amp;gt; *(gv_edge_statement(I, Dir), L).
+
+
+
+%! gv_edge_statements(+Indent:nonneg, +Statements:list(compound))// is det.
+
+gv_node_statements(I, L) --&amp;gt; *(gv_node_statement(I), L).
+
+
+
+%! gv_ranked_node_collections(+Indent:nonneg, +Collections:list)// is det.
+
+gv_ranked_node_collections(I, L) --&amp;gt; *(gv_ranked_node_collection(I), L).
+
+
+
+
+
+% HELPERS %
+
+%! add_default_option(
+%!   +Options:list(compound),
+%!   +Default:compound,
+%!   -NewOptions:list(compound)
+%! ) is det.
+
+add_default(L1, Opt, L2):-
+  Opt =.. [N,_Value],
+  Opt0 =.. [N,_FreshVar],
+  (   option(Opt0, L1)
+  -&amp;gt;  L2 = L1
+  ;   L2 = [Opt|L1]
+  ).
+
+
+
+%! gv_graph_type(+Directed:boolean)// is det.
+% The type of graph that is represented.
+
+gv_graph_type(false) --&amp;gt; !, &amp;quot;graph&amp;quot;.
+gv_graph_type(true)  --&amp;gt;    &amp;quot;digraph&amp;quot;.
+
+
+
+%! gv_strict(+Strict:boolean)// is det.
+% The keyword denoting that the graph is strict, i.e., has no self-arcs and
+% no multi-edges.
+% This only applies to directed graphs.
+
+gv_strict(false) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_strict(true)  --&amp;gt;    &amp;quot;strict &amp;quot;.
+
+
+
+%! invlude_ranges(+Graph:compound, -GraphWithRanks:compound) is det.
+% Ensures that there is a ranks components in
+% the graph-denoting compound term.
+
+include_ranks(graph(Vs,Rs,Es,L), graph(Vs,Rs,Es,L)):- !.
+include_ranks(graph(Vs,Es,L), graph(Vs,[],Es,L)).
+
+
+
+%! shared_attributes(
+%!   +Terms:list(compound),
+%!   -SharedAttributes:list(compound),
+%!   -NewTerms:list(compound)
+%! ) is det.
+
+shared_attributes(Ts1, Shared, Ts2):-
+  maplist(term_to_attrs, Ts1, L1),
+  extract_shared(L1, Shared),
+  maplist(remove_shared_attributes(Shared), L1, L2),
+  maplist(term_change_attrs, Ts1, L2, Ts2).
+
+term_to_attrs(edge(_,_,A), A).
+term_to_attrs(vertex(_,A), A).
+
+extract_shared([], []):- !.
+extract_shared(Argss, Shared):-
+  ord_intersection(Argss, Shared).
+
+remove_shared_attributes(Shared, Args1, Args2):-
+  ord_subtract(Args1, Shared, Args2).
+
+term_change_attrs(edge(From,To,_), A, edge(From,To,A)).
+term_change_attrs(vertex(Id,_), A, vertex(Id,A)).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
new file mode 100644
index 0000000..30ea9c5
--- /dev/null
+++ b/prolog/gv/gv_graph_comp.pl
@@ -0,0 +1,309 @@
+:- module(
+  gv_graph_comp,
+  [
+    gv_edge_statement//3, % +Indent:nonneg
+                          % +Directed:boolean
+                          % +Edge:compound
+    gv_generic_attributes_statement//3, % +Kind:oneof([edge,graph,node])
+                                        % +Indent:nonneg
+                                        % +CategoryAttributes:list(compound)
+    gv_id//1, % +Name:compound
+    gv_node_statement//2, % +Indent:nonneg
+                          % +Vertex:compound
+    gv_ranked_node_collection//2 % +Indent:nonneg
+                                 % +Rank
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz graph components
+
+```abnf
+attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
+a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
+```
+
+@author Wouter Beek
+@see http://www.graphviz.org/content/dot-language
+@version 2015/07-2015/08, 2015/10-2016/01
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(gv/gv_attrs)).
+:- use_module(library(gv/gv_html)).
+:- use_module(library(error)).
+:- use_module(library(lists)).
+:- use_module(library(ordsets)).
+
+
+
+
+
+%! gv_edge_statement(
+%!   +Indent:nonneg,
+%!   +Directed:boolean,
+%!   +Edge:compound
+%! )// is det.
+% A GraphViz statement describing an edge.
+%
+% @arg Indent The indentation level at which the edge statement is written.
+% @arg Directed Whether the graph is directed or not.
+% @arg GraphAttributes The attributes of the graph. Some of these attributes
+%      may be used in the edge statement (e.g., the colorscheme).
+% @arg Edge A compound term in the GIFormat, representing an edge.
+%
+% @tbd Instead of gv_node_id//1 we could have a gv_subgraph//1
+%      at the from and/or to location.
+% @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
+
+gv_edge_statement(I, Dir, edge(From,To,Attrs)) --&amp;gt;
+  tab(I),
+
+  gv_node_id(From), &amp;quot; &amp;quot;,
+  gv_edge_operator(Dir), &amp;quot; &amp;quot;,
+  gv_node_id(To), &amp;quot; &amp;quot;,
+
+  % We want `colorscheme/1` from the edges and
+  % `directionality/1` from the graph.
+  gv_attrs(edge, Attrs),
+  &amp;quot;\n&amp;quot;.
+
+%! gv_edge_operator(+Directed:boolean)// .
+% The binary edge operator between two vertices.
+% The operator that is used depends on whether the graph is directed or
+% undirected.
+%
+% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
+%      undirected (operator `--`).
+
+gv_edge_operator(Dir) --&amp;gt;
+  {must_be(boolean, Dir)},
+  ({Dir == false} -&amp;gt; &amp;quot;--&amp;quot; ; {Dir == true} -&amp;gt; &amp;quot;-&amp;gt;&amp;quot;).
+
+
+
+%! gv_generic_attributes_statement(
+%!   +Kind:oneof([edge,graph,node]),
+%!   +Indent:nonneg,
+%!   +CategoryAttrs
+%! )//
+% A GraphViz statement describing generic attributes for a category of items.
+%
+% @arg Kind The category of items for to the attributes apply.
+%      Possible values: `edge`, `graph`, and `node`.
+% @arg Indent An integer indicating the number of tabs.
+% @arg GraphAttributes A list of name-value pairs.
+% @arg CategoryAttributes A list of name-value pairs.
+%
+% ```
+% attr_stmt = (graph / node / edge) attr_list
+% ```
+
+gv_generic_attributes_statement(_, _, []) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
+  tab(I),
+  gv_kind(Kind), &amp;quot; &amp;quot;,
+  gv_attrs(Kind, Attrs),
+  &amp;quot;\n&amp;quot;, !.
+
+
+
+%! gv_kind(+Kind:oneof([edge,graph,node]))// .
+
+gv_kind(Kind) --&amp;gt; {must_be(oneof([edge,graph,node]), Kind)}, atom(Kind).
+
+
+
+%! gv_node_statement(+Indent:nonneg, +Vertex:compound)// is det.
+% A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
+
+gv_node_statement(I, vertex(Id,Attrs)) --&amp;gt;
+  tab(I),
+  gv_node_id(Id),
+  gv_attrs(node, Attrs),
+  &amp;quot;\n&amp;quot;.
+
+
+
+%! gv_ranked_node_collection(+Indent:nonneg, Rank:pair)// is det.
+
+gv_ranked_node_collection(I, RankVTerm-VTerms) --&amp;gt;
+  tab(I),
+  &amp;quot;{\n&amp;quot;,
+
+  % The rank attribute.
+  {NewI is I + 1},
+  tab(NewI),
+  gv_attr(subgraph, rank(same)),
+  &amp;quot;\n&amp;quot;,
+
+  % Vertice statements.
+  *(gv_node_statement(NewI), [RankVTerm|VTerms]),
+
+  % We want to indent the closing curly brace.
+  tab(I),
+  &amp;quot;\n}&amp;quot;.
+
+
+
+
+
+% HELPERS %
+
+%! gv_attrs(
+%!   +Kind:oneof([edge,graph,node]),
+%!   +Attributes:list(compound)
+%! )// is det.
+
+gv_attrs(Kind, L) --&amp;gt; &amp;quot;[&amp;quot;, *(gv_attr(Kind), L), &amp;quot;]&amp;quot;.
+
+
+%! gv_attr(+Context:oneof([edge,graph,node]), +Attribute:compound)// is det.
+% A single GraphViz attribute.
+% We assume that the attribute has already been validated.
+
+gv_attr(Context, Attr) --&amp;gt;
+  {Attr =.. [N,V]},
+  gv_id(N), &amp;quot;=&amp;quot;, gv_attr_value(Context, N=V), &amp;quot;;&amp;quot;.
+
+
+
+%! gv_id(+Id:compound)// is det.
+% Parse a GraphViz identifier.
+% There are 4 variants:
+%   1. Any string of alphabetic (`[a-zA-Z&#39;200-&#39;377]`) characters,
+%      underscores (`_`) or digits (`[0-9]`), not beginning with a digit.
+%   2. A numeral `[-]?(.[0-9]+ | [0-9]+(.[0-9]*)? )`.
+%   3. Any double-quoted string (`&amp;quot;...&amp;quot;`) possibly containing
+%      escaped quotes (`\&amp;quot;`).
+%      In quoted strings in DOT, the only escaped character is
+%      double-quote (`&amp;quot;`). That is, in quoted strings, the dyad `\&amp;quot;`
+%      is converted to `&amp;quot;`. All other characters are left unchanged.
+%      In particular, `\\` remains `\\`.
+%      Layout engines may apply additional escape sequences.
+%      Represented by a Prolog term of the form `double_quoted_string(ATOM)`.
+%   4. An HTML string (`&amp;lt;...&amp;gt;`).
+%      Represented by a Prolog term of the form `html_like_label(COMPOUND)`.
+%
+% @tbd Add support for HTML-like labels:
+%      http://www.graphviz.org/doc/info/shapes.html#html
+%      This requires an XML grammar!
+
+% HTML strings (assumed to be the same as HTML-like labels).
+gv_id(html_like_label(Content)) --&amp;gt; !,
+  gv_html_like_label(Content).
+% Double-quoted strings.
+% The quotes are already part of the given atom.
+gv_id(double_quoted_string(Atom)) --&amp;gt; !,
+  &amp;quot;\&amp;quot;&amp;quot;, atom(Atom), &amp;quot;\&amp;quot;&amp;quot;.
+% Numerals.
+gv_id(N) --&amp;gt;
+  {number(N)}, !,
+  {number_codes(N, Cs)},
+  Cs.
+% Alpha-numeric strings.
+gv_id(Atom) --&amp;gt;
+  {atom_codes(Atom, [H|T])},
+  gv_id_first(H),
+  gv_id_rest(T), !,
+  % Variant 1 identifiers should not be (case-variants of) a
+  % GraphViz keyword.
+  {\+ gv_keyword([H|T])}.
+
+
+%! gv_id_first(+First:code)// is det.
+% Generates the first character of a GraphViz identifier.
+
+gv_id_first(C)   --&amp;gt; alpha(C), !.
+gv_id_first(0&#39;_) --&amp;gt; &amp;quot;_&amp;quot;.
+
+
+%! gv_id_rest(+NonFirst:code)// is det.
+% Generates a non-first character of a GraphViz identifier.
+
+gv_id_rest([H|T])   --&amp;gt; alphadigit(H), !, gv_id_rest(T).
+gv_id_rest([0&#39;_|T]) --&amp;gt; &amp;quot;_&amp;quot;,           !, gv_id_rest(T).
+gv_id_rest([])      --&amp;gt; &amp;quot;&amp;quot;.
+
+
+
+%! gv_keyword(+Codes:list(code)) is semidet.
+% Succeeds if the given codes for a GraphViz reserved keyword.
+
+gv_keyword(Cs):-
+  % Obviously, the keywords do not occur on the difference list input.
+  % So we must use phrase/[2,3].
+  phrase(gv_keyword, Cs).
+
+
+%! gv_keyword// .
+% GraphViz has reserved keywords that cannot be used as identifiers.
+% GraphViz keywords are case-insensitive.
+
+gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
+
+
+
+%! gv_node_id(+NodeId:compound)// .
+% GraphViz node identifiers can be of the following two types:
+%   1. A GraphViz identifier, see gv_id//1.
+%   2. A GraphViz identifier plus a GraphViz port indicator, see gv_port//0.
+%
+% @tbd Add support for GraphViz port indicators
+%      inside GraphViz node identifiers.
+
+gv_node_id(Id) --&amp;gt; gv_id(Id), !.
+%gv_node_id(_) --&amp;gt; gv_id(_), gv_port.
+gv_node_id(Id) --&amp;gt; {type_error(gv_node_id, Id)}.
+
+
+
+%! gv_numeral(-Number)// is det.
+% ```bnf
+% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
+% ```
+
+gv_numeral(N) --&amp;gt;
+  (&amp;quot;-&amp;quot; -&amp;gt; {Sg = -1} ; {Sg = 1}),
+  (   &amp;quot;.&amp;quot;
+  -&amp;gt;  {I = 0}, +(digit, Ds), {pos_frac(Ds, Frac)}
+  ;   +(digit, Ds1), {pos_sum(Ds1, I)},
+      (&amp;quot;.&amp;quot; -&amp;gt; *(digit, Ds2), {pos_frac(Ds2, Frac)} ; {Frac = 0.0})
+  ),
+  {N is Sg * (I + Frac)}.
+
+
+
+%! gv_port// is det.
+
+gv_port --&amp;gt; gv_port_location, (gv_port_angle ; &amp;quot;&amp;quot;).
+gv_port --&amp;gt; gv_port_angle, (gv_port_location ; &amp;quot;&amp;quot;).
+gv_port --&amp;gt; &amp;quot;:&amp;quot;, gv_compass_pt(_).
+
+gv_port_angle --&amp;gt; &amp;quot;@&amp;quot;, gv_id(_).
+
+gv_port_location --&amp;gt; &amp;quot;:&amp;quot;, gv_id(_).
+gv_port_location --&amp;gt; &amp;quot;:[&amp;quot;, gv_id(_), &amp;quot;,&amp;quot;, gv_id(_), &amp;quot;]&amp;quot;.
+
+
+
+%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
+% ```
+% compass_pt : ( n | ne | e | se | s | sw | w | nw | c | _ )
+% ```
+
+gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
+gv_compass_pt(c)   --&amp;gt; &amp;quot;c&amp;quot;.
+gv_compass_pt(e)   --&amp;gt; &amp;quot;e&amp;quot;.
+gv_compass_pt(n)   --&amp;gt; &amp;quot;n&amp;quot;.
+gv_compass_pt(ne)  --&amp;gt; &amp;quot;ne&amp;quot;.
+gv_compass_pt(nw)  --&amp;gt; &amp;quot;nw&amp;quot;.
+gv_compass_pt(s)   --&amp;gt; &amp;quot;s&amp;quot;.
+gv_compass_pt(se)  --&amp;gt; &amp;quot;se&amp;quot;.
+gv_compass_pt(sw)  --&amp;gt; &amp;quot;sw&amp;quot;.
+gv_compass_pt(w)   --&amp;gt; &amp;quot;w&amp;quot;.
diff --git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
new file mode 100644
index 0000000..b5c1368
--- /dev/null
+++ b/prolog/gv/gv_html.pl
@@ -0,0 +1,255 @@
+:- module(
+  gv_html,
+  [
+    gv_html_like_label//1 % +Content:compound
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
+
+Grammar taken from the GraphViz Web site:
+
+```
+label :   text
+        | table
+text :   textitem
+       | text textitem
+textitem :   string
+           | &amp;lt;BR/&amp;gt;
+           | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+           | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+           | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+           | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+           | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+           | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+           | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+           | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+rows :   row
+       | rows row
+       | rows &amp;lt;HR/&amp;gt; row
+row: &amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
+cells :   cell
+        | cells cell
+        | cells &amp;lt;VR/&amp;gt; cell
+cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
+      | &amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
+```
+
+---
+
+@author Wouter Beek
+@see http://www.graphviz.org/content/node-shapes#html
+@version 2015/07, 2015/12
+*/
+
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(html/html_dcg)).
+
+
+
+
+
+%! gv_html_like_label(+Content:compound)// is det.
+
+gv_html_like_label(Content) --&amp;gt; &amp;quot;&amp;lt;&amp;quot;, label(Content), &amp;quot;&amp;gt;&amp;quot;.
+
+
+
+%! cell(+Contents:compound)// is det.
+% Supported attributes for `TD`:
+%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;`
+%   - `BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
+%   - `BGCOLOR=&amp;quot;color&amp;quot;`
+%   - `BORDER=&amp;quot;value&amp;quot;`
+%   - `CELLPADDING=&amp;quot;value&amp;quot;`
+%   - `CELLSPACING=&amp;quot;value&amp;quot;`
+%   - `COLOR=&amp;quot;color&amp;quot;`
+%   - `COLSPAN=&amp;quot;value&amp;quot;`
+%   - `FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;`
+%   - `GRADIENTANGLE=&amp;quot;value&amp;quot;`
+%   - `HEIGHT=&amp;quot;value&amp;quot;`
+%   - `HREF=&amp;quot;value&amp;quot;`
+%   - `ID=&amp;quot;value&amp;quot;`
+%   - `PORT=&amp;quot;portName&amp;quot;`
+%   - `ROWSPAN=&amp;quot;value&amp;quot;`
+%   - `SIDES=&amp;quot;value&amp;quot;`
+%   - `STYLE=&amp;quot;value&amp;quot;`
+%   - `TARGET=&amp;quot;value&amp;quot;`
+%   - `TITLE=&amp;quot;value&amp;quot;`
+%   - `TOOLTIP=&amp;quot;value&amp;quot;`
+%   - `VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;`
+%   - `WIDTH=&amp;quot;value&amp;quot;`
+%
+% Supported attributes for `IMG`:
+%   - `SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;`
+%   - `SRC=&amp;quot;value&amp;quot;`
+
+cell(td(Contents)) --&amp;gt; !,
+  cell(td([],Contents)).
+cell(td(Attrs1,Image)) --&amp;gt;
+  {(Image =.. [img,Attrs2] -&amp;gt; true ; Image == img -&amp;gt; Attrs2 = [])}, !,
+  html_element(td, Attrs1, html_element(img,Attrs2)).
+cell(td(Attrs,Contents)) --&amp;gt;
+  html_element(td, Attrs, label(Contents)).
+
+
+
+%! cells(+Contents:list(compound))// is det.
+
+cells([H,vr|T]) --&amp;gt; !, cell(H), html_element(vr), cells(T).
+cells([H|T])    --&amp;gt; !, cell(H), cells(T).
+cells([])       --&amp;gt; &amp;quot;&amp;quot;.
+
+
+
+%! label(+Content:compound)// is det.
+% GraphViz HTML-like label.
+
+label(Content) --&amp;gt; table(Content), !.
+label(Content) --&amp;gt; text(Content).
+
+
+
+%! row(+Contents:compound)// is det.
+
+row(tr(Contents)) --&amp;gt; html_element(tr, [], cells(Contents)).
+
+
+
+%! rows(+Contents:list)// is det.
+
+rows([hr|T]) --&amp;gt; !, html_element(hr), rows(T).
+rows([H|T]) --&amp;gt; row(H), !, rows(T).
+rows([]) --&amp;gt; &amp;quot;&amp;quot;.
+
+
+
+%! table(+Contents:compound)// is det.
+% ```
+% table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+% ```
+%
+% Supported attributes for `TABLE`:
+%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
+%   - `BGCOLOR=&amp;quot;color&amp;quot;`
+%   - `BORDER=&amp;quot;value&amp;quot;`
+%   - `CELLBORDER=&amp;quot;value&amp;quot;`
+%   - `CELLPADDING=&amp;quot;value&amp;quot;`
+%   - `CELLSPACING=&amp;quot;value&amp;quot;`
+%   - `COLOR=&amp;quot;color&amp;quot;`
+%   - `COLUMNS=&amp;quot;value&amp;quot;`
+%   - `FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;`
+%   - `GRADIENTANGLE=&amp;quot;value&amp;quot;`
+%   - `HEIGHT=&amp;quot;value&amp;quot;`
+%   - `HREF=&amp;quot;value&amp;quot;`
+%   - `ID=&amp;quot;value&amp;quot;`
+%   - `PORT=&amp;quot;portName&amp;quot;`
+%   - `ROWS=&amp;quot;value&amp;quot;`
+%   - `SIDES=&amp;quot;value&amp;quot;`
+%   - `STYLE=&amp;quot;value&amp;quot;`
+%   - `TARGET=&amp;quot;value&amp;quot;`
+%   - `TITLE=&amp;quot;value&amp;quot;`
+%   - `TOOLTIP=&amp;quot;value&amp;quot;`
+%   - `VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;`
+%   - `WIDTH=&amp;quot;value&amp;quot;`
+%
+% Supported attributes for `FONT`:
+%  - `COLOR=&amp;quot;color&amp;quot;`
+%    Sets the color of the font within the scope of `&amp;lt;FONT&amp;gt;...&amp;lt;/FONT&amp;gt;`,
+%     or the border color of the table or cell within the scope of
+%     `&amp;lt;TABLE&amp;gt;...&amp;lt;/TABLE&amp;gt;`, or `&amp;lt;TD&amp;gt;...&amp;lt;/TD&amp;gt;`.
+%    This color can be overridden by a `COLOR` attribute in descendents.
+%    By default, the font color is determined by the `fontcolor` attribute
+%     of the corresponding node, edge or graph, and the border color is
+%     determined by the color attribute of the corresponding node, edge or
+%     graph.
+%   - `FACE=&amp;quot;fontname&amp;quot;`
+%   - `POINT-SIZE=&amp;quot;value&amp;quot;`
+
+table(table(Contents)) --&amp;gt; !,
+  table(table([],Contents)).
+table(table(Attrs,Contents)) --&amp;gt; !,
+  html_element(table, Attrs, rows(Contents)).
+table(font(Table)) --&amp;gt; !,
+  table(font([],Table)).
+table(font(Attrs1,Table)) --&amp;gt;
+  {(  Table =.. [table,Attrs2,Contents]
+  -&amp;gt;  true
+  ;   Table =.. [table,Contents]
+  -&amp;gt;  Attrs2 = []
+  )},
+  html_element(font, Attrs1, table(table(Attrs2,Contents))).
+
+
+
+%! text(+Contents:list)// .
+% ```
+% text :   textitem
+%        | text textitem
+% ```
+
+text(Contents) --&amp;gt; {is_list(Contents)}, !, &#39;+&#39;(textitem, Contents).
+text(Content)  --&amp;gt; text([Content]).
+
+
+
+%! textitem(+Content:compound)// .
+% ```
+% textitem :   string
+%            | &amp;lt;BR/&amp;gt;
+%            | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+%            | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+%            | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+%            | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+%            | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+%            | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+%            | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+%            | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+% ```
+%
+% Supported attributes for BR:
+%   * `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
+%
+% Supported attributes for FONT:
+%   * COLOR=&amp;quot;color&amp;quot;
+%   * FACE=&amp;quot;fontname&amp;quot;
+%   * POINT-SIZE=&amp;quot;value&amp;quot;
+
+textitem(br(Attrs)) --&amp;gt; !,
+  html_element(br, Attrs).
+% Compound term: parser.
+textitem(Compound) --&amp;gt;
+  {var(Compound)}, !,
+  html_element(Name, _, text(Content)),
+  {
+    supported_html_element(Name),
+    Compound =.. [Name,Content]
+  }.
+% Compound term: generator.
+textitem(Compound) --&amp;gt;
+  {
+    Compound =.. [Name,Content], !,
+    supported_html_element(Name)
+  },
+  html_element(Name, _, text(Content)).
+textitem(String) --&amp;gt;
+  html_string(String).
+
+
+
+
+
+% HELPERS %
+
+%! supported_html_element(+Name:atom) is semidet.
+%! supported_html_element(-Name:atom) is multi.
+
+supported_html_element(b).
+supported_html_element(font).
+supported_html_element(i).
+supported_html_element(o).
+supported_html_element(s).
+supported_html_element(sub).
+supported_html_element(sup).
+supported_html_element(u).
diff --git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
new file mode 100644
index 0000000..4382aa6
--- /dev/null
+++ b/prolog/tree/tree_viz.pl
@@ -0,0 +1,65 @@
+:- module(
+  tree_viz,
+  [
+    tree_export_graph/2, % +Tree, ExportG
+    tree_export_graph/3, % +Tree, ExportG, +Opts
+    tree_viz/2,          % +Tree, ?File
+    tree_viz/3           % +Tree, ?File, +Opts
+  ]
+).
+
+/** &amp;lt;module&amp;gt; Tree visualization
+
+Export trees to GraphViz.
+
+@author Wouter Beek
+@version 2016/01-2016/02
+*/
+
+:- use_module(library(graph/build_export_graph)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(ordsets)).
+:- use_module(library(tree/l_tree)).
+:- use_module(library(tree/s_tree)).
+
+:- predicate_options(tree_export_graph/3, 3, [
+     pass_to(build_export_graph/4, 4)
+   ]).
+:- predicate_options(tree_viz/3, 3, [
+     pass_to(graph_viz/3, 3),
+     pass_to(tree_to_graph/3, 3)
+   ]).
+
+
+
+
+
+%! tree_export_graph(+Tree, -ExportG) is det.
+%! tree_export_graph(+Tree, -ExportG, +Opts) is det.
+% Opts are passed to build_export_graph/4.
+
+tree_export_graph(Tree, ExportG) :-
+  tree_export_graph(Tree, ExportG, []).
+
+tree_export_graph(Tree, ExportG, Opts) :-
+  (   is_s_tree(Tree)
+  -&amp;gt;  tree_to_graph(Tree, G)
+  ;   is_l_tree(Tree)
+  -&amp;gt;  l_tree_to_graph(Tree, G)
+  ),
+  build_export_graph(G, ExportG, Opts).
+
+
+
+%! tree_viz(+Tree, ?File) is det.
+%! tree_viz(+Tree, ?File, +Opts) is det.
+% Stores the given tree term into a GraphViz file.
+%
+% Options are passed to export_graph_to_gv_file/3, tree_to_graph/3.
+
+tree_viz(Tree, File) :-
+  tree_viz(Tree, File, []).
+
+tree_viz(Tree, File, Opts) :-
+  tree_export_graph(Tree, ExportG, Opts),
+  graph_viz(ExportG, File, Opts).
diff --git a/test/gv_attrs.log b/test/gv_attrs.log
new file mode 100644
index 0000000..a9c6010
--- /dev/null
+++ b/test/gv_attrs.log
@@ -0,0 +1,169 @@
+assert(gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;)).
+assert(gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(&#39;_background&#39;,[graph],[string],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;)).
+assert(gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(bgcolor,[cluster,graph],[color,colorList],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;)).
+assert(gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(inputscale,[graph],[double],_,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;)).
+assert(gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labeltarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;)).
+assert(gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;nslimit nslimit1&#39;,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;)).
+assert(gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;)).
+assert(gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;)).
+assert(gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;)).
+assert(gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;)).
+assert(gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(target,[cluster,edge,graph,node],[escString,string],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;)).
+assert(gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;)).
+assert(gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;)).
+assert(gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;)).
+assert(gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;)).
+assert(gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;)).
diff --git a/test/test.pl b/test/test.pl
new file mode 100644
index 0000000..83dc023
--- /dev/null
+++ b/test/test.pl
@@ -0,0 +1,15 @@
+%/fca
+:- use_module(library(fca/fca_viz)).
+%/graph
+:- use_module(library(graph/build_export_graph)).
+%/gv
+:- use_module(library(gv/gv_attrs)).
+:- use_module(library(gv/gv_attr_type)).
+:- use_module(library(gv/gv_color)).
+:- use_module(library(gv/gv_dom)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(gv/gv_graph)).
+:- use_module(library(gv/gv_graph_comp)).
+:- use_module(library(gv/gv_html)).
+%/tree
+:- use_module(library(tree/tree_viz)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;25&#34;&gt; 25: 正在比较变动前 6dc1cf5 和变动后 76ea35d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index bd24270..b25c15b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,3 +1 @@
 *~
-*#
-*.db
diff --git a/.gitmodules b/.gitmodules
new file mode 100644
index 0000000..a63cbff
--- /dev/null
+++ b/.gitmodules
@@ -0,0 +1,6 @@
+[submodule &amp;quot;Prolog-Library-Collection&amp;quot;]
+	path = Prolog-Library-Collection
+	url = https://github.com/wouterbeek/Prolog-Library-Collection.git
+[submodule &amp;quot;plHtml&amp;quot;]
+	path = plHtml
+	url = https://github.com/wouterbeek/plHtml.git
diff --git a/LICENSE.txt b/LICENSE.txt
deleted file mode 100644
index c7b7798..0000000
--- a/LICENSE.txt
+++ /dev/null
@@ -1,21 +0,0 @@
-The MIT License (MIT)
-
-Copyright (c) 2015 Wouter Beek
-
-Permission is hereby granted, free of charge, to any person obtaining a copy
-of this software and associated documentation files (the &amp;quot;Software&amp;quot;), to deal
-in the Software without restriction, including without limitation the rights
-to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
-copies of the Software, and to permit persons to whom the Software is
-furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in
-all copies or substantial portions of the Software.
-
-THE SOFTWARE IS PROVIDED &amp;quot;AS IS&amp;quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
-IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
-FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
-AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
-LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
-OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
-THE SOFTWARE.
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
new file mode 160000
index 0000000..5b34b01
--- /dev/null
+++ b/Prolog-Library-Collection
@@ -0,0 +1 @@
+Subproject commit 5b34b01ab0cc82a56e6fd90fc26e75da22f5a0fe
diff --git a/README.md b/README.md
deleted file mode 100644
index 23a45db..0000000
--- a/README.md
+++ /dev/null
@@ -1,151 +0,0 @@
-plGraphViz
-==========
-
-This library allows you to easily export graphs represented as Prolog terms
-using [GraphViz](http://www.graphviz.org/), an advanced graph drawing library.
-The Prolog terms have the following form:
-
-~~~prolog
-graph(Vertices, Edges, GraphAttrs)
-~~~
-
-`Vertices` and `Edges` are lists of compound terms of the following form:
-
-~~~prolog
-vertex(Id, VertexAttrs)
-edge(FromId, ToId, EdgeAttrs)
-~~~
-
-`Id` identifies a vertex and may or may not occur in any of the edges
-(i.e., unconnected vertices are allowed).
-`FromId` and `ToId` may occur in the list of vertices,
-in order to draw an edge between vertices with set attributes.
-
-Attributes have the form `Name=Value`.
-`GraphAttrs` are attributes of the graph.
-`VertexAttrs` are attributes of the vertex.
-`EdgeAttrs` are attributes of the edge.
-
-Attribute values are given as Prolog terms as well,
-and are type-checked before exporting.
-Many of the GraphViz attributes are supported.
-New ones are added on an as-needed bases
-(open an issue on Github if you want to see a specific feature added!).
-HTML-like labels are supported, allowing complex tables to be shown
-inside vertices.
-
----
-
-### Installation
-
-~~~shell
-$ git clone https://github.com/wouterbeek/plGraphViz.git
-$ cd plGraphViz
-$ git submodule update --init
-~~~
-
-### Example
-
-~~~prolog
-$ swipl run.pl
-?- export_graph_to_gv_file(
-     graph([vertex(1,[]),vertex(2,[])],[edge(1,2,[])],[]),
-     File,
-     [method(sfdp),output(png)]
-   ).
-   File = &#39;PATH/plGraphViz/data/tmp.png&#39;
-~~~
-
-![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example1.png &amp;quot;Example graph.&amp;quot;)
-
-The graphic can be saved to a different file by instantiating
-the `File` argument.
-
----
-
-### &#39;Method&#39; option
-
-Option `method(+atom)` sets the drawing method that is used by GraphViz
- to place the vertices and edges.
-The following values are supported.
-
-| **Value**       | **Description**         |
-| `circo`         | Circular layout.        |
-| `dot` (default) | Directed graph.         |
-| `fdp`           | Undirected graph.       |
-| `neato`         | Undirected graph.       |
-| `osage`         | Tree map.               |
-| `sfdp`          | Large undirected graph. |
-| `twopi`         | Radical layouts.        |
-
----
-
-### &#39;Output&#39; option
-
-Option `output(+atom)` sets the type of file the graph is written to.
-The following values are supported.
-
-| **Value**             | **Description**                       |
-|:---------------------:|:--------------------------------------|
-| `bmp`                 | Windows Bitmap Format                 |
-| `canon`               |                                       |
-| `dot`                 |                                       |
-| `gv`,  `xdot`, `xdot1.2`, `xdot1.4` | DOT                     |
-| `cgimage`             | CGImage bitmap format                 |
-| `cmap`                | Client-side imagemap (deprecated)     |
-| `eps`                 | Encapsulated PostScript               |
-| `exr`                 | OpenEXR                               |
-| `fig`                 |                                       |
-| `gd`, `gd2`           | GD/GD2 formats                        |
-| `gif`                 |                                       |
-| `gtk`                 | GTK canvas                            |
-| `ico`                 | Icon Image File Format                |
-| `imap`                |                                       |
-| `cmapx`               | Server-side and client-side imagemaps |
-| `imap_np`, `cmapx_np` | Server-side and client-side imagemaps |
-| `ismap`               | Server-side imagemap (deprecated)     |
-| `jp2`                 | JPEG 2000                             |
-| `jpg`, `jpeg`, `jpe`  | JPEG                                  |
-| `pct`, `pict`         | PICT                                  |
-| `pdf` (default)       | Portable Document Format (PDF)        |
-| `pic`                 | Kernighan&#39;s PIC graphics language     |
-| `plain`, `plain-ext`  | Simple text format                    |
-| `png`                 | Portable Network Graphics format      |
-| `pov`                 | POV-Ray markup language (prototype)   |
-| `ps`                  | PostScript                            |
-| `ps2`                 | PostScript for PDF                    |
-| `psd`                 | PSD                                   |
-| `sgi`                 | SGI                                   |
-| `svg`, `svgz`         | Scalable Vector Graphics              |
-| `tga`                 | Truevision TGA                        |
-| `tif`, `tiff`         | TIFF (Tag Image File Format)          |
-| `tk`                  | TK graphics                           |
-| `vml`, `vmlz`         | Vector Markup Language (VML)          |
-| `vrml`                | VRML                                  |
-| `wbmp`                | Wireless BitMap format                |
-| `webp`                | Image format for the Web              |
-| `xlib`, `x11`         | Xlib canvas                           |
-
----
-
-### HTML-like labels
-
-Example of using HTML-like labels:
-
-~~~prolog
-export_graph_to_gv_file(
-  graph(
-    [vertex(1,[]),vertex(2,[label=html(table([tr([td(a),td(b)]),tr([td(c),td(d)])]))])],
-    [edge(1,2,[label=&#39;From 1 to 2.&#39;])],
-    []
-  ),
-  File,
-  []
-).
-~~~
-
-![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example2.png &amp;quot;Example graph with HTML-like labels.&amp;quot;)
-
----
-
-Developed during 2013-2014 by [Wouter Beek](http://www.wouterbeek.com).
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
deleted file mode 100644
index bcc7654..0000000
--- a/data/gv_attrs_scrape.pl
+++ /dev/null
@@ -1,119 +0,0 @@
-:- module(
-  gv_attrs_scrape,
-  [
-    gv_attrs_scrape/1 % +File
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz: Scrape attributes
-
-Writes compound terms of the following form to file:
-
-```prolog
-gv_attr(
-  ?Name,
-  ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
-  ?Types:list(atom),
-  ?Default,
-  ?Minimum,
-  ?Notes
-) is nondet.
-```
-
-@author Wouter Beek
-@version 2015/10, 2016/07
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(debug)).
-:- use_module(library(gv/gv_attr_type)).
-:- use_module(library(http/http_download)).
-:- use_module(library(lists)).
-:- use_module(library(os/io)).
-:- use_module(library(pl_term)).
-:- use_module(library(print_ext)).
-:- use_module(library(xpath)).
-:- use_module(library(xpath/xpath_table)).
-:- use_module(library(yall)).
-
-
-
-
-
-%! gv_attrs_scrape(+File) is det.
-
-gv_attrs_scrape(File):-
-  debug(gv, &amp;quot;Updating the GraphViz attributes table.&amp;quot;, []),
-  call_to_stream(File, [In,Meta,Meta]&amp;gt;&amp;gt;gv_attrs_download(In)).
-
-
-gv_attrs_download(Write):-
-  gv_attrs_iri(Iri),
-  html_download(Iri, Dom),
-  xpath_chk(Dom, //table(@align=lower_case(center)), TableDom),
-  xpath_table(TableDom, _, Rows),
-  maplist(write_attr_row(Write), Rows).
-
-
-write_attr_row(Write, [Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
-  atom_phrase(translate_usedby(UsedBy2), UsedBy1),
-  once(atom_phrase(translate_type(Types2), Types1)),
-  sort(UsedBy2, UsedBy3),
-  translate_default(Default1, Default2),
-  with_output_to(
-    Write,
-    write_fact(gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes))
-  ).
-
-gv_attrs_iri(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
-
-
-
-
-
-% HELPERS %
-
-%! translate_default(+Default1, -Default2) is det.
-
-% The empty string is represented by the empty atom.
-translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
-% The absence of a default value is represented by an uninstantiated variable.
-translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
-translate_default(Default, Default).
-
-
-
-%! translate_type(-Types:list(atom))// is det.
-
-translate_type([H|T]) --&amp;gt;
-  gv_attr_type(H),
-  whites,
-  translate_type(T).
-translate_type([H]) --&amp;gt;
-  gv_attr_type(H).
-translate_type([]) --&amp;gt; &amp;quot;&amp;quot;.
-
-
-
-%! translated_usedby(
-%!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
-%! )// is det.
-
-translate_usedby([cluster|T]) --&amp;gt;
-  &amp;quot;C&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([edge|T]) --&amp;gt;
-  &amp;quot;E&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([graph|T]) --&amp;gt;
-  &amp;quot;G&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([node|T]) --&amp;gt;
-  &amp;quot;N&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([subgraph|T]) --&amp;gt;
-  &amp;quot;S&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([]) --&amp;gt;
-  &amp;quot;&amp;quot;.
diff --git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
deleted file mode 100644
index 102a02a..0000000
--- a/data/gv_color_scrape.pl
+++ /dev/null
@@ -1,52 +0,0 @@
-:- module(
-  gv_color_scrape,
-  [
-    gv_color_scrape/1 % +File
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz: Scrape colors
-
-@author Wouter Beek
-@version 2015/10, 2016/07
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(debug)).
-:- use_module(library(http/http_download)).
-:- use_module(library(lists)).
-:- use_module(library(os/io)).
-:- use_module(library(pl_term)).
-:- use_module(library(print_ext)).
-:- use_module(library(xpath)).
-:- use_module(library(xpath/xpath_table)).
-:- use_module(library(yall)).
-
-
-
-
-
-%! gv_color_scrape(+File) is det.
-
-gv_color_scrape(File):-
-  debug(io, &amp;quot;Updating the GraphViz color table.&amp;quot;, []),
-  call_to_stream(File, [In,Meta,Meta]&amp;gt;&amp;gt;gv_color_download(In)).
-
-
-gv_color_download(Write):-
-  gv_color_iri(Iri),
-  html_download(Iri, Dom),
-  xpath_chk(Dom, //table(1), TableDom1),
-  xpath_chk(Dom, //table(2), TableDom2),
-  maplist(write_color_table(Write), [x11,svg], [TableDom1,TableDom2]).
-
-
-write_color_table(Write, Colorscheme, TableDom):-
-  xpath_table(TableDom, _, Rows),
-  append(Rows, Cells),
-  forall(
-    member(Cell, Cells),
-    with_output_to(Write, write_fact(gv_color(Colorscheme, Cell)))
-  ).
-
-gv_color_iri(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
diff --git a/example1.png b/example1.png
deleted file mode 100644
index 31e7ba6..0000000
Binary files a/example1.png and /dev/null differ
diff --git a/example2.png b/example2.png
deleted file mode 100644
index 6e44b16..0000000
Binary files a/example2.png and /dev/null differ
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
new file mode 100644
index 0000000..7a64c82
--- /dev/null
+++ b/gv_attr_type.pl
@@ -0,0 +1,417 @@
+:- module(
+  gv_attr_type,
+  [
+    gv_attr_type/1, % ?Type:atom
+    addDouble//1, % +Double:float
+    addPoint//1, % +Point:compound
+    arrowType//1, % +ArrowType:atom
+    bool//1, % +Boolean:boolean
+    clusterMode//1, % +ClusterMode:atom
+    dirType//1, % +DirectionType:oneof([back,both,forward,none])
+    double//1, % +Double:float
+    doubleList//1, % +Doubles:list(float)
+    escString//1,
+    %layerList//1,
+    %layerRange//1,
+    lblString//1,
+    int//1, % +Integer:integer
+    outputMode//1, % +OutputMode:atom
+    %packMode//1,
+    pagedir//1, % +Pagedir:atom
+    point//1, % +Point:compound
+    pointList//1, % +Points:list(compound)
+    %portPos//1,
+    quadType//1, % +QuadType:atom
+    rankType//1, % +RankType:atom
+    rankdir//1, % +RankDirection:atom
+    rect//1, % +Rectangle:compound
+    shape//1,
+    smoothType//1, % +SmoothType:atom
+    %splineType//1,
+    %startType//1,
+    string//1, % ?Content:atom
+    style//2 % +Context:oneof([cluster,edge,node])
+             % +Style:atom
+    %viewPort//1
+  ]
+).
+:- reexport(
+  plGraphViz(gv_color),
+  [
+    color//1, % +Color:compound
+    colorList//1 % +ColorList:list(compound)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz attribute types
+
+@author Wouter Beek
+@version 2014/06
+*/
+
+:- use_module(dcg(dcg_abnf)).
+:- use_module(dcg(dcg_cardinal)).
+:- use_module(dcg(dcg_content)).
+
+:- use_module(plGraphViz(gv_html)).
+
+
+
+%! gv_attr_type(?Type:atom) is nondet.
+
+gv_attr_type(addDouble).
+gv_attr_type(addPoint).
+gv_attr_type(arrowType).
+gv_attr_type(bool).
+gv_attr_type(color).
+gv_attr_type(colorList).
+gv_attr_type(clusterMode).
+gv_attr_type(dirType).
+gv_attr_type(double).
+gv_attr_type(doubleList).
+gv_attr_type(escString).
+gv_attr_type(layerList).
+gv_attr_type(layerRange).
+gv_attr_type(lblString).
+gv_attr_type(int).
+gv_attr_type(outputMode).
+gv_attr_type(packMode).
+gv_attr_type(pagedir).
+gv_attr_type(point).
+gv_attr_type(pointList).
+gv_attr_type(portPos).
+gv_attr_type(quadType).
+gv_attr_type(rankType).
+gv_attr_type(rankdir).
+gv_attr_type(rect).
+gv_attr_type(shape).
+gv_attr_type(smoothType).
+gv_attr_type(splineType).
+gv_attr_type(startType).
+gv_attr_type(string).
+gv_attr_type(style).
+gv_attr_type(viewPort).
+
+
+%! addDouble(+Float:float)// .
+% An *addDouble* is represented by a Prolog float.
+
+addDouble(Float) --&amp;gt;
+  &#39;?&#39;(`+`),
+  double(Float).
+
+
+%! addPoint(+Point:compound)// .
+% An *addPoint* is represented by a compound of the following form:
+% `point(X:float,Y:float,InputOnly:boolean)`.
+
+addPoint(Point) --&amp;gt;
+  &#39;?&#39;(`+`),
+  point(Point).
+
+
+%! arrowType(+ArrowType:atom)// .
+
+arrowType(V) --&amp;gt;
+  {arrowType(V)},
+  atom(V).
+
+arrowType(V):-
+  primitive_shape(V).
+arrowType(V):-
+  derived(V).
+arrowType(V):-
+  backwards_compatible(V).
+
+primitive_shape(box).
+primitive_shape(crow).
+primitive_shape(circle).
+primitive_shape(diamond).
+primitive_shape(dot).
+primitive_shape(inv).
+primitive_shape(none).
+primitive_shape(normal).
+primitive_shape(tee).
+primitive_shape(vee).
+
+derived(odot).
+derived(invdot).
+derived(invodot).
+derived(obox).
+derived(odiamond).
+
+backwards_compatible(ediamond).
+backwards_compatible(empty).
+backwards_compatible(halfopen).
+backwards_compatible(invempty).
+backwards_compatible(open).
+
+
+bool(false) --&amp;gt; `false`.
+bool(false) --&amp;gt; `no`.
+bool(true) --&amp;gt; `true`.
+bool(true) --&amp;gt; `yes`.
+
+
+%! clusterMode(+ClusterMode:atom)// .
+
+clusterMode(V) --&amp;gt;
+  {clusterMode(V)},
+  atom(V).
+
+clusterMode(global).
+clusterMode(local).
+clusterMode(none).
+
+
+%! dirType(+DirectionType:oneof([back,both,forward,none]))// .
+
+dirType(DirType) --&amp;gt;
+  {dirType(DirType)},
+  atom(DirType).
+
+dirType(back).
+dirType(both).
+dirType(forward).
+dirType(none).
+
+
+double(Double1) --&amp;gt;
+  % float//1 will check for float type.
+  {Double2 is Double1 * 1.0},
+  float(Double2).
+
+
+doubleList([H|T]) --&amp;gt;
+  double(H),
+  &#39;*&#39;(doubleList1, T).
+
+doubleList1(Float) --&amp;gt;
+  `:`,
+  double(Float).
+
+
+%! escString(+String:atom)// .
+% @tbd Support for context-dependent replacements.
+
+escString(String) --&amp;gt;
+  atom(String).
+
+
+% @tbd layerList
+
+
+% @tbd layerRange
+
+
+lblString(V) --&amp;gt;
+  escString(V).
+lblString(V) --&amp;gt;
+  gv_html_like_label(V).
+
+
+int(V) --&amp;gt;
+  integer(V).
+
+
+outputMode(V) --&amp;gt;
+  {outputMode(V)},
+  atom(V).
+
+outputMode(breadthfirst).
+outputMode(edgesfirst).
+outputMode(nodesfirst).
+
+
+% @tbd packMode
+
+
+pagedir(V) --&amp;gt;
+  {pagedir(V)},
+  atom(V).
+
+pagedir(&#39;BL&#39;).
+pagedir(&#39;BR&#39;).
+pagedir(&#39;LB&#39;).
+pagedir(&#39;LT&#39;).
+pagedir(&#39;RB&#39;).
+pagedir(&#39;RT&#39;).
+pagedir(&#39;TL&#39;).
+pagedir(&#39;TR&#39;).
+
+
+%! point(+Point:compound)// .
+% A *point* is represented by a compound of the following form:
+% `point(X:float,Y:float,InputOnly:boolean)`.
+
+point(point(X,Y,InputOnly)) --&amp;gt;
+  float(X),
+  `,`,
+  float(Y),
+  input_only(InputOnly).
+
+input_only(false) --&amp;gt; [].
+input_only(true) --&amp;gt; `!`.
+
+
+pointList(Points) --&amp;gt;
+  &#39;*&#39;(point, Points).
+
+
+% @tbd portPos
+
+
+quadType(V) --&amp;gt;
+  {quadType(V)},
+  atom(V).
+
+quadType(fast).
+quadType(none).
+quadType(normal).
+
+
+rankType(V) --&amp;gt;
+  {rankType(V)},
+  atom(V).
+
+rankType(max).
+rankType(min).
+rankType(same).
+rankType(sink).
+rankType(source).
+
+
+rankdir(V) --&amp;gt;
+  {rankdir(V)},
+  atom(V).
+
+rankdir(&#39;BT&#39;).
+rankdir(&#39;LR&#39;).
+rankdir(&#39;RL&#39;).
+rankdir(&#39;TB&#39;).
+
+
+rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
+  float(LowerLeftX), `,`,
+  float(LowerLeftY), `,`,
+  float(UpperRightX), `,`,
+  float(UpperRightY).
+
+
+shape(V) --&amp;gt;
+  {polygon_based_shape(V)},
+  atom(V).
+
+polygon_based_shape(assembly).
+polygon_based_shape(box).
+polygon_based_shape(box3d).
+polygon_based_shape(cds).
+polygon_based_shape(circle).
+polygon_based_shape(component).
+polygon_based_shape(diamond).
+polygon_based_shape(doublecircle).
+polygon_based_shape(doubleoctagon).
+polygon_based_shape(egg).
+polygon_based_shape(ellipse).
+polygon_based_shape(fivepoverhang).
+polygon_based_shape(folder).
+polygon_based_shape(hexagon).
+polygon_based_shape(house).
+polygon_based_shape(insulator).
+polygon_based_shape(invhouse).
+polygon_based_shape(invtrapezium).
+polygon_based_shape(invtriangle).
+polygon_based_shape(larrow).
+polygon_based_shape(lpromoter).
+polygon_based_shape(&#39;Mcircle&#39;).
+polygon_based_shape(&#39;Mdiamond&#39;).
+polygon_based_shape(&#39;Msquare&#39;).
+polygon_based_shape(none).
+polygon_based_shape(note).
+polygon_based_shape(noverhang).
+polygon_based_shape(octagon).
+polygon_based_shape(oval).
+polygon_based_shape(parallelogram).
+polygon_based_shape(pentagon).
+polygon_based_shape(plaintext).
+polygon_based_shape(point).
+polygon_based_shape(polygon).
+polygon_based_shape(primersite).
+polygon_based_shape(promoter).
+polygon_based_shape(proteasesite).
+polygon_based_shape(proteinstab).
+polygon_based_shape(rarrow).
+polygon_based_shape(rect).
+polygon_based_shape(rectangle).
+polygon_based_shape(restrictionsite).
+polygon_based_shape(ribosite).
+polygon_based_shape(rnastab).
+polygon_based_shape(rpromoter).
+polygon_based_shape(septagon).
+polygon_based_shape(signature).
+polygon_based_shape(square).
+polygon_based_shape(tab).
+polygon_based_shape(terminator).
+polygon_based_shape(threepoverhang).
+polygon_based_shape(trapezium).
+polygon_based_shape(triangle).
+polygon_based_shape(tripleoctagon).
+polygon_based_shape(utr).
+
+
+smoothType(V) --&amp;gt;
+  {smoothType(V)},
+  atom(V).
+
+smoothType(avg_dist).
+smoothType(graph_dist).
+smoothType(none).
+smoothType(power_dist).
+smoothType(rng).
+smoothType(spring).
+smoothType(triangle).
+
+
+% @tbd splineType
+
+
+% @tbd startType
+
+
+%! string(?Content:atom)// .
+% A GraphViz string.
+
+string(Content) --&amp;gt;
+  atom(Content).
+
+
+%! style(?Context:oneof([cluster,edge,node]), ?Style:atom) is nondet.
+
+style(Context, Style) --&amp;gt;
+  {style(Context, Style)},
+  atom(Style).
+
+style(cluster, bold).
+style(cluster, dashed).
+style(cluster, dotted).
+style(cluster, filled).
+style(cluster, rounded).
+style(cluster, solid).
+style(cluster, striped).
+style(edge, bold).
+style(edge, dashed).
+style(edge, dotted).
+style(edge, solid).
+style(node, bold).
+style(node, dashed).
+style(node, diagonals).
+style(node, dotted).
+style(node, filled).
+style(node, rounded).
+style(node, solid).
+style(node, striped).
+style(node, wedged).
+
+
+% @tbd viewPort
+
diff --git a/gv_attrs.pl b/gv_attrs.pl
new file mode 100644
index 0000000..dd0145a
--- /dev/null
+++ b/gv_attrs.pl
@@ -0,0 +1,184 @@
+:- module(
+  gv_attrs,
+  [
+    gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
+              % +Attr1:nvpair
+              % +Attr2:nvpair
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz attributes v2
+
+@author Wouter Beek
+@version 2014/06
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(persistency)).
+:- use_module(library(xpath)).
+
+:- use_module(dcg(dcg_content)).
+:- use_module(dcg(dcg_generic)).
+:- use_module(generics(db_ext)).
+:- use_module(os(file_ext)).
+
+:- use_module(plHtml(html)).
+:- use_module(plHtml(html_table)).
+
+:- use_module(plGraphViz(gv_attr_type)). % DCGs implementing attribute types.
+
+:- db_add_novel(user:prolog_file_type(log, logging)).
+
+%! gv_attr(
+%!   ?Name:atom,
+%!   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
+%!   ?Types:list(atom),
+%!   ?Default,
+%!   ?Minimum,
+%!   ?Notes:atom
+%! ) is nondet.
+
+:- persistent(
+  gv_attr(
+    name:atom,
+    used_by:list(oneof([cluster,edge,graph,node,subgraph])),
+    types:list(atom),
+    default,
+    minimum,
+    notes:atom
+  )
+).
+
+:- initialization(gv_attrs_init).
+
+
+
+gv_attr(Context, N=V, N=V):-
+  var(V), !,
+  gv_attr(N, UsedBy, _, V, _, _),
+  memberchk(Context, UsedBy).
+gv_attr(Context, N=V1, N=V2):-
+  gv_attr(N, UsedBy, Types, _, Minimum, _),
+  memberchk(Context, UsedBy),
+  member(Type, Types),
+  (
+    Type == style
+  -&amp;gt;
+    Dcg =.. [Type,Context,V1]
+  ;
+    Dcg =.. [Type,V1]
+  ),
+  once(dcg_phrase(Dcg, V2)),
+  check_minimum(V1, Minimum).
+
+check_minimum(_, &#39;&#39;):- !.
+check_minimum(V, Min1):-
+  atom_number(Min1, Min2),
+  Min2 =&amp;lt; V.
+
+
+
+% INITIALIZATION
+
+%! assert_gv_attr_row(+Row:list(atom)) is det.
+
+assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
+  dcg_phrase(translate_usedby(UsedBy2), UsedBy1),
+  once(dcg_phrase(translate_type(Types2), Types1)),
+  sort(UsedBy2, UsedBy3),
+  translate_default(Default1, Default2),
+  assert_gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes).
+
+
+%! gv_attrs_downloads is det.
+% Downloads the table describing GraphViz attributes from `graphviz.org`.
+
+gv_attrs_download:-
+  gv_attrs_url(Url),
+  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
+
+  xpath(Dom, //table(@align=center), TableDom),
+  % @tbd This does not work, since in `record_name(Element, Name)`,
+  %      `Element` is a signleton list whereas a compound term is expected.
+  %%%%xpath(Dom, /html/body/table, TableDom),
+
+  html_to_table(TableDom, _, Rows),
+  maplist(assert_gv_attr_row, Rows).
+
+
+%! gv_attrs_file(-File:atom) is det.
+
+gv_attrs_file(File):-
+  absolute_file_name(
+    data(gv_attrs),
+    File,
+    [access(write),file_type(logging)]
+  ).
+
+
+%! gv_attrs_init is det.
+
+gv_attrs_init:-
+  gv_attrs_file(File),
+  safe_db_attach(File),
+  file_age(File, Age),
+  gv_attrs_update(Age).
+
+
+%! gv_attrs_update(+Age:float) is det.
+
+% The persistent store is still fresh.
+gv_attrs_update(Age):-
+  once(gv_attr(_, _, _, _, _, _)),
+  Age &amp;lt; 8640000, !.
+% The persistent store has become stale, so refresh it.
+gv_attrs_update(_):-
+  retractall_gv_attr(_, _, _, _, _, _),
+  gv_attrs_download.
+
+
+%! gv_attrs_url(-Url:url) is det.
+
+gv_attrs_url(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
+
+
+%! safe_db_attach(+File:atom) is det.
+
+safe_db_attach(File):-
+  exists_file(File), !,
+  db_attach(File, []).
+safe_db_attach(File):-
+  touch_file(File),
+  safe_db_attach(File).
+
+
+%! translate_default(+Default1:atom, -Default2:atom) is det.
+
+% The empty string is represented by the empty atom.
+translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
+% The absence of a default value is represented by an uninstantiated variable.
+translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
+translate_default(Default, Default).
+
+
+%! translate_type(-Types:list(atom))// is det.
+
+translate_type([H|T]) --&amp;gt;
+  {gv_attr_type(H)},
+  atom(H),
+  whites,
+  translate_type(T).
+translate_type([]) --&amp;gt; !, [].
+
+
+%! translated_usedby(
+%!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
+%! )// is det.
+
+translate_usedby([cluster|T]) --&amp;gt; `C`, !, translate_usedby(T).
+translate_usedby([edge|T]) --&amp;gt; `E`, !, translate_usedby(T).
+translate_usedby([graph|T]) --&amp;gt; `G`, !, translate_usedby(T).
+translate_usedby([node|T]) --&amp;gt; `N`, !, translate_usedby(T).
+translate_usedby([subgraph|T]) --&amp;gt; `S`, !, translate_usedby(T).
+translate_usedby([]) --&amp;gt; [].
+
diff --git a/gv_color.pl b/gv_color.pl
new file mode 100644
index 0000000..19d6e05
--- /dev/null
+++ b/gv_color.pl
@@ -0,0 +1,151 @@
+:- module(
+  gv_color,
+  [
+    gv_color/2, % ?Colorscheme:oneof([svg,x11])
+                % ?Color:atom
+    color//1, % +Color:compound
+    colorList//1 % +Pairs:list(pair(compound,float))
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz color
+
+@author Wouter Beek
+@tbd Color value `transparent` is only available in the output formats
+     ps, svg, fig, vmrl, and the bitmap formats.
+@version 2014/06
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(lists)).
+:- use_module(library(persistency)).
+:- use_module(library(xpath)).
+
+:- use_module(dcg(dcg_abnf)).
+:- use_module(dcg(dcg_cardinal)).
+:- use_module(dcg(dcg_content)).
+:- use_module(generics(db_ext)).
+:- use_module(os(file_ext)).
+:- use_module(sparql(sparql_char)).
+
+:- use_module(plHtml(html)).
+:- use_module(plHtml(html_table)).
+
+:- db_add_novel(user:prolog_file_type(log, logging)).
+
+%! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
+
+:- persistent(gv_color(colorscheme:oneof([svg,x11]),color:atom)).
+
+:- initialization(gv_color_init).
+
+
+
+% color(+Color:compound)// .
+% A *color* is represented by a compound term of one of the following forms:
+%   1. `rgb(Red:nonneg,Green:nonneg,Blue:nonneg)`
+%   2. `rgba(Red:nonneg,Green:nonneg,Blue:nonneg,Alpha:nonneg)`
+%   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
+
+color(rgb(Red,Green,Blue)) --&amp;gt; !,
+  `#`,
+  &#39;#&#39;(3, hex_color, [Red,Green,Blue]).
+color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
+  `#`,
+  &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha]).
+color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
+  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value]).
+color(Name) --&amp;gt;
+  {gv_color(_, Name)},
+  atom(Name).
+
+hex_color(I) --&amp;gt;
+  {W1 is I / 16},
+  &#39;HEX&#39;(W1),
+  {W2 is I mod 16},
+  &#39;HEX&#39;(W2).
+
+hsv_color(D, Head, Tail):-
+  format(codes(Head,Tail), &#39;~2f&#39;, [D]).
+
+
+%! colorList(+Pairs:list(pair(compound,float)))// .
+
+colorList(Pairs) --&amp;gt;
+  &#39;+&#39;(wc, Pairs).
+
+wc(Color-Float) --&amp;gt;
+  color(Color),
+  &#39;?&#39;(wc_weight(Float)).
+
+wc_weight(Float) --&amp;gt;
+  `;`,
+  float(Float).
+
+
+
+% INITIALIZATION
+
+%! gv_color_download is det.
+
+gv_color_download:-
+  gv_color_url(Url),
+  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
+  xpath(Dom, //table(1), TableDom1),
+  xpath(Dom, //table(2), TableDom2),
+  maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2]).
+
+assert_color_table(Colorscheme, TableDom):-
+  html_to_table(TableDom, _, Rows),
+  append(Rows, Cells),
+  forall(
+    member(Cell, Cells),
+    assert_gv_color(Colorscheme, Cell)
+  ).
+
+
+%! gv_color_file(-File:atom) is det.
+
+gv_color_file(File):-
+  absolute_file_name(
+    data(gv_color),
+    File,
+    [access(write),file_type(logging)]
+  ).
+
+
+%! gv_color_init is det.
+
+gv_color_init:-
+  gv_color_file(File),
+  safe_db_attach(File),
+  file_age(File, Age),
+  gv_color_update(Age).
+
+
+%! gv_color_update(+Age:float) is det.
+
+% The persistent store is still fresh.
+gv_color_update(Age):-
+  once(gv_color(_, _)),
+  Age &amp;lt; 8640000, !.
+% The persistent store has become stale, so refresh it.
+gv_color_update(_):-
+  retractall_gv_color(_, _),
+  gv_color_download.
+
+
+%! gv_color_url(-Url:url) is det.
+
+gv_color_url(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
+
+
+%! safe_db_attach(+File:atom) is det.
+
+safe_db_attach(File):-
+  exists_file(File), !,
+  db_attach(File, []).
+safe_db_attach(File):-
+  touch_file(File),
+  safe_db_attach(File).
+
diff --git a/gv_dot.pl b/gv_dot.pl
new file mode 100644
index 0000000..9888973
--- /dev/null
+++ b/gv_dot.pl
@@ -0,0 +1,496 @@
+:- module(
+  gv_dot,
+  [
+    gv_graph//1 % +GraphTerm:compound
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz DOT generator
+
+DCG rules for GraphViz DOT file generation.
+
+Methods for writing to the GraphViz DOT format.
+
+In GraphViz vertices are called &#39;nodes&#39;.
+
+@author Wouter Beek
+@see http://www.graphviz.org/content/dot-language
+@version 2013/07, 2013/09, 2014/03-2014/06
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(lists)).
+:- use_module(library(ordsets)).
+
+:- use_module(dcg(dcg_abnf)).
+:- use_module(dcg(dcg_ascii)).
+:- use_module(dcg(dcg_content)).
+:- use_module(dcg(dcg_generic)).
+:- use_module(dcg(dcg_meta)).
+:- use_module(dcg(dcg_os)).
+
+:- use_module(plGraphViz(gv_attrs)).
+:- use_module(plGraphViz(gv_html)).
+:- use_module(plGraphViz(gv_numeral)).
+
+
+
+%! gv_attribute(+Attribute:nvpair)// is det.
+% A single GraphViz attribute.
+% We assume that the attribute has already been validated.
+
+gv_attribute(Name=Val) --&amp;gt;
+  gv_id(Name), `=`, gv_id(Val), `;`.
+
+
+%! gv_attribute_list(
+%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
+%!   +GraphAttributes:list(nvpair),
+%!   +Attributes:list(nvpair)
+%! )// .
+% ~~~{.abnf}
+% attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
+% a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
+% ~~~
+
+% Attributes occur between square brackets.
+gv_attribute_list(Context, _, Attrs1) --&amp;gt;
+  {maplist(gv_attr(Context), Attrs1, Attrs2)},
+  bracketed(square, &#39;*&#39;(gv_attribute, Attrs2)).
+
+
+%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
+% ~~~
+% compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
+% ~~~
+
+gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
+gv_compass_pt(c) --&amp;gt; `c`.
+gv_compass_pt(e) --&amp;gt; `e`.
+gv_compass_pt(n) --&amp;gt; `n`.
+gv_compass_pt(ne) --&amp;gt; `ne`.
+gv_compass_pt(nw) --&amp;gt; `nw`.
+gv_compass_pt(s) --&amp;gt; `s`.
+gv_compass_pt(se) --&amp;gt; `se`.
+gv_compass_pt(sw) --&amp;gt; `sw`.
+gv_compass_pt(w) --&amp;gt; `w`.
+
+
+%! gv_edge_operator(+Directed:boolean)// .
+% The binary edge operator between two vertices.
+% The operator that is used depends on whether the graph is directed or
+% undirected.
+%
+% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
+%               undirected (operator `--`).
+
+gv_edge_operator(false) --&amp;gt; !, `--`.
+gv_edge_operator(true) --&amp;gt; arrow(right, 2).
+
+
+%! gv_edge_statement(
+%!   +Indent:nonneg,
+%!   +Directed:boolean,
+%!   +GraphAttributes:list(nvpair),
+%!   +EdgeTerm:compound
+%! )// is det.
+% A GraphViz statement describing an edge.
+%
+% @arg Indent The indentation level at which the edge statement is written.
+% @arg Directed Whether the graph is directed or not.
+% @arg GraphAttributes The attributes of the graph. Some of these attributes
+%      may be used in the edge statement (e.g., the colorscheme).
+% @arg EdgeTerm A compound term in the GIFormat, representing an edge.
+%
+% @tbd Instead of gv_node_id//1 we could have a gv_subgraph//1
+%      at the from and/or to location.
+% @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
+
+gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
+  indent(I),
+  gv_node_id(FromId), ` `,
+
+  gv_edge_operator(Directed), ` `,
+
+  gv_node_id(ToId), ` `,
+
+  % We want `colorscheme/1` from the edges and
+  % `directionality/1` from the graph.
+  gv_attribute_list(edge, GAttrs, EAttrs),
+  newline.
+
+
+%! gv_generic_attributes_statement(
+%!   +Kind:oneof([edge,graph,node]),
+%!   +Indent:integer,
+%!   +GraphAttributes:list(nvpair),
+%!   +CategoryAttributes:list(nvpair)
+%! )//
+% A GraphViz statement describing generic attributes for a category of items.
+%
+% @arg Kind The category of items for to the attributes apply.
+%      Possible values: `edge`, `graph`, and `node`.
+% @arg Indent An integer indicating the number of tabs.
+% @arg GraphAttributes A list of name-value pairs.
+% @arg CategoryAttributes A list of name-value pairs.
+%
+% ~~~
+% attr_stmt = (graph / node / edge) attr_list
+% ~~~
+
+gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
+gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
+  indent(I),
+  gv_kind(Kind), ` `,
+  gv_attribute_list(Kind, GraphAttrs, KindAttrs), newline.
+
+
+%! gv_graph(+GraphTerm:compound)//
+% The follow graph attributes are supported,
+% beyond the GraphViz attributes for graphs:
+%   1. `directonality(+Directed:oneof([directed,undirected]))`
+%      A directed graph uses the keyword `digraph`.
+%      An undirected graph uses the keyword `graph`.
+%   2. `name(+GraphName:atom)`
+%   3. `strict(+StrictGraph:boolean)`
+%      This forbids the creation of self-arcs and multi-edges;
+%      they are ignored in the input file.
+%      Only in combinattion with directionality `directed`.
+%
+% ~~~{.abnf}
+% graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
+% ~~~
+%
+% `GraphTerm` is a compound term of the following form:
+% ~~~{.pl}
+% graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
+% ~~~
+%
+% `RankedVertexTerms` is a list of compound terms of the following form:
+% ~~~{.pl}
+% rank(RankNode,ContentNodes)
+% ~~~
+%
+% @tbd Add support for subgraphs (arbitrary nesting).
+% @tbd Add support for escape strings:
+%      http://www.graphviz.org/doc/info/attrs.html#k:escString
+% @tbd Assert attributes that are generic with respect to a subgraph.
+% @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
+
+gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
+
+gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
+  {
+    shared_attributes(VTerms, SharedVAttrs, NewVTerms),
+    shared_attributes(ETerms, SharedEAttrs, NewETerms),
+    select_nvpair(strict=Strict, GAttrs1, GAttrs2, false),
+    select_nvpair(directed=Directed, GAttrs2, GAttrs3, true),
+    select_nvpair(name=GName, GAttrs3, GAttrs4, noname),
+    add_default_nvpair(GAttrs4, overlap, false, GAttrs5),
+    I = 0
+  },
+
+  % The first statement in the GraphViz output.
+  % States that this file represents a graph according to the GraphViz format.
+  indent(I),
+  gv_strict(Strict),
+  gv_graph_type(Directed), ` `,
+  gv_id(GName), ` `,
+  bracketed(
+    curly,
+    gv_graph1(
+      I,
+      NewVTerms, SharedVAttrs, RankedVTerms,
+      NewETerms, SharedEAttrs,
+      Directed, GAttrs5
+    )
+  ),
+  newline.
+
+gv_graph1(
+  I,
+  NewVTerms, SharedVAttrs, RankedVTerms,
+  NewETerms, SharedEAttrs,
+  Directed, GAttrs
+) --&amp;gt;
+  newline,
+
+  % The following lines are indented.
+  {NewI is I + 1},
+
+  % Attributes that apply to the graph as a whole.
+  gv_generic_attributes_statement(graph, NewI, GAttrs, GAttrs),
+
+  % Attributes that are the same for all nodes.
+  gv_generic_attributes_statement(node, NewI, GAttrs, SharedVAttrs),
+
+  % Attributes that are the same for all edges.
+  gv_generic_attributes_statement(edge, NewI, GAttrs, SharedEAttrs),
+
+  % Only add a newline if some content was written in the previous three
+  % lines.
+  ({(GAttrs == [], SharedVAttrs == [], SharedEAttrs == [])} -&amp;gt; `` ; newline),
+
+  % The list of GraphViz nodes.
+  &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms),
+  ({NewVTerms == []} -&amp;gt; `` ; newline),
+
+  % The ranked GraphViz nodes (displayed at the same height).
+  &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms),
+  ({RankedVTerms == []} -&amp;gt; `` ; newline),
+
+  {
+    findall(
+      edge(FromId,ToId,[]),
+      (
+        nth0(Index1, RankedVTerms, rank(vertex(FromId,_,_),_)),
+        nth0(Index2, RankedVTerms, rank(vertex(ToId,_,_),_)),
+        % We assume that the rank vertices are nicely ordered.
+        succ(Index1, Index2)
+      ),
+      RankEdges
+    )
+  },
+
+  % The rank edges.
+  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), RankEdges),
+
+  % The non-rank edges.
+  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), NewETerms),
+
+  % Note that we do not include a newline here.
+
+  % We want to indent the closing curly brace.
+  indent(I).
+
+
+%! gv_graph_type(+Directed:boolean)// .
+% The type of graph that is represented.
+
+gv_graph_type(false) --&amp;gt; `graph`.
+gv_graph_type(true) --&amp;gt; `digraph`.
+
+
+%! gv_id(?Atom:atom)// is det.
+% Parse a GraphViz identifier.
+% There are 4 variants:
+%   1. Any string of alphabetic (`[a-zA-Z&#39;200-&#39;377]`) characters,
+%      underscores (`_`) or digits (`[0-9]`), not beginning with a digit.
+%   2. A numeral `[-]?(.[0-9]+ | [0-9]+(.[0-9]*)? )`.
+%   3. Any double-quoted string (`&amp;quot;...&amp;quot;`) possibly containing
+%      escaped quotes (`\&amp;quot;`).
+%      In quoted strings in DOT, the only escaped character is
+%      double-quote (`&amp;quot;`). That is, in quoted strings, the dyad `\&amp;quot;`
+%      is converted to `&amp;quot;`. All other characters are left unchanged.
+%      In particular, `\\` remains `\\`.
+%      Layout engines may apply additional escape sequences.
+%   4. An HTML string (`&amp;lt;...&amp;gt;`).
+%
+% @tbd Add support for HTML-like labels:
+%      http://www.graphviz.org/doc/info/shapes.html#html
+%      This requires an XML grammar!
+
+% HTML strings (variant 4).
+gv_id(Atom) --&amp;gt;
+  dcg_atom_codes(gv_html_like_label, Atom), !.
+% Alpha-numeric strings (variant 1).
+gv_id(Atom) --&amp;gt;
+  {atom_codes(Atom, [H|T])},
+  gv_id_first(H),
+  gv_id_rest(T), !,
+  % Variant 1 identifiers should not be (case-variants of) a
+  % GraphViz keyword.
+  {\+ gv_keyword([H|T])}.
+% Numerals (variant 2)
+gv_id(N) --&amp;gt;
+  {number(N)}, !,
+  gv_numeral(N).
+% Double-quoted strings (variant 3).
+% The quotes are already part of the given atom.
+gv_id(Atom) --&amp;gt;
+  {
+    atom_codes(Atom, [H|T]),
+    append(S, [H], T)
+  },
+  dcg_between(double_quote(H), gv_quoted_string(S)), !.
+% Double-quoted strings (variant 3).
+% The quotes are not in the given atom. They are written anyway.
+gv_id(Atom) --&amp;gt;
+  quoted(double_quote, dcg_atom_codes(gv_quoted_string, Atom)), !.
+
+gv_id_first(X) --&amp;gt; ascii_letter(X).
+gv_id_first(X) --&amp;gt; underscore(X).
+
+gv_id_rest([]) --&amp;gt; [].
+gv_id_rest([H|T]) --&amp;gt;
+  (ascii_alpha_numeric(H) ; underscore(H)),
+  gv_id_rest(T).
+
+
+%! gv_keyword(+Codes:list(code)) is semidet.
+% Succeeds if the given codes for a GraphViz reserved keyword.
+
+gv_keyword(Codes):-
+  % Obviously, the keywords do not occur on the difference list input.
+  % So we must use phrase/[2,3].
+  phrase(gv_keyword, Codes).
+
+%! gv_keyword// .
+% GraphViz has reserved keywords that cannot be used as identifiers.
+% GraphViz keywords are case-insensitive.
+
+gv_keyword --&amp;gt; `digraph`.
+gv_keyword --&amp;gt; `edge`.
+gv_keyword --&amp;gt; `graph`.
+gv_keyword --&amp;gt; `node`.
+gv_keyword --&amp;gt; `strict`.
+gv_keyword --&amp;gt; `subgraph`.
+
+
+%! gv_kind(+Kind:oneof([edge,graph,node]))// .
+
+gv_kind(edge) --&amp;gt; `edge`.
+gv_kind(graph) --&amp;gt; `graph`.
+gv_kind(node) --&amp;gt; `node`.
+
+
+%! gv_node_id(+NodeId:atom)// .
+% GraphViz node identifiers can be of the following two types:
+%   1. A GraphViz identifier, see gv_id//1.
+%   2. A GraphViz identifier plus a GraphViz port indicator, see gv_port//0.
+%
+% @tbd Add support for GraphViz port indicators
+%      inside GraphViz node identifiers.
+
+gv_node_id(Id) --&amp;gt;
+  gv_id(Id).
+%gv_node_id(_) --&amp;gt;
+%  gv_id(_),
+%  gv_port.
+
+
+%! gv_node_statement(
+%!   +Indent:integer,
+%!   +GraphAttributes,
+%!   +VertexTerm:compound
+%! )// .
+% A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
+
+gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
+  indent(I),
+  gv_node_id(Id), ` `,
+  gv_attribute_list(node, GraphAttrs, VAttrs), newline.
+
+
+gv_port --&amp;gt;
+  gv_port_location,
+  &#39;?&#39;(gv_port_angle).
+gv_port --&amp;gt;
+  gv_port_angle,
+  &#39;?&#39;(gv_port_location).
+gv_port --&amp;gt;
+  `:`,
+  gv_compass_pt(_).
+
+gv_port_angle --&amp;gt;
+  `@`,
+  gv_id(_).
+
+gv_port_location --&amp;gt;
+  `:`,
+  gv_id(_).
+gv_port_location --&amp;gt;
+  `:`,
+  bracketed(
+    round,
+    (
+      gv_id(_),
+      `,`,
+      gv_id(_)
+    )
+  ).
+
+
+gv_quoted_string([]) --&amp;gt; [].
+% Just to be sure, we do not allow the double quote
+% that closes the string to be escaped.
+gv_quoted_string([X]) --&amp;gt;
+  {X \== 92}, !,
+  [X].
+% A double quote is only allowed if it is escaped by a backslash.
+gv_quoted_string([92,34|T]) --&amp;gt; !,
+  gv_quoted_string(T).
+% Add the backslash escape character.
+gv_quoted_string([34|T]) --&amp;gt; !,
+  `\\\&amp;quot;`,
+  gv_quoted_string(T).
+% All other characters are allowed without escaping.
+gv_quoted_string([H|T]) --&amp;gt;
+  [H],
+  gv_quoted_string(T).
+
+
+gv_ranked_node_collection(
+  I,
+  GraphAttrs,
+  rank(Rank_V_Term,Content_V_Terms)
+) --&amp;gt;
+  indent(I),
+  bracketed(curly, (
+    newline,
+
+    % The rank attribute.
+    {NewI is I + 1},
+    indent(NewI), gv_attribute(rank=same), `;`, newline,
+
+    &#39;*&#39;(gv_node_statement(NewI, GraphAttrs), [Rank_V_Term|Content_V_Terms]),
+
+    % We want to indent the closing curly brace.
+    indent(I)
+  )),
+  newline.
+
+
+%! gv_strict(+Strict:boolean)// is det.
+% The keyword denoting that the graph is strict, i.e., has no self-arcs and
+% no multi-edges.
+% This only applies to directed graphs.
+
+gv_strict(false) --&amp;gt; [].
+gv_strict(true) --&amp;gt; `strict `.
+
+
+
+% Helpers
+
+add_default_nvpair(Attrs1, N, Default, Attrs2):-
+  add_default_nvpair(Attrs1, N, Default, _, Attrs2).
+
+add_default_nvpair(Attrs, N, _, V, Attrs):-
+  memberchk(N=V, Attrs), !.
+add_default_nvpair(Attrs1, N, Default, Default, Attrs2):-
+  ord_add_element(Attrs1, N=Default, Attrs2).
+
+select_nvpair(N=V, Attrs1, Attrs2, _):-
+  memberchk(N=V, Attrs1), !,
+  select(N=V, Attrs1, Attrs2).
+select_nvpair(_=Default, Attrs, Attrs, Default).
+
+
+extract_shared([], []):- !.
+extract_shared(Argss, Shared):-
+  ord_intersection(Argss, Shared).
+
+remove_shared_attributes(Shared, Args1, Args2):-
+  ord_subtract(Args1, Shared, Args2).
+
+shared_attributes(Terms1, Shared, Terms2):-
+  maplist(term_components(Func), Terms1, Args1, Args2, Args3a),
+  extract_shared(Args3a, Shared),
+  maplist(remove_shared_attributes(Shared), Args3a, Args3b),
+  maplist(term_components(Func), Terms2, Args1, Args2, Args3b).
+
+term_components(Func, Term, Arg1, Arg2, Arg3):-
+  Term =.. [Func,Arg1,Arg2,Arg3].
+
diff --git a/gv_file.pl b/gv_file.pl
new file mode 100644
index 0000000..c780692
--- /dev/null
+++ b/gv_file.pl
@@ -0,0 +1,211 @@
+:- module(
+  gv_file,
+  [
+    gif_to_gv_file/3, % +GraphInterchangeFormat:compound
+                      % ?ToFile:atom
+                      % +Options:list(nvpair)
+    graph_to_svg_dom/3, % +GraphInterchangeFormat:compound
+                        % -SvgDom:list(compound)
+                        % +Options:list(nvpair)
+    open_dot/1 % +File:file
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz file
+
+Predicates for converting GIF-formatted terms
+into GraphViz output files or SVG DOM structures.
+
+Also converts between GraphViz DOT formatted files
+and GraphViz output files or SVG DOM structures.
+
+@author Wouter Beek
+@version 2011-2013/09, 2013/11-2014/01, 2014/05, 2014/07
+*/
+
+:- use_module(library(option)).
+:- use_module(library(process)).
+:- use_module(library(predicate_options)). % Declarations.
+
+:- use_module(generics(codes_ext)).
+:- use_module(generics(db_ext)).
+:- use_module(generics(error_ext)).
+:- use_module(generics(trees)).
+:- use_module(os(file_ext)).
+:- use_module(os(run_ext)).
+:- use_module(os(safe_file)).
+:- use_module(svg(svg_file)).
+:- use_module(ugraph(ugraph_export)).
+
+:- use_module(plGraphViz(gv_dot)).
+
+:- dynamic(user:file_type_program/2).
+:- multifile(user:file_type_program/2).
+
+:- dynamic(user:module_uses/2).
+:- multifile(user:module_uses/2).
+
+:- dynamic(user:prolog_file_type/2).
+:- multifile(user:prolog_file_type/2).
+
+% Register DOT.
+:- db_add_novel(user:prolog_file_type(dot, dot)).
+:- db_add_novel(user:prolog_file_type(dot, graphviz)).
+:- db_add_novel(user:file_type_program(dot, dotty)).
+:- db_add_novel(user:file_type_program(dot, dotx)).
+:- db_add_novel(user:module_uses(gv_file, file_type(dot))).
+
+% Register JPG/JPEG.
+:- db_add_novel(user:prolog_file_type(jpeg, jpeg)).
+:- db_add_novel(user:prolog_file_type(jpeg, graphviz_output)).
+:- db_add_novel(user:prolog_file_type(jpg, jpeg)).
+:- db_add_novel(user:prolog_file_type(jpg, graphviz_output)).
+
+% Register PDF.
+:- db_add_novel(user:prolog_file_type(pdf, pdf)).
+:- db_add_novel(user:prolog_file_type(pdf, graphviz_output)).
+
+% Register PNG.
+:- db_add_novel(user:prolog_file_type(png, png)).
+:- db_add_novel(user:prolog_file_type(png, graphviz_output)).
+
+% Register SVG.
+:- db_add_novel(user:prolog_file_type(svg, graphviz_output)).
+:- db_add_novel(user:prolog_file_type(svg, svg)).
+
+% Register XDOT.
+:- db_add_novel(user:prolog_file_type(xdot, graphviz_output)).
+:- db_add_novel(user:prolog_file_type(xdot, xdot)).
+
+:- predicate_options(graph_to_svg_dom/3, 3, [
+     pass_to(gif_to_gv_file/3, 3)
+   ]).
+:- predicate_options(gif_to_gv_file/3, 3, [
+     pass_to(to_gv_file/3, 3)
+   ]).
+:- predicate_options(to_gv_file/3, 3, [
+     pass_to(convert_gv/3, 3)
+   ]).
+:- predicate_options(convert_gv/3, 3, [
+     method(+oneof([dot,sfdp])),
+     to_file_type(+oneof([dot,jpeg,pdf,svg,xdot]))
+   ]).
+
+
+
+%! gif_to_gv_file(+Gif:compound, -ToFile:atom, +Options:list(nvpair)) is det.
+% Returns a file containing a GraphViz visualization of the given graph.
+%
+% The following options are supported:
+%   * =|method(+Method:oneof([dot,sfdp])|=
+%     The algorithm used by GraphViz for positioning the tree nodes.
+%     Either =dot= (default) or =sfdp=.
+%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
+%     The file type of the generated GraphViz file.
+%     Default: `pdf`.
+
+gif_to_gv_file(Gif, ToFile, Options):-
+  once(phrase(gv_graph(Gif), Codes)),
+  to_gv_file(Codes, ToFile, Options).
+
+
+%! graph_to_svg_dom(
+%!   +GraphInterchangeFormat:compound,
+%!   -SvgDom:list(compound),
+%!   +Options:list(nvpair)
+%! ) is det.
+
+graph_to_svg_dom(Gif, SvgDom, Options1):-
+  % Make sure the file type of the output file is SvgDom.
+  merge_options([to_file_type=svg], Options1, Options2),
+  gif_to_gv_file(Gif, ToFile, Options2),
+  file_to_svg(ToFile, SvgDom),
+  safe_delete_file(ToFile).
+
+
+%! open_dot(+File:atom) is det.
+% Opens the given DOT file.
+%
+% @tbd Test support on Windows.
+% @tbd Test support on OS-X.
+
+open_dot(File):-
+  once(find_program_by_file_type(dot, Program)),
+  run_program(Program, [File]).
+
+
+
+% SUPPORT PREDICATES %
+
+%! convert_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
+% Converts a GraphViz DOT file to an image file, using a specific
+% visualization method.
+
+convert_gv(FromFile, ToFile, Options):-
+  option(to_file_type(dot), Options), !,
+  rename_file(FromFile, ToFile).
+convert_gv(FromFile, ToFile, Options):-
+  % The input file must be readable.
+  access_file(FromFile, read),
+
+  % The method option.
+  option(method(Method), Options, dot),
+  must_be(oneof([dot,sfdp]), Method),
+
+  % The file type option.
+  option(to_file_type(ToFileType), Options, pdf),
+  prolog_file_type(ToExtension, ToFileType),
+  prolog_file_type(ToExtension, graphviz_output), !,
+
+  % The output file is either given or created.
+  (
+    var(ToFile)
+  -&amp;gt;
+    absolute_file_name(
+      data(export),
+      ToFile,
+      [access(write),file_type(ToFileType)]
+    )
+  ;
+    is_absolute_file_name(ToFile),
+    % The given output file must match a certain file extension.
+    file_name_extension(_, ToExtension, ToFile)
+  ),
+  % Now that we have the output file we can prevent the
+  % file type / file extension translation predicates from bakctracking.
+  !,
+
+  % Run the GraphViz conversion command in the shell.
+  format(atom(OutputType), &#39;-T~w&#39;, [ToExtension]),
+  process_create(
+    path(Method),
+    [OutputType,FromFile,&#39;-o&#39;,ToFile],
+    [process(PID)]
+  ),
+  process_wait(PID, exit(ShellStatus)),
+  exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
+
+
+%! to_gv_file(+Codes:list(code), ?ToFile:atom, +Options:list(nvpair)) is det.
+
+to_gv_file(Codes, ToFile, Options):-
+  absolute_file_name(
+    data(tmp),
+    FromFile,
+    [access(write),file_type(graphviz)]
+  ),
+  setup_call_cleanup(
+    open(FromFile, write, Out, [encoding(utf8),type(test)]),
+    put_codes(Out, Codes),
+    close(Out)
+  ),
+  convert_gv(FromFile, ToFile, Options),
+
+  %%%%% DEB: Store DOT file.
+  %%%%ignore((
+  %%%%  file_type_alternative(ToFile, graphviz, DOT_File),
+  %%%%  safe_copy_file(FromFile, DOT_File)
+  %%%%)),
+
+  safe_delete_file(FromFile).
+
diff --git a/gv_html.pl b/gv_html.pl
new file mode 100644
index 0000000..b8d3190
--- /dev/null
+++ b/gv_html.pl
@@ -0,0 +1,60 @@
+:- module(
+  gv_html,
+  [
+    gv_html_like_label//1 % +Codes:list(code)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz HTML
+
+@author Wouter Beek
+@version 2013/07, 2013/09, 2014/03-2014/06
+*/
+
+:- use_module(dcg(dcg_content)).
+
+:- use_module(plHtml(html_dcg)).
+
+
+
+%! gv_html_label(+Codes:list(code))// .
+%
+% @see http://www.graphviz.org/doc/info/shapes.html#html
+
+gv_html_label --&amp;gt; gv_html_text, !.
+gv_html_label --&amp;gt; gv_html_table, !.
+gv_html_label --&amp;gt; [].
+
+gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
+
+gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
+
+gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
+gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
+
+gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row.
+
+gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
+
+gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
+gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
+
+gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
+gv_html_cells --&amp;gt; gv_html_cell.
+gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
+
+gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
+gv_html_text --&amp;gt; gv_html_textitem.
+
+gv_html_textitem --&amp;gt; html_string, !.
+gv_html_textitem --&amp;gt; html_entity, !.
+gv_html_textitem --&amp;gt; html_element(br, _), !.
+gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
+
diff --git a/gv_numeral.pl b/gv_numeral.pl
new file mode 100644
index 0000000..9b82fc0
--- /dev/null
+++ b/gv_numeral.pl
@@ -0,0 +1,71 @@
+:- module(
+  gv_numeral,
+  [
+    gv_numeral//1 % ?Value:number
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz numeral
+
+@author Wouter Beek
+@version 2014/05-2014/06
+*/
+
+:- use_module(dcg(dcg_abnf)).
+:- use_module(dcg(dcg_cardinal)).
+:- use_module(math(math_ext)).
+
+
+
+%! gv_numeral(?Value:number)// .
+% ~~~{.bnf}
+% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
+% ~~~
+
+gv_numeral(N) --&amp;gt;
+  {nonvar(N)},
+  {number_sign_parts(N, Sign, Abs)},
+  ({Sign =:= -1} -&amp;gt; `-` ; ``),
+  gv_numeral_abs(Abs).
+gv_numeral(N) --&amp;gt;
+  {var(N)},
+  &#39;sign?&#39;(Sign),
+  gv_numeral_abs(Abs),
+  {number_sign_parts(N, Sign, Abs)}.
+
+
+gv_numeral_abs(N) --&amp;gt;
+  {nonvar(N)},
+  {number_integer_parts(N, N1, N2)},
+  (
+    {N2 =:= 0}
+  -&amp;gt;
+    integer(N1)
+  ;
+    {N1 =:= 0}
+  -&amp;gt;
+    `.`,
+    integer(N2)
+  ;
+    integer(N1),
+    &#39;?&#39;((`.`, &#39;integer?&#39;(N2)))
+  ).
+gv_numeral_abs(N) --&amp;gt;
+  {var(N)},
+  (
+    `.`,
+    integer(N2)
+  -&amp;gt;
+    {N1 = 0}
+  ;
+    integer(N1),
+    (
+      `.`
+    -&amp;gt;
+      &#39;integer?&#39;(N2)
+    ;
+      {N2 = 0}
+    )
+  ),
+  {number_integer_parts(N, N1, N2)}.
+
diff --git a/gv_tree.pl b/gv_tree.pl
new file mode 100644
index 0000000..afeb8f6
--- /dev/null
+++ b/gv_tree.pl
@@ -0,0 +1,43 @@
+:- module(
+  gv_tree,
+  [
+    tree_to_gv_file/3 % +Tree:compound
+                      % ?ToFile:atom
+                      % +Options:list(nvpair)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz tree
+
+Export trees to GraphViz.
+
+@author Wouter Beek
+@version 2014/06-2014/07
+*/
+
+:- use_module(library(aggregate)).
+
+:- use_module(generics(trees)).
+
+:- use_module(plGraphViz(gv_file)).
+:- use_module(plGraphViz(gv_gif)).
+
+
+%! tree_to_gv_file(
+%!   +Tree:compound,
+%!   ?ToFile:atom,
+%!   +Options:list(nvpair)
+%! ) is det.
+% Stores the given tree term into a GraphViz file.
+%
+% Options are passed on to create_gif/3 and gif_to_gv_file/3.
+
+tree_to_gv_file(Tree, ToFile, Options):-
+  tree_to_gif(Tree, Gif, Options),
+  gif_to_gv_file(Gif, ToFile, Options).
+
+
+tree_to_gif(H-T, Gif, Options):-
+  tree_to_vertices_edges(Tree, Vs, Es),
+  create_gif(Vs, Es, Gif, Options).
+
diff --git a/index.pl b/index.pl
new file mode 100644
index 0000000..7461d13
--- /dev/null
+++ b/index.pl
@@ -0,0 +1,2 @@
+% Index of project plGraphViz (empty).
+
diff --git a/load.pl b/load.pl
new file mode 100644
index 0000000..4b117d1
--- /dev/null
+++ b/load.pl
@@ -0,0 +1,12 @@
+% Load file for plGraphViz.
+
+:- dynamic(user:prolog/3).
+:- multifile(user:prolog/3).
+   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
+
+:- use_module(load_project).
+:- load_project(plGraphViz, [
+    plc-&#39;Prolog-Library-Collection&#39;,
+    plHtml
+]).
+
diff --git a/load_project.pl b/load_project.pl
new file mode 100644
index 0000000..5599b5e
--- /dev/null
+++ b/load_project.pl
@@ -0,0 +1,120 @@
+:- module(
+  load_project,
+  [
+    load_project/2, % +Parent:atom
+                    % +ChildProjects:list(or([atom,pair(atom)]))
+    load_subproject/2, % +ParentFileSearchPath:atom
+                       % +Child:or([atom,pair(atom)])
+    set_data_subdirectory/1 % +ParentDirectory:atom
+  ]
+).
+
+/** &amp;lt;module&amp;gt; Load project
+
+Generic code for loading a project:
+  * Create a subdirectory for data.
+  * Load the root of subprojects onto the file search path.
+  * Load the index of subprojects onto the file search path.
+
+@author Wouter Beek
+@version 2014/06/14
+*/
+
+:- use_module(library(ansi_term)). % Colorized terminal messages.
+:- use_module(library(apply)).
+
+:- dynamic(user:project/2).
+:- multifile(user:project/2).
+:- dynamic(user:project/3).
+:- multifile(user:project/3).
+
+
+
+load_project(Parent, ChildProjects):-
+  parent_alias(Parent, ParentFsp),
+
+  % Entry point.
+  source_file(load_project(_,_), ThisFile),
+  file_directory_name(ThisFile, ThisDir),
+  assert(user:file_search_path(ParentFsp, ThisDir)),
+  assert(user:file_search_path(project, ThisDir)),
+
+  % Set the data subdirectory.
+  set_data_subdirectory(ThisDir),
+
+  % Load the root of submodules onto the file search path.
+  maplist(load_subproject(ParentFsp), ChildProjects),
+
+  % Load the index into the file search path.
+  load_project_index(ParentFsp).
+
+
+
+%! load_subproject(
+%!   +ParentFileSearchPath:atom,
+%!   +Child:or([atom,pair(atom)])
+%! ) is det.
+
+load_subproject(ParentFsp, ChildFsp-ChildDir):- !,
+  load_subproject_file_search_path(ParentFsp, ChildFsp, ChildDir),
+  load_project_index(ChildFsp).
+load_subproject(ParentFsp, Child):-
+  load_subproject(ParentFsp, Child-Child).
+
+
+%! load_subproject_file_search_path(
+%!   +ParentFileSearchPath:atom,
+%!   +ChildFileSearchPath:atom,
+%!   +ChildDirectory:atom
+%! ) is det.
+
+% The file search path for the subproject has already been set.
+load_subproject_file_search_path(_, ChildFsp, _):-
+  user:file_search_path(ChildFsp, _).
+load_subproject_file_search_path(ParentFsp, ChildFsp, ChildDir):-
+  Spec =.. [ParentFsp,ChildDir],
+  absolute_file_name(Spec, _, [access(read),file_type(directory)]), !,
+  assert(user:file_search_path(ChildFsp, Spec)).
+load_subproject_file_search_path(_, ChildFsp, ChildDir):-
+  print_message(warning, missing_subproject_directory(ChildFsp,ChildDir)).
+
+
+%! load_project_index(+FileSearchPath:atom) is det.
+
+load_project_index(Fsp):-
+  Spec =.. [Fsp,index],
+  absolute_file_name(
+    Spec,
+    File,
+    [access(read),file_errors(fail),file_type(prolog)]
+  ), !,
+  ensure_loaded(File).
+load_project_index(_).
+
+
+%! parent_alias(+Parent:atom, -ParentFsp:atom) is det.
+
+parent_alias(Parent, ParentFsp):-
+  user:project(Parent, _, ParentFsp), !.
+parent_alias(Parent, Parent).
+
+
+%! set_data_subdirectory(+ParentDirectory:atom) is det.
+
+set_data_subdirectory(ParentDir):-
+  directory_file_path(ParentDir, data, DataDir),
+  make_directory_path(DataDir),
+  assert(user:file_search_path(data, DataDir)).
+
+
+
+:- multifile(prolog:message//1).
+
+prolog:message(missing_subproject_directory(ChildFsp,ChildDir)) --&amp;gt;
+  [
+    &#39;The ~a submodule is not present.&#39;-[ChildFsp], nl,
+    &#39;Check whether subdirectory ~a is present in your project directory:&#39;-[ChildDir], nl,
+    &#39;    git submodule init&#39;, nl,
+    &#39;    git submodule update&#39;
+  ].
+
diff --git a/pack.pl b/pack.pl
deleted file mode 100644
index 989108a..0000000
--- a/pack.pl
+++ /dev/null
@@ -1,9 +0,0 @@
-author(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
-download(&#39;https://github.com/wouterbeek/plGraphViz/release/*.zip&#39;).
-home(&#39;https://github.com/wouterbeek/plGraphViz&#39;).
-maintainer(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
-name(plGraphViz).
-packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
-requires(&#39;Prolog-Library-Collection&#39;).
-title(plGraphViz).
-version(&#39;0.0.1&#39;).
diff --git a/plHtml b/plHtml
new file mode 160000
index 0000000..08480c4
--- /dev/null
+++ b/plHtml
@@ -0,0 +1 @@
+Subproject commit 08480c40acaee5f70bfb21e3c641bef1e7d258bd
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
deleted file mode 100644
index 083dbb2..0000000
--- a/prolog/fca/fca_viz.pl
+++ /dev/null
@@ -1,101 +0,0 @@
-:- module(
-  fca_viz,
-  [
-    fca_export_graph/2, % +Context, -ExportGraph
-    fca_export_graph/3, % +Context, -ExportGraph, :Opts
-    fca_viz/2,          % +Context, ?File
-    fca_viz/3           % +Context, ?File, :Opts
-  ]
-).
-
-/** &amp;lt;module&amp;gt; FCA visualization
-
-@author Wouter Beek
-@version 2015/11-2016/01
-*/
-
-:- use_module(library(aggregate)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_pl)).
-:- use_module(library(fca/fca)).
-:- use_module(library(graph/build_export_graph)).
-:- use_module(library(graph/s/s_graph)).
-:- use_module(library(gv/gv_file)).
-:- use_module(library(option)).
-:- use_module(library(ordsets)).
-
-:- meta_predicate(fca_export_graph(+,?,:)).
-:- meta_predicate(fca_viz(+,?,:)).
-
-:- predicate_options(fca_export_graph/3, 3, [
-     concept_label(+callable)
-   ]).
-:- predicate_options(fca_viz/3, 3, [
-     pass_to(fca_export_graph/3, 3),
-     pass_to(graph_viz/3, 3)
-   ]).
-
-is_meta(concept_label).
-
-
-
-
-
-%! fca_export_graph(+Context:compound, -ExportGraph:compound) is det.
-% Wrapper around fca_export_graph/3 with default options.
-
-fca_export_graph(Context, ExportG):-
-  fca_export_graph(Context, ExportG, []).
-
-
-%! fca_export_graph(
-%!   +Context:compound,
-%!   -ExportGraph:compound,
-%!   :Options:list(compound)
-%! ) is det.
-% The following optios are supported:
-%   * concept_label(+callable)
-%     DCG writing the labels for individual concepts.
-
-fca_export_graph(Context, ExportG, Opts1):-
-  fca_hasse(Context, Hasse),
-  meta_options(is_meta, Opts1, Opts2),
-  option(concept_label(Label_3), Opts2, concept_label),
-  merge_options(
-    [
-      vertex_label(Label_3),
-      vertex_rank(fca:concept_cardinality)
-    ],
-    Opts2,
-    Opts3
-  ),
-  build_export_graph(Hasse, ExportG, Opts3).
-
-
-
-%! fca_viz(+Context:compound, ?File:atom) is det.
-% Wrapper around fca_viz/3 with default options.
-
-fca_viz(Context, File):-
-  fca_viz(Context, File, []).
-
-
-%! fca_viz(+Context:compound, ?File:atom, :Options:list(compound)) is det.
-
-fca_viz(Context, File, Opts1):-
-  meta_options(is_meta, Opts1, Opts2),
-  statistics(process_cputime, Time1),
-  fca_export_graph(Context, ExportG, Opts2),
-  ExportG = graph(_,_,Es,_),
-  aggregate_all(max(N), (member(edge(V1,V2,_), Es), (N = V1 ; N = V2)), N),
-  ignore(option(number_of_vertices(N), Opts2)),
-  statistics(process_cputime, Time2),
-  Time is Time2 - Time1,
-  ignore(option(process_cputime(Time), Opts2)),
-  graph_viz(ExportG, File, Opts2).
-
-
-
-%! concept_label(+Concept:compound)// is det.
-
-concept_label(concept(Os,As)) --&amp;gt; set(Os), &amp;quot; / &amp;quot;, set(As).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
deleted file mode 100644
index 5134069..0000000
--- a/prolog/graph/build_export_graph.pl
+++ /dev/null
@@ -1,369 +0,0 @@
-:- module(
-  build_export_graph,
-  [
-    build_export_graph/2, % +Graph, -ExportGraph
-    build_export_graph/3 % +Graph
-                         % -ExportGraph:compound
-                         % +Options:list(compound)
-  ]
-).
-
-/** &amp;lt;module&amp;gt; Build graph representation for exporting
-
-Support for building GIF representations.
-
-# Graph Intermediate Format (GIF)
-
-## Graph
-
-```prolog
-graph(Vs:ordset(compound),Ranks,Es:compound,Attributes:list(compound))
-```
-
-### Edge
-
-```prolog
-edge(FromVertexId,ToVertexId,Attributes:list(compound))
-```
-
-### Rank
-
-```prolog
-RankVertex:compound-ContentVertices:ordset(compound)
-```
-
-### Vertex
-
-```prolog
-vertex(Id,Attributes:list(compound))
-```
-
-# Property functions
-
-Edge label:
-  1. [[graph_edge]] edge_label/2
-
-Vertex coordinates:
-  1. [[circle_coords]] circular_coord/4
-  2. [[random_coords]] random_coord/4
-
----
-
-@author Wouter Beek
-@version 2015/07, 2015/09-2016/01
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(graph/s/s_graph)).
-:- use_module(library(list_ext)).
-:- use_module(library(option_ext)).
-:- use_module(library(ordsets)).
-:- use_module(library(pairs)).
-
-:- predicate_options(build_export_graph/4, 4, [
-     pass_to(edge_term/3, 3),
-     pass_to(graph_attributes/2, 2),
-     pass_to(vertex_term/3, 3)
-   ]).
-:- predicate_options(edge_term/3, 3, [
-     edge_arrowhead(+callable),
-     edge_color(+callable),
-     edge_id(+callable),
-     edge_label(+callable),
-     edge_penwidth(+callable),
-     edge_style(+callable)
-   ]).
-:- predicate_options(graph_attributes/2, 2, [
-     graph_charset(+oneof([&#39;iso-8859-1&#39;,&#39;Latin1&#39;,&#39;UTF-8&#39;])),
-     graph_colorscheme(+oneof([none,svg,x11])),
-     graph_directed(+boolean),
-     graph_fontsize(+float),
-     graph_label(+atom),
-     graph_overlap(+boolean)
-   ]).
-:- predicate_options(vertex_term/3, 3, [
-     vertex_color(+callable),
-     vertex_id(+callable),
-     vertex_image(+callable),
-     vertex_label(+callable),
-     vertex_peripheries(+callable),
-     vertex_position(+callable),
-     vertex_rank(+callable),
-     vertex_shape(+callable),
-     vertex_uri(+callable)
-   ]).
-
-:- meta_predicate(build_export_graph(+,-,:)).
-
-is_meta(edge_arrowhead).
-is_meta(edge_color).
-is_meta(edge_id).
-is_meta(edge_label).
-is_meta(edge_penwidth).
-is_meta(edge_style).
-is_meta(vertex_color).
-is_meta(vertex_id).
-is_meta(vertex_image).
-is_meta(vertex_label).
-is_meta(vertex_peripheries).
-is_meta(vertex_position).
-is_meta(vertex_rank).
-is_meta(vertex_shape).
-is_meta(vertex_uri).
-
-
-
-
-
-%! build_export_graph(+Graph, -ExportGraph:compound) is det.
-% Wrapper around build_export_graph/3 with default options.
-
-build_export_graph(G, ExportG):-
-  build_export_graph(G, ExportG, []).
-
-
-%! build_export_graph(
-%!   +Graph,
-%!   -ExportGraph:compound,
-%!   +Options:list(compound)
-%! ) is det.
-% Graph is either:
-%   * a coumpound term `graph(Vs,Es)`, or
-%   * an unlabeled graph as defined by `library(ugraph)`.
-%
-% The following options are supported:
-%   * `vertex_rank(:RankFunction)`
-%     Assigns a non-negative integer to each vertex.
-%     No default.
-
-build_export_graph(G, graph(VTerms2,VRanks,ETerms,GAttrs), Opts1):-
-  graph_components(G, Vs, Es),
-  meta_options(is_meta, Opts1, Opts2),
-  maplist(vertex_term0(Vs, Opts2), Vs, VTerms1),
-  build_export_ranks(Vs, VTerms1, VRanks, VTerms2, Opts2),
-  maplist(edge_term0(Vs, Opts2), Es, ETerms),
-  graph_attributes(GAttrs, Opts2).
-
-vertex_term0(Vs, Opts, V, VTerm) :- vertex_term(Vs, V, VTerm, Opts).
-
-edge_term0(Vs, Opts, E, ETerm) :- edge_term(Vs, E, ETerm, Opts).
-
-graph_components(graph(Vs,Es), Vs, Es):- !.
-graph_components(G, Vs, Es):-
-  s_graph_components(G, Vs, Es).
-
-build_export_ranks(Vs, VTerms, VRanks, [], Opts):-
-  option(vertex_rank(VRank_2), Opts), !,
-  maplist(VRank_2, Vs, Ranks),
-  pairs_keys_values(Pairs, Ranks, VTerms),
-  group_pairs_by_key(Pairs, GroupedPairs),
-  build_export_rank_terms(GroupedPairs, VRanks).
-build_export_ranks(_, VTerms, [], VTerms, _).
-
-build_export_rank_terms([N-VTerms|T1], [RankTerm-VTerms|T2]):- !,
-  build_export_rank_term(N, RankTerm),
-  build_export_rank_terms(T1, T2).
-build_export_rank_terms([], []).
-
-build_export_rank_term(N, vertex(Id,[label(&amp;quot;&amp;quot;),shape(none)])):-
-  format(atom(Id), &amp;quot;r~d&amp;quot;, [N]).
-
-
-
-%! edge_term(
-%!   +Vertices:ordset(compound),
-%!   +Edge:compound,
-%!   -EdgeTerm:compound,
-%!   +Options:list(compound)
-%! ) is det.
-% The following options are supported:
-%   * `edge_arrowhead(+callable)`
-%     No default.
-%   * `edge_color(+callable)`
-%     No default.
-%   * `edge_id(+callable)`
-%     Function that assignes the unique identifiers for an edge&#39;s
-%     incident vertices.
-%   * `edge_label(+callable)`
-%     No default.
-%   * `edge_penwidth(+callable)`
-%     No default.
-%   * `edge_style(+callable)`
-%     No default.
-
-edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
-  % Arrowhead
-  if_option(edge_arrowhead(Arrowhead_2), Opts,
-    call(Arrowhead_2, E, EArrowhead)
-  ),
-  
-  % Color.
-  if_option(edge_color(ColorFunction), Opts, call(ColorFunction, E, EColor)),
-  
-  % Id.
-  (   option(edge_id(Id_2), Opts)
-  -&amp;gt;  call(Id_2, E, FromId, ToId)
-  ;   edge_components(E, FromV, ToV),
-      nth0chk(FromId, Vs, FromV),
-      nth0chk(ToId, Vs, ToV)
-  ),
-  
-  % Label.
-  if_option(edge_label(ELabel_3), Opts, string_phrase(dcg_call(ELabel_3, E), ELabel)),
-  
-  % Penwidth.
-  if_option(edge_penwidth(Penwidth_2), Opts, call(Penwidth_2, E, EPenwidth)),
-  
-  % Style.
-  if_option(edge_style(Style_2), Opts, call(Style_2, E, EStyle)),
-  
-  exclude(
-    option_has_var_value,
-    [
-      arrowhead(EArrowhead),
-      color(EColor),
-      label(ELabel),
-      penwidth(EPenwidth),
-      style(EStyle)
-    ],
-    EAttrs
-  ).
-
-
-
-%! graph_attributes(
-%!   -GraphAttributes:list(compound),
-%!   +Options:list(compound)
-%! ) is det.
-% The following options are supported:
-%   * `graph_charset(+oneof([&#39;iso-8859-1&#39;,&#39;Latin1&#39;,&#39;UTF-8&#39;]))`
-%     The name of the character set that is used to encode text in the graph.
-%     Default: `UTF-8`.
-%   * `graph_colorscheme(+oneof([none,svg,x11]))`
-%     The colorscheme from which the color in this graph are taken.
-%     Default: `x11`.
-%   * `graph_directed(+boolean)`
-%     Whether the graph is directed (`true`) or undirected (`false`).
-%     Default: `false`.
-%   * `graph_fontsize(+float)`
-%     The font size of text in the graph.
-%     Default: `11.0`.
-%   * `graph_label(+atom)`
-%     The graph label.
-%     No default.
-%   * `graph_overlap(+boolean)`
-%     Whether the vertices are allowed to overlap.
-%     Default: `false`.
-
-graph_attributes(GAttrs, Opts):-
-  % Characer set.
-  option(graph_charset(Charset), Opts, &#39;UTF-8&#39;),
-  % Colorscheme.
-  option(graph_colorscheme(Colorscheme), Opts, x11),
-  % Directed.
-  option(graph_directed(Directed), Opts, false),
-  % Fontsize.
-  option(graph_fontsize(Fontsize), Opts, 11.0),
-  % Label.
-  % Defaults to the empty string.
-  option(graph_label(GLabel), Opts, &#39;&amp;quot;&amp;quot;&#39;),
-  % Overlap.
-  option(graph_overlap(Overlap), Opts, false),
-  exclude(
-    option_has_var_value,
-    [
-      charset(Charset),
-      colorscheme(Colorscheme),
-      directed(Directed),
-      fontsize(Fontsize),
-      label(GLabel),
-      overlap(Overlap)
-    ],
-    GAttrs
-  ).
-
-
-
-%! vertex_term(
-%!   +Vertices:ordset(compound),
-%!   +Vertex:compound,
-%!   -VertexTerm:compound,
-%!   +Options:list(compound)
-%! ) is det.
-% The following options are supported:
-%   * `vertex_color(:ColorFunction)`
-%     A function that assigns colors to vertices.
-%     No default.
-%   * `vertex_id(:ColorFunction)`
-%     A functions that assigns unique identifiers to vertices.
-%   * `vertex_image(:ImageFunction)`
-%     A function that assigns images to vertices.
-%     No default.
-%   * `vertex_label(:LabelFunction)`
-%     A function that assigns labels to vertices.
-%     No default.
-%   * `vertex_peripheries(:PeripheriesFunction)`
-%     A function that assinges peripheries to vertices.
-%     No default.
-%   * `vertex_position(:PositionFunction)`
-%     No default.
-%   * `vertex_shape(:ShapeFunction)`
-%     A function that assinges shapes to vertices.
-%     No default.
-%   * `vertex_uri(:UriFunction)`
-
-vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-
-  % Color.
-  if_option(vertex_color(Color_2), Opts, call(Color_2, V, VColor)),
-  
-  % Id.
-  (option(vertex_id(Id_2), Opts) -&amp;gt; call(Id_2, V, VId) ; nth0chk(VId, Vs, V)),
-  
-  % Image.
-  ignore(if_option(vertex_image(Image_2), Opts, call(Image_2, V, VImage))),
-
-  % Label.
-  if_option(vertex_label(VLabel_2), Opts, string_phrase(dcg_call(VLabel_2, V), VLabel)),
-
-  % Peripheries.
-  if_option(vertex_peripheries(Peripheries_2), Opts,
-    call(Peripheries_2, V, VPeripheries)
-  ),
-
-  % Position.
-  if_option(vertex_position(Position_4), Opts,
-    call(Position_4, Vs, Opts, V, VPosition)
-  ),
-
-  % Shape.
-  if_option(vertex_shape(Shape_2), Opts, call(Shape_2, V, VShape)),
-  
-  % URI
-  if_option(vertex_uri(Uri_2), Opts, call(Uri_2, V, VUri)),
-
-  exclude(
-    option_has_var_value,
-    [
-      color(VColor),
-      image(VImage),
-      label(VLabel),
-      peripheries(VPeripheries),
-      pos(VPosition),
-      shape(VShape),
-      &#39;URL&#39;(VUri)
-    ],
-    VAttrs
-  ).
-
-
-
-
-
-% HELPERS %
-
-%! edge_components(+Edge:compound, -FromV, -ToV) is det.
-
-edge_components(edge(FromV,_,ToV), FromV, ToV):- !.
-edge_components(edge(FromV,ToV), FromV, ToV):- !.
-edge_components(FromV-ToV, FromV, ToV):- !.
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
deleted file mode 100644
index f55fce5..0000000
--- a/prolog/gv/gv_attr_type.pl
+++ /dev/null
@@ -1,421 +0,0 @@
-:- module(
-  gv_attr_type,
-  [
-    gv_attr_type//1, % ?Type:atom
-    addDouble//1, % +Double:float
-    addPoint//1, % +Point:compound
-    arrowType//1, % +ArrowType:atom
-    bool//1, % +Boolean:boolean
-    clusterMode//1, % +ClusterMode:atom
-    dirType//1, % +DirectionType:oneof([back,both,forward,none])
-    double//1, % +Double:float
-    doubleList//1, % +Doubles:list(float)
-    escString//1,
-    %layerList//1,
-    %layerRange//1,
-    lblString//1,
-    int//1, % +Integer:integer
-    outputMode//1, % +OutputMode:atom
-    %packMode//1,
-    pagedir//1, % +Pagedir:atom
-    point//1, % +Point:compound
-    pointList//1, % +Points:list(compound)
-    %portPos//1,
-    quadType//1, % +QuadType:atom
-    rankType//1, % +RankType:atom
-    rankdir//1, % +RankDirection:atom
-    rect//1, % +Rectangle:compound
-    shape//1,
-    smoothType//1, % +SmoothType:atom
-    %splineType//1,
-    %startType//1,
-    string//1, % ?Content:atom
-    style//2 % +Context:oneof([cluster,edge,node])
-             % +Style:atom
-    %viewPort//1
-  ]
-).
-:- reexport(
-  library(gv/gv_color),
-  [
-    color//1, % +Color:compound
-    colorList//1 % +ColorList:list(compound)
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz attribute types
-
-@author Wouter Beek
-@version 2015/07, 2015/11, 2016/02
-*/
-
-:- use_module(library(dcg/dcg_ext), except([string//1])).
-:- use_module(library(gv/gv_html)).
-
-
-
-
-
-%! gv_attr_type(?Type:atom) is nondet.
-
-gv_attr_type(addDouble)   --&amp;gt; &amp;quot;addDouble&amp;quot;.
-gv_attr_type(addPoint)    --&amp;gt; &amp;quot;addPoint&amp;quot;.
-gv_attr_type(arrowType)   --&amp;gt; &amp;quot;arrowType&amp;quot;.
-gv_attr_type(bool)        --&amp;gt; &amp;quot;bool&amp;quot;.
-gv_attr_type(color)       --&amp;gt; &amp;quot;color&amp;quot;.
-gv_attr_type(colorList)   --&amp;gt; &amp;quot;colorList&amp;quot;.
-gv_attr_type(clusterMode) --&amp;gt; &amp;quot;clusterMode&amp;quot;.
-gv_attr_type(dirType)     --&amp;gt; &amp;quot;dirType&amp;quot;.
-gv_attr_type(double)      --&amp;gt; &amp;quot;double&amp;quot;.
-gv_attr_type(doubleList)  --&amp;gt; &amp;quot;doubleList&amp;quot;.
-gv_attr_type(escString)   --&amp;gt; &amp;quot;escString&amp;quot;.
-gv_attr_type(layerList)   --&amp;gt; &amp;quot;layerList&amp;quot;.
-gv_attr_type(layerRange)  --&amp;gt; &amp;quot;layerRange&amp;quot;.
-gv_attr_type(lblString)   --&amp;gt; &amp;quot;lblString&amp;quot;.
-gv_attr_type(int)         --&amp;gt; &amp;quot;int&amp;quot;.
-gv_attr_type(outputMode)  --&amp;gt; &amp;quot;outputMode&amp;quot;.
-gv_attr_type(packMode)    --&amp;gt; &amp;quot;packMode&amp;quot;.
-gv_attr_type(pagedir)     --&amp;gt; &amp;quot;pagedir&amp;quot;.
-gv_attr_type(point)       --&amp;gt; &amp;quot;point&amp;quot;.
-gv_attr_type(pointList)   --&amp;gt; &amp;quot;pointList&amp;quot;.
-gv_attr_type(portPos)     --&amp;gt; &amp;quot;portPos&amp;quot;.
-gv_attr_type(quadType)    --&amp;gt; &amp;quot;quadType&amp;quot;.
-gv_attr_type(rankType)    --&amp;gt; &amp;quot;rankType&amp;quot;.
-gv_attr_type(rankdir)     --&amp;gt; &amp;quot;rankdir&amp;quot;.
-gv_attr_type(rect)        --&amp;gt; &amp;quot;rect&amp;quot;.
-gv_attr_type(shape)       --&amp;gt; &amp;quot;shape&amp;quot;.
-gv_attr_type(smoothType)  --&amp;gt; &amp;quot;smoothType&amp;quot;.
-gv_attr_type(splineType)  --&amp;gt; &amp;quot;splineType&amp;quot;.
-gv_attr_type(startType)   --&amp;gt; &amp;quot;startType&amp;quot;.
-gv_attr_type(string)      --&amp;gt; &amp;quot;string&amp;quot;.
-gv_attr_type(style)       --&amp;gt; &amp;quot;style&amp;quot;.
-gv_attr_type(viewPort)    --&amp;gt; &amp;quot;viewPort&amp;quot;.
-
-
-
-%! addDouble(+Float:float)// .
-% An *addDouble* is represented by a Prolog float.
-
-addDouble(N) --&amp;gt; (&amp;quot;+&amp;quot;, ! ; &amp;quot;&amp;quot;), float(N).
-
-
-
-%! addPoint(+Point:compound)// .
-% An *addPoint* is represented by a compound of the following form:
-% `point(X:float,Y:float,InputOnly:boolean)`.
-
-addPoint(Point) --&amp;gt; (&amp;quot;+&amp;quot;, ! ; &amp;quot;&amp;quot;), point(Point).
-
-
-
-%! arrowType(+ArrowType:atom)// .
-
-arrowType(V) --&amp;gt; primitive_shape(V).
-arrowType(V) --&amp;gt; derived(V).
-arrowType(V) --&amp;gt; backwards_compatible(V).
-
-primitive_shape(box)     --&amp;gt; &amp;quot;box&amp;quot;.
-primitive_shape(crow)    --&amp;gt; &amp;quot;crow&amp;quot;.
-primitive_shape(circle)  --&amp;gt; &amp;quot;circle&amp;quot;.
-primitive_shape(diamond) --&amp;gt; &amp;quot;diamond&amp;quot;.
-primitive_shape(dot)     --&amp;gt; &amp;quot;dot&amp;quot;.
-primitive_shape(inv)     --&amp;gt; &amp;quot;inv&amp;quot;.
-primitive_shape(none)    --&amp;gt; &amp;quot;none&amp;quot;.
-primitive_shape(normal)  --&amp;gt; &amp;quot;normal&amp;quot;.
-primitive_shape(tee)     --&amp;gt; &amp;quot;tee&amp;quot;.
-primitive_shape(vee)     --&amp;gt; &amp;quot;vee&amp;quot;.
-
-derived(odot)     --&amp;gt; &amp;quot;odot&amp;quot;.
-derived(invdot)   --&amp;gt; &amp;quot;invdot&amp;quot;.
-derived(invodot)  --&amp;gt; &amp;quot;invodot&amp;quot;.
-derived(obox)     --&amp;gt; &amp;quot;obox&amp;quot;.
-derived(odiamond) --&amp;gt; &amp;quot;odiamond&amp;quot;.
-
-backwards_compatible(ediamond) --&amp;gt; &amp;quot;ediamond&amp;quot;.
-backwards_compatible(empty)    --&amp;gt; &amp;quot;empty&amp;quot;.
-backwards_compatible(halfopen) --&amp;gt; &amp;quot;halfopen&amp;quot;.
-backwards_compatible(invempty) --&amp;gt; &amp;quot;invempty&amp;quot;.
-backwards_compatible(open)     --&amp;gt; &amp;quot;open&amp;quot;.
-
-
-
-%! bool(+Value:boolean)// .
-
-bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
-bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
-bool(true)  --&amp;gt; &amp;quot;true&amp;quot;.
-bool(true)  --&amp;gt; &amp;quot;yes&amp;quot;.
-
-
-
-%! clusterMode(+ClusterMode:atom)// .
-
-clusterMode(global) --&amp;gt; &amp;quot;global&amp;quot;.
-clusterMode(local) --&amp;gt; &amp;quot;local&amp;quot;.
-clusterMode(none) --&amp;gt; &amp;quot;none&amp;quot;.
-
-
-
-%! dirType(+DirectionType:oneof([back,both,forward,none]))// .
-
-dirType(back) --&amp;gt; &amp;quot;back&amp;quot;.
-dirType(both) --&amp;gt; &amp;quot;both&amp;quot;.
-dirType(forward) --&amp;gt; &amp;quot;forward&amp;quot;.
-dirType(none) --&amp;gt; &amp;quot;none&amp;quot;.
-
-
-
-%! double(+Double:float)// .
-
-double(N) --&amp;gt; float(N).
-
-
-
-%! doubleList(+Doubles:list(float))// .
-
-doubleList([H|T]) --&amp;gt; double(H), (&amp;quot;:&amp;quot;, !, doubleList(T) ; {T = []}).
-
-
-
-%! escString(+String:or([atom,string]))// .
-% @tbd Support for context-dependent replacements.
-
-escString(S1) --&amp;gt;
-  {(  string(S1)
-  -&amp;gt;  string_phrase(escape_double_quotes, S1, S2)
-  ;   atom_phrase(escape_double_quotes, S1, S2)
-  )},
-  &amp;quot;\&amp;quot;&amp;quot;, atom(S2), &amp;quot;\&amp;quot;&amp;quot;.
-
-escape_double_quotes, [0&#39;\\,0&#39;&amp;quot;] --&amp;gt; [0&#39;&amp;quot;], !, escape_double_quotes.
-escape_double_quotes, [X]        --&amp;gt; [X],   !, escape_double_quotes.
-escape_double_quotes             --&amp;gt; &amp;quot;&amp;quot;.
-
-
-
-% @tbd layerList
-
-
-
-% @tbd layerRange
-
-
-
-%! lblString(+String:compound)// .
-
-lblString(html_like_label(V)) --&amp;gt; gv_html_like_label(V).
-lblString(V) --&amp;gt; escString(V).
-
-
-
-%! int(+Integer:integer)// .
-
-int(V) --&amp;gt; integer(V).
-
-
-
-%! outputMode(+OutputMode:atom)// .
-
-outputMode(breadthfirst) --&amp;gt; &amp;quot;breadthfirst&amp;quot;.
-outputMode(edgesfirst)   --&amp;gt; &amp;quot;edgesfirst&amp;quot;.
-outputMode(nodesfirst)   --&amp;gt; &amp;quot;nodesfirst&amp;quot;.
-
-
-
-% @tbd packMode
-
-
-
-%! pagedir(+PageDirection:atom)// .
-
-pagedir(&#39;BL&#39;) --&amp;gt; &amp;quot;BL&amp;quot;.
-pagedir(&#39;BR&#39;) --&amp;gt; &amp;quot;BR&amp;quot;.
-pagedir(&#39;LB&#39;) --&amp;gt; &amp;quot;LB&amp;quot;.
-pagedir(&#39;LT&#39;) --&amp;gt; &amp;quot;LT&amp;quot;.
-pagedir(&#39;RB&#39;) --&amp;gt; &amp;quot;RB&amp;quot;.
-pagedir(&#39;RT&#39;) --&amp;gt; &amp;quot;RT&amp;quot;.
-pagedir(&#39;TL&#39;) --&amp;gt; &amp;quot;TL&amp;quot;.
-pagedir(&#39;TR&#39;) --&amp;gt; &amp;quot;TR&amp;quot;.
-
-
-
-%! point(+Point:compound)// .
-% A *point* is represented by a compound of the following form:
-% `point(X:float,Y:float,Changeable:boolean)`.
-
-point(point(X,Y,Changeable)) --&amp;gt;
-  float(X), &amp;quot;,&amp;quot;, float(Y),
-  input_changeable(Changeable).
-
-input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
-input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
-
-
-
-%! pointList(+Points:list(compound))// .
-
-pointList(Points) --&amp;gt;
-  *(point, Points).
-
-
-
-% @tbd portPos
-
-
-
-%! quadType(+QuadType:atom)// .
-
-quadType(fast) --&amp;gt; &amp;quot;fast&amp;quot;.
-quadType(none) --&amp;gt; &amp;quot;none&amp;quot;.
-quadType(normal) --&amp;gt; &amp;quot;normal&amp;quot;.
-
-
-
-%! rankType(+RankType:atom)// .
-
-rankType(max) --&amp;gt; &amp;quot;max&amp;quot;.
-rankType(min) --&amp;gt; &amp;quot;min&amp;quot;.
-rankType(same) --&amp;gt; &amp;quot;same&amp;quot;.
-rankType(sink) --&amp;gt; &amp;quot;sink&amp;quot;.
-rankType(source) --&amp;gt; &amp;quot;source&amp;quot;.
-
-
-
-%! rankdir(+RankDirection:oneof([&#39;BT&#39;,&#39;LR&#39;,&#39;RL&#39;,&#39;TB&#39;]))// .
-
-rankdir(&#39;BT&#39;) --&amp;gt; &amp;quot;BT&amp;quot;.
-rankdir(&#39;LR&#39;) --&amp;gt; &amp;quot;LR&amp;quot;.
-rankdir(&#39;RL&#39;) --&amp;gt; &amp;quot;RL&amp;quot;.
-rankdir(&#39;TB&#39;) --&amp;gt; &amp;quot;TB&amp;quot;.
-
-
-
-%! rect(+Rectangle:compound)// .
-
-rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), &amp;quot;,&amp;quot;,
-  float(LowerLeftY), &amp;quot;,&amp;quot;,
-  float(UpperRightX), &amp;quot;,&amp;quot;,
-  float(UpperRightY).
-
-
-
-%! shape(+Shape:atom)// .
-
-shape(V) --&amp;gt; {polygon_based_shape(V)}, atom(V).
-
-polygon_based_shape(assembly).
-polygon_based_shape(box).
-polygon_based_shape(box3d).
-polygon_based_shape(cds).
-polygon_based_shape(circle).
-polygon_based_shape(component).
-polygon_based_shape(diamond).
-polygon_based_shape(doublecircle).
-polygon_based_shape(doubleoctagon).
-polygon_based_shape(egg).
-polygon_based_shape(ellipse).
-polygon_based_shape(fivepoverhang).
-polygon_based_shape(folder).
-polygon_based_shape(hexagon).
-polygon_based_shape(house).
-polygon_based_shape(insulator).
-polygon_based_shape(invhouse).
-polygon_based_shape(invtrapezium).
-polygon_based_shape(invtriangle).
-polygon_based_shape(larrow).
-polygon_based_shape(lpromoter).
-polygon_based_shape(&#39;Mcircle&#39;).
-polygon_based_shape(&#39;Mdiamond&#39;).
-polygon_based_shape(&#39;Msquare&#39;).
-polygon_based_shape(none).
-polygon_based_shape(note).
-polygon_based_shape(noverhang).
-polygon_based_shape(octagon).
-polygon_based_shape(oval).
-polygon_based_shape(parallelogram).
-polygon_based_shape(pentagon).
-polygon_based_shape(plaintext).
-polygon_based_shape(point).
-polygon_based_shape(polygon).
-polygon_based_shape(primersite).
-polygon_based_shape(promoter).
-polygon_based_shape(proteasesite).
-polygon_based_shape(proteinstab).
-polygon_based_shape(rarrow).
-polygon_based_shape(rect).
-polygon_based_shape(rectangle).
-polygon_based_shape(restrictionsite).
-polygon_based_shape(ribosite).
-polygon_based_shape(rnastab).
-polygon_based_shape(rpromoter).
-polygon_based_shape(septagon).
-polygon_based_shape(signature).
-polygon_based_shape(square).
-polygon_based_shape(tab).
-polygon_based_shape(terminator).
-polygon_based_shape(threepoverhang).
-polygon_based_shape(trapezium).
-polygon_based_shape(triangle).
-polygon_based_shape(tripleoctagon).
-polygon_based_shape(utr).
-
-
-
-%! smoothType(+SmoothType:atom)// .
-
-smoothType(V) --&amp;gt; {smoothType(V)}, atom(V).
-
-smoothType(avg_dist).
-smoothType(graph_dist).
-smoothType(none).
-smoothType(power_dist).
-smoothType(rng).
-smoothType(spring).
-smoothType(triangle).
-
-
-
-% @tbd splineType
-
-
-
-% @tbd startType
-
-
-
-%! string(?String:atom)// .
-% A GraphViz string.
-
-string(Content) --&amp;gt; &amp;quot;\&amp;quot;&amp;quot;, atom(Content), &amp;quot;\&amp;quot;&amp;quot;.
-
-
-
-%! style(?Context:oneof([cluster,edge,node]), ?Style:atom) is nondet.
-
-style(Context, Style) --&amp;gt; {style(Context, Style)}, atom(Style).
-
-style(cluster, bold).
-style(cluster, dashed).
-style(cluster, dotted).
-style(cluster, filled).
-style(cluster, rounded).
-style(cluster, solid).
-style(cluster, striped).
-style(edge, bold).
-style(edge, dashed).
-style(edge, dotted).
-style(edge, solid).
-style(node, bold).
-style(node, dashed).
-style(node, diagonals).
-style(node, dotted).
-style(node, filled).
-style(node, rounded).
-style(node, solid).
-style(node, striped).
-style(node, wedged).
-
-
-
-% @tbd viewPort
diff --git a/prolog/gv/gv_attrs.data b/prolog/gv/gv_attrs.data
deleted file mode 100644
index 95fc680..0000000
--- a/prolog/gv/gv_attrs.data
+++ /dev/null
@@ -1,169 +0,0 @@
-gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;).
-gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;).
-gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_G59448,&#39;&#39;,&#39;svg, postscript, map only&#39;).
-gv_attr(&#39;_background&#39;,[graph],[string],_G59644,&#39;&#39;,&#39;&#39;).
-gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;).
-gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;).
-gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
-gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;).
-gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(bgcolor,[cluster,graph],[color,colorList],_G60571,&#39;&#39;,&#39;&#39;).
-gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
-gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;).
-gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
-gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;).
-gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;).
-gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;).
-gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;).
-gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;).
-gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;).
-gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;).
-gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(edgetarget,[edge],[escString],_G63711,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
-gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;).
-gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;).
-gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;).
-gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;).
-gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;).
-gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;).
-gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;).
-gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;).
-gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;).
-gv_attr(headtarget,[edge],[escString],_G4892,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
-gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;).
-gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;).
-gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;).
-gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;).
-gv_attr(inputscale,[graph],[double],_G6250,&#39;&#39;,&#39;fdp, neato only&#39;).
-gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;).
-gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;).
-gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
-gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;).
-gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;).
-gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;).
-gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(labeltarget,[edge],[escString],_G8276,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
-gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
-gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
-gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;).
-gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;).
-gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
-gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;).
-gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;).
-gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;).
-gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;).
-gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;).
-gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;).
-gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;).
-gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;).
-gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;).
-gv_attr(nslimitnslimit1,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;).
-gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;).
-gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;).
-gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;).
-gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;).
-gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;).
-gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;).
-gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;).
-gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
-gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;).
-gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;).
-gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;).
-gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;).
-gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;).
-gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;).
-gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;).
-gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;).
-gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;).
-gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;).
-gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;).
-gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;).
-gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;).
-gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;).
-gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;).
-gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;).
-gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;).
-gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;).
-gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;).
-gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
-gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;).
-gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;).
-gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;).
-gv_attr(tailtarget,[edge],[escString],_G21528,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
-gv_attr(target,[cluster,edge,graph,node],[escString,string],_G21878,&#39;&#39;,&#39;svg, map only&#39;).
-gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
-gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;).
-gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;).
-gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;).
-gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;).
-gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;).
-gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
-gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
-gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
deleted file mode 100644
index 4a92d5b..0000000
--- a/prolog/gv/gv_attrs.pl
+++ /dev/null
@@ -1,76 +0,0 @@
-:- module(
-  gv_attrs,
-  [
-    gv_attr_value//2 % +Context:oneof([cluster,edge,graph,node,subgraph])
-                     % +Attr
-  ]
-).
-:- ensure_loaded(library(&#39;gv/gv_attrs.data&#39;)).
-
-/** &amp;lt;module&amp;gt; GraphViz attributes
-
-@author Wouter Beek
-@version 2015/07-2015/08, 2015/10, 2016/03
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(error)).
-:- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
-:- use_module(library(lists)).
-:- use_module(library(os/file_ext)).
-
-
-
-
-
-%! gv_attr_value(+Context, +Attr)// is det.
-% Uses the default value in case Value is uninstantiated.
-% Otherwise, performs a typecheck and converts the given value.
-%
-% Context can be either `cluster`, `edge`, `graph`, `node` or `subgraph`.
-
-% Use the default if no value is given.
-gv_attr_value(Context, Name=Value) --&amp;gt;
-  {
-    var(Value),
-    gv_attr(Name, UsedBy, _, DefaultValue, _, _),
-    % Check validity of context.
-    memberchk(Context, UsedBy)
-  }, !,
-  gv_attr_value(Context, Name=DefaultValue).
-gv_attr_value(Context, Name=Value) --&amp;gt;
-  {
-    % Check the validity of the context argument.
-    gv_attr(Name, UsedBy, Types, _, Minimum, _),
-    memberchk(Context, UsedBy),
-
-    %  Pick a value type non-deterministically.
-    member(Type, Types),
-
-    % The `style` type is the only one that requires the context argument.
-    (   Type == style
-    -&amp;gt;  Dcg =.. [Type,Context]
-    ;   Dcg =.. [Type]
-    ),
-
-    % Check validity of Value w.r.t. minimum value -- if available.
-    check_minimum(Value, Minimum)
-  }, !,
-  dcg_call(gv_attr_type:Dcg, Value).
-gv_attr_value(_, Name=_) --&amp;gt;
-  {existence_error(gv_attr, Name)}.
-
-
-
-
-
-% HELPERS %
-
-%! check_minimum(+Value:atom, +Minimum:number) is semidet.
-% Trivially succeeds if no minimum value is available for a given attribute.
-
-check_minimum(_, &#39;&#39;):- !.
-check_minimum(V, Min1):-
-  atom_number(Min1, Min2),
-  Min2 =&amp;lt; V.
diff --git a/prolog/gv/gv_color.data b/prolog/gv/gv_color.data
deleted file mode 100644
index 166b13c..0000000
--- a/prolog/gv/gv_color.data
+++ /dev/null
@@ -1,802 +0,0 @@
-gv_color(x11,aliceblue).
-gv_color(x11,antiquewhite).
-gv_color(x11,antiquewhite1).
-gv_color(x11,antiquewhite2).
-gv_color(x11,antiquewhite3).
-gv_color(x11,antiquewhite4).
-gv_color(x11,aquamarine).
-gv_color(x11,aquamarine1).
-gv_color(x11,aquamarine2).
-gv_color(x11,aquamarine3).
-gv_color(x11,aquamarine4).
-gv_color(x11,azure).
-gv_color(x11,azure1).
-gv_color(x11,azure2).
-gv_color(x11,azure3).
-gv_color(x11,azure4).
-gv_color(x11,beige).
-gv_color(x11,bisque).
-gv_color(x11,bisque1).
-gv_color(x11,bisque2).
-gv_color(x11,bisque3).
-gv_color(x11,bisque4).
-gv_color(x11,black).
-gv_color(x11,blanchedalmond).
-gv_color(x11,blue).
-gv_color(x11,blue1).
-gv_color(x11,blue2).
-gv_color(x11,blue3).
-gv_color(x11,blue4).
-gv_color(x11,blueviolet).
-gv_color(x11,brown).
-gv_color(x11,brown1).
-gv_color(x11,brown2).
-gv_color(x11,brown3).
-gv_color(x11,brown4).
-gv_color(x11,burlywood).
-gv_color(x11,burlywood1).
-gv_color(x11,burlywood2).
-gv_color(x11,burlywood3).
-gv_color(x11,burlywood4).
-gv_color(x11,cadetblue).
-gv_color(x11,cadetblue1).
-gv_color(x11,cadetblue2).
-gv_color(x11,cadetblue3).
-gv_color(x11,cadetblue4).
-gv_color(x11,chartreuse).
-gv_color(x11,chartreuse1).
-gv_color(x11,chartreuse2).
-gv_color(x11,chartreuse3).
-gv_color(x11,chartreuse4).
-gv_color(x11,chocolate).
-gv_color(x11,chocolate1).
-gv_color(x11,chocolate2).
-gv_color(x11,chocolate3).
-gv_color(x11,chocolate4).
-gv_color(x11,coral).
-gv_color(x11,coral1).
-gv_color(x11,coral2).
-gv_color(x11,coral3).
-gv_color(x11,coral4).
-gv_color(x11,cornflowerblue).
-gv_color(x11,cornsilk).
-gv_color(x11,cornsilk1).
-gv_color(x11,cornsilk2).
-gv_color(x11,cornsilk3).
-gv_color(x11,cornsilk4).
-gv_color(x11,crimson).
-gv_color(x11,cyan).
-gv_color(x11,cyan1).
-gv_color(x11,cyan2).
-gv_color(x11,cyan3).
-gv_color(x11,cyan4).
-gv_color(x11,darkgoldenrod).
-gv_color(x11,darkgoldenrod1).
-gv_color(x11,darkgoldenrod2).
-gv_color(x11,darkgoldenrod3).
-gv_color(x11,darkgoldenrod4).
-gv_color(x11,darkgreen).
-gv_color(x11,darkkhaki).
-gv_color(x11,darkolivegreen).
-gv_color(x11,darkolivegreen1).
-gv_color(x11,darkolivegreen2).
-gv_color(x11,darkolivegreen3).
-gv_color(x11,darkolivegreen4).
-gv_color(x11,darkorange).
-gv_color(x11,darkorange1).
-gv_color(x11,darkorange2).
-gv_color(x11,darkorange3).
-gv_color(x11,darkorange4).
-gv_color(x11,darkorchid).
-gv_color(x11,darkorchid1).
-gv_color(x11,darkorchid2).
-gv_color(x11,darkorchid3).
-gv_color(x11,darkorchid4).
-gv_color(x11,darksalmon).
-gv_color(x11,darkseagreen).
-gv_color(x11,darkseagreen1).
-gv_color(x11,darkseagreen2).
-gv_color(x11,darkseagreen3).
-gv_color(x11,darkseagreen4).
-gv_color(x11,darkslateblue).
-gv_color(x11,darkslategray).
-gv_color(x11,darkslategray1).
-gv_color(x11,darkslategray2).
-gv_color(x11,darkslategray3).
-gv_color(x11,darkslategray4).
-gv_color(x11,darkslategrey).
-gv_color(x11,darkturquoise).
-gv_color(x11,darkviolet).
-gv_color(x11,deeppink).
-gv_color(x11,deeppink1).
-gv_color(x11,deeppink2).
-gv_color(x11,deeppink3).
-gv_color(x11,deeppink4).
-gv_color(x11,deepskyblue).
-gv_color(x11,deepskyblue1).
-gv_color(x11,deepskyblue2).
-gv_color(x11,deepskyblue3).
-gv_color(x11,deepskyblue4).
-gv_color(x11,dimgray).
-gv_color(x11,dimgrey).
-gv_color(x11,dodgerblue).
-gv_color(x11,dodgerblue1).
-gv_color(x11,dodgerblue2).
-gv_color(x11,dodgerblue3).
-gv_color(x11,dodgerblue4).
-gv_color(x11,firebrick).
-gv_color(x11,firebrick1).
-gv_color(x11,firebrick2).
-gv_color(x11,firebrick3).
-gv_color(x11,firebrick4).
-gv_color(x11,floralwhite).
-gv_color(x11,forestgreen).
-gv_color(x11,gainsboro).
-gv_color(x11,ghostwhite).
-gv_color(x11,gold).
-gv_color(x11,gold1).
-gv_color(x11,gold2).
-gv_color(x11,gold3).
-gv_color(x11,gold4).
-gv_color(x11,goldenrod).
-gv_color(x11,goldenrod1).
-gv_color(x11,goldenrod2).
-gv_color(x11,goldenrod3).
-gv_color(x11,goldenrod4).
-gv_color(x11,gray).
-gv_color(x11,gray0).
-gv_color(x11,gray1).
-gv_color(x11,gray10).
-gv_color(x11,gray100).
-gv_color(x11,gray11).
-gv_color(x11,gray12).
-gv_color(x11,gray13).
-gv_color(x11,gray14).
-gv_color(x11,gray15).
-gv_color(x11,gray16).
-gv_color(x11,gray17).
-gv_color(x11,gray18).
-gv_color(x11,gray19).
-gv_color(x11,gray2).
-gv_color(x11,gray20).
-gv_color(x11,gray21).
-gv_color(x11,gray22).
-gv_color(x11,gray23).
-gv_color(x11,gray24).
-gv_color(x11,gray25).
-gv_color(x11,gray26).
-gv_color(x11,gray27).
-gv_color(x11,gray28).
-gv_color(x11,gray29).
-gv_color(x11,gray3).
-gv_color(x11,gray30).
-gv_color(x11,gray31).
-gv_color(x11,gray32).
-gv_color(x11,gray33).
-gv_color(x11,gray34).
-gv_color(x11,gray35).
-gv_color(x11,gray36).
-gv_color(x11,gray37).
-gv_color(x11,gray38).
-gv_color(x11,gray39).
-gv_color(x11,gray4).
-gv_color(x11,gray40).
-gv_color(x11,gray41).
-gv_color(x11,gray42).
-gv_color(x11,gray43).
-gv_color(x11,gray44).
-gv_color(x11,gray45).
-gv_color(x11,gray46).
-gv_color(x11,gray47).
-gv_color(x11,gray48).
-gv_color(x11,gray49).
-gv_color(x11,gray5).
-gv_color(x11,gray50).
-gv_color(x11,gray51).
-gv_color(x11,gray52).
-gv_color(x11,gray53).
-gv_color(x11,gray54).
-gv_color(x11,gray55).
-gv_color(x11,gray56).
-gv_color(x11,gray57).
-gv_color(x11,gray58).
-gv_color(x11,gray59).
-gv_color(x11,gray6).
-gv_color(x11,gray60).
-gv_color(x11,gray61).
-gv_color(x11,gray62).
-gv_color(x11,gray63).
-gv_color(x11,gray64).
-gv_color(x11,gray65).
-gv_color(x11,gray66).
-gv_color(x11,gray67).
-gv_color(x11,gray68).
-gv_color(x11,gray69).
-gv_color(x11,gray7).
-gv_color(x11,gray70).
-gv_color(x11,gray71).
-gv_color(x11,gray72).
-gv_color(x11,gray73).
-gv_color(x11,gray74).
-gv_color(x11,gray75).
-gv_color(x11,gray76).
-gv_color(x11,gray77).
-gv_color(x11,gray78).
-gv_color(x11,gray79).
-gv_color(x11,gray8).
-gv_color(x11,gray80).
-gv_color(x11,gray81).
-gv_color(x11,gray82).
-gv_color(x11,gray83).
-gv_color(x11,gray84).
-gv_color(x11,gray85).
-gv_color(x11,gray86).
-gv_color(x11,gray87).
-gv_color(x11,gray88).
-gv_color(x11,gray89).
-gv_color(x11,gray9).
-gv_color(x11,gray90).
-gv_color(x11,gray91).
-gv_color(x11,gray92).
-gv_color(x11,gray93).
-gv_color(x11,gray94).
-gv_color(x11,gray95).
-gv_color(x11,gray96).
-gv_color(x11,gray97).
-gv_color(x11,gray98).
-gv_color(x11,gray99).
-gv_color(x11,green).
-gv_color(x11,green1).
-gv_color(x11,green2).
-gv_color(x11,green3).
-gv_color(x11,green4).
-gv_color(x11,greenyellow).
-gv_color(x11,grey).
-gv_color(x11,grey0).
-gv_color(x11,grey1).
-gv_color(x11,grey10).
-gv_color(x11,grey100).
-gv_color(x11,grey11).
-gv_color(x11,grey12).
-gv_color(x11,grey13).
-gv_color(x11,grey14).
-gv_color(x11,grey15).
-gv_color(x11,grey16).
-gv_color(x11,grey17).
-gv_color(x11,grey18).
-gv_color(x11,grey19).
-gv_color(x11,grey2).
-gv_color(x11,grey20).
-gv_color(x11,grey21).
-gv_color(x11,grey22).
-gv_color(x11,grey23).
-gv_color(x11,grey24).
-gv_color(x11,grey25).
-gv_color(x11,grey26).
-gv_color(x11,grey27).
-gv_color(x11,grey28).
-gv_color(x11,grey29).
-gv_color(x11,grey3).
-gv_color(x11,grey30).
-gv_color(x11,grey31).
-gv_color(x11,grey32).
-gv_color(x11,grey33).
-gv_color(x11,grey34).
-gv_color(x11,grey35).
-gv_color(x11,grey36).
-gv_color(x11,grey37).
-gv_color(x11,grey38).
-gv_color(x11,grey39).
-gv_color(x11,grey4).
-gv_color(x11,grey40).
-gv_color(x11,grey41).
-gv_color(x11,grey42).
-gv_color(x11,grey43).
-gv_color(x11,grey44).
-gv_color(x11,grey45).
-gv_color(x11,grey46).
-gv_color(x11,grey47).
-gv_color(x11,grey48).
-gv_color(x11,grey49).
-gv_color(x11,grey5).
-gv_color(x11,grey50).
-gv_color(x11,grey51).
-gv_color(x11,grey52).
-gv_color(x11,grey53).
-gv_color(x11,grey54).
-gv_color(x11,grey55).
-gv_color(x11,grey56).
-gv_color(x11,grey57).
-gv_color(x11,grey58).
-gv_color(x11,grey59).
-gv_color(x11,grey6).
-gv_color(x11,grey60).
-gv_color(x11,grey61).
-gv_color(x11,grey62).
-gv_color(x11,grey63).
-gv_color(x11,grey64).
-gv_color(x11,grey65).
-gv_color(x11,grey66).
-gv_color(x11,grey67).
-gv_color(x11,grey68).
-gv_color(x11,grey69).
-gv_color(x11,grey7).
-gv_color(x11,grey70).
-gv_color(x11,grey71).
-gv_color(x11,grey72).
-gv_color(x11,grey73).
-gv_color(x11,grey74).
-gv_color(x11,grey75).
-gv_color(x11,grey76).
-gv_color(x11,grey77).
-gv_color(x11,grey78).
-gv_color(x11,grey79).
-gv_color(x11,grey8).
-gv_color(x11,grey80).
-gv_color(x11,grey81).
-gv_color(x11,grey82).
-gv_color(x11,grey83).
-gv_color(x11,grey84).
-gv_color(x11,grey85).
-gv_color(x11,grey86).
-gv_color(x11,grey87).
-gv_color(x11,grey88).
-gv_color(x11,grey89).
-gv_color(x11,grey9).
-gv_color(x11,grey90).
-gv_color(x11,grey91).
-gv_color(x11,grey92).
-gv_color(x11,grey93).
-gv_color(x11,grey94).
-gv_color(x11,grey95).
-gv_color(x11,grey96).
-gv_color(x11,grey97).
-gv_color(x11,grey98).
-gv_color(x11,grey99).
-gv_color(x11,honeydew).
-gv_color(x11,honeydew1).
-gv_color(x11,honeydew2).
-gv_color(x11,honeydew3).
-gv_color(x11,honeydew4).
-gv_color(x11,hotpink).
-gv_color(x11,hotpink1).
-gv_color(x11,hotpink2).
-gv_color(x11,hotpink3).
-gv_color(x11,hotpink4).
-gv_color(x11,indianred).
-gv_color(x11,indianred1).
-gv_color(x11,indianred2).
-gv_color(x11,indianred3).
-gv_color(x11,indianred4).
-gv_color(x11,indigo).
-gv_color(x11,invis).
-gv_color(x11,ivory).
-gv_color(x11,ivory1).
-gv_color(x11,ivory2).
-gv_color(x11,ivory3).
-gv_color(x11,ivory4).
-gv_color(x11,khaki).
-gv_color(x11,khaki1).
-gv_color(x11,khaki2).
-gv_color(x11,khaki3).
-gv_color(x11,khaki4).
-gv_color(x11,lavender).
-gv_color(x11,lavenderblush).
-gv_color(x11,lavenderblush1).
-gv_color(x11,lavenderblush2).
-gv_color(x11,lavenderblush3).
-gv_color(x11,lavenderblush4).
-gv_color(x11,lawngreen).
-gv_color(x11,lemonchiffon).
-gv_color(x11,lemonchiffon1).
-gv_color(x11,lemonchiffon2).
-gv_color(x11,lemonchiffon3).
-gv_color(x11,lemonchiffon4).
-gv_color(x11,lightblue).
-gv_color(x11,lightblue1).
-gv_color(x11,lightblue2).
-gv_color(x11,lightblue3).
-gv_color(x11,lightblue4).
-gv_color(x11,lightcoral).
-gv_color(x11,lightcyan).
-gv_color(x11,lightcyan1).
-gv_color(x11,lightcyan2).
-gv_color(x11,lightcyan3).
-gv_color(x11,lightcyan4).
-gv_color(x11,lightgoldenrod).
-gv_color(x11,lightgoldenrod1).
-gv_color(x11,lightgoldenrod2).
-gv_color(x11,lightgoldenrod3).
-gv_color(x11,lightgoldenrod4).
-gv_color(x11,lightgoldenrodyellow).
-gv_color(x11,lightgray).
-gv_color(x11,lightgrey).
-gv_color(x11,lightpink).
-gv_color(x11,lightpink1).
-gv_color(x11,lightpink2).
-gv_color(x11,lightpink3).
-gv_color(x11,lightpink4).
-gv_color(x11,lightsalmon).
-gv_color(x11,lightsalmon1).
-gv_color(x11,lightsalmon2).
-gv_color(x11,lightsalmon3).
-gv_color(x11,lightsalmon4).
-gv_color(x11,lightseagreen).
-gv_color(x11,lightskyblue).
-gv_color(x11,lightskyblue1).
-gv_color(x11,lightskyblue2).
-gv_color(x11,lightskyblue3).
-gv_color(x11,lightskyblue4).
-gv_color(x11,lightslateblue).
-gv_color(x11,lightslategray).
-gv_color(x11,lightslategrey).
-gv_color(x11,lightsteelblue).
-gv_color(x11,lightsteelblue1).
-gv_color(x11,lightsteelblue2).
-gv_color(x11,lightsteelblue3).
-gv_color(x11,lightsteelblue4).
-gv_color(x11,lightyellow).
-gv_color(x11,lightyellow1).
-gv_color(x11,lightyellow2).
-gv_color(x11,lightyellow3).
-gv_color(x11,lightyellow4).
-gv_color(x11,limegreen).
-gv_color(x11,linen).
-gv_color(x11,magenta).
-gv_color(x11,magenta1).
-gv_color(x11,magenta2).
-gv_color(x11,magenta3).
-gv_color(x11,magenta4).
-gv_color(x11,maroon).
-gv_color(x11,maroon1).
-gv_color(x11,maroon2).
-gv_color(x11,maroon3).
-gv_color(x11,maroon4).
-gv_color(x11,mediumaquamarine).
-gv_color(x11,mediumblue).
-gv_color(x11,mediumorchid).
-gv_color(x11,mediumorchid1).
-gv_color(x11,mediumorchid2).
-gv_color(x11,mediumorchid3).
-gv_color(x11,mediumorchid4).
-gv_color(x11,mediumpurple).
-gv_color(x11,mediumpurple1).
-gv_color(x11,mediumpurple2).
-gv_color(x11,mediumpurple3).
-gv_color(x11,mediumpurple4).
-gv_color(x11,mediumseagreen).
-gv_color(x11,mediumslateblue).
-gv_color(x11,mediumspringgreen).
-gv_color(x11,mediumturquoise).
-gv_color(x11,mediumvioletred).
-gv_color(x11,midnightblue).
-gv_color(x11,mintcream).
-gv_color(x11,mistyrose).
-gv_color(x11,mistyrose1).
-gv_color(x11,mistyrose2).
-gv_color(x11,mistyrose3).
-gv_color(x11,mistyrose4).
-gv_color(x11,moccasin).
-gv_color(x11,navajowhite).
-gv_color(x11,navajowhite1).
-gv_color(x11,navajowhite2).
-gv_color(x11,navajowhite3).
-gv_color(x11,navajowhite4).
-gv_color(x11,navy).
-gv_color(x11,navyblue).
-gv_color(x11,none).
-gv_color(x11,oldlace).
-gv_color(x11,olivedrab).
-gv_color(x11,olivedrab1).
-gv_color(x11,olivedrab2).
-gv_color(x11,olivedrab3).
-gv_color(x11,olivedrab4).
-gv_color(x11,orange).
-gv_color(x11,orange1).
-gv_color(x11,orange2).
-gv_color(x11,orange3).
-gv_color(x11,orange4).
-gv_color(x11,orangered).
-gv_color(x11,orangered1).
-gv_color(x11,orangered2).
-gv_color(x11,orangered3).
-gv_color(x11,orangered4).
-gv_color(x11,orchid).
-gv_color(x11,orchid1).
-gv_color(x11,orchid2).
-gv_color(x11,orchid3).
-gv_color(x11,orchid4).
-gv_color(x11,palegoldenrod).
-gv_color(x11,palegreen).
-gv_color(x11,palegreen1).
-gv_color(x11,palegreen2).
-gv_color(x11,palegreen3).
-gv_color(x11,palegreen4).
-gv_color(x11,paleturquoise).
-gv_color(x11,paleturquoise1).
-gv_color(x11,paleturquoise2).
-gv_color(x11,paleturquoise3).
-gv_color(x11,paleturquoise4).
-gv_color(x11,palevioletred).
-gv_color(x11,palevioletred1).
-gv_color(x11,palevioletred2).
-gv_color(x11,palevioletred3).
-gv_color(x11,palevioletred4).
-gv_color(x11,papayawhip).
-gv_color(x11,peachpuff).
-gv_color(x11,peachpuff1).
-gv_color(x11,peachpuff2).
-gv_color(x11,peachpuff3).
-gv_color(x11,peachpuff4).
-gv_color(x11,peru).
-gv_color(x11,pink).
-gv_color(x11,pink1).
-gv_color(x11,pink2).
-gv_color(x11,pink3).
-gv_color(x11,pink4).
-gv_color(x11,plum).
-gv_color(x11,plum1).
-gv_color(x11,plum2).
-gv_color(x11,plum3).
-gv_color(x11,plum4).
-gv_color(x11,powderblue).
-gv_color(x11,purple).
-gv_color(x11,purple1).
-gv_color(x11,purple2).
-gv_color(x11,purple3).
-gv_color(x11,purple4).
-gv_color(x11,red).
-gv_color(x11,red1).
-gv_color(x11,red2).
-gv_color(x11,red3).
-gv_color(x11,red4).
-gv_color(x11,rosybrown).
-gv_color(x11,rosybrown1).
-gv_color(x11,rosybrown2).
-gv_color(x11,rosybrown3).
-gv_color(x11,rosybrown4).
-gv_color(x11,royalblue).
-gv_color(x11,royalblue1).
-gv_color(x11,royalblue2).
-gv_color(x11,royalblue3).
-gv_color(x11,royalblue4).
-gv_color(x11,saddlebrown).
-gv_color(x11,salmon).
-gv_color(x11,salmon1).
-gv_color(x11,salmon2).
-gv_color(x11,salmon3).
-gv_color(x11,salmon4).
-gv_color(x11,sandybrown).
-gv_color(x11,seagreen).
-gv_color(x11,seagreen1).
-gv_color(x11,seagreen2).
-gv_color(x11,seagreen3).
-gv_color(x11,seagreen4).
-gv_color(x11,seashell).
-gv_color(x11,seashell1).
-gv_color(x11,seashell2).
-gv_color(x11,seashell3).
-gv_color(x11,seashell4).
-gv_color(x11,sienna).
-gv_color(x11,sienna1).
-gv_color(x11,sienna2).
-gv_color(x11,sienna3).
-gv_color(x11,sienna4).
-gv_color(x11,skyblue).
-gv_color(x11,skyblue1).
-gv_color(x11,skyblue2).
-gv_color(x11,skyblue3).
-gv_color(x11,skyblue4).
-gv_color(x11,slateblue).
-gv_color(x11,slateblue1).
-gv_color(x11,slateblue2).
-gv_color(x11,slateblue3).
-gv_color(x11,slateblue4).
-gv_color(x11,slategray).
-gv_color(x11,slategray1).
-gv_color(x11,slategray2).
-gv_color(x11,slategray3).
-gv_color(x11,slategray4).
-gv_color(x11,slategrey).
-gv_color(x11,snow).
-gv_color(x11,snow1).
-gv_color(x11,snow2).
-gv_color(x11,snow3).
-gv_color(x11,snow4).
-gv_color(x11,springgreen).
-gv_color(x11,springgreen1).
-gv_color(x11,springgreen2).
-gv_color(x11,springgreen3).
-gv_color(x11,springgreen4).
-gv_color(x11,steelblue).
-gv_color(x11,steelblue1).
-gv_color(x11,steelblue2).
-gv_color(x11,steelblue3).
-gv_color(x11,steelblue4).
-gv_color(x11,tan).
-gv_color(x11,tan1).
-gv_color(x11,tan2).
-gv_color(x11,tan3).
-gv_color(x11,tan4).
-gv_color(x11,thistle).
-gv_color(x11,thistle1).
-gv_color(x11,thistle2).
-gv_color(x11,thistle3).
-gv_color(x11,thistle4).
-gv_color(x11,tomato).
-gv_color(x11,tomato1).
-gv_color(x11,tomato2).
-gv_color(x11,tomato3).
-gv_color(x11,tomato4).
-gv_color(x11,transparent).
-gv_color(x11,turquoise).
-gv_color(x11,turquoise1).
-gv_color(x11,turquoise2).
-gv_color(x11,turquoise3).
-gv_color(x11,turquoise4).
-gv_color(x11,violet).
-gv_color(x11,violetred).
-gv_color(x11,violetred1).
-gv_color(x11,violetred2).
-gv_color(x11,violetred3).
-gv_color(x11,violetred4).
-gv_color(x11,wheat).
-gv_color(x11,wheat1).
-gv_color(x11,wheat2).
-gv_color(x11,wheat3).
-gv_color(x11,wheat4).
-gv_color(x11,white).
-gv_color(x11,whitesmoke).
-gv_color(x11,yellow).
-gv_color(x11,yellow1).
-gv_color(x11,yellow2).
-gv_color(x11,yellow3).
-gv_color(x11,yellow4).
-gv_color(x11,yellowgreen).
-gv_color(svg,aliceblue).
-gv_color(svg,antiquewhite).
-gv_color(svg,aqua).
-gv_color(svg,aquamarine).
-gv_color(svg,azure).
-gv_color(svg,beige).
-gv_color(svg,bisque).
-gv_color(svg,black).
-gv_color(svg,blanchedalmond).
-gv_color(svg,blue).
-gv_color(svg,blueviolet).
-gv_color(svg,brown).
-gv_color(svg,burlywood).
-gv_color(svg,cadetblue).
-gv_color(svg,chartreuse).
-gv_color(svg,chocolate).
-gv_color(svg,coral).
-gv_color(svg,cornflowerblue).
-gv_color(svg,cornsilk).
-gv_color(svg,crimson).
-gv_color(svg,cyan).
-gv_color(svg,darkblue).
-gv_color(svg,darkcyan).
-gv_color(svg,darkgoldenrod).
-gv_color(svg,darkgray).
-gv_color(svg,darkgreen).
-gv_color(svg,darkgrey).
-gv_color(svg,darkkhaki).
-gv_color(svg,darkmagenta).
-gv_color(svg,darkolivegreen).
-gv_color(svg,darkorange).
-gv_color(svg,darkorchid).
-gv_color(svg,darkred).
-gv_color(svg,darksalmon).
-gv_color(svg,darkseagreen).
-gv_color(svg,darkslateblue).
-gv_color(svg,darkslategray).
-gv_color(svg,darkslategrey).
-gv_color(svg,darkturquoise).
-gv_color(svg,darkviolet).
-gv_color(svg,deeppink).
-gv_color(svg,deepskyblue).
-gv_color(svg,dimgray).
-gv_color(svg,dimgrey).
-gv_color(svg,dodgerblue).
-gv_color(svg,firebrick).
-gv_color(svg,floralwhite).
-gv_color(svg,forestgreen).
-gv_color(svg,fuchsia).
-gv_color(svg,gainsboro).
-gv_color(svg,ghostwhite).
-gv_color(svg,gold).
-gv_color(svg,goldenrod).
-gv_color(svg,gray).
-gv_color(svg,grey).
-gv_color(svg,green).
-gv_color(svg,greenyellow).
-gv_color(svg,honeydew).
-gv_color(svg,hotpink).
-gv_color(svg,indianred).
-gv_color(svg,indigo).
-gv_color(svg,ivory).
-gv_color(svg,khaki).
-gv_color(svg,lavender).
-gv_color(svg,lavenderblush).
-gv_color(svg,lawngreen).
-gv_color(svg,lemonchiffon).
-gv_color(svg,lightblue).
-gv_color(svg,lightcoral).
-gv_color(svg,lightcyan).
-gv_color(svg,lightgoldenrodyellow).
-gv_color(svg,lightgray).
-gv_color(svg,lightgreen).
-gv_color(svg,lightgrey).
-gv_color(svg,lightpink).
-gv_color(svg,lightsalmon).
-gv_color(svg,lightseagreen).
-gv_color(svg,lightskyblue).
-gv_color(svg,lightslategray).
-gv_color(svg,lightslategrey).
-gv_color(svg,lightsteelblue).
-gv_color(svg,lightyellow).
-gv_color(svg,lime).
-gv_color(svg,limegreen).
-gv_color(svg,linen).
-gv_color(svg,magenta).
-gv_color(svg,maroon).
-gv_color(svg,mediumaquamarine).
-gv_color(svg,mediumblue).
-gv_color(svg,mediumorchid).
-gv_color(svg,mediumpurple).
-gv_color(svg,mediumseagreen).
-gv_color(svg,mediumslateblue).
-gv_color(svg,mediumspringgreen).
-gv_color(svg,mediumturquoise).
-gv_color(svg,mediumvioletred).
-gv_color(svg,midnightblue).
-gv_color(svg,mintcream).
-gv_color(svg,mistyrose).
-gv_color(svg,moccasin).
-gv_color(svg,navajowhite).
-gv_color(svg,navy).
-gv_color(svg,oldlace).
-gv_color(svg,olive).
-gv_color(svg,olivedrab).
-gv_color(svg,orange).
-gv_color(svg,orangered).
-gv_color(svg,orchid).
-gv_color(svg,palegoldenrod).
-gv_color(svg,palegreen).
-gv_color(svg,paleturquoise).
-gv_color(svg,palevioletred).
-gv_color(svg,papayawhip).
-gv_color(svg,peachpuff).
-gv_color(svg,peru).
-gv_color(svg,pink).
-gv_color(svg,plum).
-gv_color(svg,powderblue).
-gv_color(svg,purple).
-gv_color(svg,red).
-gv_color(svg,rosybrown).
-gv_color(svg,royalblue).
-gv_color(svg,saddlebrown).
-gv_color(svg,salmon).
-gv_color(svg,sandybrown).
-gv_color(svg,seagreen).
-gv_color(svg,seashell).
-gv_color(svg,sienna).
-gv_color(svg,silver).
-gv_color(svg,skyblue).
-gv_color(svg,slateblue).
-gv_color(svg,slategray).
-gv_color(svg,slategrey).
-gv_color(svg,snow).
-gv_color(svg,springgreen).
-gv_color(svg,steelblue).
-gv_color(svg,tan).
-gv_color(svg,teal).
-gv_color(svg,thistle).
-gv_color(svg,tomato).
-gv_color(svg,turquoise).
-gv_color(svg,violet).
-gv_color(svg,wheat).
-gv_color(svg,white).
-gv_color(svg,whitesmoke).
-gv_color(svg,yellow).
-gv_color(svg,yellowgreen).
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
deleted file mode 100644
index ac319dc..0000000
--- a/prolog/gv/gv_color.pl
+++ /dev/null
@@ -1,68 +0,0 @@
-:- module(
-  gv_color,
-  [
-    gv_color/2, % ?Colorscheme:oneof([svg,x11])
-                % ?Color:atom
-    color//1, % +Color:compound
-    colorList//1 % +Pairs:list(pair(compound,float))
-  ]
-).
-:- ensure_loaded(library(&#39;gv/gv_color.data&#39;)).
-
-/** &amp;lt;module&amp;gt; GraphViz color
-
-@author Wouter Beek
-@tbd Color value `transparent` is only available in the output formats
-     ps, svg, fig, vmrl, and the bitmap formats.
-@version 2015/08, 2015/10, 2016/02
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(lists)).
-:- use_module(library(os/file_ext)).
-
-
-
-
-
-% color(+Color:compound)// .
-% A *color* is represented by a compound term of one of the following forms:
-%   1. `rgb(Red:nonneg,Green:nonneg,Blue:nonneg)`
-%   2. `rgba(Red:nonneg,Green:nonneg,Blue:nonneg,Alpha:nonneg)`
-%   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
-
-color(rgb(Red,Green,Blue)) --&amp;gt; !,
-  &amp;quot;#&amp;quot;,
-  #(3, hex_color, [Red,Green,Blue]).
-color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
-  color(rgb(Red,Green,Blue)),
-  hex_color(Alpha).
-color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
-  #(3, hsv_color, [Hue,Saturation,Value]).
-color(Name) --&amp;gt;
-  {gv_color(_, Name)},
-  atom(Name).
-
-hex_color(I) --&amp;gt;
-  xinteger(I).
-
-hsv_color(D, Head, Tail):-
-  format(codes(Head,Tail), &#39;~2f&#39;, [D]).
-
-
-
-%! colorList(+Pairs:list(pair(compound,float)))// .
-
-colorList(L) --&amp;gt;
-  &#39;+&#39;(wc, L).
-
-wc(Color-Float) --&amp;gt;
-  color(Color),
-  (   wc_weight(Float)
-  ;   &amp;quot;&amp;quot;
-  ).
-
-wc_weight(Float) --&amp;gt;
-  &amp;quot;;&amp;quot;,
-  float(Float).
diff --git a/prolog/gv/gv_dom.pl b/prolog/gv/gv_dom.pl
deleted file mode 100644
index 30c4263..0000000
--- a/prolog/gv/gv_dom.pl
+++ /dev/null
@@ -1,29 +0,0 @@
-:- module(
-  gv_dom,
-  [
-    gv_dom/3 % +ExportG, -Dom, +Opts
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz DOM
-
-@author Wouter Beek
-@version 2015/07, 2016/01
-*/
-
-:- use_module(library(gv/gv_file)).
-:- use_module(library(option)).
-:- use_module(library(svg/svg_ext)).
-
-
-
-
-
-%! gv_dom(+ExportG, -Dom, +Opts) is det.
-
-gv_dom(ExportG, Dom, Opts1):-
-  % Make sure the file type of the output file is SvgDom.
-  merge_options([output(svg)], Opts1, Opts2),
-  graph_viz(ExportG, ToFile, Opts2),
-  svg_dom(ToFile, Dom),
-  delete_file(ToFile).
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
deleted file mode 100644
index 993fcee..0000000
--- a/prolog/gv/gv_file.pl
+++ /dev/null
@@ -1,175 +0,0 @@
-:- module(
-  gv_file,
-  [
-    graph_viz/2, % +ExportG, ?File
-    graph_viz/3  % +ExportG, ?File, +Opts
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz file
-
-@author Wouter Beek
-@version 2015/07, 2015/10-2015/11, 2016/01
-*/
-
-:- use_module(library(code_ext)).
-:- use_module(library(error)).
-:- use_module(library(gv/gv_graph)).
-:- use_module(library(option)).
-:- use_module(library(os/external_program)).
-:- use_module(library(os/process_ext)).
-:- use_module(library(string_ext)).
-
-:- predicate_options(graph_viz/3, 3, [
-     pass_to(file_to_gv/3, 3)
-   ]).
-:- predicate_options(file_to_gv/3, 3, [
-     method(+oneof([circo,dot,fdp,neato,osage,sfdp,twopi])),
-     output(+atom)
-   ]).
-
-:- dynamic(user:module_uses/2).
-:- multifile(user:module_uses/2).
-
-user:module_uses(gv_file, program(dot)).
-
-
-
-
-
-%! graph_viz(+ExportGraph:compound, ?File:atom) is det.
-%! graph_viz(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
-% Returns a file containing a GraphViz visualization of the given graph.
-%
-% The following options are supported:
-%   * method(+oneof([circo,dot,fdp,neato,osage,sfdp,twopi])
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Default is `dot&#39;.
-%     For possible values see gv_method/1.
-%   * output(+atom)`
-%     The file type of the generated GraphViz file.
-%     Default is `pdf`.
-%     For possible values see gv_output_type/1.
-
-graph_viz(ExportG, File):-
-  graph_viz(ExportG, File, []).
-graph_viz(ExportG, File, Opts):-
-  once(phrase(gv_graph(ExportG), Cs)),
-
-  % Be thread-safe.
-  thread_self(Id),
-  string_list_concat([&amp;quot;gv_file&amp;quot;,Id], &amp;quot;_&amp;quot;, ThreadName),
-  absolute_file_name(ThreadName, TmpFile, [access(write),extensions([dot])]),
-  setup_call_cleanup(
-    open(TmpFile, write, Write, [encoding(utf8)]),
-    with_output_to(Write, put_codes(Cs)),
-    close(Write)
-  ),
-  file_to_gv(TmpFile, File, Opts).
-
-
-%! file_to_gv(
-%!   +InputFile:atom,
-%!   ?OutputFile:atom,
-%!   +Options:list(compound)
-%! ) is det.
-% Converts a GraphViz DOT file to an image file, using a specific
-% visualization method.
-
-file_to_gv(InputFile, OutputFile, Opts):-
-  var(OutputFile), !,
-  option(output(Ext), Opts, pdf),
-  file_name_extension(out, Ext, LocalName),
-  absolute_file_name(LocalName, OutputFile, Opts),
-  file_to_gv(InputFile, OutputFile, Opts).
-file_to_gv(InputFile, OutputFile, Opts):-
-  option(output(dot), Opts), !,
-  (   var(OutputFile)
-  -&amp;gt;  OutputFile = InputFile
-  ;   rename_file(InputFile, OutputFile)
-  ).
-file_to_gv(InputFile, OutputFile, Opts):-
-  % Typecheck for `method` option.
-  option(method(Method), Opts, dot),
-  findall(Method0, gv_method(Method0), Methods),
-  must_be(oneof(Methods), Method),
-
-  % Typecheck for `output` option.
-  option(output(OutputType), Opts, pdf),
-  findall(OutputType0, gv_output_type(OutputType0), OutputTypes),
-  must_be(oneof(OutputTypes), OutputType),
-
-  % Run the GraphViz conversion command in the shell.
-  format(atom(OutputTypeFlag), &amp;quot;-T~a&amp;quot;, [OutputType]),
-  format(atom(OutputFileFlag), &amp;quot;-o~a&amp;quot;, [OutputFile]),
-  run_process(
-    Method,
-    [OutputTypeFlag,file(InputFile),OutputFileFlag]
-  ).
-
-
-
-
-
-% HELPERS %
-
-gv_method(circo).
-gv_method(dot).
-gv_method(fdp).
-gv_method(neato).
-gv_method(osage).
-gv_method(sfdp).
-gv_method(twopi).
-
-
-gv_output_type(bmp).
-gv_output_type(canon).
-gv_output_type(dot).
-gv_output_type(gv).
-gv_output_type(xdot).
-gv_output_type(&#39;xdot1.2&#39;).
-gv_output_type(&#39;xdot1.4&#39;).
-gv_output_type(cgimage).
-gv_output_type(cmap).
-gv_output_type(eps).
-gv_output_type(exr).
-gv_output_type(fig).
-gv_output_type(gd).
-gv_output_type(gd2).
-gv_output_type(gif).
-gv_output_type(gtk).
-gv_output_type(ico).
-gv_output_type(imap).
-gv_output_type(cmapx).
-gv_output_type(imap_np).
-gv_output_type(cmapx_np).
-gv_output_type(ismap).
-gv_output_type(jp2).
-gv_output_type(jpg).
-gv_output_type(jpeg).
-gv_output_type(jpe).
-gv_output_type(pct).
-gv_output_type(pict).
-gv_output_type(pdf).
-gv_output_type(pic).
-gv_output_type(plain).
-gv_output_type(&#39;plain-ext&#39;).
-gv_output_type(png).
-gv_output_type(pov).
-gv_output_type(ps).
-gv_output_type(ps2).
-gv_output_type(psd).
-gv_output_type(sgi).
-gv_output_type(svg).
-gv_output_type(svgz).
-gv_output_type(tga).
-gv_output_type(tif).
-gv_output_type(tiff).
-gv_output_type(tk).
-gv_output_type(vml).
-gv_output_type(vmlz).
-gv_output_type(vrml).
-gv_output_type(wbmp).
-gv_output_type(webp).
-gv_output_type(xlib).
-gv_output_type(x11).
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
deleted file mode 100644
index c95c9cc..0000000
--- a/prolog/gv/gv_graph.pl
+++ /dev/null
@@ -1,252 +0,0 @@
-:- module(
-  gv_graph,
-  [
-    gv_graph//1 % +Graph:compound
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz graph
-
-Generates GraphViz graphs in the DOT format based on
-a Prolog representation of a graph.
-
-In GraphViz vertices are called &#39;nodes&#39;.
-
----
-
-@author Wouter Beek
-@version 2015/07, 2015/12
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(gv/gv_graph_comp)).
-:- use_module(library(lists)).
-:- use_module(library(option)).
-
-
-
-
-
-%! gv_graph(+Graph:compound)// is det.
-% Wrapper around gv_graph//2 with no indentation.
-
-gv_graph(G) --&amp;gt; gv_graph(G, 0).
-
-
-%! gv_graph(+Graph:compound, +Indent:nonneg)// is det.
-% The follow graph attributes are supported,
-% beyond the GraphViz attributes for graphs:
-%   * `directed(+boolean)`
-%      Whether the graph is directed (`true`) or undirected (`false`).
-%      Default: `false`.
-%   * `name(+GraphName:atom)`
-%   * `strict(+StrictGraph:boolean)`
-%      This forbids the creation of self-arcs and multi-edges;
-%      they are ignored in the input file.
-%      Only in combinattion with directionality `directed`.
-%
-% ```abnf
-% graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
-% ```
-%
-% `GraphTerm` is a compound term of the following form:
-% ```prolog
-% graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
-% ```
-%
-% `RankedVertexTerms` is a list of compound terms of the following form:
-% ```prolog
-% RankVertex-ContentVertices
-% ```
-%
-% @tbd Add support for subgraphs (arbitrary nesting).
-% @tbd Add support for escape strings:
-%      http://www.graphviz.org/doc/info/attrs.html#k:escString
-% @tbd Assert attributes that are generic with respect to a subgraph.
-% @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
-
-gv_graph(G1, I) --&amp;gt;
-  {
-    include_ranks(G1, G2),
-    G2 = graph(VTerms,RankedVTerms,ETerms,GAttrs1),
-    shared_attributes(VTerms, SharedVAttrs, NewVTerms),
-    shared_attributes(ETerms, SharedEAttrs, NewETerms),
-    add_default(GAttrs1, overlap(false), GAttrs2),
-    I = 0
-  },
-
-  % The first statement in the GraphViz output.
-  % States that this file represents a graph according to the GraphViz format.
-  tab(I),
-  
-  % Strictness.
-  {select_option(strict(Strict), GAttrs2, GAttrs3, false)},
-  gv_strict(Strict),
-  
-  % Directedness.
-  {select_option(directed(Directed), GAttrs3, GAttrs4, true)},
-  gv_graph_type(Directed),
-  &amp;quot; &amp;quot;,
-  
-  % Graph name.
-  (   {select_option(name(GName), GAttrs4, GAttrs5)}
-  -&amp;gt;  gv_id(GName),
-      &amp;quot; &amp;quot;
-  ;   {GAttrs5 = GAttrs4}
-  ),
-
-  % The body of the DOT file appears between curly braces.
-  &amp;quot;{\n&amp;quot;,
-
-  % The following lines are indented.
-  {NewI is I + 1},
-
-  % Attributes that apply to the graph as a whole.
-  gv_generic_attributes_statement(graph, NewI, GAttrs5),
-
-  % Attributes that are the same for all nodes.
-  gv_generic_attributes_statement(node, NewI, SharedVAttrs),
-
-  % Attributes that are the same for all edges.
-  gv_generic_attributes_statement(edge, NewI, SharedEAttrs),
-
-  % Only add a line_feed if some content was already written
-  % and some content is about to be written.
-  (   % Succeeds if no content was written.
-      {(GAttrs5 == [], SharedVAttrs == [], SharedEAttrs == [])}
-  -&amp;gt;  &amp;quot;&amp;quot;
-  ;   % Succeeds if no content is about to be written.
-      {(NewVTerms == [], RankedVTerms == [])}
-  -&amp;gt;  &amp;quot;&amp;quot;
-  ;   &amp;quot;\n&amp;quot;
-  ),
-
-  % The list of GraphViz nodes.
-  gv_node_statements(NewI, NewVTerms),
-  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; &amp;quot;\n&amp;quot;),
-
-  % The ranked GraphViz nodes (displayed at the same height).
-  gv_ranked_node_collections(NewI, RankedVTerms),
-  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; &amp;quot;\n&amp;quot;),
-
-  {
-    findall(
-      edge(FromId,ToId,[]),
-      (
-        nth0(J1, RankedVTerms, rank(vertex(FromId,_),_)),
-        nth0(J2, RankedVTerms, rank(vertex(ToId,_),_)),
-        % We assume that the rank vertices are nicely ordered.
-        succ(J1, J2)
-      ),
-      RankEdges
-    )
-  },
-
-  % The rank edges.
-  gv_edge_statements(NewI, Directed, RankEdges),
-
-  % The non-rank edges.
-  gv_edge_statements(NewI, Directed, NewETerms),
-  
-  % Note that we do not include a line_feed here.
-
-  % We want to indent the closing curly brace.
-  tab(I),
-  &amp;quot;}\n&amp;quot;.
-
-
-
-%! gv_edge_statements(
-%!   +Indent:nonneg,
-%!   +Directed:boolean,
-%!   +Statements:list(compound)
-%! )// is det.
-
-gv_edge_statements(I, Dir, L) --&amp;gt; *(gv_edge_statement(I, Dir), L).
-
-
-
-%! gv_edge_statements(+Indent:nonneg, +Statements:list(compound))// is det.
-
-gv_node_statements(I, L) --&amp;gt; *(gv_node_statement(I), L).
-
-
-
-%! gv_ranked_node_collections(+Indent:nonneg, +Collections:list)// is det.
-
-gv_ranked_node_collections(I, L) --&amp;gt; *(gv_ranked_node_collection(I), L).
-
-
-
-
-
-% HELPERS %
-
-%! add_default_option(
-%!   +Options:list(compound),
-%!   +Default:compound,
-%!   -NewOptions:list(compound)
-%! ) is det.
-
-add_default(L1, Opt, L2):-
-  Opt =.. [N,_Value],
-  Opt0 =.. [N,_FreshVar],
-  (   option(Opt0, L1)
-  -&amp;gt;  L2 = L1
-  ;   L2 = [Opt|L1]
-  ).
-
-
-
-%! gv_graph_type(+Directed:boolean)// is det.
-% The type of graph that is represented.
-
-gv_graph_type(false) --&amp;gt; !, &amp;quot;graph&amp;quot;.
-gv_graph_type(true)  --&amp;gt;    &amp;quot;digraph&amp;quot;.
-
-
-
-%! gv_strict(+Strict:boolean)// is det.
-% The keyword denoting that the graph is strict, i.e., has no self-arcs and
-% no multi-edges.
-% This only applies to directed graphs.
-
-gv_strict(false) --&amp;gt; !, &amp;quot;&amp;quot;.
-gv_strict(true)  --&amp;gt;    &amp;quot;strict &amp;quot;.
-
-
-
-%! invlude_ranges(+Graph:compound, -GraphWithRanks:compound) is det.
-% Ensures that there is a ranks components in
-% the graph-denoting compound term.
-
-include_ranks(graph(Vs,Rs,Es,L), graph(Vs,Rs,Es,L)):- !.
-include_ranks(graph(Vs,Es,L), graph(Vs,[],Es,L)).
-
-
-
-%! shared_attributes(
-%!   +Terms:list(compound),
-%!   -SharedAttributes:list(compound),
-%!   -NewTerms:list(compound)
-%! ) is det.
-
-shared_attributes(Ts1, Shared, Ts2):-
-  maplist(term_to_attrs, Ts1, L1),
-  extract_shared(L1, Shared),
-  maplist(remove_shared_attributes(Shared), L1, L2),
-  maplist(term_change_attrs, Ts1, L2, Ts2).
-
-term_to_attrs(edge(_,_,A), A).
-term_to_attrs(vertex(_,A), A).
-
-extract_shared([], []):- !.
-extract_shared(Argss, Shared):-
-  ord_intersection(Argss, Shared).
-
-remove_shared_attributes(Shared, Args1, Args2):-
-  ord_subtract(Args1, Shared, Args2).
-
-term_change_attrs(edge(From,To,_), A, edge(From,To,A)).
-term_change_attrs(vertex(Id,_), A, vertex(Id,A)).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
deleted file mode 100644
index 30ea9c5..0000000
--- a/prolog/gv/gv_graph_comp.pl
+++ /dev/null
@@ -1,309 +0,0 @@
-:- module(
-  gv_graph_comp,
-  [
-    gv_edge_statement//3, % +Indent:nonneg
-                          % +Directed:boolean
-                          % +Edge:compound
-    gv_generic_attributes_statement//3, % +Kind:oneof([edge,graph,node])
-                                        % +Indent:nonneg
-                                        % +CategoryAttributes:list(compound)
-    gv_id//1, % +Name:compound
-    gv_node_statement//2, % +Indent:nonneg
-                          % +Vertex:compound
-    gv_ranked_node_collection//2 % +Indent:nonneg
-                                 % +Rank
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz graph components
-
-```abnf
-attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
-a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
-```
-
-@author Wouter Beek
-@see http://www.graphviz.org/content/dot-language
-@version 2015/07-2015/08, 2015/10-2016/01
-*/
-
-:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(gv/gv_attrs)).
-:- use_module(library(gv/gv_html)).
-:- use_module(library(error)).
-:- use_module(library(lists)).
-:- use_module(library(ordsets)).
-
-
-
-
-
-%! gv_edge_statement(
-%!   +Indent:nonneg,
-%!   +Directed:boolean,
-%!   +Edge:compound
-%! )// is det.
-% A GraphViz statement describing an edge.
-%
-% @arg Indent The indentation level at which the edge statement is written.
-% @arg Directed Whether the graph is directed or not.
-% @arg GraphAttributes The attributes of the graph. Some of these attributes
-%      may be used in the edge statement (e.g., the colorscheme).
-% @arg Edge A compound term in the GIFormat, representing an edge.
-%
-% @tbd Instead of gv_node_id//1 we could have a gv_subgraph//1
-%      at the from and/or to location.
-% @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
-
-gv_edge_statement(I, Dir, edge(From,To,Attrs)) --&amp;gt;
-  tab(I),
-
-  gv_node_id(From), &amp;quot; &amp;quot;,
-  gv_edge_operator(Dir), &amp;quot; &amp;quot;,
-  gv_node_id(To), &amp;quot; &amp;quot;,
-
-  % We want `colorscheme/1` from the edges and
-  % `directionality/1` from the graph.
-  gv_attrs(edge, Attrs),
-  &amp;quot;\n&amp;quot;.
-
-%! gv_edge_operator(+Directed:boolean)// .
-% The binary edge operator between two vertices.
-% The operator that is used depends on whether the graph is directed or
-% undirected.
-%
-% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
-%      undirected (operator `--`).
-
-gv_edge_operator(Dir) --&amp;gt;
-  {must_be(boolean, Dir)},
-  ({Dir == false} -&amp;gt; &amp;quot;--&amp;quot; ; {Dir == true} -&amp;gt; &amp;quot;-&amp;gt;&amp;quot;).
-
-
-
-%! gv_generic_attributes_statement(
-%!   +Kind:oneof([edge,graph,node]),
-%!   +Indent:nonneg,
-%!   +CategoryAttrs
-%! )//
-% A GraphViz statement describing generic attributes for a category of items.
-%
-% @arg Kind The category of items for to the attributes apply.
-%      Possible values: `edge`, `graph`, and `node`.
-% @arg Indent An integer indicating the number of tabs.
-% @arg GraphAttributes A list of name-value pairs.
-% @arg CategoryAttributes A list of name-value pairs.
-%
-% ```
-% attr_stmt = (graph / node / edge) attr_list
-% ```
-
-gv_generic_attributes_statement(_, _, []) --&amp;gt; !, &amp;quot;&amp;quot;.
-gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
-  tab(I),
-  gv_kind(Kind), &amp;quot; &amp;quot;,
-  gv_attrs(Kind, Attrs),
-  &amp;quot;\n&amp;quot;, !.
-
-
-
-%! gv_kind(+Kind:oneof([edge,graph,node]))// .
-
-gv_kind(Kind) --&amp;gt; {must_be(oneof([edge,graph,node]), Kind)}, atom(Kind).
-
-
-
-%! gv_node_statement(+Indent:nonneg, +Vertex:compound)// is det.
-% A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
-
-gv_node_statement(I, vertex(Id,Attrs)) --&amp;gt;
-  tab(I),
-  gv_node_id(Id),
-  gv_attrs(node, Attrs),
-  &amp;quot;\n&amp;quot;.
-
-
-
-%! gv_ranked_node_collection(+Indent:nonneg, Rank:pair)// is det.
-
-gv_ranked_node_collection(I, RankVTerm-VTerms) --&amp;gt;
-  tab(I),
-  &amp;quot;{\n&amp;quot;,
-
-  % The rank attribute.
-  {NewI is I + 1},
-  tab(NewI),
-  gv_attr(subgraph, rank(same)),
-  &amp;quot;\n&amp;quot;,
-
-  % Vertice statements.
-  *(gv_node_statement(NewI), [RankVTerm|VTerms]),
-
-  % We want to indent the closing curly brace.
-  tab(I),
-  &amp;quot;\n}&amp;quot;.
-
-
-
-
-
-% HELPERS %
-
-%! gv_attrs(
-%!   +Kind:oneof([edge,graph,node]),
-%!   +Attributes:list(compound)
-%! )// is det.
-
-gv_attrs(Kind, L) --&amp;gt; &amp;quot;[&amp;quot;, *(gv_attr(Kind), L), &amp;quot;]&amp;quot;.
-
-
-%! gv_attr(+Context:oneof([edge,graph,node]), +Attribute:compound)// is det.
-% A single GraphViz attribute.
-% We assume that the attribute has already been validated.
-
-gv_attr(Context, Attr) --&amp;gt;
-  {Attr =.. [N,V]},
-  gv_id(N), &amp;quot;=&amp;quot;, gv_attr_value(Context, N=V), &amp;quot;;&amp;quot;.
-
-
-
-%! gv_id(+Id:compound)// is det.
-% Parse a GraphViz identifier.
-% There are 4 variants:
-%   1. Any string of alphabetic (`[a-zA-Z&#39;200-&#39;377]`) characters,
-%      underscores (`_`) or digits (`[0-9]`), not beginning with a digit.
-%   2. A numeral `[-]?(.[0-9]+ | [0-9]+(.[0-9]*)? )`.
-%   3. Any double-quoted string (`&amp;quot;...&amp;quot;`) possibly containing
-%      escaped quotes (`\&amp;quot;`).
-%      In quoted strings in DOT, the only escaped character is
-%      double-quote (`&amp;quot;`). That is, in quoted strings, the dyad `\&amp;quot;`
-%      is converted to `&amp;quot;`. All other characters are left unchanged.
-%      In particular, `\\` remains `\\`.
-%      Layout engines may apply additional escape sequences.
-%      Represented by a Prolog term of the form `double_quoted_string(ATOM)`.
-%   4. An HTML string (`&amp;lt;...&amp;gt;`).
-%      Represented by a Prolog term of the form `html_like_label(COMPOUND)`.
-%
-% @tbd Add support for HTML-like labels:
-%      http://www.graphviz.org/doc/info/shapes.html#html
-%      This requires an XML grammar!
-
-% HTML strings (assumed to be the same as HTML-like labels).
-gv_id(html_like_label(Content)) --&amp;gt; !,
-  gv_html_like_label(Content).
-% Double-quoted strings.
-% The quotes are already part of the given atom.
-gv_id(double_quoted_string(Atom)) --&amp;gt; !,
-  &amp;quot;\&amp;quot;&amp;quot;, atom(Atom), &amp;quot;\&amp;quot;&amp;quot;.
-% Numerals.
-gv_id(N) --&amp;gt;
-  {number(N)}, !,
-  {number_codes(N, Cs)},
-  Cs.
-% Alpha-numeric strings.
-gv_id(Atom) --&amp;gt;
-  {atom_codes(Atom, [H|T])},
-  gv_id_first(H),
-  gv_id_rest(T), !,
-  % Variant 1 identifiers should not be (case-variants of) a
-  % GraphViz keyword.
-  {\+ gv_keyword([H|T])}.
-
-
-%! gv_id_first(+First:code)// is det.
-% Generates the first character of a GraphViz identifier.
-
-gv_id_first(C)   --&amp;gt; alpha(C), !.
-gv_id_first(0&#39;_) --&amp;gt; &amp;quot;_&amp;quot;.
-
-
-%! gv_id_rest(+NonFirst:code)// is det.
-% Generates a non-first character of a GraphViz identifier.
-
-gv_id_rest([H|T])   --&amp;gt; alphadigit(H), !, gv_id_rest(T).
-gv_id_rest([0&#39;_|T]) --&amp;gt; &amp;quot;_&amp;quot;,           !, gv_id_rest(T).
-gv_id_rest([])      --&amp;gt; &amp;quot;&amp;quot;.
-
-
-
-%! gv_keyword(+Codes:list(code)) is semidet.
-% Succeeds if the given codes for a GraphViz reserved keyword.
-
-gv_keyword(Cs):-
-  % Obviously, the keywords do not occur on the difference list input.
-  % So we must use phrase/[2,3].
-  phrase(gv_keyword, Cs).
-
-
-%! gv_keyword// .
-% GraphViz has reserved keywords that cannot be used as identifiers.
-% GraphViz keywords are case-insensitive.
-
-gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
-
-
-
-%! gv_node_id(+NodeId:compound)// .
-% GraphViz node identifiers can be of the following two types:
-%   1. A GraphViz identifier, see gv_id//1.
-%   2. A GraphViz identifier plus a GraphViz port indicator, see gv_port//0.
-%
-% @tbd Add support for GraphViz port indicators
-%      inside GraphViz node identifiers.
-
-gv_node_id(Id) --&amp;gt; gv_id(Id), !.
-%gv_node_id(_) --&amp;gt; gv_id(_), gv_port.
-gv_node_id(Id) --&amp;gt; {type_error(gv_node_id, Id)}.
-
-
-
-%! gv_numeral(-Number)// is det.
-% ```bnf
-% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
-% ```
-
-gv_numeral(N) --&amp;gt;
-  (&amp;quot;-&amp;quot; -&amp;gt; {Sg = -1} ; {Sg = 1}),
-  (   &amp;quot;.&amp;quot;
-  -&amp;gt;  {I = 0}, +(digit, Ds), {pos_frac(Ds, Frac)}
-  ;   +(digit, Ds1), {pos_sum(Ds1, I)},
-      (&amp;quot;.&amp;quot; -&amp;gt; *(digit, Ds2), {pos_frac(Ds2, Frac)} ; {Frac = 0.0})
-  ),
-  {N is Sg * (I + Frac)}.
-
-
-
-%! gv_port// is det.
-
-gv_port --&amp;gt; gv_port_location, (gv_port_angle ; &amp;quot;&amp;quot;).
-gv_port --&amp;gt; gv_port_angle, (gv_port_location ; &amp;quot;&amp;quot;).
-gv_port --&amp;gt; &amp;quot;:&amp;quot;, gv_compass_pt(_).
-
-gv_port_angle --&amp;gt; &amp;quot;@&amp;quot;, gv_id(_).
-
-gv_port_location --&amp;gt; &amp;quot;:&amp;quot;, gv_id(_).
-gv_port_location --&amp;gt; &amp;quot;:[&amp;quot;, gv_id(_), &amp;quot;,&amp;quot;, gv_id(_), &amp;quot;]&amp;quot;.
-
-
-
-%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
-% ```
-% compass_pt : ( n | ne | e | se | s | sw | w | nw | c | _ )
-% ```
-
-gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
-gv_compass_pt(c)   --&amp;gt; &amp;quot;c&amp;quot;.
-gv_compass_pt(e)   --&amp;gt; &amp;quot;e&amp;quot;.
-gv_compass_pt(n)   --&amp;gt; &amp;quot;n&amp;quot;.
-gv_compass_pt(ne)  --&amp;gt; &amp;quot;ne&amp;quot;.
-gv_compass_pt(nw)  --&amp;gt; &amp;quot;nw&amp;quot;.
-gv_compass_pt(s)   --&amp;gt; &amp;quot;s&amp;quot;.
-gv_compass_pt(se)  --&amp;gt; &amp;quot;se&amp;quot;.
-gv_compass_pt(sw)  --&amp;gt; &amp;quot;sw&amp;quot;.
-gv_compass_pt(w)   --&amp;gt; &amp;quot;w&amp;quot;.
diff --git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
deleted file mode 100644
index b5c1368..0000000
--- a/prolog/gv/gv_html.pl
+++ /dev/null
@@ -1,255 +0,0 @@
-:- module(
-  gv_html,
-  [
-    gv_html_like_label//1 % +Content:compound
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
-
-Grammar taken from the GraphViz Web site:
-
-```
-label :   text
-        | table
-text :   textitem
-       | text textitem
-textitem :   string
-           | &amp;lt;BR/&amp;gt;
-           | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
-           | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
-           | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
-           | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
-           | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
-           | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
-           | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
-           | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
-table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
-rows :   row
-       | rows row
-       | rows &amp;lt;HR/&amp;gt; row
-row: &amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
-cells :   cell
-        | cells cell
-        | cells &amp;lt;VR/&amp;gt; cell
-cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
-      | &amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
-```
-
----
-
-@author Wouter Beek
-@see http://www.graphviz.org/content/node-shapes#html
-@version 2015/07, 2015/12
-*/
-
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(html/html_dcg)).
-
-
-
-
-
-%! gv_html_like_label(+Content:compound)// is det.
-
-gv_html_like_label(Content) --&amp;gt; &amp;quot;&amp;lt;&amp;quot;, label(Content), &amp;quot;&amp;gt;&amp;quot;.
-
-
-
-%! cell(+Contents:compound)// is det.
-% Supported attributes for `TD`:
-%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;`
-%   - `BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
-%   - `BGCOLOR=&amp;quot;color&amp;quot;`
-%   - `BORDER=&amp;quot;value&amp;quot;`
-%   - `CELLPADDING=&amp;quot;value&amp;quot;`
-%   - `CELLSPACING=&amp;quot;value&amp;quot;`
-%   - `COLOR=&amp;quot;color&amp;quot;`
-%   - `COLSPAN=&amp;quot;value&amp;quot;`
-%   - `FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;`
-%   - `GRADIENTANGLE=&amp;quot;value&amp;quot;`
-%   - `HEIGHT=&amp;quot;value&amp;quot;`
-%   - `HREF=&amp;quot;value&amp;quot;`
-%   - `ID=&amp;quot;value&amp;quot;`
-%   - `PORT=&amp;quot;portName&amp;quot;`
-%   - `ROWSPAN=&amp;quot;value&amp;quot;`
-%   - `SIDES=&amp;quot;value&amp;quot;`
-%   - `STYLE=&amp;quot;value&amp;quot;`
-%   - `TARGET=&amp;quot;value&amp;quot;`
-%   - `TITLE=&amp;quot;value&amp;quot;`
-%   - `TOOLTIP=&amp;quot;value&amp;quot;`
-%   - `VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;`
-%   - `WIDTH=&amp;quot;value&amp;quot;`
-%
-% Supported attributes for `IMG`:
-%   - `SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;`
-%   - `SRC=&amp;quot;value&amp;quot;`
-
-cell(td(Contents)) --&amp;gt; !,
-  cell(td([],Contents)).
-cell(td(Attrs1,Image)) --&amp;gt;
-  {(Image =.. [img,Attrs2] -&amp;gt; true ; Image == img -&amp;gt; Attrs2 = [])}, !,
-  html_element(td, Attrs1, html_element(img,Attrs2)).
-cell(td(Attrs,Contents)) --&amp;gt;
-  html_element(td, Attrs, label(Contents)).
-
-
-
-%! cells(+Contents:list(compound))// is det.
-
-cells([H,vr|T]) --&amp;gt; !, cell(H), html_element(vr), cells(T).
-cells([H|T])    --&amp;gt; !, cell(H), cells(T).
-cells([])       --&amp;gt; &amp;quot;&amp;quot;.
-
-
-
-%! label(+Content:compound)// is det.
-% GraphViz HTML-like label.
-
-label(Content) --&amp;gt; table(Content), !.
-label(Content) --&amp;gt; text(Content).
-
-
-
-%! row(+Contents:compound)// is det.
-
-row(tr(Contents)) --&amp;gt; html_element(tr, [], cells(Contents)).
-
-
-
-%! rows(+Contents:list)// is det.
-
-rows([hr|T]) --&amp;gt; !, html_element(hr), rows(T).
-rows([H|T]) --&amp;gt; row(H), !, rows(T).
-rows([]) --&amp;gt; &amp;quot;&amp;quot;.
-
-
-
-%! table(+Contents:compound)// is det.
-% ```
-% table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
-% ```
-%
-% Supported attributes for `TABLE`:
-%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
-%   - `BGCOLOR=&amp;quot;color&amp;quot;`
-%   - `BORDER=&amp;quot;value&amp;quot;`
-%   - `CELLBORDER=&amp;quot;value&amp;quot;`
-%   - `CELLPADDING=&amp;quot;value&amp;quot;`
-%   - `CELLSPACING=&amp;quot;value&amp;quot;`
-%   - `COLOR=&amp;quot;color&amp;quot;`
-%   - `COLUMNS=&amp;quot;value&amp;quot;`
-%   - `FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;`
-%   - `GRADIENTANGLE=&amp;quot;value&amp;quot;`
-%   - `HEIGHT=&amp;quot;value&amp;quot;`
-%   - `HREF=&amp;quot;value&amp;quot;`
-%   - `ID=&amp;quot;value&amp;quot;`
-%   - `PORT=&amp;quot;portName&amp;quot;`
-%   - `ROWS=&amp;quot;value&amp;quot;`
-%   - `SIDES=&amp;quot;value&amp;quot;`
-%   - `STYLE=&amp;quot;value&amp;quot;`
-%   - `TARGET=&amp;quot;value&amp;quot;`
-%   - `TITLE=&amp;quot;value&amp;quot;`
-%   - `TOOLTIP=&amp;quot;value&amp;quot;`
-%   - `VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;`
-%   - `WIDTH=&amp;quot;value&amp;quot;`
-%
-% Supported attributes for `FONT`:
-%  - `COLOR=&amp;quot;color&amp;quot;`
-%    Sets the color of the font within the scope of `&amp;lt;FONT&amp;gt;...&amp;lt;/FONT&amp;gt;`,
-%     or the border color of the table or cell within the scope of
-%     `&amp;lt;TABLE&amp;gt;...&amp;lt;/TABLE&amp;gt;`, or `&amp;lt;TD&amp;gt;...&amp;lt;/TD&amp;gt;`.
-%    This color can be overridden by a `COLOR` attribute in descendents.
-%    By default, the font color is determined by the `fontcolor` attribute
-%     of the corresponding node, edge or graph, and the border color is
-%     determined by the color attribute of the corresponding node, edge or
-%     graph.
-%   - `FACE=&amp;quot;fontname&amp;quot;`
-%   - `POINT-SIZE=&amp;quot;value&amp;quot;`
-
-table(table(Contents)) --&amp;gt; !,
-  table(table([],Contents)).
-table(table(Attrs,Contents)) --&amp;gt; !,
-  html_element(table, Attrs, rows(Contents)).
-table(font(Table)) --&amp;gt; !,
-  table(font([],Table)).
-table(font(Attrs1,Table)) --&amp;gt;
-  {(  Table =.. [table,Attrs2,Contents]
-  -&amp;gt;  true
-  ;   Table =.. [table,Contents]
-  -&amp;gt;  Attrs2 = []
-  )},
-  html_element(font, Attrs1, table(table(Attrs2,Contents))).
-
-
-
-%! text(+Contents:list)// .
-% ```
-% text :   textitem
-%        | text textitem
-% ```
-
-text(Contents) --&amp;gt; {is_list(Contents)}, !, &#39;+&#39;(textitem, Contents).
-text(Content)  --&amp;gt; text([Content]).
-
-
-
-%! textitem(+Content:compound)// .
-% ```
-% textitem :   string
-%            | &amp;lt;BR/&amp;gt;
-%            | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
-%            | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
-%            | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
-%            | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
-%            | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
-%            | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
-%            | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
-%            | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
-% ```
-%
-% Supported attributes for BR:
-%   * `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
-%
-% Supported attributes for FONT:
-%   * COLOR=&amp;quot;color&amp;quot;
-%   * FACE=&amp;quot;fontname&amp;quot;
-%   * POINT-SIZE=&amp;quot;value&amp;quot;
-
-textitem(br(Attrs)) --&amp;gt; !,
-  html_element(br, Attrs).
-% Compound term: parser.
-textitem(Compound) --&amp;gt;
-  {var(Compound)}, !,
-  html_element(Name, _, text(Content)),
-  {
-    supported_html_element(Name),
-    Compound =.. [Name,Content]
-  }.
-% Compound term: generator.
-textitem(Compound) --&amp;gt;
-  {
-    Compound =.. [Name,Content], !,
-    supported_html_element(Name)
-  },
-  html_element(Name, _, text(Content)).
-textitem(String) --&amp;gt;
-  html_string(String).
-
-
-
-
-
-% HELPERS %
-
-%! supported_html_element(+Name:atom) is semidet.
-%! supported_html_element(-Name:atom) is multi.
-
-supported_html_element(b).
-supported_html_element(font).
-supported_html_element(i).
-supported_html_element(o).
-supported_html_element(s).
-supported_html_element(sub).
-supported_html_element(sup).
-supported_html_element(u).
diff --git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
deleted file mode 100644
index 4382aa6..0000000
--- a/prolog/tree/tree_viz.pl
+++ /dev/null
@@ -1,65 +0,0 @@
-:- module(
-  tree_viz,
-  [
-    tree_export_graph/2, % +Tree, ExportG
-    tree_export_graph/3, % +Tree, ExportG, +Opts
-    tree_viz/2,          % +Tree, ?File
-    tree_viz/3           % +Tree, ?File, +Opts
-  ]
-).
-
-/** &amp;lt;module&amp;gt; Tree visualization
-
-Export trees to GraphViz.
-
-@author Wouter Beek
-@version 2016/01-2016/02
-*/
-
-:- use_module(library(graph/build_export_graph)).
-:- use_module(library(gv/gv_file)).
-:- use_module(library(ordsets)).
-:- use_module(library(tree/l_tree)).
-:- use_module(library(tree/s_tree)).
-
-:- predicate_options(tree_export_graph/3, 3, [
-     pass_to(build_export_graph/4, 4)
-   ]).
-:- predicate_options(tree_viz/3, 3, [
-     pass_to(graph_viz/3, 3),
-     pass_to(tree_to_graph/3, 3)
-   ]).
-
-
-
-
-
-%! tree_export_graph(+Tree, -ExportG) is det.
-%! tree_export_graph(+Tree, -ExportG, +Opts) is det.
-% Opts are passed to build_export_graph/4.
-
-tree_export_graph(Tree, ExportG) :-
-  tree_export_graph(Tree, ExportG, []).
-
-tree_export_graph(Tree, ExportG, Opts) :-
-  (   is_s_tree(Tree)
-  -&amp;gt;  tree_to_graph(Tree, G)
-  ;   is_l_tree(Tree)
-  -&amp;gt;  l_tree_to_graph(Tree, G)
-  ),
-  build_export_graph(G, ExportG, Opts).
-
-
-
-%! tree_viz(+Tree, ?File) is det.
-%! tree_viz(+Tree, ?File, +Opts) is det.
-% Stores the given tree term into a GraphViz file.
-%
-% Options are passed to export_graph_to_gv_file/3, tree_to_graph/3.
-
-tree_viz(Tree, File) :-
-  tree_viz(Tree, File, []).
-
-tree_viz(Tree, File, Opts) :-
-  tree_export_graph(Tree, ExportG, Opts),
-  graph_viz(ExportG, File, Opts).
diff --git a/test/gv_attrs.log b/test/gv_attrs.log
deleted file mode 100644
index a9c6010..0000000
--- a/test/gv_attrs.log
+++ /dev/null
@@ -1,169 +0,0 @@
-assert(gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;)).
-assert(gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;)).
-assert(gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(&#39;_background&#39;,[graph],[string],_,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;)).
-assert(gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(bgcolor,[cluster,graph],[color,colorList],_,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;)).
-assert(gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
-assert(gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
-assert(gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
-assert(gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
-assert(gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgetarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
-assert(gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
-assert(gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;)).
-assert(gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(inputscale,[graph],[double],_,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;)).
-assert(gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
-assert(gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labeltarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;)).
-assert(gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;)).
-assert(gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;)).
-assert(gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(&#39;nslimit nslimit1&#39;,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;)).
-assert(gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;)).
-assert(gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;)).
-assert(gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;)).
-assert(gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
-assert(gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;)).
-assert(gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
-assert(gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
-assert(gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(target,[cluster,edge,graph,node],[escString,string],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;)).
-assert(gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;)).
-assert(gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;)).
-assert(gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;)).
-assert(gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;)).
-assert(gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;)).
diff --git a/test/test.pl b/test/test.pl
deleted file mode 100644
index 83dc023..0000000
--- a/test/test.pl
+++ /dev/null
@@ -1,15 +0,0 @@
-%/fca
-:- use_module(library(fca/fca_viz)).
-%/graph
-:- use_module(library(graph/build_export_graph)).
-%/gv
-:- use_module(library(gv/gv_attrs)).
-:- use_module(library(gv/gv_attr_type)).
-:- use_module(library(gv/gv_color)).
-:- use_module(library(gv/gv_dom)).
-:- use_module(library(gv/gv_file)).
-:- use_module(library(gv/gv_graph)).
-:- use_module(library(gv/gv_graph_comp)).
-:- use_module(library(gv/gv_html)).
-%/tree
-:- use_module(library(tree/tree_viz)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;26&#34;&gt; 26: 正在比较变动前 76ea35d 和变动后 2a2728b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index 9888973..68443ba 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -76,13 +76,13 @@ gv_compass_pt(sw) --&amp;gt; `sw`.
 gv_compass_pt(w) --&amp;gt; `w`.
 
 
-%! gv_edge_operator(+Directed:boolean)// .
+%! gv_edge_operator(+Directedness:boolean)// .
 % The binary edge operator between two vertices.
 % The operator that is used depends on whether the graph is directed or
 % undirected.
 %
-% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
-%               undirected (operator `--`).
+% @arg Directedness Whether an edge is directed (operator `-&amp;gt;`) or
+%                   undirected (operator `--`).
 
 gv_edge_operator(false) --&amp;gt; !, `--`.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
@@ -90,14 +90,14 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 %! gv_edge_statement(
 %!   +Indent:nonneg,
-%!   +Directed:boolean,
+%!   +Directedness:boolean,
 %!   +GraphAttributes:list(nvpair),
 %!   +EdgeTerm:compound
 %! )// is det.
 % A GraphViz statement describing an edge.
 %
 % @arg Indent The indentation level at which the edge statement is written.
-% @arg Directed Whether the graph is directed or not.
+% @arg Directedness Whether the graph is directed or not.
 % @arg GraphAttributes The attributes of the graph. Some of these attributes
 %      may be used in the edge statement (e.g., the colorscheme).
 % @arg EdgeTerm A compound term in the GIFormat, representing an edge.
@@ -106,11 +106,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 %      at the from and/or to location.
 % @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
 
-gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
+gv_edge_statement(I, Directedness, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
   gv_node_id(FromId), ` `,
 
-  gv_edge_operator(Directed), ` `,
+  gv_edge_operator(Directedness), ` `,
 
   gv_node_id(ToId), ` `,
 
@@ -148,11 +148,11 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 %! gv_graph(+GraphTerm:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
-%   1. `directonality(+Directed:oneof([directed,undirected]))`
-%      A directed graph uses the keyword `digraph`.
-%      An undirected graph uses the keyword `graph`.
-%   2. `name(+GraphName:atom)`
-%   3. `strict(+StrictGraph:boolean)`
+%   * `directedness(+boolean)`
+%      Whether the graph is directed (`true`) or undirected (`false`).
+%      Default: `false`.
+%   * `name(+GraphName:atom)`
+%   * `strict(+StrictGraph:boolean)`
 %      This forbids the creation of self-arcs and multi-edges;
 %      they are ignored in the input file.
 %      Only in combinattion with directionality `directed`.
@@ -185,7 +185,7 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
     select_nvpair(strict=Strict, GAttrs1, GAttrs2, false),
-    select_nvpair(directed=Directed, GAttrs2, GAttrs3, true),
+    select_nvpair(directedness=Directedness, GAttrs2, GAttrs3, true),
     select_nvpair(name=GName, GAttrs3, GAttrs4, noname),
     add_default_nvpair(GAttrs4, overlap, false, GAttrs5),
     I = 0
@@ -195,24 +195,24 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), ` `,
+  gv_graph_type(Directedness), ` `,
   gv_id(GName), ` `,
   bracketed(
     curly,
-    gv_graph1(
+    gv_graph0(
       I,
       NewVTerms, SharedVAttrs, RankedVTerms,
       NewETerms, SharedEAttrs,
-      Directed, GAttrs5
+      Directedness, GAttrs5
     )
-  ),
+  ),                                                      
   newline.
 
-gv_graph1(
+gv_graph0(
   I,
   NewVTerms, SharedVAttrs, RankedVTerms,
   NewETerms, SharedEAttrs,
-  Directed, GAttrs
+  Directedness, GAttrs
 ) --&amp;gt;
   newline,
 
@@ -254,10 +254,10 @@ gv_graph1(
   },
 
   % The rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), RankEdges),
+  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), RankEdges),
 
   % The non-rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), NewETerms),
+  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), NewETerms),
 
   % Note that we do not include a newline here.
 
@@ -265,7 +265,7 @@ gv_graph1(
   indent(I).
 
 
-%! gv_graph_type(+Directed:boolean)// .
+%! gv_graph_type(+Directedness:boolean)// .
 % The type of graph that is represented.
 
 gv_graph_type(false) --&amp;gt; `graph`.
diff --git a/gv_file.pl b/gv_file.pl
index c780692..9eaf66b 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -1,12 +1,17 @@
 :- module(
   gv_file,
   [
+    file_to_gv/2, % +File:atom
+                  % +Options:list(nvpair)
+    file_to_gv/3, % +FromFile:atom
+                  % ?ToFile:atom
+                  % +Options:list(nvpair)
     gif_to_gv_file/3, % +GraphInterchangeFormat:compound
-                      % ?ToFile:atom
+                      % +ToFile:atom
+                      % +Options:list(nvpair)
+    gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
+                      % -SvgDom:list(compound)
                       % +Options:list(nvpair)
-    graph_to_svg_dom/3, % +GraphInterchangeFormat:compound
-                        % -SvgDom:list(compound)
-                        % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -29,13 +34,10 @@ and GraphViz output files or SVG DOM structures.
 
 :- use_module(generics(codes_ext)).
 :- use_module(generics(db_ext)).
-:- use_module(generics(error_ext)).
-:- use_module(generics(trees)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
 :- use_module(os(safe_file)).
 :- use_module(svg(svg_file)).
-:- use_module(ugraph(ugraph_export)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -77,77 +79,56 @@ and GraphViz output files or SVG DOM structures.
 :- db_add_novel(user:prolog_file_type(xdot, graphviz_output)).
 :- db_add_novel(user:prolog_file_type(xdot, xdot)).
 
-:- predicate_options(graph_to_svg_dom/3, 3, [
-     pass_to(gif_to_gv_file/3, 3)
+:- predicate_options(codes_to_gv_file/3, 3, [
+     pass_to(file_to_gv/3, 3)
    ]).
-:- predicate_options(gif_to_gv_file/3, 3, [
-     pass_to(to_gv_file/3, 3)
+:- predicate_options(file_to_gv/2, 2, [
+     pass_to(file_to_gv/3, 3)
    ]).
-:- predicate_options(to_gv_file/3, 3, [
-     pass_to(convert_gv/3, 3)
-   ]).
-:- predicate_options(convert_gv/3, 3, [
+:- predicate_options(file_to_gv/3, 3, [
      method(+oneof([dot,sfdp])),
      to_file_type(+oneof([dot,jpeg,pdf,svg,xdot]))
    ]).
+:- predicate_options(gif_to_svg_dom/3, 3, [
+     pass_to(gif_to_gv_file/3, 3)
+   ]).
+:- predicate_options(gif_to_gv_file/3, 3, [
+     pass_to(codes_to_gv_file/3, 3)
+   ]).
 
 
 
-%! gif_to_gv_file(+Gif:compound, -ToFile:atom, +Options:list(nvpair)) is det.
-% Returns a file containing a GraphViz visualization of the given graph.
-%
-% The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
-%     The file type of the generated GraphViz file.
-%     Default: `pdf`.
-
-gif_to_gv_file(Gif, ToFile, Options):-
-  once(phrase(gv_graph(Gif), Codes)),
-  to_gv_file(Codes, ToFile, Options).
-
-
-%! graph_to_svg_dom(
-%!   +GraphInterchangeFormat:compound,
-%!   -SvgDom:list(compound),
+%! codes_to_gv_file(
+%!   +Codes:list(code),
+%!   +ToFile:atom,
 %!   +Options:list(nvpair)
 %! ) is det.
 
-graph_to_svg_dom(Gif, SvgDom, Options1):-
-  % Make sure the file type of the output file is SvgDom.
-  merge_options([to_file_type=svg], Options1, Options2),
-  gif_to_gv_file(Gif, ToFile, Options2),
-  file_to_svg(ToFile, SvgDom),
-  safe_delete_file(ToFile).
-
-
-%! open_dot(+File:atom) is det.
-% Opens the given DOT file.
-%
-% @tbd Test support on Windows.
-% @tbd Test support on OS-X.
-
-open_dot(File):-
-  once(find_program_by_file_type(dot, Program)),
-  run_program(Program, [File]).
+codes_to_gv_file(Codes, ToFile, Options):-
+  access_file(ToFile, write),
+  absolute_file_name(data(tmp), TmpFile, [access(write),file_type(dot)]),
+  setup_call_cleanup(
+    open(TmpFile, write, Write, [encoding(utf8)]),
+    put_codes(Write, Codes),
+    close(Write)
+  ),
+  file_to_gv(TmpFile, ToFile, Options),
+  delete_file(TmpFile).
 
 
+%! file_to_gv(+FromFile:atom, +Options:list(nvpair)) is det.
 
-% SUPPORT PREDICATES %
+file_to_gv(FromFile, Options):-
+  file_to_gv(FromFile, _, Options).
 
-%! convert_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
+%! file_to_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
 % Converts a GraphViz DOT file to an image file, using a specific
 % visualization method.
 
-convert_gv(FromFile, ToFile, Options):-
+file_to_gv(FromFile, ToFile, Options):-
   option(to_file_type(dot), Options), !,
   rename_file(FromFile, ToFile).
-convert_gv(FromFile, ToFile, Options):-
-  % The input file must be readable.
-  access_file(FromFile, read),
-
+file_to_gv(FromFile, ToFile, Options):-
   % The method option.
   option(method(Method), Options, dot),
   must_be(oneof([dot,sfdp]), Method),
@@ -161,11 +142,8 @@ convert_gv(FromFile, ToFile, Options):-
   (
     var(ToFile)
   -&amp;gt;
-    absolute_file_name(
-      data(export),
-      ToFile,
-      [access(write),file_type(ToFileType)]
-    )
+    user:prolog_file_type(ToExtension, ToFileType),
+    file_alternative(FromFile, _, _, ToExtension, ToFile)
   ;
     is_absolute_file_name(ToFile),
     % The given output file must match a certain file extension.
@@ -186,26 +164,43 @@ convert_gv(FromFile, ToFile, Options):-
   exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
 
 
-%! to_gv_file(+Codes:list(code), ?ToFile:atom, +Options:list(nvpair)) is det.
+%! gif_to_gv_file(+Gif:compound, +ToFile:atom, +Options:list(nvpair)) is det.
+% Returns a file containing a GraphViz visualization of the given graph.
+%
+% The following options are supported:
+%   * =|method(+Method:oneof([dot,sfdp])|=
+%     The algorithm used by GraphViz for positioning the tree nodes.
+%     Either =dot= (default) or =sfdp=.
+%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
+%     The file type of the generated GraphViz file.
+%     Default: `pdf`.
 
-to_gv_file(Codes, ToFile, Options):-
-  absolute_file_name(
-    data(tmp),
-    FromFile,
-    [access(write),file_type(graphviz)]
-  ),
-  setup_call_cleanup(
-    open(FromFile, write, Out, [encoding(utf8),type(test)]),
-    put_codes(Out, Codes),
-    close(Out)
-  ),
-  convert_gv(FromFile, ToFile, Options),
+gif_to_gv_file(Gif, ToFile, Options):-
+  once(phrase(gv_graph(Gif), Codes)),
+  codes_to_gv_file(Codes, ToFile, Options).
 
-  %%%%% DEB: Store DOT file.
-  %%%%ignore((
-  %%%%  file_type_alternative(ToFile, graphviz, DOT_File),
-  %%%%  safe_copy_file(FromFile, DOT_File)
-  %%%%)),
 
-  safe_delete_file(FromFile).
+%! gif_to_svg_dom(
+%!   +GraphInterchangeFormat:compound,
+%!   -SvgDom:list(compound),
+%!   +Options:list(nvpair)
+%! ) is det.
+
+gif_to_svg_dom(Gif, SvgDom, Options1):-
+  % Make sure the file type of the output file is SvgDom.
+  merge_options([to_file_type=svg], Options1, Options2),
+  gif_to_gv_file(Gif, ToFile, Options2),
+  file_to_svg(ToFile, SvgDom),
+  safe_delete_file(ToFile).
+
+
+%! open_dot(+File:atom) is det.
+% Opens the given DOT file.
+%
+% @tbd Test support on Windows.
+% @tbd Test support on OS-X.
+
+open_dot(File):-
+  once(find_program_by_file_type(dot, Program)),
+  run_program(Program, [File]).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;27&#34;&gt; 27: 正在比较变动前 2a2728b 和变动后 7f9fc82 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_tree.pl b/gv_tree.pl
index afeb8f6..7a181b5 100644
--- a/gv_tree.pl
+++ b/gv_tree.pl
@@ -30,7 +30,7 @@ Export trees to GraphViz.
 %! ) is det.
 % Stores the given tree term into a GraphViz file.
 %
-% Options are passed on to create_gif/3 and gif_to_gv_file/3.
+% Options are passed on to build_gif/3 and gif_to_gv_file/3.
 
 tree_to_gv_file(Tree, ToFile, Options):-
   tree_to_gif(Tree, Gif, Options),
@@ -39,5 +39,5 @@ tree_to_gv_file(Tree, ToFile, Options):-
 
 tree_to_gif(H-T, Gif, Options):-
   tree_to_vertices_edges(Tree, Vs, Es),
-  create_gif(Vs, Es, Gif, Options).
+  build_gif(Vs, Es, Gif, Options).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;28&#34;&gt; 28: 正在比较变动前 7f9fc82 和变动后 5baddb5 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index 68443ba..4f7f341 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -76,12 +76,12 @@ gv_compass_pt(sw) --&amp;gt; `sw`.
 gv_compass_pt(w) --&amp;gt; `w`.
 
 
-%! gv_edge_operator(+Directedness:boolean)// .
+%! gv_edge_operator(+Directed:boolean)// .
 % The binary edge operator between two vertices.
 % The operator that is used depends on whether the graph is directed or
 % undirected.
 %
-% @arg Directedness Whether an edge is directed (operator `-&amp;gt;`) or
+% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
 gv_edge_operator(false) --&amp;gt; !, `--`.
@@ -90,14 +90,14 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 %! gv_edge_statement(
 %!   +Indent:nonneg,
-%!   +Directedness:boolean,
+%!   +Directed:boolean,
 %!   +GraphAttributes:list(nvpair),
 %!   +EdgeTerm:compound
 %! )// is det.
 % A GraphViz statement describing an edge.
 %
 % @arg Indent The indentation level at which the edge statement is written.
-% @arg Directedness Whether the graph is directed or not.
+% @arg Directed Whether the graph is directed or not.
 % @arg GraphAttributes The attributes of the graph. Some of these attributes
 %      may be used in the edge statement (e.g., the colorscheme).
 % @arg EdgeTerm A compound term in the GIFormat, representing an edge.
@@ -106,11 +106,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 %      at the from and/or to location.
 % @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
 
-gv_edge_statement(I, Directedness, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
+gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
   gv_node_id(FromId), ` `,
 
-  gv_edge_operator(Directedness), ` `,
+  gv_edge_operator(Directed), ` `,
 
   gv_node_id(ToId), ` `,
 
@@ -148,7 +148,7 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 %! gv_graph(+GraphTerm:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
-%   * `directedness(+boolean)`
+%   * `directed(+boolean)`
 %      Whether the graph is directed (`true`) or undirected (`false`).
 %      Default: `false`.
 %   * `name(+GraphName:atom)`
@@ -185,7 +185,7 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
     select_nvpair(strict=Strict, GAttrs1, GAttrs2, false),
-    select_nvpair(directedness=Directedness, GAttrs2, GAttrs3, true),
+    select_nvpair(directed=Directed, GAttrs2, GAttrs3, true),
     select_nvpair(name=GName, GAttrs3, GAttrs4, noname),
     add_default_nvpair(GAttrs4, overlap, false, GAttrs5),
     I = 0
@@ -195,7 +195,7 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directedness), ` `,
+  gv_graph_type(Directed), ` `,
   gv_id(GName), ` `,
   bracketed(
     curly,
@@ -203,16 +203,16 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
       I,
       NewVTerms, SharedVAttrs, RankedVTerms,
       NewETerms, SharedEAttrs,
-      Directedness, GAttrs5
+      Directed, GAttrs5
     )
-  ),                                                      
+  ),
   newline.
 
 gv_graph0(
   I,
   NewVTerms, SharedVAttrs, RankedVTerms,
   NewETerms, SharedEAttrs,
-  Directedness, GAttrs
+  Directed, GAttrs
 ) --&amp;gt;
   newline,
 
@@ -254,10 +254,10 @@ gv_graph0(
   },
 
   % The rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), RankEdges),
+  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), RankEdges),
 
   % The non-rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directedness, GAttrs), NewETerms),
+  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), NewETerms),
 
   % Note that we do not include a newline here.
 
@@ -265,7 +265,7 @@ gv_graph0(
   indent(I).
 
 
-%! gv_graph_type(+Directedness:boolean)// .
+%! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
 gv_graph_type(false) --&amp;gt; `graph`.
diff --git a/gv_file.pl b/gv_file.pl
index 9eaf66b..0482196 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -112,8 +112,7 @@ codes_to_gv_file(Codes, ToFile, Options):-
     put_codes(Write, Codes),
     close(Write)
   ),
-  file_to_gv(TmpFile, ToFile, Options),
-  delete_file(TmpFile).
+  file_to_gv(TmpFile, ToFile, Options).
 
 
 %! file_to_gv(+FromFile:atom, +Options:list(nvpair)) is det.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;29&#34;&gt; 29: 正在比较变动前 5baddb5 和变动后 95bfe7f &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index 4f7f341..35bc3f9 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -197,6 +197,8 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   gv_strict(Strict),
   gv_graph_type(Directed), ` `,
   gv_id(GName), ` `,
+
+  % The body of the DOT file appears between curly braces.
   bracketed(
     curly,
     gv_graph0(
@@ -228,9 +230,21 @@ gv_graph0(
   % Attributes that are the same for all edges.
   gv_generic_attributes_statement(edge, NewI, GAttrs, SharedEAttrs),
 
-  % Only add a newline if some content was written in the previous three
-  % lines.
-  ({(GAttrs == [], SharedVAttrs == [], SharedEAttrs == [])} -&amp;gt; `` ; newline),
+  % Only add a newline if some content was already written
+  % and some content is about to be written.
+  (
+    {
+      % Succeeds if no content was written.
+      (GAttrs == [], SharedVAttrs == [], SharedEAttrs == [])
+    ;
+      % Succeeds if no content is about to be written.
+      (NewVTerms == [], RankedVTerms == [])
+    }
+  -&amp;gt;
+    ``
+  ;
+    newline
+  ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms),
diff --git a/gv_file.pl b/gv_file.pl
index 0482196..bba87f9 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -7,7 +7,7 @@
                   % ?ToFile:atom
                   % +Options:list(nvpair)
     gif_to_gv_file/3, % +GraphInterchangeFormat:compound
-                      % +ToFile:atom
+                      % ?ToFile:atom
                       % +Options:list(nvpair)
     gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
                       % -SvgDom:list(compound)
@@ -25,7 +25,7 @@ Also converts between GraphViz DOT formatted files
 and GraphViz output files or SVG DOM structures.
 
 @author Wouter Beek
-@version 2011-2013/09, 2013/11-2014/01, 2014/05, 2014/07
+@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08
 */
 
 :- use_module(library(option)).
@@ -36,7 +36,6 @@ and GraphViz output files or SVG DOM structures.
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
-:- use_module(os(safe_file)).
 :- use_module(svg(svg_file)).
 
 :- use_module(plGraphViz(gv_dot)).
@@ -100,12 +99,11 @@ and GraphViz output files or SVG DOM structures.
 
 %! codes_to_gv_file(
 %!   +Codes:list(code),
-%!   +ToFile:atom,
+%!   ?ToFile:atom,
 %!   +Options:list(nvpair)
 %! ) is det.
 
 codes_to_gv_file(Codes, ToFile, Options):-
-  access_file(ToFile, write),
   absolute_file_name(data(tmp), TmpFile, [access(write),file_type(dot)]),
   setup_call_cleanup(
     open(TmpFile, write, Write, [encoding(utf8)]),
@@ -163,7 +161,7 @@ file_to_gv(FromFile, ToFile, Options):-
   exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
 
 
-%! gif_to_gv_file(+Gif:compound, +ToFile:atom, +Options:list(nvpair)) is det.
+%! gif_to_gv_file(+Gif:compound, ?ToFile:atom, +Options:list(nvpair)) is det.
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
@@ -190,7 +188,7 @@ gif_to_svg_dom(Gif, SvgDom, Options1):-
   merge_options([to_file_type=svg], Options1, Options2),
   gif_to_gv_file(Gif, ToFile, Options2),
   file_to_svg(ToFile, SvgDom),
-  safe_delete_file(ToFile).
+  delete_file(ToFile).
 
 
 %! open_dot(+File:atom) is det.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;30&#34;&gt; 30: 正在比较变动前 95bfe7f 和变动后 f1322fa &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 5b34b01..d7d21ad 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 5b34b01ab0cc82a56e6fd90fc26e75da22f5a0fe
+Subproject commit d7d21ad4d6d7cec98d8b0122f5303e691998f512
diff --git a/plHtml b/plHtml
index 08480c4..18e657b 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 08480c40acaee5f70bfb21e3c641bef1e7d258bd
+Subproject commit 18e657b22a84d5e98a317ddec58314964ff68bcd
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;31&#34;&gt; 31: 正在比较变动前 f1322fa 和变动后 474bea8 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/index.pl b/index.pl
deleted file mode 100644
index 7461d13..0000000
--- a/index.pl
+++ /dev/null
@@ -1,2 +0,0 @@
-% Index of project plGraphViz (empty).
-
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;32&#34;&gt; 32: 正在比较变动前 474bea8 和变动后 262cb2a &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_tree.pl b/gv_tree.pl
deleted file mode 100644
index 7a181b5..0000000
--- a/gv_tree.pl
+++ /dev/null
@@ -1,43 +0,0 @@
-:- module(
-  gv_tree,
-  [
-    tree_to_gv_file/3 % +Tree:compound
-                      % ?ToFile:atom
-                      % +Options:list(nvpair)
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz tree
-
-Export trees to GraphViz.
-
-@author Wouter Beek
-@version 2014/06-2014/07
-*/
-
-:- use_module(library(aggregate)).
-
-:- use_module(generics(trees)).
-
-:- use_module(plGraphViz(gv_file)).
-:- use_module(plGraphViz(gv_gif)).
-
-
-%! tree_to_gv_file(
-%!   +Tree:compound,
-%!   ?ToFile:atom,
-%!   +Options:list(nvpair)
-%! ) is det.
-% Stores the given tree term into a GraphViz file.
-%
-% Options are passed on to build_gif/3 and gif_to_gv_file/3.
-
-tree_to_gv_file(Tree, ToFile, Options):-
-  tree_to_gif(Tree, Gif, Options),
-  gif_to_gv_file(Gif, ToFile, Options).
-
-
-tree_to_gif(H-T, Gif, Options):-
-  tree_to_vertices_edges(Tree, Vs, Es),
-  build_gif(Vs, Es, Gif, Options).
-
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;33&#34;&gt; 33: 正在比较变动前 262cb2a 和变动后 e7e6033 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 7a64c82..3c7863d 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -49,9 +49,9 @@
 @version 2014/06
 */
 
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_cardinal)).
-:- use_module(dcg(dcg_content)).
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_cardinal)).
+:- use_module(plDcg(dcg_content)).
 
 :- use_module(plGraphViz(gv_html)).
 
@@ -97,7 +97,7 @@ gv_attr_type(viewPort).
 % An *addDouble* is represented by a Prolog float.
 
 addDouble(Float) --&amp;gt;
-  &#39;?&#39;(`+`),
+  &#39;?&#39;(`+`, []),
   double(Float).
 
 
@@ -106,7 +106,7 @@ addDouble(Float) --&amp;gt;
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
 addPoint(Point) --&amp;gt;
-  &#39;?&#39;(`+`),
+  &#39;?&#39;(`+`, []),
   point(Point).
 
 
@@ -184,7 +184,7 @@ double(Double1) --&amp;gt;
 
 doubleList([H|T]) --&amp;gt;
   double(H),
-  &#39;*&#39;(doubleList1, T).
+  &#39;*&#39;(doubleList1, T, []).
 
 doubleList1(Float) --&amp;gt;
   `:`,
@@ -255,7 +255,7 @@ input_only(true) --&amp;gt; `!`.
 
 
 pointList(Points) --&amp;gt;
-  &#39;*&#39;(point, Points).
+  &#39;*&#39;(point, Points, []).
 
 
 % @tbd portPos
diff --git a/gv_attrs.pl b/gv_attrs.pl
index dd0145a..faf496c 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -17,11 +17,12 @@
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(dcg(dcg_content)).
-:- use_module(dcg(dcg_generic)).
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 
+:- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_generic)).
+
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
diff --git a/gv_color.pl b/gv_color.pl
index 19d6e05..14026ee 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -21,16 +21,19 @@
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_cardinal)).
-:- use_module(dcg(dcg_content)).
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
-:- use_module(sparql(sparql_char)).
+
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_cardinal)).
+:- use_module(plDcg(dcg_content)).
+:- use_module(plDcg_rfc(rfc2616_basic)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
+:- use_module(plSparql_parse(sparql_char)).
+
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
@@ -49,12 +52,12 @@
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
   `#`,
-  &#39;#&#39;(3, hex_color, [Red,Green,Blue]).
+  &#39;#&#39;(3, hex_color, [Red,Green,Blue], []).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
   `#`,
-  &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha]).
+  &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha], []).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
-  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value]).
+  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
 color(Name) --&amp;gt;
   {gv_color(_, Name)},
   atom(Name).
@@ -72,11 +75,11 @@ hsv_color(D, Head, Tail):-
 %! colorList(+Pairs:list(pair(compound,float)))// .
 
 colorList(Pairs) --&amp;gt;
-  &#39;+&#39;(wc, Pairs).
+  &#39;+&#39;(wc, Pairs, []).
 
 wc(Color-Float) --&amp;gt;
   color(Color),
-  &#39;?&#39;(wc_weight(Float)).
+  &#39;?&#39;(wc_weight(Float), []).
 
 wc_weight(Float) --&amp;gt;
   `;`,
diff --git a/gv_dot.pl b/gv_dot.pl
index 35bc3f9..accd5bd 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -22,12 +22,11 @@ In GraphViz vertices are called &#39;nodes&#39;.
 :- use_module(library(lists)).
 :- use_module(library(ordsets)).
 
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_ascii)).
-:- use_module(dcg(dcg_content)).
-:- use_module(dcg(dcg_generic)).
-:- use_module(dcg(dcg_meta)).
-:- use_module(dcg(dcg_os)).
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_generic)).
+:- use_module(plDcg(dcg_meta)).
 
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
@@ -56,7 +55,7 @@ gv_attribute(Name=Val) --&amp;gt;
 % Attributes occur between square brackets.
 gv_attribute_list(Context, _, Attrs1) --&amp;gt;
   {maplist(gv_attr(Context), Attrs1, Attrs2)},
-  bracketed(square, &#39;*&#39;(gv_attribute, Attrs2)).
+  bracketed(square, &#39;*&#39;(gv_attribute, Attrs2, [])).
 
 
 %! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
@@ -117,7 +116,7 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
   gv_attribute_list(edge, GAttrs, EAttrs),
-  newline.
+  line_feed.
 
 
 %! gv_generic_attributes_statement(
@@ -142,7 +141,7 @@ gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
   gv_kind(Kind), ` `,
-  gv_attribute_list(Kind, GraphAttrs, KindAttrs), newline.
+  gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
 %! gv_graph(+GraphTerm:compound)//
@@ -208,7 +207,7 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
       Directed, GAttrs5
     )
   ),
-  newline.
+  line_feed.
 
 gv_graph0(
   I,
@@ -216,7 +215,7 @@ gv_graph0(
   NewETerms, SharedEAttrs,
   Directed, GAttrs
 ) --&amp;gt;
-  newline,
+  line_feed,
 
   % The following lines are indented.
   {NewI is I + 1},
@@ -230,7 +229,7 @@ gv_graph0(
   % Attributes that are the same for all edges.
   gv_generic_attributes_statement(edge, NewI, GAttrs, SharedEAttrs),
 
-  % Only add a newline if some content was already written
+  % Only add a line_feed if some content was already written
   % and some content is about to be written.
   (
     {
@@ -243,16 +242,16 @@ gv_graph0(
   -&amp;gt;
     ``
   ;
-    newline
+    line_feed
   ),
 
   % The list of GraphViz nodes.
-  &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms),
-  ({NewVTerms == []} -&amp;gt; `` ; newline),
+  &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
+  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
-  &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms),
-  ({RankedVTerms == []} -&amp;gt; `` ; newline),
+  &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
+  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
 
   {
     findall(
@@ -268,12 +267,12 @@ gv_graph0(
   },
 
   % The rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), RankEdges),
+  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), RankEdges, []),
 
   % The non-rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), NewETerms),
+  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), NewETerms, []),
 
-  % Note that we do not include a newline here.
+  % Note that we do not include a line_feed here.
 
   % We want to indent the closing curly brace.
   indent(I).
@@ -394,15 +393,15 @@ gv_node_id(Id) --&amp;gt;
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
   gv_node_id(Id), ` `,
-  gv_attribute_list(node, GraphAttrs, VAttrs), newline.
+  gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
 gv_port --&amp;gt;
   gv_port_location,
-  &#39;?&#39;(gv_port_angle).
+  &#39;?&#39;(gv_port_angle, []).
 gv_port --&amp;gt;
   gv_port_angle,
-  &#39;?&#39;(gv_port_location).
+  &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
   `:`,
   gv_compass_pt(_).
@@ -452,18 +451,22 @@ gv_ranked_node_collection(
 ) --&amp;gt;
   indent(I),
   bracketed(curly, (
-    newline,
+    line_feed,
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), `;`, newline,
-
-    &#39;*&#39;(gv_node_statement(NewI, GraphAttrs), [Rank_V_Term|Content_V_Terms]),
-
+    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
+
+    &#39;*&#39;(
+      gv_node_statement(NewI, GraphAttrs),
+      [Rank_V_Term|Content_V_Terms],
+      []
+    ),
+    
     % We want to indent the closing curly brace.
     indent(I)
   )),
-  newline.
+  line_feed.
 
 
 %! gv_strict(+Strict:boolean)// is det.
diff --git a/gv_html.pl b/gv_html.pl
index b8d3190..3f0b08b 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -11,7 +11,7 @@
 @version 2013/07, 2013/09, 2014/03-2014/06
 */
 
-:- use_module(dcg(dcg_content)).
+:- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index 9b82fc0..7870eb1 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -11,10 +11,11 @@
 @version 2014/05-2014/06
 */
 
-:- use_module(dcg(dcg_abnf)).
-:- use_module(dcg(dcg_cardinal)).
 :- use_module(math(math_ext)).
 
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_cardinal)).
+
 
 
 %! gv_numeral(?Value:number)// .
@@ -48,7 +49,7 @@ gv_numeral_abs(N) --&amp;gt;
     integer(N2)
   ;
     integer(N1),
-    &#39;?&#39;((`.`, &#39;integer?&#39;(N2)))
+    &#39;?&#39;((`.`, &#39;integer?&#39;(N2)), [])
   ).
 gv_numeral_abs(N) --&amp;gt;
   {var(N)},
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;34&#34;&gt; 34: 正在比较变动前 e7e6033 和变动后 e17bf44 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;35&#34;&gt; 35: 正在比较变动前 e17bf44 和变动后 6596aa1 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index bba87f9..c6d2933 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -30,7 +30,6 @@ and GraphViz output files or SVG DOM structures.
 
 :- use_module(library(option)).
 :- use_module(library(process)).
-:- use_module(library(predicate_options)). % Declarations.
 
 :- use_module(generics(codes_ext)).
 :- use_module(generics(db_ext)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;36&#34;&gt; 36: 正在比较变动前 6596aa1 和变动后 87e8982 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index d7d21ad..b1d2484 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit d7d21ad4d6d7cec98d8b0122f5303e691998f512
+Subproject commit b1d2484486ad4876aecc1bf70b2963b12efca341
diff --git a/plHtml b/plHtml
index 18e657b..24fff7b 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 18e657b22a84d5e98a317ddec58314964ff68bcd
+Subproject commit 24fff7bcf90b6bc4fbf317d504be899dc1b869cb
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;37&#34;&gt; 37: 正在比较变动前 87e8982 和变动后 cb6aada &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index faf496c..1692915 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -21,7 +21,7 @@
 :- use_module(os(file_ext)).
 
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generic)).
+:- use_module(plDcg(dcg_generics)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
diff --git a/gv_dot.pl b/gv_dot.pl
index accd5bd..5f33e5c 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -25,7 +25,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 :- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generic)).
+:- use_module(plDcg(dcg_generics)).
 :- use_module(plDcg(dcg_meta)).
 
 :- use_module(plGraphViz(gv_attrs)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;38&#34;&gt; 38: 正在比较变动前 cb6aada 和变动后 7c8125b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_color.pl b/gv_color.pl
index 14026ee..c5fccd4 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -13,7 +13,7 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06
+@version 2014/06, 2014/10
 */
 
 :- use_module(library(apply)).
@@ -32,8 +32,6 @@
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
-:- use_module(plSparql_parse(sparql_char)).
-
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
diff --git a/gv_file.pl b/gv_file.pl
index c6d2933..5253f39 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -135,15 +135,12 @@ file_to_gv(FromFile, ToFile, Options):-
   prolog_file_type(ToExtension, graphviz_output), !,
 
   % The output file is either given or created.
-  (
-    var(ToFile)
-  -&amp;gt;
-    user:prolog_file_type(ToExtension, ToFileType),
-    file_alternative(FromFile, _, _, ToExtension, ToFile)
-  ;
-    is_absolute_file_name(ToFile),
-    % The given output file must match a certain file extension.
-    file_name_extension(_, ToExtension, ToFile)
+  (   var(ToFile)
+  -&amp;gt;  user:prolog_file_type(ToExtension, ToFileType),
+      file_alternative(FromFile, _, _, ToExtension, ToFile)
+  ;   is_absolute_file_name(ToFile),
+      % The given output file must match a certain file extension.
+      file_name_extension(_, ToExtension, ToFile)
   ),
   % Now that we have the output file we can prevent the
   % file type / file extension translation predicates from bakctracking.
@@ -152,7 +149,8 @@ file_to_gv(FromFile, ToFile, Options):-
   % Run the GraphViz conversion command in the shell.
   format(atom(OutputType), &#39;-T~w&#39;, [ToExtension]),
   process_create(
-    path(Method),
+    %%%%path(Method),
+    &#39;C:\\Program Files (x86)\\Graphviz2.38\\bin\\dot.exe&#39;,
     [OutputType,FromFile,&#39;-o&#39;,ToFile],
     [process(PID)]
   ),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;39&#34;&gt; 39: 正在比较变动前 7c8125b 和变动后 6a38f95 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 5253f39..00c9eb0 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -149,8 +149,9 @@ file_to_gv(FromFile, ToFile, Options):-
   % Run the GraphViz conversion command in the shell.
   format(atom(OutputType), &#39;-T~w&#39;, [ToExtension]),
   process_create(
-    %%%%path(Method),
-    &#39;C:\\Program Files (x86)\\Graphviz2.38\\bin\\dot.exe&#39;,
+    path(Method),
+    % @tbd Windows hack:
+    %%%%&#39;C:\\Program Files (x86)\\Graphviz2.38\\bin\\dot.exe&#39;,
     [OutputType,FromFile,&#39;-o&#39;,ToFile],
     [process(PID)]
   ),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;40&#34;&gt; 40: 正在比较变动前 6a38f95 和变动后 ebb86cd &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index b25c15b..7193a38 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1 +1,4 @@
 *~
+*#
+*.db
+data/*
diff --git a/.gitmodules b/.gitmodules
index a63cbff..844b1bd 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,3 +4,6 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
+[submodule &amp;quot;plDcg&amp;quot;]
+	path = plDcg
+	url = https://github.com/wouterbeek/plDcg.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index b1d2484..15bbbbf 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit b1d2484486ad4876aecc1bf70b2963b12efca341
+Subproject commit 15bbbbf25471abe856afbf92a04c5b3ce76b0217
diff --git a/debug.pl b/debug.pl
new file mode 100644
index 0000000..099cb84
--- /dev/null
+++ b/debug.pl
@@ -0,0 +1,7 @@
+% Loads debug tools for the plGraphViz library.
+
+:- [load].
+
+:- use_module(debug_project).
+:- debug_all_files.
+
diff --git a/debug_project.pl b/debug_project.pl
new file mode 100644
index 0000000..4eb2785
--- /dev/null
+++ b/debug_project.pl
@@ -0,0 +1,55 @@
+:- module(
+  debug_project,
+  [
+    debug_all_files/0
+  ]
+).
+
+/** &amp;lt;module&amp;gt; Debug project
+
+Generic code for debugging a project:
+  * Load all subdirectories and Prolog files contained in those directories.
+
+@author Wouter Beek
+@version 2014/10/31
+*/
+
+:- use_module(library(ansi_term)).
+:- use_module(library(apply)).
+
+:- use_module(os(dir_ext)).
+
+% Avoid errors when using gtrace/0 in threads.
+:- initialization(guitracer).
+
+
+
+debug_all_files:-
+  absolute_file_name(project(.), Dir, [access(read),file_type(directory)]),
+  directory_files(
+    Dir,
+    Files1,
+    [
+      file_types([prolog]),
+      include_directories(false),
+      include_self(false),
+      recursive(true)
+    ]
+  ),
+  exclude(do_not_load, Files1, Files2),
+  maplist(use_module, Files2).
+
+do_not_load(File1):-
+  file_base_name(File1, File2),
+  file_name_extension(File3, pl, File2),
+  do_not_load0(File3).
+
+do_not_load0(dcg_ascii).
+do_not_load0(dcg_unicode).
+do_not_load0(debug).
+do_not_load0(debug_project).
+do_not_load0(index).
+do_not_load0(load).
+do_not_load0(load_project).
+do_not_load0(rfc2616_basic).
+do_not_load0(run).
diff --git a/load.pl b/load.pl
index 4b117d1..1681cd0 100644
--- a/load.pl
+++ b/load.pl
@@ -1,12 +1,13 @@
-% Load file for plGraphViz.
+% Load file for the plGraphViz library.
 
-:- dynamic(user:prolog/3).
-:- multifile(user:prolog/3).
-   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
+:- dynamic(user:project/3).
+:- multifile(user:project/3).
+   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;).
 
 :- use_module(load_project).
-:- load_project(plGraphViz, [
+:- load_project([
     plc-&#39;Prolog-Library-Collection&#39;,
+    plDcg,
     plHtml
 ]).
 
diff --git a/load_project.pl b/load_project.pl
index 5599b5e..e2196b7 100644
--- a/load_project.pl
+++ b/load_project.pl
@@ -1,8 +1,7 @@
 :- module(
   load_project,
   [
-    load_project/2, % +Parent:atom
-                    % +ChildProjects:list(or([atom,pair(atom)]))
+    load_project/1, % +ChildProjects:list(or([atom,pair(atom)]))
     load_subproject/2, % +ParentFileSearchPath:atom
                        % +Child:or([atom,pair(atom)])
     set_data_subdirectory/1 % +ParentDirectory:atom
@@ -17,7 +16,7 @@ Generic code for loading a project:
   * Load the index of subprojects onto the file search path.
 
 @author Wouter Beek
-@version 2014/06/14
+@version 2014/08/20
 */
 
 :- use_module(library(ansi_term)). % Colorized terminal messages.
@@ -30,11 +29,11 @@ Generic code for loading a project:
 
 
 
-load_project(Parent, ChildProjects):-
-  parent_alias(Parent, ParentFsp),
+load_project(ChildProjects):-
+  parent_alias(ParentFsp),
 
   % Entry point.
-  source_file(load_project(_,_), ThisFile),
+  source_file(load_project(_), ThisFile),
   file_directory_name(ThisFile, ThisDir),
   assert(user:file_search_path(ParentFsp, ThisDir)),
   assert(user:file_search_path(project, ThisDir)),
@@ -92,11 +91,12 @@ load_project_index(Fsp):-
 load_project_index(_).
 
 
-%! parent_alias(+Parent:atom, -ParentFsp:atom) is det.
+%! parent_alias(-ParentFsp:atom) is det.
 
-parent_alias(Parent, ParentFsp):-
-  user:project(Parent, _, ParentFsp), !.
-parent_alias(Parent, Parent).
+parent_alias(ParentFsp):-
+  user:project(_, _, ParentFsp), !.
+parent_alias(ParentFsp):-
+  user:project(ParentFsp, _).
 
 
 %! set_data_subdirectory(+ParentDirectory:atom) is det.
@@ -108,6 +108,8 @@ set_data_subdirectory(ParentDir):-
 
 
 
+% Messages
+
 :- multifile(prolog:message//1).
 
 prolog:message(missing_subproject_directory(ChildFsp,ChildDir)) --&amp;gt;
diff --git a/plDcg b/plDcg
new file mode 160000
index 0000000..e074367
--- /dev/null
+++ b/plDcg
@@ -0,0 +1 @@
+Subproject commit e0743670465a92c083e6954c5cf6220222f088b6
diff --git a/plHtml b/plHtml
index 24fff7b..8ef47e0 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 24fff7bcf90b6bc4fbf317d504be899dc1b869cb
+Subproject commit 8ef47e09a24c637ac435abbe1d01b21237be4534
diff --git a/run.pl b/run.pl
new file mode 100644
index 0000000..8bba736
--- /dev/null
+++ b/run.pl
@@ -0,0 +1,9 @@
+% Standalone execution of the plGraphViz library.
+
+:- if(current_prolog_flag(argv, [&#39;--debug&#39;|_])).
+  :- ensure_loaded(debug).
+:- else.
+  :- set_prolog_flag(verbose, silent).
+  :- ensure_loaded(load).
+:- endif.
+
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;41&#34;&gt; 41: 正在比较变动前 ebb86cd 和变动后 1549e44 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index 5f33e5c..bde2962 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +GraphTerm:compound
+    gv_graph//1 % +Gif:compound
   ]
 ).
 
@@ -39,7 +39,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % We assume that the attribute has already been validated.
 
 gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), `=`, gv_id(Val), `;`.
+  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
 
 
 %! gv_attribute_list(
@@ -63,16 +63,16 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
 % ~~~
 
-gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
-gv_compass_pt(c) --&amp;gt; `c`.
-gv_compass_pt(e) --&amp;gt; `e`.
-gv_compass_pt(n) --&amp;gt; `n`.
-gv_compass_pt(ne) --&amp;gt; `ne`.
-gv_compass_pt(nw) --&amp;gt; `nw`.
-gv_compass_pt(s) --&amp;gt; `s`.
-gv_compass_pt(se) --&amp;gt; `se`.
-gv_compass_pt(sw) --&amp;gt; `sw`.
-gv_compass_pt(w) --&amp;gt; `w`.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
+gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
+gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
+gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
+gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
+gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
+gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
+gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
+gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
+gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 
 
 %! gv_edge_operator(+Directed:boolean)// .
@@ -83,7 +83,7 @@ gv_compass_pt(w) --&amp;gt; `w`.
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, `--`.
+gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
@@ -107,11 +107,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), ` `,
+  gv_node_id(FromId), &amp;quot; &amp;quot;,
 
-  gv_edge_operator(Directed), ` `,
+  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
 
-  gv_node_id(ToId), ` `,
+  gv_node_id(ToId), &amp;quot; &amp;quot;,
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
@@ -140,11 +140,11 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
-  gv_kind(Kind), ` `,
+  gv_kind(Kind), &amp;quot; &amp;quot;,
   gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
-%! gv_graph(+GraphTerm:compound)//
+%! gv_graph(+Gif:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -176,10 +176,10 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
+gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
 
-gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
+gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
   {
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
@@ -194,8 +194,8 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), ` `,
-  gv_id(GName), ` `,
+  gv_graph_type(Directed), &amp;quot; &amp;quot;,
+  gv_id(GName), &amp;quot; &amp;quot;,
 
   % The body of the DOT file appears between curly braces.
   bracketed(
@@ -240,18 +240,18 @@ gv_graph0(
       (NewVTerms == [], RankedVTerms == [])
     }
   -&amp;gt;
-    ``
+    &amp;quot;&amp;quot;
   ;
     line_feed
   ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
+  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
   &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
+  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   {
     findall(
@@ -281,8 +281,8 @@ gv_graph0(
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; `graph`.
-gv_graph_type(true) --&amp;gt; `digraph`.
+gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 
 
 %! gv_id(?Atom:atom)// is det.
@@ -305,8 +305,9 @@ gv_graph_type(true) --&amp;gt; `digraph`.
 %      This requires an XML grammar!
 
 % HTML strings (variant 4).
-gv_id(Atom) --&amp;gt;
-  dcg_atom_codes(gv_html_like_label, Atom), !.
+gv_id(Content) --&amp;gt;
+  {compound(Content)}, !,
+  gv_html_like_label, Content).
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -353,19 +354,19 @@ gv_keyword(Codes):-
 % GraphViz has reserved keywords that cannot be used as identifiers.
 % GraphViz keywords are case-insensitive.
 
-gv_keyword --&amp;gt; `digraph`.
-gv_keyword --&amp;gt; `edge`.
-gv_keyword --&amp;gt; `graph`.
-gv_keyword --&amp;gt; `node`.
-gv_keyword --&amp;gt; `strict`.
-gv_keyword --&amp;gt; `subgraph`.
+gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; `edge`.
-gv_kind(graph) --&amp;gt; `graph`.
-gv_kind(node) --&amp;gt; `node`.
+gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
 
 
 %! gv_node_id(+NodeId:atom)// .
@@ -392,7 +393,7 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), ` `,
+  gv_node_id(Id), &amp;quot; &amp;quot;,
   gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
@@ -403,23 +404,23 @@ gv_port --&amp;gt;
   gv_port_angle,
   &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_compass_pt(_).
 
 gv_port_angle --&amp;gt;
-  `@`,
+  &amp;quot;@&amp;quot;,
   gv_id(_).
 
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_id(_).
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   bracketed(
     round,
     (
       gv_id(_),
-      `,`,
+      &amp;quot;,&amp;quot;,
       gv_id(_)
     )
   ).
@@ -436,7 +437,7 @@ gv_quoted_string([92,34|T]) --&amp;gt; !,
   gv_quoted_string(T).
 % Add the backslash escape character.
 gv_quoted_string([34|T]) --&amp;gt; !,
-  `\\\&amp;quot;`,
+  &amp;quot;\\\&amp;quot;&amp;quot;,
   gv_quoted_string(T).
 % All other characters are allowed without escaping.
 gv_quoted_string([H|T]) --&amp;gt;
@@ -455,7 +456,7 @@ gv_ranked_node_collection(
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
+    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
 
     &#39;*&#39;(
       gv_node_statement(NewI, GraphAttrs),
@@ -475,7 +476,7 @@ gv_ranked_node_collection(
 % This only applies to directed graphs.
 
 gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; `strict `.
+gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
 
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 3f0b08b..a308ac7 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -1,60 +1,223 @@
 :- module(
   gv_html,
   [
-    gv_html_like_label//1 % +Codes:list(code)
+    gv_html_like_label//1 % +Content:compound
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz HTML
+/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
+
+Grammar taken from the GraphViz Web site:
+
+~~~{.txt}
+label 	: 	text
+	| 	table
+text 	: 	textitem
+	| 	text textitem
+textitem 	: 	string
+	| 	&amp;lt;BR/&amp;gt;
+	| 	&amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+	| 	&amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+	| 	&amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+	| 	&amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+	| 	&amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+	| 	&amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+	| 	&amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+	| 	&amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+table 	: 	[ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+rows 	: 	row
+	| 	rows row
+	| 	rows &amp;lt;HR/&amp;gt; row
+row 	: 	&amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
+cells 	: 	cell
+	| 	cells cell
+	| 	cells &amp;lt;VR/&amp;gt; cell
+cell 	: 	&amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
+	| 	&amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
+~~~
 
 @author Wouter Beek
-@version 2013/07, 2013/09, 2014/03-2014/06
+@see http://www.graphviz.org/content/node-shapes#html
+@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
+:- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
 
 
-%! gv_html_label(+Codes:list(code))// .
+%! gv_html_like_label(?Content:compound)// .
+
+gv_html_like_label(Content) --&amp;gt;
+  bracketed(angular, label(Content)).
+
+
+%! cell(?Contents:compound)// .
+% Supported attributes for TD:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
+% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLSPAN=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWSPAN=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ~~~
 %
-% @see http://www.graphviz.org/doc/info/shapes.html#html
-
-gv_html_label --&amp;gt; gv_html_text, !.
-gv_html_label --&amp;gt; gv_html_table, !.
-gv_html_label --&amp;gt; [].
-
-gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
-
-gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
-
-gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
-gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
-
-gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row.
-
-gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
-
-gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
-gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
-
-gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
-gv_html_cells --&amp;gt; gv_html_cell.
-gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
-
-gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
-gv_html_text --&amp;gt; gv_html_textitem.
-
-gv_html_textitem --&amp;gt; html_string, !.
-gv_html_textitem --&amp;gt; html_entity, !.
-gv_html_textitem --&amp;gt; html_element(br, _), !.
-gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
-
+% Supported attributes for IMG:
+% ~~~{.txt}
+% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
+% SRC=&amp;quot;value&amp;quot;
+% ~~~
+
+cell(td(Contents)) --&amp;gt;
+  html_element(td, [], label(Contents)).
+cell(td(img)) --&amp;gt;
+  html_element(td, [], html_element(img)).
+
+
+%! cells(?Contents:list(compound))// .
+
+cells([H|T]) --&amp;gt;
+  cell(H),
+  cells(T).
+cells([H,vr|T]) --&amp;gt;
+  cell(H),
+  html_element(vr),
+  cells(T).
+cells([H]) --&amp;gt;
+  cell(H).
+
+
+%! label(?Content:compound)// .
+% GraphViz HTML-like label.
+
+label(Content) --&amp;gt;
+  text(Content).
+label(Content) --&amp;gt;
+  table(Content).
+
+
+%! row(?Contents:compound)// .
+
+row(tr(Contents)) --&amp;gt;
+  html_element(tr, [], cell(Contents)).
+
+
+%! rows(?Contents:list)// .
+
+rows([H|T]) --&amp;gt;
+  row(H),
+  rows.
+rows([H,hr|T]) --&amp;gt;
+  row(H),
+  html_element(hr),
+  rows(T).
+rows([H]) --&amp;gt;
+  row(H).
+
+
+%! table(?Contents:compound)// .
+% Supported attributes for TABLE:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLBORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLUMNS=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWS=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ~~~
+%
+% Supported attributes for FONT:
+% ~~~{.txt}
+% COLOR=&amp;quot;color&amp;quot;
+% FACE=&amp;quot;fontname&amp;quot;
+% POINT-SIZE=&amp;quot;value&amp;quot;
+% ~~~
+
+table(table(Attrs,Contents)) --&amp;gt;
+  html_element(table, Attrs, rows(Contents)).
+table(table(font(Contents))) --&amp;gt;
+  html_element(font, [], html_element(table, [], rows(Contents))).
+
+
+%! text(?Contents:list)// .
+
+text(Contents) --&amp;gt;
+  &#39;+&#39;(textitem, Contents, []).
+
+
+%! textitem(?Content)// .
+% Supported attributes for BR:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% ~~~
+
+textitem(string(String)) --&amp;gt;
+  html_string(String).
+textitem(entity(Name)) --&amp;gt;
+  html_entity(Name).
+textitem(br(Attrs)) --&amp;gt;
+  html_element(br, Attrs).
+textitem(Compound) --&amp;gt;
+  {var(Compound)}, !,
+  html_element(Name, _, text(Content)),
+  {
+    supported_html_element(Name),
+    Compound =.. [Name,Content]
+  }.
+textitem(Compound) --&amp;gt;
+  {
+    Compound =.. [Name,Content],
+    supported_html_element(Name)
+  },
+  html_element(Name, _, text(Content)).
+
+
+
+% HELPERS
+
+%! supported_html_element(+Name:atom) is semidet.
+%! supported_html_element(-Name:atom) is multi.
+
+supported_html_element(b).
+supported_html_element(font).
+supported_html_element(i).
+supported_html_element(o).
+supported_html_element(s).
+supported_html_element(sub).
+supported_html_element(sup).
+supported_html_element(u).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;42&#34;&gt; 42: 正在比较变动前 1549e44 和变动后 61ddca2 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 15bbbbf..727ea49 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 15bbbbf25471abe856afbf92a04c5b3ce76b0217
+Subproject commit 727ea49d47063b733ae499615fda6aa06c84fb6f
diff --git a/debug_project.pl b/debug_project.pl
index 4eb2785..ab61534 100644
--- a/debug_project.pl
+++ b/debug_project.pl
@@ -37,7 +37,10 @@ debug_all_files:-
     ]
   ),
   exclude(do_not_load, Files1, Files2),
-  maplist(use_module, Files2).
+  maplist(use_module0, Files2).
+use_module0(File):-
+  print_message(informational, loading_module(File)),
+  use_module(File).
 
 do_not_load(File1):-
   file_base_name(File1, File2),
@@ -53,3 +56,12 @@ do_not_load0(load).
 do_not_load0(load_project).
 do_not_load0(rfc2616_basic).
 do_not_load0(run).
+
+
+
+% MESSAGES
+
+:- multifile(prolog:message//1).
+
+prolog:message(loading_module(File)) --&amp;gt;
+  [&#39;[M] &#39;,File].
diff --git a/gv_dot.pl b/gv_dot.pl
index bde2962..5f33e5c 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +Gif:compound
+    gv_graph//1 % +GraphTerm:compound
   ]
 ).
 
@@ -39,7 +39,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % We assume that the attribute has already been validated.
 
 gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
+  gv_id(Name), `=`, gv_id(Val), `;`.
 
 
 %! gv_attribute_list(
@@ -63,16 +63,16 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
 % ~~~
 
-gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
-gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
-gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
-gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
-gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
-gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
-gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
-gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
-gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
-gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
+gv_compass_pt(c) --&amp;gt; `c`.
+gv_compass_pt(e) --&amp;gt; `e`.
+gv_compass_pt(n) --&amp;gt; `n`.
+gv_compass_pt(ne) --&amp;gt; `ne`.
+gv_compass_pt(nw) --&amp;gt; `nw`.
+gv_compass_pt(s) --&amp;gt; `s`.
+gv_compass_pt(se) --&amp;gt; `se`.
+gv_compass_pt(sw) --&amp;gt; `sw`.
+gv_compass_pt(w) --&amp;gt; `w`.
 
 
 %! gv_edge_operator(+Directed:boolean)// .
@@ -83,7 +83,7 @@ gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
+gv_edge_operator(false) --&amp;gt; !, `--`.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
@@ -107,11 +107,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), &amp;quot; &amp;quot;,
+  gv_node_id(FromId), ` `,
 
-  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
+  gv_edge_operator(Directed), ` `,
 
-  gv_node_id(ToId), &amp;quot; &amp;quot;,
+  gv_node_id(ToId), ` `,
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
@@ -140,11 +140,11 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
-  gv_kind(Kind), &amp;quot; &amp;quot;,
+  gv_kind(Kind), ` `,
   gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
-%! gv_graph(+Gif:compound)//
+%! gv_graph(+GraphTerm:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -176,10 +176,10 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
+gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
 
-gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
+gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   {
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
@@ -194,8 +194,8 @@ gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), &amp;quot; &amp;quot;,
-  gv_id(GName), &amp;quot; &amp;quot;,
+  gv_graph_type(Directed), ` `,
+  gv_id(GName), ` `,
 
   % The body of the DOT file appears between curly braces.
   bracketed(
@@ -240,18 +240,18 @@ gv_graph0(
       (NewVTerms == [], RankedVTerms == [])
     }
   -&amp;gt;
-    &amp;quot;&amp;quot;
+    ``
   ;
     line_feed
   ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
+  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
   &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
+  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
 
   {
     findall(
@@ -281,8 +281,8 @@ gv_graph0(
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_graph_type(false) --&amp;gt; `graph`.
+gv_graph_type(true) --&amp;gt; `digraph`.
 
 
 %! gv_id(?Atom:atom)// is det.
@@ -305,9 +305,8 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 %      This requires an XML grammar!
 
 % HTML strings (variant 4).
-gv_id(Content) --&amp;gt;
-  {compound(Content)}, !,
-  gv_html_like_label, Content).
+gv_id(Atom) --&amp;gt;
+  dcg_atom_codes(gv_html_like_label, Atom), !.
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -354,19 +353,19 @@ gv_keyword(Codes):-
 % GraphViz has reserved keywords that cannot be used as identifiers.
 % GraphViz keywords are case-insensitive.
 
-gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
+gv_keyword --&amp;gt; `digraph`.
+gv_keyword --&amp;gt; `edge`.
+gv_keyword --&amp;gt; `graph`.
+gv_keyword --&amp;gt; `node`.
+gv_keyword --&amp;gt; `strict`.
+gv_keyword --&amp;gt; `subgraph`.
 
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
+gv_kind(edge) --&amp;gt; `edge`.
+gv_kind(graph) --&amp;gt; `graph`.
+gv_kind(node) --&amp;gt; `node`.
 
 
 %! gv_node_id(+NodeId:atom)// .
@@ -393,7 +392,7 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), &amp;quot; &amp;quot;,
+  gv_node_id(Id), ` `,
   gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
@@ -404,23 +403,23 @@ gv_port --&amp;gt;
   gv_port_angle,
   &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   gv_compass_pt(_).
 
 gv_port_angle --&amp;gt;
-  &amp;quot;@&amp;quot;,
+  `@`,
   gv_id(_).
 
 gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   gv_id(_).
 gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   bracketed(
     round,
     (
       gv_id(_),
-      &amp;quot;,&amp;quot;,
+      `,`,
       gv_id(_)
     )
   ).
@@ -437,7 +436,7 @@ gv_quoted_string([92,34|T]) --&amp;gt; !,
   gv_quoted_string(T).
 % Add the backslash escape character.
 gv_quoted_string([34|T]) --&amp;gt; !,
-  &amp;quot;\\\&amp;quot;&amp;quot;,
+  `\\\&amp;quot;`,
   gv_quoted_string(T).
 % All other characters are allowed without escaping.
 gv_quoted_string([H|T]) --&amp;gt;
@@ -456,7 +455,7 @@ gv_ranked_node_collection(
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
+    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
 
     &#39;*&#39;(
       gv_node_statement(NewI, GraphAttrs),
@@ -476,7 +475,7 @@ gv_ranked_node_collection(
 % This only applies to directed graphs.
 
 gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
+gv_strict(true) --&amp;gt; `strict `.
 
 
 
diff --git a/gv_html.pl b/gv_html.pl
index a308ac7..3f0b08b 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -1,223 +1,60 @@
 :- module(
   gv_html,
   [
-    gv_html_like_label//1 % +Content:compound
+    gv_html_like_label//1 % +Codes:list(code)
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
-
-Grammar taken from the GraphViz Web site:
-
-~~~{.txt}
-label 	: 	text
-	| 	table
-text 	: 	textitem
-	| 	text textitem
-textitem 	: 	string
-	| 	&amp;lt;BR/&amp;gt;
-	| 	&amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
-	| 	&amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
-	| 	&amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
-	| 	&amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
-	| 	&amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
-	| 	&amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
-	| 	&amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
-	| 	&amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
-table 	: 	[ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
-rows 	: 	row
-	| 	rows row
-	| 	rows &amp;lt;HR/&amp;gt; row
-row 	: 	&amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
-cells 	: 	cell
-	| 	cells cell
-	| 	cells &amp;lt;VR/&amp;gt; cell
-cell 	: 	&amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
-	| 	&amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
-~~~
+/** &amp;lt;module&amp;gt; GraphViz HTML
 
 @author Wouter Beek
-@see http://www.graphviz.org/content/node-shapes#html
-@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
+@version 2013/07, 2013/09, 2014/03-2014/06
 */
 
-:- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
 
 
-%! gv_html_like_label(?Content:compound)// .
-
-gv_html_like_label(Content) --&amp;gt;
-  bracketed(angular, label(Content)).
-
-
-%! cell(?Contents:compound)// .
-% Supported attributes for TD:
-% ~~~{.txt}
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
-% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLSPAN=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWSPAN=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ~~~
+%! gv_html_label(+Codes:list(code))// .
 %
-% Supported attributes for IMG:
-% ~~~{.txt}
-% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
-% SRC=&amp;quot;value&amp;quot;
-% ~~~
-
-cell(td(Contents)) --&amp;gt;
-  html_element(td, [], label(Contents)).
-cell(td(img)) --&amp;gt;
-  html_element(td, [], html_element(img)).
-
-
-%! cells(?Contents:list(compound))// .
-
-cells([H|T]) --&amp;gt;
-  cell(H),
-  cells(T).
-cells([H,vr|T]) --&amp;gt;
-  cell(H),
-  html_element(vr),
-  cells(T).
-cells([H]) --&amp;gt;
-  cell(H).
-
-
-%! label(?Content:compound)// .
-% GraphViz HTML-like label.
-
-label(Content) --&amp;gt;
-  text(Content).
-label(Content) --&amp;gt;
-  table(Content).
-
-
-%! row(?Contents:compound)// .
-
-row(tr(Contents)) --&amp;gt;
-  html_element(tr, [], cell(Contents)).
-
-
-%! rows(?Contents:list)// .
-
-rows([H|T]) --&amp;gt;
-  row(H),
-  rows.
-rows([H,hr|T]) --&amp;gt;
-  row(H),
-  html_element(hr),
-  rows(T).
-rows([H]) --&amp;gt;
-  row(H).
-
-
-%! table(?Contents:compound)// .
-% Supported attributes for TABLE:
-% ~~~{.txt}
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLBORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLUMNS=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWS=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ~~~
-%
-% Supported attributes for FONT:
-% ~~~{.txt}
-% COLOR=&amp;quot;color&amp;quot;
-% FACE=&amp;quot;fontname&amp;quot;
-% POINT-SIZE=&amp;quot;value&amp;quot;
-% ~~~
-
-table(table(Attrs,Contents)) --&amp;gt;
-  html_element(table, Attrs, rows(Contents)).
-table(table(font(Contents))) --&amp;gt;
-  html_element(font, [], html_element(table, [], rows(Contents))).
-
-
-%! text(?Contents:list)// .
-
-text(Contents) --&amp;gt;
-  &#39;+&#39;(textitem, Contents, []).
-
-
-%! textitem(?Content)// .
-% Supported attributes for BR:
-% ~~~{.txt}
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% ~~~
-
-textitem(string(String)) --&amp;gt;
-  html_string(String).
-textitem(entity(Name)) --&amp;gt;
-  html_entity(Name).
-textitem(br(Attrs)) --&amp;gt;
-  html_element(br, Attrs).
-textitem(Compound) --&amp;gt;
-  {var(Compound)}, !,
-  html_element(Name, _, text(Content)),
-  {
-    supported_html_element(Name),
-    Compound =.. [Name,Content]
-  }.
-textitem(Compound) --&amp;gt;
-  {
-    Compound =.. [Name,Content],
-    supported_html_element(Name)
-  },
-  html_element(Name, _, text(Content)).
-
-
-
-% HELPERS
-
-%! supported_html_element(+Name:atom) is semidet.
-%! supported_html_element(-Name:atom) is multi.
-
-supported_html_element(b).
-supported_html_element(font).
-supported_html_element(i).
-supported_html_element(o).
-supported_html_element(s).
-supported_html_element(sub).
-supported_html_element(sup).
-supported_html_element(u).
+% @see http://www.graphviz.org/doc/info/shapes.html#html
+
+gv_html_label --&amp;gt; gv_html_text, !.
+gv_html_label --&amp;gt; gv_html_table, !.
+gv_html_label --&amp;gt; [].
+
+gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
+
+gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
+
+gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
+gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
+
+gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row.
+
+gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
+
+gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
+gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
+
+gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
+gv_html_cells --&amp;gt; gv_html_cell.
+gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
+
+gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
+gv_html_text --&amp;gt; gv_html_textitem.
+
+gv_html_textitem --&amp;gt; html_string, !.
+gv_html_textitem --&amp;gt; html_entity, !.
+gv_html_textitem --&amp;gt; html_element(br, _), !.
+gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
+
diff --git a/plDcg b/plDcg
index e074367..be16501 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit e0743670465a92c083e6954c5cf6220222f088b6
+Subproject commit be165017993efcf781007c5d682a519fb5eaa31f
diff --git a/plHtml b/plHtml
index 8ef47e0..e3abeed 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 8ef47e09a24c637ac435abbe1d01b21237be4534
+Subproject commit e3abeed4041392013965598145806ee33081f76f
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;43&#34;&gt; 43: 正在比较变动前 61ddca2 和变动后 26f07e7 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index 5f33e5c..bde2962 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +GraphTerm:compound
+    gv_graph//1 % +Gif:compound
   ]
 ).
 
@@ -39,7 +39,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % We assume that the attribute has already been validated.
 
 gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), `=`, gv_id(Val), `;`.
+  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
 
 
 %! gv_attribute_list(
@@ -63,16 +63,16 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
 % ~~~
 
-gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
-gv_compass_pt(c) --&amp;gt; `c`.
-gv_compass_pt(e) --&amp;gt; `e`.
-gv_compass_pt(n) --&amp;gt; `n`.
-gv_compass_pt(ne) --&amp;gt; `ne`.
-gv_compass_pt(nw) --&amp;gt; `nw`.
-gv_compass_pt(s) --&amp;gt; `s`.
-gv_compass_pt(se) --&amp;gt; `se`.
-gv_compass_pt(sw) --&amp;gt; `sw`.
-gv_compass_pt(w) --&amp;gt; `w`.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
+gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
+gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
+gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
+gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
+gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
+gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
+gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
+gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
+gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 
 
 %! gv_edge_operator(+Directed:boolean)// .
@@ -83,7 +83,7 @@ gv_compass_pt(w) --&amp;gt; `w`.
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, `--`.
+gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
@@ -107,11 +107,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), ` `,
+  gv_node_id(FromId), &amp;quot; &amp;quot;,
 
-  gv_edge_operator(Directed), ` `,
+  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
 
-  gv_node_id(ToId), ` `,
+  gv_node_id(ToId), &amp;quot; &amp;quot;,
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
@@ -140,11 +140,11 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
-  gv_kind(Kind), ` `,
+  gv_kind(Kind), &amp;quot; &amp;quot;,
   gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
-%! gv_graph(+GraphTerm:compound)//
+%! gv_graph(+Gif:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -176,10 +176,10 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
+gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
 
-gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
+gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
   {
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
@@ -194,8 +194,8 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), ` `,
-  gv_id(GName), ` `,
+  gv_graph_type(Directed), &amp;quot; &amp;quot;,
+  gv_id(GName), &amp;quot; &amp;quot;,
 
   % The body of the DOT file appears between curly braces.
   bracketed(
@@ -240,18 +240,18 @@ gv_graph0(
       (NewVTerms == [], RankedVTerms == [])
     }
   -&amp;gt;
-    ``
+    &amp;quot;&amp;quot;
   ;
     line_feed
   ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
+  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
   &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
+  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   {
     findall(
@@ -281,8 +281,8 @@ gv_graph0(
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; `graph`.
-gv_graph_type(true) --&amp;gt; `digraph`.
+gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 
 
 %! gv_id(?Atom:atom)// is det.
@@ -305,8 +305,9 @@ gv_graph_type(true) --&amp;gt; `digraph`.
 %      This requires an XML grammar!
 
 % HTML strings (variant 4).
-gv_id(Atom) --&amp;gt;
-  dcg_atom_codes(gv_html_like_label, Atom), !.
+gv_id(Content) --&amp;gt;
+  {compound(Content)}, !,
+  gv_html_like_label, Content).
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -353,19 +354,19 @@ gv_keyword(Codes):-
 % GraphViz has reserved keywords that cannot be used as identifiers.
 % GraphViz keywords are case-insensitive.
 
-gv_keyword --&amp;gt; `digraph`.
-gv_keyword --&amp;gt; `edge`.
-gv_keyword --&amp;gt; `graph`.
-gv_keyword --&amp;gt; `node`.
-gv_keyword --&amp;gt; `strict`.
-gv_keyword --&amp;gt; `subgraph`.
+gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; `edge`.
-gv_kind(graph) --&amp;gt; `graph`.
-gv_kind(node) --&amp;gt; `node`.
+gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
 
 
 %! gv_node_id(+NodeId:atom)// .
@@ -392,7 +393,7 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), ` `,
+  gv_node_id(Id), &amp;quot; &amp;quot;,
   gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
@@ -403,23 +404,23 @@ gv_port --&amp;gt;
   gv_port_angle,
   &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_compass_pt(_).
 
 gv_port_angle --&amp;gt;
-  `@`,
+  &amp;quot;@&amp;quot;,
   gv_id(_).
 
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_id(_).
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   bracketed(
     round,
     (
       gv_id(_),
-      `,`,
+      &amp;quot;,&amp;quot;,
       gv_id(_)
     )
   ).
@@ -436,7 +437,7 @@ gv_quoted_string([92,34|T]) --&amp;gt; !,
   gv_quoted_string(T).
 % Add the backslash escape character.
 gv_quoted_string([34|T]) --&amp;gt; !,
-  `\\\&amp;quot;`,
+  &amp;quot;\\\&amp;quot;&amp;quot;,
   gv_quoted_string(T).
 % All other characters are allowed without escaping.
 gv_quoted_string([H|T]) --&amp;gt;
@@ -455,7 +456,7 @@ gv_ranked_node_collection(
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
+    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
 
     &#39;*&#39;(
       gv_node_statement(NewI, GraphAttrs),
@@ -475,7 +476,7 @@ gv_ranked_node_collection(
 % This only applies to directed graphs.
 
 gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; `strict `.
+gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
 
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 3f0b08b..a308ac7 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -1,60 +1,223 @@
 :- module(
   gv_html,
   [
-    gv_html_like_label//1 % +Codes:list(code)
+    gv_html_like_label//1 % +Content:compound
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz HTML
+/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
+
+Grammar taken from the GraphViz Web site:
+
+~~~{.txt}
+label 	: 	text
+	| 	table
+text 	: 	textitem
+	| 	text textitem
+textitem 	: 	string
+	| 	&amp;lt;BR/&amp;gt;
+	| 	&amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+	| 	&amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+	| 	&amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+	| 	&amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+	| 	&amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+	| 	&amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+	| 	&amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+	| 	&amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+table 	: 	[ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+rows 	: 	row
+	| 	rows row
+	| 	rows &amp;lt;HR/&amp;gt; row
+row 	: 	&amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
+cells 	: 	cell
+	| 	cells cell
+	| 	cells &amp;lt;VR/&amp;gt; cell
+cell 	: 	&amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
+	| 	&amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
+~~~
 
 @author Wouter Beek
-@version 2013/07, 2013/09, 2014/03-2014/06
+@see http://www.graphviz.org/content/node-shapes#html
+@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
+:- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
 
 
-%! gv_html_label(+Codes:list(code))// .
+%! gv_html_like_label(?Content:compound)// .
+
+gv_html_like_label(Content) --&amp;gt;
+  bracketed(angular, label(Content)).
+
+
+%! cell(?Contents:compound)// .
+% Supported attributes for TD:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
+% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLSPAN=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWSPAN=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ~~~
 %
-% @see http://www.graphviz.org/doc/info/shapes.html#html
-
-gv_html_label --&amp;gt; gv_html_text, !.
-gv_html_label --&amp;gt; gv_html_table, !.
-gv_html_label --&amp;gt; [].
-
-gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
-
-gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
-
-gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
-gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
-
-gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row.
-
-gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
-
-gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
-gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
-
-gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
-gv_html_cells --&amp;gt; gv_html_cell.
-gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
-
-gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
-gv_html_text --&amp;gt; gv_html_textitem.
-
-gv_html_textitem --&amp;gt; html_string, !.
-gv_html_textitem --&amp;gt; html_entity, !.
-gv_html_textitem --&amp;gt; html_element(br, _), !.
-gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
-
+% Supported attributes for IMG:
+% ~~~{.txt}
+% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
+% SRC=&amp;quot;value&amp;quot;
+% ~~~
+
+cell(td(Contents)) --&amp;gt;
+  html_element(td, [], label(Contents)).
+cell(td(img)) --&amp;gt;
+  html_element(td, [], html_element(img)).
+
+
+%! cells(?Contents:list(compound))// .
+
+cells([H|T]) --&amp;gt;
+  cell(H),
+  cells(T).
+cells([H,vr|T]) --&amp;gt;
+  cell(H),
+  html_element(vr),
+  cells(T).
+cells([H]) --&amp;gt;
+  cell(H).
+
+
+%! label(?Content:compound)// .
+% GraphViz HTML-like label.
+
+label(Content) --&amp;gt;
+  text(Content).
+label(Content) --&amp;gt;
+  table(Content).
+
+
+%! row(?Contents:compound)// .
+
+row(tr(Contents)) --&amp;gt;
+  html_element(tr, [], cell(Contents)).
+
+
+%! rows(?Contents:list)// .
+
+rows([H|T]) --&amp;gt;
+  row(H),
+  rows.
+rows([H,hr|T]) --&amp;gt;
+  row(H),
+  html_element(hr),
+  rows(T).
+rows([H]) --&amp;gt;
+  row(H).
+
+
+%! table(?Contents:compound)// .
+% Supported attributes for TABLE:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLBORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLUMNS=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWS=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ~~~
+%
+% Supported attributes for FONT:
+% ~~~{.txt}
+% COLOR=&amp;quot;color&amp;quot;
+% FACE=&amp;quot;fontname&amp;quot;
+% POINT-SIZE=&amp;quot;value&amp;quot;
+% ~~~
+
+table(table(Attrs,Contents)) --&amp;gt;
+  html_element(table, Attrs, rows(Contents)).
+table(table(font(Contents))) --&amp;gt;
+  html_element(font, [], html_element(table, [], rows(Contents))).
+
+
+%! text(?Contents:list)// .
+
+text(Contents) --&amp;gt;
+  &#39;+&#39;(textitem, Contents, []).
+
+
+%! textitem(?Content)// .
+% Supported attributes for BR:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% ~~~
+
+textitem(string(String)) --&amp;gt;
+  html_string(String).
+textitem(entity(Name)) --&amp;gt;
+  html_entity(Name).
+textitem(br(Attrs)) --&amp;gt;
+  html_element(br, Attrs).
+textitem(Compound) --&amp;gt;
+  {var(Compound)}, !,
+  html_element(Name, _, text(Content)),
+  {
+    supported_html_element(Name),
+    Compound =.. [Name,Content]
+  }.
+textitem(Compound) --&amp;gt;
+  {
+    Compound =.. [Name,Content],
+    supported_html_element(Name)
+  },
+  html_element(Name, _, text(Content)).
+
+
+
+% HELPERS
+
+%! supported_html_element(+Name:atom) is semidet.
+%! supported_html_element(-Name:atom) is multi.
+
+supported_html_element(b).
+supported_html_element(font).
+supported_html_element(i).
+supported_html_element(o).
+supported_html_element(s).
+supported_html_element(sub).
+supported_html_element(sup).
+supported_html_element(u).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;44&#34;&gt; 44: 正在比较变动前 26f07e7 和变动后 f78b4f8 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 727ea49..7096ef9 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 727ea49d47063b733ae499615fda6aa06c84fb6f
+Subproject commit 7096ef9749edffe389df6a90d586930c8bf4df70
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 3c7863d..67d419a 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -46,10 +46,11 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06, 2014/11
 */
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
 
@@ -97,7 +98,7 @@ gv_attr_type(viewPort).
 % An *addDouble* is represented by a Prolog float.
 
 addDouble(Float) --&amp;gt;
-  &#39;?&#39;(`+`, []),
+  &#39;?&#39;(plus_sign, []),
   double(Float).
 
 
@@ -106,7 +107,7 @@ addDouble(Float) --&amp;gt;
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
 addPoint(Point) --&amp;gt;
-  &#39;?&#39;(`+`, []),
+  &#39;?&#39;(plus_sign, []),
   point(Point).
 
 
@@ -147,10 +148,10 @@ backwards_compatible(invempty).
 backwards_compatible(open).
 
 
-bool(false) --&amp;gt; `false`.
-bool(false) --&amp;gt; `no`.
-bool(true) --&amp;gt; `true`.
-bool(true) --&amp;gt; `yes`.
+bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
+bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
+bool(true) --&amp;gt; &amp;quot;true&amp;quot;.
+bool(true) --&amp;gt; &amp;quot;yes&amp;quot;.
 
 
 %! clusterMode(+ClusterMode:atom)// .
@@ -187,7 +188,7 @@ doubleList([H|T]) --&amp;gt;
   &#39;*&#39;(doubleList1, T, []).
 
 doubleList1(Float) --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   double(Float).
 
 
@@ -242,16 +243,16 @@ pagedir(&#39;TR&#39;).
 
 %! point(+Point:compound)// .
 % A *point* is represented by a compound of the following form:
-% `point(X:float,Y:float,InputOnly:boolean)`.
+% `point(X:float,Y:float,Changeable:boolean)`.
 
-point(point(X,Y,InputOnly)) --&amp;gt;
+point(point(X,Y,Changeable)) --&amp;gt;
   float(X),
-  `,`,
+  &amp;quot;,&amp;quot;,
   float(Y),
-  input_only(InputOnly).
+  input_changeable(Changeable).
 
-input_only(false) --&amp;gt; [].
-input_only(true) --&amp;gt; `!`.
+input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
+input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
 
 
 pointList(Points) --&amp;gt;
@@ -292,9 +293,9 @@ rankdir(&#39;TB&#39;).
 
 
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), `,`,
-  float(LowerLeftY), `,`,
-  float(UpperRightX), `,`,
+  float(LowerLeftX), &amp;quot;,&amp;quot;,
+  float(LowerLeftY), &amp;quot;,&amp;quot;,
+  float(UpperRightX), &amp;quot;,&amp;quot;,
   float(UpperRightY).
 
 
@@ -414,4 +415,3 @@ style(node, wedged).
 
 
 % @tbd viewPort
-
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 1692915..df0922a 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -2,15 +2,17 @@
   gv_attrs,
   [
     gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
-              % +Attr1:nvpair
-              % +Attr2:nvpair
+              % +Attribute1:nvpair
+              % -Attribute2:nvpair
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz attributes v2
+/** &amp;lt;module&amp;gt; GraphViz: Attributes
+
+Support for GraphViz attributes.
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06, 2014/11
 */
 
 :- use_module(library(apply)).
@@ -54,24 +56,40 @@
 
 
 
+%! gv_attr(
+%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
+%!   +Attribute1:nvpair,
+%!   +Attribute2:nvpair
+%! ) is det.
+% Uses the default value in case Value is uninstantiated.
+% Otherwise, performs a typecheck and converts the given value.
+
 gv_attr(Context, N=V, N=V):-
   var(V), !,
   gv_attr(N, UsedBy, _, V, _, _),
+  % Check validity of context.
   memberchk(Context, UsedBy).
 gv_attr(Context, N=V1, N=V2):-
-  gv_attr(N, UsedBy, Types, _, Minimum, _),
+  gv_attr(N2, UsedBy, Types, _, Minimum, _),
+  % Check validity of context.
   memberchk(Context, UsedBy),
+  % Check validity of value type.
   member(Type, Types),
-  (
-    Type == style
-  -&amp;gt;
-    Dcg =.. [Type,Context,V1]
-  ;
-    Dcg =.. [Type,V1]
+  (   Type == style
+  -&amp;gt;  Dcg =.. [Type,Context,V1]
+  ;   Dcg =.. [Type,V1]
   ),
   once(dcg_phrase(Dcg, V2)),
+  % Check validity of Value w.r.t. minimum value -- if available.
   check_minimum(V1, Minimum).
 
+
+
+% HELPERS
+
+%! check_minimum(+Value:atom, +Minimum:number) is semidet.
+% Trivially succeeds if no minimum value is available for a given attribute.
+
 check_minimum(_, &#39;&#39;):- !.
 check_minimum(V, Min1):-
   atom_number(Min1, Min2),
diff --git a/plDcg b/plDcg
index be16501..2cd7321 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit be165017993efcf781007c5d682a519fb5eaa31f
+Subproject commit 2cd7321d6c8a84ca23d08670348914c4a8ca6bb0
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;45&#34;&gt; 45: 正在比较变动前 f78b4f8 和变动后 3109362 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index 7193a38..b25c15b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,4 +1 @@
 *~
-*#
-*.db
-data/*
diff --git a/.gitmodules b/.gitmodules
index 844b1bd..a63cbff 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,6 +4,3 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
-[submodule &amp;quot;plDcg&amp;quot;]
-	path = plDcg
-	url = https://github.com/wouterbeek/plDcg.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 7096ef9..b1d2484 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 7096ef9749edffe389df6a90d586930c8bf4df70
+Subproject commit b1d2484486ad4876aecc1bf70b2963b12efca341
diff --git a/debug.pl b/debug.pl
deleted file mode 100644
index 099cb84..0000000
--- a/debug.pl
+++ /dev/null
@@ -1,7 +0,0 @@
-% Loads debug tools for the plGraphViz library.
-
-:- [load].
-
-:- use_module(debug_project).
-:- debug_all_files.
-
diff --git a/debug_project.pl b/debug_project.pl
deleted file mode 100644
index ab61534..0000000
--- a/debug_project.pl
+++ /dev/null
@@ -1,67 +0,0 @@
-:- module(
-  debug_project,
-  [
-    debug_all_files/0
-  ]
-).
-
-/** &amp;lt;module&amp;gt; Debug project
-
-Generic code for debugging a project:
-  * Load all subdirectories and Prolog files contained in those directories.
-
-@author Wouter Beek
-@version 2014/10/31
-*/
-
-:- use_module(library(ansi_term)).
-:- use_module(library(apply)).
-
-:- use_module(os(dir_ext)).
-
-% Avoid errors when using gtrace/0 in threads.
-:- initialization(guitracer).
-
-
-
-debug_all_files:-
-  absolute_file_name(project(.), Dir, [access(read),file_type(directory)]),
-  directory_files(
-    Dir,
-    Files1,
-    [
-      file_types([prolog]),
-      include_directories(false),
-      include_self(false),
-      recursive(true)
-    ]
-  ),
-  exclude(do_not_load, Files1, Files2),
-  maplist(use_module0, Files2).
-use_module0(File):-
-  print_message(informational, loading_module(File)),
-  use_module(File).
-
-do_not_load(File1):-
-  file_base_name(File1, File2),
-  file_name_extension(File3, pl, File2),
-  do_not_load0(File3).
-
-do_not_load0(dcg_ascii).
-do_not_load0(dcg_unicode).
-do_not_load0(debug).
-do_not_load0(debug_project).
-do_not_load0(index).
-do_not_load0(load).
-do_not_load0(load_project).
-do_not_load0(rfc2616_basic).
-do_not_load0(run).
-
-
-
-% MESSAGES
-
-:- multifile(prolog:message//1).
-
-prolog:message(loading_module(File)) --&amp;gt;
-  [&#39;[M] &#39;,File].
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 67d419a..3c7863d 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -46,11 +46,10 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06, 2014/11
+@version 2014/06
 */
 
 :- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
 
@@ -98,7 +97,7 @@ gv_attr_type(viewPort).
 % An *addDouble* is represented by a Prolog float.
 
 addDouble(Float) --&amp;gt;
-  &#39;?&#39;(plus_sign, []),
+  &#39;?&#39;(`+`, []),
   double(Float).
 
 
@@ -107,7 +106,7 @@ addDouble(Float) --&amp;gt;
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
 addPoint(Point) --&amp;gt;
-  &#39;?&#39;(plus_sign, []),
+  &#39;?&#39;(`+`, []),
   point(Point).
 
 
@@ -148,10 +147,10 @@ backwards_compatible(invempty).
 backwards_compatible(open).
 
 
-bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
-bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
-bool(true) --&amp;gt; &amp;quot;true&amp;quot;.
-bool(true) --&amp;gt; &amp;quot;yes&amp;quot;.
+bool(false) --&amp;gt; `false`.
+bool(false) --&amp;gt; `no`.
+bool(true) --&amp;gt; `true`.
+bool(true) --&amp;gt; `yes`.
 
 
 %! clusterMode(+ClusterMode:atom)// .
@@ -188,7 +187,7 @@ doubleList([H|T]) --&amp;gt;
   &#39;*&#39;(doubleList1, T, []).
 
 doubleList1(Float) --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   double(Float).
 
 
@@ -243,16 +242,16 @@ pagedir(&#39;TR&#39;).
 
 %! point(+Point:compound)// .
 % A *point* is represented by a compound of the following form:
-% `point(X:float,Y:float,Changeable:boolean)`.
+% `point(X:float,Y:float,InputOnly:boolean)`.
 
-point(point(X,Y,Changeable)) --&amp;gt;
+point(point(X,Y,InputOnly)) --&amp;gt;
   float(X),
-  &amp;quot;,&amp;quot;,
+  `,`,
   float(Y),
-  input_changeable(Changeable).
+  input_only(InputOnly).
 
-input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
-input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
+input_only(false) --&amp;gt; [].
+input_only(true) --&amp;gt; `!`.
 
 
 pointList(Points) --&amp;gt;
@@ -293,9 +292,9 @@ rankdir(&#39;TB&#39;).
 
 
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), &amp;quot;,&amp;quot;,
-  float(LowerLeftY), &amp;quot;,&amp;quot;,
-  float(UpperRightX), &amp;quot;,&amp;quot;,
+  float(LowerLeftX), `,`,
+  float(LowerLeftY), `,`,
+  float(UpperRightX), `,`,
   float(UpperRightY).
 
 
@@ -415,3 +414,4 @@ style(node, wedged).
 
 
 % @tbd viewPort
+
diff --git a/gv_attrs.pl b/gv_attrs.pl
index df0922a..1692915 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -2,17 +2,15 @@
   gv_attrs,
   [
     gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
-              % +Attribute1:nvpair
-              % -Attribute2:nvpair
+              % +Attr1:nvpair
+              % +Attr2:nvpair
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz: Attributes
-
-Support for GraphViz attributes.
+/** &amp;lt;module&amp;gt; GraphViz attributes v2
 
 @author Wouter Beek
-@version 2014/06, 2014/11
+@version 2014/06
 */
 
 :- use_module(library(apply)).
@@ -56,40 +54,24 @@ Support for GraphViz attributes.
 
 
 
-%! gv_attr(
-%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +Attribute1:nvpair,
-%!   +Attribute2:nvpair
-%! ) is det.
-% Uses the default value in case Value is uninstantiated.
-% Otherwise, performs a typecheck and converts the given value.
-
 gv_attr(Context, N=V, N=V):-
   var(V), !,
   gv_attr(N, UsedBy, _, V, _, _),
-  % Check validity of context.
   memberchk(Context, UsedBy).
 gv_attr(Context, N=V1, N=V2):-
-  gv_attr(N2, UsedBy, Types, _, Minimum, _),
-  % Check validity of context.
+  gv_attr(N, UsedBy, Types, _, Minimum, _),
   memberchk(Context, UsedBy),
-  % Check validity of value type.
   member(Type, Types),
-  (   Type == style
-  -&amp;gt;  Dcg =.. [Type,Context,V1]
-  ;   Dcg =.. [Type,V1]
+  (
+    Type == style
+  -&amp;gt;
+    Dcg =.. [Type,Context,V1]
+  ;
+    Dcg =.. [Type,V1]
   ),
   once(dcg_phrase(Dcg, V2)),
-  % Check validity of Value w.r.t. minimum value -- if available.
   check_minimum(V1, Minimum).
 
-
-
-% HELPERS
-
-%! check_minimum(+Value:atom, +Minimum:number) is semidet.
-% Trivially succeeds if no minimum value is available for a given attribute.
-
 check_minimum(_, &#39;&#39;):- !.
 check_minimum(V, Min1):-
   atom_number(Min1, Min2),
diff --git a/gv_dot.pl b/gv_dot.pl
index bde2962..5f33e5c 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +Gif:compound
+    gv_graph//1 % +GraphTerm:compound
   ]
 ).
 
@@ -39,7 +39,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % We assume that the attribute has already been validated.
 
 gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
+  gv_id(Name), `=`, gv_id(Val), `;`.
 
 
 %! gv_attribute_list(
@@ -63,16 +63,16 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
 % ~~~
 
-gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
-gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
-gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
-gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
-gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
-gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
-gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
-gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
-gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
-gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
+gv_compass_pt(c) --&amp;gt; `c`.
+gv_compass_pt(e) --&amp;gt; `e`.
+gv_compass_pt(n) --&amp;gt; `n`.
+gv_compass_pt(ne) --&amp;gt; `ne`.
+gv_compass_pt(nw) --&amp;gt; `nw`.
+gv_compass_pt(s) --&amp;gt; `s`.
+gv_compass_pt(se) --&amp;gt; `se`.
+gv_compass_pt(sw) --&amp;gt; `sw`.
+gv_compass_pt(w) --&amp;gt; `w`.
 
 
 %! gv_edge_operator(+Directed:boolean)// .
@@ -83,7 +83,7 @@ gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
+gv_edge_operator(false) --&amp;gt; !, `--`.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
@@ -107,11 +107,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), &amp;quot; &amp;quot;,
+  gv_node_id(FromId), ` `,
 
-  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
+  gv_edge_operator(Directed), ` `,
 
-  gv_node_id(ToId), &amp;quot; &amp;quot;,
+  gv_node_id(ToId), ` `,
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
@@ -140,11 +140,11 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
-  gv_kind(Kind), &amp;quot; &amp;quot;,
+  gv_kind(Kind), ` `,
   gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
-%! gv_graph(+Gif:compound)//
+%! gv_graph(+GraphTerm:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -176,10 +176,10 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
+gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
 
-gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
+gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   {
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
@@ -194,8 +194,8 @@ gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), &amp;quot; &amp;quot;,
-  gv_id(GName), &amp;quot; &amp;quot;,
+  gv_graph_type(Directed), ` `,
+  gv_id(GName), ` `,
 
   % The body of the DOT file appears between curly braces.
   bracketed(
@@ -240,18 +240,18 @@ gv_graph0(
       (NewVTerms == [], RankedVTerms == [])
     }
   -&amp;gt;
-    &amp;quot;&amp;quot;
+    ``
   ;
     line_feed
   ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
+  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
   &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
+  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
 
   {
     findall(
@@ -281,8 +281,8 @@ gv_graph0(
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_graph_type(false) --&amp;gt; `graph`.
+gv_graph_type(true) --&amp;gt; `digraph`.
 
 
 %! gv_id(?Atom:atom)// is det.
@@ -305,9 +305,8 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 %      This requires an XML grammar!
 
 % HTML strings (variant 4).
-gv_id(Content) --&amp;gt;
-  {compound(Content)}, !,
-  gv_html_like_label, Content).
+gv_id(Atom) --&amp;gt;
+  dcg_atom_codes(gv_html_like_label, Atom), !.
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -354,19 +353,19 @@ gv_keyword(Codes):-
 % GraphViz has reserved keywords that cannot be used as identifiers.
 % GraphViz keywords are case-insensitive.
 
-gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
+gv_keyword --&amp;gt; `digraph`.
+gv_keyword --&amp;gt; `edge`.
+gv_keyword --&amp;gt; `graph`.
+gv_keyword --&amp;gt; `node`.
+gv_keyword --&amp;gt; `strict`.
+gv_keyword --&amp;gt; `subgraph`.
 
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
+gv_kind(edge) --&amp;gt; `edge`.
+gv_kind(graph) --&amp;gt; `graph`.
+gv_kind(node) --&amp;gt; `node`.
 
 
 %! gv_node_id(+NodeId:atom)// .
@@ -393,7 +392,7 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), &amp;quot; &amp;quot;,
+  gv_node_id(Id), ` `,
   gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
@@ -404,23 +403,23 @@ gv_port --&amp;gt;
   gv_port_angle,
   &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   gv_compass_pt(_).
 
 gv_port_angle --&amp;gt;
-  &amp;quot;@&amp;quot;,
+  `@`,
   gv_id(_).
 
 gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   gv_id(_).
 gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   bracketed(
     round,
     (
       gv_id(_),
-      &amp;quot;,&amp;quot;,
+      `,`,
       gv_id(_)
     )
   ).
@@ -437,7 +436,7 @@ gv_quoted_string([92,34|T]) --&amp;gt; !,
   gv_quoted_string(T).
 % Add the backslash escape character.
 gv_quoted_string([34|T]) --&amp;gt; !,
-  &amp;quot;\\\&amp;quot;&amp;quot;,
+  `\\\&amp;quot;`,
   gv_quoted_string(T).
 % All other characters are allowed without escaping.
 gv_quoted_string([H|T]) --&amp;gt;
@@ -456,7 +455,7 @@ gv_ranked_node_collection(
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
+    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
 
     &#39;*&#39;(
       gv_node_statement(NewI, GraphAttrs),
@@ -476,7 +475,7 @@ gv_ranked_node_collection(
 % This only applies to directed graphs.
 
 gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
+gv_strict(true) --&amp;gt; `strict `.
 
 
 
diff --git a/gv_file.pl b/gv_file.pl
index 00c9eb0..789bd56 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -31,7 +31,7 @@ and GraphViz output files or SVG DOM structures.
 :- use_module(library(option)).
 :- use_module(library(process)).
 
-:- use_module(generics(codes_ext)).
+:- use_module(generics(code_ext)).
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
diff --git a/gv_html.pl b/gv_html.pl
index a308ac7..3f0b08b 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -1,223 +1,60 @@
 :- module(
   gv_html,
   [
-    gv_html_like_label//1 % +Content:compound
+    gv_html_like_label//1 % +Codes:list(code)
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
-
-Grammar taken from the GraphViz Web site:
-
-~~~{.txt}
-label 	: 	text
-	| 	table
-text 	: 	textitem
-	| 	text textitem
-textitem 	: 	string
-	| 	&amp;lt;BR/&amp;gt;
-	| 	&amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
-	| 	&amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
-	| 	&amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
-	| 	&amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
-	| 	&amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
-	| 	&amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
-	| 	&amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
-	| 	&amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
-table 	: 	[ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
-rows 	: 	row
-	| 	rows row
-	| 	rows &amp;lt;HR/&amp;gt; row
-row 	: 	&amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
-cells 	: 	cell
-	| 	cells cell
-	| 	cells &amp;lt;VR/&amp;gt; cell
-cell 	: 	&amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
-	| 	&amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
-~~~
+/** &amp;lt;module&amp;gt; GraphViz HTML
 
 @author Wouter Beek
-@see http://www.graphviz.org/content/node-shapes#html
-@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
+@version 2013/07, 2013/09, 2014/03-2014/06
 */
 
-:- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
 
 
-%! gv_html_like_label(?Content:compound)// .
-
-gv_html_like_label(Content) --&amp;gt;
-  bracketed(angular, label(Content)).
-
-
-%! cell(?Contents:compound)// .
-% Supported attributes for TD:
-% ~~~{.txt}
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
-% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLSPAN=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWSPAN=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ~~~
+%! gv_html_label(+Codes:list(code))// .
 %
-% Supported attributes for IMG:
-% ~~~{.txt}
-% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
-% SRC=&amp;quot;value&amp;quot;
-% ~~~
-
-cell(td(Contents)) --&amp;gt;
-  html_element(td, [], label(Contents)).
-cell(td(img)) --&amp;gt;
-  html_element(td, [], html_element(img)).
-
-
-%! cells(?Contents:list(compound))// .
-
-cells([H|T]) --&amp;gt;
-  cell(H),
-  cells(T).
-cells([H,vr|T]) --&amp;gt;
-  cell(H),
-  html_element(vr),
-  cells(T).
-cells([H]) --&amp;gt;
-  cell(H).
-
-
-%! label(?Content:compound)// .
-% GraphViz HTML-like label.
-
-label(Content) --&amp;gt;
-  text(Content).
-label(Content) --&amp;gt;
-  table(Content).
-
-
-%! row(?Contents:compound)// .
-
-row(tr(Contents)) --&amp;gt;
-  html_element(tr, [], cell(Contents)).
-
-
-%! rows(?Contents:list)// .
-
-rows([H|T]) --&amp;gt;
-  row(H),
-  rows.
-rows([H,hr|T]) --&amp;gt;
-  row(H),
-  html_element(hr),
-  rows(T).
-rows([H]) --&amp;gt;
-  row(H).
-
-
-%! table(?Contents:compound)// .
-% Supported attributes for TABLE:
-% ~~~{.txt}
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLBORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLUMNS=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWS=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ~~~
-%
-% Supported attributes for FONT:
-% ~~~{.txt}
-% COLOR=&amp;quot;color&amp;quot;
-% FACE=&amp;quot;fontname&amp;quot;
-% POINT-SIZE=&amp;quot;value&amp;quot;
-% ~~~
-
-table(table(Attrs,Contents)) --&amp;gt;
-  html_element(table, Attrs, rows(Contents)).
-table(table(font(Contents))) --&amp;gt;
-  html_element(font, [], html_element(table, [], rows(Contents))).
-
-
-%! text(?Contents:list)// .
-
-text(Contents) --&amp;gt;
-  &#39;+&#39;(textitem, Contents, []).
-
-
-%! textitem(?Content)// .
-% Supported attributes for BR:
-% ~~~{.txt}
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% ~~~
-
-textitem(string(String)) --&amp;gt;
-  html_string(String).
-textitem(entity(Name)) --&amp;gt;
-  html_entity(Name).
-textitem(br(Attrs)) --&amp;gt;
-  html_element(br, Attrs).
-textitem(Compound) --&amp;gt;
-  {var(Compound)}, !,
-  html_element(Name, _, text(Content)),
-  {
-    supported_html_element(Name),
-    Compound =.. [Name,Content]
-  }.
-textitem(Compound) --&amp;gt;
-  {
-    Compound =.. [Name,Content],
-    supported_html_element(Name)
-  },
-  html_element(Name, _, text(Content)).
-
-
-
-% HELPERS
-
-%! supported_html_element(+Name:atom) is semidet.
-%! supported_html_element(-Name:atom) is multi.
-
-supported_html_element(b).
-supported_html_element(font).
-supported_html_element(i).
-supported_html_element(o).
-supported_html_element(s).
-supported_html_element(sub).
-supported_html_element(sup).
-supported_html_element(u).
+% @see http://www.graphviz.org/doc/info/shapes.html#html
+
+gv_html_label --&amp;gt; gv_html_text, !.
+gv_html_label --&amp;gt; gv_html_table, !.
+gv_html_label --&amp;gt; [].
+
+gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
+
+gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
+
+gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
+gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
+
+gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row.
+
+gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
+
+gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
+gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
+
+gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
+gv_html_cells --&amp;gt; gv_html_cell.
+gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
+
+gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
+gv_html_text --&amp;gt; gv_html_textitem.
+
+gv_html_textitem --&amp;gt; html_string, !.
+gv_html_textitem --&amp;gt; html_entity, !.
+gv_html_textitem --&amp;gt; html_element(br, _), !.
+gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
+
diff --git a/load.pl b/load.pl
index 1681cd0..4b117d1 100644
--- a/load.pl
+++ b/load.pl
@@ -1,13 +1,12 @@
-% Load file for the plGraphViz library.
+% Load file for plGraphViz.
 
-:- dynamic(user:project/3).
-:- multifile(user:project/3).
-   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;).
+:- dynamic(user:prolog/3).
+:- multifile(user:prolog/3).
+   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
 
 :- use_module(load_project).
-:- load_project([
+:- load_project(plGraphViz, [
     plc-&#39;Prolog-Library-Collection&#39;,
-    plDcg,
     plHtml
 ]).
 
diff --git a/load_project.pl b/load_project.pl
index e2196b7..5599b5e 100644
--- a/load_project.pl
+++ b/load_project.pl
@@ -1,7 +1,8 @@
 :- module(
   load_project,
   [
-    load_project/1, % +ChildProjects:list(or([atom,pair(atom)]))
+    load_project/2, % +Parent:atom
+                    % +ChildProjects:list(or([atom,pair(atom)]))
     load_subproject/2, % +ParentFileSearchPath:atom
                        % +Child:or([atom,pair(atom)])
     set_data_subdirectory/1 % +ParentDirectory:atom
@@ -16,7 +17,7 @@ Generic code for loading a project:
   * Load the index of subprojects onto the file search path.
 
 @author Wouter Beek
-@version 2014/08/20
+@version 2014/06/14
 */
 
 :- use_module(library(ansi_term)). % Colorized terminal messages.
@@ -29,11 +30,11 @@ Generic code for loading a project:
 
 
 
-load_project(ChildProjects):-
-  parent_alias(ParentFsp),
+load_project(Parent, ChildProjects):-
+  parent_alias(Parent, ParentFsp),
 
   % Entry point.
-  source_file(load_project(_), ThisFile),
+  source_file(load_project(_,_), ThisFile),
   file_directory_name(ThisFile, ThisDir),
   assert(user:file_search_path(ParentFsp, ThisDir)),
   assert(user:file_search_path(project, ThisDir)),
@@ -91,12 +92,11 @@ load_project_index(Fsp):-
 load_project_index(_).
 
 
-%! parent_alias(-ParentFsp:atom) is det.
+%! parent_alias(+Parent:atom, -ParentFsp:atom) is det.
 
-parent_alias(ParentFsp):-
-  user:project(_, _, ParentFsp), !.
-parent_alias(ParentFsp):-
-  user:project(ParentFsp, _).
+parent_alias(Parent, ParentFsp):-
+  user:project(Parent, _, ParentFsp), !.
+parent_alias(Parent, Parent).
 
 
 %! set_data_subdirectory(+ParentDirectory:atom) is det.
@@ -108,8 +108,6 @@ set_data_subdirectory(ParentDir):-
 
 
 
-% Messages
-
 :- multifile(prolog:message//1).
 
 prolog:message(missing_subproject_directory(ChildFsp,ChildDir)) --&amp;gt;
diff --git a/plDcg b/plDcg
deleted file mode 160000
index 2cd7321..0000000
--- a/plDcg
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 2cd7321d6c8a84ca23d08670348914c4a8ca6bb0
diff --git a/plHtml b/plHtml
index e3abeed..24fff7b 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit e3abeed4041392013965598145806ee33081f76f
+Subproject commit 24fff7bcf90b6bc4fbf317d504be899dc1b869cb
diff --git a/run.pl b/run.pl
deleted file mode 100644
index 8bba736..0000000
--- a/run.pl
+++ /dev/null
@@ -1,9 +0,0 @@
-% Standalone execution of the plGraphViz library.
-
-:- if(current_prolog_flag(argv, [&#39;--debug&#39;|_])).
-  :- ensure_loaded(debug).
-:- else.
-  :- set_prolog_flag(verbose, silent).
-  :- ensure_loaded(load).
-:- endif.
-
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;46&#34;&gt; 46: 正在比较变动前 3109362 和变动后 df0ab09 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index b25c15b..7193a38 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1 +1,4 @@
 *~
+*#
+*.db
+data/*
diff --git a/.gitmodules b/.gitmodules
index a63cbff..844b1bd 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,3 +4,6 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
+[submodule &amp;quot;plDcg&amp;quot;]
+	path = plDcg
+	url = https://github.com/wouterbeek/plDcg.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index b1d2484..7096ef9 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit b1d2484486ad4876aecc1bf70b2963b12efca341
+Subproject commit 7096ef9749edffe389df6a90d586930c8bf4df70
diff --git a/debug.pl b/debug.pl
new file mode 100644
index 0000000..099cb84
--- /dev/null
+++ b/debug.pl
@@ -0,0 +1,7 @@
+% Loads debug tools for the plGraphViz library.
+
+:- [load].
+
+:- use_module(debug_project).
+:- debug_all_files.
+
diff --git a/debug_project.pl b/debug_project.pl
new file mode 100644
index 0000000..ab61534
--- /dev/null
+++ b/debug_project.pl
@@ -0,0 +1,67 @@
+:- module(
+  debug_project,
+  [
+    debug_all_files/0
+  ]
+).
+
+/** &amp;lt;module&amp;gt; Debug project
+
+Generic code for debugging a project:
+  * Load all subdirectories and Prolog files contained in those directories.
+
+@author Wouter Beek
+@version 2014/10/31
+*/
+
+:- use_module(library(ansi_term)).
+:- use_module(library(apply)).
+
+:- use_module(os(dir_ext)).
+
+% Avoid errors when using gtrace/0 in threads.
+:- initialization(guitracer).
+
+
+
+debug_all_files:-
+  absolute_file_name(project(.), Dir, [access(read),file_type(directory)]),
+  directory_files(
+    Dir,
+    Files1,
+    [
+      file_types([prolog]),
+      include_directories(false),
+      include_self(false),
+      recursive(true)
+    ]
+  ),
+  exclude(do_not_load, Files1, Files2),
+  maplist(use_module0, Files2).
+use_module0(File):-
+  print_message(informational, loading_module(File)),
+  use_module(File).
+
+do_not_load(File1):-
+  file_base_name(File1, File2),
+  file_name_extension(File3, pl, File2),
+  do_not_load0(File3).
+
+do_not_load0(dcg_ascii).
+do_not_load0(dcg_unicode).
+do_not_load0(debug).
+do_not_load0(debug_project).
+do_not_load0(index).
+do_not_load0(load).
+do_not_load0(load_project).
+do_not_load0(rfc2616_basic).
+do_not_load0(run).
+
+
+
+% MESSAGES
+
+:- multifile(prolog:message//1).
+
+prolog:message(loading_module(File)) --&amp;gt;
+  [&#39;[M] &#39;,File].
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 3c7863d..67d419a 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -46,10 +46,11 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06, 2014/11
 */
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
 
@@ -97,7 +98,7 @@ gv_attr_type(viewPort).
 % An *addDouble* is represented by a Prolog float.
 
 addDouble(Float) --&amp;gt;
-  &#39;?&#39;(`+`, []),
+  &#39;?&#39;(plus_sign, []),
   double(Float).
 
 
@@ -106,7 +107,7 @@ addDouble(Float) --&amp;gt;
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
 addPoint(Point) --&amp;gt;
-  &#39;?&#39;(`+`, []),
+  &#39;?&#39;(plus_sign, []),
   point(Point).
 
 
@@ -147,10 +148,10 @@ backwards_compatible(invempty).
 backwards_compatible(open).
 
 
-bool(false) --&amp;gt; `false`.
-bool(false) --&amp;gt; `no`.
-bool(true) --&amp;gt; `true`.
-bool(true) --&amp;gt; `yes`.
+bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
+bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
+bool(true) --&amp;gt; &amp;quot;true&amp;quot;.
+bool(true) --&amp;gt; &amp;quot;yes&amp;quot;.
 
 
 %! clusterMode(+ClusterMode:atom)// .
@@ -187,7 +188,7 @@ doubleList([H|T]) --&amp;gt;
   &#39;*&#39;(doubleList1, T, []).
 
 doubleList1(Float) --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   double(Float).
 
 
@@ -242,16 +243,16 @@ pagedir(&#39;TR&#39;).
 
 %! point(+Point:compound)// .
 % A *point* is represented by a compound of the following form:
-% `point(X:float,Y:float,InputOnly:boolean)`.
+% `point(X:float,Y:float,Changeable:boolean)`.
 
-point(point(X,Y,InputOnly)) --&amp;gt;
+point(point(X,Y,Changeable)) --&amp;gt;
   float(X),
-  `,`,
+  &amp;quot;,&amp;quot;,
   float(Y),
-  input_only(InputOnly).
+  input_changeable(Changeable).
 
-input_only(false) --&amp;gt; [].
-input_only(true) --&amp;gt; `!`.
+input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
+input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
 
 
 pointList(Points) --&amp;gt;
@@ -292,9 +293,9 @@ rankdir(&#39;TB&#39;).
 
 
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), `,`,
-  float(LowerLeftY), `,`,
-  float(UpperRightX), `,`,
+  float(LowerLeftX), &amp;quot;,&amp;quot;,
+  float(LowerLeftY), &amp;quot;,&amp;quot;,
+  float(UpperRightX), &amp;quot;,&amp;quot;,
   float(UpperRightY).
 
 
@@ -414,4 +415,3 @@ style(node, wedged).
 
 
 % @tbd viewPort
-
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 1692915..df0922a 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -2,15 +2,17 @@
   gv_attrs,
   [
     gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
-              % +Attr1:nvpair
-              % +Attr2:nvpair
+              % +Attribute1:nvpair
+              % -Attribute2:nvpair
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz attributes v2
+/** &amp;lt;module&amp;gt; GraphViz: Attributes
+
+Support for GraphViz attributes.
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06, 2014/11
 */
 
 :- use_module(library(apply)).
@@ -54,24 +56,40 @@
 
 
 
+%! gv_attr(
+%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
+%!   +Attribute1:nvpair,
+%!   +Attribute2:nvpair
+%! ) is det.
+% Uses the default value in case Value is uninstantiated.
+% Otherwise, performs a typecheck and converts the given value.
+
 gv_attr(Context, N=V, N=V):-
   var(V), !,
   gv_attr(N, UsedBy, _, V, _, _),
+  % Check validity of context.
   memberchk(Context, UsedBy).
 gv_attr(Context, N=V1, N=V2):-
-  gv_attr(N, UsedBy, Types, _, Minimum, _),
+  gv_attr(N2, UsedBy, Types, _, Minimum, _),
+  % Check validity of context.
   memberchk(Context, UsedBy),
+  % Check validity of value type.
   member(Type, Types),
-  (
-    Type == style
-  -&amp;gt;
-    Dcg =.. [Type,Context,V1]
-  ;
-    Dcg =.. [Type,V1]
+  (   Type == style
+  -&amp;gt;  Dcg =.. [Type,Context,V1]
+  ;   Dcg =.. [Type,V1]
   ),
   once(dcg_phrase(Dcg, V2)),
+  % Check validity of Value w.r.t. minimum value -- if available.
   check_minimum(V1, Minimum).
 
+
+
+% HELPERS
+
+%! check_minimum(+Value:atom, +Minimum:number) is semidet.
+% Trivially succeeds if no minimum value is available for a given attribute.
+
 check_minimum(_, &#39;&#39;):- !.
 check_minimum(V, Min1):-
   atom_number(Min1, Min2),
diff --git a/gv_dot.pl b/gv_dot.pl
index 5f33e5c..bde2962 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +GraphTerm:compound
+    gv_graph//1 % +Gif:compound
   ]
 ).
 
@@ -39,7 +39,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % We assume that the attribute has already been validated.
 
 gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), `=`, gv_id(Val), `;`.
+  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
 
 
 %! gv_attribute_list(
@@ -63,16 +63,16 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
 % ~~~
 
-gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
-gv_compass_pt(c) --&amp;gt; `c`.
-gv_compass_pt(e) --&amp;gt; `e`.
-gv_compass_pt(n) --&amp;gt; `n`.
-gv_compass_pt(ne) --&amp;gt; `ne`.
-gv_compass_pt(nw) --&amp;gt; `nw`.
-gv_compass_pt(s) --&amp;gt; `s`.
-gv_compass_pt(se) --&amp;gt; `se`.
-gv_compass_pt(sw) --&amp;gt; `sw`.
-gv_compass_pt(w) --&amp;gt; `w`.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
+gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
+gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
+gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
+gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
+gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
+gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
+gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
+gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
+gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 
 
 %! gv_edge_operator(+Directed:boolean)// .
@@ -83,7 +83,7 @@ gv_compass_pt(w) --&amp;gt; `w`.
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, `--`.
+gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
@@ -107,11 +107,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), ` `,
+  gv_node_id(FromId), &amp;quot; &amp;quot;,
 
-  gv_edge_operator(Directed), ` `,
+  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
 
-  gv_node_id(ToId), ` `,
+  gv_node_id(ToId), &amp;quot; &amp;quot;,
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
@@ -140,11 +140,11 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
-  gv_kind(Kind), ` `,
+  gv_kind(Kind), &amp;quot; &amp;quot;,
   gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
-%! gv_graph(+GraphTerm:compound)//
+%! gv_graph(+Gif:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -176,10 +176,10 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
+gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
 
-gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
+gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
   {
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
@@ -194,8 +194,8 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), ` `,
-  gv_id(GName), ` `,
+  gv_graph_type(Directed), &amp;quot; &amp;quot;,
+  gv_id(GName), &amp;quot; &amp;quot;,
 
   % The body of the DOT file appears between curly braces.
   bracketed(
@@ -240,18 +240,18 @@ gv_graph0(
       (NewVTerms == [], RankedVTerms == [])
     }
   -&amp;gt;
-    ``
+    &amp;quot;&amp;quot;
   ;
     line_feed
   ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
+  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
   &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
+  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   {
     findall(
@@ -281,8 +281,8 @@ gv_graph0(
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; `graph`.
-gv_graph_type(true) --&amp;gt; `digraph`.
+gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 
 
 %! gv_id(?Atom:atom)// is det.
@@ -305,8 +305,9 @@ gv_graph_type(true) --&amp;gt; `digraph`.
 %      This requires an XML grammar!
 
 % HTML strings (variant 4).
-gv_id(Atom) --&amp;gt;
-  dcg_atom_codes(gv_html_like_label, Atom), !.
+gv_id(Content) --&amp;gt;
+  {compound(Content)}, !,
+  gv_html_like_label, Content).
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -353,19 +354,19 @@ gv_keyword(Codes):-
 % GraphViz has reserved keywords that cannot be used as identifiers.
 % GraphViz keywords are case-insensitive.
 
-gv_keyword --&amp;gt; `digraph`.
-gv_keyword --&amp;gt; `edge`.
-gv_keyword --&amp;gt; `graph`.
-gv_keyword --&amp;gt; `node`.
-gv_keyword --&amp;gt; `strict`.
-gv_keyword --&amp;gt; `subgraph`.
+gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; `edge`.
-gv_kind(graph) --&amp;gt; `graph`.
-gv_kind(node) --&amp;gt; `node`.
+gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
 
 
 %! gv_node_id(+NodeId:atom)// .
@@ -392,7 +393,7 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), ` `,
+  gv_node_id(Id), &amp;quot; &amp;quot;,
   gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
@@ -403,23 +404,23 @@ gv_port --&amp;gt;
   gv_port_angle,
   &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_compass_pt(_).
 
 gv_port_angle --&amp;gt;
-  `@`,
+  &amp;quot;@&amp;quot;,
   gv_id(_).
 
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_id(_).
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   bracketed(
     round,
     (
       gv_id(_),
-      `,`,
+      &amp;quot;,&amp;quot;,
       gv_id(_)
     )
   ).
@@ -436,7 +437,7 @@ gv_quoted_string([92,34|T]) --&amp;gt; !,
   gv_quoted_string(T).
 % Add the backslash escape character.
 gv_quoted_string([34|T]) --&amp;gt; !,
-  `\\\&amp;quot;`,
+  &amp;quot;\\\&amp;quot;&amp;quot;,
   gv_quoted_string(T).
 % All other characters are allowed without escaping.
 gv_quoted_string([H|T]) --&amp;gt;
@@ -455,7 +456,7 @@ gv_ranked_node_collection(
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
+    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
 
     &#39;*&#39;(
       gv_node_statement(NewI, GraphAttrs),
@@ -475,7 +476,7 @@ gv_ranked_node_collection(
 % This only applies to directed graphs.
 
 gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; `strict `.
+gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
 
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 3f0b08b..a308ac7 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -1,60 +1,223 @@
 :- module(
   gv_html,
   [
-    gv_html_like_label//1 % +Codes:list(code)
+    gv_html_like_label//1 % +Content:compound
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz HTML
+/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
+
+Grammar taken from the GraphViz Web site:
+
+~~~{.txt}
+label 	: 	text
+	| 	table
+text 	: 	textitem
+	| 	text textitem
+textitem 	: 	string
+	| 	&amp;lt;BR/&amp;gt;
+	| 	&amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+	| 	&amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+	| 	&amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+	| 	&amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+	| 	&amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+	| 	&amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+	| 	&amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+	| 	&amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+table 	: 	[ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+rows 	: 	row
+	| 	rows row
+	| 	rows &amp;lt;HR/&amp;gt; row
+row 	: 	&amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
+cells 	: 	cell
+	| 	cells cell
+	| 	cells &amp;lt;VR/&amp;gt; cell
+cell 	: 	&amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
+	| 	&amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
+~~~
 
 @author Wouter Beek
-@version 2013/07, 2013/09, 2014/03-2014/06
+@see http://www.graphviz.org/content/node-shapes#html
+@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
+:- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
 
 
-%! gv_html_label(+Codes:list(code))// .
+%! gv_html_like_label(?Content:compound)// .
+
+gv_html_like_label(Content) --&amp;gt;
+  bracketed(angular, label(Content)).
+
+
+%! cell(?Contents:compound)// .
+% Supported attributes for TD:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
+% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLSPAN=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWSPAN=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ~~~
 %
-% @see http://www.graphviz.org/doc/info/shapes.html#html
-
-gv_html_label --&amp;gt; gv_html_text, !.
-gv_html_label --&amp;gt; gv_html_table, !.
-gv_html_label --&amp;gt; [].
-
-gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
-
-gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
-
-gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
-gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
-
-gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row.
-
-gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
-
-gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
-gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
-
-gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
-gv_html_cells --&amp;gt; gv_html_cell.
-gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
-
-gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
-gv_html_text --&amp;gt; gv_html_textitem.
-
-gv_html_textitem --&amp;gt; html_string, !.
-gv_html_textitem --&amp;gt; html_entity, !.
-gv_html_textitem --&amp;gt; html_element(br, _), !.
-gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
-
+% Supported attributes for IMG:
+% ~~~{.txt}
+% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
+% SRC=&amp;quot;value&amp;quot;
+% ~~~
+
+cell(td(Contents)) --&amp;gt;
+  html_element(td, [], label(Contents)).
+cell(td(img)) --&amp;gt;
+  html_element(td, [], html_element(img)).
+
+
+%! cells(?Contents:list(compound))// .
+
+cells([H|T]) --&amp;gt;
+  cell(H),
+  cells(T).
+cells([H,vr|T]) --&amp;gt;
+  cell(H),
+  html_element(vr),
+  cells(T).
+cells([H]) --&amp;gt;
+  cell(H).
+
+
+%! label(?Content:compound)// .
+% GraphViz HTML-like label.
+
+label(Content) --&amp;gt;
+  text(Content).
+label(Content) --&amp;gt;
+  table(Content).
+
+
+%! row(?Contents:compound)// .
+
+row(tr(Contents)) --&amp;gt;
+  html_element(tr, [], cell(Contents)).
+
+
+%! rows(?Contents:list)// .
+
+rows([H|T]) --&amp;gt;
+  row(H),
+  rows.
+rows([H,hr|T]) --&amp;gt;
+  row(H),
+  html_element(hr),
+  rows(T).
+rows([H]) --&amp;gt;
+  row(H).
+
+
+%! table(?Contents:compound)// .
+% Supported attributes for TABLE:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLBORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLUMNS=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWS=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ~~~
+%
+% Supported attributes for FONT:
+% ~~~{.txt}
+% COLOR=&amp;quot;color&amp;quot;
+% FACE=&amp;quot;fontname&amp;quot;
+% POINT-SIZE=&amp;quot;value&amp;quot;
+% ~~~
+
+table(table(Attrs,Contents)) --&amp;gt;
+  html_element(table, Attrs, rows(Contents)).
+table(table(font(Contents))) --&amp;gt;
+  html_element(font, [], html_element(table, [], rows(Contents))).
+
+
+%! text(?Contents:list)// .
+
+text(Contents) --&amp;gt;
+  &#39;+&#39;(textitem, Contents, []).
+
+
+%! textitem(?Content)// .
+% Supported attributes for BR:
+% ~~~{.txt}
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% ~~~
+
+textitem(string(String)) --&amp;gt;
+  html_string(String).
+textitem(entity(Name)) --&amp;gt;
+  html_entity(Name).
+textitem(br(Attrs)) --&amp;gt;
+  html_element(br, Attrs).
+textitem(Compound) --&amp;gt;
+  {var(Compound)}, !,
+  html_element(Name, _, text(Content)),
+  {
+    supported_html_element(Name),
+    Compound =.. [Name,Content]
+  }.
+textitem(Compound) --&amp;gt;
+  {
+    Compound =.. [Name,Content],
+    supported_html_element(Name)
+  },
+  html_element(Name, _, text(Content)).
+
+
+
+% HELPERS
+
+%! supported_html_element(+Name:atom) is semidet.
+%! supported_html_element(-Name:atom) is multi.
+
+supported_html_element(b).
+supported_html_element(font).
+supported_html_element(i).
+supported_html_element(o).
+supported_html_element(s).
+supported_html_element(sub).
+supported_html_element(sup).
+supported_html_element(u).
diff --git a/load.pl b/load.pl
index 4b117d1..1681cd0 100644
--- a/load.pl
+++ b/load.pl
@@ -1,12 +1,13 @@
-% Load file for plGraphViz.
+% Load file for the plGraphViz library.
 
-:- dynamic(user:prolog/3).
-:- multifile(user:prolog/3).
-   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
+:- dynamic(user:project/3).
+:- multifile(user:project/3).
+   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;).
 
 :- use_module(load_project).
-:- load_project(plGraphViz, [
+:- load_project([
     plc-&#39;Prolog-Library-Collection&#39;,
+    plDcg,
     plHtml
 ]).
 
diff --git a/load_project.pl b/load_project.pl
index 5599b5e..e2196b7 100644
--- a/load_project.pl
+++ b/load_project.pl
@@ -1,8 +1,7 @@
 :- module(
   load_project,
   [
-    load_project/2, % +Parent:atom
-                    % +ChildProjects:list(or([atom,pair(atom)]))
+    load_project/1, % +ChildProjects:list(or([atom,pair(atom)]))
     load_subproject/2, % +ParentFileSearchPath:atom
                        % +Child:or([atom,pair(atom)])
     set_data_subdirectory/1 % +ParentDirectory:atom
@@ -17,7 +16,7 @@ Generic code for loading a project:
   * Load the index of subprojects onto the file search path.
 
 @author Wouter Beek
-@version 2014/06/14
+@version 2014/08/20
 */
 
 :- use_module(library(ansi_term)). % Colorized terminal messages.
@@ -30,11 +29,11 @@ Generic code for loading a project:
 
 
 
-load_project(Parent, ChildProjects):-
-  parent_alias(Parent, ParentFsp),
+load_project(ChildProjects):-
+  parent_alias(ParentFsp),
 
   % Entry point.
-  source_file(load_project(_,_), ThisFile),
+  source_file(load_project(_), ThisFile),
   file_directory_name(ThisFile, ThisDir),
   assert(user:file_search_path(ParentFsp, ThisDir)),
   assert(user:file_search_path(project, ThisDir)),
@@ -92,11 +91,12 @@ load_project_index(Fsp):-
 load_project_index(_).
 
 
-%! parent_alias(+Parent:atom, -ParentFsp:atom) is det.
+%! parent_alias(-ParentFsp:atom) is det.
 
-parent_alias(Parent, ParentFsp):-
-  user:project(Parent, _, ParentFsp), !.
-parent_alias(Parent, Parent).
+parent_alias(ParentFsp):-
+  user:project(_, _, ParentFsp), !.
+parent_alias(ParentFsp):-
+  user:project(ParentFsp, _).
 
 
 %! set_data_subdirectory(+ParentDirectory:atom) is det.
@@ -108,6 +108,8 @@ set_data_subdirectory(ParentDir):-
 
 
 
+% Messages
+
 :- multifile(prolog:message//1).
 
 prolog:message(missing_subproject_directory(ChildFsp,ChildDir)) --&amp;gt;
diff --git a/plDcg b/plDcg
new file mode 160000
index 0000000..2cd7321
--- /dev/null
+++ b/plDcg
@@ -0,0 +1 @@
+Subproject commit 2cd7321d6c8a84ca23d08670348914c4a8ca6bb0
diff --git a/plHtml b/plHtml
index 24fff7b..e3abeed 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 24fff7bcf90b6bc4fbf317d504be899dc1b869cb
+Subproject commit e3abeed4041392013965598145806ee33081f76f
diff --git a/run.pl b/run.pl
new file mode 100644
index 0000000..8bba736
--- /dev/null
+++ b/run.pl
@@ -0,0 +1,9 @@
+% Standalone execution of the plGraphViz library.
+
+:- if(current_prolog_flag(argv, [&#39;--debug&#39;|_])).
+  :- ensure_loaded(debug).
+:- else.
+  :- set_prolog_flag(verbose, silent).
+  :- ensure_loaded(load).
+:- endif.
+
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;47&#34;&gt; 47: 正在比较变动前 df0ab09 和变动后 73e976b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
index 844b1bd..ba7e7a9 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -7,3 +7,12 @@
 [submodule &amp;quot;plDcg&amp;quot;]
 	path = plDcg
 	url = https://github.com/wouterbeek/plDcg.git
+[submodule &amp;quot;plSvg&amp;quot;]
+	path = plSvg
+	url = https://github.com/wouterbeek/plSvg.git
+[submodule &amp;quot;plHttp&amp;quot;]
+	path = plHttp
+	url = https://github.com/wouterbeek/plHttp.git
+[submodule &amp;quot;plUri&amp;quot;]
+	path = plUri
+	url = https://github.com/wouterbeek/plUri.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 7096ef9..130d471 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 7096ef9749edffe389df6a90d586930c8bf4df70
+Subproject commit 130d471fdafe35858114ff8f9cde3acf66380d99
diff --git a/gv_attrs.pl b/gv_attrs.pl
index df0922a..f0c1c5d 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -21,6 +21,7 @@ Support for GraphViz attributes.
 
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
+:- use_module(os(file_gnu)).
 
 :- use_module(plDcg(dcg_content)).
 :- use_module(plDcg(dcg_generics)).
diff --git a/gv_color.pl b/gv_color.pl
index c5fccd4..4176444 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -17,12 +17,13 @@
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists)).
+:- use_module(library(lists), except([delete/3])).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
+:- use_module(os(file_gnu)).
 
 :- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_cardinal)).
diff --git a/gv_dot.pl b/gv_dot.pl
index bde2962..0cdc571 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -19,7 +19,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists)).
+:- use_module(library(lists), except([delete/3])).
 :- use_module(library(ordsets)).
 
 :- use_module(plDcg(dcg_abnf)).
diff --git a/load.pl b/load.pl
index 1681cd0..67dfe22 100644
--- a/load.pl
+++ b/load.pl
@@ -1,13 +1,16 @@
 % Load file for the plGraphViz library.
 
-:- dynamic(user:project/3).
-:- multifile(user:project/3).
+:- dynamic(user:project/2).
+:- multifile(user:project/2).
    user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;).
 
 :- use_module(load_project).
 :- load_project([
     plc-&#39;Prolog-Library-Collection&#39;,
     plDcg,
-    plHtml
+    plHtml,
+    plHttp,
+    plSvg,
+    plUri
 ]).
 
diff --git a/plDcg b/plDcg
index 2cd7321..3689d78 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit 2cd7321d6c8a84ca23d08670348914c4a8ca6bb0
+Subproject commit 3689d7838cef5ed6e8156e3c8ec39eb7b5f25b78
diff --git a/plHtml b/plHtml
index e3abeed..27b7b71 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit e3abeed4041392013965598145806ee33081f76f
+Subproject commit 27b7b715694daabdce26c56beb799e8d949a3ff5
diff --git a/plHttp b/plHttp
new file mode 160000
index 0000000..933ba4d
--- /dev/null
+++ b/plHttp
@@ -0,0 +1 @@
+Subproject commit 933ba4d4c906128258ef192ede6003a101b81590
diff --git a/plSvg b/plSvg
new file mode 160000
index 0000000..07ba12c
--- /dev/null
+++ b/plSvg
@@ -0,0 +1 @@
+Subproject commit 07ba12c2c373fa41e1580b8c90ee17036680fce8
diff --git a/plUri b/plUri
new file mode 160000
index 0000000..cf5d6e3
--- /dev/null
+++ b/plUri
@@ -0,0 +1 @@
+Subproject commit cf5d6e365ed7bfad0369691554c9895441ae334d
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;48&#34;&gt; 48: 正在比较变动前 73e976b 和变动后 090c25d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 130d471..1630ca0 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 130d471fdafe35858114ff8f9cde3acf66380d99
+Subproject commit 1630ca0c9622cbe3f9561de21d5e851baa333ca9
diff --git a/plDcg b/plDcg
index 3689d78..df62444 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit 3689d7838cef5ed6e8156e3c8ec39eb7b5f25b78
+Subproject commit df62444ffa0b58de4c7faf9b5630e58a18ee18ec
diff --git a/plHtml b/plHtml
index 27b7b71..429b725 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 27b7b715694daabdce26c56beb799e8d949a3ff5
+Subproject commit 429b7256680588790310c3b6acf81da31d3fc3d2
diff --git a/plHttp b/plHttp
index 933ba4d..faa8215 160000
--- a/plHttp
+++ b/plHttp
@@ -1 +1 @@
-Subproject commit 933ba4d4c906128258ef192ede6003a101b81590
+Subproject commit faa821576b6ab706060f6e8eab2a8a9210b8c842
diff --git a/plUri b/plUri
index cf5d6e3..68dba15 160000
--- a/plUri
+++ b/plUri
@@ -1 +1 @@
-Subproject commit cf5d6e365ed7bfad0369691554c9895441ae334d
+Subproject commit 68dba15c5cf7bb309165d2c9439c02bd22cfba95
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;49&#34;&gt; 49: 正在比较变动前 090c25d 和变动后 daed8bf &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
index ba7e7a9..844b1bd 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -7,12 +7,3 @@
 [submodule &amp;quot;plDcg&amp;quot;]
 	path = plDcg
 	url = https://github.com/wouterbeek/plDcg.git
-[submodule &amp;quot;plSvg&amp;quot;]
-	path = plSvg
-	url = https://github.com/wouterbeek/plSvg.git
-[submodule &amp;quot;plHttp&amp;quot;]
-	path = plHttp
-	url = https://github.com/wouterbeek/plHttp.git
-[submodule &amp;quot;plUri&amp;quot;]
-	path = plUri
-	url = https://github.com/wouterbeek/plUri.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 1630ca0..18fe981 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 1630ca0c9622cbe3f9561de21d5e851baa333ca9
+Subproject commit 18fe981c492d67be3670406e51602c23b97a6052
diff --git a/load_project.pl b/load_project.pl
index e2196b7..3f0ebef 100644
--- a/load_project.pl
+++ b/load_project.pl
@@ -16,11 +16,12 @@ Generic code for loading a project:
   * Load the index of subprojects onto the file search path.
 
 @author Wouter Beek
-@version 2014/08/20
+@version 2014/11/10
 */
 
 :- use_module(library(ansi_term)). % Colorized terminal messages.
 :- use_module(library(apply)).
+:- use_module(library(pldoc)).
 
 :- dynamic(user:project/2).
 :- multifile(user:project/2).
@@ -30,6 +31,8 @@ Generic code for loading a project:
 
 
 load_project(ChildProjects):-
+  doc_server(9999),
+  
   parent_alias(ParentFsp),
 
   % Entry point.
diff --git a/plDcg b/plDcg
index df62444..19020db 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit df62444ffa0b58de4c7faf9b5630e58a18ee18ec
+Subproject commit 19020db8046bf96d54938e6ba02d65dc2b6f8b50
diff --git a/plHtml b/plHtml
index 429b725..2d6bb5a 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 429b7256680588790310c3b6acf81da31d3fc3d2
+Subproject commit 2d6bb5a083f184570042eee68ddb8780caddb246
diff --git a/plHttp b/plHttp
deleted file mode 160000
index faa8215..0000000
--- a/plHttp
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit faa821576b6ab706060f6e8eab2a8a9210b8c842
diff --git a/plSvg b/plSvg
deleted file mode 160000
index 07ba12c..0000000
--- a/plSvg
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 07ba12c2c373fa41e1580b8c90ee17036680fce8
diff --git a/plUri b/plUri
deleted file mode 160000
index 68dba15..0000000
--- a/plUri
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 68dba15c5cf7bb309165d2c9439c02bd22cfba95
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;50&#34;&gt; 50: 正在比较变动前 daed8bf 和变动后 528b9af &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
index 844b1bd..6c22435 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -7,3 +7,6 @@
 [submodule &amp;quot;plDcg&amp;quot;]
 	path = plDcg
 	url = https://github.com/wouterbeek/plDcg.git
+[submodule &amp;quot;plUri&amp;quot;]
+	path = plUri
+	url = https://github.com/wouterbeek/plUri.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 18fe981..ec4c91a 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 18fe981c492d67be3670406e51602c23b97a6052
+Subproject commit ec4c91a00704c0c8d9b4ed747cb9b1648355559b
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 67d419a..30761bb 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -51,6 +51,7 @@
 
 :- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index f0c1c5d..649ef9c 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -23,6 +23,7 @@ Support for GraphViz attributes.
 :- use_module(os(file_ext)).
 :- use_module(os(file_gnu)).
 
+:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_content)).
 :- use_module(plDcg(dcg_generics)).
 
@@ -71,7 +72,7 @@ gv_attr(Context, N=V, N=V):-
   % Check validity of context.
   memberchk(Context, UsedBy).
 gv_attr(Context, N=V1, N=V2):-
-  gv_attr(N2, UsedBy, Types, _, Minimum, _),
+  gv_attr(N, UsedBy, Types, _, Minimum, _),
   % Check validity of context.
   memberchk(Context, UsedBy),
   % Check validity of value type.
diff --git a/gv_color.pl b/gv_color.pl
index 4176444..61d26df 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -26,6 +26,7 @@
 :- use_module(os(file_gnu)).
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
 :- use_module(plDcg_rfc(rfc2616_basic)).
diff --git a/gv_dot.pl b/gv_dot.pl
index 0cdc571..e67c469 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -23,10 +23,13 @@ In GraphViz vertices are called &#39;nodes&#39;.
 :- use_module(library(ordsets)).
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_arrow)).
 :- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_bracket)).
 :- use_module(plDcg(dcg_content)).
 :- use_module(plDcg(dcg_generics)).
 :- use_module(plDcg(dcg_meta)).
+:- use_module(plDcg(dcg_quote)).
 
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
@@ -47,10 +50,10 @@ gv_attribute(Name=Val) --&amp;gt;
 %!   +GraphAttributes:list(nvpair),
 %!   +Attributes:list(nvpair)
 %! )// .
-% ~~~{.abnf}
+% ```abnf
 % attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
 % a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
-% ~~~
+% ```
 
 % Attributes occur between square brackets.
 gv_attribute_list(Context, _, Attrs1) --&amp;gt;
@@ -59,9 +62,9 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 
 
 %! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
-% ~~~
+% ```
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
-% ~~~
+% ```
 
 gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
 gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
@@ -133,9 +136,9 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 % @arg GraphAttributes A list of name-value pairs.
 % @arg CategoryAttributes A list of name-value pairs.
 %
-% ~~~
+% ```
 % attr_stmt = (graph / node / edge) attr_list
-% ~~~
+% ```
 
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
@@ -156,19 +159,19 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 %      they are ignored in the input file.
 %      Only in combinattion with directionality `directed`.
 %
-% ~~~{.abnf}
+% ```abnf
 % graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
-% ~~~
+% ```
 %
 % `GraphTerm` is a compound term of the following form:
-% ~~~{.pl}
+% ```prolog
 % graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
-% ~~~
+% ```
 %
 % `RankedVertexTerms` is a list of compound terms of the following form:
-% ~~~{.pl}
+% ```prolog
 % rank(RankNode,ContentNodes)
-% ~~~
+% ```
 %
 % @tbd Add support for subgraphs (arbitrary nesting).
 % @tbd Add support for escape strings:
@@ -307,7 +310,7 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 % HTML strings (variant 4).
 gv_id(Content) --&amp;gt;
   {compound(Content)}, !,
-  gv_html_like_label, Content).
+  gv_html_like_label(Content).
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -331,14 +334,16 @@ gv_id(Atom) --&amp;gt;
 % Double-quoted strings (variant 3).
 % The quotes are not in the given atom. They are written anyway.
 gv_id(Atom) --&amp;gt;
-  quoted(double_quote, dcg_atom_codes(gv_quoted_string, Atom)), !.
+  quoted(dcg_atom_codes(gv_quoted_string, Atom)), !.
 
-gv_id_first(X) --&amp;gt; ascii_letter(X).
+gv_id_first(X) --&amp;gt; letter(X).
 gv_id_first(X) --&amp;gt; underscore(X).
 
 gv_id_rest([]) --&amp;gt; [].
 gv_id_rest([H|T]) --&amp;gt;
-  (ascii_alpha_numeric(H) ; underscore(H)),
+  (   alpha_numeric(H)
+  ;   underscore(H)
+  ),
   gv_id_rest(T).
 
 
@@ -463,7 +468,7 @@ gv_ranked_node_collection(
       [Rank_V_Term|Content_V_Terms],
       []
     ),
-    
+
     % We want to indent the closing curly brace.
     indent(I)
   )),
diff --git a/gv_file.pl b/gv_file.pl
index 789bd56..704e2d4 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -9,9 +9,6 @@
     gif_to_gv_file/3, % +GraphInterchangeFormat:compound
                       % ?ToFile:atom
                       % +Options:list(nvpair)
-    gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
-                      % -SvgDom:list(compound)
-                      % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -35,7 +32,6 @@ and GraphViz output files or SVG DOM structures.
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
-:- use_module(svg(svg_file)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -175,20 +171,6 @@ gif_to_gv_file(Gif, ToFile, Options):-
   codes_to_gv_file(Codes, ToFile, Options).
 
 
-%! gif_to_svg_dom(
-%!   +GraphInterchangeFormat:compound,
-%!   -SvgDom:list(compound),
-%!   +Options:list(nvpair)
-%! ) is det.
-
-gif_to_svg_dom(Gif, SvgDom, Options1):-
-  % Make sure the file type of the output file is SvgDom.
-  merge_options([to_file_type=svg], Options1, Options2),
-  gif_to_gv_file(Gif, ToFile, Options2),
-  file_to_svg(ToFile, SvgDom),
-  delete_file(ToFile).
-
-
 %! open_dot(+File:atom) is det.
 % Opens the given DOT file.
 %
diff --git a/gv_html.pl b/gv_html.pl
index a308ac7..08306f0 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -9,32 +9,32 @@
 
 Grammar taken from the GraphViz Web site:
 
-~~~{.txt}
-label 	: 	text
-	| 	table
-text 	: 	textitem
-	| 	text textitem
-textitem 	: 	string
-	| 	&amp;lt;BR/&amp;gt;
-	| 	&amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
-	| 	&amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
-	| 	&amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
-	| 	&amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
-	| 	&amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
-	| 	&amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
-	| 	&amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
-	| 	&amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
-table 	: 	[ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
-rows 	: 	row
-	| 	rows row
-	| 	rows &amp;lt;HR/&amp;gt; row
-row 	: 	&amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
-cells 	: 	cell
-	| 	cells cell
-	| 	cells &amp;lt;VR/&amp;gt; cell
-cell 	: 	&amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
-	| 	&amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
-~~~
+```
+label :   text
+        | table
+text :   textitem
+       | text textitem
+textitem :   string
+           | &amp;lt;BR/&amp;gt;
+           | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+           | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+           | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+           | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+           | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+           | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+           | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+           | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+rows :   row
+       | rows row
+       | rows &amp;lt;HR/&amp;gt; row
+row: &amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
+cells :   cell
+        | cells cell
+        | cells &amp;lt;VR/&amp;gt; cell
+cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
+      | &amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
+```
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/node-shapes#html
@@ -42,6 +42,7 @@ cell 	: 	&amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 */
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_bracket)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
@@ -56,7 +57,7 @@ gv_html_like_label(Content) --&amp;gt;
 
 %! cell(?Contents:compound)// .
 % Supported attributes for TD:
-% ~~~{.txt}
+% ```
 % ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
 % BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
 % BGCOLOR=&amp;quot;color&amp;quot;
@@ -79,13 +80,13 @@ gv_html_like_label(Content) --&amp;gt;
 % TOOLTIP=&amp;quot;value&amp;quot;
 % VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
 % WIDTH=&amp;quot;value&amp;quot;
-% ~~~
+% ```
 %
 % Supported attributes for IMG:
-% ~~~{.txt}
+% ```
 % SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
 % SRC=&amp;quot;value&amp;quot;
-% ~~~
+% ```
 
 cell(td(Contents)) --&amp;gt;
   html_element(td, [], label(Contents)).
@@ -125,7 +126,7 @@ row(tr(Contents)) --&amp;gt;
 
 rows([H|T]) --&amp;gt;
   row(H),
-  rows.
+  rows(T).
 rows([H,hr|T]) --&amp;gt;
   row(H),
   html_element(hr),
@@ -136,7 +137,7 @@ rows([H]) --&amp;gt;
 
 %! table(?Contents:compound)// .
 % Supported attributes for TABLE:
-% ~~~{.txt}
+% ```
 % ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
 % BGCOLOR=&amp;quot;color&amp;quot;
 % BORDER=&amp;quot;value&amp;quot;
@@ -159,14 +160,14 @@ rows([H]) --&amp;gt;
 % TOOLTIP=&amp;quot;value&amp;quot;
 % VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
 % WIDTH=&amp;quot;value&amp;quot;
-% ~~~
+% ```
 %
 % Supported attributes for FONT:
-% ~~~{.txt}
+% ```
 % COLOR=&amp;quot;color&amp;quot;
 % FACE=&amp;quot;fontname&amp;quot;
 % POINT-SIZE=&amp;quot;value&amp;quot;
-% ~~~
+% ```
 
 table(table(Attrs,Contents)) --&amp;gt;
   html_element(table, Attrs, rows(Contents)).
@@ -182,9 +183,9 @@ text(Contents) --&amp;gt;
 
 %! textitem(?Content)// .
 % Supported attributes for BR:
-% ~~~{.txt}
+% ```
 % ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% ~~~
+% ```
 
 textitem(string(String)) --&amp;gt;
   html_string(String).
diff --git a/gv_numeral.pl b/gv_numeral.pl
index 7870eb1..c115372 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -14,59 +14,67 @@
 :- use_module(math(math_ext)).
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_cardinal)).
 
 
 
 %! gv_numeral(?Value:number)// .
-% ~~~{.bnf}
+%
+% # Syntax
+%
+% ```bnf
 % (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
-% ~~~
+% ```
+%
+% ## Generation
+%
+% In the generative case, three notations are allowed (also see below):
+%   1. (non-zero integer-part)
+%   2. (decimal-separator) (non-zero fractional)
+%   3. (non-zero integer-part) (decimal-separator) (non-zero fractional)
+%
+% The following notations are explicitly excluded due to verbosity:
+%   - (non-zero integer-part) (decimal-separator)
+%   - (non-zero integer-part) (decimal-separator) (zero fractional)
+%   - (zero integer-part) (decimal-separator) (non-zero fractional)
+%
+% The following notations are also excluded, but since they violate
+%  well-formedness:
+%   - (non-zero integer-part) (non-zero fractional)
+%   - (decimal-separator)
 
 gv_numeral(N) --&amp;gt;
-  {nonvar(N)},
-  {number_sign_parts(N, Sign, Abs)},
-  ({Sign =:= -1} -&amp;gt; `-` ; ``),
-  gv_numeral_abs(Abs).
+  {var(N)}, !,
+  sign(Sign),
+  (   &amp;quot;.&amp;quot;,
+      &#39;+&#39;(decimal_digit, Fractional, [convert1(weights_decimal)]),
+      {IntegerPart = 0}
+  ;   &#39;+&#39;(decimal_digit, IntegerPart, [convert1(weights_decimal)]),
+      (   &amp;quot;.&amp;quot;,
+          &#39;*&#39;(decimal_digit, Fractional, [convert1(weights_decimal)])
+      ;   {Fractional = 0}
+      )
+  ),
+  {   number_integer_parts(UnsignedN, IntegerPart, Fractional),
+      N is copysign(UnsignedN, Sign)
+  }.
 gv_numeral(N) --&amp;gt;
-  {var(N)},
-  &#39;sign?&#39;(Sign),
-  gv_numeral_abs(Abs),
-  {number_sign_parts(N, Sign, Abs)}.
-
-
-gv_numeral_abs(N) --&amp;gt;
-  {nonvar(N)},
-  {number_integer_parts(N, N1, N2)},
-  (
-    {N2 =:= 0}
-  -&amp;gt;
-    integer(N1)
-  ;
-    {N1 =:= 0}
-  -&amp;gt;
-    `.`,
-    integer(N2)
-  ;
-    integer(N1),
-    &#39;?&#39;((`.`, &#39;integer?&#39;(N2)), [])
+  {number_sign_parts(N, Sign, UnsignedN)},
+  sign(Sign),
+  {number_integer_parts(UnsignedN, IntegerPart, Fractional)},
+  (   % [1] The fractional is zero, so only write the integer part
+      %     and do not write the decimal separator.
+      {Fractional =:= 0}
+  -&amp;gt;  integer(IntegerPart)
+  ;   % [2] The integer part is zero, so only write the fractional part,
+      %     preceded by the decimal separator.
+      {IntegerPart =:= 0}
+  -&amp;gt;  &amp;quot;.&amp;quot;,
+      integer(Fractional)
+  ;   % [3] Both the integer part and the fractional are non-zero,
+      %     so write both of them, with the decimal separator in-between.
+      integer(IntegerPart),
+      &amp;quot;.&amp;quot;,
+      integer(Fractional)
   ).
-gv_numeral_abs(N) --&amp;gt;
-  {var(N)},
-  (
-    `.`,
-    integer(N2)
-  -&amp;gt;
-    {N1 = 0}
-  ;
-    integer(N1),
-    (
-      `.`
-    -&amp;gt;
-      &#39;integer?&#39;(N2)
-    ;
-      {N2 = 0}
-    )
-  ),
-  {number_integer_parts(N, N1, N2)}.
-
diff --git a/load.pl b/load.pl
index 67dfe22..5cec32c 100644
--- a/load.pl
+++ b/load.pl
@@ -9,8 +9,6 @@
     plc-&#39;Prolog-Library-Collection&#39;,
     plDcg,
     plHtml,
-    plHttp,
-    plSvg,
     plUri
 ]).
 
diff --git a/plDcg b/plDcg
index 19020db..96e2615 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit 19020db8046bf96d54938e6ba02d65dc2b6f8b50
+Subproject commit 96e261537773270a43d1ff4346273820282f21fb
diff --git a/plHtml b/plHtml
index 2d6bb5a..a7b736f 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 2d6bb5a083f184570042eee68ddb8780caddb246
+Subproject commit a7b736fdf7c435f825193bbc54500a302b0bc4b1
diff --git a/plUri b/plUri
new file mode 160000
index 0000000..59f582c
--- /dev/null
+++ b/plUri
@@ -0,0 +1 @@
+Subproject commit 59f582c68cebc221f964ccb9805a869d05cb7856
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;51&#34;&gt; 51: 正在比较变动前 528b9af 和变动后 e594ae6 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_color.pl b/gv_color.pl
index 61d26df..da34c1a 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -13,7 +13,7 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06, 2014/10
+@version 2014/06, 2014/10-2014/11
 */
 
 :- use_module(library(apply)).
@@ -51,10 +51,10 @@
 %   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
-  `#`,
+  &amp;quot;#&amp;quot;,
   &#39;#&#39;(3, hex_color, [Red,Green,Blue], []).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
-  `#`,
+  &amp;quot;#&amp;quot;,
   &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha], []).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
   &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
@@ -82,7 +82,7 @@ wc(Color-Float) --&amp;gt;
   &#39;?&#39;(wc_weight(Float), []).
 
 wc_weight(Float) --&amp;gt;
-  `;`,
+  &amp;quot;;&amp;quot;,
   float(Float).
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;52&#34;&gt; 52: 正在比较变动前 e594ae6 和变动后 bbefbf7 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_color.pl b/gv_color.pl
index da34c1a..74c9060 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -25,11 +25,11 @@
 :- use_module(os(file_ext)).
 :- use_module(os(file_gnu)).
 
+:- use_module(plDcg(abnf_core_rules)).
 :- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg_rfc(rfc2616_basic)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;53&#34;&gt; 53: 正在比较变动前 bbefbf7 和变动后 0cc5421 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index 7193a38..b25c15b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,4 +1 @@
 *~
-*#
-*.db
-data/*
diff --git a/.gitmodules b/.gitmodules
index 6c22435..a63cbff 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,9 +4,3 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
-[submodule &amp;quot;plDcg&amp;quot;]
-	path = plDcg
-	url = https://github.com/wouterbeek/plDcg.git
-[submodule &amp;quot;plUri&amp;quot;]
-	path = plUri
-	url = https://github.com/wouterbeek/plUri.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index ec4c91a..d7d21ad 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit ec4c91a00704c0c8d9b4ed747cb9b1648355559b
+Subproject commit d7d21ad4d6d7cec98d8b0122f5303e691998f512
diff --git a/README.md b/README.md
new file mode 100644
index 0000000..3c9e9cf
--- /dev/null
+++ b/README.md
@@ -0,0 +1,8 @@
+plGraphViz
+==========
+
+Export graphs represented as Prolog terms to
+ [GraphViz](http://www.graphviz.org/).
+
+Author: [Wouter Beek](http://www.wouterbeek.com)
+
diff --git a/debug.pl b/debug.pl
index 099cb84..d7339b9 100644
--- a/debug.pl
+++ b/debug.pl
@@ -1,7 +1,9 @@
-% Loads debug tools for the plGraphViz library.
+% Debug file for library plGraphViz.
+
+:- style_check(+charset).
+%:- style_check(+var_branches).
 
 :- [load].
 
 :- use_module(debug_project).
 :- debug_all_files.
-
diff --git a/debug_project.pl b/debug_project.pl
index ab61534..17195c1 100644
--- a/debug_project.pl
+++ b/debug_project.pl
@@ -11,7 +11,7 @@ Generic code for debugging a project:
   * Load all subdirectories and Prolog files contained in those directories.
 
 @author Wouter Beek
-@version 2014/10/31
+@version 2014/11/19
 */
 
 :- use_module(library(ansi_term)).
@@ -54,7 +54,6 @@ do_not_load0(debug_project).
 do_not_load0(index).
 do_not_load0(load).
 do_not_load0(load_project).
-do_not_load0(rfc2616_basic).
 do_not_load0(run).
 
 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 30761bb..3c7863d 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -46,12 +46,10 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06, 2014/11
+@version 2014/06
 */
 
 :- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
 
@@ -99,7 +97,7 @@ gv_attr_type(viewPort).
 % An *addDouble* is represented by a Prolog float.
 
 addDouble(Float) --&amp;gt;
-  &#39;?&#39;(plus_sign, []),
+  &#39;?&#39;(`+`, []),
   double(Float).
 
 
@@ -108,7 +106,7 @@ addDouble(Float) --&amp;gt;
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
 addPoint(Point) --&amp;gt;
-  &#39;?&#39;(plus_sign, []),
+  &#39;?&#39;(`+`, []),
   point(Point).
 
 
@@ -149,10 +147,10 @@ backwards_compatible(invempty).
 backwards_compatible(open).
 
 
-bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
-bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
-bool(true) --&amp;gt; &amp;quot;true&amp;quot;.
-bool(true) --&amp;gt; &amp;quot;yes&amp;quot;.
+bool(false) --&amp;gt; `false`.
+bool(false) --&amp;gt; `no`.
+bool(true) --&amp;gt; `true`.
+bool(true) --&amp;gt; `yes`.
 
 
 %! clusterMode(+ClusterMode:atom)// .
@@ -189,7 +187,7 @@ doubleList([H|T]) --&amp;gt;
   &#39;*&#39;(doubleList1, T, []).
 
 doubleList1(Float) --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   double(Float).
 
 
@@ -244,16 +242,16 @@ pagedir(&#39;TR&#39;).
 
 %! point(+Point:compound)// .
 % A *point* is represented by a compound of the following form:
-% `point(X:float,Y:float,Changeable:boolean)`.
+% `point(X:float,Y:float,InputOnly:boolean)`.
 
-point(point(X,Y,Changeable)) --&amp;gt;
+point(point(X,Y,InputOnly)) --&amp;gt;
   float(X),
-  &amp;quot;,&amp;quot;,
+  `,`,
   float(Y),
-  input_changeable(Changeable).
+  input_only(InputOnly).
 
-input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
-input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
+input_only(false) --&amp;gt; [].
+input_only(true) --&amp;gt; `!`.
 
 
 pointList(Points) --&amp;gt;
@@ -294,9 +292,9 @@ rankdir(&#39;TB&#39;).
 
 
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), &amp;quot;,&amp;quot;,
-  float(LowerLeftY), &amp;quot;,&amp;quot;,
-  float(UpperRightX), &amp;quot;,&amp;quot;,
+  float(LowerLeftX), `,`,
+  float(LowerLeftY), `,`,
+  float(UpperRightX), `,`,
   float(UpperRightY).
 
 
@@ -416,3 +414,4 @@ style(node, wedged).
 
 
 % @tbd viewPort
+
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 649ef9c..faf496c 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -2,17 +2,15 @@
   gv_attrs,
   [
     gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
-              % +Attribute1:nvpair
-              % -Attribute2:nvpair
+              % +Attr1:nvpair
+              % +Attr2:nvpair
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz: Attributes
-
-Support for GraphViz attributes.
+/** &amp;lt;module&amp;gt; GraphViz attributes v2
 
 @author Wouter Beek
-@version 2014/06, 2014/11
+@version 2014/06
 */
 
 :- use_module(library(apply)).
@@ -21,11 +19,9 @@ Support for GraphViz attributes.
 
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
-:- use_module(os(file_gnu)).
 
-:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generics)).
+:- use_module(plDcg(dcg_generic)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
@@ -58,40 +54,24 @@ Support for GraphViz attributes.
 
 
 
-%! gv_attr(
-%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +Attribute1:nvpair,
-%!   +Attribute2:nvpair
-%! ) is det.
-% Uses the default value in case Value is uninstantiated.
-% Otherwise, performs a typecheck and converts the given value.
-
 gv_attr(Context, N=V, N=V):-
   var(V), !,
   gv_attr(N, UsedBy, _, V, _, _),
-  % Check validity of context.
   memberchk(Context, UsedBy).
 gv_attr(Context, N=V1, N=V2):-
   gv_attr(N, UsedBy, Types, _, Minimum, _),
-  % Check validity of context.
   memberchk(Context, UsedBy),
-  % Check validity of value type.
   member(Type, Types),
-  (   Type == style
-  -&amp;gt;  Dcg =.. [Type,Context,V1]
-  ;   Dcg =.. [Type,V1]
+  (
+    Type == style
+  -&amp;gt;
+    Dcg =.. [Type,Context,V1]
+  ;
+    Dcg =.. [Type,V1]
   ),
   once(dcg_phrase(Dcg, V2)),
-  % Check validity of Value w.r.t. minimum value -- if available.
   check_minimum(V1, Minimum).
 
-
-
-% HELPERS
-
-%! check_minimum(+Value:atom, +Minimum:number) is semidet.
-% Trivially succeeds if no minimum value is available for a given attribute.
-
 check_minimum(_, &#39;&#39;):- !.
 check_minimum(V, Min1):-
   atom_number(Min1, Min2),
diff --git a/gv_color.pl b/gv_color.pl
index 74c9060..cb0cf8c 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -13,27 +13,27 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06, 2014/10-2014/11
+@version 2014/06
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists), except([delete/3])).
+:- use_module(library(lists)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
-:- use_module(os(file_gnu)).
 
-:- use_module(plDcg(abnf_core_rules)).
 :- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
+:- use_module(plDcg_rfc(rfc2616_basic)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
+:- use_module(plSparql_parse(sparql_char)).
+
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
@@ -51,10 +51,10 @@
 %   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
-  &amp;quot;#&amp;quot;,
+  `#`,
   &#39;#&#39;(3, hex_color, [Red,Green,Blue], []).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
-  &amp;quot;#&amp;quot;,
+  `#`,
   &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha], []).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
   &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
@@ -82,7 +82,7 @@ wc(Color-Float) --&amp;gt;
   &#39;?&#39;(wc_weight(Float), []).
 
 wc_weight(Float) --&amp;gt;
-  &amp;quot;;&amp;quot;,
+  `;`,
   float(Float).
 
 
@@ -142,13 +142,3 @@ gv_color_update(_):-
 
 gv_color_url(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
 
-
-%! safe_db_attach(+File:atom) is det.
-
-safe_db_attach(File):-
-  exists_file(File), !,
-  db_attach(File, []).
-safe_db_attach(File):-
-  touch_file(File),
-  safe_db_attach(File).
-
diff --git a/gv_dot.pl b/gv_dot.pl
index e67c469..accd5bd 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +Gif:compound
+    gv_graph//1 % +GraphTerm:compound
   ]
 ).
 
@@ -19,17 +19,14 @@ In GraphViz vertices are called &#39;nodes&#39;.
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists), except([delete/3])).
+:- use_module(library(lists)).
 :- use_module(library(ordsets)).
 
 :- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_arrow)).
 :- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_bracket)).
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generics)).
+:- use_module(plDcg(dcg_generic)).
 :- use_module(plDcg(dcg_meta)).
-:- use_module(plDcg(dcg_quote)).
 
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
@@ -42,7 +39,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % We assume that the attribute has already been validated.
 
 gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
+  gv_id(Name), `=`, gv_id(Val), `;`.
 
 
 %! gv_attribute_list(
@@ -50,10 +47,10 @@ gv_attribute(Name=Val) --&amp;gt;
 %!   +GraphAttributes:list(nvpair),
 %!   +Attributes:list(nvpair)
 %! )// .
-% ```abnf
+% ~~~{.abnf}
 % attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
 % a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
-% ```
+% ~~~
 
 % Attributes occur between square brackets.
 gv_attribute_list(Context, _, Attrs1) --&amp;gt;
@@ -62,20 +59,20 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 
 
 %! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
-% ```
+% ~~~
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
-% ```
+% ~~~
 
-gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
-gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
-gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
-gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
-gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
-gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
-gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
-gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
-gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
-gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
+gv_compass_pt(c) --&amp;gt; `c`.
+gv_compass_pt(e) --&amp;gt; `e`.
+gv_compass_pt(n) --&amp;gt; `n`.
+gv_compass_pt(ne) --&amp;gt; `ne`.
+gv_compass_pt(nw) --&amp;gt; `nw`.
+gv_compass_pt(s) --&amp;gt; `s`.
+gv_compass_pt(se) --&amp;gt; `se`.
+gv_compass_pt(sw) --&amp;gt; `sw`.
+gv_compass_pt(w) --&amp;gt; `w`.
 
 
 %! gv_edge_operator(+Directed:boolean)// .
@@ -86,7 +83,7 @@ gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
+gv_edge_operator(false) --&amp;gt; !, `--`.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
@@ -110,11 +107,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), &amp;quot; &amp;quot;,
+  gv_node_id(FromId), ` `,
 
-  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
+  gv_edge_operator(Directed), ` `,
 
-  gv_node_id(ToId), &amp;quot; &amp;quot;,
+  gv_node_id(ToId), ` `,
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
@@ -136,18 +133,18 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 % @arg GraphAttributes A list of name-value pairs.
 % @arg CategoryAttributes A list of name-value pairs.
 %
-% ```
+% ~~~
 % attr_stmt = (graph / node / edge) attr_list
-% ```
+% ~~~
 
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
-  gv_kind(Kind), &amp;quot; &amp;quot;,
+  gv_kind(Kind), ` `,
   gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
-%! gv_graph(+Gif:compound)//
+%! gv_graph(+GraphTerm:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -159,19 +156,19 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 %      they are ignored in the input file.
 %      Only in combinattion with directionality `directed`.
 %
-% ```abnf
+% ~~~{.abnf}
 % graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
-% ```
+% ~~~
 %
 % `GraphTerm` is a compound term of the following form:
-% ```prolog
+% ~~~{.pl}
 % graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
-% ```
+% ~~~
 %
 % `RankedVertexTerms` is a list of compound terms of the following form:
-% ```prolog
+% ~~~{.pl}
 % rank(RankNode,ContentNodes)
-% ```
+% ~~~
 %
 % @tbd Add support for subgraphs (arbitrary nesting).
 % @tbd Add support for escape strings:
@@ -179,10 +176,10 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
+gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
 
-gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
+gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   {
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
@@ -197,8 +194,8 @@ gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), &amp;quot; &amp;quot;,
-  gv_id(GName), &amp;quot; &amp;quot;,
+  gv_graph_type(Directed), ` `,
+  gv_id(GName), ` `,
 
   % The body of the DOT file appears between curly braces.
   bracketed(
@@ -243,18 +240,18 @@ gv_graph0(
       (NewVTerms == [], RankedVTerms == [])
     }
   -&amp;gt;
-    &amp;quot;&amp;quot;
+    ``
   ;
     line_feed
   ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
+  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
   &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
+  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
 
   {
     findall(
@@ -284,8 +281,8 @@ gv_graph0(
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_graph_type(false) --&amp;gt; `graph`.
+gv_graph_type(true) --&amp;gt; `digraph`.
 
 
 %! gv_id(?Atom:atom)// is det.
@@ -308,9 +305,8 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 %      This requires an XML grammar!
 
 % HTML strings (variant 4).
-gv_id(Content) --&amp;gt;
-  {compound(Content)}, !,
-  gv_html_like_label(Content).
+gv_id(Atom) --&amp;gt;
+  dcg_atom_codes(gv_html_like_label, Atom), !.
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -334,16 +330,14 @@ gv_id(Atom) --&amp;gt;
 % Double-quoted strings (variant 3).
 % The quotes are not in the given atom. They are written anyway.
 gv_id(Atom) --&amp;gt;
-  quoted(dcg_atom_codes(gv_quoted_string, Atom)), !.
+  quoted(double_quote, dcg_atom_codes(gv_quoted_string, Atom)), !.
 
-gv_id_first(X) --&amp;gt; letter(X).
+gv_id_first(X) --&amp;gt; ascii_letter(X).
 gv_id_first(X) --&amp;gt; underscore(X).
 
 gv_id_rest([]) --&amp;gt; [].
 gv_id_rest([H|T]) --&amp;gt;
-  (   alpha_numeric(H)
-  ;   underscore(H)
-  ),
+  (ascii_alpha_numeric(H) ; underscore(H)),
   gv_id_rest(T).
 
 
@@ -359,19 +353,19 @@ gv_keyword(Codes):-
 % GraphViz has reserved keywords that cannot be used as identifiers.
 % GraphViz keywords are case-insensitive.
 
-gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
-gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
+gv_keyword --&amp;gt; `digraph`.
+gv_keyword --&amp;gt; `edge`.
+gv_keyword --&amp;gt; `graph`.
+gv_keyword --&amp;gt; `node`.
+gv_keyword --&amp;gt; `strict`.
+gv_keyword --&amp;gt; `subgraph`.
 
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
+gv_kind(edge) --&amp;gt; `edge`.
+gv_kind(graph) --&amp;gt; `graph`.
+gv_kind(node) --&amp;gt; `node`.
 
 
 %! gv_node_id(+NodeId:atom)// .
@@ -398,7 +392,7 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), &amp;quot; &amp;quot;,
+  gv_node_id(Id), ` `,
   gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
@@ -409,23 +403,23 @@ gv_port --&amp;gt;
   gv_port_angle,
   &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   gv_compass_pt(_).
 
 gv_port_angle --&amp;gt;
-  &amp;quot;@&amp;quot;,
+  `@`,
   gv_id(_).
 
 gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   gv_id(_).
 gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
+  `:`,
   bracketed(
     round,
     (
       gv_id(_),
-      &amp;quot;,&amp;quot;,
+      `,`,
       gv_id(_)
     )
   ).
@@ -442,7 +436,7 @@ gv_quoted_string([92,34|T]) --&amp;gt; !,
   gv_quoted_string(T).
 % Add the backslash escape character.
 gv_quoted_string([34|T]) --&amp;gt; !,
-  &amp;quot;\\\&amp;quot;&amp;quot;,
+  `\\\&amp;quot;`,
   gv_quoted_string(T).
 % All other characters are allowed without escaping.
 gv_quoted_string([H|T]) --&amp;gt;
@@ -461,14 +455,14 @@ gv_ranked_node_collection(
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
+    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
 
     &#39;*&#39;(
       gv_node_statement(NewI, GraphAttrs),
       [Rank_V_Term|Content_V_Terms],
       []
     ),
-
+    
     % We want to indent the closing curly brace.
     indent(I)
   )),
@@ -481,7 +475,7 @@ gv_ranked_node_collection(
 % This only applies to directed graphs.
 
 gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
+gv_strict(true) --&amp;gt; `strict `.
 
 
 
diff --git a/gv_file.pl b/gv_file.pl
index 704e2d4..bba87f9 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -9,6 +9,9 @@
     gif_to_gv_file/3, % +GraphInterchangeFormat:compound
                       % ?ToFile:atom
                       % +Options:list(nvpair)
+    gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
+                      % -SvgDom:list(compound)
+                      % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -27,11 +30,13 @@ and GraphViz output files or SVG DOM structures.
 
 :- use_module(library(option)).
 :- use_module(library(process)).
+:- use_module(library(predicate_options)). % Declarations.
 
-:- use_module(generics(code_ext)).
+:- use_module(generics(codes_ext)).
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
+:- use_module(svg(svg_file)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -131,12 +136,15 @@ file_to_gv(FromFile, ToFile, Options):-
   prolog_file_type(ToExtension, graphviz_output), !,
 
   % The output file is either given or created.
-  (   var(ToFile)
-  -&amp;gt;  user:prolog_file_type(ToExtension, ToFileType),
-      file_alternative(FromFile, _, _, ToExtension, ToFile)
-  ;   is_absolute_file_name(ToFile),
-      % The given output file must match a certain file extension.
-      file_name_extension(_, ToExtension, ToFile)
+  (
+    var(ToFile)
+  -&amp;gt;
+    user:prolog_file_type(ToExtension, ToFileType),
+    file_alternative(FromFile, _, _, ToExtension, ToFile)
+  ;
+    is_absolute_file_name(ToFile),
+    % The given output file must match a certain file extension.
+    file_name_extension(_, ToExtension, ToFile)
   ),
   % Now that we have the output file we can prevent the
   % file type / file extension translation predicates from bakctracking.
@@ -146,8 +154,6 @@ file_to_gv(FromFile, ToFile, Options):-
   format(atom(OutputType), &#39;-T~w&#39;, [ToExtension]),
   process_create(
     path(Method),
-    % @tbd Windows hack:
-    %%%%&#39;C:\\Program Files (x86)\\Graphviz2.38\\bin\\dot.exe&#39;,
     [OutputType,FromFile,&#39;-o&#39;,ToFile],
     [process(PID)]
   ),
@@ -171,6 +177,20 @@ gif_to_gv_file(Gif, ToFile, Options):-
   codes_to_gv_file(Codes, ToFile, Options).
 
 
+%! gif_to_svg_dom(
+%!   +GraphInterchangeFormat:compound,
+%!   -SvgDom:list(compound),
+%!   +Options:list(nvpair)
+%! ) is det.
+
+gif_to_svg_dom(Gif, SvgDom, Options1):-
+  % Make sure the file type of the output file is SvgDom.
+  merge_options([to_file_type=svg], Options1, Options2),
+  gif_to_gv_file(Gif, ToFile, Options2),
+  file_to_svg(ToFile, SvgDom),
+  delete_file(ToFile).
+
+
 %! open_dot(+File:atom) is det.
 % Opens the given DOT file.
 %
diff --git a/gv_html.pl b/gv_html.pl
index 08306f0..3f0b08b 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -1,224 +1,60 @@
 :- module(
   gv_html,
   [
-    gv_html_like_label//1 % +Content:compound
+    gv_html_like_label//1 % +Codes:list(code)
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
-
-Grammar taken from the GraphViz Web site:
-
-```
-label :   text
-        | table
-text :   textitem
-       | text textitem
-textitem :   string
-           | &amp;lt;BR/&amp;gt;
-           | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
-           | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
-           | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
-           | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
-           | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
-           | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
-           | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
-           | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
-table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
-rows :   row
-       | rows row
-       | rows &amp;lt;HR/&amp;gt; row
-row: &amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
-cells :   cell
-        | cells cell
-        | cells &amp;lt;VR/&amp;gt; cell
-cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
-      | &amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
-```
+/** &amp;lt;module&amp;gt; GraphViz HTML
 
 @author Wouter Beek
-@see http://www.graphviz.org/content/node-shapes#html
-@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
+@version 2013/07, 2013/09, 2014/03-2014/06
 */
 
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_bracket)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
 
 
-%! gv_html_like_label(?Content:compound)// .
-
-gv_html_like_label(Content) --&amp;gt;
-  bracketed(angular, label(Content)).
-
-
-%! cell(?Contents:compound)// .
-% Supported attributes for TD:
-% ```
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
-% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLSPAN=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWSPAN=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ```
+%! gv_html_label(+Codes:list(code))// .
 %
-% Supported attributes for IMG:
-% ```
-% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
-% SRC=&amp;quot;value&amp;quot;
-% ```
-
-cell(td(Contents)) --&amp;gt;
-  html_element(td, [], label(Contents)).
-cell(td(img)) --&amp;gt;
-  html_element(td, [], html_element(img)).
-
-
-%! cells(?Contents:list(compound))// .
-
-cells([H|T]) --&amp;gt;
-  cell(H),
-  cells(T).
-cells([H,vr|T]) --&amp;gt;
-  cell(H),
-  html_element(vr),
-  cells(T).
-cells([H]) --&amp;gt;
-  cell(H).
-
-
-%! label(?Content:compound)// .
-% GraphViz HTML-like label.
-
-label(Content) --&amp;gt;
-  text(Content).
-label(Content) --&amp;gt;
-  table(Content).
-
-
-%! row(?Contents:compound)// .
-
-row(tr(Contents)) --&amp;gt;
-  html_element(tr, [], cell(Contents)).
-
-
-%! rows(?Contents:list)// .
-
-rows([H|T]) --&amp;gt;
-  row(H),
-  rows(T).
-rows([H,hr|T]) --&amp;gt;
-  row(H),
-  html_element(hr),
-  rows(T).
-rows([H]) --&amp;gt;
-  row(H).
-
-
-%! table(?Contents:compound)// .
-% Supported attributes for TABLE:
-% ```
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLBORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLUMNS=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWS=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ```
-%
-% Supported attributes for FONT:
-% ```
-% COLOR=&amp;quot;color&amp;quot;
-% FACE=&amp;quot;fontname&amp;quot;
-% POINT-SIZE=&amp;quot;value&amp;quot;
-% ```
-
-table(table(Attrs,Contents)) --&amp;gt;
-  html_element(table, Attrs, rows(Contents)).
-table(table(font(Contents))) --&amp;gt;
-  html_element(font, [], html_element(table, [], rows(Contents))).
-
-
-%! text(?Contents:list)// .
-
-text(Contents) --&amp;gt;
-  &#39;+&#39;(textitem, Contents, []).
-
-
-%! textitem(?Content)// .
-% Supported attributes for BR:
-% ```
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% ```
-
-textitem(string(String)) --&amp;gt;
-  html_string(String).
-textitem(entity(Name)) --&amp;gt;
-  html_entity(Name).
-textitem(br(Attrs)) --&amp;gt;
-  html_element(br, Attrs).
-textitem(Compound) --&amp;gt;
-  {var(Compound)}, !,
-  html_element(Name, _, text(Content)),
-  {
-    supported_html_element(Name),
-    Compound =.. [Name,Content]
-  }.
-textitem(Compound) --&amp;gt;
-  {
-    Compound =.. [Name,Content],
-    supported_html_element(Name)
-  },
-  html_element(Name, _, text(Content)).
-
-
-
-% HELPERS
-
-%! supported_html_element(+Name:atom) is semidet.
-%! supported_html_element(-Name:atom) is multi.
-
-supported_html_element(b).
-supported_html_element(font).
-supported_html_element(i).
-supported_html_element(o).
-supported_html_element(s).
-supported_html_element(sub).
-supported_html_element(sup).
-supported_html_element(u).
+% @see http://www.graphviz.org/doc/info/shapes.html#html
+
+gv_html_label --&amp;gt; gv_html_text, !.
+gv_html_label --&amp;gt; gv_html_table, !.
+gv_html_label --&amp;gt; [].
+
+gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
+
+gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
+
+gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
+gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
+
+gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
+gv_html_rows --&amp;gt; gv_html_row.
+
+gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
+
+gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
+gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
+
+gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
+gv_html_cells --&amp;gt; gv_html_cell.
+gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
+
+gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
+gv_html_text --&amp;gt; gv_html_textitem.
+
+gv_html_textitem --&amp;gt; html_string, !.
+gv_html_textitem --&amp;gt; html_entity, !.
+gv_html_textitem --&amp;gt; html_element(br, _), !.
+gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
+gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
+
diff --git a/gv_numeral.pl b/gv_numeral.pl
index c115372..7870eb1 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -14,67 +14,59 @@
 :- use_module(math(math_ext)).
 
 :- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_cardinal)).
 
 
 
 %! gv_numeral(?Value:number)// .
-%
-% # Syntax
-%
-% ```bnf
+% ~~~{.bnf}
 % (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
-% ```
-%
-% ## Generation
-%
-% In the generative case, three notations are allowed (also see below):
-%   1. (non-zero integer-part)
-%   2. (decimal-separator) (non-zero fractional)
-%   3. (non-zero integer-part) (decimal-separator) (non-zero fractional)
-%
-% The following notations are explicitly excluded due to verbosity:
-%   - (non-zero integer-part) (decimal-separator)
-%   - (non-zero integer-part) (decimal-separator) (zero fractional)
-%   - (zero integer-part) (decimal-separator) (non-zero fractional)
-%
-% The following notations are also excluded, but since they violate
-%  well-formedness:
-%   - (non-zero integer-part) (non-zero fractional)
-%   - (decimal-separator)
+% ~~~
 
 gv_numeral(N) --&amp;gt;
-  {var(N)}, !,
-  sign(Sign),
-  (   &amp;quot;.&amp;quot;,
-      &#39;+&#39;(decimal_digit, Fractional, [convert1(weights_decimal)]),
-      {IntegerPart = 0}
-  ;   &#39;+&#39;(decimal_digit, IntegerPart, [convert1(weights_decimal)]),
-      (   &amp;quot;.&amp;quot;,
-          &#39;*&#39;(decimal_digit, Fractional, [convert1(weights_decimal)])
-      ;   {Fractional = 0}
-      )
-  ),
-  {   number_integer_parts(UnsignedN, IntegerPart, Fractional),
-      N is copysign(UnsignedN, Sign)
-  }.
+  {nonvar(N)},
+  {number_sign_parts(N, Sign, Abs)},
+  ({Sign =:= -1} -&amp;gt; `-` ; ``),
+  gv_numeral_abs(Abs).
 gv_numeral(N) --&amp;gt;
-  {number_sign_parts(N, Sign, UnsignedN)},
-  sign(Sign),
-  {number_integer_parts(UnsignedN, IntegerPart, Fractional)},
-  (   % [1] The fractional is zero, so only write the integer part
-      %     and do not write the decimal separator.
-      {Fractional =:= 0}
-  -&amp;gt;  integer(IntegerPart)
-  ;   % [2] The integer part is zero, so only write the fractional part,
-      %     preceded by the decimal separator.
-      {IntegerPart =:= 0}
-  -&amp;gt;  &amp;quot;.&amp;quot;,
-      integer(Fractional)
-  ;   % [3] Both the integer part and the fractional are non-zero,
-      %     so write both of them, with the decimal separator in-between.
-      integer(IntegerPart),
-      &amp;quot;.&amp;quot;,
-      integer(Fractional)
+  {var(N)},
+  &#39;sign?&#39;(Sign),
+  gv_numeral_abs(Abs),
+  {number_sign_parts(N, Sign, Abs)}.
+
+
+gv_numeral_abs(N) --&amp;gt;
+  {nonvar(N)},
+  {number_integer_parts(N, N1, N2)},
+  (
+    {N2 =:= 0}
+  -&amp;gt;
+    integer(N1)
+  ;
+    {N1 =:= 0}
+  -&amp;gt;
+    `.`,
+    integer(N2)
+  ;
+    integer(N1),
+    &#39;?&#39;((`.`, &#39;integer?&#39;(N2)), [])
   ).
+gv_numeral_abs(N) --&amp;gt;
+  {var(N)},
+  (
+    `.`,
+    integer(N2)
+  -&amp;gt;
+    {N1 = 0}
+  ;
+    integer(N1),
+    (
+      `.`
+    -&amp;gt;
+      &#39;integer?&#39;(N2)
+    ;
+      {N2 = 0}
+    )
+  ),
+  {number_integer_parts(N, N1, N2)}.
+
diff --git a/load.pl b/load.pl
index 5cec32c..4b117d1 100644
--- a/load.pl
+++ b/load.pl
@@ -1,14 +1,12 @@
-% Load file for the plGraphViz library.
+% Load file for plGraphViz.
 
-:- dynamic(user:project/2).
-:- multifile(user:project/2).
-   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;).
+:- dynamic(user:prolog/3).
+:- multifile(user:prolog/3).
+   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
 
 :- use_module(load_project).
-:- load_project([
+:- load_project(plGraphViz, [
     plc-&#39;Prolog-Library-Collection&#39;,
-    plDcg,
-    plHtml,
-    plUri
+    plHtml
 ]).
 
diff --git a/plDcg b/plDcg
deleted file mode 160000
index 96e2615..0000000
--- a/plDcg
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 96e261537773270a43d1ff4346273820282f21fb
diff --git a/plHtml b/plHtml
index a7b736f..18e657b 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit a7b736fdf7c435f825193bbc54500a302b0bc4b1
+Subproject commit 18e657b22a84d5e98a317ddec58314964ff68bcd
diff --git a/plUri b/plUri
deleted file mode 160000
index 59f582c..0000000
--- a/plUri
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 59f582c68cebc221f964ccb9805a869d05cb7856
diff --git a/run.pl b/run.pl
deleted file mode 100644
index 8bba736..0000000
--- a/run.pl
+++ /dev/null
@@ -1,9 +0,0 @@
-% Standalone execution of the plGraphViz library.
-
-:- if(current_prolog_flag(argv, [&#39;--debug&#39;|_])).
-  :- ensure_loaded(debug).
-:- else.
-  :- set_prolog_flag(verbose, silent).
-  :- ensure_loaded(load).
-:- endif.
-
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;54&#34;&gt; 54: 正在比较变动前 0cc5421 和变动后 dbc602d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index b25c15b..7193a38 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1 +1,4 @@
 *~
+*#
+*.db
+data/*
diff --git a/.gitmodules b/.gitmodules
index a63cbff..6c22435 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,3 +4,9 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
+[submodule &amp;quot;plDcg&amp;quot;]
+	path = plDcg
+	url = https://github.com/wouterbeek/plDcg.git
+[submodule &amp;quot;plUri&amp;quot;]
+	path = plUri
+	url = https://github.com/wouterbeek/plUri.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index d7d21ad..2774ee9 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit d7d21ad4d6d7cec98d8b0122f5303e691998f512
+Subproject commit 2774ee9cba6ac2353150322c744e65857634e575
diff --git a/debug.pl b/debug.pl
index d7339b9..12b4526 100644
--- a/debug.pl
+++ b/debug.pl
@@ -1,9 +1,7 @@
 % Debug file for library plGraphViz.
 
-:- style_check(+charset).
-%:- style_check(+var_branches).
-
 :- [load].
 
 :- use_module(debug_project).
 :- debug_all_files.
+
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 3c7863d..30761bb 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -46,10 +46,12 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06, 2014/11
 */
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
 
@@ -97,7 +99,7 @@ gv_attr_type(viewPort).
 % An *addDouble* is represented by a Prolog float.
 
 addDouble(Float) --&amp;gt;
-  &#39;?&#39;(`+`, []),
+  &#39;?&#39;(plus_sign, []),
   double(Float).
 
 
@@ -106,7 +108,7 @@ addDouble(Float) --&amp;gt;
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
 addPoint(Point) --&amp;gt;
-  &#39;?&#39;(`+`, []),
+  &#39;?&#39;(plus_sign, []),
   point(Point).
 
 
@@ -147,10 +149,10 @@ backwards_compatible(invempty).
 backwards_compatible(open).
 
 
-bool(false) --&amp;gt; `false`.
-bool(false) --&amp;gt; `no`.
-bool(true) --&amp;gt; `true`.
-bool(true) --&amp;gt; `yes`.
+bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
+bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
+bool(true) --&amp;gt; &amp;quot;true&amp;quot;.
+bool(true) --&amp;gt; &amp;quot;yes&amp;quot;.
 
 
 %! clusterMode(+ClusterMode:atom)// .
@@ -187,7 +189,7 @@ doubleList([H|T]) --&amp;gt;
   &#39;*&#39;(doubleList1, T, []).
 
 doubleList1(Float) --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   double(Float).
 
 
@@ -242,16 +244,16 @@ pagedir(&#39;TR&#39;).
 
 %! point(+Point:compound)// .
 % A *point* is represented by a compound of the following form:
-% `point(X:float,Y:float,InputOnly:boolean)`.
+% `point(X:float,Y:float,Changeable:boolean)`.
 
-point(point(X,Y,InputOnly)) --&amp;gt;
+point(point(X,Y,Changeable)) --&amp;gt;
   float(X),
-  `,`,
+  &amp;quot;,&amp;quot;,
   float(Y),
-  input_only(InputOnly).
+  input_changeable(Changeable).
 
-input_only(false) --&amp;gt; [].
-input_only(true) --&amp;gt; `!`.
+input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
+input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
 
 
 pointList(Points) --&amp;gt;
@@ -292,9 +294,9 @@ rankdir(&#39;TB&#39;).
 
 
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), `,`,
-  float(LowerLeftY), `,`,
-  float(UpperRightX), `,`,
+  float(LowerLeftX), &amp;quot;,&amp;quot;,
+  float(LowerLeftY), &amp;quot;,&amp;quot;,
+  float(UpperRightX), &amp;quot;,&amp;quot;,
   float(UpperRightY).
 
 
@@ -414,4 +416,3 @@ style(node, wedged).
 
 
 % @tbd viewPort
-
diff --git a/gv_attrs.pl b/gv_attrs.pl
index faf496c..649ef9c 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -2,15 +2,17 @@
   gv_attrs,
   [
     gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
-              % +Attr1:nvpair
-              % +Attr2:nvpair
+              % +Attribute1:nvpair
+              % -Attribute2:nvpair
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz attributes v2
+/** &amp;lt;module&amp;gt; GraphViz: Attributes
+
+Support for GraphViz attributes.
 
 @author Wouter Beek
-@version 2014/06
+@version 2014/06, 2014/11
 */
 
 :- use_module(library(apply)).
@@ -19,9 +21,11 @@
 
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
+:- use_module(os(file_gnu)).
 
+:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generic)).
+:- use_module(plDcg(dcg_generics)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
@@ -54,24 +58,40 @@
 
 
 
+%! gv_attr(
+%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
+%!   +Attribute1:nvpair,
+%!   +Attribute2:nvpair
+%! ) is det.
+% Uses the default value in case Value is uninstantiated.
+% Otherwise, performs a typecheck and converts the given value.
+
 gv_attr(Context, N=V, N=V):-
   var(V), !,
   gv_attr(N, UsedBy, _, V, _, _),
+  % Check validity of context.
   memberchk(Context, UsedBy).
 gv_attr(Context, N=V1, N=V2):-
   gv_attr(N, UsedBy, Types, _, Minimum, _),
+  % Check validity of context.
   memberchk(Context, UsedBy),
+  % Check validity of value type.
   member(Type, Types),
-  (
-    Type == style
-  -&amp;gt;
-    Dcg =.. [Type,Context,V1]
-  ;
-    Dcg =.. [Type,V1]
+  (   Type == style
+  -&amp;gt;  Dcg =.. [Type,Context,V1]
+  ;   Dcg =.. [Type,V1]
   ),
   once(dcg_phrase(Dcg, V2)),
+  % Check validity of Value w.r.t. minimum value -- if available.
   check_minimum(V1, Minimum).
 
+
+
+% HELPERS
+
+%! check_minimum(+Value:atom, +Minimum:number) is semidet.
+% Trivially succeeds if no minimum value is available for a given attribute.
+
 check_minimum(_, &#39;&#39;):- !.
 check_minimum(V, Min1):-
   atom_number(Min1, Min2),
diff --git a/gv_color.pl b/gv_color.pl
index cb0cf8c..c48817c 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -13,27 +13,27 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06
+@version 2014/06, 2014/10-2014/11
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists)).
+:- use_module(library(lists), except([delete/3])).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
+:- use_module(os(file_gnu)).
 
+:- use_module(plDcg(abnf_core_rules)).
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg_rfc(rfc2616_basic)).
 
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
-:- use_module(plSparql_parse(sparql_char)).
-
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
@@ -51,10 +51,10 @@
 %   3. `hsv(Hue:between(0.0,1.0),Saturation:between(0.0,1.0),Value:between(0.0,1.0))`
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
-  `#`,
+  &amp;quot;#&amp;quot;,
   &#39;#&#39;(3, hex_color, [Red,Green,Blue], []).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
-  `#`,
+  &amp;quot;#&amp;quot;,
   &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha], []).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
   &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
@@ -82,7 +82,7 @@ wc(Color-Float) --&amp;gt;
   &#39;?&#39;(wc_weight(Float), []).
 
 wc_weight(Float) --&amp;gt;
-  `;`,
+  &amp;quot;;&amp;quot;,
   float(Float).
 
 
diff --git a/gv_dot.pl b/gv_dot.pl
index accd5bd..e67c469 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +GraphTerm:compound
+    gv_graph//1 % +Gif:compound
   ]
 ).
 
@@ -19,14 +19,17 @@ In GraphViz vertices are called &#39;nodes&#39;.
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists)).
+:- use_module(library(lists), except([delete/3])).
 :- use_module(library(ordsets)).
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_arrow)).
 :- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_bracket)).
 :- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generic)).
+:- use_module(plDcg(dcg_generics)).
 :- use_module(plDcg(dcg_meta)).
+:- use_module(plDcg(dcg_quote)).
 
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
@@ -39,7 +42,7 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % We assume that the attribute has already been validated.
 
 gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), `=`, gv_id(Val), `;`.
+  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
 
 
 %! gv_attribute_list(
@@ -47,10 +50,10 @@ gv_attribute(Name=Val) --&amp;gt;
 %!   +GraphAttributes:list(nvpair),
 %!   +Attributes:list(nvpair)
 %! )// .
-% ~~~{.abnf}
+% ```abnf
 % attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
 % a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
-% ~~~
+% ```
 
 % Attributes occur between square brackets.
 gv_attribute_list(Context, _, Attrs1) --&amp;gt;
@@ -59,20 +62,20 @@ gv_attribute_list(Context, _, Attrs1) --&amp;gt;
 
 
 %! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
-% ~~~
+% ```
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
-% ~~~
+% ```
 
-gv_compass_pt(&#39;_&#39;) --&amp;gt; `_`.
-gv_compass_pt(c) --&amp;gt; `c`.
-gv_compass_pt(e) --&amp;gt; `e`.
-gv_compass_pt(n) --&amp;gt; `n`.
-gv_compass_pt(ne) --&amp;gt; `ne`.
-gv_compass_pt(nw) --&amp;gt; `nw`.
-gv_compass_pt(s) --&amp;gt; `s`.
-gv_compass_pt(se) --&amp;gt; `se`.
-gv_compass_pt(sw) --&amp;gt; `sw`.
-gv_compass_pt(w) --&amp;gt; `w`.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
+gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
+gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
+gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
+gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
+gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
+gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
+gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
+gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
+gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 
 
 %! gv_edge_operator(+Directed:boolean)// .
@@ -83,7 +86,7 @@ gv_compass_pt(w) --&amp;gt; `w`.
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %                   undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, `--`.
+gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
@@ -107,11 +110,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), ` `,
+  gv_node_id(FromId), &amp;quot; &amp;quot;,
 
-  gv_edge_operator(Directed), ` `,
+  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
 
-  gv_node_id(ToId), ` `,
+  gv_node_id(ToId), &amp;quot; &amp;quot;,
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
@@ -133,18 +136,18 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 % @arg GraphAttributes A list of name-value pairs.
 % @arg CategoryAttributes A list of name-value pairs.
 %
-% ~~~
+% ```
 % attr_stmt = (graph / node / edge) attr_list
-% ~~~
+% ```
 
 gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
   indent(I),
-  gv_kind(Kind), ` `,
+  gv_kind(Kind), &amp;quot; &amp;quot;,
   gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
 
 
-%! gv_graph(+GraphTerm:compound)//
+%! gv_graph(+Gif:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -156,19 +159,19 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 %      they are ignored in the input file.
 %      Only in combinattion with directionality `directed`.
 %
-% ~~~{.abnf}
+% ```abnf
 % graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
-% ~~~
+% ```
 %
 % `GraphTerm` is a compound term of the following form:
-% ~~~{.pl}
+% ```prolog
 % graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
-% ~~~
+% ```
 %
 % `RankedVertexTerms` is a list of compound terms of the following form:
-% ~~~{.pl}
+% ```prolog
 % rank(RankNode,ContentNodes)
-% ~~~
+% ```
 %
 % @tbd Add support for subgraphs (arbitrary nesting).
 % @tbd Add support for escape strings:
@@ -176,10 +179,10 @@ gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(graph(VTerms, ETerms, GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms, [], ETerms, GAttrs)).
+gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
+  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
 
-gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
+gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
   {
     shared_attributes(VTerms, SharedVAttrs, NewVTerms),
     shared_attributes(ETerms, SharedEAttrs, NewETerms),
@@ -194,8 +197,8 @@ gv_graph(graph(VTerms, RankedVTerms, ETerms, GAttrs1)) --&amp;gt;
   % States that this file represents a graph according to the GraphViz format.
   indent(I),
   gv_strict(Strict),
-  gv_graph_type(Directed), ` `,
-  gv_id(GName), ` `,
+  gv_graph_type(Directed), &amp;quot; &amp;quot;,
+  gv_id(GName), &amp;quot; &amp;quot;,
 
   % The body of the DOT file appears between curly braces.
   bracketed(
@@ -240,18 +243,18 @@ gv_graph0(
       (NewVTerms == [], RankedVTerms == [])
     }
   -&amp;gt;
-    ``
+    &amp;quot;&amp;quot;
   ;
     line_feed
   ),
 
   % The list of GraphViz nodes.
   &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; `` ; line_feed),
+  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
   &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; `` ; line_feed),
+  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   {
     findall(
@@ -281,8 +284,8 @@ gv_graph0(
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; `graph`.
-gv_graph_type(true) --&amp;gt; `digraph`.
+gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 
 
 %! gv_id(?Atom:atom)// is det.
@@ -305,8 +308,9 @@ gv_graph_type(true) --&amp;gt; `digraph`.
 %      This requires an XML grammar!
 
 % HTML strings (variant 4).
-gv_id(Atom) --&amp;gt;
-  dcg_atom_codes(gv_html_like_label, Atom), !.
+gv_id(Content) --&amp;gt;
+  {compound(Content)}, !,
+  gv_html_like_label(Content).
 % Alpha-numeric strings (variant 1).
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -330,14 +334,16 @@ gv_id(Atom) --&amp;gt;
 % Double-quoted strings (variant 3).
 % The quotes are not in the given atom. They are written anyway.
 gv_id(Atom) --&amp;gt;
-  quoted(double_quote, dcg_atom_codes(gv_quoted_string, Atom)), !.
+  quoted(dcg_atom_codes(gv_quoted_string, Atom)), !.
 
-gv_id_first(X) --&amp;gt; ascii_letter(X).
+gv_id_first(X) --&amp;gt; letter(X).
 gv_id_first(X) --&amp;gt; underscore(X).
 
 gv_id_rest([]) --&amp;gt; [].
 gv_id_rest([H|T]) --&amp;gt;
-  (ascii_alpha_numeric(H) ; underscore(H)),
+  (   alpha_numeric(H)
+  ;   underscore(H)
+  ),
   gv_id_rest(T).
 
 
@@ -353,19 +359,19 @@ gv_keyword(Codes):-
 % GraphViz has reserved keywords that cannot be used as identifiers.
 % GraphViz keywords are case-insensitive.
 
-gv_keyword --&amp;gt; `digraph`.
-gv_keyword --&amp;gt; `edge`.
-gv_keyword --&amp;gt; `graph`.
-gv_keyword --&amp;gt; `node`.
-gv_keyword --&amp;gt; `strict`.
-gv_keyword --&amp;gt; `subgraph`.
+gv_keyword --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;node&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
+gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; `edge`.
-gv_kind(graph) --&amp;gt; `graph`.
-gv_kind(node) --&amp;gt; `node`.
+gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
 
 
 %! gv_node_id(+NodeId:atom)// .
@@ -392,7 +398,7 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), ` `,
+  gv_node_id(Id), &amp;quot; &amp;quot;,
   gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
 
 
@@ -403,23 +409,23 @@ gv_port --&amp;gt;
   gv_port_angle,
   &#39;?&#39;(gv_port_location, []).
 gv_port --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_compass_pt(_).
 
 gv_port_angle --&amp;gt;
-  `@`,
+  &amp;quot;@&amp;quot;,
   gv_id(_).
 
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   gv_id(_).
 gv_port_location --&amp;gt;
-  `:`,
+  &amp;quot;:&amp;quot;,
   bracketed(
     round,
     (
       gv_id(_),
-      `,`,
+      &amp;quot;,&amp;quot;,
       gv_id(_)
     )
   ).
@@ -436,7 +442,7 @@ gv_quoted_string([92,34|T]) --&amp;gt; !,
   gv_quoted_string(T).
 % Add the backslash escape character.
 gv_quoted_string([34|T]) --&amp;gt; !,
-  `\\\&amp;quot;`,
+  &amp;quot;\\\&amp;quot;&amp;quot;,
   gv_quoted_string(T).
 % All other characters are allowed without escaping.
 gv_quoted_string([H|T]) --&amp;gt;
@@ -455,14 +461,14 @@ gv_ranked_node_collection(
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), `;`, line_feed,
+    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
 
     &#39;*&#39;(
       gv_node_statement(NewI, GraphAttrs),
       [Rank_V_Term|Content_V_Terms],
       []
     ),
-    
+
     % We want to indent the closing curly brace.
     indent(I)
   )),
@@ -475,7 +481,7 @@ gv_ranked_node_collection(
 % This only applies to directed graphs.
 
 gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; `strict `.
+gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
 
 
 
diff --git a/gv_file.pl b/gv_file.pl
index bba87f9..704e2d4 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -9,9 +9,6 @@
     gif_to_gv_file/3, % +GraphInterchangeFormat:compound
                       % ?ToFile:atom
                       % +Options:list(nvpair)
-    gif_to_svg_dom/3, % +GraphInterchangeFormat:compound
-                      % -SvgDom:list(compound)
-                      % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -30,13 +27,11 @@ and GraphViz output files or SVG DOM structures.
 
 :- use_module(library(option)).
 :- use_module(library(process)).
-:- use_module(library(predicate_options)). % Declarations.
 
-:- use_module(generics(codes_ext)).
+:- use_module(generics(code_ext)).
 :- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
-:- use_module(svg(svg_file)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -136,15 +131,12 @@ file_to_gv(FromFile, ToFile, Options):-
   prolog_file_type(ToExtension, graphviz_output), !,
 
   % The output file is either given or created.
-  (
-    var(ToFile)
-  -&amp;gt;
-    user:prolog_file_type(ToExtension, ToFileType),
-    file_alternative(FromFile, _, _, ToExtension, ToFile)
-  ;
-    is_absolute_file_name(ToFile),
-    % The given output file must match a certain file extension.
-    file_name_extension(_, ToExtension, ToFile)
+  (   var(ToFile)
+  -&amp;gt;  user:prolog_file_type(ToExtension, ToFileType),
+      file_alternative(FromFile, _, _, ToExtension, ToFile)
+  ;   is_absolute_file_name(ToFile),
+      % The given output file must match a certain file extension.
+      file_name_extension(_, ToExtension, ToFile)
   ),
   % Now that we have the output file we can prevent the
   % file type / file extension translation predicates from bakctracking.
@@ -154,6 +146,8 @@ file_to_gv(FromFile, ToFile, Options):-
   format(atom(OutputType), &#39;-T~w&#39;, [ToExtension]),
   process_create(
     path(Method),
+    % @tbd Windows hack:
+    %%%%&#39;C:\\Program Files (x86)\\Graphviz2.38\\bin\\dot.exe&#39;,
     [OutputType,FromFile,&#39;-o&#39;,ToFile],
     [process(PID)]
   ),
@@ -177,20 +171,6 @@ gif_to_gv_file(Gif, ToFile, Options):-
   codes_to_gv_file(Codes, ToFile, Options).
 
 
-%! gif_to_svg_dom(
-%!   +GraphInterchangeFormat:compound,
-%!   -SvgDom:list(compound),
-%!   +Options:list(nvpair)
-%! ) is det.
-
-gif_to_svg_dom(Gif, SvgDom, Options1):-
-  % Make sure the file type of the output file is SvgDom.
-  merge_options([to_file_type=svg], Options1, Options2),
-  gif_to_gv_file(Gif, ToFile, Options2),
-  file_to_svg(ToFile, SvgDom),
-  delete_file(ToFile).
-
-
 %! open_dot(+File:atom) is det.
 % Opens the given DOT file.
 %
diff --git a/gv_html.pl b/gv_html.pl
index 3f0b08b..08306f0 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -1,60 +1,224 @@
 :- module(
   gv_html,
   [
-    gv_html_like_label//1 % +Codes:list(code)
+    gv_html_like_label//1 % +Content:compound
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz HTML
+/** &amp;lt;module&amp;gt; GraphViz: HTML-like labels
+
+Grammar taken from the GraphViz Web site:
+
+```
+label :   text
+        | table
+text :   textitem
+       | text textitem
+textitem :   string
+           | &amp;lt;BR/&amp;gt;
+           | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+           | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+           | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+           | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+           | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+           | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+           | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+           | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+rows :   row
+       | rows row
+       | rows &amp;lt;HR/&amp;gt; row
+row: &amp;lt;TR&amp;gt; cells &amp;lt;/TR&amp;gt;
+cells :   cell
+        | cells cell
+        | cells &amp;lt;VR/&amp;gt; cell
+cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
+      | &amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
+```
 
 @author Wouter Beek
-@version 2013/07, 2013/09, 2014/03-2014/06
+@see http://www.graphviz.org/content/node-shapes#html
+@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_bracket)).
 :- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
 
 
-%! gv_html_label(+Codes:list(code))// .
+%! gv_html_like_label(?Content:compound)// .
+
+gv_html_like_label(Content) --&amp;gt;
+  bracketed(angular, label(Content)).
+
+
+%! cell(?Contents:compound)// .
+% Supported attributes for TD:
+% ```
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
+% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLSPAN=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWSPAN=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ```
 %
-% @see http://www.graphviz.org/doc/info/shapes.html#html
-
-gv_html_label --&amp;gt; gv_html_text, !.
-gv_html_label --&amp;gt; gv_html_table, !.
-gv_html_label --&amp;gt; [].
-
-gv_html_like_label --&amp;gt; bracketed(angular, gv_html_label).
-
-gv_html_like_label(Content) --&amp;gt; bracketed(angular, html_dcg(Content)).
-
-gv_html_table --&amp;gt; html_element(table, _, gv_html_rows).
-gv_html_table --&amp;gt; html_element(font, _, html_element(table, _, gv_html_rows)).
-
-gv_html_rows --&amp;gt; gv_html_row, gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row, html_element(hr, _), gv_html_rows.
-gv_html_rows --&amp;gt; gv_html_row.
-
-gv_html_row --&amp;gt; html_element(tr, _, gv_html_cells).
-
-gv_html_cell --&amp;gt; html_element(td, _, gv_html_label).
-gv_html_cell --&amp;gt; html_element(td, _, html_element(img, _)).
-
-gv_html_cells --&amp;gt; gv_html_cell, gv_html_cells.
-gv_html_cells --&amp;gt; gv_html_cell.
-gv_html_cells --&amp;gt; gv_html_cell, html_element(vr, _), gv_html_cells.
-
-gv_html_text --&amp;gt; gv_html_textitem, gv_html_text.
-gv_html_text --&amp;gt; gv_html_textitem.
-
-gv_html_textitem --&amp;gt; html_string, !.
-gv_html_textitem --&amp;gt; html_entity, !.
-gv_html_textitem --&amp;gt; html_element(br, _), !.
-gv_html_textitem --&amp;gt; html_element(font, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(i, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(b, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(u, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sub, _, gv_html_text), !.
-gv_html_textitem --&amp;gt; html_element(sup, _, gv_html_text), !.
-
+% Supported attributes for IMG:
+% ```
+% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
+% SRC=&amp;quot;value&amp;quot;
+% ```
+
+cell(td(Contents)) --&amp;gt;
+  html_element(td, [], label(Contents)).
+cell(td(img)) --&amp;gt;
+  html_element(td, [], html_element(img)).
+
+
+%! cells(?Contents:list(compound))// .
+
+cells([H|T]) --&amp;gt;
+  cell(H),
+  cells(T).
+cells([H,vr|T]) --&amp;gt;
+  cell(H),
+  html_element(vr),
+  cells(T).
+cells([H]) --&amp;gt;
+  cell(H).
+
+
+%! label(?Content:compound)// .
+% GraphViz HTML-like label.
+
+label(Content) --&amp;gt;
+  text(Content).
+label(Content) --&amp;gt;
+  table(Content).
+
+
+%! row(?Contents:compound)// .
+
+row(tr(Contents)) --&amp;gt;
+  html_element(tr, [], cell(Contents)).
+
+
+%! rows(?Contents:list)// .
+
+rows([H|T]) --&amp;gt;
+  row(H),
+  rows(T).
+rows([H,hr|T]) --&amp;gt;
+  row(H),
+  html_element(hr),
+  rows(T).
+rows([H]) --&amp;gt;
+  row(H).
+
+
+%! table(?Contents:compound)// .
+% Supported attributes for TABLE:
+% ```
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% BGCOLOR=&amp;quot;color&amp;quot;
+% BORDER=&amp;quot;value&amp;quot;
+% CELLBORDER=&amp;quot;value&amp;quot;
+% CELLPADDING=&amp;quot;value&amp;quot;
+% CELLSPACING=&amp;quot;value&amp;quot;
+% COLOR=&amp;quot;color&amp;quot;
+% COLUMNS=&amp;quot;value&amp;quot;
+% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
+% GRADIENTANGLE=&amp;quot;value&amp;quot;
+% HEIGHT=&amp;quot;value&amp;quot;
+% HREF=&amp;quot;value&amp;quot;
+% ID=&amp;quot;value&amp;quot;
+% PORT=&amp;quot;portName&amp;quot;
+% ROWS=&amp;quot;value&amp;quot;
+% SIDES=&amp;quot;value&amp;quot;
+% STYLE=&amp;quot;value&amp;quot;
+% TARGET=&amp;quot;value&amp;quot;
+% TITLE=&amp;quot;value&amp;quot;
+% TOOLTIP=&amp;quot;value&amp;quot;
+% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
+% WIDTH=&amp;quot;value&amp;quot;
+% ```
+%
+% Supported attributes for FONT:
+% ```
+% COLOR=&amp;quot;color&amp;quot;
+% FACE=&amp;quot;fontname&amp;quot;
+% POINT-SIZE=&amp;quot;value&amp;quot;
+% ```
+
+table(table(Attrs,Contents)) --&amp;gt;
+  html_element(table, Attrs, rows(Contents)).
+table(table(font(Contents))) --&amp;gt;
+  html_element(font, [], html_element(table, [], rows(Contents))).
+
+
+%! text(?Contents:list)// .
+
+text(Contents) --&amp;gt;
+  &#39;+&#39;(textitem, Contents, []).
+
+
+%! textitem(?Content)// .
+% Supported attributes for BR:
+% ```
+% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
+% ```
+
+textitem(string(String)) --&amp;gt;
+  html_string(String).
+textitem(entity(Name)) --&amp;gt;
+  html_entity(Name).
+textitem(br(Attrs)) --&amp;gt;
+  html_element(br, Attrs).
+textitem(Compound) --&amp;gt;
+  {var(Compound)}, !,
+  html_element(Name, _, text(Content)),
+  {
+    supported_html_element(Name),
+    Compound =.. [Name,Content]
+  }.
+textitem(Compound) --&amp;gt;
+  {
+    Compound =.. [Name,Content],
+    supported_html_element(Name)
+  },
+  html_element(Name, _, text(Content)).
+
+
+
+% HELPERS
+
+%! supported_html_element(+Name:atom) is semidet.
+%! supported_html_element(-Name:atom) is multi.
+
+supported_html_element(b).
+supported_html_element(font).
+supported_html_element(i).
+supported_html_element(o).
+supported_html_element(s).
+supported_html_element(sub).
+supported_html_element(sup).
+supported_html_element(u).
diff --git a/gv_numeral.pl b/gv_numeral.pl
index 7870eb1..c115372 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -14,59 +14,67 @@
 :- use_module(math(math_ext)).
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_cardinal)).
 
 
 
 %! gv_numeral(?Value:number)// .
-% ~~~{.bnf}
+%
+% # Syntax
+%
+% ```bnf
 % (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
-% ~~~
+% ```
+%
+% ## Generation
+%
+% In the generative case, three notations are allowed (also see below):
+%   1. (non-zero integer-part)
+%   2. (decimal-separator) (non-zero fractional)
+%   3. (non-zero integer-part) (decimal-separator) (non-zero fractional)
+%
+% The following notations are explicitly excluded due to verbosity:
+%   - (non-zero integer-part) (decimal-separator)
+%   - (non-zero integer-part) (decimal-separator) (zero fractional)
+%   - (zero integer-part) (decimal-separator) (non-zero fractional)
+%
+% The following notations are also excluded, but since they violate
+%  well-formedness:
+%   - (non-zero integer-part) (non-zero fractional)
+%   - (decimal-separator)
 
 gv_numeral(N) --&amp;gt;
-  {nonvar(N)},
-  {number_sign_parts(N, Sign, Abs)},
-  ({Sign =:= -1} -&amp;gt; `-` ; ``),
-  gv_numeral_abs(Abs).
+  {var(N)}, !,
+  sign(Sign),
+  (   &amp;quot;.&amp;quot;,
+      &#39;+&#39;(decimal_digit, Fractional, [convert1(weights_decimal)]),
+      {IntegerPart = 0}
+  ;   &#39;+&#39;(decimal_digit, IntegerPart, [convert1(weights_decimal)]),
+      (   &amp;quot;.&amp;quot;,
+          &#39;*&#39;(decimal_digit, Fractional, [convert1(weights_decimal)])
+      ;   {Fractional = 0}
+      )
+  ),
+  {   number_integer_parts(UnsignedN, IntegerPart, Fractional),
+      N is copysign(UnsignedN, Sign)
+  }.
 gv_numeral(N) --&amp;gt;
-  {var(N)},
-  &#39;sign?&#39;(Sign),
-  gv_numeral_abs(Abs),
-  {number_sign_parts(N, Sign, Abs)}.
-
-
-gv_numeral_abs(N) --&amp;gt;
-  {nonvar(N)},
-  {number_integer_parts(N, N1, N2)},
-  (
-    {N2 =:= 0}
-  -&amp;gt;
-    integer(N1)
-  ;
-    {N1 =:= 0}
-  -&amp;gt;
-    `.`,
-    integer(N2)
-  ;
-    integer(N1),
-    &#39;?&#39;((`.`, &#39;integer?&#39;(N2)), [])
+  {number_sign_parts(N, Sign, UnsignedN)},
+  sign(Sign),
+  {number_integer_parts(UnsignedN, IntegerPart, Fractional)},
+  (   % [1] The fractional is zero, so only write the integer part
+      %     and do not write the decimal separator.
+      {Fractional =:= 0}
+  -&amp;gt;  integer(IntegerPart)
+  ;   % [2] The integer part is zero, so only write the fractional part,
+      %     preceded by the decimal separator.
+      {IntegerPart =:= 0}
+  -&amp;gt;  &amp;quot;.&amp;quot;,
+      integer(Fractional)
+  ;   % [3] Both the integer part and the fractional are non-zero,
+      %     so write both of them, with the decimal separator in-between.
+      integer(IntegerPart),
+      &amp;quot;.&amp;quot;,
+      integer(Fractional)
   ).
-gv_numeral_abs(N) --&amp;gt;
-  {var(N)},
-  (
-    `.`,
-    integer(N2)
-  -&amp;gt;
-    {N1 = 0}
-  ;
-    integer(N1),
-    (
-      `.`
-    -&amp;gt;
-      &#39;integer?&#39;(N2)
-    ;
-      {N2 = 0}
-    )
-  ),
-  {number_integer_parts(N, N1, N2)}.
-
diff --git a/load.pl b/load.pl
index 4b117d1..5cec32c 100644
--- a/load.pl
+++ b/load.pl
@@ -1,12 +1,14 @@
-% Load file for plGraphViz.
+% Load file for the plGraphViz library.
 
-:- dynamic(user:prolog/3).
-:- multifile(user:prolog/3).
-   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;, plGraphViz).
+:- dynamic(user:project/2).
+:- multifile(user:project/2).
+   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;).
 
 :- use_module(load_project).
-:- load_project(plGraphViz, [
+:- load_project([
     plc-&#39;Prolog-Library-Collection&#39;,
-    plHtml
+    plDcg,
+    plHtml,
+    plUri
 ]).
 
diff --git a/plDcg b/plDcg
new file mode 160000
index 0000000..ad6c88a
--- /dev/null
+++ b/plDcg
@@ -0,0 +1 @@
+Subproject commit ad6c88a86234c50ffb31bdbfd50edf5709654f75
diff --git a/plHtml b/plHtml
index 18e657b..f96e87b 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 18e657b22a84d5e98a317ddec58314964ff68bcd
+Subproject commit f96e87bb4e4fa525f5e84814914834625ac9f715
diff --git a/plUri b/plUri
new file mode 160000
index 0000000..ec0a88e
--- /dev/null
+++ b/plUri
@@ -0,0 +1 @@
+Subproject commit ec0a88e1040ea624b09904f9a76c258775e98bff
diff --git a/run.pl b/run.pl
new file mode 100644
index 0000000..8bba736
--- /dev/null
+++ b/run.pl
@@ -0,0 +1,9 @@
+% Standalone execution of the plGraphViz library.
+
+:- if(current_prolog_flag(argv, [&#39;--debug&#39;|_])).
+  :- ensure_loaded(debug).
+:- else.
+  :- set_prolog_flag(verbose, silent).
+  :- ensure_loaded(load).
+:- endif.
+
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;55&#34;&gt; 55: 正在比较变动前 dbc602d 和变动后 a2456df &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_color.pl b/gv_color.pl
index c48817c..0510f98 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -22,6 +22,7 @@
 :- use_module(library(xpath)).
 
 :- use_module(generics(db_ext)).
+:- use_module(generics(persistent_db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(os(file_gnu)).
 
@@ -121,9 +122,7 @@ gv_color_file(File):-
 
 gv_color_init:-
   gv_color_file(File),
-  safe_db_attach(File),
-  file_age(File, Age),
-  gv_color_update(Age).
+  persistent_db_init(File, gv_color_update).
 
 
 %! gv_color_update(+Age:float) is det.
diff --git a/plHtml b/plHtml
index f96e87b..c98f740 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit f96e87bb4e4fa525f5e84814914834625ac9f715
+Subproject commit c98f740d593fff74bfa3cf3d08af13c857daa899
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;56&#34;&gt; 56: 正在比较变动前 a2456df 和变动后 20c6017 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index c115372..d36fa59 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -61,7 +61,7 @@ gv_numeral(N) --&amp;gt;
   }.
 gv_numeral(N) --&amp;gt;
   {number_sign_parts(N, Sign, UnsignedN)},
-  sign(Sign),
+  sign_negative(Sign),
   {number_integer_parts(UnsignedN, IntegerPart, Fractional)},
   (   % [1] The fractional is zero, so only write the integer part
       %     and do not write the decimal separator.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;57&#34;&gt; 57: 正在比较变动前 20c6017 和变动后 f694d77 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 2774ee9..58f43f0 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 2774ee9cba6ac2353150322c744e65857634e575
+Subproject commit 58f43f0e2fca088206582a18b868fe85a7603432
diff --git a/plDcg b/plDcg
index ad6c88a..c61080f 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit ad6c88a86234c50ffb31bdbfd50edf5709654f75
+Subproject commit c61080f3d8df6ba6d48b0d70f5ba52047c8cbd29
diff --git a/plUri b/plUri
index ec0a88e..66a7652 160000
--- a/plUri
+++ b/plUri
@@ -1 +1 @@
-Subproject commit ec0a88e1040ea624b09904f9a76c258775e98bff
+Subproject commit 66a7652bc1ab6a4dc1fc790b09894d6c51d42dcf
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;58&#34;&gt; 58: 正在比较变动前 f694d77 和变动后 af5d96d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 58f43f0..1b264ab 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 58f43f0e2fca088206582a18b868fe85a7603432
+Subproject commit 1b264ab8b668b44035c96f320f8798f7940ad2fa
diff --git a/README.md b/README.md
index 3c9e9cf..f89c694 100644
--- a/README.md
+++ b/README.md
@@ -1,8 +1,113 @@
 plGraphViz
 ==========
 
-Export graphs represented as Prolog terms to
+Easily export graphs represented as Prolog terms to
  [GraphViz](http://www.graphviz.org/).
 
-Author: [Wouter Beek](http://www.wouterbeek.com)
+### Example
+
+~~~prolog
+$ swipl run.pl
+?- use_module(plGraphViz(gv_file)).
+?- graph_to_gv_file(
+     graph([vertex(1,[]),vertex(2,[])],[edge(1,2,[])],[]),
+     File,
+     [method(sfdp),output(png)]
+   ).
+   File = &#39;PATH/plGraphViz/data/tmp.png&#39;
+~~~
+
+The graphic can be saved to a different file by instantiating
+ the `File` argument.
+
+![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example1.png &amp;quot;Example graph.&amp;quot;)
+
+---
+
+### Method option
+
+Option `method(+atom)` sets the drawing method that is used by GraphViz
+ to place the vertices and edges.
+The following values are supported.
+
+| **Value**       | **Description**         |
+| `circo`         | Circular layout.        |
+| `dot` (default) | Directed graph.         |
+| `fdp`           | Undirected graph.       |
+| `neato`         | Undirected graph.       |
+| `osage`         | Tree map.               |
+| `sfdp`          | Large undirected graph. |
+| `twopi`         | Radical layouts.        |
+
+---
+
+### Output type option
+
+Option `output(+atom)` sets the type of file the graph is written to.
+The following values are supported.
+
+| **Value**             | **Description**                       |
+|:---------------------:|:--------------------------------------|
+| `bmp`                 | Windows Bitmap Format                 |
+| `canon`               |                                       |
+| `dot`                 |                                       |
+| `gv`,  `xdot`, `xdot1.2`, `xdot1.4` | DOT                     |
+| `cgimage`             | CGImage bitmap format                 |
+| `cmap`                | Client-side imagemap (deprecated)     |
+| `eps`                 | Encapsulated PostScript               |
+| `exr`                 | OpenEXR                               |
+| `fig`                 |                                       |
+| `gd`, `gd2`           | GD/GD2 formats                        |
+| `gif`                 |                                       |
+| `gtk`                 | GTK canvas                            |
+| `ico`                 | Icon Image File Format                |
+| `imap`                |                                       |
+| `cmapx`               | Server-side and client-side imagemaps |
+| `imap_np`, `cmapx_np` | Server-side and client-side imagemaps |
+| `ismap`               | Server-side imagemap (deprecated)     |
+| `jp2`                 | JPEG 2000                             |
+| `jpg`, `jpeg`, `jpe`  | JPEG                                  |
+| `pct`, `pict`         | PICT                                  |
+| `pdf` (default)       | Portable Document Format (PDF)        |
+| `pic`                 | Kernighan&#39;s PIC graphics language     |
+| `plain`, `plain-ext`  | Simple text format                    |
+| `png`                 | Portable Network Graphics format      |
+| `pov`                 | POV-Ray markup language (prototype)   |
+| `ps`                  | PostScript                            |
+| `ps2`                 | PostScript for PDF                    |
+| `psd`                 | PSD                                   |
+| `sgi`                 | SGI                                   |
+| `svg`, `svgz`         | Scalable Vector Graphics              |
+| `tga`                 | Truevision TGA                        |
+| `tif`, `tiff`         | TIFF (Tag Image File Format)          |
+| `tk`                  | TK graphics                           |
+| `vml`, `vmlz`         | Vector Markup Language (VML)          |
+| `vrml`                | VRML                                  |
+| `wbmp`                | Wireless BitMap format                |
+| `webp`                | Image format for the Web              |
+| `xlib`, `x11`         | Xlib canvas                           |
+
+---
+
+### HTML-like labels
+
+Example of using HTML-like labels:
+
+~~~prolog
+graph_to_gv_file(
+  graph(
+    [vertex(1,[]),vertex(2,[label=html(table([tr([td(a),td(b)]),tr([td(c),td(d)])]))])],
+    [edge(1,2,[label=&#39;From 1 to 2.&#39;])],
+    []
+  ),
+  File,
+  []
+).
+~~~
+
+![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example2.png &amp;quot;Example graph with HTML-like labels.&amp;quot;)
+
+---
+
+Developed during 2013-2014 by [Wouter Beek](http://www.wouterbeek.com).
 
diff --git a/example1.png b/example1.png
new file mode 100644
index 0000000..31e7ba6
Binary files /dev/null and b/example1.png differ
diff --git a/example2.png b/example2.png
new file mode 100644
index 0000000..6e44b16
Binary files /dev/null and b/example2.png differ
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 30761bb..3237b4b 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -54,11 +54,14 @@
 :- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_quote)).
 
 :- use_module(plGraphViz(gv_html)).
 
 
 
+
+
 %! gv_attr_type(?Type:atom) is nondet.
 
 gv_attr_type(addDouble).
@@ -95,6 +98,7 @@ gv_attr_type(style).
 gv_attr_type(viewPort).
 
 
+
 %! addDouble(+Float:float)// .
 % An *addDouble* is represented by a Prolog float.
 
@@ -103,6 +107,7 @@ addDouble(Float) --&amp;gt;
   double(Float).
 
 
+
 %! addPoint(+Point:compound)// .
 % An *addPoint* is represented by a compound of the following form:
 % `point(X:float,Y:float,InputOnly:boolean)`.
@@ -112,6 +117,7 @@ addPoint(Point) --&amp;gt;
   point(Point).
 
 
+
 %! arrowType(+ArrowType:atom)// .
 
 arrowType(V) --&amp;gt;
@@ -149,12 +155,16 @@ backwards_compatible(invempty).
 backwards_compatible(open).
 
 
+
+%! bool(+Value:boolean)// .
+
 bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
 bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
 bool(true) --&amp;gt; &amp;quot;true&amp;quot;.
 bool(true) --&amp;gt; &amp;quot;yes&amp;quot;.
 
 
+
 %! clusterMode(+ClusterMode:atom)// .
 
 clusterMode(V) --&amp;gt;
@@ -166,6 +176,7 @@ clusterMode(local).
 clusterMode(none).
 
 
+
 %! dirType(+DirectionType:oneof([back,both,forward,none]))// .
 
 dirType(DirType) --&amp;gt;
@@ -178,44 +189,57 @@ dirType(forward).
 dirType(none).
 
 
+
+%! double(+Double:float)// .
+
 double(Double1) --&amp;gt;
   % float//1 will check for float type.
   {Double2 is Double1 * 1.0},
   float(Double2).
 
 
-doubleList([H|T]) --&amp;gt;
-  double(H),
-  &#39;*&#39;(doubleList1, T, []).
 
-doubleList1(Float) --&amp;gt;
-  &amp;quot;:&amp;quot;,
-  double(Float).
+%! doubleList(+Doubles:list(float))// .
+
+doubleList(L) --&amp;gt;
+  &#39;+&#39;(double, L, [separator(colon)]).
+
 
 
 %! escString(+String:atom)// .
 % @tbd Support for context-dependent replacements.
 
 escString(String) --&amp;gt;
-  atom(String).
+  quoted(atom(String)).
+
 
 
 % @tbd layerList
 
 
+
 % @tbd layerRange
 
 
+
+%! lblString(+String:compound)// .
+
+lblString(html(V)) --&amp;gt;
+  gv_html_like_label(V).
 lblString(V) --&amp;gt;
   escString(V).
-lblString(V) --&amp;gt;
-  gv_html_like_label(V).
 
 
+
+%! int(+Integer:integer)// .
+
 int(V) --&amp;gt;
   integer(V).
 
 
+
+%! outputMode(+OutputMode:atom)// .
+
 outputMode(V) --&amp;gt;
   {outputMode(V)},
   atom(V).
@@ -225,9 +249,13 @@ outputMode(edgesfirst).
 outputMode(nodesfirst).
 
 
+
 % @tbd packMode
 
 
+
+%! pagedir(+PageDirection:atom)// .
+
 pagedir(V) --&amp;gt;
   {pagedir(V)},
   atom(V).
@@ -242,6 +270,7 @@ pagedir(&#39;TL&#39;).
 pagedir(&#39;TR&#39;).
 
 
+
 %! point(+Point:compound)// .
 % A *point* is represented by a compound of the following form:
 % `point(X:float,Y:float,Changeable:boolean)`.
@@ -256,13 +285,20 @@ input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
 input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
 
 
+
+%! pointList(+Points:list(compound))// .
+
 pointList(Points) --&amp;gt;
   &#39;*&#39;(point, Points, []).
 
 
+
 % @tbd portPos
 
 
+
+%! quadType(+QuadType:atom)// .
+
 quadType(V) --&amp;gt;
   {quadType(V)},
   atom(V).
@@ -272,6 +308,9 @@ quadType(none).
 quadType(normal).
 
 
+
+%! rankType(+RankType:atom)// .
+
 rankType(V) --&amp;gt;
   {rankType(V)},
   atom(V).
@@ -283,6 +322,9 @@ rankType(sink).
 rankType(source).
 
 
+
+%! rankdir(+RankDirection:atom)// .
+
 rankdir(V) --&amp;gt;
   {rankdir(V)},
   atom(V).
@@ -293,6 +335,9 @@ rankdir(&#39;RL&#39;).
 rankdir(&#39;TB&#39;).
 
 
+
+%! rect(+Rectangle:compound)// .
+
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
   float(LowerLeftX), &amp;quot;,&amp;quot;,
   float(LowerLeftY), &amp;quot;,&amp;quot;,
@@ -300,6 +345,9 @@ rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
   float(UpperRightY).
 
 
+
+%! shape(+Shape:atom)// .
+
 shape(V) --&amp;gt;
   {polygon_based_shape(V)},
   atom(V).
@@ -361,6 +409,9 @@ polygon_based_shape(tripleoctagon).
 polygon_based_shape(utr).
 
 
+
+%! smoothType(+SmoothType:atom)// .
+
 smoothType(V) --&amp;gt;
   {smoothType(V)},
   atom(V).
@@ -374,19 +425,23 @@ smoothType(spring).
 smoothType(triangle).
 
 
+
 % @tbd splineType
 
 
+
 % @tbd startType
 
 
-%! string(?Content:atom)// .
+
+%! string(?String:atom)// .
 % A GraphViz string.
 
 string(Content) --&amp;gt;
   atom(Content).
 
 
+
 %! style(?Context:oneof([cluster,edge,node]), ?Style:atom) is nondet.
 
 style(Context, Style) --&amp;gt;
@@ -415,4 +470,5 @@ style(node, striped).
 style(node, wedged).
 
 
+
 % @tbd viewPort
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 649ef9c..e3ba03c 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -1,9 +1,8 @@
 :- module(
   gv_attrs,
   [
-    gv_attr/3 % +Context:oneof([cluster,edge,graph,node,subgraph])
-              % +Attribute1:nvpair
-              % -Attribute2:nvpair
+    gv_attr_value//2 % +Context:oneof([cluster,edge,graph,node,subgraph])
+               % +Attribute:nvpair
   ]
 ).
 
@@ -25,6 +24,7 @@ Support for GraphViz attributes.
 
 :- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_meta)).
 :- use_module(plDcg(dcg_generics)).
 
 :- use_module(plHtml(html)).
@@ -58,32 +58,45 @@ Support for GraphViz attributes.
 
 
 
-%! gv_attr(
+
+
+%! gv_attr_value(
 %!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +Attribute1:nvpair,
-%!   +Attribute2:nvpair
-%! ) is det.
+%!   +Attribute:nvpair
+%! )// is det.
 % Uses the default value in case Value is uninstantiated.
 % Otherwise, performs a typecheck and converts the given value.
 
-gv_attr(Context, N=V, N=V):-
-  var(V), !,
-  gv_attr(N, UsedBy, _, V, _, _),
-  % Check validity of context.
-  memberchk(Context, UsedBy).
-gv_attr(Context, N=V1, N=V2):-
-  gv_attr(N, UsedBy, Types, _, Minimum, _),
-  % Check validity of context.
-  memberchk(Context, UsedBy),
-  % Check validity of value type.
-  member(Type, Types),
-  (   Type == style
-  -&amp;gt;  Dcg =.. [Type,Context,V1]
-  ;   Dcg =.. [Type,V1]
-  ),
-  once(dcg_phrase(Dcg, V2)),
-  % Check validity of Value w.r.t. minimum value -- if available.
-  check_minimum(V1, Minimum).
+% Use the default if no value is given.
+gv_attr_value(Context, Name=Value) --&amp;gt;
+  {
+    var(Value), !,
+    gv_attr(Name, UsedBy, _, DefaultValue, _, _),
+    % Check validity of context.
+    memberchk(Context, UsedBy)
+  },
+  gv_attr_value(Context, Name=DefaultValue).
+gv_attr_value(Context, Name=Value) --&amp;gt;
+  {
+    % Check the validity of the context argument.
+    gv_attr(Name, UsedBy, Types, _, Minimum, _),
+    memberchk(Context, UsedBy),
+    
+    %  Pick a value type non-deterministically.
+    member(Type, Types),
+    
+    % The `style` type is the only one that requires the context argument.
+    (   Type == style
+    -&amp;gt;  Dcg =.. [Type,Context]
+    ;   Dcg =.. [Type]
+    ),
+    
+    % Check validity of Value w.r.t. minimum value -- if available.
+    check_minimum(Value, Minimum)
+  },
+  dcg_call(Dcg, Value).
+
+
 
 
 
diff --git a/gv_dot.pl b/gv_dot.pl
index e67c469..6db4451 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -13,9 +13,16 @@ Methods for writing to the GraphViz DOT format.
 
 In GraphViz vertices are called &#39;nodes&#39;.
 
+~~~abnf
+attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
+a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
+~~~
+
+---
+
 @author Wouter Beek
 @see http://www.graphviz.org/content/dot-language
-@version 2013/07, 2013/09, 2014/03-2014/06
+@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
 :- use_module(library(apply)).
@@ -37,28 +44,21 @@ In GraphViz vertices are called &#39;nodes&#39;.
 
 
 
-%! gv_attribute(+Attribute:nvpair)// is det.
-% A single GraphViz attribute.
-% We assume that the attribute has already been validated.
 
-gv_attribute(Name=Val) --&amp;gt;
-  gv_id(Name), &amp;quot;=&amp;quot;, gv_id(Val), &amp;quot;;&amp;quot;.
 
+%! gv_attr(
+%!   +Context:oneof([edge,graph,node]),
+%!   +Attribute:nvpair
+%! )// is det.
+% A single GraphViz attribute.
+% We assume that the attribute has already been validated.
 
-%! gv_attribute_list(
-%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +GraphAttributes:list(nvpair),
-%!   +Attributes:list(nvpair)
-%! )// .
-% ```abnf
-% attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
-% a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
-% ```
+gv_attr(Context, Name=Value) --&amp;gt;
+  gv_id(Name),
+  &amp;quot;=&amp;quot;,
+  gv_attr_value(Context, Name=Value),
+  &amp;quot;;&amp;quot;.
 
-% Attributes occur between square brackets.
-gv_attribute_list(Context, _, Attrs1) --&amp;gt;
-  {maplist(gv_attr(Context), Attrs1, Attrs2)},
-  bracketed(square, &#39;*&#39;(gv_attribute, Attrs2, [])).
 
 
 %! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
@@ -78,6 +78,7 @@ gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
 gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 
 
+
 %! gv_edge_operator(+Directed:boolean)// .
 % The binary edge operator between two vertices.
 % The operator that is used depends on whether the graph is directed or
@@ -90,10 +91,10 @@ gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
 gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 
+
 %! gv_edge_statement(
 %!   +Indent:nonneg,
 %!   +Directed:boolean,
-%!   +GraphAttributes:list(nvpair),
 %!   +EdgeTerm:compound
 %! )// is det.
 % A GraphViz statement describing an edge.
@@ -108,7 +109,7 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 %      at the from and/or to location.
 % @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
 
-gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
+gv_edge_statement(I, Directed, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
   gv_node_id(FromId), &amp;quot; &amp;quot;,
 
@@ -118,14 +119,14 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
-  gv_attribute_list(edge, GAttrs, EAttrs),
+  bracketed(square, &#39;*&#39;(gv_attr(edge), EAttrs, [])),
   line_feed.
 
 
+
 %! gv_generic_attributes_statement(
 %!   +Kind:oneof([edge,graph,node]),
 %!   +Indent:integer,
-%!   +GraphAttributes:list(nvpair),
 %!   +CategoryAttributes:list(nvpair)
 %! )//
 % A GraphViz statement describing generic attributes for a category of items.
@@ -140,11 +141,13 @@ gv_edge_statement(I, Directed, GAttrs, edge(FromId,ToId,EAttrs)) --&amp;gt;
 % attr_stmt = (graph / node / edge) attr_list
 % ```
 
-gv_generic_attributes_statement(_, _, _, []) --&amp;gt; [], !.
-gv_generic_attributes_statement(Kind, I, GraphAttrs, KindAttrs) --&amp;gt;
+gv_generic_attributes_statement(_, _, []) --&amp;gt; [], !.
+gv_generic_attributes_statement(Kind, I, KindAttrs) --&amp;gt;
   indent(I),
   gv_kind(Kind), &amp;quot; &amp;quot;,
-  gv_attribute_list(Kind, GraphAttrs, KindAttrs), line_feed.
+  bracketed(square, &#39;*&#39;(gv_attr(Kind), KindAttrs, [])),
+  line_feed.
+
 
 
 %! gv_graph(+Gif:compound)//
@@ -224,13 +227,13 @@ gv_graph0(
   {NewI is I + 1},
 
   % Attributes that apply to the graph as a whole.
-  gv_generic_attributes_statement(graph, NewI, GAttrs, GAttrs),
+  gv_generic_attributes_statement(graph, NewI, GAttrs),
 
   % Attributes that are the same for all nodes.
-  gv_generic_attributes_statement(node, NewI, GAttrs, SharedVAttrs),
+  gv_generic_attributes_statement(node, NewI, SharedVAttrs),
 
   % Attributes that are the same for all edges.
-  gv_generic_attributes_statement(edge, NewI, GAttrs, SharedEAttrs),
+  gv_generic_attributes_statement(edge, NewI, SharedEAttrs),
 
   % Only add a line_feed if some content was already written
   % and some content is about to be written.
@@ -249,19 +252,19 @@ gv_graph0(
   ),
 
   % The list of GraphViz nodes.
-  &#39;*&#39;(gv_node_statement(NewI, GAttrs), NewVTerms, []),
+  &#39;*&#39;(gv_node_statement(NewI), NewVTerms, []),
   ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   % The ranked GraphViz nodes (displayed at the same height).
-  &#39;*&#39;(gv_ranked_node_collection(NewI, GAttrs), RankedVTerms, []),
+  &#39;*&#39;(gv_ranked_node_collection(NewI), RankedVTerms, []),
   ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
 
   {
     findall(
       edge(FromId,ToId,[]),
       (
-        nth0(Index1, RankedVTerms, rank(vertex(FromId,_,_),_)),
-        nth0(Index2, RankedVTerms, rank(vertex(ToId,_,_),_)),
+        nth0(Index1, RankedVTerms, rank(vertex(FromId,_),_)),
+        nth0(Index2, RankedVTerms, rank(vertex(ToId,_),_)),
         % We assume that the rank vertices are nicely ordered.
         succ(Index1, Index2)
       ),
@@ -270,10 +273,10 @@ gv_graph0(
   },
 
   % The rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), RankEdges, []),
+  &#39;*&#39;(gv_edge_statement(NewI, Directed), RankEdges, []),
 
   % The non-rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed, GAttrs), NewETerms, []),
+  &#39;*&#39;(gv_edge_statement(NewI, Directed), NewETerms, []),
 
   % Note that we do not include a line_feed here.
 
@@ -281,6 +284,7 @@ gv_graph0(
   indent(I).
 
 
+
 %! gv_graph_type(+Directed:boolean)// .
 % The type of graph that is represented.
 
@@ -288,6 +292,7 @@ gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
 gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 
 
+
 %! gv_id(?Atom:atom)// is det.
 % Parse a GraphViz identifier.
 % There are 4 variants:
@@ -347,6 +352,7 @@ gv_id_rest([H|T]) --&amp;gt;
   gv_id_rest(T).
 
 
+
 %! gv_keyword(+Codes:list(code)) is semidet.
 % Succeeds if the given codes for a GraphViz reserved keyword.
 
@@ -367,6 +373,7 @@ gv_keyword --&amp;gt; &amp;quot;strict&amp;quot;.
 gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 
 
+
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
 gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
@@ -374,6 +381,7 @@ gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
 gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
 
 
+
 %! gv_node_id(+NodeId:atom)// .
 % GraphViz node identifiers can be of the following two types:
 %   1. A GraphViz identifier, see gv_id//1.
@@ -389,17 +397,16 @@ gv_node_id(Id) --&amp;gt;
 %  gv_port.
 
 
-%! gv_node_statement(
-%!   +Indent:integer,
-%!   +GraphAttributes,
-%!   +VertexTerm:compound
-%! )// .
+
+%! gv_node_statement(+Indent:nonneg, +VertexTerm:compound)// .
 % A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
 
-gv_node_statement(I, GraphAttrs, vertex(Id,_,VAttrs)) --&amp;gt;
+gv_node_statement(I, vertex(Id,VAttrs)) --&amp;gt;
   indent(I),
   gv_node_id(Id), &amp;quot; &amp;quot;,
-  gv_attribute_list(node, GraphAttrs, VAttrs), line_feed.
+  bracketed(square, &#39;*&#39;(gv_attr(node), VAttrs, [])),
+  line_feed.
+
 
 
 gv_port --&amp;gt;
@@ -431,6 +438,7 @@ gv_port_location --&amp;gt;
   ).
 
 
+
 gv_quoted_string([]) --&amp;gt; [].
 % Just to be sure, we do not allow the double quote
 % that closes the string to be escaped.
@@ -450,21 +458,22 @@ gv_quoted_string([H|T]) --&amp;gt;
   gv_quoted_string(T).
 
 
-gv_ranked_node_collection(
-  I,
-  GraphAttrs,
-  rank(Rank_V_Term,Content_V_Terms)
-) --&amp;gt;
+
+gv_ranked_node_collection(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
   indent(I),
   bracketed(curly, (
     line_feed,
 
     % The rank attribute.
     {NewI is I + 1},
-    indent(NewI), gv_attribute(rank=same), &amp;quot;;&amp;quot;, line_feed,
+    indent(NewI),
+    gv_attr(subgraph, rank=same),
+    &amp;quot;;&amp;quot;,
+    line_feed,
 
+    % Vertice statements.
     &#39;*&#39;(
-      gv_node_statement(NewI, GraphAttrs),
+      gv_node_statement(NewI),
       [Rank_V_Term|Content_V_Terms],
       []
     ),
@@ -475,6 +484,7 @@ gv_ranked_node_collection(
   line_feed.
 
 
+
 %! gv_strict(+Strict:boolean)// is det.
 % The keyword denoting that the graph is strict, i.e., has no self-arcs and
 % no multi-edges.
@@ -485,7 +495,9 @@ gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
 
 
 
-% Helpers
+
+
+% HELPERS
 
 add_default_nvpair(Attrs1, N, Default, Attrs2):-
   add_default_nvpair(Attrs1, N, Default, _, Attrs2).
@@ -508,12 +520,15 @@ extract_shared(Argss, Shared):-
 remove_shared_attributes(Shared, Args1, Args2):-
   ord_subtract(Args1, Shared, Args2).
 
-shared_attributes(Terms1, Shared, Terms2):-
-  maplist(term_components(Func), Terms1, Args1, Args2, Args3a),
-  extract_shared(Args3a, Shared),
-  maplist(remove_shared_attributes(Shared), Args3a, Args3b),
-  maplist(term_components(Func), Terms2, Args1, Args2, Args3b).
+shared_attributes(Terms1, SharedAs, Terms2):-
+  maplist(term_to_attrs, Terms1, As1),
+  extract_shared(As1, SharedAs),
+  maplist(remove_shared_attributes(SharedAs), As1, As2),
+  maplist(term_change_attrs, Terms1, As2, Terms2).
+
+term_change_attrs(edge(From,To,_), A, edge(From,To,A)).
+term_change_attrs(vertex(Id,_), A, vertex(Id,A)).
 
-term_components(Func, Term, Arg1, Arg2, Arg3):-
-  Term =.. [Func,Arg1,Arg2,Arg3].
+term_to_attrs(edge(_,_,A), A).
+term_to_attrs(vertex(_,A), A).
 
diff --git a/gv_file.pl b/gv_file.pl
index 704e2d4..a7901e4 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -1,14 +1,14 @@
 :- module(
   gv_file,
   [
-    file_to_gv/2, % +File:atom
+    file_to_gv/2, % +InputFile:atom
                   % +Options:list(nvpair)
-    file_to_gv/3, % +FromFile:atom
-                  % ?ToFile:atom
+    file_to_gv/3, % +InputFile:atom
+                  % ?OutputFile:atom
                   % +Options:list(nvpair)
-    gif_to_gv_file/3, % +GraphInterchangeFormat:compound
-                      % ?ToFile:atom
-                      % +Options:list(nvpair)
+    graph_to_gv_file/3, % +Graph:compound
+                        % ?OutputFile:atom
+                        % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -35,44 +35,6 @@ and GraphViz output files or SVG DOM structures.
 
 :- use_module(plGraphViz(gv_dot)).
 
-:- dynamic(user:file_type_program/2).
-:- multifile(user:file_type_program/2).
-
-:- dynamic(user:module_uses/2).
-:- multifile(user:module_uses/2).
-
-:- dynamic(user:prolog_file_type/2).
-:- multifile(user:prolog_file_type/2).
-
-% Register DOT.
-:- db_add_novel(user:prolog_file_type(dot, dot)).
-:- db_add_novel(user:prolog_file_type(dot, graphviz)).
-:- db_add_novel(user:file_type_program(dot, dotty)).
-:- db_add_novel(user:file_type_program(dot, dotx)).
-:- db_add_novel(user:module_uses(gv_file, file_type(dot))).
-
-% Register JPG/JPEG.
-:- db_add_novel(user:prolog_file_type(jpeg, jpeg)).
-:- db_add_novel(user:prolog_file_type(jpeg, graphviz_output)).
-:- db_add_novel(user:prolog_file_type(jpg, jpeg)).
-:- db_add_novel(user:prolog_file_type(jpg, graphviz_output)).
-
-% Register PDF.
-:- db_add_novel(user:prolog_file_type(pdf, pdf)).
-:- db_add_novel(user:prolog_file_type(pdf, graphviz_output)).
-
-% Register PNG.
-:- db_add_novel(user:prolog_file_type(png, png)).
-:- db_add_novel(user:prolog_file_type(png, graphviz_output)).
-
-% Register SVG.
-:- db_add_novel(user:prolog_file_type(svg, graphviz_output)).
-:- db_add_novel(user:prolog_file_type(svg, svg)).
-
-% Register XDOT.
-:- db_add_novel(user:prolog_file_type(xdot, graphviz_output)).
-:- db_add_novel(user:prolog_file_type(xdot, xdot)).
-
 :- predicate_options(codes_to_gv_file/3, 3, [
      pass_to(file_to_gv/3, 3)
    ]).
@@ -80,13 +42,13 @@ and GraphViz output files or SVG DOM structures.
      pass_to(file_to_gv/3, 3)
    ]).
 :- predicate_options(file_to_gv/3, 3, [
-     method(+oneof([dot,sfdp])),
-     to_file_type(+oneof([dot,jpeg,pdf,svg,xdot]))
+     method(+atom),
+     output(+atom)
    ]).
 :- predicate_options(gif_to_svg_dom/3, 3, [
-     pass_to(gif_to_gv_file/3, 3)
+     pass_to(graph_to_gv_file/3, 3)
    ]).
-:- predicate_options(gif_to_gv_file/3, 3, [
+:- predicate_options(graph_to_gv_file/3, 3, [
      pass_to(codes_to_gv_file/3, 3)
    ]).
 
@@ -94,81 +56,93 @@ and GraphViz output files or SVG DOM structures.
 
 %! codes_to_gv_file(
 %!   +Codes:list(code),
-%!   ?ToFile:atom,
+%!   ?OutputFile:atom,
 %!   +Options:list(nvpair)
 %! ) is det.
 
-codes_to_gv_file(Codes, ToFile, Options):-
-  absolute_file_name(data(tmp), TmpFile, [access(write),file_type(dot)]),
+codes_to_gv_file(Codes, OutputFile, Options):-
+  absolute_file_name(data(tmp), TmpFile, [access(write),extensions([dot])]),
   setup_call_cleanup(
     open(TmpFile, write, Write, [encoding(utf8)]),
     put_codes(Write, Codes),
     close(Write)
   ),
-  file_to_gv(TmpFile, ToFile, Options).
+  file_to_gv(TmpFile, OutputFile, Options).
+
 
 
-%! file_to_gv(+FromFile:atom, +Options:list(nvpair)) is det.
+%! file_to_gv(+InputFile:atom, +Options:list(nvpair)) is det.
 
-file_to_gv(FromFile, Options):-
-  file_to_gv(FromFile, _, Options).
+file_to_gv(InputFile, Options):-
+  file_to_gv(InputFile, _, Options).
 
-%! file_to_gv(+FromFile:atom, ?ToFile:atom, +Options:list(nvpair)) is det.
+%! file_to_gv(
+%!   +InputFile:atom,
+%!   ?OutputFile:atom,
+%!   +Options:list(nvpair)
+%! ) is det.
 % Converts a GraphViz DOT file to an image file, using a specific
 % visualization method.
 
-file_to_gv(FromFile, ToFile, Options):-
-  option(to_file_type(dot), Options), !,
-  rename_file(FromFile, ToFile).
-file_to_gv(FromFile, ToFile, Options):-
-  % The method option.
+file_to_gv(InputFile, OutputFile, Options):-
+  option(output(dot), Options), !,
+  (   var(OutputFile)
+  -&amp;gt;  OutputFile = InputFile
+  ;   rename_file(InputFile, OutputFile)
+  ).
+file_to_gv(InputFile, OutputFile, Options):-
+  % Typecheck for `method` option.
   option(method(Method), Options, dot),
-  must_be(oneof([dot,sfdp]), Method),
+  findall(Method0, gv_method(Method0), Methods),
+  must_be(oneof(Methods), Method),
 
-  % The file type option.
-  option(to_file_type(ToFileType), Options, pdf),
-  prolog_file_type(ToExtension, ToFileType),
-  prolog_file_type(ToExtension, graphviz_output), !,
+  % Typecheck for `output` option.
+  option(output(OutputType), Options, pdf),
+  findall(OutputType0, gv_output_type(OutputType0), OutputTypes),
+  must_be(oneof(OutputTypes), OutputType),
 
   % The output file is either given or created.
-  (   var(ToFile)
-  -&amp;gt;  user:prolog_file_type(ToExtension, ToFileType),
-      file_alternative(FromFile, _, _, ToExtension, ToFile)
-  ;   is_absolute_file_name(ToFile),
+  (   var(OutputFile)
+  -&amp;gt;  file_alternative(InputFile, _, _, OutputType, OutputFile)
+  ;   is_absolute_file_name(OutputFile),
       % The given output file must match a certain file extension.
-      file_name_extension(_, ToExtension, ToFile)
+      file_name_extension(_, OutputType, OutputFile)
   ),
-  % Now that we have the output file we can prevent the
-  % file type / file extension translation predicates from bakctracking.
-  !,
 
   % Run the GraphViz conversion command in the shell.
-  format(atom(OutputType), &#39;-T~w&#39;, [ToExtension]),
+  format(atom(OutputTypeFlag), &#39;-T~a&#39;, [OutputType]),
+  format(atom(OutputFileFlag), &#39;-o~a&#39;, [OutputFile]),
   process_create(
     path(Method),
     % @tbd Windows hack:
     %%%%&#39;C:\\Program Files (x86)\\Graphviz2.38\\bin\\dot.exe&#39;,
-    [OutputType,FromFile,&#39;-o&#39;,ToFile],
+    [OutputTypeFlag,file(InputFile),OutputFileFlag],
     [process(PID)]
   ),
   process_wait(PID, exit(ShellStatus)),
   exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
 
 
-%! gif_to_gv_file(+Gif:compound, ?ToFile:atom, +Options:list(nvpair)) is det.
+
+%! graph_to_gv_file(
+%!   +Graph:compound,
+%!   ?OutputFile:atom,
+%!   +Options:list(nvpair)
+%! ) is det.
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
-%   * =|method(+Method:oneof([dot,sfdp])|=
+%   * `method(+Method:atom`
 %     The algorithm used by GraphViz for positioning the tree nodes.
 %     Either =dot= (default) or =sfdp=.
-%   * =|to_file_type(+FileType:oneof([dot,jpeg,pdf,svg,xdot])|=
+%   * `output(+FileType:atom)`
 %     The file type of the generated GraphViz file.
 %     Default: `pdf`.
 
-gif_to_gv_file(Gif, ToFile, Options):-
+graph_to_gv_file(Gif, OutputFile, Options):-
   once(phrase(gv_graph(Gif), Codes)),
-  codes_to_gv_file(Codes, ToFile, Options).
+  codes_to_gv_file(Codes, OutputFile, Options).
+
 
 
 %! open_dot(+File:atom) is det.
@@ -181,3 +155,69 @@ open_dot(File):-
   once(find_program_by_file_type(dot, Program)),
   run_program(Program, [File]).
 
+
+
+
+% HELPERS
+
+gv_method(circo).
+gv_method(dot).
+gv_method(fdp).
+gv_method(neato).
+gv_method(osage).
+gv_method(sfdp).
+gv_method(twopi).
+
+
+
+gv_output_type(bmp).
+gv_output_type(canon).
+gv_output_type(dot).
+gv_output_type(gv).
+gv_output_type(xdot).
+gv_output_type(&#39;xdot1.2&#39;).
+gv_output_type(&#39;xdot1.4&#39;).
+gv_output_type(cgimage).
+gv_output_type(cmap).
+gv_output_type(eps).
+gv_output_type(exr).
+gv_output_type(fig).
+gv_output_type(gd).
+gv_output_type(gd2).
+gv_output_type(gif).
+gv_output_type(gtk).
+gv_output_type(ico).
+gv_output_type(imap).
+gv_output_type(cmapx).
+gv_output_type(imap_np).
+gv_output_type(cmapx_np).
+gv_output_type(ismap).
+gv_output_type(jp2).
+gv_output_type(jpg).
+gv_output_type(jpeg).
+gv_output_type(jpe).
+gv_output_type(pct).
+gv_output_type(pict).
+gv_output_type(pdf).
+gv_output_type(pic).
+gv_output_type(plain).
+gv_output_type(&#39;plain-ext&#39;).
+gv_output_type(png).
+gv_output_type(pov).
+gv_output_type(ps).
+gv_output_type(ps2).
+gv_output_type(psd).
+gv_output_type(sgi).
+gv_output_type(svg).
+gv_output_type(svgz).
+gv_output_type(tga).
+gv_output_type(tif).
+gv_output_type(tiff).
+gv_output_type(tk).
+gv_output_type(vml).
+gv_output_type(vmlz).
+gv_output_type(vrml).
+gv_output_type(wbmp).
+gv_output_type(webp).
+gv_output_type(xlib).
+gv_output_type(x11).
diff --git a/gv_html.pl b/gv_html.pl
index 08306f0..9a4d33a 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -9,7 +9,7 @@
 
 Grammar taken from the GraphViz Web site:
 
-```
+~~~
 label :   text
         | table
 text :   textitem
@@ -34,7 +34,9 @@ cells :   cell
         | cells &amp;lt;VR/&amp;gt; cell
 cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
       | &amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
-```
+~~~
+
+---
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/node-shapes#html
@@ -49,49 +51,56 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 
 
 
+
+
 %! gv_html_like_label(?Content:compound)// .
 
 gv_html_like_label(Content) --&amp;gt;
   bracketed(angular, label(Content)).
 
 
+
 %! cell(?Contents:compound)// .
-% Supported attributes for TD:
-% ```
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;
-% BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLSPAN=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWSPAN=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ```
+% Supported attributes for `TD`:
+%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;`
+%   - `BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
+%   - `BGCOLOR=&amp;quot;color&amp;quot;`
+%   - `BORDER=&amp;quot;value&amp;quot;`
+%   - `CELLPADDING=&amp;quot;value&amp;quot;`
+%   - `CELLSPACING=&amp;quot;value&amp;quot;`
+%   - `COLOR=&amp;quot;color&amp;quot;`
+%   - `COLSPAN=&amp;quot;value&amp;quot;`
+%   - `FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;`
+%   - `GRADIENTANGLE=&amp;quot;value&amp;quot;`
+%   - `HEIGHT=&amp;quot;value&amp;quot;`
+%   - `HREF=&amp;quot;value&amp;quot;`
+%   - `ID=&amp;quot;value&amp;quot;`
+%   - `PORT=&amp;quot;portName&amp;quot;`
+%   - `ROWSPAN=&amp;quot;value&amp;quot;`
+%   - `SIDES=&amp;quot;value&amp;quot;`
+%   - `STYLE=&amp;quot;value&amp;quot;`
+%   - `TARGET=&amp;quot;value&amp;quot;`
+%   - `TITLE=&amp;quot;value&amp;quot;`
+%   - `TOOLTIP=&amp;quot;value&amp;quot;`
+%   - `VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;`
+%   - `WIDTH=&amp;quot;value&amp;quot;`
 %
-% Supported attributes for IMG:
-% ```
-% SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;
-% SRC=&amp;quot;value&amp;quot;
-% ```
+% Supported attributes for `IMG`:
+%   - `SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;`
+%   - `SRC=&amp;quot;value&amp;quot;`
 
 cell(td(Contents)) --&amp;gt;
-  html_element(td, [], label(Contents)).
-cell(td(img)) --&amp;gt;
-  html_element(td, [], html_element(img)).
+  cell(td([],Contents)).
+cell(td(Attrs1,Image)) --&amp;gt;
+  {(  Image =.. [img,Attrs2]
+  -&amp;gt;  true
+  ;   Image == img
+  -&amp;gt;  Attrs2 = []
+  )},
+  html_element(td, Attrs1, html_element(img,Attrs2)).
+cell(td(Attrs,Contents)) --&amp;gt;
+  html_element(td, Attrs, label(Contents)).
+
 
 
 %! cells(?Contents:list(compound))// .
@@ -107,19 +116,22 @@ cells([H]) --&amp;gt;
   cell(H).
 
 
+
 %! label(?Content:compound)// .
 % GraphViz HTML-like label.
 
 label(Content) --&amp;gt;
-  text(Content).
-label(Content) --&amp;gt;
   table(Content).
+label(Content) --&amp;gt;
+  text(Content).
+
 
 
 %! row(?Contents:compound)// .
 
 row(tr(Contents)) --&amp;gt;
-  html_element(tr, [], cell(Contents)).
+  html_element(tr, [], cells(Contents)).
+
 
 
 %! rows(?Contents:list)// .
@@ -127,72 +139,108 @@ row(tr(Contents)) --&amp;gt;
 rows([H|T]) --&amp;gt;
   row(H),
   rows(T).
-rows([H,hr|T]) --&amp;gt;
-  row(H),
+rows([hr|T]) --&amp;gt;
   html_element(hr),
   rows(T).
 rows([H]) --&amp;gt;
   row(H).
 
 
+
 %! table(?Contents:compound)// .
-% Supported attributes for TABLE:
-% ```
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% BGCOLOR=&amp;quot;color&amp;quot;
-% BORDER=&amp;quot;value&amp;quot;
-% CELLBORDER=&amp;quot;value&amp;quot;
-% CELLPADDING=&amp;quot;value&amp;quot;
-% CELLSPACING=&amp;quot;value&amp;quot;
-% COLOR=&amp;quot;color&amp;quot;
-% COLUMNS=&amp;quot;value&amp;quot;
-% FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;
-% GRADIENTANGLE=&amp;quot;value&amp;quot;
-% HEIGHT=&amp;quot;value&amp;quot;
-% HREF=&amp;quot;value&amp;quot;
-% ID=&amp;quot;value&amp;quot;
-% PORT=&amp;quot;portName&amp;quot;
-% ROWS=&amp;quot;value&amp;quot;
-% SIDES=&amp;quot;value&amp;quot;
-% STYLE=&amp;quot;value&amp;quot;
-% TARGET=&amp;quot;value&amp;quot;
-% TITLE=&amp;quot;value&amp;quot;
-% TOOLTIP=&amp;quot;value&amp;quot;
-% VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;
-% WIDTH=&amp;quot;value&amp;quot;
-% ```
+% ~~~
+% table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
+% ~~~
 %
-% Supported attributes for FONT:
-% ```
-% COLOR=&amp;quot;color&amp;quot;
-% FACE=&amp;quot;fontname&amp;quot;
-% POINT-SIZE=&amp;quot;value&amp;quot;
-% ```
-
+% Supported attributes for `TABLE`:
+%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
+%   - `BGCOLOR=&amp;quot;color&amp;quot;`
+%   - `BORDER=&amp;quot;value&amp;quot;`
+%   - `CELLBORDER=&amp;quot;value&amp;quot;`
+%   - `CELLPADDING=&amp;quot;value&amp;quot;`
+%   - `CELLSPACING=&amp;quot;value&amp;quot;`
+%   - `COLOR=&amp;quot;color&amp;quot;`
+%   - `COLUMNS=&amp;quot;value&amp;quot;`
+%   - `FIXEDSIZE=&amp;quot;FALSE|TRUE&amp;quot;`
+%   - `GRADIENTANGLE=&amp;quot;value&amp;quot;`
+%   - `HEIGHT=&amp;quot;value&amp;quot;`
+%   - `HREF=&amp;quot;value&amp;quot;`
+%   - `ID=&amp;quot;value&amp;quot;`
+%   - `PORT=&amp;quot;portName&amp;quot;`
+%   - `ROWS=&amp;quot;value&amp;quot;`
+%   - `SIDES=&amp;quot;value&amp;quot;`
+%   - `STYLE=&amp;quot;value&amp;quot;`
+%   - `TARGET=&amp;quot;value&amp;quot;`
+%   - `TITLE=&amp;quot;value&amp;quot;`
+%   - `TOOLTIP=&amp;quot;value&amp;quot;`
+%   - `VALIGN=&amp;quot;MIDDLE|BOTTOM|TOP&amp;quot;`
+%   - `WIDTH=&amp;quot;value&amp;quot;`
+%
+% Supported attributes for `FONT`:
+%  - `COLOR=&amp;quot;color&amp;quot;`
+%    Sets the color of the font within the scope of `&amp;lt;FONT&amp;gt;...&amp;lt;/FONT&amp;gt;`,
+%     or the border color of the table or cell within the scope of
+%     `&amp;lt;TABLE&amp;gt;...&amp;lt;/TABLE&amp;gt;`, or `&amp;lt;TD&amp;gt;...&amp;lt;/TD&amp;gt;`.
+%    This color can be overridden by a `COLOR` attribute in descendents.
+%    By default, the font color is determined by the `fontcolor` attribute
+%     of the corresponding node, edge or graph, and the border color is
+%     determined by the color attribute of the corresponding node, edge or
+%     graph.
+%   - `FACE=&amp;quot;fontname&amp;quot;`
+%   - `POINT-SIZE=&amp;quot;value&amp;quot;`
+
+table(table(Contents)) --&amp;gt;
+  table(table([],Contents)).
 table(table(Attrs,Contents)) --&amp;gt;
   html_element(table, Attrs, rows(Contents)).
-table(table(font(Contents))) --&amp;gt;
-  html_element(font, [], html_element(table, [], rows(Contents))).
+table(font(Table)) --&amp;gt;
+  table(font([],Table)).
+table(font(Attrs1,Table)) --&amp;gt;
+  {(  Table =.. [table,Attrs2,Contents]
+  -&amp;gt;  true
+  ;   Table =.. [table,Contents]
+  -&amp;gt;  Attrs2 = []
+  )},
+  html_element(font, Attrs1, table(table(Attrs2,Contents))).
+
 
 
 %! text(?Contents:list)// .
+% ~~~
+% text :   textitem
+%        | text textitem
+% ~~~
 
 text(Contents) --&amp;gt;
+  {is_list(Contents)}, !,
   &#39;+&#39;(textitem, Contents, []).
-
-
-%! textitem(?Content)// .
+text(Content) --&amp;gt;
+  text([Content]).
+
+
+
+%! textitem(?Content:compound)// .
+% ~~~
+% textitem :   string
+%            | &amp;lt;BR/&amp;gt;
+%            | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
+%            | &amp;lt;I&amp;gt; text &amp;lt;/I&amp;gt;
+%            | &amp;lt;B&amp;gt; text &amp;lt;/B&amp;gt;
+%            | &amp;lt;U&amp;gt; text &amp;lt;/U&amp;gt;
+%            | &amp;lt;O&amp;gt; text &amp;lt;/O&amp;gt;
+%            | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
+%            | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
+%            | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
+% ~~~
+%
 % Supported attributes for BR:
-% ```
-% ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;
-% ```
+%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
 
-textitem(string(String)) --&amp;gt;
-  html_string(String).
-textitem(entity(Name)) --&amp;gt;
-  html_entity(Name).
+textitem(br) --&amp;gt;
+  textitem(br([])).
 textitem(br(Attrs)) --&amp;gt;
   html_element(br, Attrs).
+% Compound term: parser.
 textitem(Compound) --&amp;gt;
   {var(Compound)}, !,
   html_element(Name, _, text(Content)),
@@ -200,12 +248,17 @@ textitem(Compound) --&amp;gt;
     supported_html_element(Name),
     Compound =.. [Name,Content]
   }.
+% Compound term: generator.
 textitem(Compound) --&amp;gt;
   {
     Compound =.. [Name,Content],
     supported_html_element(Name)
   },
   html_element(Name, _, text(Content)).
+textitem(String) --&amp;gt;
+  html_string(String).
+
+
 
 
 
diff --git a/plDcg b/plDcg
index c61080f..d2e4a8a 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit c61080f3d8df6ba6d48b0d70f5ba52047c8cbd29
+Subproject commit d2e4a8a094b7c405222574a4f9fe8c472296d7e6
diff --git a/plHtml b/plHtml
index c98f740..dfd7c27 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit c98f740d593fff74bfa3cf3d08af13c857daa899
+Subproject commit dfd7c27dfd102e8eb6bfd9c516fccfcd23b5abf0
diff --git a/plUri b/plUri
index 66a7652..0be7e9c 160000
--- a/plUri
+++ b/plUri
@@ -1 +1 @@
-Subproject commit 66a7652bc1ab6a4dc1fc790b09894d6c51d42dcf
+Subproject commit 0be7e9cae7b42dea30f08aa751438d382387b8a2
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;59&#34;&gt; 59: 正在比较变动前 af5d96d 和变动后 ab4b616 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/README.md b/README.md
index f89c694..fff981c 100644
--- a/README.md
+++ b/README.md
@@ -3,6 +3,40 @@ plGraphViz
 
 Easily export graphs represented as Prolog terms to
  [GraphViz](http://www.graphviz.org/).
+The Prolog terms have the following form:
+
+~~~prolog
+graph(Vertices, Edges, GraphAttrs)
+~~~
+
+`Vertices` and `Edges` are lists of compounds terms of
+ the following form:
+
+~~~prolog
+vertex(Id, VertexAttrs)
+edges(FromId, ToId, EdgeAttrs)
+~~~
+
+`Id` identifies a vertex and need not occur in any of the edges
+ (i.e., unconnected vertices are allowed).
+`FromId` and `ToId` may occur in the list of vertices,
+ in order to draw an edge between vertices with set attributes.
+
+Attributes have the form `Name=Value`.
+`GraphAttrs` are attributes of the graph.
+`VertexAttrs` are attributes of the vertex.
+`EdgeAttrs` are attributes of the edge.
+
+Attribute values are given as Prolog terms as well,
+ and are type-checked before exporting.
+Many of the GraphViz attributes are supported.
+New ones are added on an as-needed bases
+ (open an issue on Github if you want to see a specific feature added).
+Supports HTML-like labels, allowing complex tables to be shown
+ inside vertices.
+Support for vertex clusters is currently under way.
+
+---
 
 ### Example
 
@@ -17,14 +51,14 @@ $ swipl run.pl
    File = &#39;PATH/plGraphViz/data/tmp.png&#39;
 ~~~
 
+![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example1.png &amp;quot;Example graph.&amp;quot;)
+
 The graphic can be saved to a different file by instantiating
  the `File` argument.
 
-![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example1.png &amp;quot;Example graph.&amp;quot;)
-
 ---
 
-### Method option
+### &#39;Method&#39; option
 
 Option `method(+atom)` sets the drawing method that is used by GraphViz
  to place the vertices and edges.
@@ -41,7 +75,7 @@ The following values are supported.
 
 ---
 
-### Output type option
+### &#39;Output&#39; option
 
 Option `output(+atom)` sets the type of file the graph is written to.
 The following values are supported.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;60&#34;&gt; 60: 正在比较变动前 ab4b616 和变动后 74bd19d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 3237b4b..4678991 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -438,7 +438,7 @@ smoothType(triangle).
 % A GraphViz string.
 
 string(Content) --&amp;gt;
-  atom(Content).
+  quoted(atom(Content)).
 
 
 
diff --git a/gv_dot.pl b/gv_dot.pl
index 6db4451..d01b656 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +Gif:compound
+    gv_graph//1 % +Graph:compound
   ]
 ).
 
@@ -150,7 +150,7 @@ gv_generic_attributes_statement(Kind, I, KindAttrs) --&amp;gt;
 
 
 
-%! gv_graph(+Gif:compound)//
+%! gv_graph(+Graph:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;61&#34;&gt; 61: 正在比较变动前 74bd19d 和变动后 8ffff6f &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/README.md b/README.md
index fff981c..9413d36 100644
--- a/README.md
+++ b/README.md
@@ -38,6 +38,14 @@ Support for vertex clusters is currently under way.
 
 ---
 
+### Installation
+
+~~~shell
+$ git clone https://github.com/wouterbeek/plGraphViz.git
+$ cd plGraphViz
+$ git submodule update --init
+~~~
+
 ### Example
 
 ~~~prolog
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 4678991..3237b4b 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -438,7 +438,7 @@ smoothType(triangle).
 % A GraphViz string.
 
 string(Content) --&amp;gt;
-  quoted(atom(Content)).
+  atom(Content).
 
 
 
diff --git a/gv_dot.pl b/gv_dot.pl
index d01b656..6db4451 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +Graph:compound
+    gv_graph//1 % +Gif:compound
   ]
 ).
 
@@ -150,7 +150,7 @@ gv_generic_attributes_statement(Kind, I, KindAttrs) --&amp;gt;
 
 
 
-%! gv_graph(+Graph:compound)//
+%! gv_graph(+Gif:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;62&#34;&gt; 62: 正在比较变动前 8ffff6f 和变动后 ac3423a &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 3237b4b..4678991 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -438,7 +438,7 @@ smoothType(triangle).
 % A GraphViz string.
 
 string(Content) --&amp;gt;
-  atom(Content).
+  quoted(atom(Content)).
 
 
 
diff --git a/gv_dot.pl b/gv_dot.pl
index 6db4451..d01b656 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +Gif:compound
+    gv_graph//1 % +Graph:compound
   ]
 ).
 
@@ -150,7 +150,7 @@ gv_generic_attributes_statement(Kind, I, KindAttrs) --&amp;gt;
 
 
 
-%! gv_graph(+Gif:compound)//
+%! gv_graph(+Graph:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;63&#34;&gt; 63: 正在比较变动前 ac3423a 和变动后 57932e4 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 1b264ab..3c731a0 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 1b264ab8b668b44035c96f320f8798f7940ad2fa
+Subproject commit 3c731a03db6ee32031815d24c505e784273f46ef
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;64&#34;&gt; 64: 正在比较变动前 57932e4 和变动后 315b16e &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index a7901e4..efd8c89 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -45,7 +45,7 @@ and GraphViz output files or SVG DOM structures.
      method(+atom),
      output(+atom)
    ]).
-:- predicate_options(gif_to_svg_dom/3, 3, [
+:- predicate_options(graph_to_svg_dom/3, 3, [
      pass_to(graph_to_gv_file/3, 3)
    ]).
 :- predicate_options(graph_to_gv_file/3, 3, [
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;65&#34;&gt; 65: 正在比较变动前 315b16e 和变动后 898b5d2 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index efd8c89..52506e8 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -29,7 +29,6 @@ and GraphViz output files or SVG DOM structures.
 :- use_module(library(process)).
 
 :- use_module(generics(code_ext)).
-:- use_module(generics(db_ext)).
 :- use_module(os(file_ext)).
 :- use_module(os(run_ext)).
 
@@ -45,9 +44,6 @@ and GraphViz output files or SVG DOM structures.
      method(+atom),
      output(+atom)
    ]).
-:- predicate_options(graph_to_svg_dom/3, 3, [
-     pass_to(graph_to_gv_file/3, 3)
-   ]).
 :- predicate_options(graph_to_gv_file/3, 3, [
      pass_to(codes_to_gv_file/3, 3)
    ]).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;66&#34;&gt; 66: 正在比较变动前 898b5d2 和变动后 4279a49 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 52506e8..188cfa6 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -6,9 +6,9 @@
     file_to_gv/3, % +InputFile:atom
                   % ?OutputFile:atom
                   % +Options:list(nvpair)
-    graph_to_gv_file/3, % +Graph:compound
-                        % ?OutputFile:atom
-                        % +Options:list(nvpair)
+    export_graph_to_gv_file/3, % +ExportGraph:compound
+                               % ?OutputFile:atom
+                               % +Options:list(nvpair)
     open_dot/1 % +File:file
   ]
 ).
@@ -22,7 +22,7 @@ Also converts between GraphViz DOT formatted files
 and GraphViz output files or SVG DOM structures.
 
 @author Wouter Beek
-@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08
+@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08, 2014/11
 */
 
 :- use_module(library(option)).
@@ -34,6 +34,11 @@ and GraphViz output files or SVG DOM structures.
 
 :- use_module(plGraphViz(gv_dot)).
 
+:- dynamic(user:prolog_file_type/2).
+:- multifile(user:prolog_file_type/2).
+
+user:prolog_file_type(dot, dot).
+
 :- predicate_options(codes_to_gv_file/3, 3, [
      pass_to(file_to_gv/3, 3)
    ]).
@@ -44,12 +49,14 @@ and GraphViz output files or SVG DOM structures.
      method(+atom),
      output(+atom)
    ]).
-:- predicate_options(graph_to_gv_file/3, 3, [
+:- predicate_options(export_graph_to_gv_file/3, 3, [
      pass_to(codes_to_gv_file/3, 3)
    ]).
 
 
 
+
+
 %! codes_to_gv_file(
 %!   +Codes:list(code),
 %!   ?OutputFile:atom,
@@ -120,23 +127,23 @@ file_to_gv(InputFile, OutputFile, Options):-
 
 
 
-%! graph_to_gv_file(
-%!   +Graph:compound,
+%! export_graph_to_gv_file(
+%!   +ExportGraph:compound,
 %!   ?OutputFile:atom,
 %!   +Options:list(nvpair)
 %! ) is det.
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
-%   * `method(+Method:atom`
+%   - `method(+Method:atom`
 %     The algorithm used by GraphViz for positioning the tree nodes.
 %     Either =dot= (default) or =sfdp=.
-%   * `output(+FileType:atom)`
+%   - `output(+FileType:atom)`
 %     The file type of the generated GraphViz file.
 %     Default: `pdf`.
 
-graph_to_gv_file(Gif, OutputFile, Options):-
-  once(phrase(gv_graph(Gif), Codes)),
+export_graph_to_gv_file(ExportGraph, OutputFile, Options):-
+  once(phrase(gv_graph(ExportGraph), Codes)),
   codes_to_gv_file(Codes, OutputFile, Options).
 
 
@@ -154,6 +161,7 @@ open_dot(File):-
 
 
 
+
 % HELPERS
 
 gv_method(circo).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;67&#34;&gt; 67: 正在比较变动前 4279a49 和变动后 c173073 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index d01b656..a4197a9 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -13,10 +13,10 @@ Methods for writing to the GraphViz DOT format.
 
 In GraphViz vertices are called &#39;nodes&#39;.
 
-~~~abnf
+```abnf
 attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
 a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
-~~~
+```
 
 ---
 
diff --git a/gv_html.pl b/gv_html.pl
index 9a4d33a..63f2d82 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -9,7 +9,7 @@
 
 Grammar taken from the GraphViz Web site:
 
-~~~
+```
 label :   text
         | table
 text :   textitem
@@ -34,7 +34,7 @@ cells :   cell
         | cells &amp;lt;VR/&amp;gt; cell
 cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
       | &amp;lt;TD&amp;gt; &amp;lt;IMG/&amp;gt; &amp;lt;/TD&amp;gt;
-~~~
+```
 
 ---
 
@@ -148,9 +148,9 @@ rows([H]) --&amp;gt;
 
 
 %! table(?Contents:compound)// .
-% ~~~
+% ```
 % table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
-% ~~~
+% ```
 %
 % Supported attributes for `TABLE`:
 %   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
@@ -206,10 +206,10 @@ table(font(Attrs1,Table)) --&amp;gt;
 
 
 %! text(?Contents:list)// .
-% ~~~
+% ```
 % text :   textitem
 %        | text textitem
-% ~~~
+% ```
 
 text(Contents) --&amp;gt;
   {is_list(Contents)}, !,
@@ -220,7 +220,7 @@ text(Content) --&amp;gt;
 
 
 %! textitem(?Content:compound)// .
-% ~~~
+% ```
 % textitem :   string
 %            | &amp;lt;BR/&amp;gt;
 %            | &amp;lt;FONT&amp;gt; text &amp;lt;/FONT&amp;gt;
@@ -231,7 +231,7 @@ text(Content) --&amp;gt;
 %            | &amp;lt;SUB&amp;gt; text &amp;lt;/SUB&amp;gt;
 %            | &amp;lt;SUP&amp;gt; text &amp;lt;/SUP&amp;gt;
 %            | &amp;lt;S&amp;gt; text &amp;lt;/S&amp;gt;
-% ~~~
+% ```
 %
 % Supported attributes for BR:
 %   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;68&#34;&gt; 68: 正在比较变动前 c173073 和变动后 107c515 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index e3ba03c..6e61373 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -129,7 +129,7 @@ assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
 
 gv_attrs_download:-
   gv_attrs_url(Url),
-  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
+  download_html_dom(Url, Dom, [html_dialect(html4),verbose(silent)]),
 
   xpath(Dom, //table(@align=center), TableDom),
   % @tbd This does not work, since in `record_name(Element, Name)`,
diff --git a/gv_color.pl b/gv_color.pl
index 0510f98..c1c6fde 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -94,7 +94,7 @@ wc_weight(Float) --&amp;gt;
 
 gv_color_download:-
   gv_color_url(Url),
-  download_html(Url, Dom, [html_dialect(html4),verbose(silent)]),
+  download_html_dom(Url, Dom, [html_dialect(html4),verbose(silent)]),
   xpath(Dom, //table(1), TableDom1),
   xpath(Dom, //table(2), TableDom2),
   maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2]).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;69&#34;&gt; 69: 正在比较变动前 107c515 和变动后 8f574bb &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 6e61373..0fa4dcc 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -2,7 +2,7 @@
   gv_attrs,
   [
     gv_attr_value//2 % +Context:oneof([cluster,edge,graph,node,subgraph])
-               % +Attribute:nvpair
+                     % +Attribute:nvpair
   ]
 ).
 
@@ -11,7 +11,7 @@
 Support for GraphViz attributes.
 
 @author Wouter Beek
-@version 2014/06, 2014/11
+@version 2014/06, 2014/11-2014/12
 */
 
 :- use_module(library(apply)).
@@ -30,7 +30,7 @@ Support for GraphViz attributes.
 :- use_module(plHtml(html)).
 :- use_module(plHtml(html_table)).
 
-:- use_module(plGraphViz(gv_attr_type)). % DCGs implementing attribute types.
+:- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
 
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
@@ -94,7 +94,7 @@ gv_attr_value(Context, Name=Value) --&amp;gt;
     % Check validity of Value w.r.t. minimum value -- if available.
     check_minimum(Value, Minimum)
   },
-  dcg_call(Dcg, Value).
+  dcg_call(gv_attr_type:Dcg, Value).
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;70&#34;&gt; 70: 正在比较变动前 8f574bb 和变动后 d7088dd &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index a4197a9..e7b6748 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -341,12 +341,12 @@ gv_id(Atom) --&amp;gt;
 gv_id(Atom) --&amp;gt;
   quoted(dcg_atom_codes(gv_quoted_string, Atom)), !.
 
-gv_id_first(X) --&amp;gt; letter(X).
+gv_id_first(X) --&amp;gt; ascii_letter(X).
 gv_id_first(X) --&amp;gt; underscore(X).
 
 gv_id_rest([]) --&amp;gt; [].
 gv_id_rest([H|T]) --&amp;gt;
-  (   alpha_numeric(H)
+  (   ascii_alpha_numeric(H)
   ;   underscore(H)
   ),
   gv_id_rest(T).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;71&#34;&gt; 71: 正在比较变动前 d7088dd 和变动后 94ed05d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/README.md b/README.md
index 9413d36..eb8512b 100644
--- a/README.md
+++ b/README.md
@@ -51,7 +51,7 @@ $ git submodule update --init
 ~~~prolog
 $ swipl run.pl
 ?- use_module(plGraphViz(gv_file)).
-?- graph_to_gv_file(
+?- export_graph_to_gv_file(
      graph([vertex(1,[]),vertex(2,[])],[edge(1,2,[])],[]),
      File,
      [method(sfdp),output(png)]
@@ -136,7 +136,7 @@ The following values are supported.
 Example of using HTML-like labels:
 
 ~~~prolog
-graph_to_gv_file(
+export_graph_to_gv_file(
   graph(
     [vertex(1,[]),vertex(2,[label=html(table([tr([td(a),td(b)]),tr([td(c),td(d)])]))])],
     [edge(1,2,[label=&#39;From 1 to 2.&#39;])],
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;72&#34;&gt; 72: 正在比较变动前 94ed05d 和变动后 f481060 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 188cfa6..101dc4d 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -94,6 +94,7 @@ file_to_gv(InputFile, OutputFile, Options):-
   ;   rename_file(InputFile, OutputFile)
   ).
 file_to_gv(InputFile, OutputFile, Options):-
+gtrace,
   % Typecheck for `method` option.
   option(method(Method), Options, dot),
   findall(Method0, gv_method(Method0), Methods),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;73&#34;&gt; 73: 正在比较变动前 f481060 和变动后 ce492ef &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 4678991..6d2e4f5 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -46,7 +46,7 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06, 2014/11
+@version 2014/06, 2014/11-2014/12
 */
 
 :- use_module(plDcg(dcg_abnf)).
@@ -54,7 +54,9 @@
 :- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_cardinal)).
 :- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_generics)).
 :- use_module(plDcg(dcg_quote)).
+:- use_module(plDcg(dcg_replace)).
 
 :- use_module(plGraphViz(gv_html)).
 
@@ -210,7 +212,10 @@ doubleList(L) --&amp;gt;
 % @tbd Support for context-dependent replacements.
 
 escString(String) --&amp;gt;
-  quoted(atom(String)).
+  {dcg_phrase(dcg_replace(double_quote, escaped_double_quote), String, String0)},
+  quoted(atom(String0)).
+escaped_double_quote --&amp;gt;
+  &amp;quot;\\\&amp;quot;&amp;quot;.
 
 
 
diff --git a/gv_dot.pl b/gv_dot.pl
index e7b6748..c51b4cf 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -22,7 +22,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/dot-language
-@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
+@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11-2014/12
 */
 
 :- use_module(library(apply)).
@@ -32,6 +32,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 :- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_arrow)).
 :- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_atom)).
 :- use_module(plDcg(dcg_bracket)).
 :- use_module(plDcg(dcg_content)).
 :- use_module(plDcg(dcg_generics)).
@@ -111,12 +112,11 @@ gv_edge_operator(true) --&amp;gt; arrow(right, 2).
 
 gv_edge_statement(I, Directed, edge(FromId,ToId,EAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(FromId), &amp;quot; &amp;quot;,
 
+  gv_node_id(FromId), &amp;quot; &amp;quot;,
   gv_edge_operator(Directed), &amp;quot; &amp;quot;,
-
   gv_node_id(ToId), &amp;quot; &amp;quot;,
-
+  
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
   bracketed(square, &#39;*&#39;(gv_attr(edge), EAttrs, [])),
@@ -293,7 +293,7 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 
 
 
-%! gv_id(?Atom:atom)// is det.
+%! gv_id(?Atom:compound)// is det.
 % Parse a GraphViz identifier.
 % There are 4 variants:
 %   1. Any string of alphabetic (`[a-zA-Z&#39;200-&#39;377]`) characters,
@@ -306,17 +306,26 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 %      is converted to `&amp;quot;`. All other characters are left unchanged.
 %      In particular, `\\` remains `\\`.
 %      Layout engines may apply additional escape sequences.
+%      Represented by a Prolog term of the form `double_quoted_string(ATOM)`.
 %   4. An HTML string (`&amp;lt;...&amp;gt;`).
+%      Represented by a Prolog term of the form `html_like_label(COMPOUND)`.
 %
 % @tbd Add support for HTML-like labels:
 %      http://www.graphviz.org/doc/info/shapes.html#html
 %      This requires an XML grammar!
 
-% HTML strings (variant 4).
-gv_id(Content) --&amp;gt;
-  {compound(Content)}, !,
+% HTML strings (assumed to be the same as HTML-like labels).
+gv_id(html_like_label(Content)) --&amp;gt; !,
   gv_html_like_label(Content).
-% Alpha-numeric strings (variant 1).
+% Double-quoted strings.
+% The quotes are already part of the given atom.
+gv_id(double_quoted_string(Atom)) --&amp;gt; !,
+  quoted(atom(Atom)).
+% Numerals.
+gv_id(N) --&amp;gt;
+  {number(N)}, !,
+  gv_numeral(N).
+% Alpha-numeric strings.
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
   gv_id_first(H),
@@ -324,22 +333,6 @@ gv_id(Atom) --&amp;gt;
   % Variant 1 identifiers should not be (case-variants of) a
   % GraphViz keyword.
   {\+ gv_keyword([H|T])}.
-% Numerals (variant 2)
-gv_id(N) --&amp;gt;
-  {number(N)}, !,
-  gv_numeral(N).
-% Double-quoted strings (variant 3).
-% The quotes are already part of the given atom.
-gv_id(Atom) --&amp;gt;
-  {
-    atom_codes(Atom, [H|T]),
-    append(S, [H], T)
-  },
-  dcg_between(double_quote(H), gv_quoted_string(S)), !.
-% Double-quoted strings (variant 3).
-% The quotes are not in the given atom. They are written anyway.
-gv_id(Atom) --&amp;gt;
-  quoted(dcg_atom_codes(gv_quoted_string, Atom)), !.
 
 gv_id_first(X) --&amp;gt; ascii_letter(X).
 gv_id_first(X) --&amp;gt; underscore(X).
@@ -382,7 +375,7 @@ gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
 
 
 
-%! gv_node_id(+NodeId:atom)// .
+%! gv_node_id(+NodeId:compound)// .
 % GraphViz node identifiers can be of the following two types:
 %   1. A GraphViz identifier, see gv_id//1.
 %   2. A GraphViz identifier plus a GraphViz port indicator, see gv_port//0.
@@ -439,26 +432,6 @@ gv_port_location --&amp;gt;
 
 
 
-gv_quoted_string([]) --&amp;gt; [].
-% Just to be sure, we do not allow the double quote
-% that closes the string to be escaped.
-gv_quoted_string([X]) --&amp;gt;
-  {X \== 92}, !,
-  [X].
-% A double quote is only allowed if it is escaped by a backslash.
-gv_quoted_string([92,34|T]) --&amp;gt; !,
-  gv_quoted_string(T).
-% Add the backslash escape character.
-gv_quoted_string([34|T]) --&amp;gt; !,
-  &amp;quot;\\\&amp;quot;&amp;quot;,
-  gv_quoted_string(T).
-% All other characters are allowed without escaping.
-gv_quoted_string([H|T]) --&amp;gt;
-  [H],
-  gv_quoted_string(T).
-
-
-
 gv_ranked_node_collection(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
   indent(I),
   bracketed(curly, (
diff --git a/gv_file.pl b/gv_file.pl
index 101dc4d..d191e10 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -22,7 +22,7 @@ Also converts between GraphViz DOT formatted files
 and GraphViz output files or SVG DOM structures.
 
 @author Wouter Beek
-@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08, 2014/11
+@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08, 2014/11-2014/12
 */
 
 :- use_module(library(option)).
@@ -38,6 +38,7 @@ and GraphViz output files or SVG DOM structures.
 :- multifile(user:prolog_file_type/2).
 
 user:prolog_file_type(dot, dot).
+user:prolog_file_type(pdf, pdf).
 
 :- predicate_options(codes_to_gv_file/3, 3, [
      pass_to(file_to_gv/3, 3)
@@ -94,7 +95,6 @@ file_to_gv(InputFile, OutputFile, Options):-
   ;   rename_file(InputFile, OutputFile)
   ).
 file_to_gv(InputFile, OutputFile, Options):-
-gtrace,
   % Typecheck for `method` option.
   option(method(Method), Options, dot),
   findall(Method0, gv_method(Method0), Methods),
@@ -108,9 +108,7 @@ gtrace,
   % The output file is either given or created.
   (   var(OutputFile)
   -&amp;gt;  file_alternative(InputFile, _, _, OutputType, OutputFile)
-  ;   is_absolute_file_name(OutputFile),
-      % The given output file must match a certain file extension.
-      file_name_extension(_, OutputType, OutputFile)
+  ;   is_absolute_file_name(OutputFile)
   ),
 
   % Run the GraphViz conversion command in the shell.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;74&#34;&gt; 74: 正在比较变动前 ce492ef 和变动后 ddef555 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 6d2e4f5..b886f9f 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -229,7 +229,7 @@ escaped_double_quote --&amp;gt;
 
 %! lblString(+String:compound)// .
 
-lblString(html(V)) --&amp;gt;
+lblString(html_like_label(V)) --&amp;gt;
   gv_html_like_label(V).
 lblString(V) --&amp;gt;
   escString(V).
diff --git a/gv_html.pl b/gv_html.pl
index 63f2d82..1410c25 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -236,8 +236,6 @@ text(Content) --&amp;gt;
 % Supported attributes for BR:
 %   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
 
-textitem(br) --&amp;gt;
-  textitem(br([])).
 textitem(br(Attrs)) --&amp;gt;
   html_element(br, Attrs).
 % Compound term: parser.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;75&#34;&gt; 75: 正在比较变动前 ddef555 和变动后 af27fdd &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_color.pl b/gv_color.pl
index c1c6fde..2263fa1 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -17,7 +17,7 @@
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists), except([delete/3])).
+:- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
diff --git a/gv_dot.pl b/gv_dot.pl
index c51b4cf..e047a74 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -26,7 +26,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 */
 
 :- use_module(library(apply)).
-:- use_module(library(lists), except([delete/3])).
+:- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(ordsets)).
 
 :- use_module(plDcg(dcg_abnf)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;76&#34;&gt; 76: 正在比较变动前 af27fdd 和变动后 f390238 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index b886f9f..b68f753 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -46,7 +46,7 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06, 2014/11-2014/12
+@version 2014/06, 2014/11-2015/01
 */
 
 :- use_module(plDcg(dcg_abnf)).
@@ -57,6 +57,7 @@
 :- use_module(plDcg(dcg_generics)).
 :- use_module(plDcg(dcg_quote)).
 :- use_module(plDcg(dcg_replace)).
+:- use_module(plDcg(language/c)).
 
 :- use_module(plGraphViz(gv_html)).
 
@@ -104,9 +105,9 @@ gv_attr_type(viewPort).
 %! addDouble(+Float:float)// .
 % An *addDouble* is represented by a Prolog float.
 
-addDouble(Float) --&amp;gt;
-  &#39;?&#39;(plus_sign, []),
-  double(Float).
+addDouble(N) --&amp;gt;
+  (&amp;quot;+&amp;quot; ; &amp;quot;&amp;quot;),
+  c_double(N).
 
 
 
@@ -115,7 +116,7 @@ addDouble(Float) --&amp;gt;
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
 addPoint(Point) --&amp;gt;
-  &#39;?&#39;(plus_sign, []),
+  (&amp;quot;+&amp;quot; ; &amp;quot;&amp;quot;),
   point(Point).
 
 
@@ -194,10 +195,8 @@ dirType(none).
 
 %! double(+Double:float)// .
 
-double(Double1) --&amp;gt;
-  % float//1 will check for float type.
-  {Double2 is Double1 * 1.0},
-  float(Double2).
+double(N) --&amp;gt;
+  c_double(N).
 
 
 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index d36fa59..cf595d9 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -19,7 +19,7 @@
 
 
 
-%! gv_numeral(?Value:number)// .
+%! gv_numeral(?Value:compound)// .
 %
 % # Syntax
 %
@@ -45,36 +45,39 @@
 %   - (decimal-separator)
 
 gv_numeral(N) --&amp;gt;
-  {var(N)}, !,
-  sign(Sign),
-  (   &amp;quot;.&amp;quot;,
-      &#39;+&#39;(decimal_digit, Fractional, [convert1(weights_decimal)]),
-      {IntegerPart = 0}
-  ;   &#39;+&#39;(decimal_digit, IntegerPart, [convert1(weights_decimal)]),
-      (   &amp;quot;.&amp;quot;,
-          &#39;*&#39;(decimal_digit, Fractional, [convert1(weights_decimal)])
-      ;   {Fractional = 0}
+  (   {ground(N)}
+  -&amp;gt;  &#39;[-]?&#39;(N),
+      {N0 is abs(N)},
+      {rational_parts(N0, I, F)},
+      (   % [1] The fractional is zero, so only write the integer part
+          %     and do not write the decimal separator.
+          {F =:= 0}
+      -&amp;gt;  {weights_nonneg(IW, I)},
+          &#39;[0-9]+&#39;(IW)
+      ;   % [2] The integer part is zero, so only write the fractional part,
+          %     preceded by the decimal separator.
+          {I =:= 0}
+      -&amp;gt;  &amp;quot;.&amp;quot;,
+          {weights_fraction(FW, F)},
+          &#39;[0-9]*&#39;(FW)
+      ;   % [3] Both the integer part and the fractional are non-zero,
+          %     so write both of them, with the decimal separator in-between.
+          {weights_nonneg(IW, I)},
+          &#39;[0-9]+&#39;(IW),
+          &amp;quot;.&amp;quot;,
+          {weights_fraction(FW, F)},
+          &#39;[0-9]*&#39;(FW)
       )
-  ),
-  {   number_integer_parts(UnsignedN, IntegerPart, Fractional),
-      N is copysign(UnsignedN, Sign)
-  }.
-gv_numeral(N) --&amp;gt;
-  {number_sign_parts(N, Sign, UnsignedN)},
-  sign_negative(Sign),
-  {number_integer_parts(UnsignedN, IntegerPart, Fractional)},
-  (   % [1] The fractional is zero, so only write the integer part
-      %     and do not write the decimal separator.
-      {Fractional =:= 0}
-  -&amp;gt;  integer(IntegerPart)
-  ;   % [2] The integer part is zero, so only write the fractional part,
-      %     preceded by the decimal separator.
-      {IntegerPart =:= 0}
-  -&amp;gt;  &amp;quot;.&amp;quot;,
-      integer(Fractional)
-  ;   % [3] Both the integer part and the fractional are non-zero,
-      %     so write both of them, with the decimal separator in-between.
-      integer(IntegerPart),
-      &amp;quot;.&amp;quot;,
-      integer(Fractional)
+  ;   &#39;[-]?&#39;(Sg),
+      (   &amp;quot;.&amp;quot;,
+          &#39;[0-9]+&#39;(FW),
+          {IW = []}
+      ;   &#39;[0-9]+&#39;(IW),
+          (   &amp;quot;.&amp;quot;,
+              &#39;[0-9]*&#39;(FW),
+          ;   {FW = []}
+          )
+      ),
+      {rational_parts_weights(N0, IW, FW)},
+      {N is copysign(N0, Sg)}
   ).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;77&#34;&gt; 77: 正在比较变动前 f390238 和变动后 c5f7d82 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index cf595d9..c9b3e1d 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -8,12 +8,15 @@
 /** &amp;lt;module&amp;gt; GraphViz numeral
 
 @author Wouter Beek
-@version 2014/05-2014/06
+@version 2014/05-2014/06, 2015/01
 */
 
 :- use_module(math(math_ext)).
+:- use_module(math(radix)).
+:- use_module(math(rational_ext)).
 
 :- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_abnf_common)).
 :- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_cardinal)).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;78&#34;&gt; 78: 正在比较变动前 c5f7d82 和变动后 acf6467 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index b68f753..157681f 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -49,6 +49,8 @@
 @version 2014/06, 2014/11-2015/01
 */
 
+:- use_module(library(dcg/basics), [float//1,integer//1]).
+
 :- use_module(plDcg(dcg_abnf)).
 :- use_module(plDcg(dcg_ascii)).
 :- use_module(plDcg(dcg_atom)).
diff --git a/gv_color.pl b/gv_color.pl
index 2263fa1..7aea965 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -13,10 +13,11 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06, 2014/10-2014/11
+@version 2014/06, 2014/10-2014/11, 2015/01
 */
 
 :- use_module(library(apply)).
+:- use_module(library(dcg/basics), [float//1]).
 :- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
diff --git a/gv_numeral.pl b/gv_numeral.pl
index c9b3e1d..439a024 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -77,7 +77,7 @@ gv_numeral(N) --&amp;gt;
           {IW = []}
       ;   &#39;[0-9]+&#39;(IW),
           (   &amp;quot;.&amp;quot;,
-              &#39;[0-9]*&#39;(FW),
+              &#39;[0-9]*&#39;(FW)
           ;   {FW = []}
           )
       ),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;79&#34;&gt; 79: 正在比较变动前 acf6467 和变动后 6656a2d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 157681f..3ae0920 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -59,7 +59,6 @@
 :- use_module(plDcg(dcg_generics)).
 :- use_module(plDcg(dcg_quote)).
 :- use_module(plDcg(dcg_replace)).
-:- use_module(plDcg(language/c)).
 
 :- use_module(plGraphViz(gv_html)).
 
@@ -109,7 +108,7 @@ gv_attr_type(viewPort).
 
 addDouble(N) --&amp;gt;
   (&amp;quot;+&amp;quot; ; &amp;quot;&amp;quot;),
-  c_double(N).
+  float(N).
 
 
 
@@ -198,7 +197,7 @@ dirType(none).
 %! double(+Double:float)// .
 
 double(N) --&amp;gt;
-  c_double(N).
+  float(N).
 
 
 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index 439a024..5776a4a 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -22,6 +22,8 @@
 
 
 
+
+
 %! gv_numeral(?Value:compound)// .
 %
 % # Syntax
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;80&#34;&gt; 80: 正在比较变动前 6656a2d 和变动后 256c9ce &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 3c731a0..06aa96f 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 3c731a03db6ee32031815d24c505e784273f46ef
+Subproject commit 06aa96fbeef941157e9bcccc7c088d72ba8c8d3a
diff --git a/plDcg b/plDcg
index d2e4a8a..2f2ae3a 160000
--- a/plDcg
+++ b/plDcg
@@ -1 +1 @@
-Subproject commit d2e4a8a094b7c405222574a4f9fe8c472296d7e6
+Subproject commit 2f2ae3a9228e8add2dfa4835ff045a3635a062ba
diff --git a/plHtml b/plHtml
index dfd7c27..b8bd7a6 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit dfd7c27dfd102e8eb6bfd9c516fccfcd23b5abf0
+Subproject commit b8bd7a6d92f1076a5be2c4686e998a0bfc840ac8
diff --git a/plUri b/plUri
index 0be7e9c..6550f33 160000
--- a/plUri
+++ b/plUri
@@ -1 +1 @@
-Subproject commit 0be7e9cae7b42dea30f08aa751438d382387b8a2
+Subproject commit 6550f331120c7f63739f69692791760afb507280
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;81&#34;&gt; 81: 正在比较变动前 256c9ce 和变动后 bf4ebea &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
index 6c22435..26ddd86 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,9 +4,6 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
-[submodule &amp;quot;plDcg&amp;quot;]
-	path = plDcg
-	url = https://github.com/wouterbeek/plDcg.git
 [submodule &amp;quot;plUri&amp;quot;]
 	path = plUri
 	url = https://github.com/wouterbeek/plUri.git
diff --git a/debug_project.pl b/debug_project.pl
index 17195c1..d53a92f 100644
--- a/debug_project.pl
+++ b/debug_project.pl
@@ -1,7 +1,8 @@
 :- module(
   debug_project,
   [
-    debug_all_files/0
+    debug_all_files/0,
+    start_pldoc_server/0
   ]
 ).
 
@@ -11,20 +12,35 @@ Generic code for debugging a project:
   * Load all subdirectories and Prolog files contained in those directories.
 
 @author Wouter Beek
-@version 2014/11/19
+@version 2015/02/26
 */
 
 :- use_module(library(ansi_term)).
 :- use_module(library(apply)).
+:- use_module(library(pldoc)).
+:- use_module(library(portray_text)).
+
+:- set_prolog_flag(
+  answer_write_options,
+  [max_depth(100),portrayed(true),spacing(next_argument)]
+).
+:- set_prolog_flag(
+  debugger_write_options,
+  [max_depth(100),portrayed(true),spacing(next_argument)]
+).
+:- set_portray_text(ellipsis, 1000).
+
+:- dynamic(user:debug_mode).
+:- multifile(user:debug_mode).
+
+:- initialization(init_debug_mode).
 
-:- use_module(os(dir_ext)).
 
-% Avoid errors when using gtrace/0 in threads.
-:- initialization(guitracer).
 
 
 
 debug_all_files:-
+  ensure_loaded(plc(io/dir_ext)),
   absolute_file_name(project(.), Dir, [access(read),file_type(directory)]),
   directory_files(
     Dir,
@@ -55,6 +71,30 @@ do_not_load0(index).
 do_not_load0(load).
 do_not_load0(load_project).
 do_not_load0(run).
+do_not_load0(style).
+
+
+
+%! start_pldoc_server is det.
+% The plDoc server should be started *before* documented modules are loaded.
+
+start_pldoc_server:-
+  doc_server(9999).
+
+
+
+
+
+% INITIALIZATION
+
+init_debug_mode:-
+  % Set the debug mode flag.
+  (   user:debug_mode
+  -&amp;gt;  true
+  ;   assert(user:debug_mode)
+  ),
+  % Avoid errors when using gtrace/0 in threads.
+  guitracer.
 
 
 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 3ae0920..9794eef 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -51,14 +51,14 @@
 
 :- use_module(library(dcg/basics), [float//1,integer//1]).
 
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_cardinal)).
-:- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generics)).
-:- use_module(plDcg(dcg_quote)).
-:- use_module(plDcg(dcg_replace)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_ascii)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_cardinal)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(dcg/dcg_generics)).
+:- use_module(plc(dcg/dcg_quote)).
+:- use_module(plc(dcg/dcg_replace)).
 
 :- use_module(plGraphViz(gv_html)).
 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 0fa4dcc..4e7ae2d 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -18,17 +18,16 @@ Support for GraphViz attributes.
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(generics(db_ext)).
-:- use_module(os(file_ext)).
-:- use_module(os(file_gnu)).
-
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_meta)).
-:- use_module(plDcg(dcg_generics)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(dcg/dcg_meta)).
+:- use_module(plc(dcg/dcg_generics)).
+:- use_module(plc(generics/db_ext)).
+:- use_module(plc(io/file_ext)).
+:- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
+:- use_module(plHtml(elements/html_table)).
 
 :- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
 
@@ -100,7 +99,7 @@ gv_attr_value(Context, Name=Value) --&amp;gt;
 
 
 
-% HELPERS
+% HELPERS %
 
 %! check_minimum(+Value:atom, +Minimum:number) is semidet.
 % Trivially succeeds if no minimum value is available for a given attribute.
@@ -112,7 +111,9 @@ check_minimum(V, Min1):-
 
 
 
-% INITIALIZATION
+
+
+% INITIALIZATION %
 
 %! assert_gv_attr_row(+Row:list(atom)) is det.
 
diff --git a/gv_color.pl b/gv_color.pl
index 7aea965..34d99eb 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -22,19 +22,18 @@
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(generics(db_ext)).
-:- use_module(generics(persistent_db_ext)).
-:- use_module(os(file_ext)).
-:- use_module(os(file_gnu)).
-
-:- use_module(plDcg(abnf_core_rules)).
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_cardinal)).
-:- use_module(plDcg(dcg_content)).
+:- use_module(plc(dcg/abnf_core_rules)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_cardinal)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(generics/db_ext)).
+:- use_module(plc(generics/persistent_db_ext)).
+:- use_module(plc(io/file_ext)).
+:- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
+:- use_module(plHtml(elements/html_table)).
 
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
@@ -46,6 +45,8 @@
 
 
 
+
+
 % color(+Color:compound)// .
 % A *color* is represented by a compound term of one of the following forms:
 %   1. `rgb(Red:nonneg,Green:nonneg,Blue:nonneg)`
@@ -89,7 +90,9 @@ wc_weight(Float) --&amp;gt;
 
 
 
-% INITIALIZATION
+
+
+% INITIALIZATION %
 
 %! gv_color_download is det.
 
diff --git a/gv_dot.pl b/gv_dot.pl
index e047a74..19657f5 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -29,15 +29,15 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 :- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(ordsets)).
 
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_arrow)).
-:- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_bracket)).
-:- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generics)).
-:- use_module(plDcg(dcg_meta)).
-:- use_module(plDcg(dcg_quote)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_arrow)).
+:- use_module(plc(dcg/dcg_ascii)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_bracket)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(dcg/dcg_generics)).
+:- use_module(plc(dcg/dcg_meta)).
+:- use_module(plc(dcg/dcg_quote)).
 
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
diff --git a/gv_file.pl b/gv_file.pl
index d191e10..6cb739f 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -28,9 +28,9 @@ and GraphViz output files or SVG DOM structures.
 :- use_module(library(option)).
 :- use_module(library(process)).
 
-:- use_module(generics(code_ext)).
-:- use_module(os(file_ext)).
-:- use_module(os(run_ext)).
+:- use_module(plc(generics/code_ext)).
+:- use_module(plc(io/file_ext)).
+:- use_module(plc(process/run_ext)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -41,18 +41,18 @@ user:prolog_file_type(dot, dot).
 user:prolog_file_type(pdf, pdf).
 
 :- predicate_options(codes_to_gv_file/3, 3, [
-     pass_to(file_to_gv/3, 3)
-   ]).
+  pass_to(file_to_gv/3, 3)
+]).
 :- predicate_options(file_to_gv/2, 2, [
-     pass_to(file_to_gv/3, 3)
-   ]).
+  pass_to(file_to_gv/3, 3)
+]).
 :- predicate_options(file_to_gv/3, 3, [
-     method(+atom),
-     output(+atom)
-   ]).
+  method(+atom),
+  output(+atom)
+]).
 :- predicate_options(export_graph_to_gv_file/3, 3, [
-     pass_to(codes_to_gv_file/3, 3)
-   ]).
+  pass_to(codes_to_gv_file/3, 3)
+]).
 
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 1410c25..65ae2bd 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -43,9 +43,9 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 @version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_bracket)).
-:- use_module(plDcg(dcg_content)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_bracket)).
+:- use_module(plc(dcg/dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index 5776a4a..ac294b4 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -11,14 +11,13 @@
 @version 2014/05-2014/06, 2015/01
 */
 
-:- use_module(math(math_ext)).
-:- use_module(math(radix)).
-:- use_module(math(rational_ext)).
-
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_abnf_common)).
-:- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_cardinal)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_abnf_common)).
+:- use_module(plc(dcg/dcg_ascii)).
+:- use_module(plc(dcg/dcg_cardinal)).
+:- use_module(plc(math/math_ext)).
+:- use_module(plc(math/radix)).
+:- use_module(plc(math/rational_ext)).
 
 
 
diff --git a/load.pl b/load.pl
index 5cec32c..de8b5ca 100644
--- a/load.pl
+++ b/load.pl
@@ -7,7 +7,6 @@
 :- use_module(load_project).
 :- load_project([
     plc-&#39;Prolog-Library-Collection&#39;,
-    plDcg,
     plHtml,
     plUri
 ]).
diff --git a/plDcg b/plDcg
deleted file mode 160000
index 2f2ae3a..0000000
--- a/plDcg
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 2f2ae3a9228e8add2dfa4835ff045a3635a062ba
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;82&#34;&gt; 82: 正在比较变动前 bf4ebea 和变动后 70aec99 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
index 26ddd86..6c22435 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,6 +4,9 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
+[submodule &amp;quot;plDcg&amp;quot;]
+	path = plDcg
+	url = https://github.com/wouterbeek/plDcg.git
 [submodule &amp;quot;plUri&amp;quot;]
 	path = plUri
 	url = https://github.com/wouterbeek/plUri.git
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 06aa96f..9d0e491 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 06aa96fbeef941157e9bcccc7c088d72ba8c8d3a
+Subproject commit 9d0e49135bbd1916d901ccd18be605699f48c5cc
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 9794eef..3ae0920 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -51,14 +51,14 @@
 
 :- use_module(library(dcg/basics), [float//1,integer//1]).
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_ascii)).
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_cardinal)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(dcg/dcg_generics)).
-:- use_module(plc(dcg/dcg_quote)).
-:- use_module(plc(dcg/dcg_replace)).
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_atom)).
+:- use_module(plDcg(dcg_cardinal)).
+:- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_generics)).
+:- use_module(plDcg(dcg_quote)).
+:- use_module(plDcg(dcg_replace)).
 
 :- use_module(plGraphViz(gv_html)).
 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 4e7ae2d..25519af 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -18,16 +18,17 @@ Support for GraphViz attributes.
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(dcg/dcg_meta)).
-:- use_module(plc(dcg/dcg_generics)).
-:- use_module(plc(generics/db_ext)).
-:- use_module(plc(io/file_ext)).
-:- use_module(plc(io/file_gnu)).
+:- use_module(generics(db_ext)).
+:- use_module(os(file_ext)).
+:- use_module(os(file_gnu)).
+
+:- use_module(plDcg(dcg_atom)).
+:- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_meta)).
+:- use_module(plDcg(dcg_generics)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(elements/html_table)).
+:- use_module(plHtml(html_table)).
 
 :- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
 
@@ -80,16 +81,16 @@ gv_attr_value(Context, Name=Value) --&amp;gt;
     % Check the validity of the context argument.
     gv_attr(Name, UsedBy, Types, _, Minimum, _),
     memberchk(Context, UsedBy),
-    
+
     %  Pick a value type non-deterministically.
     member(Type, Types),
-    
+
     % The `style` type is the only one that requires the context argument.
     (   Type == style
     -&amp;gt;  Dcg =.. [Type,Context]
     ;   Dcg =.. [Type]
     ),
-    
+
     % Check validity of Value w.r.t. minimum value -- if available.
     check_minimum(Value, Minimum)
   },
@@ -99,7 +100,7 @@ gv_attr_value(Context, Name=Value) --&amp;gt;
 
 
 
-% HELPERS %
+% HELPERS
 
 %! check_minimum(+Value:atom, +Minimum:number) is semidet.
 % Trivially succeeds if no minimum value is available for a given attribute.
@@ -111,9 +112,7 @@ check_minimum(V, Min1):-
 
 
 
-
-
-% INITIALIZATION %
+% INITIALIZATION
 
 %! assert_gv_attr_row(+Row:list(atom)) is det.
 
@@ -130,13 +129,8 @@ assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
 
 gv_attrs_download:-
   gv_attrs_url(Url),
-  download_html_dom(Url, Dom, [html_dialect(html4),verbose(silent)]),
-
+  download_html_dom(Url, Dom, [dialect(html4),silent(true)]),
   xpath(Dom, //table(@align=center), TableDom),
-  % @tbd This does not work, since in `record_name(Element, Name)`,
-  %      `Element` is a signleton list whereas a compound term is expected.
-  %%%%xpath(Dom, /html/body/table, TableDom),
-
   html_to_table(TableDom, _, Rows),
   maplist(assert_gv_attr_row, Rows).
 
diff --git a/gv_color.pl b/gv_color.pl
index 34d99eb..7aea965 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -22,18 +22,19 @@
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(plc(dcg/abnf_core_rules)).
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_cardinal)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(generics/db_ext)).
-:- use_module(plc(generics/persistent_db_ext)).
-:- use_module(plc(io/file_ext)).
-:- use_module(plc(io/file_gnu)).
+:- use_module(generics(db_ext)).
+:- use_module(generics(persistent_db_ext)).
+:- use_module(os(file_ext)).
+:- use_module(os(file_gnu)).
+
+:- use_module(plDcg(abnf_core_rules)).
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_atom)).
+:- use_module(plDcg(dcg_cardinal)).
+:- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(elements/html_table)).
+:- use_module(plHtml(html_table)).
 
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
@@ -45,8 +46,6 @@
 
 
 
-
-
 % color(+Color:compound)// .
 % A *color* is represented by a compound term of one of the following forms:
 %   1. `rgb(Red:nonneg,Green:nonneg,Blue:nonneg)`
@@ -90,9 +89,7 @@ wc_weight(Float) --&amp;gt;
 
 
 
-
-
-% INITIALIZATION %
+% INITIALIZATION
 
 %! gv_color_download is det.
 
diff --git a/gv_dot.pl b/gv_dot.pl
index 19657f5..e047a74 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -29,15 +29,15 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 :- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(ordsets)).
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_arrow)).
-:- use_module(plc(dcg/dcg_ascii)).
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_bracket)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(dcg/dcg_generics)).
-:- use_module(plc(dcg/dcg_meta)).
-:- use_module(plc(dcg/dcg_quote)).
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_arrow)).
+:- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_atom)).
+:- use_module(plDcg(dcg_bracket)).
+:- use_module(plDcg(dcg_content)).
+:- use_module(plDcg(dcg_generics)).
+:- use_module(plDcg(dcg_meta)).
+:- use_module(plDcg(dcg_quote)).
 
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
diff --git a/gv_file.pl b/gv_file.pl
index 6cb739f..d191e10 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -28,9 +28,9 @@ and GraphViz output files or SVG DOM structures.
 :- use_module(library(option)).
 :- use_module(library(process)).
 
-:- use_module(plc(generics/code_ext)).
-:- use_module(plc(io/file_ext)).
-:- use_module(plc(process/run_ext)).
+:- use_module(generics(code_ext)).
+:- use_module(os(file_ext)).
+:- use_module(os(run_ext)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -41,18 +41,18 @@ user:prolog_file_type(dot, dot).
 user:prolog_file_type(pdf, pdf).
 
 :- predicate_options(codes_to_gv_file/3, 3, [
-  pass_to(file_to_gv/3, 3)
-]).
+     pass_to(file_to_gv/3, 3)
+   ]).
 :- predicate_options(file_to_gv/2, 2, [
-  pass_to(file_to_gv/3, 3)
-]).
+     pass_to(file_to_gv/3, 3)
+   ]).
 :- predicate_options(file_to_gv/3, 3, [
-  method(+atom),
-  output(+atom)
-]).
+     method(+atom),
+     output(+atom)
+   ]).
 :- predicate_options(export_graph_to_gv_file/3, 3, [
-  pass_to(codes_to_gv_file/3, 3)
-]).
+     pass_to(codes_to_gv_file/3, 3)
+   ]).
 
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 65ae2bd..1410c25 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -43,9 +43,9 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 @version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_bracket)).
-:- use_module(plc(dcg/dcg_content)).
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_bracket)).
+:- use_module(plDcg(dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index ac294b4..5776a4a 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -11,13 +11,14 @@
 @version 2014/05-2014/06, 2015/01
 */
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_abnf_common)).
-:- use_module(plc(dcg/dcg_ascii)).
-:- use_module(plc(dcg/dcg_cardinal)).
-:- use_module(plc(math/math_ext)).
-:- use_module(plc(math/radix)).
-:- use_module(plc(math/rational_ext)).
+:- use_module(math(math_ext)).
+:- use_module(math(radix)).
+:- use_module(math(rational_ext)).
+
+:- use_module(plDcg(dcg_abnf)).
+:- use_module(plDcg(dcg_abnf_common)).
+:- use_module(plDcg(dcg_ascii)).
+:- use_module(plDcg(dcg_cardinal)).
 
 
 
diff --git a/load.pl b/load.pl
index de8b5ca..5cec32c 100644
--- a/load.pl
+++ b/load.pl
@@ -7,6 +7,7 @@
 :- use_module(load_project).
 :- load_project([
     plc-&#39;Prolog-Library-Collection&#39;,
+    plDcg,
     plHtml,
     plUri
 ]).
diff --git a/plDcg b/plDcg
new file mode 160000
index 0000000..45a2d2b
--- /dev/null
+++ b/plDcg
@@ -0,0 +1 @@
+Subproject commit 45a2d2b3ce1e3e18533586005b2a6a63eb2300d0
diff --git a/plHtml b/plHtml
index b8bd7a6..c2491cb 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit b8bd7a6d92f1076a5be2c4686e998a0bfc840ac8
+Subproject commit c2491cb789baef4b2c7b9e30ca79d65a7213af02
diff --git a/plUri b/plUri
index 6550f33..f1696b3 160000
--- a/plUri
+++ b/plUri
@@ -1 +1 @@
-Subproject commit 6550f331120c7f63739f69692791760afb507280
+Subproject commit f1696b3c41635b4c6af3e961e819a5e6c0bf5b75
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;83&#34;&gt; 83: 正在比较变动前 70aec99 和变动后 e06e6ba &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
index 6c22435..26ddd86 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -4,9 +4,6 @@
 [submodule &amp;quot;plHtml&amp;quot;]
 	path = plHtml
 	url = https://github.com/wouterbeek/plHtml.git
-[submodule &amp;quot;plDcg&amp;quot;]
-	path = plDcg
-	url = https://github.com/wouterbeek/plDcg.git
 [submodule &amp;quot;plUri&amp;quot;]
 	path = plUri
 	url = https://github.com/wouterbeek/plUri.git
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 3ae0920..9794eef 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -51,14 +51,14 @@
 
 :- use_module(library(dcg/basics), [float//1,integer//1]).
 
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_cardinal)).
-:- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generics)).
-:- use_module(plDcg(dcg_quote)).
-:- use_module(plDcg(dcg_replace)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_ascii)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_cardinal)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(dcg/dcg_generics)).
+:- use_module(plc(dcg/dcg_quote)).
+:- use_module(plc(dcg/dcg_replace)).
 
 :- use_module(plGraphViz(gv_html)).
 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 25519af..68f42db 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -18,17 +18,16 @@ Support for GraphViz attributes.
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(generics(db_ext)).
-:- use_module(os(file_ext)).
-:- use_module(os(file_gnu)).
-
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_meta)).
-:- use_module(plDcg(dcg_generics)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(dcg/dcg_meta)).
+:- use_module(plc(dcg/dcg_generics)).
+:- use_module(plc(generics/db_ext)).
+:- use_module(plc(io/file_ext)).
+:- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
+:- use_module(plHtml(elements/html_table)).
 
 :- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
 
@@ -100,7 +99,7 @@ gv_attr_value(Context, Name=Value) --&amp;gt;
 
 
 
-% HELPERS
+% HELPERS %
 
 %! check_minimum(+Value:atom, +Minimum:number) is semidet.
 % Trivially succeeds if no minimum value is available for a given attribute.
@@ -112,7 +111,9 @@ check_minimum(V, Min1):-
 
 
 
-% INITIALIZATION
+
+
+% INITIALIZATION %
 
 %! assert_gv_attr_row(+Row:list(atom)) is det.
 
diff --git a/gv_color.pl b/gv_color.pl
index 7aea965..34d99eb 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -22,19 +22,18 @@
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(generics(db_ext)).
-:- use_module(generics(persistent_db_ext)).
-:- use_module(os(file_ext)).
-:- use_module(os(file_gnu)).
-
-:- use_module(plDcg(abnf_core_rules)).
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_cardinal)).
-:- use_module(plDcg(dcg_content)).
+:- use_module(plc(dcg/abnf_core_rules)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_cardinal)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(generics/db_ext)).
+:- use_module(plc(generics/persistent_db_ext)).
+:- use_module(plc(io/file_ext)).
+:- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
+:- use_module(plHtml(elements/html_table)).
 
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
@@ -46,6 +45,8 @@
 
 
 
+
+
 % color(+Color:compound)// .
 % A *color* is represented by a compound term of one of the following forms:
 %   1. `rgb(Red:nonneg,Green:nonneg,Blue:nonneg)`
@@ -89,7 +90,9 @@ wc_weight(Float) --&amp;gt;
 
 
 
-% INITIALIZATION
+
+
+% INITIALIZATION %
 
 %! gv_color_download is det.
 
diff --git a/gv_dot.pl b/gv_dot.pl
index e047a74..19657f5 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -29,15 +29,15 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 :- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(ordsets)).
 
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_arrow)).
-:- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_atom)).
-:- use_module(plDcg(dcg_bracket)).
-:- use_module(plDcg(dcg_content)).
-:- use_module(plDcg(dcg_generics)).
-:- use_module(plDcg(dcg_meta)).
-:- use_module(plDcg(dcg_quote)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_arrow)).
+:- use_module(plc(dcg/dcg_ascii)).
+:- use_module(plc(dcg/dcg_atom)).
+:- use_module(plc(dcg/dcg_bracket)).
+:- use_module(plc(dcg/dcg_content)).
+:- use_module(plc(dcg/dcg_generics)).
+:- use_module(plc(dcg/dcg_meta)).
+:- use_module(plc(dcg/dcg_quote)).
 
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
diff --git a/gv_file.pl b/gv_file.pl
index d191e10..6cb739f 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -28,9 +28,9 @@ and GraphViz output files or SVG DOM structures.
 :- use_module(library(option)).
 :- use_module(library(process)).
 
-:- use_module(generics(code_ext)).
-:- use_module(os(file_ext)).
-:- use_module(os(run_ext)).
+:- use_module(plc(generics/code_ext)).
+:- use_module(plc(io/file_ext)).
+:- use_module(plc(process/run_ext)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -41,18 +41,18 @@ user:prolog_file_type(dot, dot).
 user:prolog_file_type(pdf, pdf).
 
 :- predicate_options(codes_to_gv_file/3, 3, [
-     pass_to(file_to_gv/3, 3)
-   ]).
+  pass_to(file_to_gv/3, 3)
+]).
 :- predicate_options(file_to_gv/2, 2, [
-     pass_to(file_to_gv/3, 3)
-   ]).
+  pass_to(file_to_gv/3, 3)
+]).
 :- predicate_options(file_to_gv/3, 3, [
-     method(+atom),
-     output(+atom)
-   ]).
+  method(+atom),
+  output(+atom)
+]).
 :- predicate_options(export_graph_to_gv_file/3, 3, [
-     pass_to(codes_to_gv_file/3, 3)
-   ]).
+  pass_to(codes_to_gv_file/3, 3)
+]).
 
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 1410c25..65ae2bd 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -43,9 +43,9 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 @version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
 */
 
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_bracket)).
-:- use_module(plDcg(dcg_content)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_bracket)).
+:- use_module(plc(dcg/dcg_content)).
 
 :- use_module(plHtml(html_dcg)).
 
diff --git a/gv_numeral.pl b/gv_numeral.pl
index 5776a4a..ac294b4 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -11,14 +11,13 @@
 @version 2014/05-2014/06, 2015/01
 */
 
-:- use_module(math(math_ext)).
-:- use_module(math(radix)).
-:- use_module(math(rational_ext)).
-
-:- use_module(plDcg(dcg_abnf)).
-:- use_module(plDcg(dcg_abnf_common)).
-:- use_module(plDcg(dcg_ascii)).
-:- use_module(plDcg(dcg_cardinal)).
+:- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_abnf_common)).
+:- use_module(plc(dcg/dcg_ascii)).
+:- use_module(plc(dcg/dcg_cardinal)).
+:- use_module(plc(math/math_ext)).
+:- use_module(plc(math/radix)).
+:- use_module(plc(math/rational_ext)).
 
 
 
diff --git a/load.pl b/load.pl
index 5cec32c..de8b5ca 100644
--- a/load.pl
+++ b/load.pl
@@ -7,7 +7,6 @@
 :- use_module(load_project).
 :- load_project([
     plc-&#39;Prolog-Library-Collection&#39;,
-    plDcg,
     plHtml,
     plUri
 ]).
diff --git a/plDcg b/plDcg
deleted file mode 160000
index 45a2d2b..0000000
--- a/plDcg
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 45a2d2b3ce1e3e18533586005b2a6a63eb2300d0
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;84&#34;&gt; 84: 正在比较变动前 e06e6ba 和变动后 0fd12ca &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/plHtml b/plHtml
index c2491cb..37bd0bf 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit c2491cb789baef4b2c7b9e30ca79d65a7213af02
+Subproject commit 37bd0bf33676fc06f9153221715a2cf00c4065d0
diff --git a/plUri b/plUri
index f1696b3..6550f33 160000
--- a/plUri
+++ b/plUri
@@ -1 +1 @@
-Subproject commit f1696b3c41635b4c6af3e961e819a5e6c0bf5b75
+Subproject commit 6550f331120c7f63739f69692791760afb507280
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;85&#34;&gt; 85: 正在比较变动前 0fd12ca 和变动后 67c4157 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/README.md b/README.md
index eb8512b..b4e3017 100644
--- a/README.md
+++ b/README.md
@@ -1,26 +1,25 @@
 plGraphViz
 ==========
 
-Easily export graphs represented as Prolog terms to
- [GraphViz](http://www.graphviz.org/).
+This library allows you to easily export graphs represented as Prolog terms
+using [GraphViz](http://www.graphviz.org/), an advanced graph drawing library.
 The Prolog terms have the following form:
 
 ~~~prolog
 graph(Vertices, Edges, GraphAttrs)
 ~~~
 
-`Vertices` and `Edges` are lists of compounds terms of
- the following form:
+`Vertices` and `Edges` are lists of compound terms of the following form:
 
 ~~~prolog
 vertex(Id, VertexAttrs)
-edges(FromId, ToId, EdgeAttrs)
+edge(FromId, ToId, EdgeAttrs)
 ~~~
 
-`Id` identifies a vertex and need not occur in any of the edges
- (i.e., unconnected vertices are allowed).
+`Id` identifies a vertex and may or may not occur in any of the edges
+(i.e., unconnected vertices are allowed).
 `FromId` and `ToId` may occur in the list of vertices,
- in order to draw an edge between vertices with set attributes.
+in order to draw an edge between vertices with set attributes.
 
 Attributes have the form `Name=Value`.
 `GraphAttrs` are attributes of the graph.
@@ -28,13 +27,12 @@ Attributes have the form `Name=Value`.
 `EdgeAttrs` are attributes of the edge.
 
 Attribute values are given as Prolog terms as well,
- and are type-checked before exporting.
+and are type-checked before exporting.
 Many of the GraphViz attributes are supported.
 New ones are added on an as-needed bases
- (open an issue on Github if you want to see a specific feature added).
-Supports HTML-like labels, allowing complex tables to be shown
- inside vertices.
-Support for vertex clusters is currently under way.
+(open an issue on Github if you want to see a specific feature added!).
+HTML-like labels are supported, allowing complex tables to be shown
+inside vertices.
 
 ---
 
@@ -62,7 +60,7 @@ $ swipl run.pl
 ![](https://raw.githubusercontent.com/wouterbeek/plGraphViz/master/example1.png &amp;quot;Example graph.&amp;quot;)
 
 The graphic can be saved to a different file by instantiating
- the `File` argument.
+the `File` argument.
 
 ---
 
@@ -152,4 +150,3 @@ export_graph_to_gv_file(
 ---
 
 Developed during 2013-2014 by [Wouter Beek](http://www.wouterbeek.com).
-
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;86&#34;&gt; 86: 正在比较变动前 67c4157 和变动后 b972e2b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 68f42db..8ba1535 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -11,7 +11,7 @@
 Support for GraphViz attributes.
 
 @author Wouter Beek
-@version 2014/06, 2014/11-2014/12
+@version 2014/06, 2014/11-2014/12, 2015/03
 */
 
 :- use_module(library(apply)).
@@ -23,6 +23,7 @@ Support for GraphViz attributes.
 :- use_module(plc(dcg/dcg_meta)).
 :- use_module(plc(dcg/dcg_generics)).
 :- use_module(plc(generics/db_ext)).
+:- use_module(plc(generics/print_ext)).
 :- use_module(plc(io/file_ext)).
 :- use_module(plc(io/file_gnu)).
 
@@ -129,11 +130,16 @@ assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
 % Downloads the table describing GraphViz attributes from `graphviz.org`.
 
 gv_attrs_download:-
-  gv_attrs_url(Url),
-  download_html_dom(Url, Dom, [dialect(html4),silent(true)]),
-  xpath(Dom, //table(@align=center), TableDom),
-  html_to_table(TableDom, _, Rows),
-  maplist(assert_gv_attr_row, Rows).
+  report_on_process(
+    &#39;Updating GraphViz attributes table... &#39;,
+    (
+      gv_attrs_uri(Uri),
+      download_html_dom(Uri, Dom, [dialect(html5),silent(true)]),
+      xpath(Dom, //table(@align=lower_case(center)), TableDom),
+      html_to_table(TableDom, _, Rows),
+      maplist(assert_gv_attr_row, Rows)
+    )
+  ).
 
 
 %! gv_attrs_file(-File:atom) is det.
@@ -167,9 +173,9 @@ gv_attrs_update(_):-
   gv_attrs_download.
 
 
-%! gv_attrs_url(-Url:url) is det.
+%! gv_attrs_uri(-Url:url) is det.
 
-gv_attrs_url(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
+gv_attrs_uri(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
 
 
 %! safe_db_attach(+File:atom) is det.
diff --git a/gv_color.pl b/gv_color.pl
index 34d99eb..0ab3fa7 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -13,7 +13,7 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06, 2014/10-2014/11, 2015/01
+@version 2014/06, 2014/10-2014/11, 2015/01, 2015/03
 */
 
 :- use_module(library(apply)).
@@ -29,6 +29,7 @@
 :- use_module(plc(dcg/dcg_content)).
 :- use_module(plc(generics/db_ext)).
 :- use_module(plc(generics/persistent_db_ext)).
+:- use_module(plc(generics/print_ext)).
 :- use_module(plc(io/file_ext)).
 :- use_module(plc(io/file_gnu)).
 
@@ -97,11 +98,16 @@ wc_weight(Float) --&amp;gt;
 %! gv_color_download is det.
 
 gv_color_download:-
-  gv_color_url(Url),
-  download_html_dom(Url, Dom, [html_dialect(html4),verbose(silent)]),
-  xpath(Dom, //table(1), TableDom1),
-  xpath(Dom, //table(2), TableDom2),
-  maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2]).
+  report_on_process(
+    &#39;Updating the GraphViz color table...&#39;,
+    (
+      gv_color_uri(Uri),
+      download_html_dom(Uri, Dom, [html_dialect(html4),silent(true)]),
+      xpath(Dom, //table(1), TableDom1),
+      xpath(Dom, //table(2), TableDom2),
+      maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2])
+    )
+  ).
 
 assert_color_table(Colorscheme, TableDom):-
   html_to_table(TableDom, _, Rows),
@@ -141,7 +147,7 @@ gv_color_update(_):-
   gv_color_download.
 
 
-%! gv_color_url(-Url:url) is det.
+%! gv_color_uri(-Url:url) is det.
 
-gv_color_url(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
+gv_color_uri(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;87&#34;&gt; 87: 正在比较变动前 b972e2b 和变动后 8bbc84c &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 6cb739f..991df5f 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -22,7 +22,8 @@ Also converts between GraphViz DOT formatted files
 and GraphViz output files or SVG DOM structures.
 
 @author Wouter Beek
-@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08, 2014/11-2014/12
+@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08, 2014/11-2014/12,
+         2015/03
 */
 
 :- use_module(library(option)).
@@ -30,7 +31,8 @@ and GraphViz output files or SVG DOM structures.
 
 :- use_module(plc(generics/code_ext)).
 :- use_module(plc(io/file_ext)).
-:- use_module(plc(process/run_ext)).
+:- use_module(plc(process/process_ext)).
+:- use_module(plc(process/program_db)).
 
 :- use_module(plGraphViz(gv_dot)).
 
@@ -114,15 +116,12 @@ file_to_gv(InputFile, OutputFile, Options):-
   % Run the GraphViz conversion command in the shell.
   format(atom(OutputTypeFlag), &#39;-T~a&#39;, [OutputType]),
   format(atom(OutputFileFlag), &#39;-o~a&#39;, [OutputFile]),
-  process_create(
-    path(Method),
-    % @tbd Windows hack:
-    %%%%&#39;C:\\Program Files (x86)\\Graphviz2.38\\bin\\dot.exe&#39;,
+  atomic_list_concat([&#39;GraphViz&#39;,Method], &#39; &#39;, Program),
+  handle_process(
+    Method,
     [OutputTypeFlag,file(InputFile),OutputFileFlag],
-    [process(PID)]
-  ),
-  process_wait(PID, exit(ShellStatus)),
-  exit_code_handler(&#39;GraphViz&#39;, ShellStatus).
+    [detached(true),program(Program)]
+  ).
 
 
 
@@ -155,7 +154,7 @@ export_graph_to_gv_file(ExportGraph, OutputFile, Options):-
 
 open_dot(File):-
   once(find_program_by_file_type(dot, Program)),
-  run_program(Program, [File]).
+  handle_process(Program, [File], [program(&#39;GraphViz DOT&#39;)]).
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;88&#34;&gt; 88: 正在比较变动前 8bbc84c 和变动后 033fa14 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index 7193a38..e6bec15 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,4 +1,5 @@
 *~
 *#
 *.db
+*.log
 data/*
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index 9d0e491..ca7adb3 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit 9d0e49135bbd1916d901ccd18be605699f48c5cc
+Subproject commit ca7adb30da33a289e40b01e5e163f860d5c096c7
diff --git a/README.md b/README.md
index b4e3017..23a45db 100644
--- a/README.md
+++ b/README.md
@@ -48,7 +48,6 @@ $ git submodule update --init
 
 ~~~prolog
 $ swipl run.pl
-?- use_module(plGraphViz(gv_file)).
 ?- export_graph_to_gv_file(
      graph([vertex(1,[]),vertex(2,[])],[edge(1,2,[])],[]),
      File,
diff --git a/gv_file.pl b/gv_file.pl
index 991df5f..2e0539d 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -42,9 +42,6 @@ and GraphViz output files or SVG DOM structures.
 user:prolog_file_type(dot, dot).
 user:prolog_file_type(pdf, pdf).
 
-:- predicate_options(codes_to_gv_file/3, 3, [
-  pass_to(file_to_gv/3, 3)
-]).
 :- predicate_options(file_to_gv/2, 2, [
   pass_to(file_to_gv/3, 3)
 ]).
@@ -53,30 +50,13 @@ user:prolog_file_type(pdf, pdf).
   output(+atom)
 ]).
 :- predicate_options(export_graph_to_gv_file/3, 3, [
-  pass_to(codes_to_gv_file/3, 3)
+  pass_to(file_to_gv/3, 3)
 ]).
 
 
 
 
 
-%! codes_to_gv_file(
-%!   +Codes:list(code),
-%!   ?OutputFile:atom,
-%!   +Options:list(nvpair)
-%! ) is det.
-
-codes_to_gv_file(Codes, OutputFile, Options):-
-  absolute_file_name(data(tmp), TmpFile, [access(write),extensions([dot])]),
-  setup_call_cleanup(
-    open(TmpFile, write, Write, [encoding(utf8)]),
-    put_codes(Write, Codes),
-    close(Write)
-  ),
-  file_to_gv(TmpFile, OutputFile, Options).
-
-
-
 %! file_to_gv(+InputFile:atom, +Options:list(nvpair)) is det.
 
 file_to_gv(InputFile, Options):-
@@ -120,7 +100,7 @@ file_to_gv(InputFile, OutputFile, Options):-
   handle_process(
     Method,
     [OutputTypeFlag,file(InputFile),OutputFileFlag],
-    [detached(true),program(Program)]
+    [program(Program)]
   ).
 
 
@@ -142,19 +122,30 @@ file_to_gv(InputFile, OutputFile, Options):-
 
 export_graph_to_gv_file(ExportGraph, OutputFile, Options):-
   once(phrase(gv_graph(ExportGraph), Codes)),
-  codes_to_gv_file(Codes, OutputFile, Options).
+  
+  % Be thread-safe.
+  thread_self(Id),
+  atomic_list_concat([gv_file,Id], &#39;_&#39;, ThreadName),
+  absolute_file_name(
+    data(ThreadName),
+    TmpFile,
+    [access(write),extensions([dot])]
+  ),
+  setup_call_cleanup(
+    open(TmpFile, write, Write, [encoding(utf8)]),
+    put_codes(Write, Codes),
+    close(Write)
+  ),
+  file_to_gv(TmpFile, OutputFile, Options).
 
 
 
 %! open_dot(+File:atom) is det.
 % Opens the given DOT file.
-%
-% @tbd Test support on Windows.
-% @tbd Test support on OS-X.
 
 open_dot(File):-
   once(find_program_by_file_type(dot, Program)),
-  handle_process(Program, [File], [program(&#39;GraphViz DOT&#39;)]).
+  handle_process(Program, [file(File)], []).
 
 
 
diff --git a/plHtml b/plHtml
index 37bd0bf..2919705 160000
--- a/plHtml
+++ b/plHtml
@@ -1 +1 @@
-Subproject commit 37bd0bf33676fc06f9153221715a2cf00c4065d0
+Subproject commit 2919705d079b1ab28bf3c502a87d1648fd842ed3
diff --git a/plUri b/plUri
index 6550f33..1a55127 160000
--- a/plUri
+++ b/plUri
@@ -1 +1 @@
-Subproject commit 6550f331120c7f63739f69692791760afb507280
+Subproject commit 1a55127517ee0b0cf2ad4fecbe3f84402f5f4c12
diff --git a/run.pl b/run.pl
index 8bba736..8c751f4 100644
--- a/run.pl
+++ b/run.pl
@@ -7,3 +7,5 @@
   :- ensure_loaded(load).
 :- endif.
 
+:- use_module(plGraphViz(gv_file)).
+
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;89&#34;&gt; 89: 正在比较变动前 033fa14 和变动后 fdb5a9e &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 9794eef..ce8012b 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -212,7 +212,13 @@ doubleList(L) --&amp;gt;
 % @tbd Support for context-dependent replacements.
 
 escString(String) --&amp;gt;
-  {dcg_phrase(dcg_replace(double_quote, escaped_double_quote), String, String0)},
+  {
+    atom_phrase(
+      dcg_replace(double_quote, escaped_double_quote),
+      String,
+      String0
+    )
+  },
   quoted(atom(String0)).
 escaped_double_quote --&amp;gt;
   &amp;quot;\\\&amp;quot;&amp;quot;.
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 8ba1535..fc8529a 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -119,8 +119,8 @@ check_minimum(V, Min1):-
 %! assert_gv_attr_row(+Row:list(atom)) is det.
 
 assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
-  dcg_phrase(translate_usedby(UsedBy2), UsedBy1),
-  once(dcg_phrase(translate_type(Types2), Types1)),
+  atom_phrase(translate_usedby(UsedBy2), UsedBy1),
+  once(atom_phrase(translate_type(Types2), Types1)),
   sort(UsedBy2, UsedBy3),
   translate_default(Default1, Default2),
   assert_gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;90&#34;&gt; 90: 正在比较变动前 fdb5a9e 和变动后 6ec582e &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;91&#34;&gt; 91: 正在比较变动前 6ec582e 和变动后 68b53b8 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index fc8529a..20036b3 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -28,7 +28,7 @@ Support for GraphViz attributes.
 :- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(elements/html_table)).
+:- use_module(plHtml(element/html_table)).
 
 :- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
 
diff --git a/gv_color.pl b/gv_color.pl
index 0ab3fa7..7da7313 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -34,7 +34,7 @@
 :- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(elements/html_table)).
+:- use_module(plHtml(element/html_table)).
 
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;92&#34;&gt; 92: 正在比较变动前 68b53b8 和变动后 46e8f3c &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 20036b3..add0721 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -28,7 +28,7 @@ Support for GraphViz attributes.
 :- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(element/html_table)).
+:- use_module(plHtml(html_table)).
 
 :- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
 
diff --git a/gv_color.pl b/gv_color.pl
index 7da7313..41e153b 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -34,7 +34,7 @@
 :- use_module(plc(io/file_gnu)).
 
 :- use_module(plHtml(html)).
-:- use_module(plHtml(element/html_table)).
+:- use_module(plHtml(html_table)).
 
 :- db_add_novel(user:prolog_file_type(log, logging)).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;93&#34;&gt; 93: 正在比较变动前 46e8f3c 和变动后 3162d88 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_file.pl b/gv_file.pl
index 2e0539d..2c6ed93 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -113,7 +113,7 @@ file_to_gv(InputFile, OutputFile, Options):-
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
-%   - `method(+Method:atom`
+%   - `method(+Method:atom)`
 %     The algorithm used by GraphViz for positioning the tree nodes.
 %     Either =dot= (default) or =sfdp=.
 %   - `output(+FileType:atom)`
@@ -122,7 +122,7 @@ file_to_gv(InputFile, OutputFile, Options):-
 
 export_graph_to_gv_file(ExportGraph, OutputFile, Options):-
   once(phrase(gv_graph(ExportGraph), Codes)),
-  
+
   % Be thread-safe.
   thread_self(Id),
   atomic_list_concat([gv_file,Id], &#39;_&#39;, ThreadName),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;94&#34;&gt; 94: 正在比较变动前 3162d88 和变动后 714b2e0 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index ce8012b..1e3515c 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -49,7 +49,7 @@
 @version 2014/06, 2014/11-2015/01
 */
 
-:- use_module(library(dcg/basics), [float//1,integer//1]).
+:- use_module(library(dcg/basics)).
 
 :- use_module(plc(dcg/dcg_abnf)).
 :- use_module(plc(dcg/dcg_ascii)).
diff --git a/gv_attrs.pl b/gv_attrs.pl
index add0721..489ce51 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -15,6 +15,7 @@ Support for GraphViz attributes.
 */
 
 :- use_module(library(apply)).
+:- use_module(library(dcg/basics)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
diff --git a/gv_color.pl b/gv_color.pl
index 41e153b..c4c82b4 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -17,7 +17,7 @@
 */
 
 :- use_module(library(apply)).
-:- use_module(library(dcg/basics), [float//1]).
+:- use_module(library(dcg/basics)).
 :- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
diff --git a/gv_dot.pl b/gv_dot.pl
index 19657f5..637a5ab 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -26,6 +26,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 */
 
 :- use_module(library(apply)).
+:- use_module(library(dcg/basics)).
 :- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(ordsets)).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;95&#34;&gt; 95: 正在比较变动前 714b2e0 和变动后 af7a387 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 1e3515c..6d572ab 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -49,7 +49,7 @@
 @version 2014/06, 2014/11-2015/01
 */
 
-:- use_module(library(dcg/basics)).
+:- use_module(library(dcg/basics), except([string//1])).
 
 :- use_module(plc(dcg/dcg_abnf)).
 :- use_module(plc(dcg/dcg_ascii)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;96&#34;&gt; 96: 正在比较变动前 af7a387 和变动后 7b434e3 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_color.pl b/gv_color.pl
index c4c82b4..1f3f9d6 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -22,8 +22,8 @@
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(plc(dcg/abnf_core_rules)).
 :- use_module(plc(dcg/dcg_abnf)).
+:- use_module(plc(dcg/dcg_abnf_rules)).
 :- use_module(plc(dcg/dcg_atom)).
 :- use_module(plc(dcg/dcg_cardinal)).
 :- use_module(plc(dcg/dcg_content)).
diff --git a/gv_numeral.pl b/gv_numeral.pl
index ac294b4..bff1255 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -16,6 +16,7 @@
 :- use_module(plc(dcg/dcg_ascii)).
 :- use_module(plc(dcg/dcg_cardinal)).
 :- use_module(plc(math/math_ext)).
+:- use_module(plc(math/positional)).
 :- use_module(plc(math/radix)).
 :- use_module(plc(math/rational_ext)).
 
@@ -56,7 +57,7 @@ gv_numeral(N) --&amp;gt;
       (   % [1] The fractional is zero, so only write the integer part
           %     and do not write the decimal separator.
           {F =:= 0}
-      -&amp;gt;  {weights_nonneg(IW, I)},
+      -&amp;gt;  {positional(I, IW)},
           &#39;[0-9]+&#39;(IW)
       ;   % [2] The integer part is zero, so only write the fractional part,
           %     preceded by the decimal separator.
@@ -66,7 +67,7 @@ gv_numeral(N) --&amp;gt;
           &#39;[0-9]*&#39;(FW)
       ;   % [3] Both the integer part and the fractional are non-zero,
           %     so write both of them, with the decimal separator in-between.
-          {weights_nonneg(IW, I)},
+          {positional(I, IW)},
           &#39;[0-9]+&#39;(IW),
           &amp;quot;.&amp;quot;,
           {weights_fraction(FW, F)},
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;97&#34;&gt; 97: 正在比较变动前 7b434e3 和变动后 dcbcb4d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_dot.pl b/gv_dot.pl
index 637a5ab..e98361b 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -146,151 +146,14 @@ gv_generic_attributes_statement(_, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, KindAttrs) --&amp;gt;
   indent(I),
   gv_kind(Kind), &amp;quot; &amp;quot;,
-  bracketed(square, &#39;*&#39;(gv_attr(Kind), KindAttrs, [])),
-  line_feed.
-
-
-
-%! gv_graph(+Graph:compound)//
-% The follow graph attributes are supported,
-% beyond the GraphViz attributes for graphs:
-%   * `directed(+boolean)`
-%      Whether the graph is directed (`true`) or undirected (`false`).
-%      Default: `false`.
-%   * `name(+GraphName:atom)`
-%   * `strict(+StrictGraph:boolean)`
-%      This forbids the creation of self-arcs and multi-edges;
-%      they are ignored in the input file.
-%      Only in combinattion with directionality `directed`.
-%
-% ```abnf
-% graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
-% ```
-%
-% `GraphTerm` is a compound term of the following form:
-% ```prolog
-% graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
-% ```
-%
-% `RankedVertexTerms` is a list of compound terms of the following form:
-% ```prolog
-% rank(RankNode,ContentNodes)
-% ```
-%
-% @tbd Add support for subgraphs (arbitrary nesting).
-% @tbd Add support for escape strings:
-%      http://www.graphviz.org/doc/info/attrs.html#k:escString
-% @tbd Assert attributes that are generic with respect to a subgraph.
-% @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
-
-gv_graph(graph(VTerms,ETerms,GAttrs)) --&amp;gt;
-  gv_graph(graph(VTerms,[],ETerms,GAttrs)).
-
-gv_graph(graph(VTerms,RankedVTerms,ETerms,GAttrs1)) --&amp;gt;
-  {
-    shared_attributes(VTerms, SharedVAttrs, NewVTerms),
-    shared_attributes(ETerms, SharedEAttrs, NewETerms),
-    select_nvpair(strict=Strict, GAttrs1, GAttrs2, false),
-    select_nvpair(directed=Directed, GAttrs2, GAttrs3, true),
-    select_nvpair(name=GName, GAttrs3, GAttrs4, noname),
-    add_default_nvpair(GAttrs4, overlap, false, GAttrs5),
-    I = 0
-  },
-
-  % The first statement in the GraphViz output.
-  % States that this file represents a graph according to the GraphViz format.
-  indent(I),
-  gv_strict(Strict),
-  gv_graph_type(Directed), &amp;quot; &amp;quot;,
-  gv_id(GName), &amp;quot; &amp;quot;,
-
-  % The body of the DOT file appears between curly braces.
-  bracketed(
-    curly,
-    gv_graph0(
-      I,
-      NewVTerms, SharedVAttrs, RankedVTerms,
-      NewETerms, SharedEAttrs,
-      Directed, GAttrs5
-    )
-  ),
-  line_feed.
-
-gv_graph0(
-  I,
-  NewVTerms, SharedVAttrs, RankedVTerms,
-  NewETerms, SharedEAttrs,
-  Directed, GAttrs
-) --&amp;gt;
-  line_feed,
-
-  % The following lines are indented.
-  {NewI is I + 1},
-
-  % Attributes that apply to the graph as a whole.
-  gv_generic_attributes_statement(graph, NewI, GAttrs),
-
-  % Attributes that are the same for all nodes.
-  gv_generic_attributes_statement(node, NewI, SharedVAttrs),
-
-  % Attributes that are the same for all edges.
-  gv_generic_attributes_statement(edge, NewI, SharedEAttrs),
-
-  % Only add a line_feed if some content was already written
-  % and some content is about to be written.
-  (
-    {
-      % Succeeds if no content was written.
-      (GAttrs == [], SharedVAttrs == [], SharedEAttrs == [])
-    ;
-      % Succeeds if no content is about to be written.
-      (NewVTerms == [], RankedVTerms == [])
-    }
-  -&amp;gt;
-    &amp;quot;&amp;quot;
-  ;
-    line_feed
-  ),
-
-  % The list of GraphViz nodes.
-  &#39;*&#39;(gv_node_statement(NewI), NewVTerms, []),
-  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
-
-  % The ranked GraphViz nodes (displayed at the same height).
-  &#39;*&#39;(gv_ranked_node_collection(NewI), RankedVTerms, []),
-  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; line_feed),
-
-  {
-    findall(
-      edge(FromId,ToId,[]),
-      (
-        nth0(Index1, RankedVTerms, rank(vertex(FromId,_),_)),
-        nth0(Index2, RankedVTerms, rank(vertex(ToId,_),_)),
-        % We assume that the rank vertices are nicely ordered.
-        succ(Index1, Index2)
-      ),
-      RankEdges
-    )
-  },
-
-  % The rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed), RankEdges, []),
-
-  % The non-rank edges.
-  &#39;*&#39;(gv_edge_statement(NewI, Directed), NewETerms, []),
-
-  % Note that we do not include a line_feed here.
+  &amp;quot;[&amp;quot;,
+  gv_attrs(Kind, KindAttrs),
+  &amp;quot;]\n&amp;quot;.
 
-  % We want to indent the closing curly brace.
-  indent(I).
-
-
-
-%! gv_graph_type(+Directed:boolean)// .
-% The type of graph that is represented.
-
-gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_attrs(_, []) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_attrs(Kind, [H|T]) --&amp;gt;
+  gv_attr(Kind, H),
+  gv_attrs(Kind, T).
 
 
 
@@ -456,53 +319,3 @@ gv_ranked_node_collection(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
     indent(I)
   )),
   line_feed.
-
-
-
-%! gv_strict(+Strict:boolean)// is det.
-% The keyword denoting that the graph is strict, i.e., has no self-arcs and
-% no multi-edges.
-% This only applies to directed graphs.
-
-gv_strict(false) --&amp;gt; [].
-gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
-
-
-
-
-
-% HELPERS
-
-add_default_nvpair(Attrs1, N, Default, Attrs2):-
-  add_default_nvpair(Attrs1, N, Default, _, Attrs2).
-
-add_default_nvpair(Attrs, N, _, V, Attrs):-
-  memberchk(N=V, Attrs), !.
-add_default_nvpair(Attrs1, N, Default, Default, Attrs2):-
-  ord_add_element(Attrs1, N=Default, Attrs2).
-
-select_nvpair(N=V, Attrs1, Attrs2, _):-
-  memberchk(N=V, Attrs1), !,
-  select(N=V, Attrs1, Attrs2).
-select_nvpair(_=Default, Attrs, Attrs, Default).
-
-
-extract_shared([], []):- !.
-extract_shared(Argss, Shared):-
-  ord_intersection(Argss, Shared).
-
-remove_shared_attributes(Shared, Args1, Args2):-
-  ord_subtract(Args1, Shared, Args2).
-
-shared_attributes(Terms1, SharedAs, Terms2):-
-  maplist(term_to_attrs, Terms1, As1),
-  extract_shared(As1, SharedAs),
-  maplist(remove_shared_attributes(SharedAs), As1, As2),
-  maplist(term_change_attrs, Terms1, As2, Terms2).
-
-term_change_attrs(edge(From,To,_), A, edge(From,To,A)).
-term_change_attrs(vertex(Id,_), A, vertex(Id,A)).
-
-term_to_attrs(edge(_,_,A), A).
-term_to_attrs(vertex(_,A), A).
-
diff --git a/gv_file.pl b/gv_file.pl
index 2c6ed93..5d2228e 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -1,40 +1,24 @@
 :- module(
   gv_file,
   [
-    file_to_gv/2, % +InputFile:atom
-                  % +Options:list(nvpair)
-    file_to_gv/3, % +InputFile:atom
-                  % ?OutputFile:atom
-                  % +Options:list(nvpair)
-    export_graph_to_gv_file/3, % +ExportGraph:compound
-                               % ?OutputFile:atom
-                               % +Options:list(nvpair)
-    open_dot/1 % +File:file
+    gv_export/3 % +ExportGraph:compound
+                % +OutputFile:atom
+                % +Options:list(nvpair)
   ]
 ).
 
 /** &amp;lt;module&amp;gt; GraphViz file
 
-Predicates for converting GIF-formatted terms
-into GraphViz output files or SVG DOM structures.
-
-Also converts between GraphViz DOT formatted files
-and GraphViz output files or SVG DOM structures.
-
 @author Wouter Beek
-@version 2013/09, 2013/11-2014/01, 2014/05, 2014/07-2014/08, 2014/11-2014/12,
-         2015/03
+@version 2015/07
 */
 
+:- use_module(library(error)).
+:- use_module(library(gv/gv_dot)).
 :- use_module(library(option)).
 :- use_module(library(process)).
 
-:- use_module(plc(generics/code_ext)).
-:- use_module(plc(io/file_ext)).
 :- use_module(plc(process/process_ext)).
-:- use_module(plc(process/program_db)).
-
-:- use_module(plGraphViz(gv_dot)).
 
 :- dynamic(user:prolog_file_type/2).
 :- multifile(user:prolog_file_type/2).
@@ -42,29 +26,43 @@ and GraphViz output files or SVG DOM structures.
 user:prolog_file_type(dot, dot).
 user:prolog_file_type(pdf, pdf).
 
-:- predicate_options(file_to_gv/2, 2, [
-  pass_to(file_to_gv/3, 3)
-]).
-:- predicate_options(file_to_gv/3, 3, [
-  method(+atom),
-  output(+atom)
-]).
-:- predicate_options(export_graph_to_gv_file/3, 3, [
-  pass_to(file_to_gv/3, 3)
-]).
-
+:- predicate_options(gv_export/3, 3, [pass_to(file_to_gv/3, 3)]).
+:- predicate_options(file_to_gv/3, 3, [method(+atom),output(+atom)]).
 
 
 
+%! gv_export(
+%!   +ExportGraph:compound,
+%!   +OutputFile:atom,
+%!   +Options:list(nvpair)
+%! ) is det.
+% Returns a file containing a GraphViz visualization of the given graph.
+%
+% The following options are supported:
+%   - `method(+Method:atom)`
+%     The algorithm used by GraphViz for positioning the tree nodes.
+%     Either =dot= (default) or =sfdp=.
+%   - `output(+FileType:atom)`
+%     The file type of the generated GraphViz file.
+%     Default: `pdf`.
 
-%! file_to_gv(+InputFile:atom, +Options:list(nvpair)) is det.
+gv_export(ExportGraph, OutputFile, Options):-
+  once(phrase(gv_graph(ExportGraph), Codes)),
 
-file_to_gv(InputFile, Options):-
-  file_to_gv(InputFile, _, Options).
+  % Be thread-safe.
+  thread_self(Id),
+  atomic_list_concat([gv_file,Id], &#39;_&#39;, ThreadName),
+  absolute_file_name(data(ThreadName), TmpFile, [access(write),file_type(dot)]),
+  setup_call_cleanup(
+    open(TmpFile, write, Write, [encoding(utf8)]),
+    put_codes(Write, Codes),
+    close(Write)
+  ),
+  file_to_gv(TmpFile, OutputFile, Options).
 
 %! file_to_gv(
 %!   +InputFile:atom,
-%!   ?OutputFile:atom,
+%!   +OutputFile:atom,
 %!   +Options:list(nvpair)
 %! ) is det.
 % Converts a GraphViz DOT file to an image file, using a specific
@@ -87,12 +85,6 @@ file_to_gv(InputFile, OutputFile, Options):-
   findall(OutputType0, gv_output_type(OutputType0), OutputTypes),
   must_be(oneof(OutputTypes), OutputType),
 
-  % The output file is either given or created.
-  (   var(OutputFile)
-  -&amp;gt;  file_alternative(InputFile, _, _, OutputType, OutputFile)
-  ;   is_absolute_file_name(OutputFile)
-  ),
-
   % Run the GraphViz conversion command in the shell.
   format(atom(OutputTypeFlag), &#39;-T~a&#39;, [OutputType]),
   format(atom(OutputFileFlag), &#39;-o~a&#39;, [OutputFile]),
@@ -105,53 +97,7 @@ file_to_gv(InputFile, OutputFile, Options):-
 
 
 
-%! export_graph_to_gv_file(
-%!   +ExportGraph:compound,
-%!   ?OutputFile:atom,
-%!   +Options:list(nvpair)
-%! ) is det.
-% Returns a file containing a GraphViz visualization of the given graph.
-%
-% The following options are supported:
-%   - `method(+Method:atom)`
-%     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   - `output(+FileType:atom)`
-%     The file type of the generated GraphViz file.
-%     Default: `pdf`.
-
-export_graph_to_gv_file(ExportGraph, OutputFile, Options):-
-  once(phrase(gv_graph(ExportGraph), Codes)),
-
-  % Be thread-safe.
-  thread_self(Id),
-  atomic_list_concat([gv_file,Id], &#39;_&#39;, ThreadName),
-  absolute_file_name(
-    data(ThreadName),
-    TmpFile,
-    [access(write),extensions([dot])]
-  ),
-  setup_call_cleanup(
-    open(TmpFile, write, Write, [encoding(utf8)]),
-    put_codes(Write, Codes),
-    close(Write)
-  ),
-  file_to_gv(TmpFile, OutputFile, Options).
-
-
-
-%! open_dot(+File:atom) is det.
-% Opens the given DOT file.
-
-open_dot(File):-
-  once(find_program_by_file_type(dot, Program)),
-  handle_process(Program, [file(File)], []).
-
-
-
-
-
-% HELPERS
+% HELPERS %
 
 gv_method(circo).
 gv_method(dot).
@@ -162,7 +108,6 @@ gv_method(sfdp).
 gv_method(twopi).
 
 
-
 gv_output_type(bmp).
 gv_output_type(canon).
 gv_output_type(dot).
diff --git a/gv_graph.pl b/gv_graph.pl
new file mode 100644
index 0000000..dd4af97
--- /dev/null
+++ b/gv_graph.pl
@@ -0,0 +1,229 @@
+:- module(
+  gv_graph,
+  [
+    gv_graph//1 % +Graph:compound
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz graph
+
+@author Wouter Beek
+@version 2015/07
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(lists)).
+:- use_module(library(option)).
+
+
+
+%! gv_graph(+Graph:compound)//
+% The follow graph attributes are supported,
+% beyond the GraphViz attributes for graphs:
+%   * `directed(+boolean)`
+%      Whether the graph is directed (`true`) or undirected (`false`).
+%      Default: `false`.
+%   * `name(+GraphName:atom)`
+%   * `strict(+StrictGraph:boolean)`
+%      This forbids the creation of self-arcs and multi-edges;
+%      they are ignored in the input file.
+%      Only in combinattion with directionality `directed`.
+%
+% ```abnf
+% graph = [&amp;quot;strict&amp;quot;] (&amp;quot;graph&amp;quot; / &amp;quot;digraph&amp;quot;) [ID] &amp;quot;{&amp;quot; stmt_list &amp;quot;}&amp;quot;
+% ```
+%
+% `GraphTerm` is a compound term of the following form:
+% ```prolog
+% graph(VertexTerms,RankedVertexTerms,EdgeTerms,GraphAttributes)
+% ```
+%
+% `RankedVertexTerms` is a list of compound terms of the following form:
+% ```prolog
+% rank(RankNode,ContentNodes)
+% ```
+%
+% @tbd Add support for subgraphs (arbitrary nesting).
+% @tbd Add support for escape strings:
+%      http://www.graphviz.org/doc/info/attrs.html#k:escString
+% @tbd Assert attributes that are generic with respect to a subgraph.
+% @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
+
+gv_graph(G) --&amp;gt;
+  gv_graph(G, 0).
+
+gv_graph(G1, I) --&amp;gt;
+  {
+    include_ranks(G1, G2),
+    G2 = graph(VTerms,RankedVTerms,ETerms,GAttrs1),
+    shared_attributes(VTerms, SharedVAttrs, NewVTerms),
+    shared_attributes(ETerms, SharedEAttrs, NewETerms),
+    add_default(GAttrs1, overlap(false), GAttrs2),
+    I = 0
+  },
+
+  % The first statement in the GraphViz output.
+  % States that this file represents a graph according to the GraphViz format.
+  indent(I),
+  
+  % Strictness.
+  {select_option(strict(Strict), GAttrs2, GAttrs3, false)},
+  gv_strict(Strict),
+  
+  % Directedness.
+  {select_option(directed(Directed), GAttrs3, GAttrs4, true)},
+  gv_graph_type(Directed), &amp;quot; &amp;quot;,
+  
+  % Graph name.
+  (   {select_name(GName), GAttrs4, GAttrs5)}
+  -&amp;gt;  gv_id(GName), &amp;quot; &amp;quot;,
+  ;   {GAttrs5 = GAttrs4}
+  ),
+
+  % The body of the DOT file appears between curly braces.
+  &amp;quot;{\n&amp;quot;,
+
+  % The following lines are indented.
+  {NewI is I + 1},
+
+  % Attributes that apply to the graph as a whole.
+  gv_generic_attributes_statement(graph, NewI, GAttrs5),
+
+  % Attributes that are the same for all nodes.
+  gv_generic_attributes_statement(node, NewI, SharedVAttrs),
+
+  % Attributes that are the same for all edges.
+  gv_generic_attributes_statement(edge, NewI, SharedEAttrs),
+
+  % Only add a line_feed if some content was already written
+  % and some content is about to be written.
+  (   % Succeeds if no content was written.
+      {(GAttrs == [], SharedVAttrs == [], SharedEAttrs == [])}
+  -&amp;gt;  &amp;quot;&amp;quot;
+  ;   % Succeeds if no content is about to be written.
+      {(NewVTerms == [], RankedVTerms == [])}
+  -&amp;gt;  &amp;quot;&amp;quot;
+  ;   &amp;quot;\n&amp;quot;
+  ),
+
+  % The list of GraphViz nodes.
+  gv_node_statements(NewI, NewVTerms),
+  (   {NewVTerms == []}
+  -&amp;gt;  &amp;quot;&amp;quot;
+  ;   &amp;quot;\n&amp;quot;
+  ),
+
+  % The ranked GraphViz nodes (displayed at the same height).
+  gv_ranked_node_collections(NewI, RankedVTerms),
+  (   {RankedVTerms == []}
+  -&amp;gt;  &amp;quot;&amp;quot;
+  ;   &amp;quot;\n&amp;quot;
+  ),
+
+  {
+    findall(
+      edge(FromId,ToId,[]),
+      (
+        nth0(Index1, RankedVTerms, rank(vertex(FromId,_),_)),
+        nth0(Index2, RankedVTerms, rank(vertex(ToId,_),_)),
+        % We assume that the rank vertices are nicely ordered.
+        succ(Index1, Index2)
+      ),
+      RankEdges
+    )
+  },
+
+  % The rank edges.
+  gv_edge_statements(NewI, Directed, RankEdges),
+
+  % The non-rank edges.
+  gv_edge_statements(NewI, Directed, NewETerms),
+  
+  % Note that we do not include a line_feed here.
+
+  % We want to indent the closing curly brace.
+  indent(I),
+  &amp;quot;}\n&amp;quot;.
+
+gv_edge_statements(_, _, []) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_edge_statements(I, Dir, [H|T]) --&amp;gt;
+  gv_edge_statement(I, Dir, H),
+  gv_edge_statements(I, Dir, T).
+
+gv_node_statements(_, []) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_node_statements(I, [H|T]) --&amp;gt;
+  gv_node_statement(I, H),
+  gv_node_statements(I, T).
+
+gv_ranked_node_collections(_, []) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_ranked_node_collections(I, [H|T]) --&amp;gt;
+  gv_ranked_node_collection(I, H),
+  gv_ranked_node_collections(I, T),
+
+
+
+% HELPERS %
+
+%! add_default_option(
+%!   +Options:list(compound),
+%!   +Default:compound,
+%!   -NewOptions:list(compound)
+%! ) is det.
+
+add_default(L1, Opt, L2):-
+  Opt =.. [N,V],
+  Opt0 =.. [N,_],
+  (   option(Opt0, L1)
+  -&amp;gt;  true
+  ;   L2 = [Opt|L1]
+  ).
+
+
+%! gv_graph_type(+Directed:boolean)// is det.
+% The type of graph that is represented.
+
+gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
+
+
+%! gv_strict(+Strict:boolean)// is det.
+% The keyword denoting that the graph is strict, i.e., has no self-arcs and
+% no multi-edges.
+% This only applies to directed graphs.
+
+gv_strict(false) --&amp;gt; [].
+gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
+
+
+%! invlude_ranges(+Graph:compound, -GraphWithRanks:compound) is det.
+% Ensures that there is a ranks components in
+% the graph-denoting compound term.
+
+include_ranks(graph(Vs,Rs,Es,L), graph(Vs,Rs,Es,L)).
+include_ranks(graph(Vs,Es,L), graph(Vs,[],Es,L)).
+
+
+%! shared_attributes(
+%!   +Terms:list(compound),
+%!   -SharedAttributes:list(compound),
+%!   -NewTerms:list(compound)
+%! ) is det.
+
+shared_attributes(Ts1, Shared, Ts2):-
+  maplist(term_to_attrs, Ts1, L1),
+  extract_shared(L1, Shared),
+  maplist(remove_shared_attributes(Shared), L1, L2),
+  maplist(term_change_attrs, Ts1, L2, Ts2).
+
+term_to_attrs(edge(_,_,A), A).
+term_to_attrs(vertex(_,A), A).
+
+extract_shared([], []):- !.
+extract_shared(Argss, Shared):-
+  ord_intersection(Argss, Shared).
+
+remove_shared_attributes(Shared, Args1, Args2):-
+  ord_subtract(Args1, Shared, Args2).
+
+term_change_attrs(edge(From,To,_), A, edge(From,To,A)).
+term_change_attrs(vertex(Id,_), A, vertex(Id,A)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;98&#34;&gt; 98: 正在比较变动前 dcbcb4d 和变动后 50a3dbc &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
index ca7adb3..88874a7 160000
--- a/Prolog-Library-Collection
+++ b/Prolog-Library-Collection
@@ -1 +1 @@
-Subproject commit ca7adb30da33a289e40b01e5e163f860d5c096c7
+Subproject commit 88874a7f451df36309d1d6ade03bc7186b4f6c8b
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index 6d572ab..b3e41ca 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -51,15 +51,6 @@
 
 :- use_module(library(dcg/basics), except([string//1])).
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_ascii)).
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_cardinal)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(dcg/dcg_generics)).
-:- use_module(plc(dcg/dcg_quote)).
-:- use_module(plc(dcg/dcg_replace)).
-
 :- use_module(plGraphViz(gv_html)).
 
 
@@ -203,25 +194,32 @@ double(N) --&amp;gt;
 
 %! doubleList(+Doubles:list(float))// .
 
-doubleList(L) --&amp;gt;
-  &#39;+&#39;(double, L, [separator(colon)]).
+doubleList([]) --&amp;gt; !, &amp;quot;&amp;quot;.
+doubleList([H]) --&amp;gt; !, double(H)
+doubleList([H|T]) --&amp;gt; double(H), &amp;quot;:&amp;quot;, doubleList(T).
 
 
 
 %! escString(+String:atom)// .
 % @tbd Support for context-dependent replacements.
 
-escString(String) --&amp;gt;
+escString(S1) --&amp;gt;
   {
-    atom_phrase(
-      dcg_replace(double_quote, escaped_double_quote),
-      String,
-      String0
-    )
+    atom_codes(S1, Cs1),
+    phrase(escape_double_quotes, Cs1, Cs2),
+    atom_codes(S2, Cs2)
   },
-  quoted(atom(String0)).
-escaped_double_quote --&amp;gt;
-  &amp;quot;\\\&amp;quot;&amp;quot;.
+  &amp;quot;\&amp;quot;&amp;quot;,
+  atom(S2),
+  &amp;quot;\&amp;quot;&amp;quot;.
+
+escape_double_quotes, [92,34] --&amp;gt;
+  [34], !,
+  escape_double_quotes.
+escape_double_quotes, [X] --&amp;gt;
+  [X],
+  escape_double_quotes.
+
 
 
 
@@ -449,7 +447,9 @@ smoothType(triangle).
 % A GraphViz string.
 
 string(Content) --&amp;gt;
-  quoted(atom(Content)).
+  &amp;quot;\&amp;quot;&amp;quot;,
+  atom(Content),
+  &amp;quot;\&amp;quot;&amp;quot;.
 
 
 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 489ce51..1e8ccdf 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -6,34 +6,25 @@
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz: Attributes
-
-Support for GraphViz attributes.
+/** &amp;lt;module&amp;gt; GraphViz attributes
 
 @author Wouter Beek
-@version 2014/06, 2014/11-2014/12, 2015/03
+@version 2015/07
 */
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/basics)).
+:- use_module(library(lists)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(dcg/dcg_meta)).
-:- use_module(plc(dcg/dcg_generics)).
-:- use_module(plc(generics/db_ext)).
-:- use_module(plc(generics/print_ext)).
-:- use_module(plc(io/file_ext)).
-:- use_module(plc(io/file_gnu)).
-
-:- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
-
 :- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
+:- use_module(plGraphViz(gv_util)).
+
+:- dynamic(user:prolog_file_type/2).
+:- multifile(user:prolog_file_type/2).
 
-:- db_add_novel(user:prolog_file_type(log, logging)).
+user:prolog_file_type(log, logging).
 
 %! gv_attr(
 %!   ?Name:atom,
@@ -131,13 +122,13 @@ assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
 % Downloads the table describing GraphViz attributes from `graphviz.org`.
 
 gv_attrs_download:-
-  report_on_process(
+  verbose_process(
     &#39;Updating GraphViz attributes table... &#39;,
     (
       gv_attrs_uri(Uri),
-      download_html_dom(Uri, Dom, [dialect(html5),silent(true)]),
+      html_download(Uri, Dom),
       xpath(Dom, //table(@align=lower_case(center)), TableDom),
-      html_to_table(TableDom, _, Rows),
+      html_table(TableDom, _, Rows),
       maplist(assert_gv_attr_row, Rows)
     )
   ).
@@ -146,22 +137,19 @@ gv_attrs_download:-
 %! gv_attrs_file(-File:atom) is det.
 
 gv_attrs_file(File):-
-  absolute_file_name(
-    data(gv_attrs),
-    File,
-    [access(write),file_type(logging)]
-  ).
+  absolute_file_name(gv_attrs, File, [access(write),file_type(logging)]).
 
 
 %! gv_attrs_init is det.
 
 gv_attrs_init:-
   gv_attrs_file(File),
-  safe_db_attach(File),
+  persistent_db_attach(File),
   file_age(File, Age),
   gv_attrs_update(Age).
 
 
+
 %! gv_attrs_update(+Age:float) is det.
 
 % The persistent store is still fresh.
@@ -174,20 +162,12 @@ gv_attrs_update(_):-
   gv_attrs_download.
 
 
+
 %! gv_attrs_uri(-Url:url) is det.
 
 gv_attrs_uri(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
 
 
-%! safe_db_attach(+File:atom) is det.
-
-safe_db_attach(File):-
-  exists_file(File), !,
-  db_attach(File, []).
-safe_db_attach(File):-
-  touch_file(File),
-  safe_db_attach(File).
-
 
 %! translate_default(+Default1:atom, -Default2:atom) is det.
 
@@ -198,24 +178,36 @@ translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
 translate_default(Default, Default).
 
 
+
 %! translate_type(-Types:list(atom))// is det.
 
+translate_type([]) --&amp;gt; !, [].
 translate_type([H|T]) --&amp;gt;
   {gv_attr_type(H)},
   atom(H),
   whites,
   translate_type(T).
-translate_type([]) --&amp;gt; !, [].
+
 
 
 %! translated_usedby(
 %!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
 %! )// is det.
 
-translate_usedby([cluster|T]) --&amp;gt; `C`, !, translate_usedby(T).
-translate_usedby([edge|T]) --&amp;gt; `E`, !, translate_usedby(T).
-translate_usedby([graph|T]) --&amp;gt; `G`, !, translate_usedby(T).
-translate_usedby([node|T]) --&amp;gt; `N`, !, translate_usedby(T).
-translate_usedby([subgraph|T]) --&amp;gt; `S`, !, translate_usedby(T).
-translate_usedby([]) --&amp;gt; [].
-
+translate_usedby([cluster|T]) --&amp;gt;
+  &amp;quot;C&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([edge|T]) --&amp;gt;
+  &amp;quot;E&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([graph|T]) --&amp;gt;
+  &amp;quot;G&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([node|T]) --&amp;gt;
+  &amp;quot;N&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([subgraph|T]) --&amp;gt;
+  &amp;quot;S&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([]) --&amp;gt;
+  &amp;quot;&amp;quot;.
diff --git a/gv_color.pl b/gv_color.pl
index 1f3f9d6..b8cf308 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -56,34 +56,41 @@
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
   &amp;quot;#&amp;quot;,
-  &#39;#&#39;(3, hex_color, [Red,Green,Blue], []).
+  hex_color(Red),
+  hex_color(Green),
+  hex_color(Blue).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
-  &amp;quot;#&amp;quot;,
-  &#39;#&#39;(4, hex_color, [Red,Green,Blue,Alpha], []).
+  color(rgb(Red,Green,Blue)),
+  hex_color(Alpha).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
-  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
+  hsv_color(Hue),
+  hsv_color(Saturation),
+  hsv_color(Value).
 color(Name) --&amp;gt;
   {gv_color(_, Name)},
   atom(Name).
 
 hex_color(I) --&amp;gt;
-  {W1 is I / 16},
-  &#39;HEX&#39;(W1),
-  {W2 is I mod 16},
-  &#39;HEX&#39;(W2).
+  xinteger(I).
 
 hsv_color(D, Head, Tail):-
   format(codes(Head,Tail), &#39;~2f&#39;, [D]).
 
 
+
 %! colorList(+Pairs:list(pair(compound,float)))// .
 
-colorList(Pairs) --&amp;gt;
-  &#39;+&#39;(wc, Pairs, []).
+colorList([H]) --&amp;gt; !,
+  wc(H).
+colorList([H|T]) --&amp;gt;
+  wc(H),
+  colorList(T).
 
 wc(Color-Float) --&amp;gt;
   color(Color),
-  &#39;?&#39;(wc_weight(Float), []).
+  (   wc_weight(Float)
+  ;   &amp;quot;&amp;quot;
+  ).
 
 wc_weight(Float) --&amp;gt;
   &amp;quot;;&amp;quot;,
diff --git a/gv_dot.pl b/gv_dot.pl
index e98361b..c26d629 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -30,19 +30,8 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 :- use_module(library(lists), except([delete/3,subset/2])).
 :- use_module(library(ordsets)).
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_arrow)).
-:- use_module(plc(dcg/dcg_ascii)).
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_bracket)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(dcg/dcg_generics)).
-:- use_module(plc(dcg/dcg_meta)).
-:- use_module(plc(dcg/dcg_quote)).
-
 :- use_module(plGraphViz(gv_attrs)).
 :- use_module(plGraphViz(gv_html)).
-:- use_module(plGraphViz(gv_numeral)).
 
 
 
@@ -90,7 +79,7 @@ gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 %                   undirected (operator `--`).
 
 gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
-gv_edge_operator(true) --&amp;gt; arrow(right, 2).
+gv_edge_operator(true) --&amp;gt; &amp;quot;-&amp;gt;&amp;quot;.
 
 
 
@@ -120,7 +109,9 @@ gv_edge_statement(I, Directed, edge(FromId,ToId,EAttrs)) --&amp;gt;
   
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
-  bracketed(square, &#39;*&#39;(gv_attr(edge), EAttrs, [])),
+  &amp;quot;[&amp;quot;,
+  gv_attrs(edge, EAttrs),
+  &amp;quot;]&amp;quot;,
   line_feed.
 
 
@@ -184,11 +175,14 @@ gv_id(html_like_label(Content)) --&amp;gt; !,
 % Double-quoted strings.
 % The quotes are already part of the given atom.
 gv_id(double_quoted_string(Atom)) --&amp;gt; !,
-  quoted(atom(Atom)).
+  &amp;quot;\&amp;quot;&amp;quot;,
+  atom(Atom),
+  &amp;quot;\&amp;quot;&amp;quot;.
 % Numerals.
 gv_id(N) --&amp;gt;
   {number(N)}, !,
-  gv_numeral(N).
+  % @tbd Use gv_numeral//1.
+  number(N).
 % Alpha-numeric strings.
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -198,8 +192,10 @@ gv_id(Atom) --&amp;gt;
   % GraphViz keyword.
   {\+ gv_keyword([H|T])}.
 
-gv_id_first(X) --&amp;gt; ascii_letter(X).
-gv_id_first(X) --&amp;gt; underscore(X).
+gv_id_first(X) --&amp;gt;
+  ascii_alpha(X).
+gv_id_first(X) --&amp;gt;
+  underscore(X).
 
 gv_id_rest([]) --&amp;gt; [].
 gv_id_rest([H|T]) --&amp;gt;
@@ -213,10 +209,10 @@ gv_id_rest([H|T]) --&amp;gt;
 %! gv_keyword(+Codes:list(code)) is semidet.
 % Succeeds if the given codes for a GraphViz reserved keyword.
 
-gv_keyword(Codes):-
+gv_keyword(Cs):-
   % Obviously, the keywords do not occur on the difference list input.
   % So we must use phrase/[2,3].
-  phrase(gv_keyword, Codes).
+  phrase(gv_keyword, Cs).
 
 %! gv_keyword// .
 % GraphViz has reserved keywords that cannot be used as identifiers.
@@ -260,18 +256,23 @@ gv_node_id(Id) --&amp;gt;
 
 gv_node_statement(I, vertex(Id,VAttrs)) --&amp;gt;
   indent(I),
-  gv_node_id(Id), &amp;quot; &amp;quot;,
-  bracketed(square, &#39;*&#39;(gv_attr(node), VAttrs, [])),
-  line_feed.
+  gv_node_id(Id),
+  &amp;quot; [&amp;quot;,
+  gv_attrs(node, VAttrs),
+  &amp;quot;\n&amp;quot;.
 
 
 
 gv_port --&amp;gt;
   gv_port_location,
-  &#39;?&#39;(gv_port_angle, []).
+  (   gv_port_angle
+  ;   &amp;quot;&amp;quot;
+  ).
 gv_port --&amp;gt;
   gv_port_angle,
-  &#39;?&#39;(gv_port_location, []).
+  (   gv_port_location
+  ;   &amp;quot;&amp;quot;
+  ).
 gv_port --&amp;gt;
   &amp;quot;:&amp;quot;,
   gv_compass_pt(_).
@@ -284,38 +285,31 @@ gv_port_location --&amp;gt;
   &amp;quot;:&amp;quot;,
   gv_id(_).
 gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
-  bracketed(
-    round,
-    (
-      gv_id(_),
-      &amp;quot;,&amp;quot;,
-      gv_id(_)
-    )
-  ).
+  &amp;quot;:(&amp;quot;,
+  gv_id(_),
+  &amp;quot;,&amp;quot;,
+  gv_id(_)
+  &amp;quot;)&amp;quot;.
 
 
 
 gv_ranked_node_collection(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
   indent(I),
-  bracketed(curly, (
-    line_feed,
-
-    % The rank attribute.
-    {NewI is I + 1},
-    indent(NewI),
-    gv_attr(subgraph, rank=same),
-    &amp;quot;;&amp;quot;,
-    line_feed,
-
-    % Vertice statements.
-    &#39;*&#39;(
-      gv_node_statement(NewI),
-      [Rank_V_Term|Content_V_Terms],
-      []
-    ),
-
-    % We want to indent the closing curly brace.
-    indent(I)
-  )),
-  line_feed.
+  &amp;quot;{\n&amp;quot;,
+  
+  % The rank attribute.
+  {NewI is I + 1},
+  indent(NewI),
+  gv_attr(subgraph, rank=same),
+  &amp;quot;;\n&amp;quot;,
+  
+  % Vertice statements.
+  &#39;*&#39;(
+    gv_node_statement(NewI),
+    [Rank_V_Term|Content_V_Terms],
+    []
+  ),
+  
+  % We want to indent the closing curly brace.
+  indent(I),
+  &amp;quot;\n&amp;quot;.
diff --git a/gv_file.pl b/gv_file.pl
index 5d2228e..45135f3 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -18,8 +18,6 @@
 :- use_module(library(option)).
 :- use_module(library(process)).
 
-:- use_module(plc(process/process_ext)).
-
 :- dynamic(user:prolog_file_type/2).
 :- multifile(user:prolog_file_type/2).
 
@@ -88,11 +86,10 @@ file_to_gv(InputFile, OutputFile, Options):-
   % Run the GraphViz conversion command in the shell.
   format(atom(OutputTypeFlag), &#39;-T~a&#39;, [OutputType]),
   format(atom(OutputFileFlag), &#39;-o~a&#39;, [OutputFile]),
-  atomic_list_concat([&#39;GraphViz&#39;,Method], &#39; &#39;, Program),
-  handle_process(
-    Method,
+  process_ext(
+    path(Method),
     [OutputTypeFlag,file(InputFile),OutputFileFlag],
-    [program(Program)]
+    []
   ).
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 65ae2bd..79d2564 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -56,7 +56,9 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 %! gv_html_like_label(?Content:compound)// .
 
 gv_html_like_label(Content) --&amp;gt;
-  bracketed(angular, label(Content)).
+  &amp;quot;&amp;lt;&amp;quot;,
+  label(Content),
+  &amp;quot;&amp;gt;&amp;quot;.
 
 
 
diff --git a/gv_util.pl b/gv_util.pl
new file mode 100644
index 0000000..b2cbdcc
--- /dev/null
+++ b/gv_util.pl
@@ -0,0 +1,260 @@
+:- module(
+  gv_util,
+  [
+    ascii_alpha//1, % ?X:code
+    atom_phrase/2, % :Goal_1
+                   % +Atom:atom
+    atom_phrase/3, % :Goal_1
+                   % +Atom1:atom
+                   % -Atom2:atom
+    file_age/2, % +File:atom
+                % -Age:float
+    html_download/2, % +Uri:atom
+                     % -Dom:compound
+    indent//1, % +N:nonneg
+    persistent_db_attach/2, % +Module:atom
+                            % +File:atom
+    underscore//1, % ?X:code
+    verbose_process/2 % +Process:atom
+                      % :Goal_0
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz utilities
+
+Utilities that should not be specific to the GraphViz library
+but that are considered too small to publish independently.
+
+@author Wouter Beek
+@version 2015/07
+*/
+
+:- use_module(library(ansi_term)).
+:- use_module(library(http/http_open)).
+:- use_module(library(http/http_ssl_plugin)). % HTTPS support.
+:- use_module(library(lambda)).
+:- use_module(library(option)).
+:- use_module(library(process)).
+:- use_module(library(sgml)).
+:- use_module(library(xpath)).
+
+:- meta_predicate(atom_phrase(1,+)).
+:- meta_predicate(atom_phrase(1,+,-)).
+:- meta_predicate(dcg_call(//,?,?)).
+:- meta_predicate(dcg_call(1,+,?,?)).
+:- meta_predicate(http_get(+,1,+)).
+:- meta_predicate(http_stream(+,1,+)).
+:- meta_predicate(verbose_process(+,0)).
+
+
+
+%! ascii_alpha(?X:code)// .
+
+ascii_alpha(X) --&amp;gt;
+  between_code(65, 90, X)
+ascii_alpha(X) --&amp;gt;
+  between_code(97, 122, X)
+
+
+
+%! ascii_alpha_numeric(?X:code)// .
+
+ascii_alpha_numeric(X) --&amp;gt;
+  ascii_alpha(X).
+ascii_alpha_numeric(X) --&amp;gt;
+  ascii_numberic(X).
+
+
+
+%! ascii_numeric(?X:code)// .
+
+ascii_numeric(X) --&amp;gt;
+  between_code(48, 57, X).
+
+
+
+%! atom_phrase(:Goal_1, +Atom:atom) is det.
+
+atom_phrase(Goal_1, A):-
+  atom_codes(A, Cs),
+  phrase(Goal_1, Cs).
+
+
+
+%! atom_phrase(:Goal_1, +Atom1:atom, +Atom2:atom) is det.
+
+atom_phrase(Goal_1, A1, A2):-
+  atom_codes(A1, Cs1),
+  phrase(Goal_1, Cs1, Cs2),
+  atom_codes(A2, Cs2).
+
+
+
+%! between_code(+Low:code, +High:code, ?X:code)// .
+
+between_code(Low, High, X) --&amp;gt;
+  [X],
+  {between(Low, High, X)}.
+
+
+
+%! dcg_call(:Dcg_0)// is det.
+
+dcg_call(Dcg, X, Y):-
+  call(Dcg, X, Y).
+
+%! dcg_call(:Dcg_1, +Argument1)// is det.
+
+dcg_call(Dcg, A1, X, Y):-
+  call(Dcg, A1, X, Y).
+
+
+
+%! file_age(+File:atom, -Age:float) is det.
+
+file_age(File, Age):-
+  time_file(File, LastModified),
+  get_time(Now),
+  Age is Now - LastModified.
+
+
+
+%! html_download(+Uri:atom, -Dom:compound) is det.
+
+html_download(Uri, Dom):-
+  http_get(
+    Uri,
+    \Stream^load_html(Stream, Dom, [dialect(html5),max_errors(-1)]),
+    copy
+    []
+  ).
+
+
+
+%! http_get(+Uri:atom, :Success_1, +Options:list(compound)) is det.
+
+http_get(Uri, Success_1, Opts0):-
+  merge_options([method(get),status_code(Status)], Opts0, Opts),
+  setup_call_cleanup(
+    http_open(Uri, Stream, Opts),
+    http_stream(Status, Success_1, Stream),
+    close(Stream)
+  ).
+
+%! http_stream(+Status:between(100,599), :Success_1, +Read:stream) is det.
+
+http_stream(Status, Success_1, Stream):-
+  between(200, 299, Status), !,
+  call(Success_1, Stream).
+http_stream(Status, _, Stream):-
+  format(user_error, &#39;[STATUS ~D] &#39;, [Status]),
+  copy_stream_data(Stream, user_error),
+  format(user_error, &#39;\n&#39;, []).
+
+
+
+%! html_table(+Dom:list(compound), -Header:list, -Data:list(list)) is det.
+
+html_table(Dom, Header, Data):-
+  ignore(html_table_row(header, Dom, Header)),
+  findall(
+    Data0,
+    html_table_row(data, Table, Data0),
+    Data
+  ).
+
+%! html_table_row(
+%!   +Mode:oneof([data,header]),
+%!   +Dom:list(compound),
+%!   -Data:list
+%! ) is det.
+
+html_table_row(data, Dom, Row):- !,
+  xpath(Dom, //tr, Tr),
+  findall(
+    Cell,
+    xpath(Tr, //td(normalize_space), Cell),
+    Row
+  ),
+  Row \== [].
+html_table_row(header, Dom, Row):-
+  xpath(Dom, //tr, Tr),
+  findall(
+    Cell,
+    xpath(Tr, //th(normalize_space), Cell),
+    Row
+  ),
+  Row \== [].
+
+
+
+%! indent(+N:nonneg)// is det.
+
+indent(0) --&amp;gt; !, &amp;quot;&amp;quot;.
+indent(N) --&amp;gt;
+  &amp;quot; &amp;quot;,
+  {succ(M, N)},
+  indent(M).
+
+
+
+%! persistent_db_attach(+Module:atom, +File:atom) is det.
+% Safe attachement of a persistent database dump.
+% This first make sure the given file exists.
+
+persistent_db_attach(Mod, File):-
+  exists_file(File), !,
+  Mod:db_attach(File, []).
+persistent_db_attach(Mod, File):-
+  touch_file(File),
+  persistent_db_attach(Mod, File).
+
+touch_file(File):-
+  create_process(path(touch), [file(File)], []).
+
+
+
+%! underscore(?C:code)// .
+
+underscore(95) --&amp;gt;
+  [95].
+
+
+
+%! verbose_process(+Name:atom, :Goal_0) is det.
+
+verbose_process(Name, Goal_0):-
+  setup_call_catcher_cleanup(
+    start(Name),
+    Goal_0,
+    E,
+    (   E == true
+    -&amp;gt;  success(Name)
+    ;   failure(Name)
+    )
+  ).
+
+failure(Name):-
+  warning(&#39;[FAILURE]&#39;),
+  normal(&#39; Process &#39;),
+  normal(Name),
+  normal(&#39;:&#39;),
+  nl,
+  normal(E).
+
+start(Name):-
+  normal(&#39;Starting process &#39;),
+  normal(Name),
+  normal(&#39;.&#39;).
+
+success(Name):-
+  success(&#39;[SUCCESS]&#39;),
+  normal(&#39; Ending process &#39;),
+  normal(Name),
+  normal(&#39;.&#39;).
+
+emphasis(X):- ansi_format([bold], &#39;~a&#39;, [X]).
+normal(X):- ansi_format([], &#39;~a&#39;, [X]).
+notification(X):- ansi_format([bold,fg(yellow)], &#39;~a&#39;, [X]).
+success(X):- ansi_format([bold,fg(green)], &#39;~a&#39;, [X]).
+warning(X):- ansi_format([bold,fg(red)], &#39;~a&#39;, [X]).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;99&#34;&gt; 99: 正在比较变动前 50a3dbc 和变动后 a97e8e1 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/Prolog-Library-Collection b/Prolog-Library-Collection
deleted file mode 160000
index 88874a7..0000000
--- a/Prolog-Library-Collection
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 88874a7f451df36309d1d6ade03bc7186b4f6c8b
diff --git a/debug.pl b/debug.pl
deleted file mode 100644
index 12b4526..0000000
--- a/debug.pl
+++ /dev/null
@@ -1,7 +0,0 @@
-% Debug file for library plGraphViz.
-
-:- [load].
-
-:- use_module(debug_project).
-:- debug_all_files.
-
diff --git a/debug_project.pl b/debug_project.pl
deleted file mode 100644
index d53a92f..0000000
--- a/debug_project.pl
+++ /dev/null
@@ -1,106 +0,0 @@
-:- module(
-  debug_project,
-  [
-    debug_all_files/0,
-    start_pldoc_server/0
-  ]
-).
-
-/** &amp;lt;module&amp;gt; Debug project
-
-Generic code for debugging a project:
-  * Load all subdirectories and Prolog files contained in those directories.
-
-@author Wouter Beek
-@version 2015/02/26
-*/
-
-:- use_module(library(ansi_term)).
-:- use_module(library(apply)).
-:- use_module(library(pldoc)).
-:- use_module(library(portray_text)).
-
-:- set_prolog_flag(
-  answer_write_options,
-  [max_depth(100),portrayed(true),spacing(next_argument)]
-).
-:- set_prolog_flag(
-  debugger_write_options,
-  [max_depth(100),portrayed(true),spacing(next_argument)]
-).
-:- set_portray_text(ellipsis, 1000).
-
-:- dynamic(user:debug_mode).
-:- multifile(user:debug_mode).
-
-:- initialization(init_debug_mode).
-
-
-
-
-
-debug_all_files:-
-  ensure_loaded(plc(io/dir_ext)),
-  absolute_file_name(project(.), Dir, [access(read),file_type(directory)]),
-  directory_files(
-    Dir,
-    Files1,
-    [
-      file_types([prolog]),
-      include_directories(false),
-      include_self(false),
-      recursive(true)
-    ]
-  ),
-  exclude(do_not_load, Files1, Files2),
-  maplist(use_module0, Files2).
-use_module0(File):-
-  print_message(informational, loading_module(File)),
-  use_module(File).
-
-do_not_load(File1):-
-  file_base_name(File1, File2),
-  file_name_extension(File3, pl, File2),
-  do_not_load0(File3).
-
-do_not_load0(dcg_ascii).
-do_not_load0(dcg_unicode).
-do_not_load0(debug).
-do_not_load0(debug_project).
-do_not_load0(index).
-do_not_load0(load).
-do_not_load0(load_project).
-do_not_load0(run).
-do_not_load0(style).
-
-
-
-%! start_pldoc_server is det.
-% The plDoc server should be started *before* documented modules are loaded.
-
-start_pldoc_server:-
-  doc_server(9999).
-
-
-
-
-
-% INITIALIZATION
-
-init_debug_mode:-
-  % Set the debug mode flag.
-  (   user:debug_mode
-  -&amp;gt;  true
-  ;   assert(user:debug_mode)
-  ),
-  % Avoid errors when using gtrace/0 in threads.
-  guitracer.
-
-
-
-% MESSAGES
-
-:- multifile(prolog:message//1).
-
-prolog:message(loading_module(File)) --&amp;gt;
-  [&#39;[M] &#39;,File].
diff --git a/gv_attr_type.pl b/gv_attr_type.pl
index b3e41ca..4e1b7f2 100644
--- a/gv_attr_type.pl
+++ b/gv_attr_type.pl
@@ -36,7 +36,7 @@
   ]
 ).
 :- reexport(
-  plGraphViz(gv_color),
+  library(gv/gv_color),
   [
     color//1, % +Color:compound
     colorList//1 % +ColorList:list(compound)
@@ -46,12 +46,15 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2014/06, 2014/11-2015/01
+@version 2015/07
 */
 
 :- use_module(library(dcg/basics), except([string//1])).
-
-:- use_module(plGraphViz(gv_html)).
+:- use_module(library(dcg/dcg_abnf)).
+:- use_module(library(dcg/dcg_ascii)).
+:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(dcg/dcg_quoted)).
+:- use_module(library(gv/gv_html)).
 
 
 
@@ -194,9 +197,8 @@ double(N) --&amp;gt;
 
 %! doubleList(+Doubles:list(float))// .
 
-doubleList([]) --&amp;gt; !, &amp;quot;&amp;quot;.
-doubleList([H]) --&amp;gt; !, double(H)
-doubleList([H|T]) --&amp;gt; double(H), &amp;quot;:&amp;quot;, doubleList(T).
+doubleList(L) --&amp;gt;
+  &#39;*&#39;(double, L, [separator(colon)]).
 
 
 
@@ -204,14 +206,8 @@ doubleList([H|T]) --&amp;gt; double(H), &amp;quot;:&amp;quot;, doubleList(T).
 % @tbd Support for context-dependent replacements.
 
 escString(S1) --&amp;gt;
-  {
-    atom_codes(S1, Cs1),
-    phrase(escape_double_quotes, Cs1, Cs2),
-    atom_codes(S2, Cs2)
-  },
-  &amp;quot;\&amp;quot;&amp;quot;,
-  atom(S2),
-  &amp;quot;\&amp;quot;&amp;quot;.
+  {atom_phrase(escape_double_quotes, S1, S2)},
+  quoted(atom(S2)).
 
 escape_double_quotes, [92,34] --&amp;gt;
   [34], !,
@@ -285,9 +281,7 @@ pagedir(&#39;TR&#39;).
 % `point(X:float,Y:float,Changeable:boolean)`.
 
 point(point(X,Y,Changeable)) --&amp;gt;
-  float(X),
-  &amp;quot;,&amp;quot;,
-  float(Y),
+  &#39;#&#39;(2, float, [X,Y], [separator(comma)]),
   input_changeable(Changeable).
 
 input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
@@ -348,10 +342,12 @@ rankdir(&#39;TB&#39;).
 %! rect(+Rectangle:compound)// .
 
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  float(LowerLeftX), &amp;quot;,&amp;quot;,
-  float(LowerLeftY), &amp;quot;,&amp;quot;,
-  float(UpperRightX), &amp;quot;,&amp;quot;,
-  float(UpperRightY).
+  &#39;#&#39;(
+    4,
+    float,
+    [LowerLeftX,LowerLeftY,UpperRightX,UpperRightY],
+    [separator(comma)]
+  ).
 
 
 
@@ -447,9 +443,7 @@ smoothType(triangle).
 % A GraphViz string.
 
 string(Content) --&amp;gt;
-  &amp;quot;\&amp;quot;&amp;quot;,
-  atom(Content),
-  &amp;quot;\&amp;quot;&amp;quot;.
+  quoted(atom(Content)).
 
 
 
diff --git a/gv_attrs.pl b/gv_attrs.pl
index 1e8ccdf..cce4f9d 100644
--- a/gv_attrs.pl
+++ b/gv_attrs.pl
@@ -13,13 +13,18 @@
 */
 
 :- use_module(library(apply)).
+:- use_module(library(deb_ext)).
 :- use_module(library(dcg/basics)).
+:- use_module(library(dcg/dcg_call)).
+:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(file_ext)).
+:- use_module(library(http/html_download)).
+:- use_module(library(http/html_table)).
 :- use_module(library(lists)).
-:- use_module(library(persistency)).
+:- use_module(library(persistency_ext)).
 :- use_module(library(xpath)).
 
-:- use_module(plGraphViz(gv_attr_type), [gv_attr_type/1]).
-:- use_module(plGraphViz(gv_util)).
+:- use_module(library(gv/gv_attr_type), [gv_attr_type/1]).
 
 :- dynamic(user:prolog_file_type/2).
 :- multifile(user:prolog_file_type/2).
@@ -144,7 +149,7 @@ gv_attrs_file(File):-
 
 gv_attrs_init:-
   gv_attrs_file(File),
-  persistent_db_attach(File),
+  attach_persistent_db(File),
   file_age(File, Age),
   gv_attrs_update(Age).
 
diff --git a/gv_color.pl b/gv_color.pl
index b8cf308..dd1690b 100644
--- a/gv_color.pl
+++ b/gv_color.pl
@@ -18,7 +18,7 @@
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/basics)).
-:- use_module(library(lists), except([delete/3,subset/2])).
+:- use_module(library(lists)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
@@ -56,16 +56,12 @@
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
   &amp;quot;#&amp;quot;,
-  hex_color(Red),
-  hex_color(Green),
-  hex_color(Blue).
+  &#39;#&#39;(3, hex_color, [Red,Green,Blue], []).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
   color(rgb(Red,Green,Blue)),
   hex_color(Alpha).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
-  hsv_color(Hue),
-  hsv_color(Saturation),
-  hsv_color(Value).
+  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
 color(Name) --&amp;gt;
   {gv_color(_, Name)},
   atom(Name).
@@ -80,11 +76,8 @@ hsv_color(D, Head, Tail):-
 
 %! colorList(+Pairs:list(pair(compound,float)))// .
 
-colorList([H]) --&amp;gt; !,
-  wc(H).
-colorList([H|T]) --&amp;gt;
-  wc(H),
-  colorList(T).
+colorList(L) --&amp;gt;
+  &#39;+&#39;(wc, L, []).
 
 wc(Color-Float) --&amp;gt;
   color(Color),
@@ -105,11 +98,11 @@ wc_weight(Float) --&amp;gt;
 %! gv_color_download is det.
 
 gv_color_download:-
-  report_on_process(
+  verbose_call(
     &#39;Updating the GraphViz color table...&#39;,
     (
       gv_color_uri(Uri),
-      download_html_dom(Uri, Dom, [html_dialect(html4),silent(true)]),
+      html_download(Uri, Dom),
       xpath(Dom, //table(1), TableDom1),
       xpath(Dom, //table(2), TableDom2),
       maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2])
@@ -117,7 +110,7 @@ gv_color_download:-
   ).
 
 assert_color_table(Colorscheme, TableDom):-
-  html_to_table(TableDom, _, Rows),
+  html_table(TableDom, _, Rows),
   append(Rows, Cells),
   forall(
     member(Cell, Cells),
@@ -157,4 +150,3 @@ gv_color_update(_):-
 %! gv_color_uri(-Url:url) is det.
 
 gv_color_uri(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
-
diff --git a/gv_dot.pl b/gv_dot.pl
index c26d629..9c53cc5 100644
--- a/gv_dot.pl
+++ b/gv_dot.pl
@@ -1,7 +1,6 @@
 :- module(
   gv_dot,
   [
-    gv_graph//1 % +Graph:compound
   ]
 ).
 
@@ -22,17 +21,19 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/dot-language
-@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11-2014/12
+@version 2015/07
 */
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/basics)).
-:- use_module(library(lists), except([delete/3,subset/2])).
+:- use_module(library(dcg/dcg_ascii)).
+:- use_module(library(dcg/dcg_bracketed)).
+:- use_module(library(dcg/dcg_content)).
+:- use_module(library(gv/gv_attrs)).
+:- use_module(library(gv/gv_html)).
+:- use_module(library(lists)).
 :- use_module(library(ordsets)).
 
-:- use_module(plGraphViz(gv_attrs)).
-:- use_module(plGraphViz(gv_html)).
-
 
 
 
@@ -44,14 +45,24 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 % A single GraphViz attribute.
 % We assume that the attribute has already been validated.
 
-gv_attr(Context, Name=Value) --&amp;gt;
-  gv_id(Name),
+gv_attr(Context, N=V) --&amp;gt;
+  gv_id(N),
   &amp;quot;=&amp;quot;,
-  gv_attr_value(Context, Name=Value),
+  gv_attr_value(Context, N=V),
   &amp;quot;;&amp;quot;.
 
 
 
+%! gv_attrs(
+%!   +Kind:oneof([edge,graph,node]),
+%!   +Attributes:list(compound)
+%! )// is det.
+
+gv_attrs(Kind, L) --&amp;gt;
+  bracketed(square, &#39;*&#39;(gv_attr, L, [])).
+
+
+
 %! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
 % ```
 % compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
@@ -76,7 +87,7 @@ gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
 % undirected.
 %
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
-%                   undirected (operator `--`).
+%               undirected (operator `--`).
 
 gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
 gv_edge_operator(true) --&amp;gt; &amp;quot;-&amp;gt;&amp;quot;.
@@ -109,10 +120,8 @@ gv_edge_statement(I, Directed, edge(FromId,ToId,EAttrs)) --&amp;gt;
   
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
-  &amp;quot;[&amp;quot;,
   gv_attrs(edge, EAttrs),
-  &amp;quot;]&amp;quot;,
-  line_feed.
+  &amp;quot;\n&amp;quot;.
 
 
 
@@ -137,14 +146,8 @@ gv_generic_attributes_statement(_, _, []) --&amp;gt; [], !.
 gv_generic_attributes_statement(Kind, I, KindAttrs) --&amp;gt;
   indent(I),
   gv_kind(Kind), &amp;quot; &amp;quot;,
-  &amp;quot;[&amp;quot;,
   gv_attrs(Kind, KindAttrs),
-  &amp;quot;]\n&amp;quot;.
-
-gv_attrs(_, []) --&amp;gt; !, &amp;quot;&amp;quot;.
-gv_attrs(Kind, [H|T]) --&amp;gt;
-  gv_attr(Kind, H),
-  gv_attrs(Kind, T).
+  &amp;quot;\n&amp;quot;.
 
 
 
@@ -175,9 +178,7 @@ gv_id(html_like_label(Content)) --&amp;gt; !,
 % Double-quoted strings.
 % The quotes are already part of the given atom.
 gv_id(double_quoted_string(Atom)) --&amp;gt; !,
-  &amp;quot;\&amp;quot;&amp;quot;,
-  atom(Atom),
-  &amp;quot;\&amp;quot;&amp;quot;.
+  quoted(atom(Atom)).
 % Numerals.
 gv_id(N) --&amp;gt;
   {number(N)}, !,
@@ -193,7 +194,7 @@ gv_id(Atom) --&amp;gt;
   {\+ gv_keyword([H|T])}.
 
 gv_id_first(X) --&amp;gt;
-  ascii_alpha(X).
+  ascii_letter(X).
 gv_id_first(X) --&amp;gt;
   underscore(X).
 
@@ -257,7 +258,6 @@ gv_node_id(Id) --&amp;gt;
 gv_node_statement(I, vertex(Id,VAttrs)) --&amp;gt;
   indent(I),
   gv_node_id(Id),
-  &amp;quot; [&amp;quot;,
   gv_attrs(node, VAttrs),
   &amp;quot;\n&amp;quot;.
 
@@ -293,9 +293,12 @@ gv_port_location --&amp;gt;
 
 
 
-gv_ranked_node_collection(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
+gv_ranked_node_collection(I, Rank) --&amp;gt;
   indent(I),
-  &amp;quot;{\n&amp;quot;,
+  bracketed(curly, gv_ranked_node_collection0(I, Rank)).
+
+gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
+  &amp;quot;\n&amp;quot;,
   
   % The rank attribute.
   {NewI is I + 1},
diff --git a/gv_file.pl b/gv_file.pl
index 45135f3..da17737 100644
--- a/gv_file.pl
+++ b/gv_file.pl
@@ -29,6 +29,8 @@ user:prolog_file_type(pdf, pdf).
 
 
 
+
+
 %! gv_export(
 %!   +ExportGraph:compound,
 %!   +OutputFile:atom,
diff --git a/gv_graph.pl b/gv_graph.pl
index dd4af97..9ae7353 100644
--- a/gv_graph.pl
+++ b/gv_graph.pl
@@ -12,11 +12,15 @@
 */
 
 :- use_module(library(apply)).
+:- use_module(library(dcg/dcg_abnf)).
+:- use_module(library(dcg/dcg_content)).
 :- use_module(library(lists)).
 :- use_module(library(option)).
 
 
 
+
+
 %! gv_graph(+Graph:compound)//
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
@@ -145,20 +149,16 @@ gv_graph(G1, I) --&amp;gt;
   indent(I),
   &amp;quot;}\n&amp;quot;.
 
-gv_edge_statements(_, _, []) --&amp;gt; !, &amp;quot;&amp;quot;.
-gv_edge_statements(I, Dir, [H|T]) --&amp;gt;
-  gv_edge_statement(I, Dir, H),
-  gv_edge_statements(I, Dir, T).
+gv_edge_statements(I, Dir, L) --&amp;gt;
+  &#39;*&#39;(gv_edge_statement(I, Dir), L, []).
+
+gv_node_statements(I, L) --&amp;gt;
+  &#39;*&#39;(gv_node_statement(I), L, []).
+
+gv_ranked_node_collections(I, L) --&amp;gt;
+  &#39;*&#39;(gv_ranked_node_collection(I), L, []).
 
-gv_node_statements(_, []) --&amp;gt; !, &amp;quot;&amp;quot;.
-gv_node_statements(I, [H|T]) --&amp;gt;
-  gv_node_statement(I, H),
-  gv_node_statements(I, T).
 
-gv_ranked_node_collections(_, []) --&amp;gt; !, &amp;quot;&amp;quot;.
-gv_ranked_node_collections(I, [H|T]) --&amp;gt;
-  gv_ranked_node_collection(I, H),
-  gv_ranked_node_collections(I, T),
 
 
 
@@ -191,7 +191,7 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 % no multi-edges.
 % This only applies to directed graphs.
 
-gv_strict(false) --&amp;gt; [].
+gv_strict(false) --&amp;gt; &amp;quot;&amp;quot;.
 gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
 
 
diff --git a/gv_html.pl b/gv_html.pl
index 79d2564..ced6d6b 100644
--- a/gv_html.pl
+++ b/gv_html.pl
@@ -40,14 +40,13 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/node-shapes#html
-@version 2013/07, 2013/09, 2014/03-2014/06, 2014/11
+@version 2015/07
 */
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_bracket)).
-:- use_module(plc(dcg/dcg_content)).
-
-:- use_module(plHtml(html_dcg)).
+:- use_module(library(dcg/dcg_abnf)).
+:- use_module(library(dcg/dcg_bracket)).
+:- use_module(library(dcg/dcg_content)).
+:- use_module(library(http/html_dcg)).
 
 
 
@@ -56,9 +55,7 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 %! gv_html_like_label(?Content:compound)// .
 
 gv_html_like_label(Content) --&amp;gt;
-  &amp;quot;&amp;lt;&amp;quot;,
-  label(Content),
-  &amp;quot;&amp;gt;&amp;quot;.
+  bracketed(angular, label(Content)).
 
 
 
@@ -262,7 +259,7 @@ textitem(String) --&amp;gt;
 
 
 
-% HELPERS
+% HELPERS %
 
 %! supported_html_element(+Name:atom) is semidet.
 %! supported_html_element(-Name:atom) is multi.
diff --git a/gv_numeral.pl b/gv_numeral.pl
index bff1255..1e5c723 100644
--- a/gv_numeral.pl
+++ b/gv_numeral.pl
@@ -11,14 +11,14 @@
 @version 2014/05-2014/06, 2015/01
 */
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_abnf_common)).
-:- use_module(plc(dcg/dcg_ascii)).
-:- use_module(plc(dcg/dcg_cardinal)).
-:- use_module(plc(math/math_ext)).
-:- use_module(plc(math/positional)).
-:- use_module(plc(math/radix)).
-:- use_module(plc(math/rational_ext)).
+:- use_module(library(dcg/dcg_abnf)).
+:- use_module(library(dcg/dcg_abnf_common)).
+:- use_module(library(dcg/dcg_ascii)).
+:- use_module(library(dcg/dcg_cardinal)).
+:- use_module(library(math/math_ext)).
+:- use_module(library(math/positional)).
+:- use_module(library(math/radconv)).
+:- use_module(library(math/rational_ext)).
 
 
 
@@ -63,14 +63,14 @@ gv_numeral(N) --&amp;gt;
           %     preceded by the decimal separator.
           {I =:= 0}
       -&amp;gt;  &amp;quot;.&amp;quot;,
-          {weights_fraction(FW, F)},
+          {positional_fraction(FW, F)},
           &#39;[0-9]*&#39;(FW)
       ;   % [3] Both the integer part and the fractional are non-zero,
           %     so write both of them, with the decimal separator in-between.
           {positional(I, IW)},
           &#39;[0-9]+&#39;(IW),
           &amp;quot;.&amp;quot;,
-          {weights_fraction(FW, F)},
+          {positional_fraction(FW, F)},
           &#39;[0-9]*&#39;(FW)
       )
   ;   &#39;[-]?&#39;(Sg),
diff --git a/gv_util.pl b/gv_util.pl
deleted file mode 100644
index b2cbdcc..0000000
--- a/gv_util.pl
+++ /dev/null
@@ -1,260 +0,0 @@
-:- module(
-  gv_util,
-  [
-    ascii_alpha//1, % ?X:code
-    atom_phrase/2, % :Goal_1
-                   % +Atom:atom
-    atom_phrase/3, % :Goal_1
-                   % +Atom1:atom
-                   % -Atom2:atom
-    file_age/2, % +File:atom
-                % -Age:float
-    html_download/2, % +Uri:atom
-                     % -Dom:compound
-    indent//1, % +N:nonneg
-    persistent_db_attach/2, % +Module:atom
-                            % +File:atom
-    underscore//1, % ?X:code
-    verbose_process/2 % +Process:atom
-                      % :Goal_0
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz utilities
-
-Utilities that should not be specific to the GraphViz library
-but that are considered too small to publish independently.
-
-@author Wouter Beek
-@version 2015/07
-*/
-
-:- use_module(library(ansi_term)).
-:- use_module(library(http/http_open)).
-:- use_module(library(http/http_ssl_plugin)). % HTTPS support.
-:- use_module(library(lambda)).
-:- use_module(library(option)).
-:- use_module(library(process)).
-:- use_module(library(sgml)).
-:- use_module(library(xpath)).
-
-:- meta_predicate(atom_phrase(1,+)).
-:- meta_predicate(atom_phrase(1,+,-)).
-:- meta_predicate(dcg_call(//,?,?)).
-:- meta_predicate(dcg_call(1,+,?,?)).
-:- meta_predicate(http_get(+,1,+)).
-:- meta_predicate(http_stream(+,1,+)).
-:- meta_predicate(verbose_process(+,0)).
-
-
-
-%! ascii_alpha(?X:code)// .
-
-ascii_alpha(X) --&amp;gt;
-  between_code(65, 90, X)
-ascii_alpha(X) --&amp;gt;
-  between_code(97, 122, X)
-
-
-
-%! ascii_alpha_numeric(?X:code)// .
-
-ascii_alpha_numeric(X) --&amp;gt;
-  ascii_alpha(X).
-ascii_alpha_numeric(X) --&amp;gt;
-  ascii_numberic(X).
-
-
-
-%! ascii_numeric(?X:code)// .
-
-ascii_numeric(X) --&amp;gt;
-  between_code(48, 57, X).
-
-
-
-%! atom_phrase(:Goal_1, +Atom:atom) is det.
-
-atom_phrase(Goal_1, A):-
-  atom_codes(A, Cs),
-  phrase(Goal_1, Cs).
-
-
-
-%! atom_phrase(:Goal_1, +Atom1:atom, +Atom2:atom) is det.
-
-atom_phrase(Goal_1, A1, A2):-
-  atom_codes(A1, Cs1),
-  phrase(Goal_1, Cs1, Cs2),
-  atom_codes(A2, Cs2).
-
-
-
-%! between_code(+Low:code, +High:code, ?X:code)// .
-
-between_code(Low, High, X) --&amp;gt;
-  [X],
-  {between(Low, High, X)}.
-
-
-
-%! dcg_call(:Dcg_0)// is det.
-
-dcg_call(Dcg, X, Y):-
-  call(Dcg, X, Y).
-
-%! dcg_call(:Dcg_1, +Argument1)// is det.
-
-dcg_call(Dcg, A1, X, Y):-
-  call(Dcg, A1, X, Y).
-
-
-
-%! file_age(+File:atom, -Age:float) is det.
-
-file_age(File, Age):-
-  time_file(File, LastModified),
-  get_time(Now),
-  Age is Now - LastModified.
-
-
-
-%! html_download(+Uri:atom, -Dom:compound) is det.
-
-html_download(Uri, Dom):-
-  http_get(
-    Uri,
-    \Stream^load_html(Stream, Dom, [dialect(html5),max_errors(-1)]),
-    copy
-    []
-  ).
-
-
-
-%! http_get(+Uri:atom, :Success_1, +Options:list(compound)) is det.
-
-http_get(Uri, Success_1, Opts0):-
-  merge_options([method(get),status_code(Status)], Opts0, Opts),
-  setup_call_cleanup(
-    http_open(Uri, Stream, Opts),
-    http_stream(Status, Success_1, Stream),
-    close(Stream)
-  ).
-
-%! http_stream(+Status:between(100,599), :Success_1, +Read:stream) is det.
-
-http_stream(Status, Success_1, Stream):-
-  between(200, 299, Status), !,
-  call(Success_1, Stream).
-http_stream(Status, _, Stream):-
-  format(user_error, &#39;[STATUS ~D] &#39;, [Status]),
-  copy_stream_data(Stream, user_error),
-  format(user_error, &#39;\n&#39;, []).
-
-
-
-%! html_table(+Dom:list(compound), -Header:list, -Data:list(list)) is det.
-
-html_table(Dom, Header, Data):-
-  ignore(html_table_row(header, Dom, Header)),
-  findall(
-    Data0,
-    html_table_row(data, Table, Data0),
-    Data
-  ).
-
-%! html_table_row(
-%!   +Mode:oneof([data,header]),
-%!   +Dom:list(compound),
-%!   -Data:list
-%! ) is det.
-
-html_table_row(data, Dom, Row):- !,
-  xpath(Dom, //tr, Tr),
-  findall(
-    Cell,
-    xpath(Tr, //td(normalize_space), Cell),
-    Row
-  ),
-  Row \== [].
-html_table_row(header, Dom, Row):-
-  xpath(Dom, //tr, Tr),
-  findall(
-    Cell,
-    xpath(Tr, //th(normalize_space), Cell),
-    Row
-  ),
-  Row \== [].
-
-
-
-%! indent(+N:nonneg)// is det.
-
-indent(0) --&amp;gt; !, &amp;quot;&amp;quot;.
-indent(N) --&amp;gt;
-  &amp;quot; &amp;quot;,
-  {succ(M, N)},
-  indent(M).
-
-
-
-%! persistent_db_attach(+Module:atom, +File:atom) is det.
-% Safe attachement of a persistent database dump.
-% This first make sure the given file exists.
-
-persistent_db_attach(Mod, File):-
-  exists_file(File), !,
-  Mod:db_attach(File, []).
-persistent_db_attach(Mod, File):-
-  touch_file(File),
-  persistent_db_attach(Mod, File).
-
-touch_file(File):-
-  create_process(path(touch), [file(File)], []).
-
-
-
-%! underscore(?C:code)// .
-
-underscore(95) --&amp;gt;
-  [95].
-
-
-
-%! verbose_process(+Name:atom, :Goal_0) is det.
-
-verbose_process(Name, Goal_0):-
-  setup_call_catcher_cleanup(
-    start(Name),
-    Goal_0,
-    E,
-    (   E == true
-    -&amp;gt;  success(Name)
-    ;   failure(Name)
-    )
-  ).
-
-failure(Name):-
-  warning(&#39;[FAILURE]&#39;),
-  normal(&#39; Process &#39;),
-  normal(Name),
-  normal(&#39;:&#39;),
-  nl,
-  normal(E).
-
-start(Name):-
-  normal(&#39;Starting process &#39;),
-  normal(Name),
-  normal(&#39;.&#39;).
-
-success(Name):-
-  success(&#39;[SUCCESS]&#39;),
-  normal(&#39; Ending process &#39;),
-  normal(Name),
-  normal(&#39;.&#39;).
-
-emphasis(X):- ansi_format([bold], &#39;~a&#39;, [X]).
-normal(X):- ansi_format([], &#39;~a&#39;, [X]).
-notification(X):- ansi_format([bold,fg(yellow)], &#39;~a&#39;, [X]).
-success(X):- ansi_format([bold,fg(green)], &#39;~a&#39;, [X]).
-warning(X):- ansi_format([bold,fg(red)], &#39;~a&#39;, [X]).
diff --git a/load.pl b/load.pl
deleted file mode 100644
index de8b5ca..0000000
--- a/load.pl
+++ /dev/null
@@ -1,13 +0,0 @@
-% Load file for the plGraphViz library.
-
-:- dynamic(user:project/2).
-:- multifile(user:project/2).
-   user:project(plGraphViz, &#39;GraphViz support for SWI-Prolog.&#39;).
-
-:- use_module(load_project).
-:- load_project([
-    plc-&#39;Prolog-Library-Collection&#39;,
-    plHtml,
-    plUri
-]).
-
diff --git a/load_project.pl b/load_project.pl
deleted file mode 100644
index 3f0ebef..0000000
--- a/load_project.pl
+++ /dev/null
@@ -1,125 +0,0 @@
-:- module(
-  load_project,
-  [
-    load_project/1, % +ChildProjects:list(or([atom,pair(atom)]))
-    load_subproject/2, % +ParentFileSearchPath:atom
-                       % +Child:or([atom,pair(atom)])
-    set_data_subdirectory/1 % +ParentDirectory:atom
-  ]
-).
-
-/** &amp;lt;module&amp;gt; Load project
-
-Generic code for loading a project:
-  * Create a subdirectory for data.
-  * Load the root of subprojects onto the file search path.
-  * Load the index of subprojects onto the file search path.
-
-@author Wouter Beek
-@version 2014/11/10
-*/
-
-:- use_module(library(ansi_term)). % Colorized terminal messages.
-:- use_module(library(apply)).
-:- use_module(library(pldoc)).
-
-:- dynamic(user:project/2).
-:- multifile(user:project/2).
-:- dynamic(user:project/3).
-:- multifile(user:project/3).
-
-
-
-load_project(ChildProjects):-
-  doc_server(9999),
-  
-  parent_alias(ParentFsp),
-
-  % Entry point.
-  source_file(load_project(_), ThisFile),
-  file_directory_name(ThisFile, ThisDir),
-  assert(user:file_search_path(ParentFsp, ThisDir)),
-  assert(user:file_search_path(project, ThisDir)),
-
-  % Set the data subdirectory.
-  set_data_subdirectory(ThisDir),
-
-  % Load the root of submodules onto the file search path.
-  maplist(load_subproject(ParentFsp), ChildProjects),
-
-  % Load the index into the file search path.
-  load_project_index(ParentFsp).
-
-
-
-%! load_subproject(
-%!   +ParentFileSearchPath:atom,
-%!   +Child:or([atom,pair(atom)])
-%! ) is det.
-
-load_subproject(ParentFsp, ChildFsp-ChildDir):- !,
-  load_subproject_file_search_path(ParentFsp, ChildFsp, ChildDir),
-  load_project_index(ChildFsp).
-load_subproject(ParentFsp, Child):-
-  load_subproject(ParentFsp, Child-Child).
-
-
-%! load_subproject_file_search_path(
-%!   +ParentFileSearchPath:atom,
-%!   +ChildFileSearchPath:atom,
-%!   +ChildDirectory:atom
-%! ) is det.
-
-% The file search path for the subproject has already been set.
-load_subproject_file_search_path(_, ChildFsp, _):-
-  user:file_search_path(ChildFsp, _).
-load_subproject_file_search_path(ParentFsp, ChildFsp, ChildDir):-
-  Spec =.. [ParentFsp,ChildDir],
-  absolute_file_name(Spec, _, [access(read),file_type(directory)]), !,
-  assert(user:file_search_path(ChildFsp, Spec)).
-load_subproject_file_search_path(_, ChildFsp, ChildDir):-
-  print_message(warning, missing_subproject_directory(ChildFsp,ChildDir)).
-
-
-%! load_project_index(+FileSearchPath:atom) is det.
-
-load_project_index(Fsp):-
-  Spec =.. [Fsp,index],
-  absolute_file_name(
-    Spec,
-    File,
-    [access(read),file_errors(fail),file_type(prolog)]
-  ), !,
-  ensure_loaded(File).
-load_project_index(_).
-
-
-%! parent_alias(-ParentFsp:atom) is det.
-
-parent_alias(ParentFsp):-
-  user:project(_, _, ParentFsp), !.
-parent_alias(ParentFsp):-
-  user:project(ParentFsp, _).
-
-
-%! set_data_subdirectory(+ParentDirectory:atom) is det.
-
-set_data_subdirectory(ParentDir):-
-  directory_file_path(ParentDir, data, DataDir),
-  make_directory_path(DataDir),
-  assert(user:file_search_path(data, DataDir)).
-
-
-
-% Messages
-
-:- multifile(prolog:message//1).
-
-prolog:message(missing_subproject_directory(ChildFsp,ChildDir)) --&amp;gt;
-  [
-    &#39;The ~a submodule is not present.&#39;-[ChildFsp], nl,
-    &#39;Check whether subdirectory ~a is present in your project directory:&#39;-[ChildDir], nl,
-    &#39;    git submodule init&#39;, nl,
-    &#39;    git submodule update&#39;
-  ].
-
diff --git a/plHtml b/plHtml
deleted file mode 160000
index 2919705..0000000
--- a/plHtml
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 2919705d079b1ab28bf3c502a87d1648fd842ed3
diff --git a/plUri b/plUri
deleted file mode 160000
index 1a55127..0000000
--- a/plUri
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 1a55127517ee0b0cf2ad4fecbe3f84402f5f4c12
diff --git a/run.pl b/run.pl
deleted file mode 100644
index 8c751f4..0000000
--- a/run.pl
+++ /dev/null
@@ -1,11 +0,0 @@
-% Standalone execution of the plGraphViz library.
-
-:- if(current_prolog_flag(argv, [&#39;--debug&#39;|_])).
-  :- ensure_loaded(debug).
-:- else.
-  :- set_prolog_flag(verbose, silent).
-  :- ensure_loaded(load).
-:- endif.
-
-:- use_module(plGraphViz(gv_file)).
-
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;100&#34;&gt; 100: 正在比较变动前 a97e8e1 和变动后 9513a9b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/LICENSE.txt b/LICENSE.txt
new file mode 100644
index 0000000..c7b7798
--- /dev/null
+++ b/LICENSE.txt
@@ -0,0 +1,21 @@
+The MIT License (MIT)
+
+Copyright (c) 2015 Wouter Beek
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the &amp;quot;Software&amp;quot;), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED &amp;quot;AS IS&amp;quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
diff --git a/pack.pl b/pack.pl
new file mode 100644
index 0000000..f0f5b22
--- /dev/null
+++ b/pack.pl
@@ -0,0 +1,9 @@
+author(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
+download(&#39;https://github.com/wouterbeek/plGraphViz/release/*.zip&#39;).
+home(&#39;https://github.com/wouterbeek/plGraphViz&#39;).
+maintainer(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
+name(plGraphViz).
+packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
+requires(&#39;Prolog_Library_Collection&#39;).
+title(plGraphViz).
+version(&#39;0.0.1&#39;).
diff --git a/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
similarity index 86%
rename from gv_attr_type.pl
rename to prolog/gv/gv_attr_type.pl
index 4e1b7f2..ff163fe 100644
--- a/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_attr_type,
   [
-    gv_attr_type/1, % ?Type:atom
+    gv_attr_type//1, % ?Type:atom
     addDouble//1, % +Double:float
     addPoint//1, % +Point:compound
     arrowType//1, % +ArrowType:atom
@@ -62,38 +62,38 @@
 
 %! gv_attr_type(?Type:atom) is nondet.
 
-gv_attr_type(addDouble).
-gv_attr_type(addPoint).
-gv_attr_type(arrowType).
-gv_attr_type(bool).
-gv_attr_type(color).
-gv_attr_type(colorList).
-gv_attr_type(clusterMode).
-gv_attr_type(dirType).
-gv_attr_type(double).
-gv_attr_type(doubleList).
-gv_attr_type(escString).
-gv_attr_type(layerList).
-gv_attr_type(layerRange).
-gv_attr_type(lblString).
-gv_attr_type(int).
-gv_attr_type(outputMode).
-gv_attr_type(packMode).
-gv_attr_type(pagedir).
-gv_attr_type(point).
-gv_attr_type(pointList).
-gv_attr_type(portPos).
-gv_attr_type(quadType).
-gv_attr_type(rankType).
-gv_attr_type(rankdir).
-gv_attr_type(rect).
-gv_attr_type(shape).
-gv_attr_type(smoothType).
-gv_attr_type(splineType).
-gv_attr_type(startType).
-gv_attr_type(string).
-gv_attr_type(style).
-gv_attr_type(viewPort).
+gv_attr_type(addDouble) --&amp;gt; &amp;quot;addDouble&amp;quot;.
+gv_attr_type(addPoint) --&amp;gt; &amp;quot;addPoint&amp;quot;.
+gv_attr_type(arrowType) --&amp;gt; &amp;quot;arrowType&amp;quot;.
+gv_attr_type(bool) --&amp;gt; &amp;quot;bool&amp;quot;.
+gv_attr_type(color) --&amp;gt; &amp;quot;color&amp;quot;.
+gv_attr_type(colorList) --&amp;gt; &amp;quot;colorList&amp;quot;.
+gv_attr_type(clusterMode) --&amp;gt; &amp;quot;clusterMode&amp;quot;.
+gv_attr_type(dirType) --&amp;gt; &amp;quot;dirType&amp;quot;.
+gv_attr_type(double) --&amp;gt; &amp;quot;double&amp;quot;.
+gv_attr_type(doubleList) --&amp;gt; &amp;quot;doubleList&amp;quot;.
+gv_attr_type(escString) --&amp;gt; &amp;quot;escString&amp;quot;.
+gv_attr_type(layerList) --&amp;gt; &amp;quot;layerList&amp;quot;.
+gv_attr_type(layerRange) --&amp;gt; &amp;quot;layerRange&amp;quot;.
+gv_attr_type(lblString) --&amp;gt; &amp;quot;lblString&amp;quot;.
+gv_attr_type(int) --&amp;gt; &amp;quot;int&amp;quot;.
+gv_attr_type(outputMode) --&amp;gt; &amp;quot;outputMode&amp;quot;.
+gv_attr_type(packMode) --&amp;gt; &amp;quot;packMode&amp;quot;.
+gv_attr_type(pagedir) --&amp;gt; &amp;quot;pagedir&amp;quot;.
+gv_attr_type(point) --&amp;gt; &amp;quot;point&amp;quot;.
+gv_attr_type(pointList) --&amp;gt; &amp;quot;pointList&amp;quot;.
+gv_attr_type(portPos) --&amp;gt; &amp;quot;portPos&amp;quot;.
+gv_attr_type(quadType) --&amp;gt; &amp;quot;quadType&amp;quot;.
+gv_attr_type(rankType) --&amp;gt; &amp;quot;rankType&amp;quot;.
+gv_attr_type(rankdir) --&amp;gt; &amp;quot;rankdir&amp;quot;.
+gv_attr_type(rect) --&amp;gt; &amp;quot;rect&amp;quot;.
+gv_attr_type(shape) --&amp;gt; &amp;quot;shape&amp;quot;.
+gv_attr_type(smoothType) --&amp;gt; &amp;quot;smoothType&amp;quot;.
+gv_attr_type(splineType) --&amp;gt; &amp;quot;splineType&amp;quot;.
+gv_attr_type(startType) --&amp;gt; &amp;quot;startType&amp;quot;.
+gv_attr_type(string) --&amp;gt; &amp;quot;string&amp;quot;.
+gv_attr_type(style) --&amp;gt; &amp;quot;style&amp;quot;.
+gv_attr_type(viewPort) --&amp;gt; &amp;quot;viewPort&amp;quot;.
 
 
 
diff --git a/gv_attrs.pl b/prolog/gv/gv_attrs.pl
similarity index 86%
rename from gv_attrs.pl
rename to prolog/gv/gv_attrs.pl
index cce4f9d..d773a8b 100644
--- a/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -24,12 +24,7 @@
 :- use_module(library(persistency_ext)).
 :- use_module(library(xpath)).
 
-:- use_module(library(gv/gv_attr_type), [gv_attr_type/1]).
-
-:- dynamic(user:prolog_file_type/2).
-:- multifile(user:prolog_file_type/2).
-
-user:prolog_file_type(log, logging).
+:- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
 
 %! gv_attr(
 %!   ?Name:atom,
@@ -127,32 +122,30 @@ assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
 % Downloads the table describing GraphViz attributes from `graphviz.org`.
 
 gv_attrs_download:-
-  verbose_process(
-    &#39;Updating GraphViz attributes table... &#39;,
-    (
-      gv_attrs_uri(Uri),
-      html_download(Uri, Dom),
-      xpath(Dom, //table(@align=lower_case(center)), TableDom),
-      html_table(TableDom, _, Rows),
-      maplist(assert_gv_attr_row, Rows)
-    )
+  verbose_call(
+    &#39;updating GraphViz attributes table&#39;,
+    gv_attrs_download0
   ).
 
+gv_attrs_download0:-
+  gv_attrs_uri(Uri),
+  html_download(Uri, Dom),
+  xpath_chk(Dom, //table(@align=lower_case(center)), TableDom),
+  html_table(TableDom, _, Rows),
+  maplist(assert_gv_attr_row, Rows).
+
 
 %! gv_attrs_file(-File:atom) is det.
 
 gv_attrs_file(File):-
-  absolute_file_name(gv_attrs, File, [access(write),file_type(logging)]).
+  absolute_file_name(&#39;gv_attrs.log&#39;, File, [access(write)]).
 
 
 %! gv_attrs_init is det.
 
 gv_attrs_init:-
   gv_attrs_file(File),
-  attach_persistent_db(File),
-  file_age(File, Age),
-  gv_attrs_update(Age).
-
+  init_persistent_db(File, gv_attrs_update).
 
 
 %! gv_attrs_update(+Age:float) is det.
@@ -186,12 +179,13 @@ translate_default(Default, Default).
 
 %! translate_type(-Types:list(atom))// is det.
 
-translate_type([]) --&amp;gt; !, [].
 translate_type([H|T]) --&amp;gt;
-  {gv_attr_type(H)},
-  atom(H),
+  gv_attr_type(H),
   whites,
   translate_type(T).
+translate_type([H]) --&amp;gt;
+  gv_attr_type(H).
+translate_type([]) --&amp;gt; &amp;quot;&amp;quot;.
 
 
 
diff --git a/gv_color.pl b/prolog/gv/gv_color.pl
similarity index 78%
rename from gv_color.pl
rename to prolog/gv/gv_color.pl
index dd1690b..0553aa2 100644
--- a/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -17,27 +17,17 @@
 */
 
 :- use_module(library(apply)).
+:- use_module(library(deb_ext)).
 :- use_module(library(dcg/basics)).
+:- use_module(library(dcg/dcg_abnf)).
+:- use_module(library(dcg/dcg_content)).
+:- use_module(library(file_ext)).
+:- use_module(library(http/html_download)).
+:- use_module(library(http/html_table)).
 :- use_module(library(lists)).
-:- use_module(library(persistency)).
+:- use_module(library(persistency_ext)).
 :- use_module(library(xpath)).
 
-:- use_module(plc(dcg/dcg_abnf)).
-:- use_module(plc(dcg/dcg_abnf_rules)).
-:- use_module(plc(dcg/dcg_atom)).
-:- use_module(plc(dcg/dcg_cardinal)).
-:- use_module(plc(dcg/dcg_content)).
-:- use_module(plc(generics/db_ext)).
-:- use_module(plc(generics/persistent_db_ext)).
-:- use_module(plc(generics/print_ext)).
-:- use_module(plc(io/file_ext)).
-:- use_module(plc(io/file_gnu)).
-
-:- use_module(plHtml(html)).
-:- use_module(plHtml(html_table)).
-
-:- db_add_novel(user:prolog_file_type(log, logging)).
-
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
 
 :- persistent(gv_color(colorscheme:oneof([svg,x11]),color:atom)).
@@ -99,7 +89,7 @@ wc_weight(Float) --&amp;gt;
 
 gv_color_download:-
   verbose_call(
-    &#39;Updating the GraphViz color table...&#39;,
+    &#39;updating the GraphViz color table&#39;,
     (
       gv_color_uri(Uri),
       html_download(Uri, Dom),
@@ -121,18 +111,14 @@ assert_color_table(Colorscheme, TableDom):-
 %! gv_color_file(-File:atom) is det.
 
 gv_color_file(File):-
-  absolute_file_name(
-    data(gv_color),
-    File,
-    [access(write),file_type(logging)]
-  ).
+  absolute_file_name(&#39;gv_color.log&#39;, File, [access(write)]).
 
 
 %! gv_color_init is det.
 
 gv_color_init:-
   gv_color_file(File),
-  persistent_db_init(File, gv_color_update).
+  init_persistent_db(File, gv_color_update).
 
 
 %! gv_color_update(+Age:float) is det.
diff --git a/gv_file.pl b/prolog/gv/gv_file.pl
similarity index 96%
rename from gv_file.pl
rename to prolog/gv/gv_file.pl
index da17737..a175071 100644
--- a/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -13,8 +13,9 @@
 @version 2015/07
 */
 
+:- use_module(library(code_ext)).
 :- use_module(library(error)).
-:- use_module(library(gv/gv_dot)).
+:- use_module(library(gv/gv_graph)).
 :- use_module(library(option)).
 :- use_module(library(process)).
 
@@ -55,7 +56,7 @@ gv_export(ExportGraph, OutputFile, Options):-
   absolute_file_name(data(ThreadName), TmpFile, [access(write),file_type(dot)]),
   setup_call_cleanup(
     open(TmpFile, write, Write, [encoding(utf8)]),
-    put_codes(Write, Codes),
+    with_output_to(Write, put_codes(Codes)),
     close(Write)
   ),
   file_to_gv(TmpFile, OutputFile, Options).
@@ -88,7 +89,7 @@ file_to_gv(InputFile, OutputFile, Options):-
   % Run the GraphViz conversion command in the shell.
   format(atom(OutputTypeFlag), &#39;-T~a&#39;, [OutputType]),
   format(atom(OutputFileFlag), &#39;-o~a&#39;, [OutputFile]),
-  process_ext(
+  process_create(
     path(Method),
     [OutputTypeFlag,file(InputFile),OutputFileFlag],
     []
diff --git a/gv_graph.pl b/prolog/gv/gv_graph.pl
similarity index 93%
rename from gv_graph.pl
rename to prolog/gv/gv_graph.pl
index 9ae7353..6bd4b86 100644
--- a/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -7,6 +7,13 @@
 
 /** &amp;lt;module&amp;gt; GraphViz graph
 
+Generates GraphViz graphs in the DOT format based on
+a Prolog representation of a graph.
+
+In GraphViz vertices are called &#39;nodes&#39;.
+
+---
+
 @author Wouter Beek
 @version 2015/07
 */
@@ -14,6 +21,7 @@
 :- use_module(library(apply)).
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_content)).
+:- use_module(library(gv/gv_graph_comp)).
 :- use_module(library(lists)).
 :- use_module(library(option)).
 
@@ -79,8 +87,9 @@ gv_graph(G1, I) --&amp;gt;
   gv_graph_type(Directed), &amp;quot; &amp;quot;,
   
   % Graph name.
-  (   {select_name(GName), GAttrs4, GAttrs5)}
-  -&amp;gt;  gv_id(GName), &amp;quot; &amp;quot;,
+  (   {select_option(name(GName), GAttrs4, GAttrs5)}
+  -&amp;gt;  gv_id(GName),
+      &amp;quot; &amp;quot;
   ;   {GAttrs5 = GAttrs4}
   ),
 
@@ -102,7 +111,7 @@ gv_graph(G1, I) --&amp;gt;
   % Only add a line_feed if some content was already written
   % and some content is about to be written.
   (   % Succeeds if no content was written.
-      {(GAttrs == [], SharedVAttrs == [], SharedEAttrs == [])}
+      {(GAttrs5 == [], SharedVAttrs == [], SharedEAttrs == [])}
   -&amp;gt;  &amp;quot;&amp;quot;
   ;   % Succeeds if no content is about to be written.
       {(NewVTerms == [], RankedVTerms == [])}
@@ -171,8 +180,8 @@ gv_ranked_node_collections(I, L) --&amp;gt;
 %! ) is det.
 
 add_default(L1, Opt, L2):-
-  Opt =.. [N,V],
-  Opt0 =.. [N,_],
+  Opt =.. [N,_Value],
+  Opt0 =.. [N,_FreshVar],
   (   option(Opt0, L1)
   -&amp;gt;  true
   ;   L2 = [Opt|L1]
diff --git a/gv_dot.pl b/prolog/gv/gv_graph_comp.pl
similarity index 79%
rename from gv_dot.pl
rename to prolog/gv/gv_graph_comp.pl
index 9c53cc5..8a7d28a 100644
--- a/gv_dot.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -1,16 +1,21 @@
 :- module(
-  gv_dot,
+  gv_graph_comp,
   [
+    gv_edge_statement//3, % +Indent:nonneg
+                          % +Directed:boolean
+                          % +Edge:compound
+    gv_generic_attributes_statement//3, % +Kind:oneof([edge,graph,node])
+                                        % +Indent:nonneg
+                                        % +CategoryAttributes:list(compound)
+    gv_id//1, % +Name:compound
+    gv_node_statement//2, % +Indent:nonneg
+                          % +Vertex:compound
+    gv_ranked_node_collection//2 % +Indent:nonneg
+				 % +Rank:???    
   ]
 ).
 
-/** &amp;lt;module&amp;gt; GraphViz DOT generator
-
-DCG rules for GraphViz DOT file generation.
-
-Methods for writing to the GraphViz DOT format.
-
-In GraphViz vertices are called &#39;nodes&#39;.
+/** &amp;lt;module&amp;gt; GraphViz graph components
 
 ```abnf
 attr_list = &amp;quot;[&amp;quot; [a_list] &amp;quot;]&amp;quot; [attr_list]
@@ -26,9 +31,11 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/basics)).
+:- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_ascii)).
 :- use_module(library(dcg/dcg_bracketed)).
 :- use_module(library(dcg/dcg_content)).
+:- use_module(library(dcg/dcg_quoted)).
 :- use_module(library(gv/gv_attrs)).
 :- use_module(library(gv/gv_html)).
 :- use_module(library(lists)).
@@ -38,66 +45,10 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 
 
-%! gv_attr(
-%!   +Context:oneof([edge,graph,node]),
-%!   +Attribute:nvpair
-%! )// is det.
-% A single GraphViz attribute.
-% We assume that the attribute has already been validated.
-
-gv_attr(Context, N=V) --&amp;gt;
-  gv_id(N),
-  &amp;quot;=&amp;quot;,
-  gv_attr_value(Context, N=V),
-  &amp;quot;;&amp;quot;.
-
-
-
-%! gv_attrs(
-%!   +Kind:oneof([edge,graph,node]),
-%!   +Attributes:list(compound)
-%! )// is det.
-
-gv_attrs(Kind, L) --&amp;gt;
-  bracketed(square, &#39;*&#39;(gv_attr, L, [])).
-
-
-
-%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
-% ```
-% compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
-% ```
-
-gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
-gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
-gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
-gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
-gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
-gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
-gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
-gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
-gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
-gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
-
-
-
-%! gv_edge_operator(+Directed:boolean)// .
-% The binary edge operator between two vertices.
-% The operator that is used depends on whether the graph is directed or
-% undirected.
-%
-% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
-%               undirected (operator `--`).
-
-gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
-gv_edge_operator(true) --&amp;gt; &amp;quot;-&amp;gt;&amp;quot;.
-
-
-
 %! gv_edge_statement(
 %!   +Indent:nonneg,
 %!   +Directed:boolean,
-%!   +EdgeTerm:compound
+%!   +Edge:compound
 %! )// is det.
 % A GraphViz statement describing an edge.
 %
@@ -105,29 +56,40 @@ gv_edge_operator(true) --&amp;gt; &amp;quot;-&amp;gt;&amp;quot;.
 % @arg Directed Whether the graph is directed or not.
 % @arg GraphAttributes The attributes of the graph. Some of these attributes
 %      may be used in the edge statement (e.g., the colorscheme).
-% @arg EdgeTerm A compound term in the GIFormat, representing an edge.
+% @arg Edge A compound term in the GIFormat, representing an edge.
 %
 % @tbd Instead of gv_node_id//1 we could have a gv_subgraph//1
 %      at the from and/or to location.
 % @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
 
-gv_edge_statement(I, Directed, edge(FromId,ToId,EAttrs)) --&amp;gt;
+gv_edge_statement(I, Dir, edge(From,To,Attrs)) --&amp;gt;
   indent(I),
 
-  gv_node_id(FromId), &amp;quot; &amp;quot;,
-  gv_edge_operator(Directed), &amp;quot; &amp;quot;,
-  gv_node_id(ToId), &amp;quot; &amp;quot;,
+  gv_node_id(From), &amp;quot; &amp;quot;,
+  gv_edge_operator(Dir), &amp;quot; &amp;quot;,
+  gv_node_id(To), &amp;quot; &amp;quot;,
   
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
-  gv_attrs(edge, EAttrs),
+  gv_attrs(edge, Attrs),
   &amp;quot;\n&amp;quot;.
 
+%! gv_edge_operator(+Directed:boolean)// .
+% The binary edge operator between two vertices.
+% The operator that is used depends on whether the graph is directed or
+% undirected.
+%
+% @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
+%      undirected (operator `--`).
+
+gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
+gv_edge_operator(true) --&amp;gt; &amp;quot;-&amp;gt;&amp;quot;.
+
 
 
 %! gv_generic_attributes_statement(
 %!   +Kind:oneof([edge,graph,node]),
-%!   +Indent:integer,
+%!   +Indent:nonneg,
 %!   +CategoryAttributes:list(nvpair)
 %! )//
 % A GraphViz statement describing generic attributes for a category of items.
@@ -142,16 +104,88 @@ gv_edge_statement(I, Directed, edge(FromId,ToId,EAttrs)) --&amp;gt;
 % attr_stmt = (graph / node / edge) attr_list
 % ```
 
-gv_generic_attributes_statement(_, _, []) --&amp;gt; [], !.
-gv_generic_attributes_statement(Kind, I, KindAttrs) --&amp;gt;
+gv_generic_attributes_statement(_, _, []) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
   indent(I),
   gv_kind(Kind), &amp;quot; &amp;quot;,
-  gv_attrs(Kind, KindAttrs),
+  gv_attrs(Kind, Attrs),
+  &amp;quot;\n&amp;quot;.
+
+%! gv_kind(+Kind:oneof([edge,graph,node]))// .
+
+gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
+gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
+gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
+
+
+
+%! gv_node_statement(+Indent:nonneg, +Vertex:compound)// is det.
+% A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
+
+gv_node_statement(I, vertex(Id,Attrs)) --&amp;gt;
+  indent(I),
+  gv_node_id(Id),
+  gv_attrs(node, Attrs),
+  &amp;quot;\n&amp;quot;.
+
+
+
+%! gv_ranked_node_collection(+Indent:nonneg, Rank:???)// is det.
+
+gv_ranked_node_collection(I, Rank) --&amp;gt;
+  indent(I),
+  bracketed(curly, gv_ranked_node_collection0(I, Rank)).
+
+gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
+  &amp;quot;\n&amp;quot;,
+  
+  % The rank attribute.
+  {NewI is I + 1},
+  indent(NewI),
+  gv_attr(subgraph, rank=same),
+  &amp;quot;;\n&amp;quot;,
+  
+  % Vertice statements.
+  &#39;*&#39;(
+    gv_node_statement(NewI),
+    [Rank_V_Term|Content_V_Terms],
+    []
+  ),
+  
+  % We want to indent the closing curly brace.
+  indent(I),
   &amp;quot;\n&amp;quot;.
 
 
 
-%! gv_id(?Atom:compound)// is det.
+
+
+% HELPERS %
+
+%! gv_attrs(
+%!   +Kind:oneof([edge,graph,node]),
+%!   +Attributes:list(compound)
+%! )// is det.
+
+gv_attrs(Kind, L) --&amp;gt;
+  bracketed(square, &#39;*&#39;(gv_attr(Kind), L, [])).
+
+%! gv_attr(
+%!   +Context:oneof([edge,graph,node]),
+%!   +Attribute:nvpair
+%! )// is det.
+% A single GraphViz attribute.
+% We assume that the attribute has already been validated.
+
+gv_attr(Context, N=V) --&amp;gt;
+  gv_id(N),
+  &amp;quot;=&amp;quot;,
+  gv_attr_value(Context, N=V),
+  &amp;quot;;&amp;quot;.
+
+
+
+%! gv_id(+Id:compound)// is det.
 % Parse a GraphViz identifier.
 % There are 4 variants:
 %   1. Any string of alphabetic (`[a-zA-Z&#39;200-&#39;377]`) characters,
@@ -193,20 +227,24 @@ gv_id(Atom) --&amp;gt;
   % GraphViz keyword.
   {\+ gv_keyword([H|T])}.
 
+%! gv_id_first(+First:code)// is det.
+% Generates the first character of a GraphViz identifier.
+
 gv_id_first(X) --&amp;gt;
   ascii_letter(X).
 gv_id_first(X) --&amp;gt;
   underscore(X).
 
-gv_id_rest([]) --&amp;gt; [].
+%! gv_id_rest(+NonFirst:code)// is det.
+% Generates a non-first character of a GraphViz identifier.
+
+gv_id_rest([]) --&amp;gt; !, &amp;quot;&amp;quot;.
 gv_id_rest([H|T]) --&amp;gt;
   (   ascii_alpha_numeric(H)
   ;   underscore(H)
   ),
   gv_id_rest(T).
 
-
-
 %! gv_keyword(+Codes:list(code)) is semidet.
 % Succeeds if the given codes for a GraphViz reserved keyword.
 
@@ -228,14 +266,6 @@ gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 
 
 
-%! gv_kind(+Kind:oneof([edge,graph,node]))// .
-
-gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
-
-
-
 %! gv_node_id(+NodeId:compound)// .
 % GraphViz node identifiers can be of the following two types:
 %   1. A GraphViz identifier, see gv_id//1.
@@ -252,16 +282,7 @@ gv_node_id(Id) --&amp;gt;
 
 
 
-%! gv_node_statement(+Indent:nonneg, +VertexTerm:compound)// .
-% A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
-
-gv_node_statement(I, vertex(Id,VAttrs)) --&amp;gt;
-  indent(I),
-  gv_node_id(Id),
-  gv_attrs(node, VAttrs),
-  &amp;quot;\n&amp;quot;.
-
-
+%! gv_port// is det.
 
 gv_port --&amp;gt;
   gv_port_location,
@@ -285,34 +306,25 @@ gv_port_location --&amp;gt;
   &amp;quot;:&amp;quot;,
   gv_id(_).
 gv_port_location --&amp;gt;
-  &amp;quot;:(&amp;quot;,
-  gv_id(_),
-  &amp;quot;,&amp;quot;,
-  gv_id(_)
-  &amp;quot;)&amp;quot;.
-
-
+  &amp;quot;:&amp;quot;,
+  bracketed((
+    gv_id(_),
+    &amp;quot;,&amp;quot;,
+    gv_id(_)
+  )).
 
-gv_ranked_node_collection(I, Rank) --&amp;gt;
-  indent(I),
-  bracketed(curly, gv_ranked_node_collection0(I, Rank)).
+%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
+% ```
+% compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
+% ```
 
-gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
-  &amp;quot;\n&amp;quot;,
-  
-  % The rank attribute.
-  {NewI is I + 1},
-  indent(NewI),
-  gv_attr(subgraph, rank=same),
-  &amp;quot;;\n&amp;quot;,
-  
-  % Vertice statements.
-  &#39;*&#39;(
-    gv_node_statement(NewI),
-    [Rank_V_Term|Content_V_Terms],
-    []
-  ),
-  
-  % We want to indent the closing curly brace.
-  indent(I),
-  &amp;quot;\n&amp;quot;.
+gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
+gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
+gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
+gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
+gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
+gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
+gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
+gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
+gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
+gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
diff --git a/gv_html.pl b/prolog/gv/gv_html.pl
similarity index 99%
rename from gv_html.pl
rename to prolog/gv/gv_html.pl
index ced6d6b..c16d26b 100644
--- a/gv_html.pl
+++ b/prolog/gv/gv_html.pl
@@ -44,7 +44,7 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 */
 
 :- use_module(library(dcg/dcg_abnf)).
-:- use_module(library(dcg/dcg_bracket)).
+:- use_module(library(dcg/dcg_bracketed)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(http/html_dcg)).
 
diff --git a/gv_numeral.pl b/prolog/gv/gv_numeral.pl
similarity index 98%
rename from gv_numeral.pl
rename to prolog/gv/gv_numeral.pl
index 1e5c723..4ba0d64 100644
--- a/gv_numeral.pl
+++ b/prolog/gv/gv_numeral.pl
@@ -14,7 +14,6 @@
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_abnf_common)).
 :- use_module(library(dcg/dcg_ascii)).
-:- use_module(library(dcg/dcg_cardinal)).
 :- use_module(library(math/math_ext)).
 :- use_module(library(math/positional)).
 :- use_module(library(math/radconv)).
diff --git a/test/debug.pl b/test/debug.pl
new file mode 100644
index 0000000..b0f85ea
--- /dev/null
+++ b/test/debug.pl
@@ -0,0 +1,15 @@
+:- use_module(library(ansi_term)).
+:- use_module(library(prolog_pack)).
+
+pack_ensure_removed(Pack):-
+  pack_property(Pack, _), !,
+  pack_remove(Pack).
+pack_ensure_removed(_).
+
+test:-
+  pack_ensure_removed(plGraphViz),
+  source_file(test, ThisFile),
+  file_directory_name(ThisFile, ThisDirectory),
+  assert(user:file_search_path(gvTest, ThisDirectory)),
+  assert(user:file_search_path(library, gvTest(&#39;../prolog&#39;))).
+:- test.
diff --git a/test/test.pl b/test/test.pl
new file mode 100644
index 0000000..6e59928
--- /dev/null
+++ b/test/test.pl
@@ -0,0 +1,10 @@
+:- ensure_loaded(debug).
+
+:- use_module(library(gv/gv_attrs)).
+:- use_module(library(gv/gv_attr_type)).
+:- use_module(library(gv/gv_color)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(gv/gv_graph)).
+:- use_module(library(gv/gv_graph_comp)).
+:- use_module(library(gv/gv_html)).
+:- use_module(library(gv/gv_numeral)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;101&#34;&gt; 101: 正在比较变动前 9513a9b 和变动后 7163f60 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 0553aa2..6c2cc4c 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -90,15 +90,17 @@ wc_weight(Float) --&amp;gt;
 gv_color_download:-
   verbose_call(
     &#39;updating the GraphViz color table&#39;,
-    (
-      gv_color_uri(Uri),
-      html_download(Uri, Dom),
-      xpath(Dom, //table(1), TableDom1),
-      xpath(Dom, //table(2), TableDom2),
-      maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2])
-    )
+    gv_color_download0
   ).
 
+gv_color_download0:-
+  gv_color_uri(Uri),
+  html_download(Uri, Dom),
+  xpath_chk(Dom, //table(1), TableDom1),
+  xpath_chk(Dom, //table(2), TableDom2),
+  maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2]).
+
+
 assert_color_table(Colorscheme, TableDom):-
   html_table(TableDom, _, Rows),
   append(Rows, Cells),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;102&#34;&gt; 102: 正在比较变动前 7163f60 和变动后 b2f4aef &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index f0f5b22..cf24d04 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.1&#39;).
+version(&#39;0.0.2&#39;).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;103&#34;&gt; 103: 正在比较变动前 b2f4aef 和变动后 ba30c25 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index cf24d04..775776f 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.2&#39;).
+version(&#39;0.0.3&#39;).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 8a7d28a..7fd9709 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -177,7 +177,8 @@ gv_attrs(Kind, L) --&amp;gt;
 % A single GraphViz attribute.
 % We assume that the attribute has already been validated.
 
-gv_attr(Context, N=V) --&amp;gt;
+gv_attr(Context, Attr) --&amp;gt;
+  {Attr =.. [N,V]},
   gv_id(N),
   &amp;quot;=&amp;quot;,
   gv_attr_value(Context, N=V),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;104&#34;&gt; 104: 正在比较变动前 ba30c25 和变动后 0eea41b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 775776f..ea8929c 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.3&#39;).
+version(&#39;0.0.4&#39;).
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index a175071..7a92cf5 100644
--- a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -53,7 +53,7 @@ gv_export(ExportGraph, OutputFile, Options):-
   % Be thread-safe.
   thread_self(Id),
   atomic_list_concat([gv_file,Id], &#39;_&#39;, ThreadName),
-  absolute_file_name(data(ThreadName), TmpFile, [access(write),file_type(dot)]),
+  absolute_file_name(ThreadName, TmpFile, [access(write),file_type(dot)]),
   setup_call_cleanup(
     open(TmpFile, write, Write, [encoding(utf8)]),
     with_output_to(Write, put_codes(Codes)),
@@ -69,20 +69,26 @@ gv_export(ExportGraph, OutputFile, Options):-
 % Converts a GraphViz DOT file to an image file, using a specific
 % visualization method.
 
-file_to_gv(InputFile, OutputFile, Options):-
-  option(output(dot), Options), !,
+file_to_gv(InputFile, OutputFile, Opts):-
+  var(OutputFile), !,
+  option(output(Ext), Opts, pdf),
+  file_name_extension(out, Ext, LocalName),
+  absolute_file_name(LocalName, OutputFile, Opts),
+  file_to_gv(InputFile, OutputFile, Opts).
+file_to_gv(InputFile, OutputFile, Opts):-
+  option(output(dot), Opts), !,
   (   var(OutputFile)
   -&amp;gt;  OutputFile = InputFile
   ;   rename_file(InputFile, OutputFile)
   ).
-file_to_gv(InputFile, OutputFile, Options):-
+file_to_gv(InputFile, OutputFile, Opts):-
   % Typecheck for `method` option.
-  option(method(Method), Options, dot),
+  option(method(Method), Opts, dot),
   findall(Method0, gv_method(Method0), Methods),
   must_be(oneof(Methods), Method),
 
   % Typecheck for `output` option.
-  option(output(OutputType), Options, pdf),
+  option(output(OutputType), Opts, pdf),
   findall(OutputType0, gv_output_type(OutputType0), OutputTypes),
   must_be(oneof(OutputTypes), OutputType),
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;105&#34;&gt; 105: 正在比较变动前 0eea41b 和变动后 c1691bd &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index ea8929c..8806f20 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.4&#39;).
+version(&#39;0.0.5&#39;).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index d773a8b..0e6b003 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -18,8 +18,8 @@
 :- use_module(library(dcg/dcg_call)).
 :- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(file_ext)).
-:- use_module(library(http/html_download)).
-:- use_module(library(http/html_table)).
+:- use_module(library(html/html_download)).
+:- use_module(library(html/html_table)).
 :- use_module(library(lists)).
 :- use_module(library(persistency_ext)).
 :- use_module(library(xpath)).
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 6c2cc4c..bc08dcc 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -22,8 +22,8 @@
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(file_ext)).
-:- use_module(library(http/html_download)).
-:- use_module(library(http/html_table)).
+:- use_module(library(html/html_download)).
+:- use_module(library(html/html_table)).
 :- use_module(library(lists)).
 :- use_module(library(persistency_ext)).
 :- use_module(library(xpath)).
diff --git a/prolog/gv/gv_dom.pl b/prolog/gv/gv_dom.pl
new file mode 100644
index 0000000..e85849d
--- /dev/null
+++ b/prolog/gv/gv_dom.pl
@@ -0,0 +1,35 @@
+:- module(
+  gv_dom,
+  [
+    gv_dom/3 % +ExportGraph:compound
+             % -Dom:list(compound)
+             % +Options:list(compound)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz DOM
+
+@author Wouter Beek
+@version 2015/07
+*/
+
+:- use_module(library(gv/gv_file)).
+:- use_module(library(option)).
+:- use_module(library(svg/svg_dom)).
+
+
+
+
+
+%! gv_dom(
+%!   +ExportGraph:compound,
+%!   -Dom:list(compound),
+%!   +Options:list(compound)
+%! ) is det.
+
+gv_dom(ExportG, Dom, Opts1):-
+  % Make sure the file type of the output file is SvgDom.
+  merge_options([output(svg)], Opts1, Opts2),
+  gv_export(ExportG, ToFile, Opts2),
+  svg_dom(ToFile, Dom),
+  delete_file(ToFile).
diff --git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
index c16d26b..5f2db03 100644
--- a/prolog/gv/gv_html.pl
+++ b/prolog/gv/gv_html.pl
@@ -46,7 +46,7 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_bracketed)).
 :- use_module(library(dcg/dcg_content)).
-:- use_module(library(http/html_dcg)).
+:- use_module(library(html/html_dcg)).
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;106&#34;&gt; 106: 正在比较变动前 c1691bd 和变动后 3de9fc2 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 8806f20..d590fb2 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.5&#39;).
+version(&#39;0.0.6&#39;).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
new file mode 100644
index 0000000..0bc966a
--- /dev/null
+++ b/prolog/graph/build_export_graph.pl
@@ -0,0 +1,360 @@
+:- module(
+  build_export_graph,
+  [
+    build_export_graph/3 % +Graph:compound
+                         % -ExportGraph:compound
+                         % +Options:list(compound)
+  ]
+).
+
+/** &amp;lt;module&amp;gt; Build graph representation for exporting
+
+Support for building GIF representations.
+
+# Graph Intermediate Format (GIF)
+
+## Graph
+
+```prolog
+graph(Vs:ordset(compound),Ranks,Es:compound,Attributes:list(nvpair))
+```
+
+### Edge
+
+```prolog
+edge(FromVertexId,ToVertexId,Attributes:list(nvpair))
+```
+
+### Rank
+
+```prolog
+rank(RankVertex:compound,ContentVertices:ordset(compound))
+```
+
+### Vertex
+
+```prolog
+vertex(Id,Attributes:list(nvpair))
+```
+
+# Property functions
+
+Edge label:
+  1. [[graph_edge]] edge_label/2
+
+Vertex coordinates:
+  1. [[circle_coords]] circular_coord/4
+  2. [[random_coords]] random_coord/4
+
+---
+
+@author Wouter Beek
+@version 2015/07
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(list_ext)).
+:- use_module(library(option_ext)).
+:- use_module(library(ordsets)).
+
+:- predicate_options(build_export_graph/4, 4, [
+     pass_to(edge_term/3, 3),
+     pass_to(graph_attributes/2, 2),
+     pass_to(vertex_term/3, 3)
+   ]).
+:- predicate_options(edge_term/3, 3, [
+     edge_arrowhead(+callable),
+     edge_color(+callable),
+     edge_id(+callable),
+     edge_label(+callable),
+     edge_penwidth(+callable),
+     edge_style(+callable)
+   ]).
+:- predicate_options(graph_attributes/2, 2, [
+     graph_charset(+oneof([&#39;iso-8859-1&#39;,&#39;Latin1&#39;,&#39;UTF-8&#39;])),
+     graph_colorscheme(+oneof([none,svg,x11])),
+     graph_directed(+boolean),
+     graph_fontsize(+float),
+     graph_label(+atom),
+     graph_overlap(+boolean)
+   ]).
+:- predicate_options(vertex_term/3, 3, [
+     vertex_color(+callable),
+     vertex_id(+callable),
+     vertex_image(+callable),
+     vertex_label(+callable),
+     vertex_peripheries(+callable),
+     vertex_position(+callable),
+     vertex_shape(+callable),
+     vertex_uri(+callable)
+   ]).
+
+:- meta_predicate(build_export_graph(+,-,:)).
+
+is_meta(edge_arrowhead).
+is_meta(edge_color).
+is_meta(edge_id).
+is_meta(edge_label).
+is_meta(edge_penwidth).
+is_meta(edge_style).
+is_meta(vertex_color).
+is_meta(vertex_id).
+is_meta(vertex_image).
+is_meta(vertex_label).
+is_meta(vertex_peripheries).
+is_meta(vertex_position).
+is_meta(vertex_shape).
+is_meta(vertex_uri).
+
+
+
+
+
+%! build_export_graph(
+%!   +Graph:compound,
+%!   -ExportGraph:compound,
+%!   +Options:list(compound)
+%! ) is det.
+
+build_export_graph(graph(Vs,Es), graph(VTerms,ETerms,GAttrs), Opts1):-
+  meta_options(is_meta, Opts1, Opts2),
+
+  % V terms.
+  maplist(vertex_term0(Vs, Opts2), Vs, VTerms),
+
+  % Edge terms.
+  maplist(edge_term0(Vs, Opts2), Es, ETerms),
+
+  % Graph attributes.
+  graph_attributes(GAttrs, Opts2).
+
+vertex_term0(Vs, Opts, V, VTerm):-
+  vertex_term(Vs, V, VTerm, Opts).
+
+edge_term0(Vs, Opts, E, ETerm):-
+  edge_term(Vs, E, ETerm, Opts).
+
+
+
+%! edge_term(
+%!   +Vertices:ordset(compound),
+%!   +Edge:compound,
+%!   -EdgeTerm:compound,
+%!   +Options:list(compound)
+%! ) is det.
+% The following options are supported:
+%   * `edge_arrowhead(+callable)`
+%     No default.
+%   * `edge_color(+callable)`
+%     No default.
+%   * `edge_id(+callable)`
+%     Function that assignes the unique identifiers for an edge&#39;s
+%     incident vertices.
+%   * `edge_label(+callable)`
+%     No default.
+%   * `edge_penwidth(+callable)`
+%     No default.
+%   * `edge_style(+callable)`
+%     No default.
+
+edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
+  % Arrowhead
+  if_option(edge_arrowhead(ArrowheadFunction), Opts,
+    call(ArrowheadFunction, E, EArrowhead)
+  ),
+  
+  % Color.
+  if_option(edge_color(ColorFunction), Opts,
+    call(ColorFunction, E, EColor)
+  ),
+  
+  % Id.
+  (   option(edge_id(IdFunction), Opts)
+  -&amp;gt;  call(IdFunction, E, FromId, ToId)
+  ;     E = edge(FromV,_,ToV),
+        nth0chk(FromId, Vs, FromV),
+        nth0chk(ToId, Vs, ToV)
+  ),
+  
+  % Label.
+  if_option(edge_label(LabelFunction), Opts,
+    call(LabelFunction, E, ELabel)
+  ),
+  
+  % Penwidth.
+  if_option(edge_penwidth(PenwidthFunction), Opts,
+    call(PenwidthFunction, E, EPenwidth)
+  ),
+  
+  % Style.
+  if_option(edge_style(StyleFunction), Opts,
+    call(StyleFunction, E, EStyle)
+  ),
+
+  merge_options(
+    [
+      arrowhead=EArrowhead,
+      color=EColor,
+      label=ELabel,
+      penwidth=EPenwidth,
+      style=EStyle
+    ],
+    EAttrs
+  ).
+
+
+
+%! graph_attributes(
+%!   -GraphAttributes:list(nvpair),
+%!   +Options:list(compound)
+%! ) is det.
+% The following options are supported:
+%   * `graph_charset(+oneof([&#39;iso-8859-1&#39;,&#39;Latin1&#39;,&#39;UTF-8&#39;]))`
+%     The name of the character set that is used to encode text in the graph.
+%     Default: `UTF-8`.
+%   * `graph_colorscheme(+oneof([none,svg,x11]))`
+%     The colorscheme from which the color in this graph are taken.
+%     Default: `x11`.
+%   * `graph_directed(+boolean)`
+%     Whether the graph is directed (`true`) or undirected (`false`).
+%     Default: `false`.
+%   * `graph_fontsize(+float)`
+%     The font size of text in the graph.
+%     Default: `11.0`.
+%   * `graph_label(+atom)`
+%     The graph label.
+%     No default.
+%   * `graph_overlap(+boolean)`
+%     Whether the vertices are allowed to overlap.
+%     Default: `false`.
+
+graph_attributes(GAttrs, Opts):-
+  % Characer set.
+  option(graph_charset(Charset), Opts, &#39;UTF-8&#39;),
+  % Colorscheme.
+  option(graph_colorscheme(Colorscheme), Opts, x11),
+  % Directed.
+  option(graph_directed(Directed), Opts, false),
+  % Fontsize.
+  option(graph_fontsize(Fontsize), Opts, 11.0),
+  % Label.
+  option(graph_label(GLabel), Opts, &#39;&#39;),
+  % Overlap.
+  option(graph_overlap(Overlap), Opts, false),
+
+  merge_options(
+    [
+      charset=Charset,
+      colorscheme=Colorscheme,
+      directed=Directed,
+      fontsize=Fontsize,
+      label=GLabel,
+      overlap=Overlap
+    ],
+    GAttrs
+  ).
+
+
+
+%! vertex_term(
+%!   +Vertices:ordset(compound),
+%!   +Vertex:compound,
+%!   -VertexTerm:compound,
+%!   +Options:list(compound)
+%! ) is det.
+% The following options are supported:
+%   * `vertex_color(:ColorFunction)`
+%     A function that assigns colors to vertices.
+%     No default.
+%   * `vertex_id(:ColorFunction)`
+%     A functions that assigns unique identifiers to vertices.
+%   * `vertex_image(:ImageFunction)`
+%     A function that assigns images to vertices.
+%     No default.
+%   * `vertex_label(:LabelFunction)`
+%     A function that assigns labels to vertices.
+%     No default.
+%   * `vertex_peripheries(:PeripheriesFunction)`
+%     A function that assinges peripheries to vertices.
+%     No default.
+%   * `vertex_position(:PositionFunction)`
+%     No default.
+%   * `vertex_shape(:ShapeFunction)`
+%     A function that assinges shapes to vertices.
+%     No default.
+%   * `vertex_uri(:UriFunction)`
+
+vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-
+  % Color.
+  if_option(vertex_color(ColorFunction), Opts,
+    call(ColorFunction, V, VColor)
+  ),
+  
+  % Id.
+  (   option(vertex_id(IdFunction), Opts)
+  -&amp;gt;  call(IdFunction, V, VId)
+  ;   nth0chk(VId, Vs, V)
+  ),
+  
+  % Image.
+  ignore(
+    if_option(vertex_image(ImageFunction), Opts,
+      call(ImageFunction, V, VImage)
+    )
+  ),
+
+  % Label.
+  if_option(vertex_label(LabelFunction), Opts,
+    call(LabelFunction, V, VLabel)
+  ),
+
+  % Peripheries.
+  if_option(vertex_peripheries(PeripheriesFunction), Opts,
+    call(PeripheriesFunction, V, VPeripheries)
+  ),
+
+  % Position.
+  if_option(vertex_position(PositionFunction), Opts,
+    call(PositionFunction, Vs, Opts, V, VPosition)
+  ),
+
+  % Shape.
+  if_option(vertex_shape(ShapeFunction), Opts,
+    call(ShapeFunction, V, VShape)
+  ),
+  
+  % URI
+  if_option(vertex_uri(UriFunction), Opts,
+    call(UriFunction, V, VUri)
+  ),
+
+  merge_options(
+    [
+      color=VColor,
+      image=VImage,
+      label=VLabel,
+      peripheries=VPeripheries,
+      pos=VPosition,
+      shape=VShape,
+      &#39;URL&#39;=VUri
+    ],
+    VAttrs
+  ).
+
+
+
+
+
+% HELPERS %
+
+%! merge_options(+FromOptions:list(nvpair), -ToOptions:list(nvpair)) is det.
+
+merge_options([], []).
+% Skip uninstantiated values.
+merge_options([H|T1], T2):-
+  merge_options(T1, T2),
+  H =.. [_,V],
+  var(V), !.
+% Include instantiated values.
+merge_options([H|T1], [H|T2]):-
+  merge_options(T1, T2).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 0e6b003..6634b3e 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -18,14 +18,13 @@
 :- use_module(library(dcg/dcg_call)).
 :- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(file_ext)).
+:- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
 :- use_module(library(html/html_download)).
 :- use_module(library(html/html_table)).
 :- use_module(library(lists)).
 :- use_module(library(persistency_ext)).
 :- use_module(library(xpath)).
 
-:- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
-
 %! gv_attr(
 %!   ?Name:atom,
 %!   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
diff --git a/test/test.pl b/test/test.pl
index 6e59928..898c04e 100644
--- a/test/test.pl
+++ b/test/test.pl
@@ -1,10 +1,13 @@
 :- ensure_loaded(debug).
 
-:- use_module(library(gv/gv_attrs)).
-:- use_module(library(gv/gv_attr_type)).
-:- use_module(library(gv/gv_color)).
-:- use_module(library(gv/gv_file)).
-:- use_module(library(gv/gv_graph)).
-:- use_module(library(gv/gv_graph_comp)).
-:- use_module(library(gv/gv_html)).
-:- use_module(library(gv/gv_numeral)).
+%/graph
+  :- use_module(library(graph/build_export_graph)).
+%/gv
+  :- use_module(library(gv/gv_attrs)).
+  :- use_module(library(gv/gv_attr_type)).
+  :- use_module(library(gv/gv_color)).
+  :- use_module(library(gv/gv_file)).
+  :- use_module(library(gv/gv_graph)).
+  :- use_module(library(gv/gv_graph_comp)).
+  :- use_module(library(gv/gv_html)).
+  :- use_module(library(gv/gv_numeral)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;107&#34;&gt; 107: 正在比较变动前 3de9fc2 和变动后 cb34d89 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index d590fb2..8093a1f 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.6&#39;).
+version(&#39;0.0.7&#39;).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 6634b3e..5e55234 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -22,7 +22,7 @@
 :- use_module(library(html/html_download)).
 :- use_module(library(html/html_table)).
 :- use_module(library(lists)).
-:- use_module(library(persistency_ext)).
+:- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
 %! gv_attr(
@@ -144,7 +144,13 @@ gv_attrs_file(File):-
 
 gv_attrs_init:-
   gv_attrs_file(File),
-  init_persistent_db(File, gv_attrs_update).
+  (   exists_file(File)
+  -&amp;gt;  true
+  ;   touch(File)
+  ),
+  db_attach(File, []),
+  file_age(File, Age),
+  gv_attrs_update(Age).
 
 
 %! gv_attrs_update(+Age:float) is det.
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index bc08dcc..9235e27 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -25,7 +25,7 @@
 :- use_module(library(html/html_download)).
 :- use_module(library(html/html_table)).
 :- use_module(library(lists)).
-:- use_module(library(persistency_ext)).
+:- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
@@ -120,7 +120,13 @@ gv_color_file(File):-
 
 gv_color_init:-
   gv_color_file(File),
-  init_persistent_db(File, gv_color_update).
+  (   exists_file(File)
+  -&amp;gt;  true
+  ;   touch(File)
+  ),
+  db_attach(File, []),
+  file_age(File, Age),
+  gv_color_update(Age).
 
 
 %! gv_color_update(+Age:float) is det.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;108&#34;&gt; 108: 正在比较变动前 cb34d89 和变动后 7f0e20f &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 8093a1f..487feb1 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.7&#39;).
+version(&#39;0.0.8&#39;).
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index 6bd4b86..7f008c7 100644
--- a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -84,7 +84,8 @@ gv_graph(G1, I) --&amp;gt;
   
   % Directedness.
   {select_option(directed(Directed), GAttrs3, GAttrs4, true)},
-  gv_graph_type(Directed), &amp;quot; &amp;quot;,
+  gv_graph_type(Directed),
+  &amp;quot; &amp;quot;,
   
   % Graph name.
   (   {select_option(name(GName), GAttrs4, GAttrs5)}
@@ -183,7 +184,7 @@ add_default(L1, Opt, L2):-
   Opt =.. [N,_Value],
   Opt0 =.. [N,_FreshVar],
   (   option(Opt0, L1)
-  -&amp;gt;  true
+  -&amp;gt;  L2 = L1
   ;   L2 = [Opt|L1]
   ).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;109&#34;&gt; 109: 正在比较变动前 7f0e20f 和变动后 c16a7a7 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 487feb1..57e9348 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.8&#39;).
+version(&#39;0.0.9&#39;).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 0bc966a..67a9e1b 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -193,11 +193,11 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
 
   merge_options(
     [
-      arrowhead=EArrowhead,
-      color=EColor,
-      label=ELabel,
-      penwidth=EPenwidth,
-      style=EStyle
+      arrowhead(EArrowhead),
+      color(EColor),
+      label(ELabel),
+      penwidth(EPenwidth),
+      style(EStyle)
     ],
     EAttrs
   ).
@@ -244,12 +244,12 @@ graph_attributes(GAttrs, Opts):-
 
   merge_options(
     [
-      charset=Charset,
-      colorscheme=Colorscheme,
-      directed=Directed,
-      fontsize=Fontsize,
-      label=GLabel,
-      overlap=Overlap
+      charset(Charset),
+      colorscheme(Colorscheme),
+      directed(Directed),
+      fontsize(Fontsize),
+      label(GLabel),
+      overlap(Overlap)
     ],
     GAttrs
   ).
@@ -330,13 +330,13 @@ vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-
 
   merge_options(
     [
-      color=VColor,
-      image=VImage,
-      label=VLabel,
-      peripheries=VPeripheries,
-      pos=VPosition,
-      shape=VShape,
-      &#39;URL&#39;=VUri
+      color(VColor),
+      image(VImage),
+      label(VLabel),
+      peripheries(VPeripheries),
+      pos(VPosition),
+      shape(VShape),
+      &#39;URL&#39;(VUri)
     ],
     VAttrs
   ).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;110&#34;&gt; 110: 正在比较变动前 c16a7a7 和变动后 8bbb08c &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 57e9348..d1fef6b 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.9&#39;).
+version(&#39;0.0.10&#39;).
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index 7f008c7..bff4257 100644
--- a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -160,13 +160,13 @@ gv_graph(G1, I) --&amp;gt;
   &amp;quot;}\n&amp;quot;.
 
 gv_edge_statements(I, Dir, L) --&amp;gt;
-  &#39;*&#39;(gv_edge_statement(I, Dir), L, []).
+  &#39;*&#39;(gv_edge_statement(I, Dir), L, []), !.
 
 gv_node_statements(I, L) --&amp;gt;
-  &#39;*&#39;(gv_node_statement(I), L, []).
+  &#39;*&#39;(gv_node_statement(I), L, []), !.
 
 gv_ranked_node_collections(I, L) --&amp;gt;
-  &#39;*&#39;(gv_ranked_node_collection(I), L, []).
+  &#39;*&#39;(gv_ranked_node_collection(I), L, []), !.
 
 
 
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 7fd9709..930fb32 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -109,7 +109,7 @@ gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
   indent(I),
   gv_kind(Kind), &amp;quot; &amp;quot;,
   gv_attrs(Kind, Attrs),
-  &amp;quot;\n&amp;quot;.
+  &amp;quot;\n&amp;quot;, !.
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;111&#34;&gt; 111: 正在比较变动前 8bbb08c 和变动后 34c8b1a &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index d1fef6b..854ddee 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.10&#39;).
+version(&#39;0.0.11&#39;).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 5e55234..5d97cb1 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -20,10 +20,10 @@
 :- use_module(library(file_ext)).
 :- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
 :- use_module(library(html/html_download)).
-:- use_module(library(html/html_table)).
 :- use_module(library(lists)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
+:- use_module(library(xpath/xpath_table)).
 
 %! gv_attr(
 %!   ?Name:atom,
@@ -130,7 +130,7 @@ gv_attrs_download0:-
   gv_attrs_uri(Uri),
   html_download(Uri, Dom),
   xpath_chk(Dom, //table(@align=lower_case(center)), TableDom),
-  html_table(TableDom, _, Rows),
+  xpath_table(TableDom, _, Rows),
   maplist(assert_gv_attr_row, Rows).
 
 
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 9235e27..d6eb478 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -13,7 +13,7 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2014/06, 2014/10-2014/11, 2015/01, 2015/03
+@version 2015/08
 */
 
 :- use_module(library(apply)).
@@ -23,10 +23,10 @@
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(file_ext)).
 :- use_module(library(html/html_download)).
-:- use_module(library(html/html_table)).
 :- use_module(library(lists)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
+:- use_module(library(xpath/xpath_table)).
 
 %! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
 
@@ -102,7 +102,7 @@ gv_color_download0:-
 
 
 assert_color_table(Colorscheme, TableDom):-
-  html_table(TableDom, _, Rows),
+  xpath_table(TableDom, _, Rows),
   append(Rows, Cells),
   forall(
     member(Cell, Cells),
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index 7a92cf5..577a33a 100644
--- a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -25,8 +25,13 @@
 user:prolog_file_type(dot, dot).
 user:prolog_file_type(pdf, pdf).
 
-:- predicate_options(gv_export/3, 3, [pass_to(file_to_gv/3, 3)]).
-:- predicate_options(file_to_gv/3, 3, [method(+atom),output(+atom)]).
+:- predicate_options(gv_export/3, 3, [
+     pass_to(file_to_gv/3, 3)
+   ]).
+:- predicate_options(file_to_gv/3, 3, [
+     method(+atom),
+     output(+atom)
+   ]).
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;112&#34;&gt; 112: 正在比较变动前 34c8b1a 和变动后 d883d06 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 854ddee..74f024d 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.11&#39;).
+version(&#39;0.0.12&#39;).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 67a9e1b..e96f484 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -171,7 +171,10 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
   % Id.
   (   option(edge_id(IdFunction), Opts)
   -&amp;gt;  call(IdFunction, E, FromId, ToId)
-  ;     E = edge(FromV,_,ToV),
+  ;     (   E = edge(FromV,_,ToV)
+        -&amp;gt;  true
+        ;   E = edge(FromV,ToV)
+        ),
         nth0chk(FromId, Vs, FromV),
         nth0chk(ToId, Vs, ToV)
   ),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;113&#34;&gt; 113: 正在比较变动前 d883d06 和变动后 66ac0a0 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 74f024d..2a85425 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.12&#39;).
+version(&#39;0.0.13&#39;).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index e96f484..b031d16 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -241,7 +241,8 @@ graph_attributes(GAttrs, Opts):-
   % Fontsize.
   option(graph_fontsize(Fontsize), Opts, 11.0),
   % Label.
-  option(graph_label(GLabel), Opts, &#39;&#39;),
+  % Defaults to the empty string.
+  option(graph_label(GLabel), Opts, &#39;&amp;quot;&amp;quot;&#39;),
   % Overlap.
   option(graph_overlap(Overlap), Opts, false),
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;114&#34;&gt; 114: 正在比较变动前 66ac0a0 和变动后 ab5a102 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 2a85425..dfee09c 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.13&#39;).
+version(&#39;0.0.14&#39;).
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index ff163fe..c6508a3 100644
--- a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -213,9 +213,9 @@ escape_double_quotes, [92,34] --&amp;gt;
   [34], !,
   escape_double_quotes.
 escape_double_quotes, [X] --&amp;gt;
-  [X],
+  [X], !,
   escape_double_quotes.
-
+escape_double_quotes --&amp;gt; [].
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;115&#34;&gt; 115: 正在比较变动前 ab5a102 和变动后 65f43b8 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index e6bec15..7193a38 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,5 +1,4 @@
 *~
 *#
 *.db
-*.log
 data/*
diff --git a/gv_attrs.log b/gv_attrs.log
new file mode 100644
index 0000000..a9c6010
--- /dev/null
+++ b/gv_attrs.log
@@ -0,0 +1,169 @@
+assert(gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;)).
+assert(gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(&#39;_background&#39;,[graph],[string],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;)).
+assert(gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(bgcolor,[cluster,graph],[color,colorList],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;)).
+assert(gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(inputscale,[graph],[double],_,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;)).
+assert(gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labeltarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;)).
+assert(gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;nslimit nslimit1&#39;,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;)).
+assert(gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;)).
+assert(gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;)).
+assert(gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;)).
+assert(gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;)).
+assert(gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(target,[cluster,edge,graph,node],[escString,string],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;)).
+assert(gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;)).
+assert(gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;)).
+assert(gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;)).
+assert(gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;)).
+assert(gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;)).
diff --git a/gv_color.log b/gv_color.log
new file mode 100644
index 0000000..23d6cdf
--- /dev/null
+++ b/gv_color.log
@@ -0,0 +1,802 @@
+assert(gv_color(x11,aliceblue)).
+assert(gv_color(x11,antiquewhite)).
+assert(gv_color(x11,antiquewhite1)).
+assert(gv_color(x11,antiquewhite2)).
+assert(gv_color(x11,antiquewhite3)).
+assert(gv_color(x11,antiquewhite4)).
+assert(gv_color(x11,aquamarine)).
+assert(gv_color(x11,aquamarine1)).
+assert(gv_color(x11,aquamarine2)).
+assert(gv_color(x11,aquamarine3)).
+assert(gv_color(x11,aquamarine4)).
+assert(gv_color(x11,azure)).
+assert(gv_color(x11,azure1)).
+assert(gv_color(x11,azure2)).
+assert(gv_color(x11,azure3)).
+assert(gv_color(x11,azure4)).
+assert(gv_color(x11,beige)).
+assert(gv_color(x11,bisque)).
+assert(gv_color(x11,bisque1)).
+assert(gv_color(x11,bisque2)).
+assert(gv_color(x11,bisque3)).
+assert(gv_color(x11,bisque4)).
+assert(gv_color(x11,black)).
+assert(gv_color(x11,blanchedalmond)).
+assert(gv_color(x11,blue)).
+assert(gv_color(x11,blue1)).
+assert(gv_color(x11,blue2)).
+assert(gv_color(x11,blue3)).
+assert(gv_color(x11,blue4)).
+assert(gv_color(x11,blueviolet)).
+assert(gv_color(x11,brown)).
+assert(gv_color(x11,brown1)).
+assert(gv_color(x11,brown2)).
+assert(gv_color(x11,brown3)).
+assert(gv_color(x11,brown4)).
+assert(gv_color(x11,burlywood)).
+assert(gv_color(x11,burlywood1)).
+assert(gv_color(x11,burlywood2)).
+assert(gv_color(x11,burlywood3)).
+assert(gv_color(x11,burlywood4)).
+assert(gv_color(x11,cadetblue)).
+assert(gv_color(x11,cadetblue1)).
+assert(gv_color(x11,cadetblue2)).
+assert(gv_color(x11,cadetblue3)).
+assert(gv_color(x11,cadetblue4)).
+assert(gv_color(x11,chartreuse)).
+assert(gv_color(x11,chartreuse1)).
+assert(gv_color(x11,chartreuse2)).
+assert(gv_color(x11,chartreuse3)).
+assert(gv_color(x11,chartreuse4)).
+assert(gv_color(x11,chocolate)).
+assert(gv_color(x11,chocolate1)).
+assert(gv_color(x11,chocolate2)).
+assert(gv_color(x11,chocolate3)).
+assert(gv_color(x11,chocolate4)).
+assert(gv_color(x11,coral)).
+assert(gv_color(x11,coral1)).
+assert(gv_color(x11,coral2)).
+assert(gv_color(x11,coral3)).
+assert(gv_color(x11,coral4)).
+assert(gv_color(x11,cornflowerblue)).
+assert(gv_color(x11,cornsilk)).
+assert(gv_color(x11,cornsilk1)).
+assert(gv_color(x11,cornsilk2)).
+assert(gv_color(x11,cornsilk3)).
+assert(gv_color(x11,cornsilk4)).
+assert(gv_color(x11,crimson)).
+assert(gv_color(x11,cyan)).
+assert(gv_color(x11,cyan1)).
+assert(gv_color(x11,cyan2)).
+assert(gv_color(x11,cyan3)).
+assert(gv_color(x11,cyan4)).
+assert(gv_color(x11,darkgoldenrod)).
+assert(gv_color(x11,darkgoldenrod1)).
+assert(gv_color(x11,darkgoldenrod2)).
+assert(gv_color(x11,darkgoldenrod3)).
+assert(gv_color(x11,darkgoldenrod4)).
+assert(gv_color(x11,darkgreen)).
+assert(gv_color(x11,darkkhaki)).
+assert(gv_color(x11,darkolivegreen)).
+assert(gv_color(x11,darkolivegreen1)).
+assert(gv_color(x11,darkolivegreen2)).
+assert(gv_color(x11,darkolivegreen3)).
+assert(gv_color(x11,darkolivegreen4)).
+assert(gv_color(x11,darkorange)).
+assert(gv_color(x11,darkorange1)).
+assert(gv_color(x11,darkorange2)).
+assert(gv_color(x11,darkorange3)).
+assert(gv_color(x11,darkorange4)).
+assert(gv_color(x11,darkorchid)).
+assert(gv_color(x11,darkorchid1)).
+assert(gv_color(x11,darkorchid2)).
+assert(gv_color(x11,darkorchid3)).
+assert(gv_color(x11,darkorchid4)).
+assert(gv_color(x11,darksalmon)).
+assert(gv_color(x11,darkseagreen)).
+assert(gv_color(x11,darkseagreen1)).
+assert(gv_color(x11,darkseagreen2)).
+assert(gv_color(x11,darkseagreen3)).
+assert(gv_color(x11,darkseagreen4)).
+assert(gv_color(x11,darkslateblue)).
+assert(gv_color(x11,darkslategray)).
+assert(gv_color(x11,darkslategray1)).
+assert(gv_color(x11,darkslategray2)).
+assert(gv_color(x11,darkslategray3)).
+assert(gv_color(x11,darkslategray4)).
+assert(gv_color(x11,darkslategrey)).
+assert(gv_color(x11,darkturquoise)).
+assert(gv_color(x11,darkviolet)).
+assert(gv_color(x11,deeppink)).
+assert(gv_color(x11,deeppink1)).
+assert(gv_color(x11,deeppink2)).
+assert(gv_color(x11,deeppink3)).
+assert(gv_color(x11,deeppink4)).
+assert(gv_color(x11,deepskyblue)).
+assert(gv_color(x11,deepskyblue1)).
+assert(gv_color(x11,deepskyblue2)).
+assert(gv_color(x11,deepskyblue3)).
+assert(gv_color(x11,deepskyblue4)).
+assert(gv_color(x11,dimgray)).
+assert(gv_color(x11,dimgrey)).
+assert(gv_color(x11,dodgerblue)).
+assert(gv_color(x11,dodgerblue1)).
+assert(gv_color(x11,dodgerblue2)).
+assert(gv_color(x11,dodgerblue3)).
+assert(gv_color(x11,dodgerblue4)).
+assert(gv_color(x11,firebrick)).
+assert(gv_color(x11,firebrick1)).
+assert(gv_color(x11,firebrick2)).
+assert(gv_color(x11,firebrick3)).
+assert(gv_color(x11,firebrick4)).
+assert(gv_color(x11,floralwhite)).
+assert(gv_color(x11,forestgreen)).
+assert(gv_color(x11,gainsboro)).
+assert(gv_color(x11,ghostwhite)).
+assert(gv_color(x11,gold)).
+assert(gv_color(x11,gold1)).
+assert(gv_color(x11,gold2)).
+assert(gv_color(x11,gold3)).
+assert(gv_color(x11,gold4)).
+assert(gv_color(x11,goldenrod)).
+assert(gv_color(x11,goldenrod1)).
+assert(gv_color(x11,goldenrod2)).
+assert(gv_color(x11,goldenrod3)).
+assert(gv_color(x11,goldenrod4)).
+assert(gv_color(x11,gray)).
+assert(gv_color(x11,gray0)).
+assert(gv_color(x11,gray1)).
+assert(gv_color(x11,gray10)).
+assert(gv_color(x11,gray100)).
+assert(gv_color(x11,gray11)).
+assert(gv_color(x11,gray12)).
+assert(gv_color(x11,gray13)).
+assert(gv_color(x11,gray14)).
+assert(gv_color(x11,gray15)).
+assert(gv_color(x11,gray16)).
+assert(gv_color(x11,gray17)).
+assert(gv_color(x11,gray18)).
+assert(gv_color(x11,gray19)).
+assert(gv_color(x11,gray2)).
+assert(gv_color(x11,gray20)).
+assert(gv_color(x11,gray21)).
+assert(gv_color(x11,gray22)).
+assert(gv_color(x11,gray23)).
+assert(gv_color(x11,gray24)).
+assert(gv_color(x11,gray25)).
+assert(gv_color(x11,gray26)).
+assert(gv_color(x11,gray27)).
+assert(gv_color(x11,gray28)).
+assert(gv_color(x11,gray29)).
+assert(gv_color(x11,gray3)).
+assert(gv_color(x11,gray30)).
+assert(gv_color(x11,gray31)).
+assert(gv_color(x11,gray32)).
+assert(gv_color(x11,gray33)).
+assert(gv_color(x11,gray34)).
+assert(gv_color(x11,gray35)).
+assert(gv_color(x11,gray36)).
+assert(gv_color(x11,gray37)).
+assert(gv_color(x11,gray38)).
+assert(gv_color(x11,gray39)).
+assert(gv_color(x11,gray4)).
+assert(gv_color(x11,gray40)).
+assert(gv_color(x11,gray41)).
+assert(gv_color(x11,gray42)).
+assert(gv_color(x11,gray43)).
+assert(gv_color(x11,gray44)).
+assert(gv_color(x11,gray45)).
+assert(gv_color(x11,gray46)).
+assert(gv_color(x11,gray47)).
+assert(gv_color(x11,gray48)).
+assert(gv_color(x11,gray49)).
+assert(gv_color(x11,gray5)).
+assert(gv_color(x11,gray50)).
+assert(gv_color(x11,gray51)).
+assert(gv_color(x11,gray52)).
+assert(gv_color(x11,gray53)).
+assert(gv_color(x11,gray54)).
+assert(gv_color(x11,gray55)).
+assert(gv_color(x11,gray56)).
+assert(gv_color(x11,gray57)).
+assert(gv_color(x11,gray58)).
+assert(gv_color(x11,gray59)).
+assert(gv_color(x11,gray6)).
+assert(gv_color(x11,gray60)).
+assert(gv_color(x11,gray61)).
+assert(gv_color(x11,gray62)).
+assert(gv_color(x11,gray63)).
+assert(gv_color(x11,gray64)).
+assert(gv_color(x11,gray65)).
+assert(gv_color(x11,gray66)).
+assert(gv_color(x11,gray67)).
+assert(gv_color(x11,gray68)).
+assert(gv_color(x11,gray69)).
+assert(gv_color(x11,gray7)).
+assert(gv_color(x11,gray70)).
+assert(gv_color(x11,gray71)).
+assert(gv_color(x11,gray72)).
+assert(gv_color(x11,gray73)).
+assert(gv_color(x11,gray74)).
+assert(gv_color(x11,gray75)).
+assert(gv_color(x11,gray76)).
+assert(gv_color(x11,gray77)).
+assert(gv_color(x11,gray78)).
+assert(gv_color(x11,gray79)).
+assert(gv_color(x11,gray8)).
+assert(gv_color(x11,gray80)).
+assert(gv_color(x11,gray81)).
+assert(gv_color(x11,gray82)).
+assert(gv_color(x11,gray83)).
+assert(gv_color(x11,gray84)).
+assert(gv_color(x11,gray85)).
+assert(gv_color(x11,gray86)).
+assert(gv_color(x11,gray87)).
+assert(gv_color(x11,gray88)).
+assert(gv_color(x11,gray89)).
+assert(gv_color(x11,gray9)).
+assert(gv_color(x11,gray90)).
+assert(gv_color(x11,gray91)).
+assert(gv_color(x11,gray92)).
+assert(gv_color(x11,gray93)).
+assert(gv_color(x11,gray94)).
+assert(gv_color(x11,gray95)).
+assert(gv_color(x11,gray96)).
+assert(gv_color(x11,gray97)).
+assert(gv_color(x11,gray98)).
+assert(gv_color(x11,gray99)).
+assert(gv_color(x11,green)).
+assert(gv_color(x11,green1)).
+assert(gv_color(x11,green2)).
+assert(gv_color(x11,green3)).
+assert(gv_color(x11,green4)).
+assert(gv_color(x11,greenyellow)).
+assert(gv_color(x11,grey)).
+assert(gv_color(x11,grey0)).
+assert(gv_color(x11,grey1)).
+assert(gv_color(x11,grey10)).
+assert(gv_color(x11,grey100)).
+assert(gv_color(x11,grey11)).
+assert(gv_color(x11,grey12)).
+assert(gv_color(x11,grey13)).
+assert(gv_color(x11,grey14)).
+assert(gv_color(x11,grey15)).
+assert(gv_color(x11,grey16)).
+assert(gv_color(x11,grey17)).
+assert(gv_color(x11,grey18)).
+assert(gv_color(x11,grey19)).
+assert(gv_color(x11,grey2)).
+assert(gv_color(x11,grey20)).
+assert(gv_color(x11,grey21)).
+assert(gv_color(x11,grey22)).
+assert(gv_color(x11,grey23)).
+assert(gv_color(x11,grey24)).
+assert(gv_color(x11,grey25)).
+assert(gv_color(x11,grey26)).
+assert(gv_color(x11,grey27)).
+assert(gv_color(x11,grey28)).
+assert(gv_color(x11,grey29)).
+assert(gv_color(x11,grey3)).
+assert(gv_color(x11,grey30)).
+assert(gv_color(x11,grey31)).
+assert(gv_color(x11,grey32)).
+assert(gv_color(x11,grey33)).
+assert(gv_color(x11,grey34)).
+assert(gv_color(x11,grey35)).
+assert(gv_color(x11,grey36)).
+assert(gv_color(x11,grey37)).
+assert(gv_color(x11,grey38)).
+assert(gv_color(x11,grey39)).
+assert(gv_color(x11,grey4)).
+assert(gv_color(x11,grey40)).
+assert(gv_color(x11,grey41)).
+assert(gv_color(x11,grey42)).
+assert(gv_color(x11,grey43)).
+assert(gv_color(x11,grey44)).
+assert(gv_color(x11,grey45)).
+assert(gv_color(x11,grey46)).
+assert(gv_color(x11,grey47)).
+assert(gv_color(x11,grey48)).
+assert(gv_color(x11,grey49)).
+assert(gv_color(x11,grey5)).
+assert(gv_color(x11,grey50)).
+assert(gv_color(x11,grey51)).
+assert(gv_color(x11,grey52)).
+assert(gv_color(x11,grey53)).
+assert(gv_color(x11,grey54)).
+assert(gv_color(x11,grey55)).
+assert(gv_color(x11,grey56)).
+assert(gv_color(x11,grey57)).
+assert(gv_color(x11,grey58)).
+assert(gv_color(x11,grey59)).
+assert(gv_color(x11,grey6)).
+assert(gv_color(x11,grey60)).
+assert(gv_color(x11,grey61)).
+assert(gv_color(x11,grey62)).
+assert(gv_color(x11,grey63)).
+assert(gv_color(x11,grey64)).
+assert(gv_color(x11,grey65)).
+assert(gv_color(x11,grey66)).
+assert(gv_color(x11,grey67)).
+assert(gv_color(x11,grey68)).
+assert(gv_color(x11,grey69)).
+assert(gv_color(x11,grey7)).
+assert(gv_color(x11,grey70)).
+assert(gv_color(x11,grey71)).
+assert(gv_color(x11,grey72)).
+assert(gv_color(x11,grey73)).
+assert(gv_color(x11,grey74)).
+assert(gv_color(x11,grey75)).
+assert(gv_color(x11,grey76)).
+assert(gv_color(x11,grey77)).
+assert(gv_color(x11,grey78)).
+assert(gv_color(x11,grey79)).
+assert(gv_color(x11,grey8)).
+assert(gv_color(x11,grey80)).
+assert(gv_color(x11,grey81)).
+assert(gv_color(x11,grey82)).
+assert(gv_color(x11,grey83)).
+assert(gv_color(x11,grey84)).
+assert(gv_color(x11,grey85)).
+assert(gv_color(x11,grey86)).
+assert(gv_color(x11,grey87)).
+assert(gv_color(x11,grey88)).
+assert(gv_color(x11,grey89)).
+assert(gv_color(x11,grey9)).
+assert(gv_color(x11,grey90)).
+assert(gv_color(x11,grey91)).
+assert(gv_color(x11,grey92)).
+assert(gv_color(x11,grey93)).
+assert(gv_color(x11,grey94)).
+assert(gv_color(x11,grey95)).
+assert(gv_color(x11,grey96)).
+assert(gv_color(x11,grey97)).
+assert(gv_color(x11,grey98)).
+assert(gv_color(x11,grey99)).
+assert(gv_color(x11,honeydew)).
+assert(gv_color(x11,honeydew1)).
+assert(gv_color(x11,honeydew2)).
+assert(gv_color(x11,honeydew3)).
+assert(gv_color(x11,honeydew4)).
+assert(gv_color(x11,hotpink)).
+assert(gv_color(x11,hotpink1)).
+assert(gv_color(x11,hotpink2)).
+assert(gv_color(x11,hotpink3)).
+assert(gv_color(x11,hotpink4)).
+assert(gv_color(x11,indianred)).
+assert(gv_color(x11,indianred1)).
+assert(gv_color(x11,indianred2)).
+assert(gv_color(x11,indianred3)).
+assert(gv_color(x11,indianred4)).
+assert(gv_color(x11,indigo)).
+assert(gv_color(x11,invis)).
+assert(gv_color(x11,ivory)).
+assert(gv_color(x11,ivory1)).
+assert(gv_color(x11,ivory2)).
+assert(gv_color(x11,ivory3)).
+assert(gv_color(x11,ivory4)).
+assert(gv_color(x11,khaki)).
+assert(gv_color(x11,khaki1)).
+assert(gv_color(x11,khaki2)).
+assert(gv_color(x11,khaki3)).
+assert(gv_color(x11,khaki4)).
+assert(gv_color(x11,lavender)).
+assert(gv_color(x11,lavenderblush)).
+assert(gv_color(x11,lavenderblush1)).
+assert(gv_color(x11,lavenderblush2)).
+assert(gv_color(x11,lavenderblush3)).
+assert(gv_color(x11,lavenderblush4)).
+assert(gv_color(x11,lawngreen)).
+assert(gv_color(x11,lemonchiffon)).
+assert(gv_color(x11,lemonchiffon1)).
+assert(gv_color(x11,lemonchiffon2)).
+assert(gv_color(x11,lemonchiffon3)).
+assert(gv_color(x11,lemonchiffon4)).
+assert(gv_color(x11,lightblue)).
+assert(gv_color(x11,lightblue1)).
+assert(gv_color(x11,lightblue2)).
+assert(gv_color(x11,lightblue3)).
+assert(gv_color(x11,lightblue4)).
+assert(gv_color(x11,lightcoral)).
+assert(gv_color(x11,lightcyan)).
+assert(gv_color(x11,lightcyan1)).
+assert(gv_color(x11,lightcyan2)).
+assert(gv_color(x11,lightcyan3)).
+assert(gv_color(x11,lightcyan4)).
+assert(gv_color(x11,lightgoldenrod)).
+assert(gv_color(x11,lightgoldenrod1)).
+assert(gv_color(x11,lightgoldenrod2)).
+assert(gv_color(x11,lightgoldenrod3)).
+assert(gv_color(x11,lightgoldenrod4)).
+assert(gv_color(x11,lightgoldenrodyellow)).
+assert(gv_color(x11,lightgray)).
+assert(gv_color(x11,lightgrey)).
+assert(gv_color(x11,lightpink)).
+assert(gv_color(x11,lightpink1)).
+assert(gv_color(x11,lightpink2)).
+assert(gv_color(x11,lightpink3)).
+assert(gv_color(x11,lightpink4)).
+assert(gv_color(x11,lightsalmon)).
+assert(gv_color(x11,lightsalmon1)).
+assert(gv_color(x11,lightsalmon2)).
+assert(gv_color(x11,lightsalmon3)).
+assert(gv_color(x11,lightsalmon4)).
+assert(gv_color(x11,lightseagreen)).
+assert(gv_color(x11,lightskyblue)).
+assert(gv_color(x11,lightskyblue1)).
+assert(gv_color(x11,lightskyblue2)).
+assert(gv_color(x11,lightskyblue3)).
+assert(gv_color(x11,lightskyblue4)).
+assert(gv_color(x11,lightslateblue)).
+assert(gv_color(x11,lightslategray)).
+assert(gv_color(x11,lightslategrey)).
+assert(gv_color(x11,lightsteelblue)).
+assert(gv_color(x11,lightsteelblue1)).
+assert(gv_color(x11,lightsteelblue2)).
+assert(gv_color(x11,lightsteelblue3)).
+assert(gv_color(x11,lightsteelblue4)).
+assert(gv_color(x11,lightyellow)).
+assert(gv_color(x11,lightyellow1)).
+assert(gv_color(x11,lightyellow2)).
+assert(gv_color(x11,lightyellow3)).
+assert(gv_color(x11,lightyellow4)).
+assert(gv_color(x11,limegreen)).
+assert(gv_color(x11,linen)).
+assert(gv_color(x11,magenta)).
+assert(gv_color(x11,magenta1)).
+assert(gv_color(x11,magenta2)).
+assert(gv_color(x11,magenta3)).
+assert(gv_color(x11,magenta4)).
+assert(gv_color(x11,maroon)).
+assert(gv_color(x11,maroon1)).
+assert(gv_color(x11,maroon2)).
+assert(gv_color(x11,maroon3)).
+assert(gv_color(x11,maroon4)).
+assert(gv_color(x11,mediumaquamarine)).
+assert(gv_color(x11,mediumblue)).
+assert(gv_color(x11,mediumorchid)).
+assert(gv_color(x11,mediumorchid1)).
+assert(gv_color(x11,mediumorchid2)).
+assert(gv_color(x11,mediumorchid3)).
+assert(gv_color(x11,mediumorchid4)).
+assert(gv_color(x11,mediumpurple)).
+assert(gv_color(x11,mediumpurple1)).
+assert(gv_color(x11,mediumpurple2)).
+assert(gv_color(x11,mediumpurple3)).
+assert(gv_color(x11,mediumpurple4)).
+assert(gv_color(x11,mediumseagreen)).
+assert(gv_color(x11,mediumslateblue)).
+assert(gv_color(x11,mediumspringgreen)).
+assert(gv_color(x11,mediumturquoise)).
+assert(gv_color(x11,mediumvioletred)).
+assert(gv_color(x11,midnightblue)).
+assert(gv_color(x11,mintcream)).
+assert(gv_color(x11,mistyrose)).
+assert(gv_color(x11,mistyrose1)).
+assert(gv_color(x11,mistyrose2)).
+assert(gv_color(x11,mistyrose3)).
+assert(gv_color(x11,mistyrose4)).
+assert(gv_color(x11,moccasin)).
+assert(gv_color(x11,navajowhite)).
+assert(gv_color(x11,navajowhite1)).
+assert(gv_color(x11,navajowhite2)).
+assert(gv_color(x11,navajowhite3)).
+assert(gv_color(x11,navajowhite4)).
+assert(gv_color(x11,navy)).
+assert(gv_color(x11,navyblue)).
+assert(gv_color(x11,none)).
+assert(gv_color(x11,oldlace)).
+assert(gv_color(x11,olivedrab)).
+assert(gv_color(x11,olivedrab1)).
+assert(gv_color(x11,olivedrab2)).
+assert(gv_color(x11,olivedrab3)).
+assert(gv_color(x11,olivedrab4)).
+assert(gv_color(x11,orange)).
+assert(gv_color(x11,orange1)).
+assert(gv_color(x11,orange2)).
+assert(gv_color(x11,orange3)).
+assert(gv_color(x11,orange4)).
+assert(gv_color(x11,orangered)).
+assert(gv_color(x11,orangered1)).
+assert(gv_color(x11,orangered2)).
+assert(gv_color(x11,orangered3)).
+assert(gv_color(x11,orangered4)).
+assert(gv_color(x11,orchid)).
+assert(gv_color(x11,orchid1)).
+assert(gv_color(x11,orchid2)).
+assert(gv_color(x11,orchid3)).
+assert(gv_color(x11,orchid4)).
+assert(gv_color(x11,palegoldenrod)).
+assert(gv_color(x11,palegreen)).
+assert(gv_color(x11,palegreen1)).
+assert(gv_color(x11,palegreen2)).
+assert(gv_color(x11,palegreen3)).
+assert(gv_color(x11,palegreen4)).
+assert(gv_color(x11,paleturquoise)).
+assert(gv_color(x11,paleturquoise1)).
+assert(gv_color(x11,paleturquoise2)).
+assert(gv_color(x11,paleturquoise3)).
+assert(gv_color(x11,paleturquoise4)).
+assert(gv_color(x11,palevioletred)).
+assert(gv_color(x11,palevioletred1)).
+assert(gv_color(x11,palevioletred2)).
+assert(gv_color(x11,palevioletred3)).
+assert(gv_color(x11,palevioletred4)).
+assert(gv_color(x11,papayawhip)).
+assert(gv_color(x11,peachpuff)).
+assert(gv_color(x11,peachpuff1)).
+assert(gv_color(x11,peachpuff2)).
+assert(gv_color(x11,peachpuff3)).
+assert(gv_color(x11,peachpuff4)).
+assert(gv_color(x11,peru)).
+assert(gv_color(x11,pink)).
+assert(gv_color(x11,pink1)).
+assert(gv_color(x11,pink2)).
+assert(gv_color(x11,pink3)).
+assert(gv_color(x11,pink4)).
+assert(gv_color(x11,plum)).
+assert(gv_color(x11,plum1)).
+assert(gv_color(x11,plum2)).
+assert(gv_color(x11,plum3)).
+assert(gv_color(x11,plum4)).
+assert(gv_color(x11,powderblue)).
+assert(gv_color(x11,purple)).
+assert(gv_color(x11,purple1)).
+assert(gv_color(x11,purple2)).
+assert(gv_color(x11,purple3)).
+assert(gv_color(x11,purple4)).
+assert(gv_color(x11,red)).
+assert(gv_color(x11,red1)).
+assert(gv_color(x11,red2)).
+assert(gv_color(x11,red3)).
+assert(gv_color(x11,red4)).
+assert(gv_color(x11,rosybrown)).
+assert(gv_color(x11,rosybrown1)).
+assert(gv_color(x11,rosybrown2)).
+assert(gv_color(x11,rosybrown3)).
+assert(gv_color(x11,rosybrown4)).
+assert(gv_color(x11,royalblue)).
+assert(gv_color(x11,royalblue1)).
+assert(gv_color(x11,royalblue2)).
+assert(gv_color(x11,royalblue3)).
+assert(gv_color(x11,royalblue4)).
+assert(gv_color(x11,saddlebrown)).
+assert(gv_color(x11,salmon)).
+assert(gv_color(x11,salmon1)).
+assert(gv_color(x11,salmon2)).
+assert(gv_color(x11,salmon3)).
+assert(gv_color(x11,salmon4)).
+assert(gv_color(x11,sandybrown)).
+assert(gv_color(x11,seagreen)).
+assert(gv_color(x11,seagreen1)).
+assert(gv_color(x11,seagreen2)).
+assert(gv_color(x11,seagreen3)).
+assert(gv_color(x11,seagreen4)).
+assert(gv_color(x11,seashell)).
+assert(gv_color(x11,seashell1)).
+assert(gv_color(x11,seashell2)).
+assert(gv_color(x11,seashell3)).
+assert(gv_color(x11,seashell4)).
+assert(gv_color(x11,sienna)).
+assert(gv_color(x11,sienna1)).
+assert(gv_color(x11,sienna2)).
+assert(gv_color(x11,sienna3)).
+assert(gv_color(x11,sienna4)).
+assert(gv_color(x11,skyblue)).
+assert(gv_color(x11,skyblue1)).
+assert(gv_color(x11,skyblue2)).
+assert(gv_color(x11,skyblue3)).
+assert(gv_color(x11,skyblue4)).
+assert(gv_color(x11,slateblue)).
+assert(gv_color(x11,slateblue1)).
+assert(gv_color(x11,slateblue2)).
+assert(gv_color(x11,slateblue3)).
+assert(gv_color(x11,slateblue4)).
+assert(gv_color(x11,slategray)).
+assert(gv_color(x11,slategray1)).
+assert(gv_color(x11,slategray2)).
+assert(gv_color(x11,slategray3)).
+assert(gv_color(x11,slategray4)).
+assert(gv_color(x11,slategrey)).
+assert(gv_color(x11,snow)).
+assert(gv_color(x11,snow1)).
+assert(gv_color(x11,snow2)).
+assert(gv_color(x11,snow3)).
+assert(gv_color(x11,snow4)).
+assert(gv_color(x11,springgreen)).
+assert(gv_color(x11,springgreen1)).
+assert(gv_color(x11,springgreen2)).
+assert(gv_color(x11,springgreen3)).
+assert(gv_color(x11,springgreen4)).
+assert(gv_color(x11,steelblue)).
+assert(gv_color(x11,steelblue1)).
+assert(gv_color(x11,steelblue2)).
+assert(gv_color(x11,steelblue3)).
+assert(gv_color(x11,steelblue4)).
+assert(gv_color(x11,tan)).
+assert(gv_color(x11,tan1)).
+assert(gv_color(x11,tan2)).
+assert(gv_color(x11,tan3)).
+assert(gv_color(x11,tan4)).
+assert(gv_color(x11,thistle)).
+assert(gv_color(x11,thistle1)).
+assert(gv_color(x11,thistle2)).
+assert(gv_color(x11,thistle3)).
+assert(gv_color(x11,thistle4)).
+assert(gv_color(x11,tomato)).
+assert(gv_color(x11,tomato1)).
+assert(gv_color(x11,tomato2)).
+assert(gv_color(x11,tomato3)).
+assert(gv_color(x11,tomato4)).
+assert(gv_color(x11,transparent)).
+assert(gv_color(x11,turquoise)).
+assert(gv_color(x11,turquoise1)).
+assert(gv_color(x11,turquoise2)).
+assert(gv_color(x11,turquoise3)).
+assert(gv_color(x11,turquoise4)).
+assert(gv_color(x11,violet)).
+assert(gv_color(x11,violetred)).
+assert(gv_color(x11,violetred1)).
+assert(gv_color(x11,violetred2)).
+assert(gv_color(x11,violetred3)).
+assert(gv_color(x11,violetred4)).
+assert(gv_color(x11,wheat)).
+assert(gv_color(x11,wheat1)).
+assert(gv_color(x11,wheat2)).
+assert(gv_color(x11,wheat3)).
+assert(gv_color(x11,wheat4)).
+assert(gv_color(x11,white)).
+assert(gv_color(x11,whitesmoke)).
+assert(gv_color(x11,yellow)).
+assert(gv_color(x11,yellow1)).
+assert(gv_color(x11,yellow2)).
+assert(gv_color(x11,yellow3)).
+assert(gv_color(x11,yellow4)).
+assert(gv_color(x11,yellowgreen)).
+assert(gv_color(svg,aliceblue)).
+assert(gv_color(svg,antiquewhite)).
+assert(gv_color(svg,aqua)).
+assert(gv_color(svg,aquamarine)).
+assert(gv_color(svg,azure)).
+assert(gv_color(svg,beige)).
+assert(gv_color(svg,bisque)).
+assert(gv_color(svg,black)).
+assert(gv_color(svg,blanchedalmond)).
+assert(gv_color(svg,blue)).
+assert(gv_color(svg,blueviolet)).
+assert(gv_color(svg,brown)).
+assert(gv_color(svg,burlywood)).
+assert(gv_color(svg,cadetblue)).
+assert(gv_color(svg,chartreuse)).
+assert(gv_color(svg,chocolate)).
+assert(gv_color(svg,coral)).
+assert(gv_color(svg,cornflowerblue)).
+assert(gv_color(svg,cornsilk)).
+assert(gv_color(svg,crimson)).
+assert(gv_color(svg,cyan)).
+assert(gv_color(svg,darkblue)).
+assert(gv_color(svg,darkcyan)).
+assert(gv_color(svg,darkgoldenrod)).
+assert(gv_color(svg,darkgray)).
+assert(gv_color(svg,darkgreen)).
+assert(gv_color(svg,darkgrey)).
+assert(gv_color(svg,darkkhaki)).
+assert(gv_color(svg,darkmagenta)).
+assert(gv_color(svg,darkolivegreen)).
+assert(gv_color(svg,darkorange)).
+assert(gv_color(svg,darkorchid)).
+assert(gv_color(svg,darkred)).
+assert(gv_color(svg,darksalmon)).
+assert(gv_color(svg,darkseagreen)).
+assert(gv_color(svg,darkslateblue)).
+assert(gv_color(svg,darkslategray)).
+assert(gv_color(svg,darkslategrey)).
+assert(gv_color(svg,darkturquoise)).
+assert(gv_color(svg,darkviolet)).
+assert(gv_color(svg,deeppink)).
+assert(gv_color(svg,deepskyblue)).
+assert(gv_color(svg,dimgray)).
+assert(gv_color(svg,dimgrey)).
+assert(gv_color(svg,dodgerblue)).
+assert(gv_color(svg,firebrick)).
+assert(gv_color(svg,floralwhite)).
+assert(gv_color(svg,forestgreen)).
+assert(gv_color(svg,fuchsia)).
+assert(gv_color(svg,gainsboro)).
+assert(gv_color(svg,ghostwhite)).
+assert(gv_color(svg,gold)).
+assert(gv_color(svg,goldenrod)).
+assert(gv_color(svg,gray)).
+assert(gv_color(svg,grey)).
+assert(gv_color(svg,green)).
+assert(gv_color(svg,greenyellow)).
+assert(gv_color(svg,honeydew)).
+assert(gv_color(svg,hotpink)).
+assert(gv_color(svg,indianred)).
+assert(gv_color(svg,indigo)).
+assert(gv_color(svg,ivory)).
+assert(gv_color(svg,khaki)).
+assert(gv_color(svg,lavender)).
+assert(gv_color(svg,lavenderblush)).
+assert(gv_color(svg,lawngreen)).
+assert(gv_color(svg,lemonchiffon)).
+assert(gv_color(svg,lightblue)).
+assert(gv_color(svg,lightcoral)).
+assert(gv_color(svg,lightcyan)).
+assert(gv_color(svg,lightgoldenrodyellow)).
+assert(gv_color(svg,lightgray)).
+assert(gv_color(svg,lightgreen)).
+assert(gv_color(svg,lightgrey)).
+assert(gv_color(svg,lightpink)).
+assert(gv_color(svg,lightsalmon)).
+assert(gv_color(svg,lightseagreen)).
+assert(gv_color(svg,lightskyblue)).
+assert(gv_color(svg,lightslategray)).
+assert(gv_color(svg,lightslategrey)).
+assert(gv_color(svg,lightsteelblue)).
+assert(gv_color(svg,lightyellow)).
+assert(gv_color(svg,lime)).
+assert(gv_color(svg,limegreen)).
+assert(gv_color(svg,linen)).
+assert(gv_color(svg,magenta)).
+assert(gv_color(svg,maroon)).
+assert(gv_color(svg,mediumaquamarine)).
+assert(gv_color(svg,mediumblue)).
+assert(gv_color(svg,mediumorchid)).
+assert(gv_color(svg,mediumpurple)).
+assert(gv_color(svg,mediumseagreen)).
+assert(gv_color(svg,mediumslateblue)).
+assert(gv_color(svg,mediumspringgreen)).
+assert(gv_color(svg,mediumturquoise)).
+assert(gv_color(svg,mediumvioletred)).
+assert(gv_color(svg,midnightblue)).
+assert(gv_color(svg,mintcream)).
+assert(gv_color(svg,mistyrose)).
+assert(gv_color(svg,moccasin)).
+assert(gv_color(svg,navajowhite)).
+assert(gv_color(svg,navy)).
+assert(gv_color(svg,oldlace)).
+assert(gv_color(svg,olive)).
+assert(gv_color(svg,olivedrab)).
+assert(gv_color(svg,orange)).
+assert(gv_color(svg,orangered)).
+assert(gv_color(svg,orchid)).
+assert(gv_color(svg,palegoldenrod)).
+assert(gv_color(svg,palegreen)).
+assert(gv_color(svg,paleturquoise)).
+assert(gv_color(svg,palevioletred)).
+assert(gv_color(svg,papayawhip)).
+assert(gv_color(svg,peachpuff)).
+assert(gv_color(svg,peru)).
+assert(gv_color(svg,pink)).
+assert(gv_color(svg,plum)).
+assert(gv_color(svg,powderblue)).
+assert(gv_color(svg,purple)).
+assert(gv_color(svg,red)).
+assert(gv_color(svg,rosybrown)).
+assert(gv_color(svg,royalblue)).
+assert(gv_color(svg,saddlebrown)).
+assert(gv_color(svg,salmon)).
+assert(gv_color(svg,sandybrown)).
+assert(gv_color(svg,seagreen)).
+assert(gv_color(svg,seashell)).
+assert(gv_color(svg,sienna)).
+assert(gv_color(svg,silver)).
+assert(gv_color(svg,skyblue)).
+assert(gv_color(svg,slateblue)).
+assert(gv_color(svg,slategray)).
+assert(gv_color(svg,slategrey)).
+assert(gv_color(svg,snow)).
+assert(gv_color(svg,springgreen)).
+assert(gv_color(svg,steelblue)).
+assert(gv_color(svg,tan)).
+assert(gv_color(svg,teal)).
+assert(gv_color(svg,thistle)).
+assert(gv_color(svg,tomato)).
+assert(gv_color(svg,turquoise)).
+assert(gv_color(svg,violet)).
+assert(gv_color(svg,wheat)).
+assert(gv_color(svg,white)).
+assert(gv_color(svg,whitesmoke)).
+assert(gv_color(svg,yellow)).
+assert(gv_color(svg,yellowgreen)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;116&#34;&gt; 116: 正在比较变动前 65f43b8 和变动后 c6de3d1 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitignore b/.gitignore
index 7193a38..bd24270 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,4 +1,3 @@
 *~
 *#
 *.db
-data/*
diff --git a/pack.pl b/pack.pl
index dfee09c..edfd45f 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.14&#39;).
+version(&#39;0.0.15&#39;).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 5d97cb1..fa00670 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -9,7 +9,7 @@
 /** &amp;lt;module&amp;gt; GraphViz attributes
 
 @author Wouter Beek
-@version 2015/07
+@version 2015/07-2015/08
 */
 
 :- use_module(library(apply)).
@@ -17,10 +17,10 @@
 :- use_module(library(dcg/basics)).
 :- use_module(library(dcg/dcg_call)).
 :- use_module(library(dcg/dcg_phrase)).
-:- use_module(library(file_ext)).
 :- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
-:- use_module(library(html/html_download)).
+:- use_module(library(http/http_download)).
 :- use_module(library(lists)).
+:- use_module(library(os/file_ext)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 :- use_module(library(xpath/xpath_table)).
diff --git a/gv_color.log b/prolog/gv/gv_color.log
similarity index 100%
rename from gv_color.log
rename to prolog/gv/gv_color.log
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index d6eb478..57c7f90 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -21,9 +21,9 @@
 :- use_module(library(dcg/basics)).
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_content)).
-:- use_module(library(file_ext)).
-:- use_module(library(html/html_download)).
+:- use_module(library(http/http_download)).
 :- use_module(library(lists)).
+:- use_module(library(os/file_ext)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 :- use_module(library(xpath/xpath_table)).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 930fb32..18cdf7a 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -11,7 +11,7 @@
     gv_node_statement//2, % +Indent:nonneg
                           % +Vertex:compound
     gv_ranked_node_collection//2 % +Indent:nonneg
-				 % +Rank:???    
+                                 % +Rank
   ]
 ).
 
@@ -26,7 +26,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/dot-language
-@version 2015/07
+@version 2015/07-2015/08
 */
 
 :- use_module(library(apply)).
@@ -68,7 +68,7 @@ gv_edge_statement(I, Dir, edge(From,To,Attrs)) --&amp;gt;
   gv_node_id(From), &amp;quot; &amp;quot;,
   gv_edge_operator(Dir), &amp;quot; &amp;quot;,
   gv_node_id(To), &amp;quot; &amp;quot;,
-  
+
   % We want `colorscheme/1` from the edges and
   % `directionality/1` from the graph.
   gv_attrs(edge, Attrs),
@@ -130,7 +130,7 @@ gv_node_statement(I, vertex(Id,Attrs)) --&amp;gt;
 
 
 
-%! gv_ranked_node_collection(+Indent:nonneg, Rank:???)// is det.
+%! gv_ranked_node_collection(+Indent:nonneg, Rank)// is det.
 
 gv_ranked_node_collection(I, Rank) --&amp;gt;
   indent(I),
@@ -138,20 +138,20 @@ gv_ranked_node_collection(I, Rank) --&amp;gt;
 
 gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
   &amp;quot;\n&amp;quot;,
-  
+
   % The rank attribute.
   {NewI is I + 1},
   indent(NewI),
   gv_attr(subgraph, rank=same),
   &amp;quot;;\n&amp;quot;,
-  
+
   % Vertice statements.
   &#39;*&#39;(
     gv_node_statement(NewI),
     [Rank_V_Term|Content_V_Terms],
     []
   ),
-  
+
   % We want to indent the closing curly brace.
   indent(I),
   &amp;quot;\n&amp;quot;.
diff --git a/gv_attrs.log b/test/gv_attrs.log
similarity index 100%
rename from gv_attrs.log
rename to test/gv_attrs.log
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;117&#34;&gt; 117: 正在比较变动前 c6de3d1 和变动后 cab2231 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/gv_attrs.log b/gv_attrs.log
new file mode 100644
index 0000000..a9c6010
--- /dev/null
+++ b/gv_attrs.log
@@ -0,0 +1,169 @@
+assert(gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;)).
+assert(gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(&#39;_background&#39;,[graph],[string],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;)).
+assert(gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(bgcolor,[cluster,graph],[color,colorList],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;)).
+assert(gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(inputscale,[graph],[double],_,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;)).
+assert(gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labeltarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;)).
+assert(gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;nslimit nslimit1&#39;,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;)).
+assert(gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;)).
+assert(gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;)).
+assert(gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;)).
+assert(gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;)).
+assert(gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(target,[cluster,edge,graph,node],[escString,string],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;)).
+assert(gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;)).
+assert(gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;)).
+assert(gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;)).
+assert(gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;)).
+assert(gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;)).
diff --git a/gv_color.log b/gv_color.log
new file mode 100644
index 0000000..23d6cdf
--- /dev/null
+++ b/gv_color.log
@@ -0,0 +1,802 @@
+assert(gv_color(x11,aliceblue)).
+assert(gv_color(x11,antiquewhite)).
+assert(gv_color(x11,antiquewhite1)).
+assert(gv_color(x11,antiquewhite2)).
+assert(gv_color(x11,antiquewhite3)).
+assert(gv_color(x11,antiquewhite4)).
+assert(gv_color(x11,aquamarine)).
+assert(gv_color(x11,aquamarine1)).
+assert(gv_color(x11,aquamarine2)).
+assert(gv_color(x11,aquamarine3)).
+assert(gv_color(x11,aquamarine4)).
+assert(gv_color(x11,azure)).
+assert(gv_color(x11,azure1)).
+assert(gv_color(x11,azure2)).
+assert(gv_color(x11,azure3)).
+assert(gv_color(x11,azure4)).
+assert(gv_color(x11,beige)).
+assert(gv_color(x11,bisque)).
+assert(gv_color(x11,bisque1)).
+assert(gv_color(x11,bisque2)).
+assert(gv_color(x11,bisque3)).
+assert(gv_color(x11,bisque4)).
+assert(gv_color(x11,black)).
+assert(gv_color(x11,blanchedalmond)).
+assert(gv_color(x11,blue)).
+assert(gv_color(x11,blue1)).
+assert(gv_color(x11,blue2)).
+assert(gv_color(x11,blue3)).
+assert(gv_color(x11,blue4)).
+assert(gv_color(x11,blueviolet)).
+assert(gv_color(x11,brown)).
+assert(gv_color(x11,brown1)).
+assert(gv_color(x11,brown2)).
+assert(gv_color(x11,brown3)).
+assert(gv_color(x11,brown4)).
+assert(gv_color(x11,burlywood)).
+assert(gv_color(x11,burlywood1)).
+assert(gv_color(x11,burlywood2)).
+assert(gv_color(x11,burlywood3)).
+assert(gv_color(x11,burlywood4)).
+assert(gv_color(x11,cadetblue)).
+assert(gv_color(x11,cadetblue1)).
+assert(gv_color(x11,cadetblue2)).
+assert(gv_color(x11,cadetblue3)).
+assert(gv_color(x11,cadetblue4)).
+assert(gv_color(x11,chartreuse)).
+assert(gv_color(x11,chartreuse1)).
+assert(gv_color(x11,chartreuse2)).
+assert(gv_color(x11,chartreuse3)).
+assert(gv_color(x11,chartreuse4)).
+assert(gv_color(x11,chocolate)).
+assert(gv_color(x11,chocolate1)).
+assert(gv_color(x11,chocolate2)).
+assert(gv_color(x11,chocolate3)).
+assert(gv_color(x11,chocolate4)).
+assert(gv_color(x11,coral)).
+assert(gv_color(x11,coral1)).
+assert(gv_color(x11,coral2)).
+assert(gv_color(x11,coral3)).
+assert(gv_color(x11,coral4)).
+assert(gv_color(x11,cornflowerblue)).
+assert(gv_color(x11,cornsilk)).
+assert(gv_color(x11,cornsilk1)).
+assert(gv_color(x11,cornsilk2)).
+assert(gv_color(x11,cornsilk3)).
+assert(gv_color(x11,cornsilk4)).
+assert(gv_color(x11,crimson)).
+assert(gv_color(x11,cyan)).
+assert(gv_color(x11,cyan1)).
+assert(gv_color(x11,cyan2)).
+assert(gv_color(x11,cyan3)).
+assert(gv_color(x11,cyan4)).
+assert(gv_color(x11,darkgoldenrod)).
+assert(gv_color(x11,darkgoldenrod1)).
+assert(gv_color(x11,darkgoldenrod2)).
+assert(gv_color(x11,darkgoldenrod3)).
+assert(gv_color(x11,darkgoldenrod4)).
+assert(gv_color(x11,darkgreen)).
+assert(gv_color(x11,darkkhaki)).
+assert(gv_color(x11,darkolivegreen)).
+assert(gv_color(x11,darkolivegreen1)).
+assert(gv_color(x11,darkolivegreen2)).
+assert(gv_color(x11,darkolivegreen3)).
+assert(gv_color(x11,darkolivegreen4)).
+assert(gv_color(x11,darkorange)).
+assert(gv_color(x11,darkorange1)).
+assert(gv_color(x11,darkorange2)).
+assert(gv_color(x11,darkorange3)).
+assert(gv_color(x11,darkorange4)).
+assert(gv_color(x11,darkorchid)).
+assert(gv_color(x11,darkorchid1)).
+assert(gv_color(x11,darkorchid2)).
+assert(gv_color(x11,darkorchid3)).
+assert(gv_color(x11,darkorchid4)).
+assert(gv_color(x11,darksalmon)).
+assert(gv_color(x11,darkseagreen)).
+assert(gv_color(x11,darkseagreen1)).
+assert(gv_color(x11,darkseagreen2)).
+assert(gv_color(x11,darkseagreen3)).
+assert(gv_color(x11,darkseagreen4)).
+assert(gv_color(x11,darkslateblue)).
+assert(gv_color(x11,darkslategray)).
+assert(gv_color(x11,darkslategray1)).
+assert(gv_color(x11,darkslategray2)).
+assert(gv_color(x11,darkslategray3)).
+assert(gv_color(x11,darkslategray4)).
+assert(gv_color(x11,darkslategrey)).
+assert(gv_color(x11,darkturquoise)).
+assert(gv_color(x11,darkviolet)).
+assert(gv_color(x11,deeppink)).
+assert(gv_color(x11,deeppink1)).
+assert(gv_color(x11,deeppink2)).
+assert(gv_color(x11,deeppink3)).
+assert(gv_color(x11,deeppink4)).
+assert(gv_color(x11,deepskyblue)).
+assert(gv_color(x11,deepskyblue1)).
+assert(gv_color(x11,deepskyblue2)).
+assert(gv_color(x11,deepskyblue3)).
+assert(gv_color(x11,deepskyblue4)).
+assert(gv_color(x11,dimgray)).
+assert(gv_color(x11,dimgrey)).
+assert(gv_color(x11,dodgerblue)).
+assert(gv_color(x11,dodgerblue1)).
+assert(gv_color(x11,dodgerblue2)).
+assert(gv_color(x11,dodgerblue3)).
+assert(gv_color(x11,dodgerblue4)).
+assert(gv_color(x11,firebrick)).
+assert(gv_color(x11,firebrick1)).
+assert(gv_color(x11,firebrick2)).
+assert(gv_color(x11,firebrick3)).
+assert(gv_color(x11,firebrick4)).
+assert(gv_color(x11,floralwhite)).
+assert(gv_color(x11,forestgreen)).
+assert(gv_color(x11,gainsboro)).
+assert(gv_color(x11,ghostwhite)).
+assert(gv_color(x11,gold)).
+assert(gv_color(x11,gold1)).
+assert(gv_color(x11,gold2)).
+assert(gv_color(x11,gold3)).
+assert(gv_color(x11,gold4)).
+assert(gv_color(x11,goldenrod)).
+assert(gv_color(x11,goldenrod1)).
+assert(gv_color(x11,goldenrod2)).
+assert(gv_color(x11,goldenrod3)).
+assert(gv_color(x11,goldenrod4)).
+assert(gv_color(x11,gray)).
+assert(gv_color(x11,gray0)).
+assert(gv_color(x11,gray1)).
+assert(gv_color(x11,gray10)).
+assert(gv_color(x11,gray100)).
+assert(gv_color(x11,gray11)).
+assert(gv_color(x11,gray12)).
+assert(gv_color(x11,gray13)).
+assert(gv_color(x11,gray14)).
+assert(gv_color(x11,gray15)).
+assert(gv_color(x11,gray16)).
+assert(gv_color(x11,gray17)).
+assert(gv_color(x11,gray18)).
+assert(gv_color(x11,gray19)).
+assert(gv_color(x11,gray2)).
+assert(gv_color(x11,gray20)).
+assert(gv_color(x11,gray21)).
+assert(gv_color(x11,gray22)).
+assert(gv_color(x11,gray23)).
+assert(gv_color(x11,gray24)).
+assert(gv_color(x11,gray25)).
+assert(gv_color(x11,gray26)).
+assert(gv_color(x11,gray27)).
+assert(gv_color(x11,gray28)).
+assert(gv_color(x11,gray29)).
+assert(gv_color(x11,gray3)).
+assert(gv_color(x11,gray30)).
+assert(gv_color(x11,gray31)).
+assert(gv_color(x11,gray32)).
+assert(gv_color(x11,gray33)).
+assert(gv_color(x11,gray34)).
+assert(gv_color(x11,gray35)).
+assert(gv_color(x11,gray36)).
+assert(gv_color(x11,gray37)).
+assert(gv_color(x11,gray38)).
+assert(gv_color(x11,gray39)).
+assert(gv_color(x11,gray4)).
+assert(gv_color(x11,gray40)).
+assert(gv_color(x11,gray41)).
+assert(gv_color(x11,gray42)).
+assert(gv_color(x11,gray43)).
+assert(gv_color(x11,gray44)).
+assert(gv_color(x11,gray45)).
+assert(gv_color(x11,gray46)).
+assert(gv_color(x11,gray47)).
+assert(gv_color(x11,gray48)).
+assert(gv_color(x11,gray49)).
+assert(gv_color(x11,gray5)).
+assert(gv_color(x11,gray50)).
+assert(gv_color(x11,gray51)).
+assert(gv_color(x11,gray52)).
+assert(gv_color(x11,gray53)).
+assert(gv_color(x11,gray54)).
+assert(gv_color(x11,gray55)).
+assert(gv_color(x11,gray56)).
+assert(gv_color(x11,gray57)).
+assert(gv_color(x11,gray58)).
+assert(gv_color(x11,gray59)).
+assert(gv_color(x11,gray6)).
+assert(gv_color(x11,gray60)).
+assert(gv_color(x11,gray61)).
+assert(gv_color(x11,gray62)).
+assert(gv_color(x11,gray63)).
+assert(gv_color(x11,gray64)).
+assert(gv_color(x11,gray65)).
+assert(gv_color(x11,gray66)).
+assert(gv_color(x11,gray67)).
+assert(gv_color(x11,gray68)).
+assert(gv_color(x11,gray69)).
+assert(gv_color(x11,gray7)).
+assert(gv_color(x11,gray70)).
+assert(gv_color(x11,gray71)).
+assert(gv_color(x11,gray72)).
+assert(gv_color(x11,gray73)).
+assert(gv_color(x11,gray74)).
+assert(gv_color(x11,gray75)).
+assert(gv_color(x11,gray76)).
+assert(gv_color(x11,gray77)).
+assert(gv_color(x11,gray78)).
+assert(gv_color(x11,gray79)).
+assert(gv_color(x11,gray8)).
+assert(gv_color(x11,gray80)).
+assert(gv_color(x11,gray81)).
+assert(gv_color(x11,gray82)).
+assert(gv_color(x11,gray83)).
+assert(gv_color(x11,gray84)).
+assert(gv_color(x11,gray85)).
+assert(gv_color(x11,gray86)).
+assert(gv_color(x11,gray87)).
+assert(gv_color(x11,gray88)).
+assert(gv_color(x11,gray89)).
+assert(gv_color(x11,gray9)).
+assert(gv_color(x11,gray90)).
+assert(gv_color(x11,gray91)).
+assert(gv_color(x11,gray92)).
+assert(gv_color(x11,gray93)).
+assert(gv_color(x11,gray94)).
+assert(gv_color(x11,gray95)).
+assert(gv_color(x11,gray96)).
+assert(gv_color(x11,gray97)).
+assert(gv_color(x11,gray98)).
+assert(gv_color(x11,gray99)).
+assert(gv_color(x11,green)).
+assert(gv_color(x11,green1)).
+assert(gv_color(x11,green2)).
+assert(gv_color(x11,green3)).
+assert(gv_color(x11,green4)).
+assert(gv_color(x11,greenyellow)).
+assert(gv_color(x11,grey)).
+assert(gv_color(x11,grey0)).
+assert(gv_color(x11,grey1)).
+assert(gv_color(x11,grey10)).
+assert(gv_color(x11,grey100)).
+assert(gv_color(x11,grey11)).
+assert(gv_color(x11,grey12)).
+assert(gv_color(x11,grey13)).
+assert(gv_color(x11,grey14)).
+assert(gv_color(x11,grey15)).
+assert(gv_color(x11,grey16)).
+assert(gv_color(x11,grey17)).
+assert(gv_color(x11,grey18)).
+assert(gv_color(x11,grey19)).
+assert(gv_color(x11,grey2)).
+assert(gv_color(x11,grey20)).
+assert(gv_color(x11,grey21)).
+assert(gv_color(x11,grey22)).
+assert(gv_color(x11,grey23)).
+assert(gv_color(x11,grey24)).
+assert(gv_color(x11,grey25)).
+assert(gv_color(x11,grey26)).
+assert(gv_color(x11,grey27)).
+assert(gv_color(x11,grey28)).
+assert(gv_color(x11,grey29)).
+assert(gv_color(x11,grey3)).
+assert(gv_color(x11,grey30)).
+assert(gv_color(x11,grey31)).
+assert(gv_color(x11,grey32)).
+assert(gv_color(x11,grey33)).
+assert(gv_color(x11,grey34)).
+assert(gv_color(x11,grey35)).
+assert(gv_color(x11,grey36)).
+assert(gv_color(x11,grey37)).
+assert(gv_color(x11,grey38)).
+assert(gv_color(x11,grey39)).
+assert(gv_color(x11,grey4)).
+assert(gv_color(x11,grey40)).
+assert(gv_color(x11,grey41)).
+assert(gv_color(x11,grey42)).
+assert(gv_color(x11,grey43)).
+assert(gv_color(x11,grey44)).
+assert(gv_color(x11,grey45)).
+assert(gv_color(x11,grey46)).
+assert(gv_color(x11,grey47)).
+assert(gv_color(x11,grey48)).
+assert(gv_color(x11,grey49)).
+assert(gv_color(x11,grey5)).
+assert(gv_color(x11,grey50)).
+assert(gv_color(x11,grey51)).
+assert(gv_color(x11,grey52)).
+assert(gv_color(x11,grey53)).
+assert(gv_color(x11,grey54)).
+assert(gv_color(x11,grey55)).
+assert(gv_color(x11,grey56)).
+assert(gv_color(x11,grey57)).
+assert(gv_color(x11,grey58)).
+assert(gv_color(x11,grey59)).
+assert(gv_color(x11,grey6)).
+assert(gv_color(x11,grey60)).
+assert(gv_color(x11,grey61)).
+assert(gv_color(x11,grey62)).
+assert(gv_color(x11,grey63)).
+assert(gv_color(x11,grey64)).
+assert(gv_color(x11,grey65)).
+assert(gv_color(x11,grey66)).
+assert(gv_color(x11,grey67)).
+assert(gv_color(x11,grey68)).
+assert(gv_color(x11,grey69)).
+assert(gv_color(x11,grey7)).
+assert(gv_color(x11,grey70)).
+assert(gv_color(x11,grey71)).
+assert(gv_color(x11,grey72)).
+assert(gv_color(x11,grey73)).
+assert(gv_color(x11,grey74)).
+assert(gv_color(x11,grey75)).
+assert(gv_color(x11,grey76)).
+assert(gv_color(x11,grey77)).
+assert(gv_color(x11,grey78)).
+assert(gv_color(x11,grey79)).
+assert(gv_color(x11,grey8)).
+assert(gv_color(x11,grey80)).
+assert(gv_color(x11,grey81)).
+assert(gv_color(x11,grey82)).
+assert(gv_color(x11,grey83)).
+assert(gv_color(x11,grey84)).
+assert(gv_color(x11,grey85)).
+assert(gv_color(x11,grey86)).
+assert(gv_color(x11,grey87)).
+assert(gv_color(x11,grey88)).
+assert(gv_color(x11,grey89)).
+assert(gv_color(x11,grey9)).
+assert(gv_color(x11,grey90)).
+assert(gv_color(x11,grey91)).
+assert(gv_color(x11,grey92)).
+assert(gv_color(x11,grey93)).
+assert(gv_color(x11,grey94)).
+assert(gv_color(x11,grey95)).
+assert(gv_color(x11,grey96)).
+assert(gv_color(x11,grey97)).
+assert(gv_color(x11,grey98)).
+assert(gv_color(x11,grey99)).
+assert(gv_color(x11,honeydew)).
+assert(gv_color(x11,honeydew1)).
+assert(gv_color(x11,honeydew2)).
+assert(gv_color(x11,honeydew3)).
+assert(gv_color(x11,honeydew4)).
+assert(gv_color(x11,hotpink)).
+assert(gv_color(x11,hotpink1)).
+assert(gv_color(x11,hotpink2)).
+assert(gv_color(x11,hotpink3)).
+assert(gv_color(x11,hotpink4)).
+assert(gv_color(x11,indianred)).
+assert(gv_color(x11,indianred1)).
+assert(gv_color(x11,indianred2)).
+assert(gv_color(x11,indianred3)).
+assert(gv_color(x11,indianred4)).
+assert(gv_color(x11,indigo)).
+assert(gv_color(x11,invis)).
+assert(gv_color(x11,ivory)).
+assert(gv_color(x11,ivory1)).
+assert(gv_color(x11,ivory2)).
+assert(gv_color(x11,ivory3)).
+assert(gv_color(x11,ivory4)).
+assert(gv_color(x11,khaki)).
+assert(gv_color(x11,khaki1)).
+assert(gv_color(x11,khaki2)).
+assert(gv_color(x11,khaki3)).
+assert(gv_color(x11,khaki4)).
+assert(gv_color(x11,lavender)).
+assert(gv_color(x11,lavenderblush)).
+assert(gv_color(x11,lavenderblush1)).
+assert(gv_color(x11,lavenderblush2)).
+assert(gv_color(x11,lavenderblush3)).
+assert(gv_color(x11,lavenderblush4)).
+assert(gv_color(x11,lawngreen)).
+assert(gv_color(x11,lemonchiffon)).
+assert(gv_color(x11,lemonchiffon1)).
+assert(gv_color(x11,lemonchiffon2)).
+assert(gv_color(x11,lemonchiffon3)).
+assert(gv_color(x11,lemonchiffon4)).
+assert(gv_color(x11,lightblue)).
+assert(gv_color(x11,lightblue1)).
+assert(gv_color(x11,lightblue2)).
+assert(gv_color(x11,lightblue3)).
+assert(gv_color(x11,lightblue4)).
+assert(gv_color(x11,lightcoral)).
+assert(gv_color(x11,lightcyan)).
+assert(gv_color(x11,lightcyan1)).
+assert(gv_color(x11,lightcyan2)).
+assert(gv_color(x11,lightcyan3)).
+assert(gv_color(x11,lightcyan4)).
+assert(gv_color(x11,lightgoldenrod)).
+assert(gv_color(x11,lightgoldenrod1)).
+assert(gv_color(x11,lightgoldenrod2)).
+assert(gv_color(x11,lightgoldenrod3)).
+assert(gv_color(x11,lightgoldenrod4)).
+assert(gv_color(x11,lightgoldenrodyellow)).
+assert(gv_color(x11,lightgray)).
+assert(gv_color(x11,lightgrey)).
+assert(gv_color(x11,lightpink)).
+assert(gv_color(x11,lightpink1)).
+assert(gv_color(x11,lightpink2)).
+assert(gv_color(x11,lightpink3)).
+assert(gv_color(x11,lightpink4)).
+assert(gv_color(x11,lightsalmon)).
+assert(gv_color(x11,lightsalmon1)).
+assert(gv_color(x11,lightsalmon2)).
+assert(gv_color(x11,lightsalmon3)).
+assert(gv_color(x11,lightsalmon4)).
+assert(gv_color(x11,lightseagreen)).
+assert(gv_color(x11,lightskyblue)).
+assert(gv_color(x11,lightskyblue1)).
+assert(gv_color(x11,lightskyblue2)).
+assert(gv_color(x11,lightskyblue3)).
+assert(gv_color(x11,lightskyblue4)).
+assert(gv_color(x11,lightslateblue)).
+assert(gv_color(x11,lightslategray)).
+assert(gv_color(x11,lightslategrey)).
+assert(gv_color(x11,lightsteelblue)).
+assert(gv_color(x11,lightsteelblue1)).
+assert(gv_color(x11,lightsteelblue2)).
+assert(gv_color(x11,lightsteelblue3)).
+assert(gv_color(x11,lightsteelblue4)).
+assert(gv_color(x11,lightyellow)).
+assert(gv_color(x11,lightyellow1)).
+assert(gv_color(x11,lightyellow2)).
+assert(gv_color(x11,lightyellow3)).
+assert(gv_color(x11,lightyellow4)).
+assert(gv_color(x11,limegreen)).
+assert(gv_color(x11,linen)).
+assert(gv_color(x11,magenta)).
+assert(gv_color(x11,magenta1)).
+assert(gv_color(x11,magenta2)).
+assert(gv_color(x11,magenta3)).
+assert(gv_color(x11,magenta4)).
+assert(gv_color(x11,maroon)).
+assert(gv_color(x11,maroon1)).
+assert(gv_color(x11,maroon2)).
+assert(gv_color(x11,maroon3)).
+assert(gv_color(x11,maroon4)).
+assert(gv_color(x11,mediumaquamarine)).
+assert(gv_color(x11,mediumblue)).
+assert(gv_color(x11,mediumorchid)).
+assert(gv_color(x11,mediumorchid1)).
+assert(gv_color(x11,mediumorchid2)).
+assert(gv_color(x11,mediumorchid3)).
+assert(gv_color(x11,mediumorchid4)).
+assert(gv_color(x11,mediumpurple)).
+assert(gv_color(x11,mediumpurple1)).
+assert(gv_color(x11,mediumpurple2)).
+assert(gv_color(x11,mediumpurple3)).
+assert(gv_color(x11,mediumpurple4)).
+assert(gv_color(x11,mediumseagreen)).
+assert(gv_color(x11,mediumslateblue)).
+assert(gv_color(x11,mediumspringgreen)).
+assert(gv_color(x11,mediumturquoise)).
+assert(gv_color(x11,mediumvioletred)).
+assert(gv_color(x11,midnightblue)).
+assert(gv_color(x11,mintcream)).
+assert(gv_color(x11,mistyrose)).
+assert(gv_color(x11,mistyrose1)).
+assert(gv_color(x11,mistyrose2)).
+assert(gv_color(x11,mistyrose3)).
+assert(gv_color(x11,mistyrose4)).
+assert(gv_color(x11,moccasin)).
+assert(gv_color(x11,navajowhite)).
+assert(gv_color(x11,navajowhite1)).
+assert(gv_color(x11,navajowhite2)).
+assert(gv_color(x11,navajowhite3)).
+assert(gv_color(x11,navajowhite4)).
+assert(gv_color(x11,navy)).
+assert(gv_color(x11,navyblue)).
+assert(gv_color(x11,none)).
+assert(gv_color(x11,oldlace)).
+assert(gv_color(x11,olivedrab)).
+assert(gv_color(x11,olivedrab1)).
+assert(gv_color(x11,olivedrab2)).
+assert(gv_color(x11,olivedrab3)).
+assert(gv_color(x11,olivedrab4)).
+assert(gv_color(x11,orange)).
+assert(gv_color(x11,orange1)).
+assert(gv_color(x11,orange2)).
+assert(gv_color(x11,orange3)).
+assert(gv_color(x11,orange4)).
+assert(gv_color(x11,orangered)).
+assert(gv_color(x11,orangered1)).
+assert(gv_color(x11,orangered2)).
+assert(gv_color(x11,orangered3)).
+assert(gv_color(x11,orangered4)).
+assert(gv_color(x11,orchid)).
+assert(gv_color(x11,orchid1)).
+assert(gv_color(x11,orchid2)).
+assert(gv_color(x11,orchid3)).
+assert(gv_color(x11,orchid4)).
+assert(gv_color(x11,palegoldenrod)).
+assert(gv_color(x11,palegreen)).
+assert(gv_color(x11,palegreen1)).
+assert(gv_color(x11,palegreen2)).
+assert(gv_color(x11,palegreen3)).
+assert(gv_color(x11,palegreen4)).
+assert(gv_color(x11,paleturquoise)).
+assert(gv_color(x11,paleturquoise1)).
+assert(gv_color(x11,paleturquoise2)).
+assert(gv_color(x11,paleturquoise3)).
+assert(gv_color(x11,paleturquoise4)).
+assert(gv_color(x11,palevioletred)).
+assert(gv_color(x11,palevioletred1)).
+assert(gv_color(x11,palevioletred2)).
+assert(gv_color(x11,palevioletred3)).
+assert(gv_color(x11,palevioletred4)).
+assert(gv_color(x11,papayawhip)).
+assert(gv_color(x11,peachpuff)).
+assert(gv_color(x11,peachpuff1)).
+assert(gv_color(x11,peachpuff2)).
+assert(gv_color(x11,peachpuff3)).
+assert(gv_color(x11,peachpuff4)).
+assert(gv_color(x11,peru)).
+assert(gv_color(x11,pink)).
+assert(gv_color(x11,pink1)).
+assert(gv_color(x11,pink2)).
+assert(gv_color(x11,pink3)).
+assert(gv_color(x11,pink4)).
+assert(gv_color(x11,plum)).
+assert(gv_color(x11,plum1)).
+assert(gv_color(x11,plum2)).
+assert(gv_color(x11,plum3)).
+assert(gv_color(x11,plum4)).
+assert(gv_color(x11,powderblue)).
+assert(gv_color(x11,purple)).
+assert(gv_color(x11,purple1)).
+assert(gv_color(x11,purple2)).
+assert(gv_color(x11,purple3)).
+assert(gv_color(x11,purple4)).
+assert(gv_color(x11,red)).
+assert(gv_color(x11,red1)).
+assert(gv_color(x11,red2)).
+assert(gv_color(x11,red3)).
+assert(gv_color(x11,red4)).
+assert(gv_color(x11,rosybrown)).
+assert(gv_color(x11,rosybrown1)).
+assert(gv_color(x11,rosybrown2)).
+assert(gv_color(x11,rosybrown3)).
+assert(gv_color(x11,rosybrown4)).
+assert(gv_color(x11,royalblue)).
+assert(gv_color(x11,royalblue1)).
+assert(gv_color(x11,royalblue2)).
+assert(gv_color(x11,royalblue3)).
+assert(gv_color(x11,royalblue4)).
+assert(gv_color(x11,saddlebrown)).
+assert(gv_color(x11,salmon)).
+assert(gv_color(x11,salmon1)).
+assert(gv_color(x11,salmon2)).
+assert(gv_color(x11,salmon3)).
+assert(gv_color(x11,salmon4)).
+assert(gv_color(x11,sandybrown)).
+assert(gv_color(x11,seagreen)).
+assert(gv_color(x11,seagreen1)).
+assert(gv_color(x11,seagreen2)).
+assert(gv_color(x11,seagreen3)).
+assert(gv_color(x11,seagreen4)).
+assert(gv_color(x11,seashell)).
+assert(gv_color(x11,seashell1)).
+assert(gv_color(x11,seashell2)).
+assert(gv_color(x11,seashell3)).
+assert(gv_color(x11,seashell4)).
+assert(gv_color(x11,sienna)).
+assert(gv_color(x11,sienna1)).
+assert(gv_color(x11,sienna2)).
+assert(gv_color(x11,sienna3)).
+assert(gv_color(x11,sienna4)).
+assert(gv_color(x11,skyblue)).
+assert(gv_color(x11,skyblue1)).
+assert(gv_color(x11,skyblue2)).
+assert(gv_color(x11,skyblue3)).
+assert(gv_color(x11,skyblue4)).
+assert(gv_color(x11,slateblue)).
+assert(gv_color(x11,slateblue1)).
+assert(gv_color(x11,slateblue2)).
+assert(gv_color(x11,slateblue3)).
+assert(gv_color(x11,slateblue4)).
+assert(gv_color(x11,slategray)).
+assert(gv_color(x11,slategray1)).
+assert(gv_color(x11,slategray2)).
+assert(gv_color(x11,slategray3)).
+assert(gv_color(x11,slategray4)).
+assert(gv_color(x11,slategrey)).
+assert(gv_color(x11,snow)).
+assert(gv_color(x11,snow1)).
+assert(gv_color(x11,snow2)).
+assert(gv_color(x11,snow3)).
+assert(gv_color(x11,snow4)).
+assert(gv_color(x11,springgreen)).
+assert(gv_color(x11,springgreen1)).
+assert(gv_color(x11,springgreen2)).
+assert(gv_color(x11,springgreen3)).
+assert(gv_color(x11,springgreen4)).
+assert(gv_color(x11,steelblue)).
+assert(gv_color(x11,steelblue1)).
+assert(gv_color(x11,steelblue2)).
+assert(gv_color(x11,steelblue3)).
+assert(gv_color(x11,steelblue4)).
+assert(gv_color(x11,tan)).
+assert(gv_color(x11,tan1)).
+assert(gv_color(x11,tan2)).
+assert(gv_color(x11,tan3)).
+assert(gv_color(x11,tan4)).
+assert(gv_color(x11,thistle)).
+assert(gv_color(x11,thistle1)).
+assert(gv_color(x11,thistle2)).
+assert(gv_color(x11,thistle3)).
+assert(gv_color(x11,thistle4)).
+assert(gv_color(x11,tomato)).
+assert(gv_color(x11,tomato1)).
+assert(gv_color(x11,tomato2)).
+assert(gv_color(x11,tomato3)).
+assert(gv_color(x11,tomato4)).
+assert(gv_color(x11,transparent)).
+assert(gv_color(x11,turquoise)).
+assert(gv_color(x11,turquoise1)).
+assert(gv_color(x11,turquoise2)).
+assert(gv_color(x11,turquoise3)).
+assert(gv_color(x11,turquoise4)).
+assert(gv_color(x11,violet)).
+assert(gv_color(x11,violetred)).
+assert(gv_color(x11,violetred1)).
+assert(gv_color(x11,violetred2)).
+assert(gv_color(x11,violetred3)).
+assert(gv_color(x11,violetred4)).
+assert(gv_color(x11,wheat)).
+assert(gv_color(x11,wheat1)).
+assert(gv_color(x11,wheat2)).
+assert(gv_color(x11,wheat3)).
+assert(gv_color(x11,wheat4)).
+assert(gv_color(x11,white)).
+assert(gv_color(x11,whitesmoke)).
+assert(gv_color(x11,yellow)).
+assert(gv_color(x11,yellow1)).
+assert(gv_color(x11,yellow2)).
+assert(gv_color(x11,yellow3)).
+assert(gv_color(x11,yellow4)).
+assert(gv_color(x11,yellowgreen)).
+assert(gv_color(svg,aliceblue)).
+assert(gv_color(svg,antiquewhite)).
+assert(gv_color(svg,aqua)).
+assert(gv_color(svg,aquamarine)).
+assert(gv_color(svg,azure)).
+assert(gv_color(svg,beige)).
+assert(gv_color(svg,bisque)).
+assert(gv_color(svg,black)).
+assert(gv_color(svg,blanchedalmond)).
+assert(gv_color(svg,blue)).
+assert(gv_color(svg,blueviolet)).
+assert(gv_color(svg,brown)).
+assert(gv_color(svg,burlywood)).
+assert(gv_color(svg,cadetblue)).
+assert(gv_color(svg,chartreuse)).
+assert(gv_color(svg,chocolate)).
+assert(gv_color(svg,coral)).
+assert(gv_color(svg,cornflowerblue)).
+assert(gv_color(svg,cornsilk)).
+assert(gv_color(svg,crimson)).
+assert(gv_color(svg,cyan)).
+assert(gv_color(svg,darkblue)).
+assert(gv_color(svg,darkcyan)).
+assert(gv_color(svg,darkgoldenrod)).
+assert(gv_color(svg,darkgray)).
+assert(gv_color(svg,darkgreen)).
+assert(gv_color(svg,darkgrey)).
+assert(gv_color(svg,darkkhaki)).
+assert(gv_color(svg,darkmagenta)).
+assert(gv_color(svg,darkolivegreen)).
+assert(gv_color(svg,darkorange)).
+assert(gv_color(svg,darkorchid)).
+assert(gv_color(svg,darkred)).
+assert(gv_color(svg,darksalmon)).
+assert(gv_color(svg,darkseagreen)).
+assert(gv_color(svg,darkslateblue)).
+assert(gv_color(svg,darkslategray)).
+assert(gv_color(svg,darkslategrey)).
+assert(gv_color(svg,darkturquoise)).
+assert(gv_color(svg,darkviolet)).
+assert(gv_color(svg,deeppink)).
+assert(gv_color(svg,deepskyblue)).
+assert(gv_color(svg,dimgray)).
+assert(gv_color(svg,dimgrey)).
+assert(gv_color(svg,dodgerblue)).
+assert(gv_color(svg,firebrick)).
+assert(gv_color(svg,floralwhite)).
+assert(gv_color(svg,forestgreen)).
+assert(gv_color(svg,fuchsia)).
+assert(gv_color(svg,gainsboro)).
+assert(gv_color(svg,ghostwhite)).
+assert(gv_color(svg,gold)).
+assert(gv_color(svg,goldenrod)).
+assert(gv_color(svg,gray)).
+assert(gv_color(svg,grey)).
+assert(gv_color(svg,green)).
+assert(gv_color(svg,greenyellow)).
+assert(gv_color(svg,honeydew)).
+assert(gv_color(svg,hotpink)).
+assert(gv_color(svg,indianred)).
+assert(gv_color(svg,indigo)).
+assert(gv_color(svg,ivory)).
+assert(gv_color(svg,khaki)).
+assert(gv_color(svg,lavender)).
+assert(gv_color(svg,lavenderblush)).
+assert(gv_color(svg,lawngreen)).
+assert(gv_color(svg,lemonchiffon)).
+assert(gv_color(svg,lightblue)).
+assert(gv_color(svg,lightcoral)).
+assert(gv_color(svg,lightcyan)).
+assert(gv_color(svg,lightgoldenrodyellow)).
+assert(gv_color(svg,lightgray)).
+assert(gv_color(svg,lightgreen)).
+assert(gv_color(svg,lightgrey)).
+assert(gv_color(svg,lightpink)).
+assert(gv_color(svg,lightsalmon)).
+assert(gv_color(svg,lightseagreen)).
+assert(gv_color(svg,lightskyblue)).
+assert(gv_color(svg,lightslategray)).
+assert(gv_color(svg,lightslategrey)).
+assert(gv_color(svg,lightsteelblue)).
+assert(gv_color(svg,lightyellow)).
+assert(gv_color(svg,lime)).
+assert(gv_color(svg,limegreen)).
+assert(gv_color(svg,linen)).
+assert(gv_color(svg,magenta)).
+assert(gv_color(svg,maroon)).
+assert(gv_color(svg,mediumaquamarine)).
+assert(gv_color(svg,mediumblue)).
+assert(gv_color(svg,mediumorchid)).
+assert(gv_color(svg,mediumpurple)).
+assert(gv_color(svg,mediumseagreen)).
+assert(gv_color(svg,mediumslateblue)).
+assert(gv_color(svg,mediumspringgreen)).
+assert(gv_color(svg,mediumturquoise)).
+assert(gv_color(svg,mediumvioletred)).
+assert(gv_color(svg,midnightblue)).
+assert(gv_color(svg,mintcream)).
+assert(gv_color(svg,mistyrose)).
+assert(gv_color(svg,moccasin)).
+assert(gv_color(svg,navajowhite)).
+assert(gv_color(svg,navy)).
+assert(gv_color(svg,oldlace)).
+assert(gv_color(svg,olive)).
+assert(gv_color(svg,olivedrab)).
+assert(gv_color(svg,orange)).
+assert(gv_color(svg,orangered)).
+assert(gv_color(svg,orchid)).
+assert(gv_color(svg,palegoldenrod)).
+assert(gv_color(svg,palegreen)).
+assert(gv_color(svg,paleturquoise)).
+assert(gv_color(svg,palevioletred)).
+assert(gv_color(svg,papayawhip)).
+assert(gv_color(svg,peachpuff)).
+assert(gv_color(svg,peru)).
+assert(gv_color(svg,pink)).
+assert(gv_color(svg,plum)).
+assert(gv_color(svg,powderblue)).
+assert(gv_color(svg,purple)).
+assert(gv_color(svg,red)).
+assert(gv_color(svg,rosybrown)).
+assert(gv_color(svg,royalblue)).
+assert(gv_color(svg,saddlebrown)).
+assert(gv_color(svg,salmon)).
+assert(gv_color(svg,sandybrown)).
+assert(gv_color(svg,seagreen)).
+assert(gv_color(svg,seashell)).
+assert(gv_color(svg,sienna)).
+assert(gv_color(svg,silver)).
+assert(gv_color(svg,skyblue)).
+assert(gv_color(svg,slateblue)).
+assert(gv_color(svg,slategray)).
+assert(gv_color(svg,slategrey)).
+assert(gv_color(svg,snow)).
+assert(gv_color(svg,springgreen)).
+assert(gv_color(svg,steelblue)).
+assert(gv_color(svg,tan)).
+assert(gv_color(svg,teal)).
+assert(gv_color(svg,thistle)).
+assert(gv_color(svg,tomato)).
+assert(gv_color(svg,turquoise)).
+assert(gv_color(svg,violet)).
+assert(gv_color(svg,wheat)).
+assert(gv_color(svg,white)).
+assert(gv_color(svg,whitesmoke)).
+assert(gv_color(svg,yellow)).
+assert(gv_color(svg,yellowgreen)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;118&#34;&gt; 118: 正在比较变动前 cab2231 和变动后 008c5e6 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attrs.log b/prolog/gv/gv_attrs.log
new file mode 100644
index 0000000..a9c6010
--- /dev/null
+++ b/prolog/gv/gv_attrs.log
@@ -0,0 +1,169 @@
+assert(gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;)).
+assert(gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(&#39;_background&#39;,[graph],[string],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;)).
+assert(gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(bgcolor,[cluster,graph],[color,colorList],_,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;)).
+assert(gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
+assert(gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(headtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
+assert(gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(inputscale,[graph],[double],_,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;)).
+assert(gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
+assert(gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(labeltarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;)).
+assert(gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;)).
+assert(gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
+assert(gv_attr(&#39;nslimit nslimit1&#39;,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;)).
+assert(gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;)).
+assert(gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;)).
+assert(gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
+assert(gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;)).
+assert(gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
+assert(gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;)).
+assert(gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;)).
+assert(gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;)).
+assert(gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
+assert(gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
+assert(gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;)).
+assert(gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
+assert(gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
+assert(gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(tailtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(target,[cluster,edge,graph,node],[escString,string],_,&#39;&#39;,&#39;svg, map only&#39;)).
+assert(gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
+assert(gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;)).
+assert(gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;)).
+assert(gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;)).
+assert(gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;)).
+assert(gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;)).
+assert(gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
+assert(gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
+assert(gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;119&#34;&gt; 119: 正在比较变动前 008c5e6 和变动后 dba5c72 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index edfd45f..ed03c94 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.15&#39;).
+version(&#39;0.0.16&#39;).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;120&#34;&gt; 120: 正在比较变动前 dba5c72 和变动后 eff64ee &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index ed03c94..203cbfc 100644
--- a/pack.pl
+++ b/pack.pl
@@ -6,4 +6,4 @@ name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 requires(&#39;Prolog_Library_Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.16&#39;).
+version(&#39;0.0.17&#39;).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;121&#34;&gt; 121: 正在比较变动前 eff64ee 和变动后 89eb423 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/test/debug.pl b/test/debug.pl
deleted file mode 100644
index b0f85ea..0000000
--- a/test/debug.pl
+++ /dev/null
@@ -1,15 +0,0 @@
-:- use_module(library(ansi_term)).
-:- use_module(library(prolog_pack)).
-
-pack_ensure_removed(Pack):-
-  pack_property(Pack, _), !,
-  pack_remove(Pack).
-pack_ensure_removed(_).
-
-test:-
-  pack_ensure_removed(plGraphViz),
-  source_file(test, ThisFile),
-  file_directory_name(ThisFile, ThisDirectory),
-  assert(user:file_search_path(gvTest, ThisDirectory)),
-  assert(user:file_search_path(library, gvTest(&#39;../prolog&#39;))).
-:- test.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;122&#34;&gt; 122: 正在比较变动前 89eb423 和变动后 2346997 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index c6508a3..b0dbd69 100644
--- a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -198,7 +198,7 @@ double(N) --&amp;gt;
 %! doubleList(+Doubles:list(float))// .
 
 doubleList(L) --&amp;gt;
-  &#39;*&#39;(double, L, [separator(colon)]).
+  *(double, L, [separator(colon)]).
 
 
 
@@ -292,7 +292,7 @@ input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
 %! pointList(+Points:list(compound))// .
 
 pointList(Points) --&amp;gt;
-  &#39;*&#39;(point, Points, []).
+  *(point, Points, []).
 
 
 
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index bff4257..5de2ff1 100644
--- a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -160,13 +160,13 @@ gv_graph(G1, I) --&amp;gt;
   &amp;quot;}\n&amp;quot;.
 
 gv_edge_statements(I, Dir, L) --&amp;gt;
-  &#39;*&#39;(gv_edge_statement(I, Dir), L, []), !.
+  *(gv_edge_statement(I, Dir), L, []), !.
 
 gv_node_statements(I, L) --&amp;gt;
-  &#39;*&#39;(gv_node_statement(I), L, []), !.
+  *(gv_node_statement(I), L, []), !.
 
 gv_ranked_node_collections(I, L) --&amp;gt;
-  &#39;*&#39;(gv_ranked_node_collection(I), L, []), !.
+  *(gv_ranked_node_collection(I), L, []), !.
 
 
 
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 18cdf7a..033d0b9 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -146,7 +146,7 @@ gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
   &amp;quot;;\n&amp;quot;,
 
   % Vertice statements.
-  &#39;*&#39;(
+  *(
     gv_node_statement(NewI),
     [Rank_V_Term|Content_V_Terms],
     []
@@ -168,7 +168,7 @@ gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
 %! )// is det.
 
 gv_attrs(Kind, L) --&amp;gt;
-  bracketed(square, &#39;*&#39;(gv_attr(Kind), L, [])).
+  bracketed(square, *(gv_attr(Kind), L, [])).
 
 %! gv_attr(
 %!   +Context:oneof([edge,graph,node]),
diff --git a/test/test.pl b/test/test.pl
index 898c04e..ee92ae6 100644
--- a/test/test.pl
+++ b/test/test.pl
@@ -1,5 +1,3 @@
-:- ensure_loaded(debug).
-
 %/graph
   :- use_module(library(graph/build_export_graph)).
 %/gv
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;123&#34;&gt; 123: 正在比较变动前 2346997 和变动后 d22d50e &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/.gitmodules b/.gitmodules
deleted file mode 100644
index 26ddd86..0000000
--- a/.gitmodules
+++ /dev/null
@@ -1,9 +0,0 @@
-[submodule &amp;quot;Prolog-Library-Collection&amp;quot;]
-	path = Prolog-Library-Collection
-	url = https://github.com/wouterbeek/Prolog-Library-Collection.git
-[submodule &amp;quot;plHtml&amp;quot;]
-	path = plHtml
-	url = https://github.com/wouterbeek/plHtml.git
-[submodule &amp;quot;plUri&amp;quot;]
-	path = plUri
-	url = https://github.com/wouterbeek/plUri.git
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index b031d16..507e8ad 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -1,6 +1,8 @@
 :- module(
   build_export_graph,
   [
+    build_export_graph/2, % +Graph:compound
+                          % -ExportGraph:compound
     build_export_graph/3 % +Graph:compound
                          % -ExportGraph:compound
                          % +Options:list(compound)
@@ -49,7 +51,7 @@ Vertex coordinates:
 ---
 
 @author Wouter Beek
-@version 2015/07
+@version 2015/07, 2015/09
 */
 
 :- use_module(library(apply)).
@@ -110,6 +112,11 @@ is_meta(vertex_uri).
 
 
 
+%! build_export_graph(+Graph:compound, -ExportGraph:compound) is det.
+
+build_export_graph(G, ExportG):-
+  build_export_graph(G, ExportG, []).
+
 %! build_export_graph(
 %!   +Graph:compound,
 %!   -ExportGraph:compound,
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;124&#34;&gt; 124: 正在比较变动前 d22d50e 和变动后 e64cc35 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/install b/install
new file mode 100755
index 0000000..849699b
--- /dev/null
+++ b/install
@@ -0,0 +1,218 @@
+#!/usr/bin/env swipl
+
+:- module(install, []).
+
+/** &amp;lt;module&amp;gt; Install
+
+Let&#39;s do this!
+
+@author Wouter Beek
+@version 2015/09/23
+*/
+
+:- use_module(library(filesex)).
+:- use_module(library(lists)).
+:- use_module(library(option)).
+:- use_module(library(optparse)).
+:- use_module(library(prolog_pack)).
+:- use_module(library(uri)).
+
+:- dynamic(author/2).
+:- dynamic(download/1).
+:- dynamic(home/1).
+:- dynamic(maintainer/2).
+:- dynamic(name/1).
+:- dynamic(packager/2).
+:- dynamic(requires/1).
+:- dynamic(title/1).
+:- dynamic(version/1).
+
+:- initialization(install).
+
+
+
+
+
+%! install is det.
+
+install:-
+  OptSpec = [
+    [ % Github
+      default(true),
+      help(&#39;Whether Github should be used to install requirements.&#39;),
+      longflags([git,github]),
+      opt(github),
+      type(boolean)
+    ],
+    [ % Help
+      default(false),
+      help(&#39;Display help about the install command.&#39;),
+      longflags([help]),
+      opt(help),
+      shortflags([h]),
+      type(boolean)
+    ],
+    [ % Pack
+      default(true),
+      help(&#39;Whether the Prolog Pack system is used for installing requirements.&#39;),
+      longflags([pack]),
+      opt(pack),
+      type(boolean)
+    ],
+    [ % Parent
+      default(false),
+      help(&#39;Whether existing installations in the parent directory should be taken into account.&#39;),
+      longflags([parent]),
+      opt(parent),
+      type(boolean)
+    ]
+  ],
+  opt_arguments(OptSpec, Opts, _),
+
+  % Process help
+  (option(help(true), Opts) -&amp;gt; show_help(OptSpec) ; install(Opts)).
+
+
+%! install(+Options:list(compound)) is det.
+
+install(Opts):-
+  source_file(install, File),
+  file_directory_name(File, AppDir),
+  install(AppDir, AppDir, Opts),
+  clean_meta,
+  halt.
+
+
+%! install(
+%!   +ApplicationDirectory:atom,
+%!   +LibraryDirectory:atom,
+%!   +Options:list(compound)
+%! ) is det.
+
+install(AppDir, LibDir, Opts):-
+  % The pack information is taken from the library directory.
+  % This allows application requirements to be installed recursively.
+  directory_file_path(LibDir, &#39;pack.pl&#39;, Info),
+  access_file(Info, read),
+  load_meta(Info),
+
+  % Set this library&#39;s search path.
+  name(Name),
+  assert(user:file_search_path(Name, LibDir)),
+
+  % Pull in the required libraries.
+  forall(requires(LibName), install_required(AppDir, LibName, Opts)), !.
+install(_, _, _):-
+  msg_warning(&#39;Installation failed.&#39;).
+
+
+%! install_required(
+%!   +ApplicationDirectory:atom,
+%!   +LibName:atom,
+%!   +Options:list(compound)
+%! ) is det.
+
+% Developer&#39;s delight: library already available from parent directory.
+install_required(AppDir, LibName, Opts):-
+  option(parent(true), Opts),
+
+  file_directory_name(AppDir, ParentDir),
+  append_directories(ParentDir, LibName, LibDir),
+  exists_directory(LibDir), !,
+
+  % Print message.
+  atomic_list_concat([&#39;Library &#39;,LibName,&#39; already installed.&#39;], Msg),
+  msg_success(Msg).
+% Install through the Prolog Pack system.
+install_required(_, LibName, Opts):-
+  option(pack(true), Opts),
+
+  prolog_pack:query_pack_server(search(LibName), Result,[]),
+  Result = true([pack(LibName,_,_,_,_)]), !,
+  pack_install(LibName).
+% Install through Github.
+install_required(AppDir, LibName, Opts):-
+  option(github(true), Opts),
+
+  % Remove the old version of the library.
+  append_directories(AppDir, LibName, LibDir),
+  (exists_directory(LibDir) -&amp;gt; delete_directory_and_contents(LibDir) ; true),
+
+  % Git clone the new version of the library.
+  atomic_list_concat([&#39;&#39;,wouterbeek,LibName], /, Path),
+  uri_components(Iri, uri_components(https,&#39;github.com&#39;,Path,_,_)),
+  prolog_pack:run_process(path(git), [clone,Iri,LibDir], []),
+
+  % Print message.
+  atomic_list_concat([&#39;Library &#39;,LibName,&#39; was installed.&#39;], Msg),
+  msg_success(Msg),
+  
+  % Recurse
+  install(AppDir, LibDir, Opts), !.
+% Oops!
+install_required(_, LibName, _):-
+  atomic_list_concat(
+    [&#39;Installation of library &#39;,LibName,&#39; failed.&#39;],
+    Msg
+  ),
+  msg_warning(Msg).
+
+
+
+
+
+% HELPERS %
+
+%! append_directories(+Dir1:atom, +Dir2:atom, -Dir3:atom) is det.
+
+append_directories(Dir1, Dir2, Dir3):-
+  atomic_list_concat(Subdirs1, /, Dir1),
+  atomic_list_concat(Subdirs2, /, Dir2),
+  append(Subdirs1, Subdirs2, Subdirs3),
+  atomic_list_concat(Subdirs3, /, Dir3).
+
+
+
+%! clean_meta is det.
+
+clean_meta:-
+  retractall(author/2),
+  retractall(download/1),
+  retractall(home/1),
+  retractall(maintainer/2),
+  retractall(name/1),
+  retractall(packager/2),
+  retractall(requires/1),
+  retractall(title/1),
+  retractall(version/1).
+
+
+
+%! show_help(+OptionSpecification:list(compound)) is det.
+
+show_help(OptSpec):-
+  opt_help(OptSpec, Help),
+  format(user_output, &#39;~a\n&#39;, [Help]),
+  halt.
+
+
+
+%! load_meta(+File:atom) is det.
+
+load_meta(File):-
+  clean_meta,
+  ensure_loaded(File).
+
+
+
+%! msg_success(+Message:atom) is det.
+
+msg_success(X):-
+    ansi_format([bold,fg(green)], &#39;~a~n&#39;, [X]).
+
+
+
+%! msg_warning(+Message:atom) is det.
+
+msg_warning(X):-
+    ansi_format([bold,fg(red)], &#39;~a~n&#39;, [X]).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;125&#34;&gt; 125: 正在比较变动前 e64cc35 和变动后 763a529 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/install b/install
deleted file mode 100755
index 849699b..0000000
--- a/install
+++ /dev/null
@@ -1,218 +0,0 @@
-#!/usr/bin/env swipl
-
-:- module(install, []).
-
-/** &amp;lt;module&amp;gt; Install
-
-Let&#39;s do this!
-
-@author Wouter Beek
-@version 2015/09/23
-*/
-
-:- use_module(library(filesex)).
-:- use_module(library(lists)).
-:- use_module(library(option)).
-:- use_module(library(optparse)).
-:- use_module(library(prolog_pack)).
-:- use_module(library(uri)).
-
-:- dynamic(author/2).
-:- dynamic(download/1).
-:- dynamic(home/1).
-:- dynamic(maintainer/2).
-:- dynamic(name/1).
-:- dynamic(packager/2).
-:- dynamic(requires/1).
-:- dynamic(title/1).
-:- dynamic(version/1).
-
-:- initialization(install).
-
-
-
-
-
-%! install is det.
-
-install:-
-  OptSpec = [
-    [ % Github
-      default(true),
-      help(&#39;Whether Github should be used to install requirements.&#39;),
-      longflags([git,github]),
-      opt(github),
-      type(boolean)
-    ],
-    [ % Help
-      default(false),
-      help(&#39;Display help about the install command.&#39;),
-      longflags([help]),
-      opt(help),
-      shortflags([h]),
-      type(boolean)
-    ],
-    [ % Pack
-      default(true),
-      help(&#39;Whether the Prolog Pack system is used for installing requirements.&#39;),
-      longflags([pack]),
-      opt(pack),
-      type(boolean)
-    ],
-    [ % Parent
-      default(false),
-      help(&#39;Whether existing installations in the parent directory should be taken into account.&#39;),
-      longflags([parent]),
-      opt(parent),
-      type(boolean)
-    ]
-  ],
-  opt_arguments(OptSpec, Opts, _),
-
-  % Process help
-  (option(help(true), Opts) -&amp;gt; show_help(OptSpec) ; install(Opts)).
-
-
-%! install(+Options:list(compound)) is det.
-
-install(Opts):-
-  source_file(install, File),
-  file_directory_name(File, AppDir),
-  install(AppDir, AppDir, Opts),
-  clean_meta,
-  halt.
-
-
-%! install(
-%!   +ApplicationDirectory:atom,
-%!   +LibraryDirectory:atom,
-%!   +Options:list(compound)
-%! ) is det.
-
-install(AppDir, LibDir, Opts):-
-  % The pack information is taken from the library directory.
-  % This allows application requirements to be installed recursively.
-  directory_file_path(LibDir, &#39;pack.pl&#39;, Info),
-  access_file(Info, read),
-  load_meta(Info),
-
-  % Set this library&#39;s search path.
-  name(Name),
-  assert(user:file_search_path(Name, LibDir)),
-
-  % Pull in the required libraries.
-  forall(requires(LibName), install_required(AppDir, LibName, Opts)), !.
-install(_, _, _):-
-  msg_warning(&#39;Installation failed.&#39;).
-
-
-%! install_required(
-%!   +ApplicationDirectory:atom,
-%!   +LibName:atom,
-%!   +Options:list(compound)
-%! ) is det.
-
-% Developer&#39;s delight: library already available from parent directory.
-install_required(AppDir, LibName, Opts):-
-  option(parent(true), Opts),
-
-  file_directory_name(AppDir, ParentDir),
-  append_directories(ParentDir, LibName, LibDir),
-  exists_directory(LibDir), !,
-
-  % Print message.
-  atomic_list_concat([&#39;Library &#39;,LibName,&#39; already installed.&#39;], Msg),
-  msg_success(Msg).
-% Install through the Prolog Pack system.
-install_required(_, LibName, Opts):-
-  option(pack(true), Opts),
-
-  prolog_pack:query_pack_server(search(LibName), Result,[]),
-  Result = true([pack(LibName,_,_,_,_)]), !,
-  pack_install(LibName).
-% Install through Github.
-install_required(AppDir, LibName, Opts):-
-  option(github(true), Opts),
-
-  % Remove the old version of the library.
-  append_directories(AppDir, LibName, LibDir),
-  (exists_directory(LibDir) -&amp;gt; delete_directory_and_contents(LibDir) ; true),
-
-  % Git clone the new version of the library.
-  atomic_list_concat([&#39;&#39;,wouterbeek,LibName], /, Path),
-  uri_components(Iri, uri_components(https,&#39;github.com&#39;,Path,_,_)),
-  prolog_pack:run_process(path(git), [clone,Iri,LibDir], []),
-
-  % Print message.
-  atomic_list_concat([&#39;Library &#39;,LibName,&#39; was installed.&#39;], Msg),
-  msg_success(Msg),
-  
-  % Recurse
-  install(AppDir, LibDir, Opts), !.
-% Oops!
-install_required(_, LibName, _):-
-  atomic_list_concat(
-    [&#39;Installation of library &#39;,LibName,&#39; failed.&#39;],
-    Msg
-  ),
-  msg_warning(Msg).
-
-
-
-
-
-% HELPERS %
-
-%! append_directories(+Dir1:atom, +Dir2:atom, -Dir3:atom) is det.
-
-append_directories(Dir1, Dir2, Dir3):-
-  atomic_list_concat(Subdirs1, /, Dir1),
-  atomic_list_concat(Subdirs2, /, Dir2),
-  append(Subdirs1, Subdirs2, Subdirs3),
-  atomic_list_concat(Subdirs3, /, Dir3).
-
-
-
-%! clean_meta is det.
-
-clean_meta:-
-  retractall(author/2),
-  retractall(download/1),
-  retractall(home/1),
-  retractall(maintainer/2),
-  retractall(name/1),
-  retractall(packager/2),
-  retractall(requires/1),
-  retractall(title/1),
-  retractall(version/1).
-
-
-
-%! show_help(+OptionSpecification:list(compound)) is det.
-
-show_help(OptSpec):-
-  opt_help(OptSpec, Help),
-  format(user_output, &#39;~a\n&#39;, [Help]),
-  halt.
-
-
-
-%! load_meta(+File:atom) is det.
-
-load_meta(File):-
-  clean_meta,
-  ensure_loaded(File).
-
-
-
-%! msg_success(+Message:atom) is det.
-
-msg_success(X):-
-    ansi_format([bold,fg(green)], &#39;~a~n&#39;, [X]).
-
-
-
-%! msg_warning(+Message:atom) is det.
-
-msg_warning(X):-
-    ansi_format([bold,fg(red)], &#39;~a~n&#39;, [X]).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index fa00670..99d6059 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -121,9 +121,9 @@ assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
 % Downloads the table describing GraphViz attributes from `graphviz.org`.
 
 gv_attrs_download:-
-  verbose_call(
-    &#39;updating GraphViz attributes table&#39;,
+  verbose(
     gv_attrs_download0
+    &amp;quot;updating GraphViz attributes table&amp;quot;,
   ).
 
 gv_attrs_download0:-
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 57c7f90..2c56713 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -88,9 +88,9 @@ wc_weight(Float) --&amp;gt;
 %! gv_color_download is det.
 
 gv_color_download:-
-  verbose_call(
-    &#39;updating the GraphViz color table&#39;,
-    gv_color_download0
+  verbose(
+    gv_color_download0,
+    &#39;updating the GraphViz color table&#39;
   ).
 
 gv_color_download0:-
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index 577a33a..7fd5a58 100644
--- a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -10,7 +10,7 @@
 /** &amp;lt;module&amp;gt; GraphViz file
 
 @author Wouter Beek
-@version 2015/07
+@version 2015/07, 2015/10
 */
 
 :- use_module(library(code_ext)).
@@ -18,18 +18,13 @@
 :- use_module(library(gv/gv_graph)).
 :- use_module(library(option)).
 :- use_module(library(process)).
-
-:- dynamic(user:prolog_file_type/2).
-:- multifile(user:prolog_file_type/2).
-
-user:prolog_file_type(dot, dot).
-user:prolog_file_type(pdf, pdf).
+:- use_module(library(string_ext)).
 
 :- predicate_options(gv_export/3, 3, [
      pass_to(file_to_gv/3, 3)
    ]).
 :- predicate_options(file_to_gv/3, 3, [
-     method(+atom),
+     method(+oneof([circo,dot,fdp,neato,osage,sfdp,twopi])),
      output(+atom)
    ]).
 
@@ -37,39 +32,38 @@ user:prolog_file_type(pdf, pdf).
 
 
 
-%! gv_export(
-%!   +ExportGraph:compound,
-%!   +OutputFile:atom,
-%!   +Options:list(nvpair)
-%! ) is det.
+%! gv_export(+ExportGraph:compound, +File:atom, +Options:list(compound)) is det.
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
-%   - `method(+Method:atom)`
+%   * method(+oneof([circo,dot,fdp,neato,osage,sfdp,twopi])
 %     The algorithm used by GraphViz for positioning the tree nodes.
-%     Either =dot= (default) or =sfdp=.
-%   - `output(+FileType:atom)`
+%     Default is `dot&#39;.
+%     For possible values see gv_method/1.
+%   * output(+atom)`
 %     The file type of the generated GraphViz file.
-%     Default: `pdf`.
+%     Default is `pdf`.
+%     For possible values see gv_output_type/1.
 
-gv_export(ExportGraph, OutputFile, Options):-
-  once(phrase(gv_graph(ExportGraph), Codes)),
+gv_export(ExportG, File, Opts):-
+  once(phrase(gv_graph(ExportG), Cs)),
 
   % Be thread-safe.
   thread_self(Id),
-  atomic_list_concat([gv_file,Id], &#39;_&#39;, ThreadName),
-  absolute_file_name(ThreadName, TmpFile, [access(write),file_type(dot)]),
+  string_list_concat([&amp;quot;gv_file&amp;quot;,Id], &amp;quot;_&amp;quot;, ThreadName),
+  absolute_file_name(ThreadName, TmpFile, [access(write),extensions([dot])]),
   setup_call_cleanup(
     open(TmpFile, write, Write, [encoding(utf8)]),
-    with_output_to(Write, put_codes(Codes)),
+    with_output_to(Write, put_codes(Cs)),
     close(Write)
   ),
-  file_to_gv(TmpFile, OutputFile, Options).
+  file_to_gv(TmpFile, File, Opts).
+
 
 %! file_to_gv(
 %!   +InputFile:atom,
 %!   +OutputFile:atom,
-%!   +Options:list(nvpair)
+%!   +Options:list(compound)
 %! ) is det.
 % Converts a GraphViz DOT file to an image file, using a specific
 % visualization method.
@@ -98,8 +92,8 @@ file_to_gv(InputFile, OutputFile, Opts):-
   must_be(oneof(OutputTypes), OutputType),
 
   % Run the GraphViz conversion command in the shell.
-  format(atom(OutputTypeFlag), &#39;-T~a&#39;, [OutputType]),
-  format(atom(OutputFileFlag), &#39;-o~a&#39;, [OutputFile]),
+  format(atom(OutputTypeFlag), &amp;quot;-T~a&amp;quot;, [OutputType]),
+  format(atom(OutputFileFlag), &amp;quot;-o~a&amp;quot;, [OutputFile]),
   process_create(
     path(Method),
     [OutputTypeFlag,file(InputFile),OutputFileFlag],
@@ -108,6 +102,8 @@ file_to_gv(InputFile, OutputFile, Opts):-
 
 
 
+
+
 % HELPERS %
 
 gv_method(circo).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;126&#34;&gt; 126: 正在比较变动前 763a529 和变动后 d962f81 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/install b/install
new file mode 100755
index 0000000..849699b
--- /dev/null
+++ b/install
@@ -0,0 +1,218 @@
+#!/usr/bin/env swipl
+
+:- module(install, []).
+
+/** &amp;lt;module&amp;gt; Install
+
+Let&#39;s do this!
+
+@author Wouter Beek
+@version 2015/09/23
+*/
+
+:- use_module(library(filesex)).
+:- use_module(library(lists)).
+:- use_module(library(option)).
+:- use_module(library(optparse)).
+:- use_module(library(prolog_pack)).
+:- use_module(library(uri)).
+
+:- dynamic(author/2).
+:- dynamic(download/1).
+:- dynamic(home/1).
+:- dynamic(maintainer/2).
+:- dynamic(name/1).
+:- dynamic(packager/2).
+:- dynamic(requires/1).
+:- dynamic(title/1).
+:- dynamic(version/1).
+
+:- initialization(install).
+
+
+
+
+
+%! install is det.
+
+install:-
+  OptSpec = [
+    [ % Github
+      default(true),
+      help(&#39;Whether Github should be used to install requirements.&#39;),
+      longflags([git,github]),
+      opt(github),
+      type(boolean)
+    ],
+    [ % Help
+      default(false),
+      help(&#39;Display help about the install command.&#39;),
+      longflags([help]),
+      opt(help),
+      shortflags([h]),
+      type(boolean)
+    ],
+    [ % Pack
+      default(true),
+      help(&#39;Whether the Prolog Pack system is used for installing requirements.&#39;),
+      longflags([pack]),
+      opt(pack),
+      type(boolean)
+    ],
+    [ % Parent
+      default(false),
+      help(&#39;Whether existing installations in the parent directory should be taken into account.&#39;),
+      longflags([parent]),
+      opt(parent),
+      type(boolean)
+    ]
+  ],
+  opt_arguments(OptSpec, Opts, _),
+
+  % Process help
+  (option(help(true), Opts) -&amp;gt; show_help(OptSpec) ; install(Opts)).
+
+
+%! install(+Options:list(compound)) is det.
+
+install(Opts):-
+  source_file(install, File),
+  file_directory_name(File, AppDir),
+  install(AppDir, AppDir, Opts),
+  clean_meta,
+  halt.
+
+
+%! install(
+%!   +ApplicationDirectory:atom,
+%!   +LibraryDirectory:atom,
+%!   +Options:list(compound)
+%! ) is det.
+
+install(AppDir, LibDir, Opts):-
+  % The pack information is taken from the library directory.
+  % This allows application requirements to be installed recursively.
+  directory_file_path(LibDir, &#39;pack.pl&#39;, Info),
+  access_file(Info, read),
+  load_meta(Info),
+
+  % Set this library&#39;s search path.
+  name(Name),
+  assert(user:file_search_path(Name, LibDir)),
+
+  % Pull in the required libraries.
+  forall(requires(LibName), install_required(AppDir, LibName, Opts)), !.
+install(_, _, _):-
+  msg_warning(&#39;Installation failed.&#39;).
+
+
+%! install_required(
+%!   +ApplicationDirectory:atom,
+%!   +LibName:atom,
+%!   +Options:list(compound)
+%! ) is det.
+
+% Developer&#39;s delight: library already available from parent directory.
+install_required(AppDir, LibName, Opts):-
+  option(parent(true), Opts),
+
+  file_directory_name(AppDir, ParentDir),
+  append_directories(ParentDir, LibName, LibDir),
+  exists_directory(LibDir), !,
+
+  % Print message.
+  atomic_list_concat([&#39;Library &#39;,LibName,&#39; already installed.&#39;], Msg),
+  msg_success(Msg).
+% Install through the Prolog Pack system.
+install_required(_, LibName, Opts):-
+  option(pack(true), Opts),
+
+  prolog_pack:query_pack_server(search(LibName), Result,[]),
+  Result = true([pack(LibName,_,_,_,_)]), !,
+  pack_install(LibName).
+% Install through Github.
+install_required(AppDir, LibName, Opts):-
+  option(github(true), Opts),
+
+  % Remove the old version of the library.
+  append_directories(AppDir, LibName, LibDir),
+  (exists_directory(LibDir) -&amp;gt; delete_directory_and_contents(LibDir) ; true),
+
+  % Git clone the new version of the library.
+  atomic_list_concat([&#39;&#39;,wouterbeek,LibName], /, Path),
+  uri_components(Iri, uri_components(https,&#39;github.com&#39;,Path,_,_)),
+  prolog_pack:run_process(path(git), [clone,Iri,LibDir], []),
+
+  % Print message.
+  atomic_list_concat([&#39;Library &#39;,LibName,&#39; was installed.&#39;], Msg),
+  msg_success(Msg),
+  
+  % Recurse
+  install(AppDir, LibDir, Opts), !.
+% Oops!
+install_required(_, LibName, _):-
+  atomic_list_concat(
+    [&#39;Installation of library &#39;,LibName,&#39; failed.&#39;],
+    Msg
+  ),
+  msg_warning(Msg).
+
+
+
+
+
+% HELPERS %
+
+%! append_directories(+Dir1:atom, +Dir2:atom, -Dir3:atom) is det.
+
+append_directories(Dir1, Dir2, Dir3):-
+  atomic_list_concat(Subdirs1, /, Dir1),
+  atomic_list_concat(Subdirs2, /, Dir2),
+  append(Subdirs1, Subdirs2, Subdirs3),
+  atomic_list_concat(Subdirs3, /, Dir3).
+
+
+
+%! clean_meta is det.
+
+clean_meta:-
+  retractall(author/2),
+  retractall(download/1),
+  retractall(home/1),
+  retractall(maintainer/2),
+  retractall(name/1),
+  retractall(packager/2),
+  retractall(requires/1),
+  retractall(title/1),
+  retractall(version/1).
+
+
+
+%! show_help(+OptionSpecification:list(compound)) is det.
+
+show_help(OptSpec):-
+  opt_help(OptSpec, Help),
+  format(user_output, &#39;~a\n&#39;, [Help]),
+  halt.
+
+
+
+%! load_meta(+File:atom) is det.
+
+load_meta(File):-
+  clean_meta,
+  ensure_loaded(File).
+
+
+
+%! msg_success(+Message:atom) is det.
+
+msg_success(X):-
+    ansi_format([bold,fg(green)], &#39;~a~n&#39;, [X]).
+
+
+
+%! msg_warning(+Message:atom) is det.
+
+msg_warning(X):-
+    ansi_format([bold,fg(red)], &#39;~a~n&#39;, [X]).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;127&#34;&gt; 127: 正在比较变动前 d962f81 和变动后 63a5cd7 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/install b/install
deleted file mode 100755
index 849699b..0000000
--- a/install
+++ /dev/null
@@ -1,218 +0,0 @@
-#!/usr/bin/env swipl
-
-:- module(install, []).
-
-/** &amp;lt;module&amp;gt; Install
-
-Let&#39;s do this!
-
-@author Wouter Beek
-@version 2015/09/23
-*/
-
-:- use_module(library(filesex)).
-:- use_module(library(lists)).
-:- use_module(library(option)).
-:- use_module(library(optparse)).
-:- use_module(library(prolog_pack)).
-:- use_module(library(uri)).
-
-:- dynamic(author/2).
-:- dynamic(download/1).
-:- dynamic(home/1).
-:- dynamic(maintainer/2).
-:- dynamic(name/1).
-:- dynamic(packager/2).
-:- dynamic(requires/1).
-:- dynamic(title/1).
-:- dynamic(version/1).
-
-:- initialization(install).
-
-
-
-
-
-%! install is det.
-
-install:-
-  OptSpec = [
-    [ % Github
-      default(true),
-      help(&#39;Whether Github should be used to install requirements.&#39;),
-      longflags([git,github]),
-      opt(github),
-      type(boolean)
-    ],
-    [ % Help
-      default(false),
-      help(&#39;Display help about the install command.&#39;),
-      longflags([help]),
-      opt(help),
-      shortflags([h]),
-      type(boolean)
-    ],
-    [ % Pack
-      default(true),
-      help(&#39;Whether the Prolog Pack system is used for installing requirements.&#39;),
-      longflags([pack]),
-      opt(pack),
-      type(boolean)
-    ],
-    [ % Parent
-      default(false),
-      help(&#39;Whether existing installations in the parent directory should be taken into account.&#39;),
-      longflags([parent]),
-      opt(parent),
-      type(boolean)
-    ]
-  ],
-  opt_arguments(OptSpec, Opts, _),
-
-  % Process help
-  (option(help(true), Opts) -&amp;gt; show_help(OptSpec) ; install(Opts)).
-
-
-%! install(+Options:list(compound)) is det.
-
-install(Opts):-
-  source_file(install, File),
-  file_directory_name(File, AppDir),
-  install(AppDir, AppDir, Opts),
-  clean_meta,
-  halt.
-
-
-%! install(
-%!   +ApplicationDirectory:atom,
-%!   +LibraryDirectory:atom,
-%!   +Options:list(compound)
-%! ) is det.
-
-install(AppDir, LibDir, Opts):-
-  % The pack information is taken from the library directory.
-  % This allows application requirements to be installed recursively.
-  directory_file_path(LibDir, &#39;pack.pl&#39;, Info),
-  access_file(Info, read),
-  load_meta(Info),
-
-  % Set this library&#39;s search path.
-  name(Name),
-  assert(user:file_search_path(Name, LibDir)),
-
-  % Pull in the required libraries.
-  forall(requires(LibName), install_required(AppDir, LibName, Opts)), !.
-install(_, _, _):-
-  msg_warning(&#39;Installation failed.&#39;).
-
-
-%! install_required(
-%!   +ApplicationDirectory:atom,
-%!   +LibName:atom,
-%!   +Options:list(compound)
-%! ) is det.
-
-% Developer&#39;s delight: library already available from parent directory.
-install_required(AppDir, LibName, Opts):-
-  option(parent(true), Opts),
-
-  file_directory_name(AppDir, ParentDir),
-  append_directories(ParentDir, LibName, LibDir),
-  exists_directory(LibDir), !,
-
-  % Print message.
-  atomic_list_concat([&#39;Library &#39;,LibName,&#39; already installed.&#39;], Msg),
-  msg_success(Msg).
-% Install through the Prolog Pack system.
-install_required(_, LibName, Opts):-
-  option(pack(true), Opts),
-
-  prolog_pack:query_pack_server(search(LibName), Result,[]),
-  Result = true([pack(LibName,_,_,_,_)]), !,
-  pack_install(LibName).
-% Install through Github.
-install_required(AppDir, LibName, Opts):-
-  option(github(true), Opts),
-
-  % Remove the old version of the library.
-  append_directories(AppDir, LibName, LibDir),
-  (exists_directory(LibDir) -&amp;gt; delete_directory_and_contents(LibDir) ; true),
-
-  % Git clone the new version of the library.
-  atomic_list_concat([&#39;&#39;,wouterbeek,LibName], /, Path),
-  uri_components(Iri, uri_components(https,&#39;github.com&#39;,Path,_,_)),
-  prolog_pack:run_process(path(git), [clone,Iri,LibDir], []),
-
-  % Print message.
-  atomic_list_concat([&#39;Library &#39;,LibName,&#39; was installed.&#39;], Msg),
-  msg_success(Msg),
-  
-  % Recurse
-  install(AppDir, LibDir, Opts), !.
-% Oops!
-install_required(_, LibName, _):-
-  atomic_list_concat(
-    [&#39;Installation of library &#39;,LibName,&#39; failed.&#39;],
-    Msg
-  ),
-  msg_warning(Msg).
-
-
-
-
-
-% HELPERS %
-
-%! append_directories(+Dir1:atom, +Dir2:atom, -Dir3:atom) is det.
-
-append_directories(Dir1, Dir2, Dir3):-
-  atomic_list_concat(Subdirs1, /, Dir1),
-  atomic_list_concat(Subdirs2, /, Dir2),
-  append(Subdirs1, Subdirs2, Subdirs3),
-  atomic_list_concat(Subdirs3, /, Dir3).
-
-
-
-%! clean_meta is det.
-
-clean_meta:-
-  retractall(author/2),
-  retractall(download/1),
-  retractall(home/1),
-  retractall(maintainer/2),
-  retractall(name/1),
-  retractall(packager/2),
-  retractall(requires/1),
-  retractall(title/1),
-  retractall(version/1).
-
-
-
-%! show_help(+OptionSpecification:list(compound)) is det.
-
-show_help(OptSpec):-
-  opt_help(OptSpec, Help),
-  format(user_output, &#39;~a\n&#39;, [Help]),
-  halt.
-
-
-
-%! load_meta(+File:atom) is det.
-
-load_meta(File):-
-  clean_meta,
-  ensure_loaded(File).
-
-
-
-%! msg_success(+Message:atom) is det.
-
-msg_success(X):-
-    ansi_format([bold,fg(green)], &#39;~a~n&#39;, [X]).
-
-
-
-%! msg_warning(+Message:atom) is det.
-
-msg_warning(X):-
-    ansi_format([bold,fg(red)], &#39;~a~n&#39;, [X]).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;128&#34;&gt; 128: 正在比较变动前 63a5cd7 和变动后 ce95c3c &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 99d6059..1fd4a18 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -9,17 +9,18 @@
 /** &amp;lt;module&amp;gt; GraphViz attributes
 
 @author Wouter Beek
-@version 2015/07-2015/08
+@version 2015/07-2015/08, 2015/10
 */
 
 :- use_module(library(apply)).
-:- use_module(library(deb_ext)).
+:- use_module(library(debug_ext)).
 :- use_module(library(dcg/basics)).
 :- use_module(library(dcg/dcg_call)).
 :- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
 :- use_module(library(http/http_download)).
 :- use_module(library(lists)).
+:- use_module(library(msg_ext)).
 :- use_module(library(os/file_ext)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
@@ -35,15 +36,15 @@
 %! ) is nondet.
 
 :- persistent(
-  gv_attr(
-    name:atom,
-    used_by:list(oneof([cluster,edge,graph,node,subgraph])),
-    types:list(atom),
-    default,
-    minimum,
-    notes:atom
-  )
-).
+     gv_attr(
+       name:atom,
+       used_by:list(oneof([cluster,edge,graph,node,subgraph])),
+       types:list(atom),
+       default,
+       minimum,
+       notes:atom
+     )
+   ).
 
 :- initialization(gv_attrs_init).
 
@@ -122,8 +123,8 @@ assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
 
 gv_attrs_download:-
   verbose(
-    gv_attrs_download0
-    &amp;quot;updating GraphViz attributes table&amp;quot;,
+    gv_attrs_download0,
+    &amp;quot;updating GraphViz attributes table&amp;quot;
   ).
 
 gv_attrs_download0:-
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 2c56713..fa79bea 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -13,16 +13,17 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2015/08
+@version 2015/08, 2015/10
 */
 
 :- use_module(library(apply)).
-:- use_module(library(deb_ext)).
+:- use_module(library(debug_ext)).
 :- use_module(library(dcg/basics)).
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(http/http_download)).
 :- use_module(library(lists)).
+:- use_module(library(msg_ext)).
 :- use_module(library(os/file_ext)).
 :- use_module(library(persistency)).
 :- use_module(library(xpath)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;129&#34;&gt; 129: 正在比较变动前 ce95c3c 和变动后 44cd5a6 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index b0dbd69..5ab08a6 100644
--- a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -202,11 +202,14 @@ doubleList(L) --&amp;gt;
 
 
 
-%! escString(+String:atom)// .
+%! escString(+String:or([atom,string]))// .
 % @tbd Support for context-dependent replacements.
 
 escString(S1) --&amp;gt;
-  {atom_phrase(escape_double_quotes, S1, S2)},
+  {(  string(S1)
+  -&amp;gt;  string_phrase(escape_double_quotes, S1, S2)
+  ;   atom_phrase(escape_double_quotes, S1, S2)
+  )},
   quoted(atom(S2)).
 
 escape_double_quotes, [92,34] --&amp;gt;
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 033d0b9..3aec4e6 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -26,7 +26,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/dot-language
-@version 2015/07-2015/08
+@version 2015/07-2015/08, 2015/10
 */
 
 :- use_module(library(apply)).
@@ -38,6 +38,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 :- use_module(library(dcg/dcg_quoted)).
 :- use_module(library(gv/gv_attrs)).
 :- use_module(library(gv/gv_html)).
+:- use_module(library(error)).
 :- use_module(library(lists)).
 :- use_module(library(ordsets)).
 
@@ -82,8 +83,9 @@ gv_edge_statement(I, Dir, edge(From,To,Attrs)) --&amp;gt;
 % @arg Directed Whether an edge is directed (operator `-&amp;gt;`) or
 %      undirected (operator `--`).
 
-gv_edge_operator(false) --&amp;gt; !, &amp;quot;--&amp;quot;.
-gv_edge_operator(true) --&amp;gt; &amp;quot;-&amp;gt;&amp;quot;.
+gv_edge_operator(Dir) --&amp;gt;
+  {must_be(boolean, Dir)},
+  ({Dir == false} -&amp;gt; &amp;quot;--&amp;quot; ; {Dir == true} -&amp;gt; &amp;quot;-&amp;gt;&amp;quot;).
 
 
 
@@ -113,9 +115,9 @@ gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(edge) --&amp;gt; &amp;quot;edge&amp;quot;.
-gv_kind(graph) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_kind(node) --&amp;gt; &amp;quot;node&amp;quot;.
+gv_kind(Kind) --&amp;gt;
+  {must_be(oneof([edge,graph,node]), Kind)},
+  atom(Kind).
 
 
 
@@ -142,8 +144,8 @@ gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
   % The rank attribute.
   {NewI is I + 1},
   indent(NewI),
-  gv_attr(subgraph, rank=same),
-  &amp;quot;;\n&amp;quot;,
+  gv_attr(subgraph, rank(same)),
+  &amp;quot;\n&amp;quot;,
 
   % Vertice statements.
   *(
@@ -170,10 +172,8 @@ gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
 gv_attrs(Kind, L) --&amp;gt;
   bracketed(square, *(gv_attr(Kind), L, [])).
 
-%! gv_attr(
-%!   +Context:oneof([edge,graph,node]),
-%!   +Attribute:nvpair
-%! )// is det.
+
+%! gv_attr(+Context:oneof([edge,graph,node]), +Attribute:compound)// is det.
 % A single GraphViz attribute.
 % We assume that the attribute has already been validated.
 
@@ -276,10 +276,12 @@ gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 %      inside GraphViz node identifiers.
 
 gv_node_id(Id) --&amp;gt;
-  gv_id(Id).
+  gv_id(Id), !.
 %gv_node_id(_) --&amp;gt;
 %  gv_id(_),
 %  gv_port.
+gv_node_id(Id) --&amp;gt;
+  {type_error(gv_node_id, Id)}.
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;130&#34;&gt; 130: 正在比较变动前 44cd5a6 和变动后 c0c5e18 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 507e8ad..b6d367b 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -1,9 +1,9 @@
 :- module(
   build_export_graph,
   [
-    build_export_graph/2, % +Graph:compound
+    build_export_graph/2, % +Graph
                           % -ExportGraph:compound
-    build_export_graph/3 % +Graph:compound
+    build_export_graph/3 % +Graph
                          % -ExportGraph:compound
                          % +Options:list(compound)
   ]
@@ -18,13 +18,13 @@ Support for building GIF representations.
 ## Graph
 
 ```prolog
-graph(Vs:ordset(compound),Ranks,Es:compound,Attributes:list(nvpair))
+graph(Vs:ordset(compound),Ranks,Es:compound,Attributes:list(compound))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;edge&#34;&gt;Edge&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-prolog&#34;&gt;-edge(FromVertexId,ToVertexId,Attributes:list(nvpair))
+edge(FromVertexId,ToVertexId,Attributes:list(compound))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;rank&#34;&gt;Rank&lt;/h3&gt;
&lt;p&gt;@@ -36,7 +36,7 @@ rank(RankVertex:compound,ContentVertices:ordset(compound))&lt;/p&gt;
&lt;h3 id=&#34;vertex&#34;&gt;Vertex&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-prolog&#34;&gt;-vertex(Id,Attributes:list(nvpair))
+vertex(Id,Attributes:list(compound))
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;property-functions&#34;&gt;Property functions&lt;/h1&gt;
&lt;h2 id=&#34;--5110-5112--vertex-coordinates&#34;&gt;@@ -51,10 +51,12 @@ Vertex coordinates:&lt;/h2&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/09
+@version 2015/07, 2015/09-2015/10
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
+:- use_module(library(graph/s/s_graph)).
+:- use_module(library(lambda)).
:- use_module(library(list_ext)).
:- use_module(library(option_ext)).
:- use_module(library(ordsets)).
@@ -112,34 +114,32 @@ is_meta(vertex_uri).&lt;/p&gt;
&lt;p&gt;-%! build_export_graph(+Graph:compound, -ExportGraph:compound) is det.
+%! build_export_graph(+Graph, -ExportGraph:compound) is det.
+% Wrapper around build_export_graph/3.&lt;/p&gt;
&lt;p&gt;build_export_graph(G, ExportG):-
build_export_graph(G, ExportG, []).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;%! build_export_graph(
-%!   +Graph:compound,
+%!   +Graph,
%!   -ExportGraph:compound,
%!   +Options:list(compound)
%! ) is det.
+% Graph is either:
+%   * a coumpound term &lt;code&gt;graph(Vs,Es)&lt;/code&gt;, or
+%   * an unlabeled graph as defined by &lt;code&gt;library(ugraph)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;-build_export_graph(graph(Vs,Es), graph(VTerms,ETerms,GAttrs), Opts1):-
+build_export_graph(G, graph(VTerms,ETerms,GAttrs), Opts1):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;graph_components(G, Vs, Es),
meta_options(is_meta, Opts1, Opts2),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;% V terms.&lt;/li&gt;
&lt;li&gt;maplist(vertex_term0(Vs, Opts2), Vs, VTerms),&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;% Edge terms.&lt;/li&gt;
&lt;li&gt;maplist(edge_term0(Vs, Opts2), Es, ETerms),&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;% Graph attributes.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms),&lt;/li&gt;
&lt;li&gt;maplist(\E^ETerm^edge_term(Vs, E, ETerm, Opts2), Es, ETerms),
graph_attributes(GAttrs, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-vertex_term0(Vs, Opts, V, VTerm):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;vertex_term(Vs, V, VTerm, Opts).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-edge_term0(Vs, Opts, E, ETerm):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;edge_term(Vs, E, ETerm, Opts).
+graph_components(graph(Vs,Es), Vs, Es):- !.
+graph_components(G, Vs, Es):-&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;s_graph_components(G, Vs, Es).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@@ -178,12 +178,9 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
% Id.
(   option(edge_id(IdFunction), Opts)
-&amp;gt;  call(IdFunction, E, FromId, ToId)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;;     (   E = edge(FromV,_,ToV)&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   -&amp;gt;  true
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   ;   E = edge(FromV,ToV)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   ),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   nth0chk(FromId, Vs, FromV),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   nth0chk(ToId, Vs, ToV)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;;   edge_components(E, FromV, ToV),&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; nth0chk(FromId, Vs, FromV),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; nth0chk(ToId, Vs, ToV)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;),&lt;/p&gt;
&lt;p&gt;% Label.
@@ -215,7 +212,7 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;%! graph_attributes(
-%!   -GraphAttributes:list(nvpair),
+%!   -GraphAttributes:list(compound),
%!   +Options:list(compound)
%! ) is det.
% The following options are supported:
@@ -358,7 +355,15 @@ vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-&lt;/p&gt;
&lt;p&gt;% HELPERS %&lt;/p&gt;
&lt;p&gt;-%! merge_options(+FromOptions:list(nvpair), -ToOptions:list(nvpair)) is det.
+%! edge_components(+Edge:compound, -FromV, -ToV) is det.
+
+edge_components(edge(FromV,_,ToV), FromV, ToV):- !.
+edge_components(edge(FromV,ToV), FromV, ToV):- !.
+edge_components(FromV-ToV, FromV, ToV):- !.
+
+
+
+%! merge_options(+FromOptions:list(compound), -ToOptions:list(compound)) is det.&lt;/p&gt;
&lt;p&gt;merge_options([], []).
% Skip uninstantiated values.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; 
&amp;lt;h2 id=&amp;quot;131&amp;quot;&amp;gt; 131: 正在比较变动前 c0c5e18 和变动后 603344f &amp;lt;/h2&amp;gt;
[back to content](#compare)
 
``` diff
 
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
new file mode 100644
index 0000000..190b988
--- /dev/null
+++ b/data/gv_attrs_scrape.pl
@@ -0,0 +1,124 @@
+:- module(
+  gv_attrs_scrape,
+  [
+    gv_attrs_scrape/1 % +File:atom
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz: Scrape attributes
+
+Writes compound terms of the following form to file:
+
+```prolog
+gv_attr(
+  ?Name:atom,
+  ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
+  ?Types:list(atom),
+  ?Default,
+  ?Minimum,
+  ?Notes:atom
+) is nondet.
+```
+
+@author Wouter Beek
+@version 2015/10
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(dcg/basics), except([string//1])).
+:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(gv/gv_attr_type)).
+:- use_module(library(http/http_download)).
+:- use_module(library(iostream)).
+:- use_module(library(lists)).
+:- use_module(library(msg_ext)).
+:- use_module(library(pl/pl_term)).
+:- use_module(library(xpath)).
+:- use_module(library(xpath/xpath_table)).
+
+
+
+
+
+%! gv_attrs_scrape(+File:atom) is det.
+
+gv_attrs_scrape(File):-
+  setup_call_cleanup(
+    open_any(File, write, Write, Close, []),
+    verbose(
+      gv_attrs_download(Write),
+      &amp;quot;Updating the GraphViz attributes table.&amp;quot;
+    ),
+    close_any(Close)
+  ).
+
+
+gv_attrs_download(Write):-
+  gv_attrs_iri(Iri),
+  html_download(Iri, Dom),
+  xpath_chk(Dom, //table(@align=lower_case(center)), TableDom),
+  xpath_table(TableDom, _, Rows),
+  maplist(write_attr_row(Write), Rows).
+
+
+write_attr_row(Write, [Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
+  atom_phrase(translate_usedby(UsedBy2), UsedBy1),
+  once(atom_phrase(translate_type(Types2), Types1)),
+  sort(UsedBy2, UsedBy3),
+  translate_default(Default1, Default2),
+  with_output_to(
+    Write,
+    write_fact(gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes))
+  ).
+
+gv_attrs_iri(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
+
+
+
+
+
+% HELPERS %
+
+%! translate_default(+Default1:atom, -Default2:atom) is det.
+
+% The empty string is represented by the empty atom.
+translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
+% The absence of a default value is represented by an uninstantiated variable.
+translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
+translate_default(Default, Default).
+
+
+
+%! translate_type(-Types:list(atom))// is det.
+
+translate_type([H|T]) --&amp;gt;
+  gv_attr_type(H),
+  whites,
+  translate_type(T).
+translate_type([H]) --&amp;gt;
+  gv_attr_type(H).
+translate_type([]) --&amp;gt; &amp;quot;&amp;quot;.
+
+
+
+%! translated_usedby(
+%!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
+%! )// is det.
+
+translate_usedby([cluster|T]) --&amp;gt;
+  &amp;quot;C&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([edge|T]) --&amp;gt;
+  &amp;quot;E&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([graph|T]) --&amp;gt;
+  &amp;quot;G&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([node|T]) --&amp;gt;
+  &amp;quot;N&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([subgraph|T]) --&amp;gt;
+  &amp;quot;S&amp;quot;, !,
+  translate_usedby(T).
+translate_usedby([]) --&amp;gt;
+  &amp;quot;&amp;quot;.
diff --git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
new file mode 100644
index 0000000..3ac5d44
--- /dev/null
+++ b/data/gv_color_scrape.pl
@@ -0,0 +1,56 @@
+:- module(
+  gv_color_scrape,
+  [
+    gv_color_scrape/1 % +File:atom
+  ]
+).
+
+/** &amp;lt;module&amp;gt; GraphViz: Scrape colors
+
+@author Wouter Beek
+@version 2015/10
+*/
+
+:- use_module(library(apply)).
+:- use_module(library(http/http_download)).
+:- use_module(library(iostream)).
+:- use_module(library(lists)).
+:- use_module(library(msg_ext)).
+:- use_module(library(pl/pl_term)).
+:- use_module(library(xpath)).
+:- use_module(library(xpath/xpath_table)).
+
+
+
+
+
+%! gv_color_scrape(+File:atom) is det.
+
+gv_color_scrape(File):-
+  setup_call_cleanup(
+    open_any(File, write, Write, Close, []),
+    verbose(
+      gv_color_download(Write),
+      &amp;quot;Updating the GraphViz color table.&amp;quot;
+    ),
+    close_any(Close)
+  ).
+
+
+gv_color_download(Write):-
+  gv_color_iri(Iri),
+  html_download(Iri, Dom),
+  xpath_chk(Dom, //table(1), TableDom1),
+  xpath_chk(Dom, //table(2), TableDom2),
+  maplist(write_color_table(Write), [x11,svg], [TableDom1,TableDom2]).
+
+
+write_color_table(Write, Colorscheme, TableDom):-
+  xpath_table(TableDom, _, Rows),
+  append(Rows, Cells),
+  forall(
+    member(Cell, Cells),
+    with_output_to(Write, write_fact(gv_color(Colorscheme, Cell)))
+  ).
+
+gv_color_iri(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
diff --git a/gv_attrs.log b/gv_attrs.log
deleted file mode 100644
index a9c6010..0000000
--- a/gv_attrs.log
+++ /dev/null
@@ -1,169 +0,0 @@
-assert(gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;)).
-assert(gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;)).
-assert(gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(&#39;_background&#39;,[graph],[string],_,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;)).
-assert(gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(bgcolor,[cluster,graph],[color,colorList],_,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;)).
-assert(gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
-assert(gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
-assert(gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
-assert(gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
-assert(gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgetarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
-assert(gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
-assert(gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;)).
-assert(gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(inputscale,[graph],[double],_,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;)).
-assert(gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
-assert(gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labeltarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;)).
-assert(gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;)).
-assert(gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;)).
-assert(gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(&#39;nslimit nslimit1&#39;,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;)).
-assert(gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;)).
-assert(gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;)).
-assert(gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;)).
-assert(gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
-assert(gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;)).
-assert(gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
-assert(gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
-assert(gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(target,[cluster,edge,graph,node],[escString,string],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;)).
-assert(gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;)).
-assert(gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;)).
-assert(gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;)).
-assert(gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;)).
-assert(gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;)).
diff --git a/gv_color.log b/gv_color.log
deleted file mode 100644
index 23d6cdf..0000000
--- a/gv_color.log
+++ /dev/null
@@ -1,802 +0,0 @@
-assert(gv_color(x11,aliceblue)).
-assert(gv_color(x11,antiquewhite)).
-assert(gv_color(x11,antiquewhite1)).
-assert(gv_color(x11,antiquewhite2)).
-assert(gv_color(x11,antiquewhite3)).
-assert(gv_color(x11,antiquewhite4)).
-assert(gv_color(x11,aquamarine)).
-assert(gv_color(x11,aquamarine1)).
-assert(gv_color(x11,aquamarine2)).
-assert(gv_color(x11,aquamarine3)).
-assert(gv_color(x11,aquamarine4)).
-assert(gv_color(x11,azure)).
-assert(gv_color(x11,azure1)).
-assert(gv_color(x11,azure2)).
-assert(gv_color(x11,azure3)).
-assert(gv_color(x11,azure4)).
-assert(gv_color(x11,beige)).
-assert(gv_color(x11,bisque)).
-assert(gv_color(x11,bisque1)).
-assert(gv_color(x11,bisque2)).
-assert(gv_color(x11,bisque3)).
-assert(gv_color(x11,bisque4)).
-assert(gv_color(x11,black)).
-assert(gv_color(x11,blanchedalmond)).
-assert(gv_color(x11,blue)).
-assert(gv_color(x11,blue1)).
-assert(gv_color(x11,blue2)).
-assert(gv_color(x11,blue3)).
-assert(gv_color(x11,blue4)).
-assert(gv_color(x11,blueviolet)).
-assert(gv_color(x11,brown)).
-assert(gv_color(x11,brown1)).
-assert(gv_color(x11,brown2)).
-assert(gv_color(x11,brown3)).
-assert(gv_color(x11,brown4)).
-assert(gv_color(x11,burlywood)).
-assert(gv_color(x11,burlywood1)).
-assert(gv_color(x11,burlywood2)).
-assert(gv_color(x11,burlywood3)).
-assert(gv_color(x11,burlywood4)).
-assert(gv_color(x11,cadetblue)).
-assert(gv_color(x11,cadetblue1)).
-assert(gv_color(x11,cadetblue2)).
-assert(gv_color(x11,cadetblue3)).
-assert(gv_color(x11,cadetblue4)).
-assert(gv_color(x11,chartreuse)).
-assert(gv_color(x11,chartreuse1)).
-assert(gv_color(x11,chartreuse2)).
-assert(gv_color(x11,chartreuse3)).
-assert(gv_color(x11,chartreuse4)).
-assert(gv_color(x11,chocolate)).
-assert(gv_color(x11,chocolate1)).
-assert(gv_color(x11,chocolate2)).
-assert(gv_color(x11,chocolate3)).
-assert(gv_color(x11,chocolate4)).
-assert(gv_color(x11,coral)).
-assert(gv_color(x11,coral1)).
-assert(gv_color(x11,coral2)).
-assert(gv_color(x11,coral3)).
-assert(gv_color(x11,coral4)).
-assert(gv_color(x11,cornflowerblue)).
-assert(gv_color(x11,cornsilk)).
-assert(gv_color(x11,cornsilk1)).
-assert(gv_color(x11,cornsilk2)).
-assert(gv_color(x11,cornsilk3)).
-assert(gv_color(x11,cornsilk4)).
-assert(gv_color(x11,crimson)).
-assert(gv_color(x11,cyan)).
-assert(gv_color(x11,cyan1)).
-assert(gv_color(x11,cyan2)).
-assert(gv_color(x11,cyan3)).
-assert(gv_color(x11,cyan4)).
-assert(gv_color(x11,darkgoldenrod)).
-assert(gv_color(x11,darkgoldenrod1)).
-assert(gv_color(x11,darkgoldenrod2)).
-assert(gv_color(x11,darkgoldenrod3)).
-assert(gv_color(x11,darkgoldenrod4)).
-assert(gv_color(x11,darkgreen)).
-assert(gv_color(x11,darkkhaki)).
-assert(gv_color(x11,darkolivegreen)).
-assert(gv_color(x11,darkolivegreen1)).
-assert(gv_color(x11,darkolivegreen2)).
-assert(gv_color(x11,darkolivegreen3)).
-assert(gv_color(x11,darkolivegreen4)).
-assert(gv_color(x11,darkorange)).
-assert(gv_color(x11,darkorange1)).
-assert(gv_color(x11,darkorange2)).
-assert(gv_color(x11,darkorange3)).
-assert(gv_color(x11,darkorange4)).
-assert(gv_color(x11,darkorchid)).
-assert(gv_color(x11,darkorchid1)).
-assert(gv_color(x11,darkorchid2)).
-assert(gv_color(x11,darkorchid3)).
-assert(gv_color(x11,darkorchid4)).
-assert(gv_color(x11,darksalmon)).
-assert(gv_color(x11,darkseagreen)).
-assert(gv_color(x11,darkseagreen1)).
-assert(gv_color(x11,darkseagreen2)).
-assert(gv_color(x11,darkseagreen3)).
-assert(gv_color(x11,darkseagreen4)).
-assert(gv_color(x11,darkslateblue)).
-assert(gv_color(x11,darkslategray)).
-assert(gv_color(x11,darkslategray1)).
-assert(gv_color(x11,darkslategray2)).
-assert(gv_color(x11,darkslategray3)).
-assert(gv_color(x11,darkslategray4)).
-assert(gv_color(x11,darkslategrey)).
-assert(gv_color(x11,darkturquoise)).
-assert(gv_color(x11,darkviolet)).
-assert(gv_color(x11,deeppink)).
-assert(gv_color(x11,deeppink1)).
-assert(gv_color(x11,deeppink2)).
-assert(gv_color(x11,deeppink3)).
-assert(gv_color(x11,deeppink4)).
-assert(gv_color(x11,deepskyblue)).
-assert(gv_color(x11,deepskyblue1)).
-assert(gv_color(x11,deepskyblue2)).
-assert(gv_color(x11,deepskyblue3)).
-assert(gv_color(x11,deepskyblue4)).
-assert(gv_color(x11,dimgray)).
-assert(gv_color(x11,dimgrey)).
-assert(gv_color(x11,dodgerblue)).
-assert(gv_color(x11,dodgerblue1)).
-assert(gv_color(x11,dodgerblue2)).
-assert(gv_color(x11,dodgerblue3)).
-assert(gv_color(x11,dodgerblue4)).
-assert(gv_color(x11,firebrick)).
-assert(gv_color(x11,firebrick1)).
-assert(gv_color(x11,firebrick2)).
-assert(gv_color(x11,firebrick3)).
-assert(gv_color(x11,firebrick4)).
-assert(gv_color(x11,floralwhite)).
-assert(gv_color(x11,forestgreen)).
-assert(gv_color(x11,gainsboro)).
-assert(gv_color(x11,ghostwhite)).
-assert(gv_color(x11,gold)).
-assert(gv_color(x11,gold1)).
-assert(gv_color(x11,gold2)).
-assert(gv_color(x11,gold3)).
-assert(gv_color(x11,gold4)).
-assert(gv_color(x11,goldenrod)).
-assert(gv_color(x11,goldenrod1)).
-assert(gv_color(x11,goldenrod2)).
-assert(gv_color(x11,goldenrod3)).
-assert(gv_color(x11,goldenrod4)).
-assert(gv_color(x11,gray)).
-assert(gv_color(x11,gray0)).
-assert(gv_color(x11,gray1)).
-assert(gv_color(x11,gray10)).
-assert(gv_color(x11,gray100)).
-assert(gv_color(x11,gray11)).
-assert(gv_color(x11,gray12)).
-assert(gv_color(x11,gray13)).
-assert(gv_color(x11,gray14)).
-assert(gv_color(x11,gray15)).
-assert(gv_color(x11,gray16)).
-assert(gv_color(x11,gray17)).
-assert(gv_color(x11,gray18)).
-assert(gv_color(x11,gray19)).
-assert(gv_color(x11,gray2)).
-assert(gv_color(x11,gray20)).
-assert(gv_color(x11,gray21)).
-assert(gv_color(x11,gray22)).
-assert(gv_color(x11,gray23)).
-assert(gv_color(x11,gray24)).
-assert(gv_color(x11,gray25)).
-assert(gv_color(x11,gray26)).
-assert(gv_color(x11,gray27)).
-assert(gv_color(x11,gray28)).
-assert(gv_color(x11,gray29)).
-assert(gv_color(x11,gray3)).
-assert(gv_color(x11,gray30)).
-assert(gv_color(x11,gray31)).
-assert(gv_color(x11,gray32)).
-assert(gv_color(x11,gray33)).
-assert(gv_color(x11,gray34)).
-assert(gv_color(x11,gray35)).
-assert(gv_color(x11,gray36)).
-assert(gv_color(x11,gray37)).
-assert(gv_color(x11,gray38)).
-assert(gv_color(x11,gray39)).
-assert(gv_color(x11,gray4)).
-assert(gv_color(x11,gray40)).
-assert(gv_color(x11,gray41)).
-assert(gv_color(x11,gray42)).
-assert(gv_color(x11,gray43)).
-assert(gv_color(x11,gray44)).
-assert(gv_color(x11,gray45)).
-assert(gv_color(x11,gray46)).
-assert(gv_color(x11,gray47)).
-assert(gv_color(x11,gray48)).
-assert(gv_color(x11,gray49)).
-assert(gv_color(x11,gray5)).
-assert(gv_color(x11,gray50)).
-assert(gv_color(x11,gray51)).
-assert(gv_color(x11,gray52)).
-assert(gv_color(x11,gray53)).
-assert(gv_color(x11,gray54)).
-assert(gv_color(x11,gray55)).
-assert(gv_color(x11,gray56)).
-assert(gv_color(x11,gray57)).
-assert(gv_color(x11,gray58)).
-assert(gv_color(x11,gray59)).
-assert(gv_color(x11,gray6)).
-assert(gv_color(x11,gray60)).
-assert(gv_color(x11,gray61)).
-assert(gv_color(x11,gray62)).
-assert(gv_color(x11,gray63)).
-assert(gv_color(x11,gray64)).
-assert(gv_color(x11,gray65)).
-assert(gv_color(x11,gray66)).
-assert(gv_color(x11,gray67)).
-assert(gv_color(x11,gray68)).
-assert(gv_color(x11,gray69)).
-assert(gv_color(x11,gray7)).
-assert(gv_color(x11,gray70)).
-assert(gv_color(x11,gray71)).
-assert(gv_color(x11,gray72)).
-assert(gv_color(x11,gray73)).
-assert(gv_color(x11,gray74)).
-assert(gv_color(x11,gray75)).
-assert(gv_color(x11,gray76)).
-assert(gv_color(x11,gray77)).
-assert(gv_color(x11,gray78)).
-assert(gv_color(x11,gray79)).
-assert(gv_color(x11,gray8)).
-assert(gv_color(x11,gray80)).
-assert(gv_color(x11,gray81)).
-assert(gv_color(x11,gray82)).
-assert(gv_color(x11,gray83)).
-assert(gv_color(x11,gray84)).
-assert(gv_color(x11,gray85)).
-assert(gv_color(x11,gray86)).
-assert(gv_color(x11,gray87)).
-assert(gv_color(x11,gray88)).
-assert(gv_color(x11,gray89)).
-assert(gv_color(x11,gray9)).
-assert(gv_color(x11,gray90)).
-assert(gv_color(x11,gray91)).
-assert(gv_color(x11,gray92)).
-assert(gv_color(x11,gray93)).
-assert(gv_color(x11,gray94)).
-assert(gv_color(x11,gray95)).
-assert(gv_color(x11,gray96)).
-assert(gv_color(x11,gray97)).
-assert(gv_color(x11,gray98)).
-assert(gv_color(x11,gray99)).
-assert(gv_color(x11,green)).
-assert(gv_color(x11,green1)).
-assert(gv_color(x11,green2)).
-assert(gv_color(x11,green3)).
-assert(gv_color(x11,green4)).
-assert(gv_color(x11,greenyellow)).
-assert(gv_color(x11,grey)).
-assert(gv_color(x11,grey0)).
-assert(gv_color(x11,grey1)).
-assert(gv_color(x11,grey10)).
-assert(gv_color(x11,grey100)).
-assert(gv_color(x11,grey11)).
-assert(gv_color(x11,grey12)).
-assert(gv_color(x11,grey13)).
-assert(gv_color(x11,grey14)).
-assert(gv_color(x11,grey15)).
-assert(gv_color(x11,grey16)).
-assert(gv_color(x11,grey17)).
-assert(gv_color(x11,grey18)).
-assert(gv_color(x11,grey19)).
-assert(gv_color(x11,grey2)).
-assert(gv_color(x11,grey20)).
-assert(gv_color(x11,grey21)).
-assert(gv_color(x11,grey22)).
-assert(gv_color(x11,grey23)).
-assert(gv_color(x11,grey24)).
-assert(gv_color(x11,grey25)).
-assert(gv_color(x11,grey26)).
-assert(gv_color(x11,grey27)).
-assert(gv_color(x11,grey28)).
-assert(gv_color(x11,grey29)).
-assert(gv_color(x11,grey3)).
-assert(gv_color(x11,grey30)).
-assert(gv_color(x11,grey31)).
-assert(gv_color(x11,grey32)).
-assert(gv_color(x11,grey33)).
-assert(gv_color(x11,grey34)).
-assert(gv_color(x11,grey35)).
-assert(gv_color(x11,grey36)).
-assert(gv_color(x11,grey37)).
-assert(gv_color(x11,grey38)).
-assert(gv_color(x11,grey39)).
-assert(gv_color(x11,grey4)).
-assert(gv_color(x11,grey40)).
-assert(gv_color(x11,grey41)).
-assert(gv_color(x11,grey42)).
-assert(gv_color(x11,grey43)).
-assert(gv_color(x11,grey44)).
-assert(gv_color(x11,grey45)).
-assert(gv_color(x11,grey46)).
-assert(gv_color(x11,grey47)).
-assert(gv_color(x11,grey48)).
-assert(gv_color(x11,grey49)).
-assert(gv_color(x11,grey5)).
-assert(gv_color(x11,grey50)).
-assert(gv_color(x11,grey51)).
-assert(gv_color(x11,grey52)).
-assert(gv_color(x11,grey53)).
-assert(gv_color(x11,grey54)).
-assert(gv_color(x11,grey55)).
-assert(gv_color(x11,grey56)).
-assert(gv_color(x11,grey57)).
-assert(gv_color(x11,grey58)).
-assert(gv_color(x11,grey59)).
-assert(gv_color(x11,grey6)).
-assert(gv_color(x11,grey60)).
-assert(gv_color(x11,grey61)).
-assert(gv_color(x11,grey62)).
-assert(gv_color(x11,grey63)).
-assert(gv_color(x11,grey64)).
-assert(gv_color(x11,grey65)).
-assert(gv_color(x11,grey66)).
-assert(gv_color(x11,grey67)).
-assert(gv_color(x11,grey68)).
-assert(gv_color(x11,grey69)).
-assert(gv_color(x11,grey7)).
-assert(gv_color(x11,grey70)).
-assert(gv_color(x11,grey71)).
-assert(gv_color(x11,grey72)).
-assert(gv_color(x11,grey73)).
-assert(gv_color(x11,grey74)).
-assert(gv_color(x11,grey75)).
-assert(gv_color(x11,grey76)).
-assert(gv_color(x11,grey77)).
-assert(gv_color(x11,grey78)).
-assert(gv_color(x11,grey79)).
-assert(gv_color(x11,grey8)).
-assert(gv_color(x11,grey80)).
-assert(gv_color(x11,grey81)).
-assert(gv_color(x11,grey82)).
-assert(gv_color(x11,grey83)).
-assert(gv_color(x11,grey84)).
-assert(gv_color(x11,grey85)).
-assert(gv_color(x11,grey86)).
-assert(gv_color(x11,grey87)).
-assert(gv_color(x11,grey88)).
-assert(gv_color(x11,grey89)).
-assert(gv_color(x11,grey9)).
-assert(gv_color(x11,grey90)).
-assert(gv_color(x11,grey91)).
-assert(gv_color(x11,grey92)).
-assert(gv_color(x11,grey93)).
-assert(gv_color(x11,grey94)).
-assert(gv_color(x11,grey95)).
-assert(gv_color(x11,grey96)).
-assert(gv_color(x11,grey97)).
-assert(gv_color(x11,grey98)).
-assert(gv_color(x11,grey99)).
-assert(gv_color(x11,honeydew)).
-assert(gv_color(x11,honeydew1)).
-assert(gv_color(x11,honeydew2)).
-assert(gv_color(x11,honeydew3)).
-assert(gv_color(x11,honeydew4)).
-assert(gv_color(x11,hotpink)).
-assert(gv_color(x11,hotpink1)).
-assert(gv_color(x11,hotpink2)).
-assert(gv_color(x11,hotpink3)).
-assert(gv_color(x11,hotpink4)).
-assert(gv_color(x11,indianred)).
-assert(gv_color(x11,indianred1)).
-assert(gv_color(x11,indianred2)).
-assert(gv_color(x11,indianred3)).
-assert(gv_color(x11,indianred4)).
-assert(gv_color(x11,indigo)).
-assert(gv_color(x11,invis)).
-assert(gv_color(x11,ivory)).
-assert(gv_color(x11,ivory1)).
-assert(gv_color(x11,ivory2)).
-assert(gv_color(x11,ivory3)).
-assert(gv_color(x11,ivory4)).
-assert(gv_color(x11,khaki)).
-assert(gv_color(x11,khaki1)).
-assert(gv_color(x11,khaki2)).
-assert(gv_color(x11,khaki3)).
-assert(gv_color(x11,khaki4)).
-assert(gv_color(x11,lavender)).
-assert(gv_color(x11,lavenderblush)).
-assert(gv_color(x11,lavenderblush1)).
-assert(gv_color(x11,lavenderblush2)).
-assert(gv_color(x11,lavenderblush3)).
-assert(gv_color(x11,lavenderblush4)).
-assert(gv_color(x11,lawngreen)).
-assert(gv_color(x11,lemonchiffon)).
-assert(gv_color(x11,lemonchiffon1)).
-assert(gv_color(x11,lemonchiffon2)).
-assert(gv_color(x11,lemonchiffon3)).
-assert(gv_color(x11,lemonchiffon4)).
-assert(gv_color(x11,lightblue)).
-assert(gv_color(x11,lightblue1)).
-assert(gv_color(x11,lightblue2)).
-assert(gv_color(x11,lightblue3)).
-assert(gv_color(x11,lightblue4)).
-assert(gv_color(x11,lightcoral)).
-assert(gv_color(x11,lightcyan)).
-assert(gv_color(x11,lightcyan1)).
-assert(gv_color(x11,lightcyan2)).
-assert(gv_color(x11,lightcyan3)).
-assert(gv_color(x11,lightcyan4)).
-assert(gv_color(x11,lightgoldenrod)).
-assert(gv_color(x11,lightgoldenrod1)).
-assert(gv_color(x11,lightgoldenrod2)).
-assert(gv_color(x11,lightgoldenrod3)).
-assert(gv_color(x11,lightgoldenrod4)).
-assert(gv_color(x11,lightgoldenrodyellow)).
-assert(gv_color(x11,lightgray)).
-assert(gv_color(x11,lightgrey)).
-assert(gv_color(x11,lightpink)).
-assert(gv_color(x11,lightpink1)).
-assert(gv_color(x11,lightpink2)).
-assert(gv_color(x11,lightpink3)).
-assert(gv_color(x11,lightpink4)).
-assert(gv_color(x11,lightsalmon)).
-assert(gv_color(x11,lightsalmon1)).
-assert(gv_color(x11,lightsalmon2)).
-assert(gv_color(x11,lightsalmon3)).
-assert(gv_color(x11,lightsalmon4)).
-assert(gv_color(x11,lightseagreen)).
-assert(gv_color(x11,lightskyblue)).
-assert(gv_color(x11,lightskyblue1)).
-assert(gv_color(x11,lightskyblue2)).
-assert(gv_color(x11,lightskyblue3)).
-assert(gv_color(x11,lightskyblue4)).
-assert(gv_color(x11,lightslateblue)).
-assert(gv_color(x11,lightslategray)).
-assert(gv_color(x11,lightslategrey)).
-assert(gv_color(x11,lightsteelblue)).
-assert(gv_color(x11,lightsteelblue1)).
-assert(gv_color(x11,lightsteelblue2)).
-assert(gv_color(x11,lightsteelblue3)).
-assert(gv_color(x11,lightsteelblue4)).
-assert(gv_color(x11,lightyellow)).
-assert(gv_color(x11,lightyellow1)).
-assert(gv_color(x11,lightyellow2)).
-assert(gv_color(x11,lightyellow3)).
-assert(gv_color(x11,lightyellow4)).
-assert(gv_color(x11,limegreen)).
-assert(gv_color(x11,linen)).
-assert(gv_color(x11,magenta)).
-assert(gv_color(x11,magenta1)).
-assert(gv_color(x11,magenta2)).
-assert(gv_color(x11,magenta3)).
-assert(gv_color(x11,magenta4)).
-assert(gv_color(x11,maroon)).
-assert(gv_color(x11,maroon1)).
-assert(gv_color(x11,maroon2)).
-assert(gv_color(x11,maroon3)).
-assert(gv_color(x11,maroon4)).
-assert(gv_color(x11,mediumaquamarine)).
-assert(gv_color(x11,mediumblue)).
-assert(gv_color(x11,mediumorchid)).
-assert(gv_color(x11,mediumorchid1)).
-assert(gv_color(x11,mediumorchid2)).
-assert(gv_color(x11,mediumorchid3)).
-assert(gv_color(x11,mediumorchid4)).
-assert(gv_color(x11,mediumpurple)).
-assert(gv_color(x11,mediumpurple1)).
-assert(gv_color(x11,mediumpurple2)).
-assert(gv_color(x11,mediumpurple3)).
-assert(gv_color(x11,mediumpurple4)).
-assert(gv_color(x11,mediumseagreen)).
-assert(gv_color(x11,mediumslateblue)).
-assert(gv_color(x11,mediumspringgreen)).
-assert(gv_color(x11,mediumturquoise)).
-assert(gv_color(x11,mediumvioletred)).
-assert(gv_color(x11,midnightblue)).
-assert(gv_color(x11,mintcream)).
-assert(gv_color(x11,mistyrose)).
-assert(gv_color(x11,mistyrose1)).
-assert(gv_color(x11,mistyrose2)).
-assert(gv_color(x11,mistyrose3)).
-assert(gv_color(x11,mistyrose4)).
-assert(gv_color(x11,moccasin)).
-assert(gv_color(x11,navajowhite)).
-assert(gv_color(x11,navajowhite1)).
-assert(gv_color(x11,navajowhite2)).
-assert(gv_color(x11,navajowhite3)).
-assert(gv_color(x11,navajowhite4)).
-assert(gv_color(x11,navy)).
-assert(gv_color(x11,navyblue)).
-assert(gv_color(x11,none)).
-assert(gv_color(x11,oldlace)).
-assert(gv_color(x11,olivedrab)).
-assert(gv_color(x11,olivedrab1)).
-assert(gv_color(x11,olivedrab2)).
-assert(gv_color(x11,olivedrab3)).
-assert(gv_color(x11,olivedrab4)).
-assert(gv_color(x11,orange)).
-assert(gv_color(x11,orange1)).
-assert(gv_color(x11,orange2)).
-assert(gv_color(x11,orange3)).
-assert(gv_color(x11,orange4)).
-assert(gv_color(x11,orangered)).
-assert(gv_color(x11,orangered1)).
-assert(gv_color(x11,orangered2)).
-assert(gv_color(x11,orangered3)).
-assert(gv_color(x11,orangered4)).
-assert(gv_color(x11,orchid)).
-assert(gv_color(x11,orchid1)).
-assert(gv_color(x11,orchid2)).
-assert(gv_color(x11,orchid3)).
-assert(gv_color(x11,orchid4)).
-assert(gv_color(x11,palegoldenrod)).
-assert(gv_color(x11,palegreen)).
-assert(gv_color(x11,palegreen1)).
-assert(gv_color(x11,palegreen2)).
-assert(gv_color(x11,palegreen3)).
-assert(gv_color(x11,palegreen4)).
-assert(gv_color(x11,paleturquoise)).
-assert(gv_color(x11,paleturquoise1)).
-assert(gv_color(x11,paleturquoise2)).
-assert(gv_color(x11,paleturquoise3)).
-assert(gv_color(x11,paleturquoise4)).
-assert(gv_color(x11,palevioletred)).
-assert(gv_color(x11,palevioletred1)).
-assert(gv_color(x11,palevioletred2)).
-assert(gv_color(x11,palevioletred3)).
-assert(gv_color(x11,palevioletred4)).
-assert(gv_color(x11,papayawhip)).
-assert(gv_color(x11,peachpuff)).
-assert(gv_color(x11,peachpuff1)).
-assert(gv_color(x11,peachpuff2)).
-assert(gv_color(x11,peachpuff3)).
-assert(gv_color(x11,peachpuff4)).
-assert(gv_color(x11,peru)).
-assert(gv_color(x11,pink)).
-assert(gv_color(x11,pink1)).
-assert(gv_color(x11,pink2)).
-assert(gv_color(x11,pink3)).
-assert(gv_color(x11,pink4)).
-assert(gv_color(x11,plum)).
-assert(gv_color(x11,plum1)).
-assert(gv_color(x11,plum2)).
-assert(gv_color(x11,plum3)).
-assert(gv_color(x11,plum4)).
-assert(gv_color(x11,powderblue)).
-assert(gv_color(x11,purple)).
-assert(gv_color(x11,purple1)).
-assert(gv_color(x11,purple2)).
-assert(gv_color(x11,purple3)).
-assert(gv_color(x11,purple4)).
-assert(gv_color(x11,red)).
-assert(gv_color(x11,red1)).
-assert(gv_color(x11,red2)).
-assert(gv_color(x11,red3)).
-assert(gv_color(x11,red4)).
-assert(gv_color(x11,rosybrown)).
-assert(gv_color(x11,rosybrown1)).
-assert(gv_color(x11,rosybrown2)).
-assert(gv_color(x11,rosybrown3)).
-assert(gv_color(x11,rosybrown4)).
-assert(gv_color(x11,royalblue)).
-assert(gv_color(x11,royalblue1)).
-assert(gv_color(x11,royalblue2)).
-assert(gv_color(x11,royalblue3)).
-assert(gv_color(x11,royalblue4)).
-assert(gv_color(x11,saddlebrown)).
-assert(gv_color(x11,salmon)).
-assert(gv_color(x11,salmon1)).
-assert(gv_color(x11,salmon2)).
-assert(gv_color(x11,salmon3)).
-assert(gv_color(x11,salmon4)).
-assert(gv_color(x11,sandybrown)).
-assert(gv_color(x11,seagreen)).
-assert(gv_color(x11,seagreen1)).
-assert(gv_color(x11,seagreen2)).
-assert(gv_color(x11,seagreen3)).
-assert(gv_color(x11,seagreen4)).
-assert(gv_color(x11,seashell)).
-assert(gv_color(x11,seashell1)).
-assert(gv_color(x11,seashell2)).
-assert(gv_color(x11,seashell3)).
-assert(gv_color(x11,seashell4)).
-assert(gv_color(x11,sienna)).
-assert(gv_color(x11,sienna1)).
-assert(gv_color(x11,sienna2)).
-assert(gv_color(x11,sienna3)).
-assert(gv_color(x11,sienna4)).
-assert(gv_color(x11,skyblue)).
-assert(gv_color(x11,skyblue1)).
-assert(gv_color(x11,skyblue2)).
-assert(gv_color(x11,skyblue3)).
-assert(gv_color(x11,skyblue4)).
-assert(gv_color(x11,slateblue)).
-assert(gv_color(x11,slateblue1)).
-assert(gv_color(x11,slateblue2)).
-assert(gv_color(x11,slateblue3)).
-assert(gv_color(x11,slateblue4)).
-assert(gv_color(x11,slategray)).
-assert(gv_color(x11,slategray1)).
-assert(gv_color(x11,slategray2)).
-assert(gv_color(x11,slategray3)).
-assert(gv_color(x11,slategray4)).
-assert(gv_color(x11,slategrey)).
-assert(gv_color(x11,snow)).
-assert(gv_color(x11,snow1)).
-assert(gv_color(x11,snow2)).
-assert(gv_color(x11,snow3)).
-assert(gv_color(x11,snow4)).
-assert(gv_color(x11,springgreen)).
-assert(gv_color(x11,springgreen1)).
-assert(gv_color(x11,springgreen2)).
-assert(gv_color(x11,springgreen3)).
-assert(gv_color(x11,springgreen4)).
-assert(gv_color(x11,steelblue)).
-assert(gv_color(x11,steelblue1)).
-assert(gv_color(x11,steelblue2)).
-assert(gv_color(x11,steelblue3)).
-assert(gv_color(x11,steelblue4)).
-assert(gv_color(x11,tan)).
-assert(gv_color(x11,tan1)).
-assert(gv_color(x11,tan2)).
-assert(gv_color(x11,tan3)).
-assert(gv_color(x11,tan4)).
-assert(gv_color(x11,thistle)).
-assert(gv_color(x11,thistle1)).
-assert(gv_color(x11,thistle2)).
-assert(gv_color(x11,thistle3)).
-assert(gv_color(x11,thistle4)).
-assert(gv_color(x11,tomato)).
-assert(gv_color(x11,tomato1)).
-assert(gv_color(x11,tomato2)).
-assert(gv_color(x11,tomato3)).
-assert(gv_color(x11,tomato4)).
-assert(gv_color(x11,transparent)).
-assert(gv_color(x11,turquoise)).
-assert(gv_color(x11,turquoise1)).
-assert(gv_color(x11,turquoise2)).
-assert(gv_color(x11,turquoise3)).
-assert(gv_color(x11,turquoise4)).
-assert(gv_color(x11,violet)).
-assert(gv_color(x11,violetred)).
-assert(gv_color(x11,violetred1)).
-assert(gv_color(x11,violetred2)).
-assert(gv_color(x11,violetred3)).
-assert(gv_color(x11,violetred4)).
-assert(gv_color(x11,wheat)).
-assert(gv_color(x11,wheat1)).
-assert(gv_color(x11,wheat2)).
-assert(gv_color(x11,wheat3)).
-assert(gv_color(x11,wheat4)).
-assert(gv_color(x11,white)).
-assert(gv_color(x11,whitesmoke)).
-assert(gv_color(x11,yellow)).
-assert(gv_color(x11,yellow1)).
-assert(gv_color(x11,yellow2)).
-assert(gv_color(x11,yellow3)).
-assert(gv_color(x11,yellow4)).
-assert(gv_color(x11,yellowgreen)).
-assert(gv_color(svg,aliceblue)).
-assert(gv_color(svg,antiquewhite)).
-assert(gv_color(svg,aqua)).
-assert(gv_color(svg,aquamarine)).
-assert(gv_color(svg,azure)).
-assert(gv_color(svg,beige)).
-assert(gv_color(svg,bisque)).
-assert(gv_color(svg,black)).
-assert(gv_color(svg,blanchedalmond)).
-assert(gv_color(svg,blue)).
-assert(gv_color(svg,blueviolet)).
-assert(gv_color(svg,brown)).
-assert(gv_color(svg,burlywood)).
-assert(gv_color(svg,cadetblue)).
-assert(gv_color(svg,chartreuse)).
-assert(gv_color(svg,chocolate)).
-assert(gv_color(svg,coral)).
-assert(gv_color(svg,cornflowerblue)).
-assert(gv_color(svg,cornsilk)).
-assert(gv_color(svg,crimson)).
-assert(gv_color(svg,cyan)).
-assert(gv_color(svg,darkblue)).
-assert(gv_color(svg,darkcyan)).
-assert(gv_color(svg,darkgoldenrod)).
-assert(gv_color(svg,darkgray)).
-assert(gv_color(svg,darkgreen)).
-assert(gv_color(svg,darkgrey)).
-assert(gv_color(svg,darkkhaki)).
-assert(gv_color(svg,darkmagenta)).
-assert(gv_color(svg,darkolivegreen)).
-assert(gv_color(svg,darkorange)).
-assert(gv_color(svg,darkorchid)).
-assert(gv_color(svg,darkred)).
-assert(gv_color(svg,darksalmon)).
-assert(gv_color(svg,darkseagreen)).
-assert(gv_color(svg,darkslateblue)).
-assert(gv_color(svg,darkslategray)).
-assert(gv_color(svg,darkslategrey)).
-assert(gv_color(svg,darkturquoise)).
-assert(gv_color(svg,darkviolet)).
-assert(gv_color(svg,deeppink)).
-assert(gv_color(svg,deepskyblue)).
-assert(gv_color(svg,dimgray)).
-assert(gv_color(svg,dimgrey)).
-assert(gv_color(svg,dodgerblue)).
-assert(gv_color(svg,firebrick)).
-assert(gv_color(svg,floralwhite)).
-assert(gv_color(svg,forestgreen)).
-assert(gv_color(svg,fuchsia)).
-assert(gv_color(svg,gainsboro)).
-assert(gv_color(svg,ghostwhite)).
-assert(gv_color(svg,gold)).
-assert(gv_color(svg,goldenrod)).
-assert(gv_color(svg,gray)).
-assert(gv_color(svg,grey)).
-assert(gv_color(svg,green)).
-assert(gv_color(svg,greenyellow)).
-assert(gv_color(svg,honeydew)).
-assert(gv_color(svg,hotpink)).
-assert(gv_color(svg,indianred)).
-assert(gv_color(svg,indigo)).
-assert(gv_color(svg,ivory)).
-assert(gv_color(svg,khaki)).
-assert(gv_color(svg,lavender)).
-assert(gv_color(svg,lavenderblush)).
-assert(gv_color(svg,lawngreen)).
-assert(gv_color(svg,lemonchiffon)).
-assert(gv_color(svg,lightblue)).
-assert(gv_color(svg,lightcoral)).
-assert(gv_color(svg,lightcyan)).
-assert(gv_color(svg,lightgoldenrodyellow)).
-assert(gv_color(svg,lightgray)).
-assert(gv_color(svg,lightgreen)).
-assert(gv_color(svg,lightgrey)).
-assert(gv_color(svg,lightpink)).
-assert(gv_color(svg,lightsalmon)).
-assert(gv_color(svg,lightseagreen)).
-assert(gv_color(svg,lightskyblue)).
-assert(gv_color(svg,lightslategray)).
-assert(gv_color(svg,lightslategrey)).
-assert(gv_color(svg,lightsteelblue)).
-assert(gv_color(svg,lightyellow)).
-assert(gv_color(svg,lime)).
-assert(gv_color(svg,limegreen)).
-assert(gv_color(svg,linen)).
-assert(gv_color(svg,magenta)).
-assert(gv_color(svg,maroon)).
-assert(gv_color(svg,mediumaquamarine)).
-assert(gv_color(svg,mediumblue)).
-assert(gv_color(svg,mediumorchid)).
-assert(gv_color(svg,mediumpurple)).
-assert(gv_color(svg,mediumseagreen)).
-assert(gv_color(svg,mediumslateblue)).
-assert(gv_color(svg,mediumspringgreen)).
-assert(gv_color(svg,mediumturquoise)).
-assert(gv_color(svg,mediumvioletred)).
-assert(gv_color(svg,midnightblue)).
-assert(gv_color(svg,mintcream)).
-assert(gv_color(svg,mistyrose)).
-assert(gv_color(svg,moccasin)).
-assert(gv_color(svg,navajowhite)).
-assert(gv_color(svg,navy)).
-assert(gv_color(svg,oldlace)).
-assert(gv_color(svg,olive)).
-assert(gv_color(svg,olivedrab)).
-assert(gv_color(svg,orange)).
-assert(gv_color(svg,orangered)).
-assert(gv_color(svg,orchid)).
-assert(gv_color(svg,palegoldenrod)).
-assert(gv_color(svg,palegreen)).
-assert(gv_color(svg,paleturquoise)).
-assert(gv_color(svg,palevioletred)).
-assert(gv_color(svg,papayawhip)).
-assert(gv_color(svg,peachpuff)).
-assert(gv_color(svg,peru)).
-assert(gv_color(svg,pink)).
-assert(gv_color(svg,plum)).
-assert(gv_color(svg,powderblue)).
-assert(gv_color(svg,purple)).
-assert(gv_color(svg,red)).
-assert(gv_color(svg,rosybrown)).
-assert(gv_color(svg,royalblue)).
-assert(gv_color(svg,saddlebrown)).
-assert(gv_color(svg,salmon)).
-assert(gv_color(svg,sandybrown)).
-assert(gv_color(svg,seagreen)).
-assert(gv_color(svg,seashell)).
-assert(gv_color(svg,sienna)).
-assert(gv_color(svg,silver)).
-assert(gv_color(svg,skyblue)).
-assert(gv_color(svg,slateblue)).
-assert(gv_color(svg,slategray)).
-assert(gv_color(svg,slategrey)).
-assert(gv_color(svg,snow)).
-assert(gv_color(svg,springgreen)).
-assert(gv_color(svg,steelblue)).
-assert(gv_color(svg,tan)).
-assert(gv_color(svg,teal)).
-assert(gv_color(svg,thistle)).
-assert(gv_color(svg,tomato)).
-assert(gv_color(svg,turquoise)).
-assert(gv_color(svg,violet)).
-assert(gv_color(svg,wheat)).
-assert(gv_color(svg,white)).
-assert(gv_color(svg,whitesmoke)).
-assert(gv_color(svg,yellow)).
-assert(gv_color(svg,yellowgreen)).
diff --git a/prolog/gv/gv_attrs.data b/prolog/gv/gv_attrs.data
new file mode 100644
index 0000000..95fc680
--- /dev/null
+++ b/prolog/gv/gv_attrs.data
@@ -0,0 +1,169 @@
+gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;).
+gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;).
+gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_G59448,&#39;&#39;,&#39;svg, postscript, map only&#39;).
+gv_attr(&#39;_background&#39;,[graph],[string],_G59644,&#39;&#39;,&#39;&#39;).
+gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;).
+gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;).
+gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;).
+gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(bgcolor,[cluster,graph],[color,colorList],_G60571,&#39;&#39;,&#39;&#39;).
+gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;).
+gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;).
+gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;).
+gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;).
+gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;).
+gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;).
+gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(edgetarget,[edge],[escString],_G63711,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;).
+gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;).
+gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;).
+gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;).
+gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;).
+gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;).
+gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;).
+gv_attr(headtarget,[edge],[escString],_G4892,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;).
+gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;).
+gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;).
+gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;).
+gv_attr(inputscale,[graph],[double],_G6250,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;).
+gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;).
+gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;).
+gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;).
+gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(labeltarget,[edge],[escString],_G8276,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;).
+gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;).
+gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;).
+gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;).
+gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;).
+gv_attr(nslimitnslimit1,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;).
+gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;).
+gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;).
+gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;).
+gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;).
+gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;).
+gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;).
+gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;).
+gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;).
+gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;).
+gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;).
+gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;).
+gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;).
+gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;).
+gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;).
+gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;).
+gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;).
+gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;).
+gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;).
+gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;).
+gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;).
+gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;).
+gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;).
+gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;).
+gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;).
+gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;).
+gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;).
+gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;).
+gv_attr(tailtarget,[edge],[escString],_G21528,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(target,[cluster,edge,graph,node],[escString,string],_G21878,&#39;&#39;,&#39;svg, map only&#39;).
+gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;).
+gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;).
+gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;).
+gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;).
+gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;).
+gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;).
+gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;).
+gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;).
+gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;).
diff --git a/prolog/gv/gv_attrs.log b/prolog/gv/gv_attrs.log
deleted file mode 100644
index a9c6010..0000000
--- a/prolog/gv/gv_attrs.log
+++ /dev/null
@@ -1,169 +0,0 @@
-assert(gv_attr(&#39;Damping&#39;,[graph],[double],&#39;0.99&#39;,&#39;0.0&#39;,&#39;neato only&#39;)).
-assert(gv_attr(&#39;K&#39;,[cluster,graph],[double],&#39;0.3&#39;,&#39;0&#39;,&#39;sfdp, fdp only&#39;)).
-assert(gv_attr(&#39;URL&#39;,[cluster,edge,graph,node],[escString],_,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(&#39;_background&#39;,[graph],[string],_,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(area,[cluster,node],[double],&#39;1.0&#39;,&#39;&amp;gt;0&#39;,&#39;patchwork only&#39;)).
-assert(gv_attr(arrowhead,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(arrowsize,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(arrowtail,[edge],[arrowType],normal,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(bb,[graph],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(bgcolor,[cluster,graph],[color,colorList],_,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(center,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(charset,[graph],[string],&#39;&amp;quot;UTF-8&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(clusterrank,[graph],[clusterMode],local,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(color,[cluster,edge,node],[color,colorList],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(colorscheme,[cluster,edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(comment,[edge,graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(compound,[graph],[bool],false,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(concentrate,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(constraint,[edge],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(decorate,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(defaultdist,[graph],[double],&#39;1+(avg. len)*sqrt(|V|)&#39;,epsilon,&#39;neato only&#39;)).
-assert(gv_attr(dim,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
-assert(gv_attr(dimen,[graph],[int],&#39;2&#39;,&#39;2&#39;,&#39;sfdp, fdp, neato only&#39;)).
-assert(gv_attr(dir,[edge],[dirType],&#39;forward(directed)none(undirected)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(diredgeconstraints,[graph],[string,bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(distortion,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
-assert(gv_attr(dpi,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
-assert(gv_attr(edgeURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgehref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgetarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(edgetooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(epsilon,[graph],[double],&#39;.0001 * # nodes(mode == KK).0001(mode == major)&#39;,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(esep,[graph],[addDouble,addPoint],&#39;+3&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(fillcolor,[cluster,edge,node],[color,colorList],&#39;lightgrey(nodes)black(clusters)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fixedsize,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontcolor,[cluster,edge,graph,node],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontname,[cluster,edge,graph,node],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontnames,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
-assert(gv_attr(fontpath,[graph],[string],&#39;system-dependent&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(fontsize,[cluster,edge,graph,node],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
-assert(gv_attr(forcelabels,[graph],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(gradientangle,[cluster,graph,node],[int],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(group,[node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(headURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(head_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(headclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(headlabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(headtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(headtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(height,[node],[double],&#39;0.5&#39;,&#39;0.02&#39;,&#39;&#39;)).
-assert(gv_attr(href,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(id,[cluster,edge,graph,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, postscript, map only&#39;)).
-assert(gv_attr(image,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(imagepath,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(imagescale,[node],[bool,string],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(inputscale,[graph],[double],_,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(label,[cluster,edge,graph,node],[lblString],&#39;&amp;quot;\\N&amp;quot; (nodes)&amp;quot;&amp;quot; (otherwise)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(label_scheme,[graph],[int],&#39;0&#39;,&#39;0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(labelangle,[edge],[double],&#39;-25.0&#39;,&#39;-180.0&#39;,&#39;&#39;)).
-assert(gv_attr(labeldistance,[edge],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(labelfloat,[edge],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontcolor,[edge],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontname,[edge],[string],&#39;&amp;quot;Times-Roman&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelfontsize,[edge],[double],&#39;14.0&#39;,&#39;1.0&#39;,&#39;&#39;)).
-assert(gv_attr(labelhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(labeljust,[cluster,graph],[string],&#39;&amp;quot;c&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labelloc,[cluster,graph,node],[string],&#39;&amp;quot;t&amp;quot;(clusters)&amp;quot;b&amp;quot;(root graphs)&amp;quot;c&amp;quot;(nodes)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(labeltarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(labeltooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(landscape,[graph],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layer,[cluster,edge,node],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layerlistsep,[graph],[string],&#39;&amp;quot;,&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layers,[graph],[layerList],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layerselect,[graph],[layerRange],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layersep,[graph],[string],&#39;&amp;quot; :\\t&amp;quot;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(layout,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(len,[edge],[double],&#39;1.0(neato)0.3(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(levels,[graph],[int],&#39;MAXINT&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(levelsgap,[graph],[double],&#39;0.0&#39;,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(lhead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(lheight,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(lp,[cluster,edge,graph],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(ltail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(lwidth,[cluster,graph],[double],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(margin,[cluster,graph,node],[double,point],&#39;&amp;lt;device-dependent&amp;gt;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(maxiter,[graph],[int],&#39;100 * # nodes(mode == KK)200(mode == major)600(fdp)&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(mclimit,[graph],[double],&#39;1.0&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(mindist,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;circo only&#39;)).
-assert(gv_attr(minlen,[edge],[int],&#39;1&#39;,&#39;0&#39;,&#39;dot only&#39;)).
-assert(gv_attr(mode,[graph],[string],major,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(model,[graph],[string],shortpath,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(mosek,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(nodesep,[graph],[double],&#39;0.25&#39;,&#39;0.02&#39;,&#39;&#39;)).
-assert(gv_attr(nojustify,[cluster,edge,graph,node],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(normalize,[graph],[double,bool],false,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(notranslate,[graph],[bool],false,&#39;&#39;,&#39;neato only&#39;)).
-assert(gv_attr(&#39;nslimit nslimit1&#39;,[graph],[double],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(ordering,[graph,node],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(orientation,[node],[double],&#39;0.0&#39;,&#39;360.0&#39;,&#39;&#39;)).
-assert(gv_attr(orientation,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(outputorder,[graph],[outputMode],breadthfirst,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(overlap,[graph],[string,bool],true,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(overlap_scaling,[graph],[double],&#39;-4&#39;,&#39;-1.0e10&#39;,&#39;prism only&#39;)).
-assert(gv_attr(overlap_shrink,[graph],[bool],true,&#39;&#39;,&#39;prism only&#39;)).
-assert(gv_attr(pack,[graph],[bool,int],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(packmode,[graph],[packMode],node,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pad,[graph],[double,point],&#39;0.0555 (4 points)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(page,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pagedir,[graph],[pagedir],&#39;BL&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(pencolor,[cluster],[color],black,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(penwidth,[cluster,edge,node],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(peripheries,[cluster,node],[int],&#39;shape default(nodes)1(clusters)&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(pin,[node],[bool],false,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(pos,[edge,node],[point,splineType],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(quadtree,[graph],[quadType,bool],normal,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(quantum,[graph],[double],&#39;0.0&#39;,&#39;0.0&#39;,&#39;&#39;)).
-assert(gv_attr(rank,[subgraph],[rankType],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(rankdir,[graph],[rankdir],&#39;TB&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(ranksep,[graph],[double,doubleList],&#39;0.5(dot)1.0(twopi)&#39;,&#39;0.02&#39;,&#39;twopi, dot only&#39;)).
-assert(gv_attr(ratio,[graph],[double,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(rects,[node],[rect],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(regular,[node],[bool],false,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(remincross,[graph],[bool],true,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(repulsiveforce,[graph],[double],&#39;1.0&#39;,&#39;0.0&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(resolution,[graph],[double],&#39;96.00.0&#39;,&#39;&#39;,&#39;svg, bitmap output only&#39;)).
-assert(gv_attr(root,[graph,node],[string,bool],&#39;&amp;lt;none&amp;gt;(graphs)false(nodes)&#39;,&#39;&#39;,&#39;circo, twopi only&#39;)).
-assert(gv_attr(rotate,[graph],[int],&#39;0&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(rotation,[graph],[double],&#39;0&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(samehead,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sametail,[edge],[string],&#39;&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(samplepoints,[node],[int],&#39;8(output)20(overlap and image maps)&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(scale,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(searchsize,[graph],[int],&#39;30&#39;,&#39;&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sep,[graph],[addDouble,addPoint],&#39;+4&#39;,&#39;&#39;,&#39;not dot&#39;)).
-assert(gv_attr(shape,[node],[shape],ellipse,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(shapefile,[node],[string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(showboxes,[edge,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;dot only&#39;)).
-assert(gv_attr(sides,[node],[int],&#39;4&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(size,[graph],[double,point],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(skew,[node],[double],&#39;0.0&#39;,&#39;-100.0&#39;,&#39;&#39;)).
-assert(gv_attr(smoothing,[graph],[smoothType],&#39;&amp;quot;none&amp;quot;&#39;,&#39;&#39;,&#39;sfdp only&#39;)).
-assert(gv_attr(sortv,[cluster,graph,node],[int],&#39;0&#39;,&#39;0&#39;,&#39;&#39;)).
-assert(gv_attr(splines,[graph],[bool,string],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(start,[graph],[startType],&#39;&#39;,&#39;&#39;,&#39;fdp, neato only&#39;)).
-assert(gv_attr(style,[cluster,edge,graph,node],[style],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(stylesheet,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;svg only&#39;)).
-assert(gv_attr(tailURL,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tail_lp,[edge],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(tailclip,[edge],[bool],true,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailhref,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(taillabel,[edge],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailport,[edge],[portPos],center,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(tailtarget,[edge],[escString],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tailtooltip,[edge],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(target,[cluster,edge,graph,node],[escString,string],_,&#39;&#39;,&#39;svg, map only&#39;)).
-assert(gv_attr(tooltip,[cluster,edge,node],[escString],&#39;&#39;,&#39;&#39;,&#39;svg, cmap only&#39;)).
-assert(gv_attr(truecolor,[graph],[bool],&#39;&#39;,&#39;&#39;,&#39;bitmap output only&#39;)).
-assert(gv_attr(vertices,[node],[pointList],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(viewport,[graph],[viewPort],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(voro_margin,[graph],[double],&#39;0.05&#39;,&#39;0.0&#39;,&#39;not dot&#39;)).
-assert(gv_attr(weight,[edge],[int,double],&#39;1&#39;,&#39;0(dot,twopi)1(neato,fdp)&#39;,&#39;&#39;)).
-assert(gv_attr(width,[node],[double],&#39;0.75&#39;,&#39;0.01&#39;,&#39;&#39;)).
-assert(gv_attr(xdotversion,[graph],[string],&#39;&#39;,&#39;&#39;,&#39;xdot only&#39;)).
-assert(gv_attr(xlabel,[edge,node],[lblString],&#39;&#39;,&#39;&#39;,&#39;&#39;)).
-assert(gv_attr(xlp,[edge,node],[point],&#39;&#39;,&#39;&#39;,&#39;write only&#39;)).
-assert(gv_attr(z,[node],[double],&#39;0.0&#39;,&#39;-MAXFLOAT-1000&#39;,&#39;&#39;)).
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 1fd4a18..b26af73 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -5,6 +5,7 @@
                      % +Attribute:nvpair
   ]
 ).
+:- ensure_loaded(library(&#39;gv/gv_attrs.data&#39;)).
 
 /** &amp;lt;module&amp;gt; GraphViz attributes
 
@@ -13,40 +14,10 @@
 */
 
 :- use_module(library(apply)).
-:- use_module(library(debug_ext)).
-:- use_module(library(dcg/basics)).
 :- use_module(library(dcg/dcg_call)).
-:- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
-:- use_module(library(http/http_download)).
 :- use_module(library(lists)).
-:- use_module(library(msg_ext)).
 :- use_module(library(os/file_ext)).
-:- use_module(library(persistency)).
-:- use_module(library(xpath)).
-:- use_module(library(xpath/xpath_table)).
-
-%! gv_attr(
-%!   ?Name:atom,
-%!   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
-%!   ?Types:list(atom),
-%!   ?Default,
-%!   ?Minimum,
-%!   ?Notes:atom
-%! ) is nondet.
-
-:- persistent(
-     gv_attr(
-       name:atom,
-       used_by:list(oneof([cluster,edge,graph,node,subgraph])),
-       types:list(atom),
-       default,
-       minimum,
-       notes:atom
-     )
-   ).
-
-:- initialization(gv_attrs_init).
 
 
 
@@ -54,7 +25,7 @@
 
 %! gv_attr_value(
 %!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +Attribute:nvpair
+%!   +Attribute:compound
 %! )// is det.
 % Uses the default value in case Value is uninstantiated.
 % Otherwise, performs a typecheck and converts the given value.
@@ -101,118 +72,3 @@ check_minimum(_, &#39;&#39;):- !.
 check_minimum(V, Min1):-
   atom_number(Min1, Min2),
   Min2 =&amp;lt; V.
-
-
-
-
-
-% INITIALIZATION %
-
-%! assert_gv_attr_row(+Row:list(atom)) is det.
-
-assert_gv_attr_row([Name,UsedBy1,Types1,Default1,Minimum,Notes]):-
-  atom_phrase(translate_usedby(UsedBy2), UsedBy1),
-  once(atom_phrase(translate_type(Types2), Types1)),
-  sort(UsedBy2, UsedBy3),
-  translate_default(Default1, Default2),
-  assert_gv_attr(Name, UsedBy3, Types2, Default2, Minimum, Notes).
-
-
-%! gv_attrs_downloads is det.
-% Downloads the table describing GraphViz attributes from `graphviz.org`.
-
-gv_attrs_download:-
-  verbose(
-    gv_attrs_download0,
-    &amp;quot;updating GraphViz attributes table&amp;quot;
-  ).
-
-gv_attrs_download0:-
-  gv_attrs_uri(Uri),
-  html_download(Uri, Dom),
-  xpath_chk(Dom, //table(@align=lower_case(center)), TableDom),
-  xpath_table(TableDom, _, Rows),
-  maplist(assert_gv_attr_row, Rows).
-
-
-%! gv_attrs_file(-File:atom) is det.
-
-gv_attrs_file(File):-
-  absolute_file_name(&#39;gv_attrs.log&#39;, File, [access(write)]).
-
-
-%! gv_attrs_init is det.
-
-gv_attrs_init:-
-  gv_attrs_file(File),
-  (   exists_file(File)
-  -&amp;gt;  true
-  ;   touch(File)
-  ),
-  db_attach(File, []),
-  file_age(File, Age),
-  gv_attrs_update(Age).
-
-
-%! gv_attrs_update(+Age:float) is det.
-
-% The persistent store is still fresh.
-gv_attrs_update(Age):-
-  once(gv_attr(_, _, _, _, _, _)),
-  Age &amp;lt; 8640000, !.
-% The persistent store has become stale, so refresh it.
-gv_attrs_update(_):-
-  retractall_gv_attr(_, _, _, _, _, _),
-  gv_attrs_download.
-
-
-
-%! gv_attrs_uri(-Url:url) is det.
-
-gv_attrs_uri(&#39;http://www.graphviz.org/doc/info/attrs.html&#39;).
-
-
-
-%! translate_default(+Default1:atom, -Default2:atom) is det.
-
-% The empty string is represented by the empty atom.
-translate_default(&#39;&amp;quot;&amp;quot;&#39;, &#39;&#39;):- !.
-% The absence of a default value is represented by an uninstantiated variable.
-translate_default(&#39;&amp;lt;none&amp;gt;&#39;, _):- !.
-translate_default(Default, Default).
-
-
-
-%! translate_type(-Types:list(atom))// is det.
-
-translate_type([H|T]) --&amp;gt;
-  gv_attr_type(H),
-  whites,
-  translate_type(T).
-translate_type([H]) --&amp;gt;
-  gv_attr_type(H).
-translate_type([]) --&amp;gt; &amp;quot;&amp;quot;.
-
-
-
-%! translated_usedby(
-%!   -UsedBy:list(oneof([cluster,edge,graph,node,subgraph]))
-%! )// is det.
-
-translate_usedby([cluster|T]) --&amp;gt;
-  &amp;quot;C&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([edge|T]) --&amp;gt;
-  &amp;quot;E&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([graph|T]) --&amp;gt;
-  &amp;quot;G&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([node|T]) --&amp;gt;
-  &amp;quot;N&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([subgraph|T]) --&amp;gt;
-  &amp;quot;S&amp;quot;, !,
-  translate_usedby(T).
-translate_usedby([]) --&amp;gt;
-  &amp;quot;&amp;quot;.
diff --git a/prolog/gv/gv_color.data b/prolog/gv/gv_color.data
new file mode 100644
index 0000000..166b13c
--- /dev/null
+++ b/prolog/gv/gv_color.data
@@ -0,0 +1,802 @@
+gv_color(x11,aliceblue).
+gv_color(x11,antiquewhite).
+gv_color(x11,antiquewhite1).
+gv_color(x11,antiquewhite2).
+gv_color(x11,antiquewhite3).
+gv_color(x11,antiquewhite4).
+gv_color(x11,aquamarine).
+gv_color(x11,aquamarine1).
+gv_color(x11,aquamarine2).
+gv_color(x11,aquamarine3).
+gv_color(x11,aquamarine4).
+gv_color(x11,azure).
+gv_color(x11,azure1).
+gv_color(x11,azure2).
+gv_color(x11,azure3).
+gv_color(x11,azure4).
+gv_color(x11,beige).
+gv_color(x11,bisque).
+gv_color(x11,bisque1).
+gv_color(x11,bisque2).
+gv_color(x11,bisque3).
+gv_color(x11,bisque4).
+gv_color(x11,black).
+gv_color(x11,blanchedalmond).
+gv_color(x11,blue).
+gv_color(x11,blue1).
+gv_color(x11,blue2).
+gv_color(x11,blue3).
+gv_color(x11,blue4).
+gv_color(x11,blueviolet).
+gv_color(x11,brown).
+gv_color(x11,brown1).
+gv_color(x11,brown2).
+gv_color(x11,brown3).
+gv_color(x11,brown4).
+gv_color(x11,burlywood).
+gv_color(x11,burlywood1).
+gv_color(x11,burlywood2).
+gv_color(x11,burlywood3).
+gv_color(x11,burlywood4).
+gv_color(x11,cadetblue).
+gv_color(x11,cadetblue1).
+gv_color(x11,cadetblue2).
+gv_color(x11,cadetblue3).
+gv_color(x11,cadetblue4).
+gv_color(x11,chartreuse).
+gv_color(x11,chartreuse1).
+gv_color(x11,chartreuse2).
+gv_color(x11,chartreuse3).
+gv_color(x11,chartreuse4).
+gv_color(x11,chocolate).
+gv_color(x11,chocolate1).
+gv_color(x11,chocolate2).
+gv_color(x11,chocolate3).
+gv_color(x11,chocolate4).
+gv_color(x11,coral).
+gv_color(x11,coral1).
+gv_color(x11,coral2).
+gv_color(x11,coral3).
+gv_color(x11,coral4).
+gv_color(x11,cornflowerblue).
+gv_color(x11,cornsilk).
+gv_color(x11,cornsilk1).
+gv_color(x11,cornsilk2).
+gv_color(x11,cornsilk3).
+gv_color(x11,cornsilk4).
+gv_color(x11,crimson).
+gv_color(x11,cyan).
+gv_color(x11,cyan1).
+gv_color(x11,cyan2).
+gv_color(x11,cyan3).
+gv_color(x11,cyan4).
+gv_color(x11,darkgoldenrod).
+gv_color(x11,darkgoldenrod1).
+gv_color(x11,darkgoldenrod2).
+gv_color(x11,darkgoldenrod3).
+gv_color(x11,darkgoldenrod4).
+gv_color(x11,darkgreen).
+gv_color(x11,darkkhaki).
+gv_color(x11,darkolivegreen).
+gv_color(x11,darkolivegreen1).
+gv_color(x11,darkolivegreen2).
+gv_color(x11,darkolivegreen3).
+gv_color(x11,darkolivegreen4).
+gv_color(x11,darkorange).
+gv_color(x11,darkorange1).
+gv_color(x11,darkorange2).
+gv_color(x11,darkorange3).
+gv_color(x11,darkorange4).
+gv_color(x11,darkorchid).
+gv_color(x11,darkorchid1).
+gv_color(x11,darkorchid2).
+gv_color(x11,darkorchid3).
+gv_color(x11,darkorchid4).
+gv_color(x11,darksalmon).
+gv_color(x11,darkseagreen).
+gv_color(x11,darkseagreen1).
+gv_color(x11,darkseagreen2).
+gv_color(x11,darkseagreen3).
+gv_color(x11,darkseagreen4).
+gv_color(x11,darkslateblue).
+gv_color(x11,darkslategray).
+gv_color(x11,darkslategray1).
+gv_color(x11,darkslategray2).
+gv_color(x11,darkslategray3).
+gv_color(x11,darkslategray4).
+gv_color(x11,darkslategrey).
+gv_color(x11,darkturquoise).
+gv_color(x11,darkviolet).
+gv_color(x11,deeppink).
+gv_color(x11,deeppink1).
+gv_color(x11,deeppink2).
+gv_color(x11,deeppink3).
+gv_color(x11,deeppink4).
+gv_color(x11,deepskyblue).
+gv_color(x11,deepskyblue1).
+gv_color(x11,deepskyblue2).
+gv_color(x11,deepskyblue3).
+gv_color(x11,deepskyblue4).
+gv_color(x11,dimgray).
+gv_color(x11,dimgrey).
+gv_color(x11,dodgerblue).
+gv_color(x11,dodgerblue1).
+gv_color(x11,dodgerblue2).
+gv_color(x11,dodgerblue3).
+gv_color(x11,dodgerblue4).
+gv_color(x11,firebrick).
+gv_color(x11,firebrick1).
+gv_color(x11,firebrick2).
+gv_color(x11,firebrick3).
+gv_color(x11,firebrick4).
+gv_color(x11,floralwhite).
+gv_color(x11,forestgreen).
+gv_color(x11,gainsboro).
+gv_color(x11,ghostwhite).
+gv_color(x11,gold).
+gv_color(x11,gold1).
+gv_color(x11,gold2).
+gv_color(x11,gold3).
+gv_color(x11,gold4).
+gv_color(x11,goldenrod).
+gv_color(x11,goldenrod1).
+gv_color(x11,goldenrod2).
+gv_color(x11,goldenrod3).
+gv_color(x11,goldenrod4).
+gv_color(x11,gray).
+gv_color(x11,gray0).
+gv_color(x11,gray1).
+gv_color(x11,gray10).
+gv_color(x11,gray100).
+gv_color(x11,gray11).
+gv_color(x11,gray12).
+gv_color(x11,gray13).
+gv_color(x11,gray14).
+gv_color(x11,gray15).
+gv_color(x11,gray16).
+gv_color(x11,gray17).
+gv_color(x11,gray18).
+gv_color(x11,gray19).
+gv_color(x11,gray2).
+gv_color(x11,gray20).
+gv_color(x11,gray21).
+gv_color(x11,gray22).
+gv_color(x11,gray23).
+gv_color(x11,gray24).
+gv_color(x11,gray25).
+gv_color(x11,gray26).
+gv_color(x11,gray27).
+gv_color(x11,gray28).
+gv_color(x11,gray29).
+gv_color(x11,gray3).
+gv_color(x11,gray30).
+gv_color(x11,gray31).
+gv_color(x11,gray32).
+gv_color(x11,gray33).
+gv_color(x11,gray34).
+gv_color(x11,gray35).
+gv_color(x11,gray36).
+gv_color(x11,gray37).
+gv_color(x11,gray38).
+gv_color(x11,gray39).
+gv_color(x11,gray4).
+gv_color(x11,gray40).
+gv_color(x11,gray41).
+gv_color(x11,gray42).
+gv_color(x11,gray43).
+gv_color(x11,gray44).
+gv_color(x11,gray45).
+gv_color(x11,gray46).
+gv_color(x11,gray47).
+gv_color(x11,gray48).
+gv_color(x11,gray49).
+gv_color(x11,gray5).
+gv_color(x11,gray50).
+gv_color(x11,gray51).
+gv_color(x11,gray52).
+gv_color(x11,gray53).
+gv_color(x11,gray54).
+gv_color(x11,gray55).
+gv_color(x11,gray56).
+gv_color(x11,gray57).
+gv_color(x11,gray58).
+gv_color(x11,gray59).
+gv_color(x11,gray6).
+gv_color(x11,gray60).
+gv_color(x11,gray61).
+gv_color(x11,gray62).
+gv_color(x11,gray63).
+gv_color(x11,gray64).
+gv_color(x11,gray65).
+gv_color(x11,gray66).
+gv_color(x11,gray67).
+gv_color(x11,gray68).
+gv_color(x11,gray69).
+gv_color(x11,gray7).
+gv_color(x11,gray70).
+gv_color(x11,gray71).
+gv_color(x11,gray72).
+gv_color(x11,gray73).
+gv_color(x11,gray74).
+gv_color(x11,gray75).
+gv_color(x11,gray76).
+gv_color(x11,gray77).
+gv_color(x11,gray78).
+gv_color(x11,gray79).
+gv_color(x11,gray8).
+gv_color(x11,gray80).
+gv_color(x11,gray81).
+gv_color(x11,gray82).
+gv_color(x11,gray83).
+gv_color(x11,gray84).
+gv_color(x11,gray85).
+gv_color(x11,gray86).
+gv_color(x11,gray87).
+gv_color(x11,gray88).
+gv_color(x11,gray89).
+gv_color(x11,gray9).
+gv_color(x11,gray90).
+gv_color(x11,gray91).
+gv_color(x11,gray92).
+gv_color(x11,gray93).
+gv_color(x11,gray94).
+gv_color(x11,gray95).
+gv_color(x11,gray96).
+gv_color(x11,gray97).
+gv_color(x11,gray98).
+gv_color(x11,gray99).
+gv_color(x11,green).
+gv_color(x11,green1).
+gv_color(x11,green2).
+gv_color(x11,green3).
+gv_color(x11,green4).
+gv_color(x11,greenyellow).
+gv_color(x11,grey).
+gv_color(x11,grey0).
+gv_color(x11,grey1).
+gv_color(x11,grey10).
+gv_color(x11,grey100).
+gv_color(x11,grey11).
+gv_color(x11,grey12).
+gv_color(x11,grey13).
+gv_color(x11,grey14).
+gv_color(x11,grey15).
+gv_color(x11,grey16).
+gv_color(x11,grey17).
+gv_color(x11,grey18).
+gv_color(x11,grey19).
+gv_color(x11,grey2).
+gv_color(x11,grey20).
+gv_color(x11,grey21).
+gv_color(x11,grey22).
+gv_color(x11,grey23).
+gv_color(x11,grey24).
+gv_color(x11,grey25).
+gv_color(x11,grey26).
+gv_color(x11,grey27).
+gv_color(x11,grey28).
+gv_color(x11,grey29).
+gv_color(x11,grey3).
+gv_color(x11,grey30).
+gv_color(x11,grey31).
+gv_color(x11,grey32).
+gv_color(x11,grey33).
+gv_color(x11,grey34).
+gv_color(x11,grey35).
+gv_color(x11,grey36).
+gv_color(x11,grey37).
+gv_color(x11,grey38).
+gv_color(x11,grey39).
+gv_color(x11,grey4).
+gv_color(x11,grey40).
+gv_color(x11,grey41).
+gv_color(x11,grey42).
+gv_color(x11,grey43).
+gv_color(x11,grey44).
+gv_color(x11,grey45).
+gv_color(x11,grey46).
+gv_color(x11,grey47).
+gv_color(x11,grey48).
+gv_color(x11,grey49).
+gv_color(x11,grey5).
+gv_color(x11,grey50).
+gv_color(x11,grey51).
+gv_color(x11,grey52).
+gv_color(x11,grey53).
+gv_color(x11,grey54).
+gv_color(x11,grey55).
+gv_color(x11,grey56).
+gv_color(x11,grey57).
+gv_color(x11,grey58).
+gv_color(x11,grey59).
+gv_color(x11,grey6).
+gv_color(x11,grey60).
+gv_color(x11,grey61).
+gv_color(x11,grey62).
+gv_color(x11,grey63).
+gv_color(x11,grey64).
+gv_color(x11,grey65).
+gv_color(x11,grey66).
+gv_color(x11,grey67).
+gv_color(x11,grey68).
+gv_color(x11,grey69).
+gv_color(x11,grey7).
+gv_color(x11,grey70).
+gv_color(x11,grey71).
+gv_color(x11,grey72).
+gv_color(x11,grey73).
+gv_color(x11,grey74).
+gv_color(x11,grey75).
+gv_color(x11,grey76).
+gv_color(x11,grey77).
+gv_color(x11,grey78).
+gv_color(x11,grey79).
+gv_color(x11,grey8).
+gv_color(x11,grey80).
+gv_color(x11,grey81).
+gv_color(x11,grey82).
+gv_color(x11,grey83).
+gv_color(x11,grey84).
+gv_color(x11,grey85).
+gv_color(x11,grey86).
+gv_color(x11,grey87).
+gv_color(x11,grey88).
+gv_color(x11,grey89).
+gv_color(x11,grey9).
+gv_color(x11,grey90).
+gv_color(x11,grey91).
+gv_color(x11,grey92).
+gv_color(x11,grey93).
+gv_color(x11,grey94).
+gv_color(x11,grey95).
+gv_color(x11,grey96).
+gv_color(x11,grey97).
+gv_color(x11,grey98).
+gv_color(x11,grey99).
+gv_color(x11,honeydew).
+gv_color(x11,honeydew1).
+gv_color(x11,honeydew2).
+gv_color(x11,honeydew3).
+gv_color(x11,honeydew4).
+gv_color(x11,hotpink).
+gv_color(x11,hotpink1).
+gv_color(x11,hotpink2).
+gv_color(x11,hotpink3).
+gv_color(x11,hotpink4).
+gv_color(x11,indianred).
+gv_color(x11,indianred1).
+gv_color(x11,indianred2).
+gv_color(x11,indianred3).
+gv_color(x11,indianred4).
+gv_color(x11,indigo).
+gv_color(x11,invis).
+gv_color(x11,ivory).
+gv_color(x11,ivory1).
+gv_color(x11,ivory2).
+gv_color(x11,ivory3).
+gv_color(x11,ivory4).
+gv_color(x11,khaki).
+gv_color(x11,khaki1).
+gv_color(x11,khaki2).
+gv_color(x11,khaki3).
+gv_color(x11,khaki4).
+gv_color(x11,lavender).
+gv_color(x11,lavenderblush).
+gv_color(x11,lavenderblush1).
+gv_color(x11,lavenderblush2).
+gv_color(x11,lavenderblush3).
+gv_color(x11,lavenderblush4).
+gv_color(x11,lawngreen).
+gv_color(x11,lemonchiffon).
+gv_color(x11,lemonchiffon1).
+gv_color(x11,lemonchiffon2).
+gv_color(x11,lemonchiffon3).
+gv_color(x11,lemonchiffon4).
+gv_color(x11,lightblue).
+gv_color(x11,lightblue1).
+gv_color(x11,lightblue2).
+gv_color(x11,lightblue3).
+gv_color(x11,lightblue4).
+gv_color(x11,lightcoral).
+gv_color(x11,lightcyan).
+gv_color(x11,lightcyan1).
+gv_color(x11,lightcyan2).
+gv_color(x11,lightcyan3).
+gv_color(x11,lightcyan4).
+gv_color(x11,lightgoldenrod).
+gv_color(x11,lightgoldenrod1).
+gv_color(x11,lightgoldenrod2).
+gv_color(x11,lightgoldenrod3).
+gv_color(x11,lightgoldenrod4).
+gv_color(x11,lightgoldenrodyellow).
+gv_color(x11,lightgray).
+gv_color(x11,lightgrey).
+gv_color(x11,lightpink).
+gv_color(x11,lightpink1).
+gv_color(x11,lightpink2).
+gv_color(x11,lightpink3).
+gv_color(x11,lightpink4).
+gv_color(x11,lightsalmon).
+gv_color(x11,lightsalmon1).
+gv_color(x11,lightsalmon2).
+gv_color(x11,lightsalmon3).
+gv_color(x11,lightsalmon4).
+gv_color(x11,lightseagreen).
+gv_color(x11,lightskyblue).
+gv_color(x11,lightskyblue1).
+gv_color(x11,lightskyblue2).
+gv_color(x11,lightskyblue3).
+gv_color(x11,lightskyblue4).
+gv_color(x11,lightslateblue).
+gv_color(x11,lightslategray).
+gv_color(x11,lightslategrey).
+gv_color(x11,lightsteelblue).
+gv_color(x11,lightsteelblue1).
+gv_color(x11,lightsteelblue2).
+gv_color(x11,lightsteelblue3).
+gv_color(x11,lightsteelblue4).
+gv_color(x11,lightyellow).
+gv_color(x11,lightyellow1).
+gv_color(x11,lightyellow2).
+gv_color(x11,lightyellow3).
+gv_color(x11,lightyellow4).
+gv_color(x11,limegreen).
+gv_color(x11,linen).
+gv_color(x11,magenta).
+gv_color(x11,magenta1).
+gv_color(x11,magenta2).
+gv_color(x11,magenta3).
+gv_color(x11,magenta4).
+gv_color(x11,maroon).
+gv_color(x11,maroon1).
+gv_color(x11,maroon2).
+gv_color(x11,maroon3).
+gv_color(x11,maroon4).
+gv_color(x11,mediumaquamarine).
+gv_color(x11,mediumblue).
+gv_color(x11,mediumorchid).
+gv_color(x11,mediumorchid1).
+gv_color(x11,mediumorchid2).
+gv_color(x11,mediumorchid3).
+gv_color(x11,mediumorchid4).
+gv_color(x11,mediumpurple).
+gv_color(x11,mediumpurple1).
+gv_color(x11,mediumpurple2).
+gv_color(x11,mediumpurple3).
+gv_color(x11,mediumpurple4).
+gv_color(x11,mediumseagreen).
+gv_color(x11,mediumslateblue).
+gv_color(x11,mediumspringgreen).
+gv_color(x11,mediumturquoise).
+gv_color(x11,mediumvioletred).
+gv_color(x11,midnightblue).
+gv_color(x11,mintcream).
+gv_color(x11,mistyrose).
+gv_color(x11,mistyrose1).
+gv_color(x11,mistyrose2).
+gv_color(x11,mistyrose3).
+gv_color(x11,mistyrose4).
+gv_color(x11,moccasin).
+gv_color(x11,navajowhite).
+gv_color(x11,navajowhite1).
+gv_color(x11,navajowhite2).
+gv_color(x11,navajowhite3).
+gv_color(x11,navajowhite4).
+gv_color(x11,navy).
+gv_color(x11,navyblue).
+gv_color(x11,none).
+gv_color(x11,oldlace).
+gv_color(x11,olivedrab).
+gv_color(x11,olivedrab1).
+gv_color(x11,olivedrab2).
+gv_color(x11,olivedrab3).
+gv_color(x11,olivedrab4).
+gv_color(x11,orange).
+gv_color(x11,orange1).
+gv_color(x11,orange2).
+gv_color(x11,orange3).
+gv_color(x11,orange4).
+gv_color(x11,orangered).
+gv_color(x11,orangered1).
+gv_color(x11,orangered2).
+gv_color(x11,orangered3).
+gv_color(x11,orangered4).
+gv_color(x11,orchid).
+gv_color(x11,orchid1).
+gv_color(x11,orchid2).
+gv_color(x11,orchid3).
+gv_color(x11,orchid4).
+gv_color(x11,palegoldenrod).
+gv_color(x11,palegreen).
+gv_color(x11,palegreen1).
+gv_color(x11,palegreen2).
+gv_color(x11,palegreen3).
+gv_color(x11,palegreen4).
+gv_color(x11,paleturquoise).
+gv_color(x11,paleturquoise1).
+gv_color(x11,paleturquoise2).
+gv_color(x11,paleturquoise3).
+gv_color(x11,paleturquoise4).
+gv_color(x11,palevioletred).
+gv_color(x11,palevioletred1).
+gv_color(x11,palevioletred2).
+gv_color(x11,palevioletred3).
+gv_color(x11,palevioletred4).
+gv_color(x11,papayawhip).
+gv_color(x11,peachpuff).
+gv_color(x11,peachpuff1).
+gv_color(x11,peachpuff2).
+gv_color(x11,peachpuff3).
+gv_color(x11,peachpuff4).
+gv_color(x11,peru).
+gv_color(x11,pink).
+gv_color(x11,pink1).
+gv_color(x11,pink2).
+gv_color(x11,pink3).
+gv_color(x11,pink4).
+gv_color(x11,plum).
+gv_color(x11,plum1).
+gv_color(x11,plum2).
+gv_color(x11,plum3).
+gv_color(x11,plum4).
+gv_color(x11,powderblue).
+gv_color(x11,purple).
+gv_color(x11,purple1).
+gv_color(x11,purple2).
+gv_color(x11,purple3).
+gv_color(x11,purple4).
+gv_color(x11,red).
+gv_color(x11,red1).
+gv_color(x11,red2).
+gv_color(x11,red3).
+gv_color(x11,red4).
+gv_color(x11,rosybrown).
+gv_color(x11,rosybrown1).
+gv_color(x11,rosybrown2).
+gv_color(x11,rosybrown3).
+gv_color(x11,rosybrown4).
+gv_color(x11,royalblue).
+gv_color(x11,royalblue1).
+gv_color(x11,royalblue2).
+gv_color(x11,royalblue3).
+gv_color(x11,royalblue4).
+gv_color(x11,saddlebrown).
+gv_color(x11,salmon).
+gv_color(x11,salmon1).
+gv_color(x11,salmon2).
+gv_color(x11,salmon3).
+gv_color(x11,salmon4).
+gv_color(x11,sandybrown).
+gv_color(x11,seagreen).
+gv_color(x11,seagreen1).
+gv_color(x11,seagreen2).
+gv_color(x11,seagreen3).
+gv_color(x11,seagreen4).
+gv_color(x11,seashell).
+gv_color(x11,seashell1).
+gv_color(x11,seashell2).
+gv_color(x11,seashell3).
+gv_color(x11,seashell4).
+gv_color(x11,sienna).
+gv_color(x11,sienna1).
+gv_color(x11,sienna2).
+gv_color(x11,sienna3).
+gv_color(x11,sienna4).
+gv_color(x11,skyblue).
+gv_color(x11,skyblue1).
+gv_color(x11,skyblue2).
+gv_color(x11,skyblue3).
+gv_color(x11,skyblue4).
+gv_color(x11,slateblue).
+gv_color(x11,slateblue1).
+gv_color(x11,slateblue2).
+gv_color(x11,slateblue3).
+gv_color(x11,slateblue4).
+gv_color(x11,slategray).
+gv_color(x11,slategray1).
+gv_color(x11,slategray2).
+gv_color(x11,slategray3).
+gv_color(x11,slategray4).
+gv_color(x11,slategrey).
+gv_color(x11,snow).
+gv_color(x11,snow1).
+gv_color(x11,snow2).
+gv_color(x11,snow3).
+gv_color(x11,snow4).
+gv_color(x11,springgreen).
+gv_color(x11,springgreen1).
+gv_color(x11,springgreen2).
+gv_color(x11,springgreen3).
+gv_color(x11,springgreen4).
+gv_color(x11,steelblue).
+gv_color(x11,steelblue1).
+gv_color(x11,steelblue2).
+gv_color(x11,steelblue3).
+gv_color(x11,steelblue4).
+gv_color(x11,tan).
+gv_color(x11,tan1).
+gv_color(x11,tan2).
+gv_color(x11,tan3).
+gv_color(x11,tan4).
+gv_color(x11,thistle).
+gv_color(x11,thistle1).
+gv_color(x11,thistle2).
+gv_color(x11,thistle3).
+gv_color(x11,thistle4).
+gv_color(x11,tomato).
+gv_color(x11,tomato1).
+gv_color(x11,tomato2).
+gv_color(x11,tomato3).
+gv_color(x11,tomato4).
+gv_color(x11,transparent).
+gv_color(x11,turquoise).
+gv_color(x11,turquoise1).
+gv_color(x11,turquoise2).
+gv_color(x11,turquoise3).
+gv_color(x11,turquoise4).
+gv_color(x11,violet).
+gv_color(x11,violetred).
+gv_color(x11,violetred1).
+gv_color(x11,violetred2).
+gv_color(x11,violetred3).
+gv_color(x11,violetred4).
+gv_color(x11,wheat).
+gv_color(x11,wheat1).
+gv_color(x11,wheat2).
+gv_color(x11,wheat3).
+gv_color(x11,wheat4).
+gv_color(x11,white).
+gv_color(x11,whitesmoke).
+gv_color(x11,yellow).
+gv_color(x11,yellow1).
+gv_color(x11,yellow2).
+gv_color(x11,yellow3).
+gv_color(x11,yellow4).
+gv_color(x11,yellowgreen).
+gv_color(svg,aliceblue).
+gv_color(svg,antiquewhite).
+gv_color(svg,aqua).
+gv_color(svg,aquamarine).
+gv_color(svg,azure).
+gv_color(svg,beige).
+gv_color(svg,bisque).
+gv_color(svg,black).
+gv_color(svg,blanchedalmond).
+gv_color(svg,blue).
+gv_color(svg,blueviolet).
+gv_color(svg,brown).
+gv_color(svg,burlywood).
+gv_color(svg,cadetblue).
+gv_color(svg,chartreuse).
+gv_color(svg,chocolate).
+gv_color(svg,coral).
+gv_color(svg,cornflowerblue).
+gv_color(svg,cornsilk).
+gv_color(svg,crimson).
+gv_color(svg,cyan).
+gv_color(svg,darkblue).
+gv_color(svg,darkcyan).
+gv_color(svg,darkgoldenrod).
+gv_color(svg,darkgray).
+gv_color(svg,darkgreen).
+gv_color(svg,darkgrey).
+gv_color(svg,darkkhaki).
+gv_color(svg,darkmagenta).
+gv_color(svg,darkolivegreen).
+gv_color(svg,darkorange).
+gv_color(svg,darkorchid).
+gv_color(svg,darkred).
+gv_color(svg,darksalmon).
+gv_color(svg,darkseagreen).
+gv_color(svg,darkslateblue).
+gv_color(svg,darkslategray).
+gv_color(svg,darkslategrey).
+gv_color(svg,darkturquoise).
+gv_color(svg,darkviolet).
+gv_color(svg,deeppink).
+gv_color(svg,deepskyblue).
+gv_color(svg,dimgray).
+gv_color(svg,dimgrey).
+gv_color(svg,dodgerblue).
+gv_color(svg,firebrick).
+gv_color(svg,floralwhite).
+gv_color(svg,forestgreen).
+gv_color(svg,fuchsia).
+gv_color(svg,gainsboro).
+gv_color(svg,ghostwhite).
+gv_color(svg,gold).
+gv_color(svg,goldenrod).
+gv_color(svg,gray).
+gv_color(svg,grey).
+gv_color(svg,green).
+gv_color(svg,greenyellow).
+gv_color(svg,honeydew).
+gv_color(svg,hotpink).
+gv_color(svg,indianred).
+gv_color(svg,indigo).
+gv_color(svg,ivory).
+gv_color(svg,khaki).
+gv_color(svg,lavender).
+gv_color(svg,lavenderblush).
+gv_color(svg,lawngreen).
+gv_color(svg,lemonchiffon).
+gv_color(svg,lightblue).
+gv_color(svg,lightcoral).
+gv_color(svg,lightcyan).
+gv_color(svg,lightgoldenrodyellow).
+gv_color(svg,lightgray).
+gv_color(svg,lightgreen).
+gv_color(svg,lightgrey).
+gv_color(svg,lightpink).
+gv_color(svg,lightsalmon).
+gv_color(svg,lightseagreen).
+gv_color(svg,lightskyblue).
+gv_color(svg,lightslategray).
+gv_color(svg,lightslategrey).
+gv_color(svg,lightsteelblue).
+gv_color(svg,lightyellow).
+gv_color(svg,lime).
+gv_color(svg,limegreen).
+gv_color(svg,linen).
+gv_color(svg,magenta).
+gv_color(svg,maroon).
+gv_color(svg,mediumaquamarine).
+gv_color(svg,mediumblue).
+gv_color(svg,mediumorchid).
+gv_color(svg,mediumpurple).
+gv_color(svg,mediumseagreen).
+gv_color(svg,mediumslateblue).
+gv_color(svg,mediumspringgreen).
+gv_color(svg,mediumturquoise).
+gv_color(svg,mediumvioletred).
+gv_color(svg,midnightblue).
+gv_color(svg,mintcream).
+gv_color(svg,mistyrose).
+gv_color(svg,moccasin).
+gv_color(svg,navajowhite).
+gv_color(svg,navy).
+gv_color(svg,oldlace).
+gv_color(svg,olive).
+gv_color(svg,olivedrab).
+gv_color(svg,orange).
+gv_color(svg,orangered).
+gv_color(svg,orchid).
+gv_color(svg,palegoldenrod).
+gv_color(svg,palegreen).
+gv_color(svg,paleturquoise).
+gv_color(svg,palevioletred).
+gv_color(svg,papayawhip).
+gv_color(svg,peachpuff).
+gv_color(svg,peru).
+gv_color(svg,pink).
+gv_color(svg,plum).
+gv_color(svg,powderblue).
+gv_color(svg,purple).
+gv_color(svg,red).
+gv_color(svg,rosybrown).
+gv_color(svg,royalblue).
+gv_color(svg,saddlebrown).
+gv_color(svg,salmon).
+gv_color(svg,sandybrown).
+gv_color(svg,seagreen).
+gv_color(svg,seashell).
+gv_color(svg,sienna).
+gv_color(svg,silver).
+gv_color(svg,skyblue).
+gv_color(svg,slateblue).
+gv_color(svg,slategray).
+gv_color(svg,slategrey).
+gv_color(svg,snow).
+gv_color(svg,springgreen).
+gv_color(svg,steelblue).
+gv_color(svg,tan).
+gv_color(svg,teal).
+gv_color(svg,thistle).
+gv_color(svg,tomato).
+gv_color(svg,turquoise).
+gv_color(svg,violet).
+gv_color(svg,wheat).
+gv_color(svg,white).
+gv_color(svg,whitesmoke).
+gv_color(svg,yellow).
+gv_color(svg,yellowgreen).
diff --git a/prolog/gv/gv_color.log b/prolog/gv/gv_color.log
deleted file mode 100644
index 23d6cdf..0000000
--- a/prolog/gv/gv_color.log
+++ /dev/null
@@ -1,802 +0,0 @@
-assert(gv_color(x11,aliceblue)).
-assert(gv_color(x11,antiquewhite)).
-assert(gv_color(x11,antiquewhite1)).
-assert(gv_color(x11,antiquewhite2)).
-assert(gv_color(x11,antiquewhite3)).
-assert(gv_color(x11,antiquewhite4)).
-assert(gv_color(x11,aquamarine)).
-assert(gv_color(x11,aquamarine1)).
-assert(gv_color(x11,aquamarine2)).
-assert(gv_color(x11,aquamarine3)).
-assert(gv_color(x11,aquamarine4)).
-assert(gv_color(x11,azure)).
-assert(gv_color(x11,azure1)).
-assert(gv_color(x11,azure2)).
-assert(gv_color(x11,azure3)).
-assert(gv_color(x11,azure4)).
-assert(gv_color(x11,beige)).
-assert(gv_color(x11,bisque)).
-assert(gv_color(x11,bisque1)).
-assert(gv_color(x11,bisque2)).
-assert(gv_color(x11,bisque3)).
-assert(gv_color(x11,bisque4)).
-assert(gv_color(x11,black)).
-assert(gv_color(x11,blanchedalmond)).
-assert(gv_color(x11,blue)).
-assert(gv_color(x11,blue1)).
-assert(gv_color(x11,blue2)).
-assert(gv_color(x11,blue3)).
-assert(gv_color(x11,blue4)).
-assert(gv_color(x11,blueviolet)).
-assert(gv_color(x11,brown)).
-assert(gv_color(x11,brown1)).
-assert(gv_color(x11,brown2)).
-assert(gv_color(x11,brown3)).
-assert(gv_color(x11,brown4)).
-assert(gv_color(x11,burlywood)).
-assert(gv_color(x11,burlywood1)).
-assert(gv_color(x11,burlywood2)).
-assert(gv_color(x11,burlywood3)).
-assert(gv_color(x11,burlywood4)).
-assert(gv_color(x11,cadetblue)).
-assert(gv_color(x11,cadetblue1)).
-assert(gv_color(x11,cadetblue2)).
-assert(gv_color(x11,cadetblue3)).
-assert(gv_color(x11,cadetblue4)).
-assert(gv_color(x11,chartreuse)).
-assert(gv_color(x11,chartreuse1)).
-assert(gv_color(x11,chartreuse2)).
-assert(gv_color(x11,chartreuse3)).
-assert(gv_color(x11,chartreuse4)).
-assert(gv_color(x11,chocolate)).
-assert(gv_color(x11,chocolate1)).
-assert(gv_color(x11,chocolate2)).
-assert(gv_color(x11,chocolate3)).
-assert(gv_color(x11,chocolate4)).
-assert(gv_color(x11,coral)).
-assert(gv_color(x11,coral1)).
-assert(gv_color(x11,coral2)).
-assert(gv_color(x11,coral3)).
-assert(gv_color(x11,coral4)).
-assert(gv_color(x11,cornflowerblue)).
-assert(gv_color(x11,cornsilk)).
-assert(gv_color(x11,cornsilk1)).
-assert(gv_color(x11,cornsilk2)).
-assert(gv_color(x11,cornsilk3)).
-assert(gv_color(x11,cornsilk4)).
-assert(gv_color(x11,crimson)).
-assert(gv_color(x11,cyan)).
-assert(gv_color(x11,cyan1)).
-assert(gv_color(x11,cyan2)).
-assert(gv_color(x11,cyan3)).
-assert(gv_color(x11,cyan4)).
-assert(gv_color(x11,darkgoldenrod)).
-assert(gv_color(x11,darkgoldenrod1)).
-assert(gv_color(x11,darkgoldenrod2)).
-assert(gv_color(x11,darkgoldenrod3)).
-assert(gv_color(x11,darkgoldenrod4)).
-assert(gv_color(x11,darkgreen)).
-assert(gv_color(x11,darkkhaki)).
-assert(gv_color(x11,darkolivegreen)).
-assert(gv_color(x11,darkolivegreen1)).
-assert(gv_color(x11,darkolivegreen2)).
-assert(gv_color(x11,darkolivegreen3)).
-assert(gv_color(x11,darkolivegreen4)).
-assert(gv_color(x11,darkorange)).
-assert(gv_color(x11,darkorange1)).
-assert(gv_color(x11,darkorange2)).
-assert(gv_color(x11,darkorange3)).
-assert(gv_color(x11,darkorange4)).
-assert(gv_color(x11,darkorchid)).
-assert(gv_color(x11,darkorchid1)).
-assert(gv_color(x11,darkorchid2)).
-assert(gv_color(x11,darkorchid3)).
-assert(gv_color(x11,darkorchid4)).
-assert(gv_color(x11,darksalmon)).
-assert(gv_color(x11,darkseagreen)).
-assert(gv_color(x11,darkseagreen1)).
-assert(gv_color(x11,darkseagreen2)).
-assert(gv_color(x11,darkseagreen3)).
-assert(gv_color(x11,darkseagreen4)).
-assert(gv_color(x11,darkslateblue)).
-assert(gv_color(x11,darkslategray)).
-assert(gv_color(x11,darkslategray1)).
-assert(gv_color(x11,darkslategray2)).
-assert(gv_color(x11,darkslategray3)).
-assert(gv_color(x11,darkslategray4)).
-assert(gv_color(x11,darkslategrey)).
-assert(gv_color(x11,darkturquoise)).
-assert(gv_color(x11,darkviolet)).
-assert(gv_color(x11,deeppink)).
-assert(gv_color(x11,deeppink1)).
-assert(gv_color(x11,deeppink2)).
-assert(gv_color(x11,deeppink3)).
-assert(gv_color(x11,deeppink4)).
-assert(gv_color(x11,deepskyblue)).
-assert(gv_color(x11,deepskyblue1)).
-assert(gv_color(x11,deepskyblue2)).
-assert(gv_color(x11,deepskyblue3)).
-assert(gv_color(x11,deepskyblue4)).
-assert(gv_color(x11,dimgray)).
-assert(gv_color(x11,dimgrey)).
-assert(gv_color(x11,dodgerblue)).
-assert(gv_color(x11,dodgerblue1)).
-assert(gv_color(x11,dodgerblue2)).
-assert(gv_color(x11,dodgerblue3)).
-assert(gv_color(x11,dodgerblue4)).
-assert(gv_color(x11,firebrick)).
-assert(gv_color(x11,firebrick1)).
-assert(gv_color(x11,firebrick2)).
-assert(gv_color(x11,firebrick3)).
-assert(gv_color(x11,firebrick4)).
-assert(gv_color(x11,floralwhite)).
-assert(gv_color(x11,forestgreen)).
-assert(gv_color(x11,gainsboro)).
-assert(gv_color(x11,ghostwhite)).
-assert(gv_color(x11,gold)).
-assert(gv_color(x11,gold1)).
-assert(gv_color(x11,gold2)).
-assert(gv_color(x11,gold3)).
-assert(gv_color(x11,gold4)).
-assert(gv_color(x11,goldenrod)).
-assert(gv_color(x11,goldenrod1)).
-assert(gv_color(x11,goldenrod2)).
-assert(gv_color(x11,goldenrod3)).
-assert(gv_color(x11,goldenrod4)).
-assert(gv_color(x11,gray)).
-assert(gv_color(x11,gray0)).
-assert(gv_color(x11,gray1)).
-assert(gv_color(x11,gray10)).
-assert(gv_color(x11,gray100)).
-assert(gv_color(x11,gray11)).
-assert(gv_color(x11,gray12)).
-assert(gv_color(x11,gray13)).
-assert(gv_color(x11,gray14)).
-assert(gv_color(x11,gray15)).
-assert(gv_color(x11,gray16)).
-assert(gv_color(x11,gray17)).
-assert(gv_color(x11,gray18)).
-assert(gv_color(x11,gray19)).
-assert(gv_color(x11,gray2)).
-assert(gv_color(x11,gray20)).
-assert(gv_color(x11,gray21)).
-assert(gv_color(x11,gray22)).
-assert(gv_color(x11,gray23)).
-assert(gv_color(x11,gray24)).
-assert(gv_color(x11,gray25)).
-assert(gv_color(x11,gray26)).
-assert(gv_color(x11,gray27)).
-assert(gv_color(x11,gray28)).
-assert(gv_color(x11,gray29)).
-assert(gv_color(x11,gray3)).
-assert(gv_color(x11,gray30)).
-assert(gv_color(x11,gray31)).
-assert(gv_color(x11,gray32)).
-assert(gv_color(x11,gray33)).
-assert(gv_color(x11,gray34)).
-assert(gv_color(x11,gray35)).
-assert(gv_color(x11,gray36)).
-assert(gv_color(x11,gray37)).
-assert(gv_color(x11,gray38)).
-assert(gv_color(x11,gray39)).
-assert(gv_color(x11,gray4)).
-assert(gv_color(x11,gray40)).
-assert(gv_color(x11,gray41)).
-assert(gv_color(x11,gray42)).
-assert(gv_color(x11,gray43)).
-assert(gv_color(x11,gray44)).
-assert(gv_color(x11,gray45)).
-assert(gv_color(x11,gray46)).
-assert(gv_color(x11,gray47)).
-assert(gv_color(x11,gray48)).
-assert(gv_color(x11,gray49)).
-assert(gv_color(x11,gray5)).
-assert(gv_color(x11,gray50)).
-assert(gv_color(x11,gray51)).
-assert(gv_color(x11,gray52)).
-assert(gv_color(x11,gray53)).
-assert(gv_color(x11,gray54)).
-assert(gv_color(x11,gray55)).
-assert(gv_color(x11,gray56)).
-assert(gv_color(x11,gray57)).
-assert(gv_color(x11,gray58)).
-assert(gv_color(x11,gray59)).
-assert(gv_color(x11,gray6)).
-assert(gv_color(x11,gray60)).
-assert(gv_color(x11,gray61)).
-assert(gv_color(x11,gray62)).
-assert(gv_color(x11,gray63)).
-assert(gv_color(x11,gray64)).
-assert(gv_color(x11,gray65)).
-assert(gv_color(x11,gray66)).
-assert(gv_color(x11,gray67)).
-assert(gv_color(x11,gray68)).
-assert(gv_color(x11,gray69)).
-assert(gv_color(x11,gray7)).
-assert(gv_color(x11,gray70)).
-assert(gv_color(x11,gray71)).
-assert(gv_color(x11,gray72)).
-assert(gv_color(x11,gray73)).
-assert(gv_color(x11,gray74)).
-assert(gv_color(x11,gray75)).
-assert(gv_color(x11,gray76)).
-assert(gv_color(x11,gray77)).
-assert(gv_color(x11,gray78)).
-assert(gv_color(x11,gray79)).
-assert(gv_color(x11,gray8)).
-assert(gv_color(x11,gray80)).
-assert(gv_color(x11,gray81)).
-assert(gv_color(x11,gray82)).
-assert(gv_color(x11,gray83)).
-assert(gv_color(x11,gray84)).
-assert(gv_color(x11,gray85)).
-assert(gv_color(x11,gray86)).
-assert(gv_color(x11,gray87)).
-assert(gv_color(x11,gray88)).
-assert(gv_color(x11,gray89)).
-assert(gv_color(x11,gray9)).
-assert(gv_color(x11,gray90)).
-assert(gv_color(x11,gray91)).
-assert(gv_color(x11,gray92)).
-assert(gv_color(x11,gray93)).
-assert(gv_color(x11,gray94)).
-assert(gv_color(x11,gray95)).
-assert(gv_color(x11,gray96)).
-assert(gv_color(x11,gray97)).
-assert(gv_color(x11,gray98)).
-assert(gv_color(x11,gray99)).
-assert(gv_color(x11,green)).
-assert(gv_color(x11,green1)).
-assert(gv_color(x11,green2)).
-assert(gv_color(x11,green3)).
-assert(gv_color(x11,green4)).
-assert(gv_color(x11,greenyellow)).
-assert(gv_color(x11,grey)).
-assert(gv_color(x11,grey0)).
-assert(gv_color(x11,grey1)).
-assert(gv_color(x11,grey10)).
-assert(gv_color(x11,grey100)).
-assert(gv_color(x11,grey11)).
-assert(gv_color(x11,grey12)).
-assert(gv_color(x11,grey13)).
-assert(gv_color(x11,grey14)).
-assert(gv_color(x11,grey15)).
-assert(gv_color(x11,grey16)).
-assert(gv_color(x11,grey17)).
-assert(gv_color(x11,grey18)).
-assert(gv_color(x11,grey19)).
-assert(gv_color(x11,grey2)).
-assert(gv_color(x11,grey20)).
-assert(gv_color(x11,grey21)).
-assert(gv_color(x11,grey22)).
-assert(gv_color(x11,grey23)).
-assert(gv_color(x11,grey24)).
-assert(gv_color(x11,grey25)).
-assert(gv_color(x11,grey26)).
-assert(gv_color(x11,grey27)).
-assert(gv_color(x11,grey28)).
-assert(gv_color(x11,grey29)).
-assert(gv_color(x11,grey3)).
-assert(gv_color(x11,grey30)).
-assert(gv_color(x11,grey31)).
-assert(gv_color(x11,grey32)).
-assert(gv_color(x11,grey33)).
-assert(gv_color(x11,grey34)).
-assert(gv_color(x11,grey35)).
-assert(gv_color(x11,grey36)).
-assert(gv_color(x11,grey37)).
-assert(gv_color(x11,grey38)).
-assert(gv_color(x11,grey39)).
-assert(gv_color(x11,grey4)).
-assert(gv_color(x11,grey40)).
-assert(gv_color(x11,grey41)).
-assert(gv_color(x11,grey42)).
-assert(gv_color(x11,grey43)).
-assert(gv_color(x11,grey44)).
-assert(gv_color(x11,grey45)).
-assert(gv_color(x11,grey46)).
-assert(gv_color(x11,grey47)).
-assert(gv_color(x11,grey48)).
-assert(gv_color(x11,grey49)).
-assert(gv_color(x11,grey5)).
-assert(gv_color(x11,grey50)).
-assert(gv_color(x11,grey51)).
-assert(gv_color(x11,grey52)).
-assert(gv_color(x11,grey53)).
-assert(gv_color(x11,grey54)).
-assert(gv_color(x11,grey55)).
-assert(gv_color(x11,grey56)).
-assert(gv_color(x11,grey57)).
-assert(gv_color(x11,grey58)).
-assert(gv_color(x11,grey59)).
-assert(gv_color(x11,grey6)).
-assert(gv_color(x11,grey60)).
-assert(gv_color(x11,grey61)).
-assert(gv_color(x11,grey62)).
-assert(gv_color(x11,grey63)).
-assert(gv_color(x11,grey64)).
-assert(gv_color(x11,grey65)).
-assert(gv_color(x11,grey66)).
-assert(gv_color(x11,grey67)).
-assert(gv_color(x11,grey68)).
-assert(gv_color(x11,grey69)).
-assert(gv_color(x11,grey7)).
-assert(gv_color(x11,grey70)).
-assert(gv_color(x11,grey71)).
-assert(gv_color(x11,grey72)).
-assert(gv_color(x11,grey73)).
-assert(gv_color(x11,grey74)).
-assert(gv_color(x11,grey75)).
-assert(gv_color(x11,grey76)).
-assert(gv_color(x11,grey77)).
-assert(gv_color(x11,grey78)).
-assert(gv_color(x11,grey79)).
-assert(gv_color(x11,grey8)).
-assert(gv_color(x11,grey80)).
-assert(gv_color(x11,grey81)).
-assert(gv_color(x11,grey82)).
-assert(gv_color(x11,grey83)).
-assert(gv_color(x11,grey84)).
-assert(gv_color(x11,grey85)).
-assert(gv_color(x11,grey86)).
-assert(gv_color(x11,grey87)).
-assert(gv_color(x11,grey88)).
-assert(gv_color(x11,grey89)).
-assert(gv_color(x11,grey9)).
-assert(gv_color(x11,grey90)).
-assert(gv_color(x11,grey91)).
-assert(gv_color(x11,grey92)).
-assert(gv_color(x11,grey93)).
-assert(gv_color(x11,grey94)).
-assert(gv_color(x11,grey95)).
-assert(gv_color(x11,grey96)).
-assert(gv_color(x11,grey97)).
-assert(gv_color(x11,grey98)).
-assert(gv_color(x11,grey99)).
-assert(gv_color(x11,honeydew)).
-assert(gv_color(x11,honeydew1)).
-assert(gv_color(x11,honeydew2)).
-assert(gv_color(x11,honeydew3)).
-assert(gv_color(x11,honeydew4)).
-assert(gv_color(x11,hotpink)).
-assert(gv_color(x11,hotpink1)).
-assert(gv_color(x11,hotpink2)).
-assert(gv_color(x11,hotpink3)).
-assert(gv_color(x11,hotpink4)).
-assert(gv_color(x11,indianred)).
-assert(gv_color(x11,indianred1)).
-assert(gv_color(x11,indianred2)).
-assert(gv_color(x11,indianred3)).
-assert(gv_color(x11,indianred4)).
-assert(gv_color(x11,indigo)).
-assert(gv_color(x11,invis)).
-assert(gv_color(x11,ivory)).
-assert(gv_color(x11,ivory1)).
-assert(gv_color(x11,ivory2)).
-assert(gv_color(x11,ivory3)).
-assert(gv_color(x11,ivory4)).
-assert(gv_color(x11,khaki)).
-assert(gv_color(x11,khaki1)).
-assert(gv_color(x11,khaki2)).
-assert(gv_color(x11,khaki3)).
-assert(gv_color(x11,khaki4)).
-assert(gv_color(x11,lavender)).
-assert(gv_color(x11,lavenderblush)).
-assert(gv_color(x11,lavenderblush1)).
-assert(gv_color(x11,lavenderblush2)).
-assert(gv_color(x11,lavenderblush3)).
-assert(gv_color(x11,lavenderblush4)).
-assert(gv_color(x11,lawngreen)).
-assert(gv_color(x11,lemonchiffon)).
-assert(gv_color(x11,lemonchiffon1)).
-assert(gv_color(x11,lemonchiffon2)).
-assert(gv_color(x11,lemonchiffon3)).
-assert(gv_color(x11,lemonchiffon4)).
-assert(gv_color(x11,lightblue)).
-assert(gv_color(x11,lightblue1)).
-assert(gv_color(x11,lightblue2)).
-assert(gv_color(x11,lightblue3)).
-assert(gv_color(x11,lightblue4)).
-assert(gv_color(x11,lightcoral)).
-assert(gv_color(x11,lightcyan)).
-assert(gv_color(x11,lightcyan1)).
-assert(gv_color(x11,lightcyan2)).
-assert(gv_color(x11,lightcyan3)).
-assert(gv_color(x11,lightcyan4)).
-assert(gv_color(x11,lightgoldenrod)).
-assert(gv_color(x11,lightgoldenrod1)).
-assert(gv_color(x11,lightgoldenrod2)).
-assert(gv_color(x11,lightgoldenrod3)).
-assert(gv_color(x11,lightgoldenrod4)).
-assert(gv_color(x11,lightgoldenrodyellow)).
-assert(gv_color(x11,lightgray)).
-assert(gv_color(x11,lightgrey)).
-assert(gv_color(x11,lightpink)).
-assert(gv_color(x11,lightpink1)).
-assert(gv_color(x11,lightpink2)).
-assert(gv_color(x11,lightpink3)).
-assert(gv_color(x11,lightpink4)).
-assert(gv_color(x11,lightsalmon)).
-assert(gv_color(x11,lightsalmon1)).
-assert(gv_color(x11,lightsalmon2)).
-assert(gv_color(x11,lightsalmon3)).
-assert(gv_color(x11,lightsalmon4)).
-assert(gv_color(x11,lightseagreen)).
-assert(gv_color(x11,lightskyblue)).
-assert(gv_color(x11,lightskyblue1)).
-assert(gv_color(x11,lightskyblue2)).
-assert(gv_color(x11,lightskyblue3)).
-assert(gv_color(x11,lightskyblue4)).
-assert(gv_color(x11,lightslateblue)).
-assert(gv_color(x11,lightslategray)).
-assert(gv_color(x11,lightslategrey)).
-assert(gv_color(x11,lightsteelblue)).
-assert(gv_color(x11,lightsteelblue1)).
-assert(gv_color(x11,lightsteelblue2)).
-assert(gv_color(x11,lightsteelblue3)).
-assert(gv_color(x11,lightsteelblue4)).
-assert(gv_color(x11,lightyellow)).
-assert(gv_color(x11,lightyellow1)).
-assert(gv_color(x11,lightyellow2)).
-assert(gv_color(x11,lightyellow3)).
-assert(gv_color(x11,lightyellow4)).
-assert(gv_color(x11,limegreen)).
-assert(gv_color(x11,linen)).
-assert(gv_color(x11,magenta)).
-assert(gv_color(x11,magenta1)).
-assert(gv_color(x11,magenta2)).
-assert(gv_color(x11,magenta3)).
-assert(gv_color(x11,magenta4)).
-assert(gv_color(x11,maroon)).
-assert(gv_color(x11,maroon1)).
-assert(gv_color(x11,maroon2)).
-assert(gv_color(x11,maroon3)).
-assert(gv_color(x11,maroon4)).
-assert(gv_color(x11,mediumaquamarine)).
-assert(gv_color(x11,mediumblue)).
-assert(gv_color(x11,mediumorchid)).
-assert(gv_color(x11,mediumorchid1)).
-assert(gv_color(x11,mediumorchid2)).
-assert(gv_color(x11,mediumorchid3)).
-assert(gv_color(x11,mediumorchid4)).
-assert(gv_color(x11,mediumpurple)).
-assert(gv_color(x11,mediumpurple1)).
-assert(gv_color(x11,mediumpurple2)).
-assert(gv_color(x11,mediumpurple3)).
-assert(gv_color(x11,mediumpurple4)).
-assert(gv_color(x11,mediumseagreen)).
-assert(gv_color(x11,mediumslateblue)).
-assert(gv_color(x11,mediumspringgreen)).
-assert(gv_color(x11,mediumturquoise)).
-assert(gv_color(x11,mediumvioletred)).
-assert(gv_color(x11,midnightblue)).
-assert(gv_color(x11,mintcream)).
-assert(gv_color(x11,mistyrose)).
-assert(gv_color(x11,mistyrose1)).
-assert(gv_color(x11,mistyrose2)).
-assert(gv_color(x11,mistyrose3)).
-assert(gv_color(x11,mistyrose4)).
-assert(gv_color(x11,moccasin)).
-assert(gv_color(x11,navajowhite)).
-assert(gv_color(x11,navajowhite1)).
-assert(gv_color(x11,navajowhite2)).
-assert(gv_color(x11,navajowhite3)).
-assert(gv_color(x11,navajowhite4)).
-assert(gv_color(x11,navy)).
-assert(gv_color(x11,navyblue)).
-assert(gv_color(x11,none)).
-assert(gv_color(x11,oldlace)).
-assert(gv_color(x11,olivedrab)).
-assert(gv_color(x11,olivedrab1)).
-assert(gv_color(x11,olivedrab2)).
-assert(gv_color(x11,olivedrab3)).
-assert(gv_color(x11,olivedrab4)).
-assert(gv_color(x11,orange)).
-assert(gv_color(x11,orange1)).
-assert(gv_color(x11,orange2)).
-assert(gv_color(x11,orange3)).
-assert(gv_color(x11,orange4)).
-assert(gv_color(x11,orangered)).
-assert(gv_color(x11,orangered1)).
-assert(gv_color(x11,orangered2)).
-assert(gv_color(x11,orangered3)).
-assert(gv_color(x11,orangered4)).
-assert(gv_color(x11,orchid)).
-assert(gv_color(x11,orchid1)).
-assert(gv_color(x11,orchid2)).
-assert(gv_color(x11,orchid3)).
-assert(gv_color(x11,orchid4)).
-assert(gv_color(x11,palegoldenrod)).
-assert(gv_color(x11,palegreen)).
-assert(gv_color(x11,palegreen1)).
-assert(gv_color(x11,palegreen2)).
-assert(gv_color(x11,palegreen3)).
-assert(gv_color(x11,palegreen4)).
-assert(gv_color(x11,paleturquoise)).
-assert(gv_color(x11,paleturquoise1)).
-assert(gv_color(x11,paleturquoise2)).
-assert(gv_color(x11,paleturquoise3)).
-assert(gv_color(x11,paleturquoise4)).
-assert(gv_color(x11,palevioletred)).
-assert(gv_color(x11,palevioletred1)).
-assert(gv_color(x11,palevioletred2)).
-assert(gv_color(x11,palevioletred3)).
-assert(gv_color(x11,palevioletred4)).
-assert(gv_color(x11,papayawhip)).
-assert(gv_color(x11,peachpuff)).
-assert(gv_color(x11,peachpuff1)).
-assert(gv_color(x11,peachpuff2)).
-assert(gv_color(x11,peachpuff3)).
-assert(gv_color(x11,peachpuff4)).
-assert(gv_color(x11,peru)).
-assert(gv_color(x11,pink)).
-assert(gv_color(x11,pink1)).
-assert(gv_color(x11,pink2)).
-assert(gv_color(x11,pink3)).
-assert(gv_color(x11,pink4)).
-assert(gv_color(x11,plum)).
-assert(gv_color(x11,plum1)).
-assert(gv_color(x11,plum2)).
-assert(gv_color(x11,plum3)).
-assert(gv_color(x11,plum4)).
-assert(gv_color(x11,powderblue)).
-assert(gv_color(x11,purple)).
-assert(gv_color(x11,purple1)).
-assert(gv_color(x11,purple2)).
-assert(gv_color(x11,purple3)).
-assert(gv_color(x11,purple4)).
-assert(gv_color(x11,red)).
-assert(gv_color(x11,red1)).
-assert(gv_color(x11,red2)).
-assert(gv_color(x11,red3)).
-assert(gv_color(x11,red4)).
-assert(gv_color(x11,rosybrown)).
-assert(gv_color(x11,rosybrown1)).
-assert(gv_color(x11,rosybrown2)).
-assert(gv_color(x11,rosybrown3)).
-assert(gv_color(x11,rosybrown4)).
-assert(gv_color(x11,royalblue)).
-assert(gv_color(x11,royalblue1)).
-assert(gv_color(x11,royalblue2)).
-assert(gv_color(x11,royalblue3)).
-assert(gv_color(x11,royalblue4)).
-assert(gv_color(x11,saddlebrown)).
-assert(gv_color(x11,salmon)).
-assert(gv_color(x11,salmon1)).
-assert(gv_color(x11,salmon2)).
-assert(gv_color(x11,salmon3)).
-assert(gv_color(x11,salmon4)).
-assert(gv_color(x11,sandybrown)).
-assert(gv_color(x11,seagreen)).
-assert(gv_color(x11,seagreen1)).
-assert(gv_color(x11,seagreen2)).
-assert(gv_color(x11,seagreen3)).
-assert(gv_color(x11,seagreen4)).
-assert(gv_color(x11,seashell)).
-assert(gv_color(x11,seashell1)).
-assert(gv_color(x11,seashell2)).
-assert(gv_color(x11,seashell3)).
-assert(gv_color(x11,seashell4)).
-assert(gv_color(x11,sienna)).
-assert(gv_color(x11,sienna1)).
-assert(gv_color(x11,sienna2)).
-assert(gv_color(x11,sienna3)).
-assert(gv_color(x11,sienna4)).
-assert(gv_color(x11,skyblue)).
-assert(gv_color(x11,skyblue1)).
-assert(gv_color(x11,skyblue2)).
-assert(gv_color(x11,skyblue3)).
-assert(gv_color(x11,skyblue4)).
-assert(gv_color(x11,slateblue)).
-assert(gv_color(x11,slateblue1)).
-assert(gv_color(x11,slateblue2)).
-assert(gv_color(x11,slateblue3)).
-assert(gv_color(x11,slateblue4)).
-assert(gv_color(x11,slategray)).
-assert(gv_color(x11,slategray1)).
-assert(gv_color(x11,slategray2)).
-assert(gv_color(x11,slategray3)).
-assert(gv_color(x11,slategray4)).
-assert(gv_color(x11,slategrey)).
-assert(gv_color(x11,snow)).
-assert(gv_color(x11,snow1)).
-assert(gv_color(x11,snow2)).
-assert(gv_color(x11,snow3)).
-assert(gv_color(x11,snow4)).
-assert(gv_color(x11,springgreen)).
-assert(gv_color(x11,springgreen1)).
-assert(gv_color(x11,springgreen2)).
-assert(gv_color(x11,springgreen3)).
-assert(gv_color(x11,springgreen4)).
-assert(gv_color(x11,steelblue)).
-assert(gv_color(x11,steelblue1)).
-assert(gv_color(x11,steelblue2)).
-assert(gv_color(x11,steelblue3)).
-assert(gv_color(x11,steelblue4)).
-assert(gv_color(x11,tan)).
-assert(gv_color(x11,tan1)).
-assert(gv_color(x11,tan2)).
-assert(gv_color(x11,tan3)).
-assert(gv_color(x11,tan4)).
-assert(gv_color(x11,thistle)).
-assert(gv_color(x11,thistle1)).
-assert(gv_color(x11,thistle2)).
-assert(gv_color(x11,thistle3)).
-assert(gv_color(x11,thistle4)).
-assert(gv_color(x11,tomato)).
-assert(gv_color(x11,tomato1)).
-assert(gv_color(x11,tomato2)).
-assert(gv_color(x11,tomato3)).
-assert(gv_color(x11,tomato4)).
-assert(gv_color(x11,transparent)).
-assert(gv_color(x11,turquoise)).
-assert(gv_color(x11,turquoise1)).
-assert(gv_color(x11,turquoise2)).
-assert(gv_color(x11,turquoise3)).
-assert(gv_color(x11,turquoise4)).
-assert(gv_color(x11,violet)).
-assert(gv_color(x11,violetred)).
-assert(gv_color(x11,violetred1)).
-assert(gv_color(x11,violetred2)).
-assert(gv_color(x11,violetred3)).
-assert(gv_color(x11,violetred4)).
-assert(gv_color(x11,wheat)).
-assert(gv_color(x11,wheat1)).
-assert(gv_color(x11,wheat2)).
-assert(gv_color(x11,wheat3)).
-assert(gv_color(x11,wheat4)).
-assert(gv_color(x11,white)).
-assert(gv_color(x11,whitesmoke)).
-assert(gv_color(x11,yellow)).
-assert(gv_color(x11,yellow1)).
-assert(gv_color(x11,yellow2)).
-assert(gv_color(x11,yellow3)).
-assert(gv_color(x11,yellow4)).
-assert(gv_color(x11,yellowgreen)).
-assert(gv_color(svg,aliceblue)).
-assert(gv_color(svg,antiquewhite)).
-assert(gv_color(svg,aqua)).
-assert(gv_color(svg,aquamarine)).
-assert(gv_color(svg,azure)).
-assert(gv_color(svg,beige)).
-assert(gv_color(svg,bisque)).
-assert(gv_color(svg,black)).
-assert(gv_color(svg,blanchedalmond)).
-assert(gv_color(svg,blue)).
-assert(gv_color(svg,blueviolet)).
-assert(gv_color(svg,brown)).
-assert(gv_color(svg,burlywood)).
-assert(gv_color(svg,cadetblue)).
-assert(gv_color(svg,chartreuse)).
-assert(gv_color(svg,chocolate)).
-assert(gv_color(svg,coral)).
-assert(gv_color(svg,cornflowerblue)).
-assert(gv_color(svg,cornsilk)).
-assert(gv_color(svg,crimson)).
-assert(gv_color(svg,cyan)).
-assert(gv_color(svg,darkblue)).
-assert(gv_color(svg,darkcyan)).
-assert(gv_color(svg,darkgoldenrod)).
-assert(gv_color(svg,darkgray)).
-assert(gv_color(svg,darkgreen)).
-assert(gv_color(svg,darkgrey)).
-assert(gv_color(svg,darkkhaki)).
-assert(gv_color(svg,darkmagenta)).
-assert(gv_color(svg,darkolivegreen)).
-assert(gv_color(svg,darkorange)).
-assert(gv_color(svg,darkorchid)).
-assert(gv_color(svg,darkred)).
-assert(gv_color(svg,darksalmon)).
-assert(gv_color(svg,darkseagreen)).
-assert(gv_color(svg,darkslateblue)).
-assert(gv_color(svg,darkslategray)).
-assert(gv_color(svg,darkslategrey)).
-assert(gv_color(svg,darkturquoise)).
-assert(gv_color(svg,darkviolet)).
-assert(gv_color(svg,deeppink)).
-assert(gv_color(svg,deepskyblue)).
-assert(gv_color(svg,dimgray)).
-assert(gv_color(svg,dimgrey)).
-assert(gv_color(svg,dodgerblue)).
-assert(gv_color(svg,firebrick)).
-assert(gv_color(svg,floralwhite)).
-assert(gv_color(svg,forestgreen)).
-assert(gv_color(svg,fuchsia)).
-assert(gv_color(svg,gainsboro)).
-assert(gv_color(svg,ghostwhite)).
-assert(gv_color(svg,gold)).
-assert(gv_color(svg,goldenrod)).
-assert(gv_color(svg,gray)).
-assert(gv_color(svg,grey)).
-assert(gv_color(svg,green)).
-assert(gv_color(svg,greenyellow)).
-assert(gv_color(svg,honeydew)).
-assert(gv_color(svg,hotpink)).
-assert(gv_color(svg,indianred)).
-assert(gv_color(svg,indigo)).
-assert(gv_color(svg,ivory)).
-assert(gv_color(svg,khaki)).
-assert(gv_color(svg,lavender)).
-assert(gv_color(svg,lavenderblush)).
-assert(gv_color(svg,lawngreen)).
-assert(gv_color(svg,lemonchiffon)).
-assert(gv_color(svg,lightblue)).
-assert(gv_color(svg,lightcoral)).
-assert(gv_color(svg,lightcyan)).
-assert(gv_color(svg,lightgoldenrodyellow)).
-assert(gv_color(svg,lightgray)).
-assert(gv_color(svg,lightgreen)).
-assert(gv_color(svg,lightgrey)).
-assert(gv_color(svg,lightpink)).
-assert(gv_color(svg,lightsalmon)).
-assert(gv_color(svg,lightseagreen)).
-assert(gv_color(svg,lightskyblue)).
-assert(gv_color(svg,lightslategray)).
-assert(gv_color(svg,lightslategrey)).
-assert(gv_color(svg,lightsteelblue)).
-assert(gv_color(svg,lightyellow)).
-assert(gv_color(svg,lime)).
-assert(gv_color(svg,limegreen)).
-assert(gv_color(svg,linen)).
-assert(gv_color(svg,magenta)).
-assert(gv_color(svg,maroon)).
-assert(gv_color(svg,mediumaquamarine)).
-assert(gv_color(svg,mediumblue)).
-assert(gv_color(svg,mediumorchid)).
-assert(gv_color(svg,mediumpurple)).
-assert(gv_color(svg,mediumseagreen)).
-assert(gv_color(svg,mediumslateblue)).
-assert(gv_color(svg,mediumspringgreen)).
-assert(gv_color(svg,mediumturquoise)).
-assert(gv_color(svg,mediumvioletred)).
-assert(gv_color(svg,midnightblue)).
-assert(gv_color(svg,mintcream)).
-assert(gv_color(svg,mistyrose)).
-assert(gv_color(svg,moccasin)).
-assert(gv_color(svg,navajowhite)).
-assert(gv_color(svg,navy)).
-assert(gv_color(svg,oldlace)).
-assert(gv_color(svg,olive)).
-assert(gv_color(svg,olivedrab)).
-assert(gv_color(svg,orange)).
-assert(gv_color(svg,orangered)).
-assert(gv_color(svg,orchid)).
-assert(gv_color(svg,palegoldenrod)).
-assert(gv_color(svg,palegreen)).
-assert(gv_color(svg,paleturquoise)).
-assert(gv_color(svg,palevioletred)).
-assert(gv_color(svg,papayawhip)).
-assert(gv_color(svg,peachpuff)).
-assert(gv_color(svg,peru)).
-assert(gv_color(svg,pink)).
-assert(gv_color(svg,plum)).
-assert(gv_color(svg,powderblue)).
-assert(gv_color(svg,purple)).
-assert(gv_color(svg,red)).
-assert(gv_color(svg,rosybrown)).
-assert(gv_color(svg,royalblue)).
-assert(gv_color(svg,saddlebrown)).
-assert(gv_color(svg,salmon)).
-assert(gv_color(svg,sandybrown)).
-assert(gv_color(svg,seagreen)).
-assert(gv_color(svg,seashell)).
-assert(gv_color(svg,sienna)).
-assert(gv_color(svg,silver)).
-assert(gv_color(svg,skyblue)).
-assert(gv_color(svg,slateblue)).
-assert(gv_color(svg,slategray)).
-assert(gv_color(svg,slategrey)).
-assert(gv_color(svg,snow)).
-assert(gv_color(svg,springgreen)).
-assert(gv_color(svg,steelblue)).
-assert(gv_color(svg,tan)).
-assert(gv_color(svg,teal)).
-assert(gv_color(svg,thistle)).
-assert(gv_color(svg,tomato)).
-assert(gv_color(svg,turquoise)).
-assert(gv_color(svg,violet)).
-assert(gv_color(svg,wheat)).
-assert(gv_color(svg,white)).
-assert(gv_color(svg,whitesmoke)).
-assert(gv_color(svg,yellow)).
-assert(gv_color(svg,yellowgreen)).
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index fa79bea..0c3755c 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -7,6 +7,7 @@
     colorList//1 % +Pairs:list(pair(compound,float))
   ]
 ).
+:- ensure_loaded(library(&#39;gv/gv_color.data&#39;)).
 
 /** &amp;lt;module&amp;gt; GraphViz color
 
@@ -17,23 +18,11 @@
 */
 
 :- use_module(library(apply)).
-:- use_module(library(debug_ext)).
 :- use_module(library(dcg/basics)).
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_content)).
-:- use_module(library(http/http_download)).
 :- use_module(library(lists)).
-:- use_module(library(msg_ext)).
 :- use_module(library(os/file_ext)).
-:- use_module(library(persistency)).
-:- use_module(library(xpath)).
-:- use_module(library(xpath/xpath_table)).
-
-%! gv_color(?Colorscheme:oneof([svg,x11]), ?Color:atom) is nondet.
-
-:- persistent(gv_color(colorscheme:oneof([svg,x11]),color:atom)).
-
-:- initialization(gv_color_init).
 
 
 
@@ -79,69 +68,3 @@ wc(Color-Float) --&amp;gt;
 wc_weight(Float) --&amp;gt;
   &amp;quot;;&amp;quot;,
   float(Float).
-
-
-
-
-
-% INITIALIZATION %
-
-%! gv_color_download is det.
-
-gv_color_download:-
-  verbose(
-    gv_color_download0,
-    &#39;updating the GraphViz color table&#39;
-  ).
-
-gv_color_download0:-
-  gv_color_uri(Uri),
-  html_download(Uri, Dom),
-  xpath_chk(Dom, //table(1), TableDom1),
-  xpath_chk(Dom, //table(2), TableDom2),
-  maplist(assert_color_table, [x11,svg], [TableDom1,TableDom2]).
-
-
-assert_color_table(Colorscheme, TableDom):-
-  xpath_table(TableDom, _, Rows),
-  append(Rows, Cells),
-  forall(
-    member(Cell, Cells),
-    assert_gv_color(Colorscheme, Cell)
-  ).
-
-
-%! gv_color_file(-File:atom) is det.
-
-gv_color_file(File):-
-  absolute_file_name(&#39;gv_color.log&#39;, File, [access(write)]).
-
-
-%! gv_color_init is det.
-
-gv_color_init:-
-  gv_color_file(File),
-  (   exists_file(File)
-  -&amp;gt;  true
-  ;   touch(File)
-  ),
-  db_attach(File, []),
-  file_age(File, Age),
-  gv_color_update(Age).
-
-
-%! gv_color_update(+Age:float) is det.
-
-% The persistent store is still fresh.
-gv_color_update(Age):-
-  once(gv_color(_, _)),
-  Age &amp;lt; 8640000, !.
-% The persistent store has become stale, so refresh it.
-gv_color_update(_):-
-  retractall_gv_color(_, _),
-  gv_color_download.
-
-
-%! gv_color_uri(-Url:url) is det.
-
-gv_color_uri(&#39;http://www.graphviz.org/doc/info/colors.html&#39;).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;132&#34;&gt; 132: 正在比较变动前 603344f 和变动后 2679253 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index 7fd5a58..43ff053 100644
--- a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -17,7 +17,8 @@
 :- use_module(library(error)).
 :- use_module(library(gv/gv_graph)).
 :- use_module(library(option)).
-:- use_module(library(process)).
+:- use_module(library(os/external_program)).
+:- use_module(library(os/process_ext)).
 :- use_module(library(string_ext)).
 
 :- predicate_options(gv_export/3, 3, [
@@ -28,6 +29,11 @@
      output(+atom)
    ]).
 
+:- dynamic(user:module_uses/2).
+:- multifile(user:module_uses/2).
+
+user:module_uses(gv_file, program(dot)).
+
 
 
 
@@ -94,10 +100,9 @@ file_to_gv(InputFile, OutputFile, Opts):-
   % Run the GraphViz conversion command in the shell.
   format(atom(OutputTypeFlag), &amp;quot;-T~a&amp;quot;, [OutputType]),
   format(atom(OutputFileFlag), &amp;quot;-o~a&amp;quot;, [OutputFile]),
-  process_create(
+  run_process(
     path(Method),
-    [OutputTypeFlag,file(InputFile),OutputFileFlag],
-    []
+    [OutputTypeFlag,file(InputFile),OutputFileFlag]
   ).
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;133&#34;&gt; 133: 正在比较变动前 2679253 和变动后 a5e20f8 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_export.pl b/prolog/fca/fca_export.pl
new file mode 100644
index 0000000..562a035
--- /dev/null
+++ b/prolog/fca/fca_export.pl
@@ -0,0 +1,87 @@
+:- module(
+  fca_export,
+  [
+    fca_export/2, % +Context:compound
+                  % ?File:atom
+    fca_export/3, % +Context:compound
+                  % ?File:atom
+                  % +Options:list(compound)
+    fca_label_attributes/2, % +Concept:compound
+                            % -Label:atom
+    fca_label_concept/2, % +Concept:compound
+                         % -Label:atom
+    fca_label_objects/2 % +Concept:compound
+                        % -Label:atom
+  ]
+).
+
+/** &amp;lt;module&amp;gt; FCA export
+
+@author Wouter Beek
+@version 2015/11
+*/
+
+:- use_module(library(dcg/dcg_collection)).
+:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(fca/fca)).
+:- use_module(library(graph/build_export_graph)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(option)).
+
+:- predicate_options(fca_export/3, 3, [
+     pass_to(build_export_graph/3, 3),
+     pass_to(gv_export/3, 3)
+   ]).
+
+
+
+
+
+%! fca_export(+Context:compound, ?File:atom) is det.
+% Wrapper around fca_export/3 with default options.
+
+fca_export(Context, File):-
+  fca_export(Context, File, []).
+
+
+%! fca_export(+Context:compound, ?File:atom, +Options:list(compound)) is det.
+
+fca_export(Context, File, Opts1):-
+  fca_lattice(Context, Lattice),
+  option(concept_label(VLabel_2), Opts1, fca_export:fca_label_concept),
+  merge_options([vertex_label(VLabel_2)], Opts1, Opts2),
+  build_export_graph(Lattice, ExportG, Opts2),
+  gv_export(ExportG, File, Opts1).
+
+
+
+%! fca_label_attributes(+Concept:compound, -Label:atom) is det.
+% Writes a concept label displaying its attributes.
+
+fca_label_attributes(Concept, Lbl):-
+  string_phrase(dcg_attributes(Concept), Lbl).
+
+dcg_attributes(concept(_,As)) --&amp;gt;
+  set(As).
+
+
+
+%! fca_label_attributes(+Concept:compound, -Label:atom) is det.
+% Writes a concept label display both its attributes and objects.
+
+fca_label_concept(Concept, Lbl):-
+  string_phrase(dcg_concept(Concept), Lbl).
+
+dcg_concept(Concept) --&amp;gt;
+  pair(dcg_objects(Concept), dcg_attributes(Concept)).
+
+
+
+%! fca_label_objects(+Concept:compound, -Label:atom) is det.
+% Writes a concept label displaying its object.
+
+fca_label_objects(Concept, Lbl):-
+  string_phrase(dcg_objects(Concept), Lbl).
+
+dcg_objects(concept(Os,_)) --&amp;gt;
+  set(Os).
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index 43ff053..4cf12a8 100644
--- a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -1,8 +1,10 @@
 :- module(
   gv_file,
   [
+    gv_export/2, % +ExportGraph:compound
+                 % ?File:atom
     gv_export/3 % +ExportGraph:compound
-                % +OutputFile:atom
+                % ?File:atom
                 % +Options:list(nvpair)
   ]
 ).
@@ -10,7 +12,7 @@
 /** &amp;lt;module&amp;gt; GraphViz file
 
 @author Wouter Beek
-@version 2015/07, 2015/10
+@version 2015/07, 2015/10-2015/11
 */
 
 :- use_module(library(code_ext)).
@@ -38,7 +40,14 @@ user:module_uses(gv_file, program(dot)).
 
 
 
-%! gv_export(+ExportGraph:compound, +File:atom, +Options:list(compound)) is det.
+%! gv_export(+ExportGraph:compound, ?File:atom) is det.
+% Wrapper around gv_export/3 with default options.
+
+gv_export(ExportG, File):-
+  gv_export(ExportG, File, []).
+
+
+%! gv_export(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
@@ -68,7 +77,7 @@ gv_export(ExportG, File, Opts):-
 
 %! file_to_gv(
 %!   +InputFile:atom,
-%!   +OutputFile:atom,
+%!   ?OutputFile:atom,
 %!   +Options:list(compound)
 %! ) is det.
 % Converts a GraphViz DOT file to an image file, using a specific
@@ -101,7 +110,7 @@ file_to_gv(InputFile, OutputFile, Opts):-
   format(atom(OutputTypeFlag), &amp;quot;-T~a&amp;quot;, [OutputType]),
   format(atom(OutputFileFlag), &amp;quot;-o~a&amp;quot;, [OutputFile]),
   run_process(
-    path(Method),
+    Method,
     [OutputTypeFlag,file(InputFile),OutputFileFlag]
   ).
 
diff --git a/test/test.pl b/test/test.pl
index ee92ae6..5ce2db0 100644
--- a/test/test.pl
+++ b/test/test.pl
@@ -1,3 +1,5 @@
+%/fca
+  :- use_module(library(fca/fca_export)).
 %/graph
   :- use_module(library(graph/build_export_graph)).
 %/gv
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;134&#34;&gt; 134: 正在比较变动前 a5e20f8 和变动后 bc3c502 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_export.pl b/prolog/fca/fca_export.pl
index 562a035..249d104 100644
--- a/prolog/fca/fca_export.pl
+++ b/prolog/fca/fca_export.pl
@@ -27,6 +27,7 @@
 :- use_module(library(graph/build_export_graph)).
 :- use_module(library(gv/gv_file)).
 :- use_module(library(option)).
+:- use_module(library(ordsets)).
 
 :- predicate_options(fca_export/3, 3, [
      pass_to(build_export_graph/3, 3),
@@ -47,12 +48,16 @@ fca_export(Context, File):-
 %! fca_export(+Context:compound, ?File:atom, +Options:list(compound)) is det.
 
 fca_export(Context, File, Opts1):-
-  fca_lattice(Context, Lattice),
+  fca_lattice(Context, Lattice1),
+  maplist(remove_reflexive_edge, Lattice1, Lattice2),
   option(concept_label(VLabel_2), Opts1, fca_export:fca_label_concept),
   merge_options([vertex_label(VLabel_2)], Opts1, Opts2),
-  build_export_graph(Lattice, ExportG, Opts2),
+  build_export_graph(Lattice2, ExportG, Opts2),
   gv_export(ExportG, File, Opts1).
 
+remove_reflexive_edge(M-Ns1, M-Ns2):-
+  ord_del_element(Ns1, M, Ns2).
+
 
 
 %! fca_label_attributes(+Concept:compound, -Label:atom) is det.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;135&#34;&gt; 135: 正在比较变动前 bc3c502 和变动后 7ec98aa &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_export.pl b/prolog/fca/fca_export.pl
index 249d104..0368834 100644
--- a/prolog/fca/fca_export.pl
+++ b/prolog/fca/fca_export.pl
@@ -25,6 +25,7 @@
 :- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(fca/fca)).
 :- use_module(library(graph/build_export_graph)).
+:- use_module(library(graph/s/s_graph)).
 :- use_module(library(gv/gv_file)).
 :- use_module(library(option)).
 :- use_module(library(ordsets)).
@@ -49,14 +50,29 @@ fca_export(Context, File):-
 
 fca_export(Context, File, Opts1):-
   fca_lattice(Context, Lattice1),
-  maplist(remove_reflexive_edge, Lattice1, Lattice2),
+  %minimize(Lattice1, Lattice2),
+  Lattice2 = Lattice1,
   option(concept_label(VLabel_2), Opts1, fca_export:fca_label_concept),
-  merge_options([vertex_label(VLabel_2)], Opts1, Opts2),
+  merge_options(
+    [vertex_label(VLabel_2),vertex_rank(fca:concept_cardinality)],
+    Opts1,
+    Opts2
+  ),
   build_export_graph(Lattice2, ExportG, Opts2),
   gv_export(ExportG, File, Opts1).
 
-remove_reflexive_edge(M-Ns1, M-Ns2):-
-  ord_del_element(Ns1, M, Ns2).
+minimize(G1, G2):-
+  s_vertices(G1, Vs),
+  aggregate_all(
+    set(X-Y),
+    (
+      s_edge(G1, X-Y),
+      maplist(concept_cardinality, [X,Y], [CX,CY]),
+      CX &amp;lt; CY
+    ),
+    Es
+  ),
+  s_graph_components(G2, Vs, Es).
 
 
 
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index b6d367b..f5dc122 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -30,7 +30,7 @@ edge(FromVertexId,ToVertexId,Attributes:list(compound))
 ### Rank
 
 ```prolog
-rank(RankVertex:compound,ContentVertices:ordset(compound))
+RankVertex:compound-ContentVertices:ordset(compound)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;vertex-1&#34;&gt;Vertex&lt;/h3&gt;
&lt;h2 id=&#34;--517-517--vertex-coordinates&#34;&gt;@@ -51,7 +51,7 @@ Vertex coordinates:&lt;/h2&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/09-2015/10
+@version 2015/07, 2015/09-2015/11
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
@@ -60,6 +60,7 @@ Vertex coordinates:
:- use_module(library(list_ext)).
:- use_module(library(option_ext)).
:- use_module(library(ordsets)).
+:- use_module(library(pairs)).&lt;/p&gt;
&lt;p&gt;:- predicate_options(build_export_graph/4, 4, [
pass_to(edge_term/3, 3),
@@ -89,6 +90,7 @@ Vertex coordinates:
vertex_label(+callable),
vertex_peripheries(+callable),
vertex_position(+callable),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;vertex_rank(+callable),
vertex_shape(+callable),
vertex_uri(+callable)
&lt;/code&gt;&lt;/pre&gt;
]).
@@ -107,6 +109,7 @@ is_meta(vertex_image).
is_meta(vertex_label).
is_meta(vertex_peripheries).
is_meta(vertex_position).
+is_meta(vertex_rank).
is_meta(vertex_shape).
is_meta(vertex_uri).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@@ -129,11 +132,17 @@ build_export_graph(G, ExportG):-
% Graph is either:
%   * a coumpound term &lt;code&gt;graph(Vs,Es)&lt;/code&gt;, or
%   * an unlabeled graph as defined by &lt;code&gt;library(ugraph)&lt;/code&gt;.
+%
+% The following options are supported:
+%   * &lt;code&gt;vertex_rank(:RankFunction)&lt;/code&gt;
+%     Assigns a non-negative integer to each vertex.
+%     No default.&lt;/p&gt;
&lt;p&gt;-build_export_graph(G, graph(VTerms,ETerms,GAttrs), Opts1):-
+build_export_graph(G, graph(VTerms2,VRanks,ETerms,GAttrs), Opts1):-
graph_components(G, Vs, Es),
meta_options(is_meta, Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms1),&lt;/li&gt;
&lt;li&gt;build_export_ranks(Vs, VTerms1, VRanks, VTerms2, Opts2),
maplist(\E^ETerm^edge_term(Vs, E, ETerm, Opts2), Es, ETerms),
graph_attributes(GAttrs, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@@ -141,6 +150,20 @@ graph_components(graph(Vs,Es), Vs, Es):- !.
graph_components(G, Vs, Es):-
s_graph_components(G, Vs, Es).&lt;/p&gt;
&lt;p&gt;+build_export_ranks(Vs, VTerms, VRanks, [], Opts):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;option(vertex_rank(VRank_2), Opts), !,&lt;/li&gt;
&lt;li&gt;maplist(VRank_2, Vs, Ranks),&lt;/li&gt;
&lt;li&gt;pairs_keys_values(Pairs, Ranks, VTerms),&lt;/li&gt;
&lt;li&gt;group_pairs_by_key(Pairs, GroupedPairs),&lt;/li&gt;
&lt;li&gt;build_export_rank_terms(GroupedPairs, VRanks).
+build_export_ranks(_, VTerms, [], VTerms, _).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+build_export_rank_terms([N-VTerms|T1], [vertex(Id,[label(Lbl)])-VTerms|T2]):- !,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;format(atom(Id), &amp;lsquo;r~d&amp;rsquo;, [N]),&lt;/li&gt;
&lt;li&gt;atom_number(Lbl, N),&lt;/li&gt;
&lt;li&gt;build_export_rank_terms(T1, T2).
+build_export_rank_terms([], []).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;%! edge_term(
diff &amp;ndash;git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index 5de2ff1..79c1be0 100644
&amp;mdash; a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -52,7 +52,7 @@ In GraphViz vertices are called &amp;lsquo;nodes&amp;rsquo;.
%
% &lt;code&gt;RankedVertexTerms&lt;/code&gt; is a list of compound terms of the following form:
% &lt;code&gt;prolog -% rank(RankNode,ContentNodes) +% RankVertex-ContentVertices % &lt;/code&gt;
%
% @tbd Add support for subgraphs (arbitrary nesting).
diff &amp;ndash;git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 3aec4e6..8644e1c 100644
&amp;mdash; a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -22,18 +22,15 @@ attr_list = &amp;ldquo;[&amp;rdquo; [a_list] &amp;ldquo;]&amp;rdquo; [attr_list]
a_list = ID &amp;ldquo;=&amp;rdquo; ID [&amp;quot;,&amp;quot;] [a_list]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
----
-
@author Wouter Beek
@see http://www.graphviz.org/content/dot-language
-@version 2015/07-2015/08, 2015/10
+@version 2015/07-2015/08, 2015/10-2015/11
*/

:- use_module(library(apply)).
:- use_module(library(dcg/basics)).
:- use_module(library(dcg/dcg_abnf)).
:- use_module(library(dcg/dcg_ascii)).
-:- use_module(library(dcg/dcg_bracketed)).
:- use_module(library(dcg/dcg_content)).
:- use_module(library(dcg/dcg_quoted)).
:- use_module(library(gv/gv_attrs)).
@@ -113,6 +110,8 @@ gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
  gv_attrs(Kind, Attrs),
  &amp;quot;\n&amp;quot;, !.

+
+
%! gv_kind(+Kind:oneof([edge,graph,node]))// .

gv_kind(Kind) --&amp;gt;
@@ -132,14 +131,11 @@ gv_node_statement(I, vertex(Id,Attrs)) --&amp;gt;



-%! gv_ranked_node_collection(+Indent:nonneg, Rank)// is det.
+%! gv_ranked_node_collection(+Indent:nonneg, Rank:pair)// is det.

-gv_ranked_node_collection(I, Rank) --&amp;gt;
+gv_ranked_node_collection(I, RankVTerm-VTerms) --&amp;gt;
  indent(I),
-  bracketed(curly, gv_ranked_node_collection0(I, Rank)).
-
-gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
-  &amp;quot;\n&amp;quot;,
+  &amp;quot;{\n&amp;quot;,

  % The rank attribute.
  {NewI is I + 1},
@@ -148,15 +144,11 @@ gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
  &amp;quot;\n&amp;quot;,

  % Vertice statements.
-  *(
-    gv_node_statement(NewI),
-    [Rank_V_Term|Content_V_Terms],
-    []
-  ),
+  *(gv_node_statement(NewI), [RankVTerm|VTerms], []),

  % We want to indent the closing curly brace.
  indent(I),
-  &amp;quot;\n&amp;quot;.
+  &amp;quot;\n}&amp;quot;.



@@ -170,7 +162,7 @@ gv_ranked_node_collection0(I, rank(Rank_V_Term,Content_V_Terms)) --&amp;gt;
%! )// is det.

gv_attrs(Kind, L) --&amp;gt;
-  bracketed(square, *(gv_attr(Kind), L, [])).
+  &amp;quot;[&amp;quot;, *(gv_attr(Kind), L, []), &amp;quot;]&amp;quot;.


%! gv_attr(+Context:oneof([edge,graph,node]), +Attribute:compound)// is det.
@@ -179,10 +171,7 @@ gv_attrs(Kind, L) --&amp;gt;

gv_attr(Context, Attr) --&amp;gt;
  {Attr =.. [N,V]},
-  gv_id(N),
-  &amp;quot;=&amp;quot;,
-  gv_attr_value(Context, N=V),
-  &amp;quot;;&amp;quot;.
+  gv_id(N), &amp;quot;=&amp;quot;, gv_attr_value(Context, N=V), &amp;quot;;&amp;quot;.



@@ -213,7 +202,7 @@ gv_id(html_like_label(Content)) --&amp;gt; !,
% Double-quoted strings.
% The quotes are already part of the given atom.
gv_id(double_quoted_string(Atom)) --&amp;gt; !,
-  quoted(atom(Atom)).
+  &amp;quot;\&amp;quot;&amp;quot;, atom(Atom), &amp;quot;\&amp;quot;&amp;quot;.
% Numerals.
gv_id(N) --&amp;gt;
  {number(N)}, !,
@@ -228,6 +217,7 @@ gv_id(Atom) --&amp;gt;
  % GraphViz keyword.
  {\+ gv_keyword([H|T])}.

+
%! gv_id_first(+First:code)// is det.
% Generates the first character of a GraphViz identifier.

@@ -236,16 +226,17 @@ gv_id_first(X) --&amp;gt;
gv_id_first(X) --&amp;gt;
  underscore(X).

+
%! gv_id_rest(+NonFirst:code)// is det.
% Generates a non-first character of a GraphViz identifier.

gv_id_rest([]) --&amp;gt; !, &amp;quot;&amp;quot;.
gv_id_rest([H|T]) --&amp;gt;
-  (   ascii_alpha_numeric(H)
-  ;   underscore(H)
-  ),
+  (ascii_alpha_numeric(H) ; underscore(H)),
  gv_id_rest(T).

+
+
%! gv_keyword(+Codes:list(code)) is semidet.
% Succeeds if the given codes for a GraphViz reserved keyword.

@@ -254,6 +245,7 @@ gv_keyword(Cs):-
  % So we must use phrase/[2,3].
  phrase(gv_keyword, Cs).

+
%! gv_keyword// .
% GraphViz has reserved keywords that cannot be used as identifiers.
% GraphViz keywords are case-insensitive.
@@ -289,32 +281,22 @@ gv_node_id(Id) --&amp;gt;

gv_port --&amp;gt;
  gv_port_location,
-  (   gv_port_angle
-  ;   &amp;quot;&amp;quot;
-  ).
+  (gv_port_angle ; &amp;quot;&amp;quot;).
gv_port --&amp;gt;
  gv_port_angle,
-  (   gv_port_location
-  ;   &amp;quot;&amp;quot;
-  ).
+  (gv_port_location ; &amp;quot;&amp;quot;).
gv_port --&amp;gt;
-  &amp;quot;:&amp;quot;,
-  gv_compass_pt(_).
+  &amp;quot;:&amp;quot;, gv_compass_pt(_).

gv_port_angle --&amp;gt;
-  &amp;quot;@&amp;quot;,
-  gv_id(_).
+  &amp;quot;@&amp;quot;, gv_id(_).

gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
-  gv_id(_).
+  &amp;quot;:&amp;quot;, gv_id(_).
gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;,
-  bracketed((
-    gv_id(_),
-    &amp;quot;,&amp;quot;,
-    gv_id(_)
-  )).
+  &amp;quot;:[&amp;quot;, gv_id(_), &amp;quot;,&amp;quot;, gv_id(_), &amp;quot;]&amp;quot;.
+
+

%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
% ```

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;136&#34;&gt; 136: 正在比较变动前 7ec98aa 和变动后 984d3b9 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_export.pl b/prolog/fca/fca_export.pl
index 0368834..d14d24b 100644
--- a/prolog/fca/fca_export.pl
+++ b/prolog/fca/fca_export.pl
@@ -49,31 +49,16 @@ fca_export(Context, File):-
 %! fca_export(+Context:compound, ?File:atom, +Options:list(compound)) is det.
 
 fca_export(Context, File, Opts1):-
-  fca_lattice(Context, Lattice1),
-  %minimize(Lattice1, Lattice2),
-  Lattice2 = Lattice1,
+  fca_hasse(Context, Hasse),
   option(concept_label(VLabel_2), Opts1, fca_export:fca_label_concept),
   merge_options(
     [vertex_label(VLabel_2),vertex_rank(fca:concept_cardinality)],
     Opts1,
     Opts2
   ),
-  build_export_graph(Lattice2, ExportG, Opts2),
+  build_export_graph(Hasse, ExportG, Opts2),
   gv_export(ExportG, File, Opts1).
 
-minimize(G1, G2):-
-  s_vertices(G1, Vs),
-  aggregate_all(
-    set(X-Y),
-    (
-      s_edge(G1, X-Y),
-      maplist(concept_cardinality, [X,Y], [CX,CY]),
-      CX &amp;lt; CY
-    ),
-    Es
-  ),
-  s_graph_components(G2, Vs, Es).
-
 
 
 %! fca_label_attributes(+Concept:compound, -Label:atom) is det.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;137&#34;&gt; 137: 正在比较变动前 984d3b9 和变动后 4401e20 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_export.pl b/prolog/fca/fca_export.pl
index d14d24b..c48fe40 100644
--- a/prolog/fca/fca_export.pl
+++ b/prolog/fca/fca_export.pl
@@ -3,15 +3,9 @@
   [
     fca_export/2, % +Context:compound
                   % ?File:atom
-    fca_export/3, % +Context:compound
-                  % ?File:atom
-                  % +Options:list(compound)
-    fca_label_attributes/2, % +Concept:compound
-                            % -Label:atom
-    fca_label_concept/2, % +Concept:compound
-                         % -Label:atom
-    fca_label_objects/2 % +Concept:compound
-                        % -Label:atom
+    fca_export/3 % +Context:compound
+                 % ?File:atom
+                 % :Options:list(compound)
   ]
 ).
 
@@ -30,11 +24,18 @@
 :- use_module(library(option)).
 :- use_module(library(ordsets)).
 
+:- meta_predicate(concept_label(+,1,+,-)).
+:- meta_predicate(concept_label(+,1,+,?,?)).
+:- meta_predicate(fca_export(+,?,:)).
+
 :- predicate_options(fca_export/3, 3, [
-     pass_to(build_export_graph/3, 3),
+     concept_label(+oneof([attributes,both,objects])),
+     object_label(+callable),
      pass_to(gv_export/3, 3)
    ]).
 
+is_meta(object_label).
+
 
 
 
@@ -46,48 +47,46 @@ fca_export(Context, File):-
   fca_export(Context, File, []).
 
 
-%! fca_export(+Context:compound, ?File:atom, +Options:list(compound)) is det.
+%! fca_export(+Context:compound, ?File:atom, :Options:list(compound)) is det.
+% The following optios are supported:
+%   * concept_label(+oneof([attributes,both,objects]))
 
 fca_export(Context, File, Opts1):-
   fca_hasse(Context, Hasse),
-  option(concept_label(VLabel_2), Opts1, fca_export:fca_label_concept),
+  
+  meta_options(is_meta, Opts1, Opts2),
+  option(concept_label(Mode), Opts2, both),
+  option(object_label(Object_1), Opts2, =),
   merge_options(
-    [vertex_label(VLabel_2),vertex_rank(fca:concept_cardinality)],
-    Opts1,
-    Opts2
+    [
+      vertex_label(fca_export:concept_label(Mode, Object_1)),
+      vertex_rank(fca:concept_cardinality)
+    ],
+    Opts2,
+    Opts3
   ),
-  build_export_graph(Hasse, ExportG, Opts2),
-  gv_export(ExportG, File, Opts1).
-
-
-
-%! fca_label_attributes(+Concept:compound, -Label:atom) is det.
-% Writes a concept label displaying its attributes.
-
-fca_label_attributes(Concept, Lbl):-
-  string_phrase(dcg_attributes(Concept), Lbl).
+  build_export_graph(Hasse, ExportG, Opts3),
 
-dcg_attributes(concept(_,As)) --&amp;gt;
-  set(As).
-
-
-
-%! fca_label_attributes(+Concept:compound, -Label:atom) is det.
-% Writes a concept label display both its attributes and objects.
+  gv_export(ExportG, File, Opts2).
 
-fca_label_concept(Concept, Lbl):-
-  string_phrase(dcg_concept(Concept), Lbl).
 
-dcg_concept(Concept) --&amp;gt;
-  pair(dcg_objects(Concept), dcg_attributes(Concept)).
 
+%! concept_label(
+%!   +Mode:oneof([attributes,both,objects]),
+%!   :Object_1,
+%!   +Concept:compound,
+%!   -Label:atom
+%! ) is det.
 
+concept_label(Mode, Object_1, Concept, Lbl):-
+  string_phrase(concept_label(Mode, Object_1, Concept), Lbl).
 
-%! fca_label_objects(+Concept:compound, -Label:atom) is det.
-% Writes a concept label displaying its object.
-
-fca_label_objects(Concept, Lbl):-
-  string_phrase(dcg_objects(Concept), Lbl).
-
-dcg_objects(concept(Os,_)) --&amp;gt;
-  set(Os).
+concept_label(attributes, _, concept(_,As)) --&amp;gt;
+  set(As).
+concept_label(both, Object_1, Concept) --&amp;gt;
+  pair(
+    concept_label(objects, Object_1, Concept),
+    concept_label(attributes, Object_1, Concept)
+  ).
+concept_label(objects, Object_1, concept(Os,_)) --&amp;gt;
+  set(Object_1, Os).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index f5dc122..71f9dd4 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -158,12 +158,14 @@ build_export_ranks(Vs, VTerms, VRanks, [], Opts):-
   build_export_rank_terms(GroupedPairs, VRanks).
 build_export_ranks(_, VTerms, [], VTerms, _).
 
-build_export_rank_terms([N-VTerms|T1], [vertex(Id,[label(Lbl)])-VTerms|T2]):- !,
-  format(atom(Id), &#39;r~d&#39;, [N]),
-  atom_number(Lbl, N),
+build_export_rank_terms([N-VTerms|T1], [RankTerm-VTerms|T2]):- !,
+  build_export_rank_term(N, RankTerm),
   build_export_rank_terms(T1, T2).
 build_export_rank_terms([], []).
 
+build_export_rank_term(N, vertex(Id,[label(&amp;quot;&amp;quot;),shape(none)])):-
+  format(atom(Id), &amp;quot;r~d&amp;quot;, [N]).
+
 
 
 %! edge_term(
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;138&#34;&gt; 138: 正在比较变动前 4401e20 和变动后 2247466 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_export.pl b/prolog/fca/fca_export.pl
index c48fe40..03353e3 100644
--- a/prolog/fca/fca_export.pl
+++ b/prolog/fca/fca_export.pl
@@ -17,6 +17,7 @@
 
 :- use_module(library(dcg/dcg_collection)).
 :- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(dcg/dcg_pl)).
 :- use_module(library(fca/fca)).
 :- use_module(library(graph/build_export_graph)).
 :- use_module(library(graph/s/s_graph)).
@@ -24,8 +25,8 @@
 :- use_module(library(option)).
 :- use_module(library(ordsets)).
 
-:- meta_predicate(concept_label(+,1,+,-)).
-:- meta_predicate(concept_label(+,1,+,?,?)).
+:- meta_predicate(concept_label(+,1,1,+,-)).
+:- meta_predicate(concept_label(+,1,1,+,?,?)).
 :- meta_predicate(fca_export(+,?,:)).
 
 :- predicate_options(fca_export/3, 3, [
@@ -34,6 +35,7 @@
      pass_to(gv_export/3, 3)
    ]).
 
+is_meta(attribute_label).
 is_meta(object_label).
 
 
@@ -49,17 +51,27 @@ fca_export(Context, File):-
 
 %! fca_export(+Context:compound, ?File:atom, :Options:list(compound)) is det.
 % The following optios are supported:
+%   * attribute_label(+callable)
+%     DCG writing the labels for individual attributes.
+%     Default is pl_term//1.
 %   * concept_label(+oneof([attributes,both,objects]))
+%     Determines which components of the concepts are displayed
+%     in the export graph.
+%     Default is `both`.
+%   * object_label(+callable)
+%     DCG writing the labels for individual objects.
+%     Default is pl_term//1.
 
 fca_export(Context, File, Opts1):-
   fca_hasse(Context, Hasse),
   
   meta_options(is_meta, Opts1, Opts2),
+  option(attribute_label(ALbl_1), Opts2, pl_term),
   option(concept_label(Mode), Opts2, both),
-  option(object_label(Object_1), Opts2, =),
+  option(object_label(OLbl_1), Opts2, pl_term),
   merge_options(
     [
-      vertex_label(fca_export:concept_label(Mode, Object_1)),
+      vertex_label(fca_export:concept_label(Mode, OLbl_1, ALbl_1)),
       vertex_rank(fca:concept_cardinality)
     ],
     Opts2,
@@ -73,20 +85,29 @@ fca_export(Context, File, Opts1):-
 
 %! concept_label(
 %!   +Mode:oneof([attributes,both,objects]),
-%!   :Object_1,
+%!   :ObjectLabel_1,
+%!   :AttributeLabel_1,
 %!   +Concept:compound,
 %!   -Label:atom
 %! ) is det.
 
-concept_label(Mode, Object_1, Concept, Lbl):-
-  string_phrase(concept_label(Mode, Object_1, Concept), Lbl).
+concept_label(Mode, OLbl_1, ALbl_1, Concept, Lbl):-
+  string_phrase(concept_label(Mode, OLbl_1, ALbl_1, Concept), Lbl).
 
-concept_label(attributes, _, concept(_,As)) --&amp;gt;
-  set(As).
-concept_label(both, Object_1, Concept) --&amp;gt;
+
+%! concept_label(
+%!   +Mode:oneof([attributes,both,objects]),
+%!   :ObjectLabel_1,
+%!   :AttributeLabel_1,
+%!   +Concept:compound
+%! )// is det.
+
+concept_label(attributes, _, ALbl_1, concept(_,As)) --&amp;gt;
+  set(ALbl_1, As).
+concept_label(both, OLbl_1, ALbl_1, Concept) --&amp;gt;
   pair(
-    concept_label(objects, Object_1, Concept),
-    concept_label(attributes, Object_1, Concept)
+    concept_label(objects, OLbl_1, ALbl_1, Concept),
+    concept_label(attributes, OLbl_1, ALbl_1, Concept)
   ).
-concept_label(objects, Object_1, concept(Os,_)) --&amp;gt;
-  set(Object_1, Os).
+concept_label(objects, OLbl_1, _, concept(Os,_)) --&amp;gt;
+  set(OLbl_1, Os).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;139&#34;&gt; 139: 正在比较变动前 2247466 和变动后 f4a9322 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index 79c1be0..a9e1a42 100644
--- a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -76,7 +76,7 @@ gv_graph(G1, I) --&amp;gt;
 
   % The first statement in the GraphViz output.
   % States that this file represents a graph according to the GraphViz format.
-  indent(I),
+  tab(I),
   
   % Strictness.
   {select_option(strict(Strict), GAttrs2, GAttrs3, false)},
@@ -156,7 +156,7 @@ gv_graph(G1, I) --&amp;gt;
   % Note that we do not include a line_feed here.
 
   % We want to indent the closing curly brace.
-  indent(I),
+  tab(I),
   &amp;quot;}\n&amp;quot;.
 
 gv_edge_statements(I, Dir, L) --&amp;gt;
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 8644e1c..d86c1b4 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -61,7 +61,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 % @tbd Add support for multiple, consecutive occurrences of gv_edge_rhs//2.
 
 gv_edge_statement(I, Dir, edge(From,To,Attrs)) --&amp;gt;
-  indent(I),
+  tab(I),
 
   gv_node_id(From), &amp;quot; &amp;quot;,
   gv_edge_operator(Dir), &amp;quot; &amp;quot;,
@@ -105,7 +105,7 @@ gv_edge_operator(Dir) --&amp;gt;
 
 gv_generic_attributes_statement(_, _, []) --&amp;gt; !, &amp;quot;&amp;quot;.
 gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
-  indent(I),
+  tab(I),
   gv_kind(Kind), &amp;quot; &amp;quot;,
   gv_attrs(Kind, Attrs),
   &amp;quot;\n&amp;quot;, !.
@@ -124,7 +124,7 @@ gv_kind(Kind) --&amp;gt;
 % A GraphViz statement describing a vertex (GraphViz calls vertices &#39;nodes&#39;).
 
 gv_node_statement(I, vertex(Id,Attrs)) --&amp;gt;
-  indent(I),
+  tab(I),
   gv_node_id(Id),
   gv_attrs(node, Attrs),
   &amp;quot;\n&amp;quot;.
@@ -134,12 +134,12 @@ gv_node_statement(I, vertex(Id,Attrs)) --&amp;gt;
 %! gv_ranked_node_collection(+Indent:nonneg, Rank:pair)// is det.
 
 gv_ranked_node_collection(I, RankVTerm-VTerms) --&amp;gt;
-  indent(I),
+  tab(I),
   &amp;quot;{\n&amp;quot;,
 
   % The rank attribute.
   {NewI is I + 1},
-  indent(NewI),
+  tab(NewI),
   gv_attr(subgraph, rank(same)),
   &amp;quot;\n&amp;quot;,
 
@@ -147,7 +147,7 @@ gv_ranked_node_collection(I, RankVTerm-VTerms) --&amp;gt;
   *(gv_node_statement(NewI), [RankVTerm|VTerms], []),
 
   % We want to indent the closing curly brace.
-  indent(I),
+  tab(I),
   &amp;quot;\n}&amp;quot;.
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;140&#34;&gt; 140: 正在比较变动前 f4a9322 和变动后 0d2712a &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index 5ab08a6..8fa78af 100644
--- a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -46,14 +46,11 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2015/07
+@version 2015/07, 2015/11
 */
 
 :- use_module(library(dcg/basics), except([string//1])).
-:- use_module(library(dcg/dcg_abnf)).
-:- use_module(library(dcg/dcg_ascii)).
 :- use_module(library(dcg/dcg_phrase)).
-:- use_module(library(dcg/dcg_quoted)).
 :- use_module(library(gv/gv_html)).
 
 
@@ -62,47 +59,45 @@
 
 %! gv_attr_type(?Type:atom) is nondet.
 
-gv_attr_type(addDouble) --&amp;gt; &amp;quot;addDouble&amp;quot;.
-gv_attr_type(addPoint) --&amp;gt; &amp;quot;addPoint&amp;quot;.
-gv_attr_type(arrowType) --&amp;gt; &amp;quot;arrowType&amp;quot;.
-gv_attr_type(bool) --&amp;gt; &amp;quot;bool&amp;quot;.
-gv_attr_type(color) --&amp;gt; &amp;quot;color&amp;quot;.
-gv_attr_type(colorList) --&amp;gt; &amp;quot;colorList&amp;quot;.
+gv_attr_type(addDouble)   --&amp;gt; &amp;quot;addDouble&amp;quot;.
+gv_attr_type(addPoint)    --&amp;gt; &amp;quot;addPoint&amp;quot;.
+gv_attr_type(arrowType)   --&amp;gt; &amp;quot;arrowType&amp;quot;.
+gv_attr_type(bool)        --&amp;gt; &amp;quot;bool&amp;quot;.
+gv_attr_type(color)       --&amp;gt; &amp;quot;color&amp;quot;.
+gv_attr_type(colorList)   --&amp;gt; &amp;quot;colorList&amp;quot;.
 gv_attr_type(clusterMode) --&amp;gt; &amp;quot;clusterMode&amp;quot;.
-gv_attr_type(dirType) --&amp;gt; &amp;quot;dirType&amp;quot;.
-gv_attr_type(double) --&amp;gt; &amp;quot;double&amp;quot;.
-gv_attr_type(doubleList) --&amp;gt; &amp;quot;doubleList&amp;quot;.
-gv_attr_type(escString) --&amp;gt; &amp;quot;escString&amp;quot;.
-gv_attr_type(layerList) --&amp;gt; &amp;quot;layerList&amp;quot;.
-gv_attr_type(layerRange) --&amp;gt; &amp;quot;layerRange&amp;quot;.
-gv_attr_type(lblString) --&amp;gt; &amp;quot;lblString&amp;quot;.
-gv_attr_type(int) --&amp;gt; &amp;quot;int&amp;quot;.
-gv_attr_type(outputMode) --&amp;gt; &amp;quot;outputMode&amp;quot;.
-gv_attr_type(packMode) --&amp;gt; &amp;quot;packMode&amp;quot;.
-gv_attr_type(pagedir) --&amp;gt; &amp;quot;pagedir&amp;quot;.
-gv_attr_type(point) --&amp;gt; &amp;quot;point&amp;quot;.
-gv_attr_type(pointList) --&amp;gt; &amp;quot;pointList&amp;quot;.
-gv_attr_type(portPos) --&amp;gt; &amp;quot;portPos&amp;quot;.
-gv_attr_type(quadType) --&amp;gt; &amp;quot;quadType&amp;quot;.
-gv_attr_type(rankType) --&amp;gt; &amp;quot;rankType&amp;quot;.
-gv_attr_type(rankdir) --&amp;gt; &amp;quot;rankdir&amp;quot;.
-gv_attr_type(rect) --&amp;gt; &amp;quot;rect&amp;quot;.
-gv_attr_type(shape) --&amp;gt; &amp;quot;shape&amp;quot;.
-gv_attr_type(smoothType) --&amp;gt; &amp;quot;smoothType&amp;quot;.
-gv_attr_type(splineType) --&amp;gt; &amp;quot;splineType&amp;quot;.
-gv_attr_type(startType) --&amp;gt; &amp;quot;startType&amp;quot;.
-gv_attr_type(string) --&amp;gt; &amp;quot;string&amp;quot;.
-gv_attr_type(style) --&amp;gt; &amp;quot;style&amp;quot;.
-gv_attr_type(viewPort) --&amp;gt; &amp;quot;viewPort&amp;quot;.
+gv_attr_type(dirType)     --&amp;gt; &amp;quot;dirType&amp;quot;.
+gv_attr_type(double)      --&amp;gt; &amp;quot;double&amp;quot;.
+gv_attr_type(doubleList)  --&amp;gt; &amp;quot;doubleList&amp;quot;.
+gv_attr_type(escString)   --&amp;gt; &amp;quot;escString&amp;quot;.
+gv_attr_type(layerList)   --&amp;gt; &amp;quot;layerList&amp;quot;.
+gv_attr_type(layerRange)  --&amp;gt; &amp;quot;layerRange&amp;quot;.
+gv_attr_type(lblString)   --&amp;gt; &amp;quot;lblString&amp;quot;.
+gv_attr_type(int)         --&amp;gt; &amp;quot;int&amp;quot;.
+gv_attr_type(outputMode)  --&amp;gt; &amp;quot;outputMode&amp;quot;.
+gv_attr_type(packMode)    --&amp;gt; &amp;quot;packMode&amp;quot;.
+gv_attr_type(pagedir)     --&amp;gt; &amp;quot;pagedir&amp;quot;.
+gv_attr_type(point)       --&amp;gt; &amp;quot;point&amp;quot;.
+gv_attr_type(pointList)   --&amp;gt; &amp;quot;pointList&amp;quot;.
+gv_attr_type(portPos)     --&amp;gt; &amp;quot;portPos&amp;quot;.
+gv_attr_type(quadType)    --&amp;gt; &amp;quot;quadType&amp;quot;.
+gv_attr_type(rankType)    --&amp;gt; &amp;quot;rankType&amp;quot;.
+gv_attr_type(rankdir)     --&amp;gt; &amp;quot;rankdir&amp;quot;.
+gv_attr_type(rect)        --&amp;gt; &amp;quot;rect&amp;quot;.
+gv_attr_type(shape)       --&amp;gt; &amp;quot;shape&amp;quot;.
+gv_attr_type(smoothType)  --&amp;gt; &amp;quot;smoothType&amp;quot;.
+gv_attr_type(splineType)  --&amp;gt; &amp;quot;splineType&amp;quot;.
+gv_attr_type(startType)   --&amp;gt; &amp;quot;startType&amp;quot;.
+gv_attr_type(string)      --&amp;gt; &amp;quot;string&amp;quot;.
+gv_attr_type(style)       --&amp;gt; &amp;quot;style&amp;quot;.
+gv_attr_type(viewPort)    --&amp;gt; &amp;quot;viewPort&amp;quot;.
 
 
 
 %! addDouble(+Float:float)// .
 % An *addDouble* is represented by a Prolog float.
 
-addDouble(N) --&amp;gt;
-  (&amp;quot;+&amp;quot; ; &amp;quot;&amp;quot;),
-  float(N).
+addDouble(N) --&amp;gt; (&amp;quot;+&amp;quot;, ! ; &amp;quot;&amp;quot;), float(N).
 
 
 
@@ -110,47 +105,38 @@ addDouble(N) --&amp;gt;
 % An *addPoint* is represented by a compound of the following form:
 % `point(X:float,Y:float,InputOnly:boolean)`.
 
-addPoint(Point) --&amp;gt;
-  (&amp;quot;+&amp;quot; ; &amp;quot;&amp;quot;),
-  point(Point).
+addPoint(Point) --&amp;gt; (&amp;quot;+&amp;quot;, ! ; &amp;quot;&amp;quot;), point(Point).
 
 
 
 %! arrowType(+ArrowType:atom)// .
 
-arrowType(V) --&amp;gt;
-  {arrowType(V)},
-  atom(V).
-
-arrowType(V):-
-  primitive_shape(V).
-arrowType(V):-
-  derived(V).
-arrowType(V):-
-  backwards_compatible(V).
-
-primitive_shape(box).
-primitive_shape(crow).
-primitive_shape(circle).
-primitive_shape(diamond).
-primitive_shape(dot).
-primitive_shape(inv).
-primitive_shape(none).
-primitive_shape(normal).
-primitive_shape(tee).
-primitive_shape(vee).
-
-derived(odot).
-derived(invdot).
-derived(invodot).
-derived(obox).
-derived(odiamond).
-
-backwards_compatible(ediamond).
-backwards_compatible(empty).
-backwards_compatible(halfopen).
-backwards_compatible(invempty).
-backwards_compatible(open).
+arrowType(V) --&amp;gt; primitive_shape(V).
+arrowType(V) --&amp;gt; derived(V).
+arrowType(V) --&amp;gt; backwards_compatible(V).
+
+primitive_shape(box)     --&amp;gt; &amp;quot;box&amp;quot;.
+primitive_shape(crow)    --&amp;gt; &amp;quot;crow&amp;quot;.
+primitive_shape(circle)  --&amp;gt; &amp;quot;circle&amp;quot;.
+primitive_shape(diamond) --&amp;gt; &amp;quot;diamond&amp;quot;.
+primitive_shape(dot)     --&amp;gt; &amp;quot;dot&amp;quot;.
+primitive_shape(inv)     --&amp;gt; &amp;quot;inv&amp;quot;.
+primitive_shape(none)    --&amp;gt; &amp;quot;none&amp;quot;.
+primitive_shape(normal)  --&amp;gt; &amp;quot;normal&amp;quot;.
+primitive_shape(tee)     --&amp;gt; &amp;quot;tee&amp;quot;.
+primitive_shape(vee)     --&amp;gt; &amp;quot;vee&amp;quot;.
+
+derived(odot)     --&amp;gt; &amp;quot;odot&amp;quot;.
+derived(invdot)   --&amp;gt; &amp;quot;invdot&amp;quot;.
+derived(invodot)  --&amp;gt; &amp;quot;invodot&amp;quot;.
+derived(obox)     --&amp;gt; &amp;quot;obox&amp;quot;.
+derived(odiamond) --&amp;gt; &amp;quot;odiamond&amp;quot;.
+
+backwards_compatible(ediamond) --&amp;gt; &amp;quot;ediamond&amp;quot;.
+backwards_compatible(empty)    --&amp;gt; &amp;quot;empty&amp;quot;.
+backwards_compatible(halfopen) --&amp;gt; &amp;quot;halfopen&amp;quot;.
+backwards_compatible(invempty) --&amp;gt; &amp;quot;invempty&amp;quot;.
+backwards_compatible(open)     --&amp;gt; &amp;quot;open&amp;quot;.
 
 
 
@@ -158,47 +144,37 @@ backwards_compatible(open).
 
 bool(false) --&amp;gt; &amp;quot;false&amp;quot;.
 bool(false) --&amp;gt; &amp;quot;no&amp;quot;.
-bool(true) --&amp;gt; &amp;quot;true&amp;quot;.
-bool(true) --&amp;gt; &amp;quot;yes&amp;quot;.
+bool(true)  --&amp;gt; &amp;quot;true&amp;quot;.
+bool(true)  --&amp;gt; &amp;quot;yes&amp;quot;.
 
 
 
 %! clusterMode(+ClusterMode:atom)// .
 
-clusterMode(V) --&amp;gt;
-  {clusterMode(V)},
-  atom(V).
-
-clusterMode(global).
-clusterMode(local).
-clusterMode(none).
+clusterMode(global) --&amp;gt; &amp;quot;global&amp;quot;.
+clusterMode(local) --&amp;gt; &amp;quot;local&amp;quot;.
+clusterMode(none) --&amp;gt; &amp;quot;none&amp;quot;.
 
 
 
 %! dirType(+DirectionType:oneof([back,both,forward,none]))// .
 
-dirType(DirType) --&amp;gt;
-  {dirType(DirType)},
-  atom(DirType).
-
-dirType(back).
-dirType(both).
-dirType(forward).
-dirType(none).
+dirType(back) --&amp;gt; &amp;quot;back&amp;quot;.
+dirType(both) --&amp;gt; &amp;quot;both&amp;quot;.
+dirType(forward) --&amp;gt; &amp;quot;forward&amp;quot;.
+dirType(none) --&amp;gt; &amp;quot;none&amp;quot;.
 
 
 
 %! double(+Double:float)// .
 
-double(N) --&amp;gt;
-  float(N).
+double(N) --&amp;gt; float(N).
 
 
 
 %! doubleList(+Doubles:list(float))// .
 
-doubleList(L) --&amp;gt;
-  *(double, L, [separator(colon)]).
+doubleList([H|T]) --&amp;gt; double(H), (&amp;quot;:&amp;quot;, !, doubleList(T) ; {T = []}).
 
 
 
@@ -210,15 +186,11 @@ escString(S1) --&amp;gt;
   -&amp;gt;  string_phrase(escape_double_quotes, S1, S2)
   ;   atom_phrase(escape_double_quotes, S1, S2)
   )},
-  quoted(atom(S2)).
+  &amp;quot;\&amp;quot;&amp;quot;, atom(S2), &amp;quot;\&amp;quot;&amp;quot;.
 
-escape_double_quotes, [92,34] --&amp;gt;
-  [34], !,
-  escape_double_quotes.
-escape_double_quotes, [X] --&amp;gt;
-  [X], !,
-  escape_double_quotes.
-escape_double_quotes --&amp;gt; [].
+escape_double_quotes, [0&#39;\\,0&#39;&amp;quot;] --&amp;gt; [0&#39;&amp;quot;], !, escape_double_quotes.
+escape_double_quotes, [X]        --&amp;gt; [X],   !, escape_double_quotes.
+escape_double_quotes             --&amp;gt; &amp;quot;&amp;quot;.
 
 
 
@@ -232,29 +204,22 @@ escape_double_quotes --&amp;gt; [].
 
 %! lblString(+String:compound)// .
 
-lblString(html_like_label(V)) --&amp;gt;
-  gv_html_like_label(V).
-lblString(V) --&amp;gt;
-  escString(V).
+lblString(html_like_label(V)) --&amp;gt; gv_html_like_label(V).
+lblString(V) --&amp;gt; escString(V).
 
 
 
 %! int(+Integer:integer)// .
 
-int(V) --&amp;gt;
-  integer(V).
+int(V) --&amp;gt; integer(V).
 
 
 
 %! outputMode(+OutputMode:atom)// .
 
-outputMode(V) --&amp;gt;
-  {outputMode(V)},
-  atom(V).
-
-outputMode(breadthfirst).
-outputMode(edgesfirst).
-outputMode(nodesfirst).
+outputMode(breadthfirst) --&amp;gt; &amp;quot;breadthfirst&amp;quot;.
+outputMode(edgesfirst)   --&amp;gt; &amp;quot;edgesfirst&amp;quot;.
+outputMode(nodesfirst)   --&amp;gt; &amp;quot;nodesfirst&amp;quot;.
 
 
 
@@ -264,18 +229,14 @@ outputMode(nodesfirst).
 
 %! pagedir(+PageDirection:atom)// .
 
-pagedir(V) --&amp;gt;
-  {pagedir(V)},
-  atom(V).
-
-pagedir(&#39;BL&#39;).
-pagedir(&#39;BR&#39;).
-pagedir(&#39;LB&#39;).
-pagedir(&#39;LT&#39;).
-pagedir(&#39;RB&#39;).
-pagedir(&#39;RT&#39;).
-pagedir(&#39;TL&#39;).
-pagedir(&#39;TR&#39;).
+pagedir(&#39;BL&#39;) --&amp;gt; &amp;quot;BL&amp;quot;.
+pagedir(&#39;BR&#39;) --&amp;gt; &amp;quot;BR&amp;quot;.
+pagedir(&#39;LB&#39;) --&amp;gt; &amp;quot;LB&amp;quot;.
+pagedir(&#39;LT&#39;) --&amp;gt; &amp;quot;LT&amp;quot;.
+pagedir(&#39;RB&#39;) --&amp;gt; &amp;quot;RB&amp;quot;.
+pagedir(&#39;RT&#39;) --&amp;gt; &amp;quot;RT&amp;quot;.
+pagedir(&#39;TL&#39;) --&amp;gt; &amp;quot;TL&amp;quot;.
+pagedir(&#39;TR&#39;) --&amp;gt; &amp;quot;TR&amp;quot;.
 
 
 
@@ -284,7 +245,7 @@ pagedir(&#39;TR&#39;).
 % `point(X:float,Y:float,Changeable:boolean)`.
 
 point(point(X,Y,Changeable)) --&amp;gt;
-  &#39;#&#39;(2, float, [X,Y], [separator(comma)]),
+  float(X), &amp;quot;,&amp;quot;, float(Y),
   input_changeable(Changeable).
 
 input_changeable(false) --&amp;gt; &amp;quot;&amp;quot;.
@@ -305,60 +266,44 @@ pointList(Points) --&amp;gt;
 
 %! quadType(+QuadType:atom)// .
 
-quadType(V) --&amp;gt;
-  {quadType(V)},
-  atom(V).
-
-quadType(fast).
-quadType(none).
-quadType(normal).
+quadType(fast) --&amp;gt; &amp;quot;fast&amp;quot;.
+quadType(none) --&amp;gt; &amp;quot;none&amp;quot;.
+quadType(normal) --&amp;gt; &amp;quot;normal&amp;quot;.
 
 
 
 %! rankType(+RankType:atom)// .
 
-rankType(V) --&amp;gt;
-  {rankType(V)},
-  atom(V).
-
-rankType(max).
-rankType(min).
-rankType(same).
-rankType(sink).
-rankType(source).
-
+rankType(max) --&amp;gt; &amp;quot;max&amp;quot;.
+rankType(min) --&amp;gt; &amp;quot;min&amp;quot;.
+rankType(same) --&amp;gt; &amp;quot;same&amp;quot;.
+rankType(sink) --&amp;gt; &amp;quot;sink&amp;quot;.
+rankType(source) --&amp;gt; &amp;quot;source&amp;quot;.
 
 
-%! rankdir(+RankDirection:atom)// .
 
-rankdir(V) --&amp;gt;
-  {rankdir(V)},
-  atom(V).
+%! rankdir(+RankDirection:oneof([&#39;BT&#39;,&#39;LR&#39;,&#39;RL&#39;,&#39;TB&#39;]))// .
 
-rankdir(&#39;BT&#39;).
-rankdir(&#39;LR&#39;).
-rankdir(&#39;RL&#39;).
-rankdir(&#39;TB&#39;).
+rankdir(&#39;BT&#39;) --&amp;gt; &amp;quot;BT&amp;quot;.
+rankdir(&#39;LR&#39;) --&amp;gt; &amp;quot;LR&amp;quot;.
+rankdir(&#39;RL&#39;) --&amp;gt; &amp;quot;RL&amp;quot;.
+rankdir(&#39;TB&#39;) --&amp;gt; &amp;quot;TB&amp;quot;.
 
 
 
 %! rect(+Rectangle:compound)// .
 
 rect(rect(LowerLeftX,LowerLeftY,UpperRightX,UpperRightY)) --&amp;gt;
-  &#39;#&#39;(
-    4,
-    float,
-    [LowerLeftX,LowerLeftY,UpperRightX,UpperRightY],
-    [separator(comma)]
-  ).
+  float(LowerLeftX), &amp;quot;,&amp;quot;,
+  float(LowerLeftY), &amp;quot;,&amp;quot;,
+  float(UpperRightX), &amp;quot;,&amp;quot;,
+  float(UpperRightY).
 
 
 
 %! shape(+Shape:atom)// .
 
-shape(V) --&amp;gt;
-  {polygon_based_shape(V)},
-  atom(V).
+shape(V) --&amp;gt; {polygon_based_shape(V)}, atom(V).
 
 polygon_based_shape(assembly).
 polygon_based_shape(box).
@@ -420,9 +365,7 @@ polygon_based_shape(utr).
 
 %! smoothType(+SmoothType:atom)// .
 
-smoothType(V) --&amp;gt;
-  {smoothType(V)},
-  atom(V).
+smoothType(V) --&amp;gt; {smoothType(V)}, atom(V).
 
 smoothType(avg_dist).
 smoothType(graph_dist).
@@ -445,16 +388,13 @@ smoothType(triangle).
 %! string(?String:atom)// .
 % A GraphViz string.
 
-string(Content) --&amp;gt;
-  quoted(atom(Content)).
+string(Content) --&amp;gt; &amp;quot;\&amp;quot;&amp;quot;, atom(Content), &amp;quot;\&amp;quot;&amp;quot;.
 
 
 
 %! style(?Context:oneof([cluster,edge,node]), ?Style:atom) is nondet.
 
-style(Context, Style) --&amp;gt;
-  {style(Context, Style)},
-  atom(Style).
+style(Context, Style) --&amp;gt; {style(Context, Style)}, atom(Style).
 
 style(cluster, bold).
 style(cluster, dashed).
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 0c3755c..3232c97 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -19,7 +19,6 @@
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/basics)).
-:- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(lists)).
 :- use_module(library(os/file_ext)).
@@ -36,7 +35,7 @@
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
   &amp;quot;#&amp;quot;,
-  &#39;#&#39;(3, hex_color, [Red,Green,Blue], []).
+  &#39;#&#39;(3, hex_color, [Red,Green,Blue]).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
   color(rgb(Red,Green,Blue)),
   hex_color(Alpha).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index d86c1b4..6877107 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -32,7 +32,6 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 :- use_module(library(dcg/dcg_abnf)).
 :- use_module(library(dcg/dcg_ascii)).
 :- use_module(library(dcg/dcg_content)).
-:- use_module(library(dcg/dcg_quoted)).
 :- use_module(library(gv/gv_attrs)).
 :- use_module(library(gv/gv_html)).
 :- use_module(library(error)).
@@ -114,9 +113,7 @@ gv_generic_attributes_statement(Kind, I, Attrs) --&amp;gt;
 
 %! gv_kind(+Kind:oneof([edge,graph,node]))// .
 
-gv_kind(Kind) --&amp;gt;
-  {must_be(oneof([edge,graph,node]), Kind)},
-  atom(Kind).
+gv_kind(Kind) --&amp;gt; {must_be(oneof([edge,graph,node]), Kind)}, atom(Kind).
 
 
 
@@ -144,7 +141,7 @@ gv_ranked_node_collection(I, RankVTerm-VTerms) --&amp;gt;
   &amp;quot;\n&amp;quot;,
 
   % Vertice statements.
-  *(gv_node_statement(NewI), [RankVTerm|VTerms], []),
+  *(gv_node_statement(NewI), [RankVTerm|VTerms]),
 
   % We want to indent the closing curly brace.
   tab(I),
@@ -161,8 +158,7 @@ gv_ranked_node_collection(I, RankVTerm-VTerms) --&amp;gt;
 %!   +Attributes:list(compound)
 %! )// is det.
 
-gv_attrs(Kind, L) --&amp;gt;
-  &amp;quot;[&amp;quot;, *(gv_attr(Kind), L, []), &amp;quot;]&amp;quot;.
+gv_attrs(Kind, L) --&amp;gt; &amp;quot;[&amp;quot;, *(gv_attr(Kind), L), &amp;quot;]&amp;quot;.
 
 
 %! gv_attr(+Context:oneof([edge,graph,node]), +Attribute:compound)// is det.
@@ -221,19 +217,16 @@ gv_id(Atom) --&amp;gt;
 %! gv_id_first(+First:code)// is det.
 % Generates the first character of a GraphViz identifier.
 
-gv_id_first(X) --&amp;gt;
-  ascii_letter(X).
-gv_id_first(X) --&amp;gt;
-  underscore(X).
+gv_id_first(C)   --&amp;gt; ascii_alpha(C), !.
+gv_id_first(0&#39;_) --&amp;gt; &amp;quot;_&amp;quot;.
 
 
 %! gv_id_rest(+NonFirst:code)// is det.
 % Generates a non-first character of a GraphViz identifier.
 
-gv_id_rest([]) --&amp;gt; !, &amp;quot;&amp;quot;.
-gv_id_rest([H|T]) --&amp;gt;
-  (ascii_alpha_numeric(H) ; underscore(H)),
-  gv_id_rest(T).
+gv_id_rest([H|T])   --&amp;gt; ascii_alpha_num(C), !, gv_id_rest(T).
+gv_id_rest([0&#39;_|T]) --&amp;gt; &amp;quot;_&amp;quot;,                !, gv_id_rest(T).
+gv_id_rest([])      --&amp;gt; &amp;quot;&amp;quot;.
 
 
 
@@ -267,34 +260,22 @@ gv_keyword --&amp;gt; &amp;quot;subgraph&amp;quot;.
 % @tbd Add support for GraphViz port indicators
 %      inside GraphViz node identifiers.
 
-gv_node_id(Id) --&amp;gt;
-  gv_id(Id), !.
-%gv_node_id(_) --&amp;gt;
-%  gv_id(_),
-%  gv_port.
-gv_node_id(Id) --&amp;gt;
-  {type_error(gv_node_id, Id)}.
+gv_node_id(Id) --&amp;gt; gv_id(Id), !.
+%gv_node_id(_) --&amp;gt; gv_id(_), gv_port.
+gv_node_id(Id) --&amp;gt; {type_error(gv_node_id, Id)}.
 
 
 
 %! gv_port// is det.
 
-gv_port --&amp;gt;
-  gv_port_location,
-  (gv_port_angle ; &amp;quot;&amp;quot;).
-gv_port --&amp;gt;
-  gv_port_angle,
-  (gv_port_location ; &amp;quot;&amp;quot;).
-gv_port --&amp;gt;
-  &amp;quot;:&amp;quot;, gv_compass_pt(_).
+gv_port --&amp;gt; gv_port_location, (gv_port_angle ; &amp;quot;&amp;quot;).
+gv_port --&amp;gt; gv_port_angle, (gv_port_location ; &amp;quot;&amp;quot;).
+gv_port --&amp;gt; &amp;quot;:&amp;quot;, gv_compass_pt(_).
 
-gv_port_angle --&amp;gt;
-  &amp;quot;@&amp;quot;, gv_id(_).
+gv_port_angle --&amp;gt; &amp;quot;@&amp;quot;, gv_id(_).
 
-gv_port_location --&amp;gt;
-  &amp;quot;:&amp;quot;, gv_id(_).
-gv_port_location --&amp;gt;
-  &amp;quot;:[&amp;quot;, gv_id(_), &amp;quot;,&amp;quot;, gv_id(_), &amp;quot;]&amp;quot;.
+gv_port_location --&amp;gt; &amp;quot;:&amp;quot;, gv_id(_).
+gv_port_location --&amp;gt; &amp;quot;:[&amp;quot;, gv_id(_), &amp;quot;,&amp;quot;, gv_id(_), &amp;quot;]&amp;quot;.
 
 
 
@@ -304,12 +285,12 @@ gv_port_location --&amp;gt;
 % ```
 
 gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
-gv_compass_pt(c) --&amp;gt; &amp;quot;c&amp;quot;.
-gv_compass_pt(e) --&amp;gt; &amp;quot;e&amp;quot;.
-gv_compass_pt(n) --&amp;gt; &amp;quot;n&amp;quot;.
-gv_compass_pt(ne) --&amp;gt; &amp;quot;ne&amp;quot;.
-gv_compass_pt(nw) --&amp;gt; &amp;quot;nw&amp;quot;.
-gv_compass_pt(s) --&amp;gt; &amp;quot;s&amp;quot;.
-gv_compass_pt(se) --&amp;gt; &amp;quot;se&amp;quot;.
-gv_compass_pt(sw) --&amp;gt; &amp;quot;sw&amp;quot;.
-gv_compass_pt(w) --&amp;gt; &amp;quot;w&amp;quot;.
+gv_compass_pt(c)   --&amp;gt; &amp;quot;c&amp;quot;.
+gv_compass_pt(e)   --&amp;gt; &amp;quot;e&amp;quot;.
+gv_compass_pt(n)   --&amp;gt; &amp;quot;n&amp;quot;.
+gv_compass_pt(ne)  --&amp;gt; &amp;quot;ne&amp;quot;.
+gv_compass_pt(nw)  --&amp;gt; &amp;quot;nw&amp;quot;.
+gv_compass_pt(s)   --&amp;gt; &amp;quot;s&amp;quot;.
+gv_compass_pt(se)  --&amp;gt; &amp;quot;se&amp;quot;.
+gv_compass_pt(sw)  --&amp;gt; &amp;quot;sw&amp;quot;.
+gv_compass_pt(w)   --&amp;gt; &amp;quot;w&amp;quot;.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;141&#34;&gt; 141: 正在比较变动前 0d2712a 和变动后 3518985 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 71f9dd4..2428483 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -51,7 +51,7 @@ Vertex coordinates:
 ---
 
 @author Wouter Beek
-@version 2015/07, 2015/09-2015/11
+@version 2015/07, 2015/09-2015/12
 */
 
 :- use_module(library(apply)).
@@ -222,8 +222,9 @@ edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
   if_option(edge_style(StyleFunction), Opts,
     call(StyleFunction, E, EStyle)
   ),
-
-  merge_options(
+  
+  exclude(
+    option_has_var_value,
     [
       arrowhead(EArrowhead),
       color(EColor),
@@ -275,7 +276,8 @@ graph_attributes(GAttrs, Opts):-
   % Overlap.
   option(graph_overlap(Overlap), Opts, false),
 
-  merge_options(
+  exclude(
+    option_has_var_value,
     [
       charset(Charset),
       colorscheme(Colorscheme),
@@ -361,7 +363,8 @@ vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-
     call(UriFunction, V, VUri)
   ),
 
-  merge_options(
+  exclude(
+    option_has_var_value,
     [
       color(VColor),
       image(VImage),
@@ -385,17 +388,3 @@ vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-
 edge_components(edge(FromV,_,ToV), FromV, ToV):- !.
 edge_components(edge(FromV,ToV), FromV, ToV):- !.
 edge_components(FromV-ToV, FromV, ToV):- !.
-
-
-
-%! merge_options(+FromOptions:list(compound), -ToOptions:list(compound)) is det.
-
-merge_options([], []).
-% Skip uninstantiated values.
-merge_options([H|T1], T2):-
-  merge_options(T1, T2),
-  H =.. [_,V],
-  var(V), !.
-% Include instantiated values.
-merge_options([H|T1], [H|T2]):-
-  merge_options(T1, T2).
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index a9e1a42..5c937ce 100644
--- a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -15,11 +15,11 @@ In GraphViz vertices are called &#39;nodes&#39;.
 ---
 
 @author Wouter Beek
-@version 2015/07
+@version 2015/07, 2015/12
 */
 
 :- use_module(library(apply)).
-:- use_module(library(dcg/dcg_abnf)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(gv/gv_graph_comp)).
 :- use_module(library(lists)).
@@ -29,7 +29,13 @@ In GraphViz vertices are called &#39;nodes&#39;.
 
 
 
-%! gv_graph(+Graph:compound)//
+%! gv_graph(+Graph:compound)// is det.
+% Wrapper around gv_graph//2 with no indentation.
+
+gv_graph(G) --&amp;gt; gv_graph(G, 0).
+
+
+%! gv_graph(+Graph:compound, +Indent:nonneg)// is det.
 % The follow graph attributes are supported,
 % beyond the GraphViz attributes for graphs:
 %   * `directed(+boolean)`
@@ -61,9 +67,6 @@ In GraphViz vertices are called &#39;nodes&#39;.
 % @tbd Assert attributes that are generic with respect to a subgraph.
 % @tbd Not all vertex and edge properties can be shared it seems (e.g., label).
 
-gv_graph(G) --&amp;gt;
-  gv_graph(G, 0).
-
 gv_graph(G1, I) --&amp;gt;
   {
     include_ranks(G1, G2),
@@ -122,26 +125,20 @@ gv_graph(G1, I) --&amp;gt;
 
   % The list of GraphViz nodes.
   gv_node_statements(NewI, NewVTerms),
-  (   {NewVTerms == []}
-  -&amp;gt;  &amp;quot;&amp;quot;
-  ;   &amp;quot;\n&amp;quot;
-  ),
+  ({NewVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; &amp;quot;\n&amp;quot;),
 
   % The ranked GraphViz nodes (displayed at the same height).
   gv_ranked_node_collections(NewI, RankedVTerms),
-  (   {RankedVTerms == []}
-  -&amp;gt;  &amp;quot;&amp;quot;
-  ;   &amp;quot;\n&amp;quot;
-  ),
+  ({RankedVTerms == []} -&amp;gt; &amp;quot;&amp;quot; ; &amp;quot;\n&amp;quot;),
 
   {
     findall(
       edge(FromId,ToId,[]),
       (
-        nth0(Index1, RankedVTerms, rank(vertex(FromId,_),_)),
-        nth0(Index2, RankedVTerms, rank(vertex(ToId,_),_)),
+        nth0(J1, RankedVTerms, rank(vertex(FromId,_),_)),
+        nth0(J2, RankedVTerms, rank(vertex(ToId,_),_)),
         % We assume that the rank vertices are nicely ordered.
-        succ(Index1, Index2)
+        succ(J1, J2)
       ),
       RankEdges
     )
@@ -159,14 +156,27 @@ gv_graph(G1, I) --&amp;gt;
   tab(I),
   &amp;quot;}\n&amp;quot;.
 
-gv_edge_statements(I, Dir, L) --&amp;gt;
-  *(gv_edge_statement(I, Dir), L, []), !.
 
-gv_node_statements(I, L) --&amp;gt;
-  *(gv_node_statement(I), L, []), !.
 
-gv_ranked_node_collections(I, L) --&amp;gt;
-  *(gv_ranked_node_collection(I), L, []), !.
+%! gv_edge_statements(
+%!   +Indent:nonneg,
+%!   +Directed:boolean,
+%!   +Statements:list(compound)
+%! )// is det.
+
+gv_edge_statements(I, Dir, L) --&amp;gt; *(gv_edge_statement(I, Dir), L).
+
+
+
+%! gv_edge_statements(+Indent:nonneg, +Statements:list(compound))// is det.
+
+gv_node_statements(I, L) --&amp;gt; *(gv_node_statement(I), L).
+
+
+
+%! gv_ranked_node_collections(+Indent:nonneg, +Collections:list)// is det.
+
+gv_ranked_node_collections(I, L) --&amp;gt; *(gv_ranked_node_collection(I), L).
 
 
 
@@ -189,11 +199,13 @@ add_default(L1, Opt, L2):-
   ).
 
 
+
 %! gv_graph_type(+Directed:boolean)// is det.
 % The type of graph that is represented.
 
-gv_graph_type(false) --&amp;gt; &amp;quot;graph&amp;quot;.
-gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
+gv_graph_type(false) --&amp;gt; !, &amp;quot;graph&amp;quot;.
+gv_graph_type(true)  --&amp;gt;    &amp;quot;digraph&amp;quot;.
+
 
 
 %! gv_strict(+Strict:boolean)// is det.
@@ -201,18 +213,20 @@ gv_graph_type(true) --&amp;gt; &amp;quot;digraph&amp;quot;.
 % no multi-edges.
 % This only applies to directed graphs.
 
-gv_strict(false) --&amp;gt; &amp;quot;&amp;quot;.
-gv_strict(true) --&amp;gt; &amp;quot;strict &amp;quot;.
+gv_strict(false) --&amp;gt; !, &amp;quot;&amp;quot;.
+gv_strict(true)  --&amp;gt;    &amp;quot;strict &amp;quot;.
+
 
 
 %! invlude_ranges(+Graph:compound, -GraphWithRanks:compound) is det.
 % Ensures that there is a ranks components in
 % the graph-denoting compound term.
 
-include_ranks(graph(Vs,Rs,Es,L), graph(Vs,Rs,Es,L)).
+include_ranks(graph(Vs,Rs,Es,L), graph(Vs,Rs,Es,L)):- !.
 include_ranks(graph(Vs,Es,L), graph(Vs,[],Es,L)).
 
 
+
 %! shared_attributes(
 %!   +Terms:list(compound),
 %!   -SharedAttributes:list(compound),
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 6877107..8bfc9a2 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -24,13 +24,11 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/dot-language
-@version 2015/07-2015/08, 2015/10-2015/11
+@version 2015/07-2015/08, 2015/10-2015/12
 */
 
 :- use_module(library(apply)).
-:- use_module(library(dcg/basics)).
-:- use_module(library(dcg/dcg_abnf)).
-:- use_module(library(dcg/dcg_ascii)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(gv/gv_attrs)).
 :- use_module(library(gv/gv_html)).
@@ -166,7 +164,7 @@ gv_attrs(Kind, L) --&amp;gt; &amp;quot;[&amp;quot;, *(gv_attr(Kind), L), &amp;quot;]&amp;quot;.
 % We assume that the attribute has already been validated.
 
 gv_attr(Context, Attr) --&amp;gt;
-  {Attr =.. [N,V]},
+  {Attr =.. [N,V], (N == peripheries -&amp;gt; gtrace ; true)},
   gv_id(N), &amp;quot;=&amp;quot;, gv_attr_value(Context, N=V), &amp;quot;;&amp;quot;.
 
 
@@ -217,15 +215,15 @@ gv_id(Atom) --&amp;gt;
 %! gv_id_first(+First:code)// is det.
 % Generates the first character of a GraphViz identifier.
 
-gv_id_first(C)   --&amp;gt; ascii_alpha(C), !.
+gv_id_first(C)   --&amp;gt; alpha(C), !.
 gv_id_first(0&#39;_) --&amp;gt; &amp;quot;_&amp;quot;.
 
 
 %! gv_id_rest(+NonFirst:code)// is det.
 % Generates a non-first character of a GraphViz identifier.
 
-gv_id_rest([H|T])   --&amp;gt; ascii_alpha_num(C), !, gv_id_rest(T).
-gv_id_rest([0&#39;_|T]) --&amp;gt; &amp;quot;_&amp;quot;,                !, gv_id_rest(T).
+gv_id_rest([H|T])   --&amp;gt; alphadigit(H), !, gv_id_rest(T).
+gv_id_rest([0&#39;_|T]) --&amp;gt; &amp;quot;_&amp;quot;,           !, gv_id_rest(T).
 gv_id_rest([])      --&amp;gt; &amp;quot;&amp;quot;.
 
 
diff --git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
index 5f2db03..3ee7de6 100644
--- a/prolog/gv/gv_html.pl
+++ b/prolog/gv/gv_html.pl
@@ -40,11 +40,10 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/node-shapes#html
-@version 2015/07
+@version 2015/07, 2015/12
 */
 
-:- use_module(library(dcg/dcg_abnf)).
-:- use_module(library(dcg/dcg_bracketed)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(html/html_dcg)).
 
@@ -52,14 +51,13 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 
 
 
-%! gv_html_like_label(?Content:compound)// .
+%! gv_html_like_label(+Content:compound)// is det.
 
-gv_html_like_label(Content) --&amp;gt;
-  bracketed(angular, label(Content)).
+gv_html_like_label(Content) --&amp;gt; &amp;quot;&amp;lt;&amp;quot;, label(Content), &amp;quot;&amp;gt;&amp;quot;.
 
 
 
-%! cell(?Contents:compound)// .
+%! cell(+Contents:compound)// is det.
 % Supported attributes for `TD`:
 %   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT|TEXT&amp;quot;`
 %   - `BALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
@@ -88,65 +86,47 @@ gv_html_like_label(Content) --&amp;gt;
 %   - `SCALE=&amp;quot;FALSE|TRUE|WIDTH|HEIGHT|BOTH&amp;quot;`
 %   - `SRC=&amp;quot;value&amp;quot;`
 
-cell(td(Contents)) --&amp;gt;
+cell(td(Contents)) --&amp;gt; !,
   cell(td([],Contents)).
 cell(td(Attrs1,Image)) --&amp;gt;
-  {(  Image =.. [img,Attrs2]
-  -&amp;gt;  true
-  ;   Image == img
-  -&amp;gt;  Attrs2 = []
-  )},
+  {(Image =.. [img,Attrs2] -&amp;gt; true ; Image == img -&amp;gt; Attrs2 = [])}, !,
   html_element(td, Attrs1, html_element(img,Attrs2)).
 cell(td(Attrs,Contents)) --&amp;gt;
   html_element(td, Attrs, label(Contents)).
 
 
 
-%! cells(?Contents:list(compound))// .
+%! cells(+Contents:list(compound))// is det.
 
-cells([H|T]) --&amp;gt;
-  cell(H),
-  cells(T).
-cells([H,vr|T]) --&amp;gt;
-  cell(H),
-  html_element(vr),
-  cells(T).
-cells([H]) --&amp;gt;
-  cell(H).
+cells([H,vr|T]) --&amp;gt; !, cell(H), html_element(vr), cells(T).
+cells([H|T])    --&amp;gt; !, cell(H), cells(T).
+cells([])       --&amp;gt; &amp;quot;&amp;quot;.
 
 
 
-%! label(?Content:compound)// .
+%! label(+Content:compound)// is det.
 % GraphViz HTML-like label.
 
-label(Content) --&amp;gt;
-  table(Content).
-label(Content) --&amp;gt;
-  text(Content).
+label(Content) --&amp;gt; table(Content), !.
+label(Content) --&amp;gt; text(Content).
 
 
 
-%! row(?Contents:compound)// .
+%! row(+Contents:compound)// is det.
 
-row(tr(Contents)) --&amp;gt;
-  html_element(tr, [], cells(Contents)).
+row(tr(Contents)) --&amp;gt; html_element(tr, [], cells(Contents)).
 
 
 
-%! rows(?Contents:list)// .
+%! rows(+Contents:list)// is det.
 
-rows([H|T]) --&amp;gt;
-  row(H),
-  rows(T).
-rows([hr|T]) --&amp;gt;
-  html_element(hr),
-  rows(T).
-rows([H]) --&amp;gt;
-  row(H).
+rows([hr|T]) --&amp;gt; !, html_element(hr), rows(T).
+rows([H|T]) --&amp;gt; row(H), !, rows(T).
+rows([]) --&amp;gt; &amp;quot;&amp;quot;.
 
 
 
-%! table(?Contents:compound)// .
+%! table(+Contents:compound)// is det.
 % ```
 % table : [ &amp;lt;FONT&amp;gt; ] &amp;lt;TABLE&amp;gt; rows &amp;lt;/TABLE&amp;gt; [ &amp;lt;/FONT&amp;gt; ]
 % ```
@@ -188,11 +168,11 @@ rows([H]) --&amp;gt;
 %   - `FACE=&amp;quot;fontname&amp;quot;`
 %   - `POINT-SIZE=&amp;quot;value&amp;quot;`
 
-table(table(Contents)) --&amp;gt;
+table(table(Contents)) --&amp;gt; !,
   table(table([],Contents)).
-table(table(Attrs,Contents)) --&amp;gt;
+table(table(Attrs,Contents)) --&amp;gt; !,
   html_element(table, Attrs, rows(Contents)).
-table(font(Table)) --&amp;gt;
+table(font(Table)) --&amp;gt; !,
   table(font([],Table)).
 table(font(Attrs1,Table)) --&amp;gt;
   {(  Table =.. [table,Attrs2,Contents]
@@ -204,21 +184,18 @@ table(font(Attrs1,Table)) --&amp;gt;
 
 
 
-%! text(?Contents:list)// .
+%! text(+Contents:list)// .
 % ```
 % text :   textitem
 %        | text textitem
 % ```
 
-text(Contents) --&amp;gt;
-  {is_list(Contents)}, !,
-  &#39;+&#39;(textitem, Contents, []).
-text(Content) --&amp;gt;
-  text([Content]).
+text(Contents) --&amp;gt; {is_list(Contents)}, !, &#39;+&#39;(textitem, Contents).
+text(Content)  --&amp;gt; text([Content]).
 
 
 
-%! textitem(?Content:compound)// .
+%! textitem(+Content:compound)// .
 % ```
 % textitem :   string
 %            | &amp;lt;BR/&amp;gt;
@@ -235,7 +212,7 @@ text(Content) --&amp;gt;
 % Supported attributes for BR:
 %   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
 
-textitem(br(Attrs)) --&amp;gt;
+textitem(br(Attrs)) --&amp;gt; !,
   html_element(br, Attrs).
 % Compound term: parser.
 textitem(Compound) --&amp;gt;
@@ -248,7 +225,7 @@ textitem(Compound) --&amp;gt;
 % Compound term: generator.
 textitem(Compound) --&amp;gt;
   {
-    Compound =.. [Name,Content],
+    Compound =.. [Name,Content], !,
     supported_html_element(Name)
   },
   html_element(Name, _, text(Content)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;142&#34;&gt; 142: 正在比较变动前 3518985 和变动后 322ca62 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_export.pl b/prolog/fca/fca_viz.pl
similarity index 59%
rename from prolog/fca/fca_export.pl
rename to prolog/fca/fca_viz.pl
index 03353e3..36393de 100644
--- a/prolog/fca/fca_export.pl
+++ b/prolog/fca/fca_viz.pl
@@ -1,18 +1,21 @@
 :- module(
-  fca_export,
+  fca_viz,
   [
-    fca_export/2, % +Context:compound
-                  % ?File:atom
-    fca_export/3 % +Context:compound
-                 % ?File:atom
-                 % :Options:list(compound)
+    fca_export_graph/2, % +Context, -ExportGraph
+    fca_export_graph/3, % +Context:compound
+                        % -ExportGraph:compound
+                        % :Options:list(compound)
+    fca_viz/2, % +Context, ?File
+    fca_viz/3 % +Context:compound
+              % ?File:atom
+              % :Options:list(compound)
   ]
 ).
 
-/** &amp;lt;module&amp;gt; FCA export
+/** &amp;lt;module&amp;gt; FCA visualization
 
 @author Wouter Beek
-@version 2015/11
+@version 2015/11-2015/12
 */
 
 :- use_module(library(dcg/dcg_collection)).
@@ -27,11 +30,16 @@
 
 :- meta_predicate(concept_label(+,1,1,+,-)).
 :- meta_predicate(concept_label(+,1,1,+,?,?)).
-:- meta_predicate(fca_export(+,?,:)).
+:- meta_predicate(fca_export_graph(+,?,:)).
+:- meta_predicate(fca_viz(+,?,:)).
 
-:- predicate_options(fca_export/3, 3, [
+:- predicate_options(fca_export_graph/3, 3, [
+     attribute_label(+callable),
      concept_label(+oneof([attributes,both,objects])),
-     object_label(+callable),
+     object_label(+callable)
+   ]).
+:- predicate_options(fca_viz/3, 3, [
+     pass_to(fca_export_graph/3, 3),
      pass_to(gv_export/3, 3)
    ]).
 
@@ -42,14 +50,18 @@ is_meta(object_label).
 
 
 
-%! fca_export(+Context:compound, ?File:atom) is det.
-% Wrapper around fca_export/3 with default options.
+%! fca_export_graph(+Context:compound, -ExportGraph:compound) is det.
+% Wrapper around fca_export_graph/3 with default options.
 
-fca_export(Context, File):-
-  fca_export(Context, File, []).
+fca_export_graph(Context, ExportG):-
+  fca_export_graph(Context, ExportG, []).
 
 
-%! fca_export(+Context:compound, ?File:atom, :Options:list(compound)) is det.
+%! fca_export_graph(
+%!   +Context:compound,
+%!   -ExportGraph:compound,
+%!   :Options:list(compound)
+%! ) is det.
 % The following optios are supported:
 %   * attribute_label(+callable)
 %     DCG writing the labels for individual attributes.
@@ -62,24 +74,36 @@ fca_export(Context, File):-
 %     DCG writing the labels for individual objects.
 %     Default is pl_term//1.
 
-fca_export(Context, File, Opts1):-
+fca_export_graph(Context, ExportG, Opts1):-
   fca_hasse(Context, Hasse),
-  
   meta_options(is_meta, Opts1, Opts2),
   option(attribute_label(ALbl_1), Opts2, pl_term),
   option(concept_label(Mode), Opts2, both),
   option(object_label(OLbl_1), Opts2, pl_term),
   merge_options(
     [
-      vertex_label(fca_export:concept_label(Mode, OLbl_1, ALbl_1)),
+      vertex_label(fca_viz:concept_label(Mode, OLbl_1, ALbl_1)),
       vertex_rank(fca:concept_cardinality)
     ],
     Opts2,
     Opts3
   ),
-  build_export_graph(Hasse, ExportG, Opts3),
+  build_export_graph(Hasse, ExportG, Opts3).
+
+
+
+%! fca_viz(+Context:compound, ?File:atom) is det.
+% Wrapper around fca_viz/3 with default options.
+
+fca_viz(Context, File):-
+  fca_viz(Context, File, []).
+
+
+%! fca_viz(+Context:compound, ?File:atom, :Options:list(compound)) is det.
 
-  gv_export(ExportG, File, Opts2).
+fca_viz(Context, File, Opts):-
+  fca_export_graph(Context, ExportG, Opts),
+  gv_export(ExportG, File, Opts).
 
 
 
diff --git a/test/test.pl b/test/test.pl
index 5ce2db0..470acce 100644
--- a/test/test.pl
+++ b/test/test.pl
@@ -1,5 +1,5 @@
 %/fca
-  :- use_module(library(fca/fca_export)).
+  :- use_module(library(fca/fca_viz)).
 %/graph
   :- use_module(library(graph/build_export_graph)).
 %/gv
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;143&#34;&gt; 143: 正在比较变动前 322ca62 和变动后 c4bf9ea &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index 36393de..5ff8cf5 100644
--- a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -12,7 +12,7 @@
   ]
 ).
 
-/** &amp;lt;module&amp;gt; FCA visualization
+/** &amp;lt;module&amp;gt; FCA export
 
 @author Wouter Beek
 @version 2015/11-2015/12
@@ -30,7 +30,7 @@
 
 :- meta_predicate(concept_label(+,1,1,+,-)).
 :- meta_predicate(concept_label(+,1,1,+,?,?)).
-:- meta_predicate(fca_export_graph(+,?,:)).
+:- meta_predicate(fca_export_graph(+,-,:)).
 :- meta_predicate(fca_viz(+,?,:)).
 
 :- predicate_options(fca_export_graph/3, 3, [
@@ -49,7 +49,6 @@ is_meta(object_label).
 
 
 
-
 %! fca_export_graph(+Context:compound, -ExportGraph:compound) is det.
 % Wrapper around fca_export_graph/3 with default options.
 
@@ -60,7 +59,7 @@ fca_export_graph(Context, ExportG):-
 %! fca_export_graph(
 %!   +Context:compound,
 %!   -ExportGraph:compound,
-%!   :Options:list(compound)
+%!   +Options:list(compound)
 %! ) is det.
 % The following optios are supported:
 %   * attribute_label(+callable)
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 2428483..6dbb4f7 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -1,8 +1,7 @@
 :- module(
   build_export_graph,
   [
-    build_export_graph/2, % +Graph
-                          % -ExportGraph:compound
+    build_export_graph/2, % +Graph, -ExportGraph
     build_export_graph/3 % +Graph
                          % -ExportGraph:compound
                          % +Options:list(compound)
@@ -118,7 +117,7 @@ is_meta(vertex_uri).
 
 
 %! build_export_graph(+Graph, -ExportGraph:compound) is det.
-% Wrapper around build_export_graph/3.
+% Wrapper around build_export_graph/3 with default options.
 
 build_export_graph(G, ExportG):-
   build_export_graph(G, ExportG, []).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 8bfc9a2..aecbe07 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -164,7 +164,7 @@ gv_attrs(Kind, L) --&amp;gt; &amp;quot;[&amp;quot;, *(gv_attr(Kind), L), &amp;quot;]&amp;quot;.
 % We assume that the attribute has already been validated.
 
 gv_attr(Context, Attr) --&amp;gt;
-  {Attr =.. [N,V], (N == peripheries -&amp;gt; gtrace ; true)},
+  {Attr =.. [N,V]},
   gv_id(N), &amp;quot;=&amp;quot;, gv_attr_value(Context, N=V), &amp;quot;;&amp;quot;.
 
 
diff --git a/test/test.pl b/test/test.pl
index 470acce..c1bdca0 100644
--- a/test/test.pl
+++ b/test/test.pl
@@ -1,13 +1,13 @@
 %/fca
-  :- use_module(library(fca/fca_viz)).
+:- use_module(library(fca/fca_viz)).
 %/graph
-  :- use_module(library(graph/build_export_graph)).
+:- use_module(library(graph/build_export_graph)).
 %/gv
-  :- use_module(library(gv/gv_attrs)).
-  :- use_module(library(gv/gv_attr_type)).
-  :- use_module(library(gv/gv_color)).
-  :- use_module(library(gv/gv_file)).
-  :- use_module(library(gv/gv_graph)).
-  :- use_module(library(gv/gv_graph_comp)).
-  :- use_module(library(gv/gv_html)).
-  :- use_module(library(gv/gv_numeral)).
+:- use_module(library(gv/gv_attrs)).
+:- use_module(library(gv/gv_attr_type)).
+:- use_module(library(gv/gv_color)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(gv/gv_graph)).
+:- use_module(library(gv/gv_graph_comp)).
+:- use_module(library(gv/gv_html)).
+:- use_module(library(gv/gv_numeral)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;144&#34;&gt; 144: 正在比较变动前 c4bf9ea 和变动后 2a6dafd &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index 5ff8cf5..ef6a632 100644
--- a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -12,7 +12,7 @@
   ]
 ).
 
-/** &amp;lt;module&amp;gt; FCA export
+/** &amp;lt;module&amp;gt; FCA visualization
 
 @author Wouter Beek
 @version 2015/11-2015/12
@@ -30,7 +30,7 @@
 
 :- meta_predicate(concept_label(+,1,1,+,-)).
 :- meta_predicate(concept_label(+,1,1,+,?,?)).
-:- meta_predicate(fca_export_graph(+,-,:)).
+:- meta_predicate(fca_export_graph(+,?,:)).
 :- meta_predicate(fca_viz(+,?,:)).
 
 :- predicate_options(fca_export_graph/3, 3, [
@@ -59,7 +59,7 @@ fca_export_graph(Context, ExportG):-
 %! fca_export_graph(
 %!   +Context:compound,
 %!   -ExportGraph:compound,
-%!   +Options:list(compound)
+%!   :Options:list(compound)
 %! ) is det.
 % The following optios are supported:
 %   * attribute_label(+callable)
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;145&#34;&gt; 145: 正在比较变动前 2a6dafd 和变动后 145615e &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index ef6a632..1a15ef5 100644
--- a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -100,9 +100,10 @@ fca_viz(Context, File):-
 
 %! fca_viz(+Context:compound, ?File:atom, :Options:list(compound)) is det.
 
-fca_viz(Context, File, Opts):-
-  fca_export_graph(Context, ExportG, Opts),
-  gv_export(ExportG, File, Opts).
+fca_viz(Context, File, Opts1):-
+  meta_options(is_meta, Opts1, Opts2),
+  fca_export_graph(Context, ExportG, Opts2),
+  gv_export(ExportG, File, Opts2).
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;146&#34;&gt; 146: 正在比较变动前 145615e 和变动后 f16acca &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
index 190b988..bcc7654 100644
--- a/data/gv_attrs_scrape.pl
+++ b/data/gv_attrs_scrape.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_attrs_scrape,
   [
-    gv_attrs_scrape/1 % +File:atom
+    gv_attrs_scrape/1 % +File
   ]
 ).
 
@@ -11,46 +11,41 @@ Writes compound terms of the following form to file:
 
 ```prolog
 gv_attr(
-  ?Name:atom,
+  ?Name,
   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
   ?Types:list(atom),
   ?Default,
   ?Minimum,
-  ?Notes:atom
+  ?Notes
 ) is nondet.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/10
+@version 2015/10, 2016/07
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(dcg/basics), except([string//1])).
-:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(debug)).
:- use_module(library(gv/gv_attr_type)).
:- use_module(library(http/http_download)).
-:- use_module(library(iostream)).
:- use_module(library(lists)).
-:- use_module(library(msg_ext)).
-:- use_module(library(pl/pl_term)).
+:- use_module(library(os/io)).
+:- use_module(library(pl_term)).
+:- use_module(library(print_ext)).
:- use_module(library(xpath)).
:- use_module(library(xpath/xpath_table)).
+:- use_module(library(yall)).&lt;/p&gt;
&lt;p&gt;-%! gv_attrs_scrape(+File:atom) is det.
+%! gv_attrs_scrape(+File) is det.&lt;/p&gt;
&lt;p&gt;gv_attrs_scrape(File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;setup_call_cleanup(&lt;/li&gt;
&lt;li&gt;open_any(File, write, Write, Close, []),&lt;/li&gt;
&lt;li&gt;verbose(&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; gv_attrs_download(Write),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; &amp;quot;Updating the GraphViz attributes table.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;close_any(Close)&lt;/li&gt;
&lt;li&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;debug(gv, &amp;ldquo;Updating the GraphViz attributes table.&amp;rdquo;, []),&lt;/li&gt;
&lt;li&gt;call_to_stream(File, [In,Meta,Meta]&amp;raquo;gv_attrs_download(In)).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;gv_attrs_download(Write):-
@@ -79,7 +74,7 @@ gv_attrs_iri(&amp;lsquo;&lt;a href=&#34;http://www.graphviz.org/doc/info/attrs.html%27%29&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.graphviz.org/doc/info/attrs.html&#39;)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;% HELPERS %&lt;/p&gt;
&lt;p&gt;-%! translate_default(+Default1:atom, -Default2:atom) is det.
+%! translate_default(+Default1, -Default2) is det.&lt;/p&gt;
&lt;p&gt;% The empty string is represented by the empty atom.
translate_default(&#39;&amp;quot;&amp;quot;&amp;rsquo;, &amp;lsquo;&#39;):- !.
diff &amp;ndash;git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
index 3ac5d44..102a02a 100644
&amp;mdash; a/data/gv_color_scrape.pl
+++ b/data/gv_color_scrape.pl
@@ -1,40 +1,36 @@
:- module(
gv_color_scrape,
[&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_color_scrape/1 % +File:atom&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_color_scrape/1 % +File
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; GraphViz: Scrape colors&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/10
+@version 2015/10, 2016/07
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
+:- use_module(library(debug)).
:- use_module(library(http/http_download)).
-:- use_module(library(iostream)).
:- use_module(library(lists)).
-:- use_module(library(msg_ext)).
-:- use_module(library(pl/pl_term)).
+:- use_module(library(os/io)).
+:- use_module(library(pl_term)).
+:- use_module(library(print_ext)).
:- use_module(library(xpath)).
:- use_module(library(xpath/xpath_table)).
+:- use_module(library(yall)).&lt;/p&gt;
&lt;p&gt;-%! gv_color_scrape(+File:atom) is det.
+%! gv_color_scrape(+File) is det.&lt;/p&gt;
&lt;p&gt;gv_color_scrape(File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;setup_call_cleanup(&lt;/li&gt;
&lt;li&gt;open_any(File, write, Write, Close, []),&lt;/li&gt;
&lt;li&gt;verbose(&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; gv_color_download(Write),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; &amp;quot;Updating the GraphViz color table.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;close_any(Close)&lt;/li&gt;
&lt;li&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;debug(io, &amp;ldquo;Updating the GraphViz color table.&amp;rdquo;, []),&lt;/li&gt;
&lt;li&gt;call_to_stream(File, [In,Meta,Meta]&amp;raquo;gv_color_download(In)).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;gv_color_download(Write):-
diff &amp;ndash;git a/pack.pl b/pack.pl
index 203cbfc..989108a 100644
&amp;mdash; a/pack.pl
+++ b/pack.pl
@@ -4,6 +4,6 @@ home(&amp;lsquo;&lt;a href=&#34;https://github.com/wouterbeek/plGraphViz%27%29&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/wouterbeek/plGraphViz&#39;)&lt;/a&gt;.
maintainer(&amp;lsquo;Wouter Beek&amp;rsquo;, &amp;lsquo;&lt;a href=&#34;mailto:me@wouterbeek.com&#34;&gt;me@wouterbeek.com&lt;/a&gt;&amp;rsquo;).
name(plGraphViz).
packager(&amp;lsquo;Wouter Beek&amp;rsquo;, &amp;lsquo;&lt;a href=&#34;mailto:me@wouterbeek.com&#34;&gt;me@wouterbeek.com&lt;/a&gt;&amp;rsquo;).
-requires(&amp;lsquo;Prolog_Library_Collection&amp;rsquo;).
+requires(&amp;lsquo;Prolog-Library-Collection&amp;rsquo;).
title(plGraphViz).
-version(&amp;lsquo;0.0.17&amp;rsquo;).
+version(&amp;lsquo;0.0.1&amp;rsquo;).
diff &amp;ndash;git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index 1a15ef5..083dbb2 100644
&amp;mdash; a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -2,24 +2,20 @@
fca_viz,
[
fca_export_graph/2, % +Context, -ExportGraph&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fca_export_graph/3, % +Context:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                   % -ExportGraph:compound
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                   % :Options:list(compound)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;fca_viz/2, % +Context, ?File&lt;/li&gt;
&lt;li&gt;fca_viz/3 % +Context:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;         % ?File:atom
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;         % :Options:list(compound)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;fca_export_graph/3, % +Context, -ExportGraph, :Opts&lt;/li&gt;
&lt;li&gt;fca_viz/2,          % +Context, ?File&lt;/li&gt;
&lt;li&gt;fca_viz/3           % +Context, ?File, :Opts
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; FCA visualization&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/11-2015/12
+@version 2015/11-2016/01
*/&lt;/p&gt;
&lt;p&gt;-:- use_module(library(dcg/dcg_collection)).
-:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(aggregate)).
+:- use_module(library(dcg/dcg_ext)).
:- use_module(library(dcg/dcg_pl)).
:- use_module(library(fca/fca)).
:- use_module(library(graph/build_export_graph)).
@@ -28,23 +24,19 @@
:- use_module(library(option)).
:- use_module(library(ordsets)).&lt;/p&gt;
&lt;p&gt;-:- meta_predicate(concept_label(+,1,1,+,-)).
-:- meta_predicate(concept_label(+,1,1,+,?,?)).
:- meta_predicate(fca_export_graph(+,?,:)).
:- meta_predicate(fca_viz(+,?,:)).&lt;/p&gt;
&lt;p&gt;:- predicate_options(fca_export_graph/3, 3, [&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;attribute_label(+callable),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;concept_label(+oneof([attributes,both,objects])),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;object_label(+callable)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;concept_label(+callable)
&lt;/code&gt;&lt;/pre&gt;
]).
:- predicate_options(fca_viz/3, 3, [
pass_to(fca_export_graph/3, 3),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(gv_export/3, 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(graph_viz/3, 3)
&lt;/code&gt;&lt;/pre&gt;
]).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-is_meta(attribute_label).
-is_meta(object_label).
+is_meta(concept_label).
+&lt;/p&gt;
&lt;p&gt;@@ -62,26 +54,16 @@ fca_export_graph(Context, ExportG):-
%!   :Options:list(compound)
%! ) is det.
% The following optios are supported:
-%   * attribute_label(+callable)
-%     DCG writing the labels for individual attributes.
-%     Default is pl_term//1.
-%   * concept_label(+oneof([attributes,both,objects]))
-%     Determines which components of the concepts are displayed
-%     in the export graph.
-%     Default is &lt;code&gt;both&lt;/code&gt;.
-%   * object_label(+callable)
-%     DCG writing the labels for individual objects.
-%     Default is pl_term//1.
+%   * concept_label(+callable)
+%     DCG writing the labels for individual concepts.&lt;/p&gt;
&lt;p&gt;fca_export_graph(Context, ExportG, Opts1):-
fca_hasse(Context, Hasse),
meta_options(is_meta, Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;option(attribute_label(ALbl_1), Opts2, pl_term),&lt;/li&gt;
&lt;li&gt;option(concept_label(Mode), Opts2, both),&lt;/li&gt;
&lt;li&gt;option(object_label(OLbl_1), Opts2, pl_term),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;option(concept_label(Label_3), Opts2, concept_label),
merge_options(
[&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; vertex_label(fca_viz:concept_label(Mode, OLbl_1, ALbl_1)),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; vertex_label(Label_3),
 vertex_rank(fca:concept_cardinality)
&lt;/code&gt;&lt;/pre&gt;
],
Opts2,
@@ -102,36 +84,18 @@ fca_viz(Context, File):-&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;fca_viz(Context, File, Opts1):-
meta_options(is_meta, Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;statistics(process_cputime, Time1),
fca_export_graph(Context, ExportG, Opts2),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_export(ExportG, File, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;ExportG = graph(&lt;em&gt;,&lt;/em&gt;,Es,_),&lt;/li&gt;
&lt;li&gt;aggregate_all(max(N), (member(edge(V1,V2,_), Es), (N = V1 ; N = V2)), N),&lt;/li&gt;
&lt;li&gt;ignore(option(number_of_vertices(N), Opts2)),&lt;/li&gt;
&lt;li&gt;statistics(process_cputime, Time2),&lt;/li&gt;
&lt;li&gt;Time is Time2 - Time1,&lt;/li&gt;
&lt;li&gt;ignore(option(process_cputime(Time), Opts2)),&lt;/li&gt;
&lt;li&gt;graph_viz(ExportG, File, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-%! concept_label(
-%!   +Mode:oneof([attributes,both,objects]),
-%!   :ObjectLabel_1,
-%!   :AttributeLabel_1,
-%!   +Concept:compound,
-%!   -Label:atom
-%! ) is det.
+%! concept_label(+Concept:compound)// is det.&lt;/p&gt;
&lt;p&gt;-concept_label(Mode, OLbl_1, ALbl_1, Concept, Lbl):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;string_phrase(concept_label(Mode, OLbl_1, ALbl_1, Concept), Lbl).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;---is-det&#34;&gt;-%! concept_label(
-%!   +Mode:oneof([attributes,both,objects]),
-%!   :ObjectLabel_1,
-%!   :AttributeLabel_1,
-%!   +Concept:compound
-%! )// is det.&lt;/h2&gt;
&lt;p&gt;-concept_label(attributes, &lt;em&gt;, ALbl_1, concept(&lt;/em&gt;,As)) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;set(ALbl_1, As).
-concept_label(both, OLbl_1, ALbl_1, Concept) &amp;ndash;&amp;gt;&lt;/li&gt;
&lt;li&gt;pair(&lt;/li&gt;
&lt;li&gt;concept_label(objects, OLbl_1, ALbl_1, Concept),&lt;/li&gt;
&lt;li&gt;concept_label(attributes, OLbl_1, ALbl_1, Concept)&lt;/li&gt;
&lt;li&gt;).
-concept_label(objects, OLbl_1, &lt;em&gt;, concept(Os,&lt;/em&gt;)) &amp;ndash;&amp;gt;&lt;/li&gt;
&lt;li&gt;set(OLbl_1, Os).
+concept_label(concept(Os,As)) &amp;ndash;&amp;gt; set(Os), &amp;quot; / &amp;ldquo;, set(As).
diff &amp;ndash;git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 6dbb4f7..5134069 100644
&amp;mdash; a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -50,12 +50,12 @@ Vertex coordinates:&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/09-2015/12
+@version 2015/07, 2015/09-2016/01
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
+:- use_module(library(dcg/dcg_ext)).
:- use_module(library(graph/s/s_graph)).
-:- use_module(library(lambda)).
:- use_module(library(list_ext)).
:- use_module(library(option_ext)).
:- use_module(library(ordsets)).
@@ -140,11 +140,15 @@ build_export_graph(G, ExportG):-
build_export_graph(G, graph(VTerms2,VRanks,ETerms,GAttrs), Opts1):-
graph_components(G, Vs, Es),
meta_options(is_meta, Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms1),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(vertex_term0(Vs, Opts2), Vs, VTerms1),
build_export_ranks(Vs, VTerms1, VRanks, VTerms2, Opts2),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(\E^ETerm^edge_term(Vs, E, ETerm, Opts2), Es, ETerms),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(edge_term0(Vs, Opts2), Es, ETerms),
graph_attributes(GAttrs, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+vertex_term0(Vs, Opts, V, VTerm) :- vertex_term(Vs, V, VTerm, Opts).
+
+edge_term0(Vs, Opts, E, ETerm) :- edge_term(Vs, E, ETerm, Opts).
+
graph_components(graph(Vs,Es), Vs, Es):- !.
graph_components(G, Vs, Es):-
s_graph_components(G, Vs, Es).
@@ -190,37 +194,29 @@ build_export_rank_term(N, vertex(Id,[label(&amp;quot;&amp;quot;),shape(none)])):-&lt;/p&gt;
&lt;p&gt;edge_term(Vs, E, edge(FromId,ToId,EAttrs), Opts):-
% Arrowhead&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if_option(edge_arrowhead(ArrowheadFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(ArrowheadFunction, E, EArrowhead)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(edge_arrowhead(Arrowhead_2), Opts,&lt;/li&gt;
&lt;li&gt;call(Arrowhead_2, E, EArrowhead)
),&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;% Color.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if_option(edge_color(ColorFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(ColorFunction, E, EColor)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(edge_color(ColorFunction), Opts, call(ColorFunction, E, EColor)),&lt;/p&gt;
&lt;p&gt;% Id.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;(   option(edge_id(IdFunction), Opts)&lt;/li&gt;
&lt;li&gt;-&amp;gt;  call(IdFunction, E, FromId, ToId)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;(   option(edge_id(Id_2), Opts)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;-&amp;gt;  call(Id_2, E, FromId, ToId)
;   edge_components(E, FromV, ToV),
nth0chk(FromId, Vs, FromV),
nth0chk(ToId, Vs, ToV)
),&lt;/p&gt;
&lt;p&gt;% Label.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(edge_label(LabelFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(LabelFunction, E, ELabel)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(edge_label(ELabel_3), Opts, string_phrase(dcg_call(ELabel_3, E), ELabel)),&lt;/p&gt;
&lt;p&gt;% Penwidth.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(edge_penwidth(PenwidthFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(PenwidthFunction, E, EPenwidth)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(edge_penwidth(Penwidth_2), Opts, call(Penwidth_2, E, EPenwidth)),&lt;/p&gt;
&lt;p&gt;% Style.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(edge_style(StyleFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(StyleFunction, E, EStyle)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(edge_style(Style_2), Opts, call(Style_2, E, EStyle)),&lt;/p&gt;
&lt;p&gt;exclude(
option_has_var_value,
@@ -274,7 +270,6 @@ graph_attributes(GAttrs, Opts):-
option(graph_label(GLabel), Opts, &amp;lsquo;&amp;quot;&amp;quot;&#39;),
% Overlap.
option(graph_overlap(Overlap), Opts, false),&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;exclude(
option_has_var_value,
[
@@ -320,47 +315,32 @@ graph_attributes(GAttrs, Opts):-&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;vertex_term(Vs, V, vertex(VId,VAttrs), Opts):-
% Color.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_color(ColorFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(ColorFunction, V, VColor)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(vertex_color(Color_2), Opts, call(Color_2, V, VColor)),&lt;/p&gt;
&lt;p&gt;% Id.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;(   option(vertex_id(IdFunction), Opts)&lt;/li&gt;
&lt;li&gt;-&amp;gt;  call(IdFunction, V, VId)&lt;/li&gt;
&lt;li&gt;;   nth0chk(VId, Vs, V)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;(option(vertex_id(Id_2), Opts) -&amp;gt; call(Id_2, V, VId) ; nth0chk(VId, Vs, V)),&lt;/p&gt;
&lt;p&gt;% Image.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;ignore(&lt;/li&gt;
&lt;li&gt;if_option(vertex_image(ImageFunction), Opts,&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; call(ImageFunction, V, VImage)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ignore(if_option(vertex_image(Image_2), Opts, call(Image_2, V, VImage))),&lt;/p&gt;
&lt;p&gt;% Label.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_label(LabelFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(LabelFunction, V, VLabel)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(vertex_label(VLabel_2), Opts, string_phrase(dcg_call(VLabel_2, V), VLabel)),&lt;/p&gt;
&lt;p&gt;% Peripheries.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_peripheries(PeripheriesFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(PeripheriesFunction, V, VPeripheries)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_peripheries(Peripheries_2), Opts,&lt;/li&gt;
&lt;li&gt;call(Peripheries_2, V, VPeripheries)
),&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;% Position.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_position(PositionFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(PositionFunction, Vs, Opts, V, VPosition)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_position(Position_4), Opts,&lt;/li&gt;
&lt;li&gt;call(Position_4, Vs, Opts, V, VPosition)
),&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;% Shape.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_shape(ShapeFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(ShapeFunction, V, VShape)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(vertex_shape(Shape_2), Opts, call(Shape_2, V, VShape)),&lt;/p&gt;
&lt;p&gt;% URI&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;if_option(vertex_uri(UriFunction), Opts,&lt;/li&gt;
&lt;li&gt;call(UriFunction, V, VUri)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if_option(vertex_uri(Uri_2), Opts, call(Uri_2, V, VUri)),&lt;/p&gt;
&lt;p&gt;exclude(
option_has_var_value,
diff &amp;ndash;git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index 8fa78af..f55fce5 100644
&amp;mdash; a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -46,11 +46,10 @@
/** &lt;module&gt; GraphViz attribute types&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/11
+@version 2015/07, 2015/11, 2016/02
*/&lt;/p&gt;
&lt;p&gt;-:- use_module(library(dcg/basics), except([string//1])).
-:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(dcg/dcg_ext), except([string//1])).
:- use_module(library(gv/gv_html)).&lt;/p&gt;
&lt;p&gt;@@ -256,7 +255,7 @@ input_changeable(true) &amp;ndash;&amp;gt; &amp;ldquo;!&amp;rdquo;.
%! pointList(+Points:list(compound))// .&lt;/p&gt;
&lt;p&gt;pointList(Points) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;*(point, Points, []).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;*(point, Points).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;diff &amp;ndash;git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index b26af73..4a92d5b 100644
&amp;mdash; a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -2,7 +2,7 @@
gv_attrs,
[
gv_attr_value//2 % +Context:oneof([cluster,edge,graph,node,subgraph])&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                % +Attribute:nvpair
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                % +Attr
&lt;/code&gt;&lt;/pre&gt;
]
).
:- ensure_loaded(library(&amp;lsquo;gv/gv_attrs.data&amp;rsquo;)).
@@ -10,11 +10,12 @@
/** &lt;module&gt; GraphViz attributes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07-2015/08, 2015/10
+@version 2015/07-2015/08, 2015/10, 2016/03
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_call)).
+:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(error)).
:- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
:- use_module(library(lists)).
:- use_module(library(os/file_ext)).
@@ -23,21 +24,20 @@&lt;/p&gt;
&lt;p&gt;-%! gv_attr_value(
-%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +Attribute:compound
-%! )// is det.
+%! gv_attr_value(+Context, +Attr)// is det.
% Uses the default value in case Value is uninstantiated.
% Otherwise, performs a typecheck and converts the given value.
+%
+% Context can be either &lt;code&gt;cluster&lt;/code&gt;, &lt;code&gt;edge&lt;/code&gt;, &lt;code&gt;graph&lt;/code&gt;, &lt;code&gt;node&lt;/code&gt; or &lt;code&gt;subgraph&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;% Use the default if no value is given.
gv_attr_value(Context, Name=Value) &amp;ndash;&amp;gt;
{&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;var(Value), !,&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;var(Value),
gv_attr(Name, UsedBy, _, DefaultValue, _, _),
% Check validity of context.
memberchk(Context, UsedBy)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;},&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;}, !,
gv_attr_value(Context, Name=DefaultValue).
gv_attr_value(Context, Name=Value) &amp;ndash;&amp;gt;
{
@@ -56,8 +56,10 @@ gv_attr_value(Context, Name=Value) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;p&gt;% Check validity of Value w.r.t. minimum value &amp;ndash; if available.
check_minimum(Value, Minimum)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;},&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;}, !,
dcg_call(gv_attr_type:Dcg, Value).
+gv_attr_value(&lt;em&gt;, Name=&lt;/em&gt;) &amp;ndash;&amp;gt;&lt;/li&gt;
&lt;li&gt;{existence_error(gv_attr, Name)}.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;diff &amp;ndash;git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 3232c97..ac319dc 100644
&amp;mdash; a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -14,12 +14,11 @@
@author Wouter Beek
@tbd Color value &lt;code&gt;transparent&lt;/code&gt; is only available in the output formats
ps, svg, fig, vmrl, and the bitmap formats.
-@version 2015/08, 2015/10
+@version 2015/08, 2015/10, 2016/02
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(dcg/basics)).
-:- use_module(library(dcg/dcg_content)).
+:- use_module(library(dcg/dcg_ext)).
:- use_module(library(lists)).
:- use_module(library(os/file_ext)).&lt;/p&gt;
&lt;p&gt;@@ -35,12 +34,12 @@&lt;/p&gt;
&lt;p&gt;color(rgb(Red,Green,Blue)) &amp;ndash;&amp;gt; !,
&amp;ldquo;#&amp;rdquo;,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;#&#39;(3, hex_color, [Red,Green,Blue]).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;#(3, hex_color, [Red,Green,Blue]).
color(rgbs(Red,Green,Blue,Alpha)) &amp;ndash;&amp;gt; !,
color(rgb(Red,Green,Blue)),
hex_color(Alpha).
color(hsv(Hue,Saturation,Value)) &amp;ndash;&amp;gt; !,&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;#(3, hsv_color, [Hue,Saturation,Value]).
color(Name) &amp;ndash;&amp;gt;
{gv_color(_, Name)},
atom(Name).
@@ -56,7 +55,7 @@ hsv_color(D, Head, Tail):-
%! colorList(+Pairs:list(pair(compound,float)))// .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;colorList(L) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;+&#39;(wc, L, []).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;+&#39;(wc, L).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;wc(Color-Float) &amp;ndash;&amp;gt;
color(Color),
diff &amp;ndash;git a/prolog/gv/gv_dom.pl b/prolog/gv/gv_dom.pl
index e85849d..30c4263 100644
&amp;mdash; a/prolog/gv/gv_dom.pl
+++ b/prolog/gv/gv_dom.pl
@@ -1,35 +1,29 @@
:- module(
gv_dom,
[&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_dom/3 % +ExportGraph:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;        % -Dom:list(compound)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;        % +Options:list(compound)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_dom/3 % +ExportG, -Dom, +Opts
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; GraphViz DOM&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07
+@version 2015/07, 2016/01
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(gv/gv_file)).
:- use_module(library(option)).
-:- use_module(library(svg/svg_dom)).
+:- use_module(library(svg/svg_ext)).&lt;/p&gt;
&lt;p&gt;-%! gv_dom(
-%!   +ExportGraph:compound,
-%!   -Dom:list(compound),
-%!   +Options:list(compound)
-%! ) is det.
+%! gv_dom(+ExportG, -Dom, +Opts) is det.&lt;/p&gt;
&lt;p&gt;gv_dom(ExportG, Dom, Opts1):-
% Make sure the file type of the output file is SvgDom.
merge_options([output(svg)], Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_export(ExportG, ToFile, Opts2),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;graph_viz(ExportG, ToFile, Opts2),
svg_dom(ToFile, Dom),
delete_file(ToFile).
diff &amp;ndash;git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index 4cf12a8..993fcee 100644
&amp;mdash; a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -1,18 +1,15 @@
:- module(
gv_file,
[&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_export/2, % +ExportGraph:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;            % ?File:atom
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;gv_export/3 % +ExportGraph:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;           % ?File:atom
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;           % +Options:list(nvpair)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;graph_viz/2, % +ExportG, ?File&lt;/li&gt;
&lt;li&gt;graph_viz/3  % +ExportG, ?File, +Opts
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; GraphViz file&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/10-2015/11
+@version 2015/07, 2015/10-2015/11, 2016/01
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(code_ext)).
@@ -23,7 +20,7 @@
:- use_module(library(os/process_ext)).
:- use_module(library(string_ext)).&lt;/p&gt;
&lt;p&gt;-:- predicate_options(gv_export/3, 3, [
+:- predicate_options(graph_viz/3, 3, [
pass_to(file_to_gv/3, 3)
]).
:- predicate_options(file_to_gv/3, 3, [
@@ -40,14 +37,8 @@ user:module_uses(gv_file, program(dot)).&lt;/p&gt;
&lt;h2 id=&#34;--wrapper-around-gv_export3-with-default-options&#34;&gt;-%! gv_export(+ExportGraph:compound, ?File:atom) is det.
-% Wrapper around gv_export/3 with default options.&lt;/h2&gt;
&lt;p&gt;-gv_export(ExportG, File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_export(ExportG, File, []).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-%! gv_export(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
+%! graph_viz(+ExportGraph:compound, ?File:atom) is det.
+%! graph_viz(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
% Returns a file containing a GraphViz visualization of the given graph.
%
% The following options are supported:
@@ -60,7 +51,9 @@ gv_export(ExportG, File):-
%     Default is &lt;code&gt;pdf&lt;/code&gt;.
%     For possible values see gv_output_type/1.&lt;/p&gt;
&lt;p&gt;-gv_export(ExportG, File, Opts):-
+graph_viz(ExportG, File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;graph_viz(ExportG, File, []).
+graph_viz(ExportG, File, Opts):-
once(phrase(gv_graph(ExportG), Cs)),&lt;/p&gt;
&lt;p&gt;% Be thread-safe.
diff &amp;ndash;git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index 5c937ce..c95c9cc 100644
&amp;mdash; a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -20,7 +20,6 @@ In GraphViz vertices are called &amp;lsquo;nodes&amp;rsquo;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;:- use_module(library(apply)).
:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_content)).
:- use_module(library(gv/gv_graph_comp)).
:- use_module(library(lists)).
:- use_module(library(option)).
diff &amp;ndash;git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index aecbe07..30ea9c5 100644
&amp;mdash; a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -24,12 +24,11 @@ a_list = ID &amp;ldquo;=&amp;rdquo; ID [&amp;rdquo;,&amp;quot;] [a_list]&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
@see &lt;a href=&#34;http://www.graphviz.org/content/dot-language&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.graphviz.org/content/dot-language&lt;/a&gt;
-@version 2015/07-2015/08, 2015/10-2015/12
+@version 2015/07-2015/08, 2015/10-2016/01
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_content)).
:- use_module(library(gv/gv_attrs)).
:- use_module(library(gv/gv_html)).
:- use_module(library(error)).
@@ -86,7 +85,7 @@ gv_edge_operator(Dir) &amp;ndash;&amp;gt;
%! gv_generic_attributes_statement(
%!   +Kind:oneof([edge,graph,node]),
%!   +Indent:nonneg,
-%!   +CategoryAttributes:list(nvpair)
+%!   +CategoryAttrs
%! )//
% A GraphViz statement describing generic attributes for a category of items.
%
@@ -200,8 +199,8 @@ gv_id(double_quoted_string(Atom)) &amp;ndash;&amp;gt; !,
% Numerals.
gv_id(N) &amp;ndash;&amp;gt;
{number(N)}, !,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;% @tbd Use gv_numeral//1.&lt;/li&gt;
&lt;li&gt;number(N).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;{number_codes(N, Cs)},&lt;/li&gt;
&lt;li&gt;Cs.
% Alpha-numeric strings.
gv_id(Atom) &amp;ndash;&amp;gt;
{atom_codes(Atom, [H|T])},
@@ -264,6 +263,22 @@ gv_node_id(Id) &amp;ndash;&amp;gt; {type_error(gv_node_id, Id)}.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+%! gv_numeral(-Number)// is det.
+% &lt;code&gt;bnf +% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? ) +% &lt;/code&gt;
+
+gv_numeral(N) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(&amp;quot;-&amp;quot; -&amp;gt; {Sg = -1} ; {Sg = 1}),&lt;/li&gt;
&lt;li&gt;(   &amp;ldquo;.&amp;rdquo;&lt;/li&gt;
&lt;li&gt;-&amp;gt;  {I = 0}, +(digit, Ds), {pos_frac(Ds, Frac)}&lt;/li&gt;
&lt;li&gt;;   +(digit, Ds1), {pos_sum(Ds1, I)},&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; (&amp;quot;.&amp;quot; -&amp;gt; *(digit, Ds2), {pos_frac(Ds2, Frac)} ; {Frac = 0.0})
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;{N is Sg * (I + Frac)}.&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;%! gv_port// is det.&lt;/p&gt;
&lt;p&gt;gv_port &amp;ndash;&amp;gt; gv_port_location, (gv_port_angle ; &amp;ldquo;&amp;quot;).
@@ -279,7 +294,7 @@ gv_port_location &amp;ndash;&amp;gt; &amp;ldquo;:[&amp;rdquo;, gv_id(&lt;em&gt;), &amp;ldquo;,&amp;rdquo;, gv_id(&lt;/em&gt;), &amp;ldquo;]&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
% &lt;code&gt;-% compass_pt : (n | ne | e | se | s | sw | w | nw | c | _) +% compass_pt : ( n | ne | e | se | s | sw | w | nw | c | _ ) % &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;gv_compass_pt(&#39;&lt;em&gt;&#39;) &amp;ndash;&amp;gt; &amp;ldquo;&lt;/em&gt;&amp;rdquo;.
diff &amp;ndash;git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
index 3ee7de6..b5c1368 100644
&amp;mdash; a/prolog/gv/gv_html.pl
+++ b/prolog/gv/gv_html.pl
@@ -44,7 +44,6 @@ cell:   &lt;TD&gt; label &lt;/TD&gt;
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_content)).
:- use_module(library(html/html_dcg)).&lt;/p&gt;
&lt;p&gt;@@ -210,7 +209,12 @@ text(Content)  &amp;ndash;&amp;gt; text([Content]).
% ```
%
% Supported attributes for BR:
-%   - &lt;code&gt;ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;&lt;/code&gt;
+%   * &lt;code&gt;ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;&lt;/code&gt;
+%
+% Supported attributes for FONT:
+%   * COLOR=&amp;ldquo;color&amp;rdquo;
+%   * FACE=&amp;ldquo;fontname&amp;rdquo;
+%   * POINT-SIZE=&amp;ldquo;value&amp;rdquo;&lt;/p&gt;
&lt;p&gt;textitem(br(Attrs)) &amp;ndash;&amp;gt; !,
html_element(br, Attrs).
diff &amp;ndash;git a/prolog/gv/gv_numeral.pl b/prolog/gv/gv_numeral.pl
deleted file mode 100644
index 4ba0d64..0000000
&amp;mdash; a/prolog/gv/gv_numeral.pl
+++ /dev/null
@@ -1,87 +0,0 @@
-:- module(&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_numeral,&lt;/li&gt;
&lt;li&gt;[&lt;/li&gt;
&lt;li&gt;gv_numeral//1 % ?Value:number&lt;/li&gt;
&lt;li&gt;]
-).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;--module-graphviz-numeral&#34;&gt;-/** &lt;module&gt; GraphViz numeral&lt;/h2&gt;
&lt;h2 id=&#34;-&#34;&gt;-@author Wouter Beek
-@version 2014/05-2014/06, 2015/01
-*/&lt;/h2&gt;
&lt;h2 id=&#34;---use_modulelibrarymathrational_ext&#34;&gt;-:- use_module(library(dcg/dcg_abnf)).
-:- use_module(library(dcg/dcg_abnf_common)).
-:- use_module(library(dcg/dcg_ascii)).
-:- use_module(library(math/math_ext)).
-:- use_module(library(math/positional)).
-:- use_module(library(math/radconv)).
-:- use_module(library(math/rational_ext)).&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;------decimal-separator&#34;&gt;-%! gv_numeral(?Value:compound)// .
-%
-% # Syntax
-%
-% &lt;code&gt;bnf -% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? ) -% &lt;/code&gt;
-%
-% ## Generation
-%
-% In the generative case, three notations are allowed (also see below):
-%   1. (non-zero integer-part)
-%   2. (decimal-separator) (non-zero fractional)
-%   3. (non-zero integer-part) (decimal-separator) (non-zero fractional)
-%
-% The following notations are explicitly excluded due to verbosity:
-%   - (non-zero integer-part) (decimal-separator)
-%   - (non-zero integer-part) (decimal-separator) (zero fractional)
-%   - (zero integer-part) (decimal-separator) (non-zero fractional)
-%
-% The following notations are also excluded, but since they violate
-%  well-formedness:
-%   - (non-zero integer-part) (non-zero fractional)
-%   - (decimal-separator)&lt;/h2&gt;
&lt;p&gt;-gv_numeral(N) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(   {ground(N)}&lt;/li&gt;
&lt;li&gt;-&amp;gt;  &amp;lsquo;[-]?&#39;(N),&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {N0 is abs(N)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {rational_parts(N0, I, F)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; (   % [1] The fractional is zero, so only write the integer part
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     %     and do not write the decimal separator.
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {F =:= 0}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; -&amp;gt;  {positional(I, IW)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]+&#39;(IW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ;   % [2] The integer part is zero, so only write the fractional part,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     %     preceded by the decimal separator.
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {I =:= 0}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; -&amp;gt;  &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {positional_fraction(FW, F)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]*&#39;(FW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ;   % [3] Both the integer part and the fractional are non-zero,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     %     so write both of them, with the decimal separator in-between.
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {positional(I, IW)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]+&#39;(IW),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {positional_fraction(FW, F)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]*&#39;(FW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; )
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;;   &amp;lsquo;[-]?&#39;(Sg),&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; (   &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]+&#39;(FW),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {IW = []}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ;   &#39;[0-9]+&#39;(IW),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     (   &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;         &#39;[0-9]*&#39;(FW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     ;   {FW = []}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     )
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {rational_parts_weights(N0, IW, FW)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {N is copysign(N0, Sg)}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;).
diff &amp;ndash;git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
new file mode 100644
index 0000000..4382aa6
&amp;mdash; /dev/null
+++ b/prolog/tree/tree_viz.pl
@@ -0,0 +1,65 @@
+:- module(&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;tree_viz,&lt;/li&gt;
&lt;li&gt;[&lt;/li&gt;
&lt;li&gt;tree_export_graph/2, % +Tree, ExportG&lt;/li&gt;
&lt;li&gt;tree_export_graph/3, % +Tree, ExportG, +Opts&lt;/li&gt;
&lt;li&gt;tree_viz/2,          % +Tree, ?File&lt;/li&gt;
&lt;li&gt;tree_viz/3           % +Tree, ?File, +Opts&lt;/li&gt;
&lt;li&gt;]
+).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+/** &lt;module&gt; Tree visualization
+
+Export trees to GraphViz.
+
+@author Wouter Beek
+@version 2016/01-2016/02
+*/
+
+:- use_module(library(graph/build_export_graph)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(ordsets)).
+:- use_module(library(tree/l_tree)).
+:- use_module(library(tree/s_tree)).
+
+:- predicate_options(tree_export_graph/3, 3, [&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(build_export_graph/4, 4)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;]).
+:- predicate_options(tree_viz/3, 3, [&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(graph_viz/3, 3),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(tree_to_graph/3, 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;]).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+%! tree_export_graph(+Tree, -ExportG) is det.
+%! tree_export_graph(+Tree, -ExportG, +Opts) is det.
+% Opts are passed to build_export_graph/4.
+
+tree_export_graph(Tree, ExportG) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tree_export_graph(Tree, ExportG, []).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+tree_export_graph(Tree, ExportG, Opts) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(   is_s_tree(Tree)&lt;/li&gt;
&lt;li&gt;-&amp;gt;  tree_to_graph(Tree, G)&lt;/li&gt;
&lt;li&gt;;   is_l_tree(Tree)&lt;/li&gt;
&lt;li&gt;-&amp;gt;  l_tree_to_graph(Tree, G)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;build_export_graph(G, ExportG, Opts).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+%! tree_viz(+Tree, ?File) is det.
+%! tree_viz(+Tree, ?File, +Opts) is det.
+% Stores the given tree term into a GraphViz file.
+%
+% Options are passed to export_graph_to_gv_file/3, tree_to_graph/3.
+
+tree_viz(Tree, File) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tree_viz(Tree, File, []).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+tree_viz(Tree, File, Opts) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tree_export_graph(Tree, ExportG, Opts),&lt;/li&gt;
&lt;li&gt;graph_viz(ExportG, File, Opts).
diff &amp;ndash;git a/test/test.pl b/test/test.pl
index c1bdca0..83dc023 100644
&amp;mdash; a/test/test.pl
+++ b/test/test.pl
@@ -6,8 +6,10 @@
:- use_module(library(gv/gv_attrs)).
:- use_module(library(gv/gv_attr_type)).
:- use_module(library(gv/gv_color)).
+:- use_module(library(gv/gv_dom)).
:- use_module(library(gv/gv_file)).
:- use_module(library(gv/gv_graph)).
:- use_module(library(gv/gv_graph_comp)).
:- use_module(library(gv/gv_html)).
-:- use_module(library(gv/gv_numeral)).
+%/tree
+:- use_module(library(tree/tree_viz)).&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt; 
&amp;lt;h2 id=&amp;quot;147&amp;quot;&amp;gt; 147: 正在比较变动前 f16acca 和变动后 4e2d9f1 &amp;lt;/h2&amp;gt;
[back to content](#compare)
 
``` diff
 
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
index bcc7654..190b988 100644
--- a/data/gv_attrs_scrape.pl
+++ b/data/gv_attrs_scrape.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_attrs_scrape,
   [
-    gv_attrs_scrape/1 % +File
+    gv_attrs_scrape/1 % +File:atom
   ]
 ).
 
@@ -11,41 +11,46 @@ Writes compound terms of the following form to file:
 
 ```prolog
 gv_attr(
-  ?Name,
+  ?Name:atom,
   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
   ?Types:list(atom),
   ?Default,
   ?Minimum,
-  ?Notes
+  ?Notes:atom
 ) is nondet.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/10, 2016/07
+@version 2015/10
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(debug)).
+:- use_module(library(dcg/basics), except([string//1])).
+:- use_module(library(dcg/dcg_phrase)).
:- use_module(library(gv/gv_attr_type)).
:- use_module(library(http/http_download)).
+:- use_module(library(iostream)).
:- use_module(library(lists)).
-:- use_module(library(os/io)).
-:- use_module(library(pl_term)).
-:- use_module(library(print_ext)).
+:- use_module(library(msg_ext)).
+:- use_module(library(pl/pl_term)).
:- use_module(library(xpath)).
:- use_module(library(xpath/xpath_table)).
-:- use_module(library(yall)).&lt;/p&gt;
&lt;p&gt;-%! gv_attrs_scrape(+File) is det.
+%! gv_attrs_scrape(+File:atom) is det.&lt;/p&gt;
&lt;p&gt;gv_attrs_scrape(File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;debug(gv, &amp;ldquo;Updating the GraphViz attributes table.&amp;rdquo;, []),&lt;/li&gt;
&lt;li&gt;call_to_stream(File, [In,Meta,Meta]&amp;raquo;gv_attrs_download(In)).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;setup_call_cleanup(&lt;/li&gt;
&lt;li&gt;open_any(File, write, Write, Close, []),&lt;/li&gt;
&lt;li&gt;verbose(&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; gv_attrs_download(Write),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; &amp;quot;Updating the GraphViz attributes table.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;close_any(Close)&lt;/li&gt;
&lt;li&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;gv_attrs_download(Write):-
@@ -74,7 +79,7 @@ gv_attrs_iri(&amp;lsquo;&lt;a href=&#34;http://www.graphviz.org/doc/info/attrs.html%27%29&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.graphviz.org/doc/info/attrs.html&#39;)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;% HELPERS %&lt;/p&gt;
&lt;p&gt;-%! translate_default(+Default1, -Default2) is det.
+%! translate_default(+Default1:atom, -Default2:atom) is det.&lt;/p&gt;
&lt;p&gt;% The empty string is represented by the empty atom.
translate_default(&#39;&amp;quot;&amp;quot;&amp;rsquo;, &amp;lsquo;&#39;):- !.
diff &amp;ndash;git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
index 102a02a..3ac5d44 100644
&amp;mdash; a/data/gv_color_scrape.pl
+++ b/data/gv_color_scrape.pl
@@ -1,36 +1,40 @@
:- module(
gv_color_scrape,
[&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_color_scrape/1 % +File&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_color_scrape/1 % +File:atom
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; GraphViz: Scrape colors&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/10, 2016/07
+@version 2015/10
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(debug)).
:- use_module(library(http/http_download)).
+:- use_module(library(iostream)).
:- use_module(library(lists)).
-:- use_module(library(os/io)).
-:- use_module(library(pl_term)).
-:- use_module(library(print_ext)).
+:- use_module(library(msg_ext)).
+:- use_module(library(pl/pl_term)).
:- use_module(library(xpath)).
:- use_module(library(xpath/xpath_table)).
-:- use_module(library(yall)).&lt;/p&gt;
&lt;p&gt;-%! gv_color_scrape(+File) is det.
+%! gv_color_scrape(+File:atom) is det.&lt;/p&gt;
&lt;p&gt;gv_color_scrape(File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;debug(io, &amp;ldquo;Updating the GraphViz color table.&amp;rdquo;, []),&lt;/li&gt;
&lt;li&gt;call_to_stream(File, [In,Meta,Meta]&amp;raquo;gv_color_download(In)).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;setup_call_cleanup(&lt;/li&gt;
&lt;li&gt;open_any(File, write, Write, Close, []),&lt;/li&gt;
&lt;li&gt;verbose(&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; gv_color_download(Write),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; &amp;quot;Updating the GraphViz color table.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;close_any(Close)&lt;/li&gt;
&lt;li&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;gv_color_download(Write):-
diff &amp;ndash;git a/pack.pl b/pack.pl
index 989108a..203cbfc 100644
&amp;mdash; a/pack.pl
+++ b/pack.pl
@@ -4,6 +4,6 @@ home(&amp;lsquo;&lt;a href=&#34;https://github.com/wouterbeek/plGraphViz%27%29&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/wouterbeek/plGraphViz&#39;)&lt;/a&gt;.
maintainer(&amp;lsquo;Wouter Beek&amp;rsquo;, &amp;lsquo;&lt;a href=&#34;mailto:me@wouterbeek.com&#34;&gt;me@wouterbeek.com&lt;/a&gt;&amp;rsquo;).
name(plGraphViz).
packager(&amp;lsquo;Wouter Beek&amp;rsquo;, &amp;lsquo;&lt;a href=&#34;mailto:me@wouterbeek.com&#34;&gt;me@wouterbeek.com&lt;/a&gt;&amp;rsquo;).
-requires(&amp;lsquo;Prolog-Library-Collection&amp;rsquo;).
+requires(&amp;lsquo;Prolog_Library_Collection&amp;rsquo;).
title(plGraphViz).
-version(&amp;lsquo;0.0.1&amp;rsquo;).
+version(&amp;lsquo;0.0.17&amp;rsquo;).
diff &amp;ndash;git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index 083dbb2..e6fb117 100644
&amp;mdash; a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -2,20 +2,24 @@
fca_viz,
[
fca_export_graph/2, % +Context, -ExportGraph&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fca_export_graph/3, % +Context, -ExportGraph, :Opts&lt;/li&gt;
&lt;li&gt;fca_viz/2,          % +Context, ?File&lt;/li&gt;
&lt;li&gt;fca_viz/3           % +Context, ?File, :Opts&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;fca_export_graph/3, % +Context:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                   % -ExportGraph:compound
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                   % :Options:list(compound)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;fca_viz/2, % +Context, ?File&lt;/li&gt;
&lt;li&gt;fca_viz/3 % +Context:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;         % ?File:atom
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;         % :Options:list(compound)
&lt;/code&gt;&lt;/pre&gt;
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; FCA visualization&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/11-2016/01
+@version 2015/11-2015/12
*/&lt;/p&gt;
&lt;p&gt;-:- use_module(library(aggregate)).
-:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(dcg/dcg_collection)).
+:- use_module(library(dcg/dcg_phrase)).
:- use_module(library(dcg/dcg_pl)).
:- use_module(library(fca/fca)).
:- use_module(library(graph/build_export_graph)).
@@ -32,7 +36,7 @@
]).
:- predicate_options(fca_viz/3, 3, [
pass_to(fca_export_graph/3, 3),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(graph_viz/3, 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(gv_export/3, 3)
&lt;/code&gt;&lt;/pre&gt;
]).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;is_meta(concept_label).
@@ -84,15 +88,8 @@ fca_viz(Context, File):-&lt;/p&gt;
&lt;p&gt;fca_viz(Context, File, Opts1):-
meta_options(is_meta, Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;statistics(process_cputime, Time1),
fca_export_graph(Context, ExportG, Opts2),&lt;/li&gt;
&lt;li&gt;ExportG = graph(&lt;em&gt;,&lt;/em&gt;,Es,_),&lt;/li&gt;
&lt;li&gt;aggregate_all(max(N), (member(edge(V1,V2,_), Es), (N = V1 ; N = V2)), N),&lt;/li&gt;
&lt;li&gt;ignore(option(number_of_vertices(N), Opts2)),&lt;/li&gt;
&lt;li&gt;statistics(process_cputime, Time2),&lt;/li&gt;
&lt;li&gt;Time is Time2 - Time1,&lt;/li&gt;
&lt;li&gt;ignore(option(process_cputime(Time), Opts2)),&lt;/li&gt;
&lt;li&gt;graph_viz(ExportG, File, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_export(ExportG, File, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;--5012-5014--vertex-coordinates&#34;&gt;diff &amp;ndash;git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 5134069..caabaa0 100644
&amp;mdash; a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -50,12 +50,14 @@ Vertex coordinates:&lt;/h2&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/09-2016/01
+@version 2015/07, 2015/09-2015/12
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(dcg/dcg_call)).
+:- use_module(library(dcg/dcg_phrase)).
:- use_module(library(graph/s/s_graph)).
+:- use_module(library(lambda)).
:- use_module(library(list_ext)).
:- use_module(library(option_ext)).
:- use_module(library(ordsets)).
@@ -140,15 +142,11 @@ build_export_graph(G, ExportG):-
build_export_graph(G, graph(VTerms2,VRanks,ETerms,GAttrs), Opts1):-
graph_components(G, Vs, Es),
meta_options(is_meta, Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;maplist(vertex_term0(Vs, Opts2), Vs, VTerms1),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms1),
build_export_ranks(Vs, VTerms1, VRanks, VTerms2, Opts2),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(edge_term0(Vs, Opts2), Es, ETerms),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;maplist(\E^ETerm^edge_term(Vs, E, ETerm, Opts2), Es, ETerms),
graph_attributes(GAttrs, Opts2).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-vertex_term0vs-opts-v-vterm---vertex_termvs-v-vterm-opts&#34;&gt;-vertex_term0(Vs, Opts, V, VTerm) :- vertex_term(Vs, V, VTerm, Opts).&lt;/h2&gt;
&lt;h2 id=&#34;-edge_term0vs-opts-e-eterm---edge_termvs-e-eterm-opts&#34;&gt;-edge_term0(Vs, Opts, E, ETerm) :- edge_term(Vs, E, ETerm, Opts).&lt;/h2&gt;
&lt;p&gt;graph_components(graph(Vs,Es), Vs, Es):- !.
graph_components(G, Vs, Es):-
s_graph_components(G, Vs, Es).
diff &amp;ndash;git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index f55fce5..8fa78af 100644
&amp;mdash; a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -46,10 +46,11 @@
/** &lt;module&gt; GraphViz attribute types&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/11, 2016/02
+@version 2015/07, 2015/11
*/&lt;/p&gt;
&lt;p&gt;-:- use_module(library(dcg/dcg_ext), except([string//1])).
+:- use_module(library(dcg/basics), except([string//1])).
+:- use_module(library(dcg/dcg_phrase)).
:- use_module(library(gv/gv_html)).&lt;/p&gt;
&lt;p&gt;@@ -255,7 +256,7 @@ input_changeable(true) &amp;ndash;&amp;gt; &amp;ldquo;!&amp;rdquo;.
%! pointList(+Points:list(compound))// .&lt;/p&gt;
&lt;p&gt;pointList(Points) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;*(point, Points).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;*(point, Points, []).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;diff &amp;ndash;git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 4a92d5b..b26af73 100644
&amp;mdash; a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -2,7 +2,7 @@
gv_attrs,
[
gv_attr_value//2 % +Context:oneof([cluster,edge,graph,node,subgraph])&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                % +Attr
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                % +Attribute:nvpair
&lt;/code&gt;&lt;/pre&gt;
]
).
:- ensure_loaded(library(&amp;lsquo;gv/gv_attrs.data&amp;rsquo;)).
@@ -10,12 +10,11 @@
/** &lt;module&gt; GraphViz attributes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07-2015/08, 2015/10, 2016/03
+@version 2015/07-2015/08, 2015/10
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
-:- use_module(library(error)).
+:- use_module(library(dcg/dcg_call)).
:- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
:- use_module(library(lists)).
:- use_module(library(os/file_ext)).
@@ -24,20 +23,21 @@&lt;/p&gt;
&lt;p&gt;-%! gv_attr_value(+Context, +Attr)// is det.
+%! gv_attr_value(
+%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
+%!   +Attribute:compound
+%! )// is det.
% Uses the default value in case Value is uninstantiated.
% Otherwise, performs a typecheck and converts the given value.
-%
-% Context can be either &lt;code&gt;cluster&lt;/code&gt;, &lt;code&gt;edge&lt;/code&gt;, &lt;code&gt;graph&lt;/code&gt;, &lt;code&gt;node&lt;/code&gt; or &lt;code&gt;subgraph&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;% Use the default if no value is given.
gv_attr_value(Context, Name=Value) &amp;ndash;&amp;gt;
{&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;var(Value),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;var(Value), !,
gv_attr(Name, UsedBy, _, DefaultValue, _, _),
% Check validity of context.
memberchk(Context, UsedBy)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;}, !,&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;},
gv_attr_value(Context, Name=DefaultValue).
gv_attr_value(Context, Name=Value) &amp;ndash;&amp;gt;
{
@@ -56,10 +56,8 @@ gv_attr_value(Context, Name=Value) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;p&gt;% Check validity of Value w.r.t. minimum value &amp;ndash; if available.
check_minimum(Value, Minimum)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;}, !,&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;},
dcg_call(gv_attr_type:Dcg, Value).
-gv_attr_value(&lt;em&gt;, Name=&lt;/em&gt;) &amp;ndash;&amp;gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;{existence_error(gv_attr, Name)}.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;diff &amp;ndash;git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index ac319dc..3232c97 100644
&amp;mdash; a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -14,11 +14,12 @@
@author Wouter Beek
@tbd Color value &lt;code&gt;transparent&lt;/code&gt; is only available in the output formats
ps, svg, fig, vmrl, and the bitmap formats.
-@version 2015/08, 2015/10, 2016/02
+@version 2015/08, 2015/10
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
-:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(dcg/basics)).
+:- use_module(library(dcg/dcg_content)).
:- use_module(library(lists)).
:- use_module(library(os/file_ext)).&lt;/p&gt;
&lt;p&gt;@@ -34,12 +35,12 @@&lt;/p&gt;
&lt;p&gt;color(rgb(Red,Green,Blue)) &amp;ndash;&amp;gt; !,
&amp;ldquo;#&amp;rdquo;,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;#(3, hex_color, [Red,Green,Blue]).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;#&#39;(3, hex_color, [Red,Green,Blue]).
color(rgbs(Red,Green,Blue,Alpha)) &amp;ndash;&amp;gt; !,
color(rgb(Red,Green,Blue)),
hex_color(Alpha).
color(hsv(Hue,Saturation,Value)) &amp;ndash;&amp;gt; !,&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;#(3, hsv_color, [Hue,Saturation,Value]).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
color(Name) &amp;ndash;&amp;gt;
{gv_color(_, Name)},
atom(Name).
@@ -55,7 +56,7 @@ hsv_color(D, Head, Tail):-
%! colorList(+Pairs:list(pair(compound,float)))// .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;colorList(L) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;+&#39;(wc, L).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lsquo;+&#39;(wc, L, []).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;wc(Color-Float) &amp;ndash;&amp;gt;
color(Color),
diff &amp;ndash;git a/prolog/gv/gv_dom.pl b/prolog/gv/gv_dom.pl
index 30c4263..e85849d 100644
&amp;mdash; a/prolog/gv/gv_dom.pl
+++ b/prolog/gv/gv_dom.pl
@@ -1,29 +1,35 @@
:- module(
gv_dom,
[&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_dom/3 % +ExportG, -Dom, +Opts&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_dom/3 % +ExportGraph:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;        % -Dom:list(compound)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;        % +Options:list(compound)
&lt;/code&gt;&lt;/pre&gt;
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; GraphViz DOM&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2016/01
+@version 2015/07
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(gv/gv_file)).
:- use_module(library(option)).
-:- use_module(library(svg/svg_ext)).
+:- use_module(library(svg/svg_dom)).&lt;/p&gt;
&lt;p&gt;-%! gv_dom(+ExportG, -Dom, +Opts) is det.
+%! gv_dom(
+%!   +ExportGraph:compound,
+%!   -Dom:list(compound),
+%!   +Options:list(compound)
+%! ) is det.&lt;/p&gt;
&lt;p&gt;gv_dom(ExportG, Dom, Opts1):-
% Make sure the file type of the output file is SvgDom.
merge_options([output(svg)], Opts1, Opts2),&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;graph_viz(ExportG, ToFile, Opts2),&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_export(ExportG, ToFile, Opts2),
svg_dom(ToFile, Dom),
delete_file(ToFile).
diff &amp;ndash;git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index 993fcee..4cf12a8 100644
&amp;mdash; a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -1,15 +1,18 @@
:- module(
gv_file,
[&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;graph_viz/2, % +ExportG, ?File&lt;/li&gt;
&lt;li&gt;graph_viz/3  % +ExportG, ?File, +Opts&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_export/2, % +ExportGraph:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;            % ?File:atom
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;gv_export/3 % +ExportGraph:compound&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;           % ?File:atom
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;           % +Options:list(nvpair)
&lt;/code&gt;&lt;/pre&gt;
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; GraphViz file&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/07, 2015/10-2015/11, 2016/01
+@version 2015/07, 2015/10-2015/11
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(code_ext)).
@@ -20,7 +23,7 @@
:- use_module(library(os/process_ext)).
:- use_module(library(string_ext)).&lt;/p&gt;
&lt;p&gt;-:- predicate_options(graph_viz/3, 3, [
+:- predicate_options(gv_export/3, 3, [
pass_to(file_to_gv/3, 3)
]).
:- predicate_options(file_to_gv/3, 3, [
@@ -37,8 +40,14 @@ user:module_uses(gv_file, program(dot)).&lt;/p&gt;
&lt;p&gt;-%! graph_viz(+ExportGraph:compound, ?File:atom) is det.
-%! graph_viz(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
+%! gv_export(+ExportGraph:compound, ?File:atom) is det.
+% Wrapper around gv_export/3 with default options.
+
+gv_export(ExportG, File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_export(ExportG, File, []).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+%! gv_export(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
% Returns a file containing a GraphViz visualization of the given graph.
%
% The following options are supported:
@@ -51,9 +60,7 @@ user:module_uses(gv_file, program(dot)).
%     Default is &lt;code&gt;pdf&lt;/code&gt;.
%     For possible values see gv_output_type/1.&lt;/p&gt;
&lt;p&gt;-graph_viz(ExportG, File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;graph_viz(ExportG, File, []).
-graph_viz(ExportG, File, Opts):-
+gv_export(ExportG, File, Opts):-
once(phrase(gv_graph(ExportG), Cs)),&lt;/p&gt;
&lt;p&gt;% Be thread-safe.
diff &amp;ndash;git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index c95c9cc..5c937ce 100644
&amp;mdash; a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -20,6 +20,7 @@ In GraphViz vertices are called &amp;lsquo;nodes&amp;rsquo;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;:- use_module(library(apply)).
:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(dcg/dcg_content)).
:- use_module(library(gv/gv_graph_comp)).
:- use_module(library(lists)).
:- use_module(library(option)).
diff &amp;ndash;git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 30ea9c5..aecbe07 100644
&amp;mdash; a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -24,11 +24,12 @@ a_list = ID &amp;ldquo;=&amp;rdquo; ID [&amp;rdquo;,&amp;quot;] [a_list]&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
@see &lt;a href=&#34;http://www.graphviz.org/content/dot-language&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.graphviz.org/content/dot-language&lt;/a&gt;
-@version 2015/07-2015/08, 2015/10-2016/01
+@version 2015/07-2015/08, 2015/10-2015/12
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(dcg/dcg_content)).
:- use_module(library(gv/gv_attrs)).
:- use_module(library(gv/gv_html)).
:- use_module(library(error)).
@@ -85,7 +86,7 @@ gv_edge_operator(Dir) &amp;ndash;&amp;gt;
%! gv_generic_attributes_statement(
%!   +Kind:oneof([edge,graph,node]),
%!   +Indent:nonneg,
-%!   +CategoryAttrs
+%!   +CategoryAttributes:list(nvpair)
%! )//
% A GraphViz statement describing generic attributes for a category of items.
%
@@ -199,8 +200,8 @@ gv_id(double_quoted_string(Atom)) &amp;ndash;&amp;gt; !,
% Numerals.
gv_id(N) &amp;ndash;&amp;gt;
{number(N)}, !,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;{number_codes(N, Cs)},&lt;/li&gt;
&lt;li&gt;Cs.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;% @tbd Use gv_numeral//1.&lt;/li&gt;
&lt;li&gt;number(N).
% Alpha-numeric strings.
gv_id(Atom) &amp;ndash;&amp;gt;
{atom_codes(Atom, [H|T])},
@@ -263,22 +264,6 @@ gv_node_id(Id) &amp;ndash;&amp;gt; {type_error(gv_node_id, Id)}.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;--&#34;&gt;-%! gv_numeral(-Number)// is det.
-% &lt;code&gt;bnf -% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? ) -% &lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;-gv_numeral(N) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(&amp;quot;-&amp;quot; -&amp;gt; {Sg = -1} ; {Sg = 1}),&lt;/li&gt;
&lt;li&gt;(   &amp;ldquo;.&amp;rdquo;&lt;/li&gt;
&lt;li&gt;-&amp;gt;  {I = 0}, +(digit, Ds), {pos_frac(Ds, Frac)}&lt;/li&gt;
&lt;li&gt;;   +(digit, Ds1), {pos_sum(Ds1, I)},&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; (&amp;quot;.&amp;quot; -&amp;gt; *(digit, Ds2), {pos_frac(Ds2, Frac)} ; {Frac = 0.0})
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;{N is Sg * (I + Frac)}.&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;%! gv_port// is det.&lt;/p&gt;
&lt;p&gt;gv_port &amp;ndash;&amp;gt; gv_port_location, (gv_port_angle ; &amp;ldquo;&amp;quot;).
@@ -294,7 +279,7 @@ gv_port_location &amp;ndash;&amp;gt; &amp;ldquo;:[&amp;rdquo;, gv_id(&lt;em&gt;), &amp;ldquo;,&amp;rdquo;, gv_id(&lt;/em&gt;), &amp;ldquo;]&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;%! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
% &lt;code&gt;-% compass_pt : ( n | ne | e | se | s | sw | w | nw | c | _ ) +% compass_pt : (n | ne | e | se | s | sw | w | nw | c | _) % &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;gv_compass_pt(&#39;&lt;em&gt;&#39;) &amp;ndash;&amp;gt; &amp;ldquo;&lt;/em&gt;&amp;rdquo;.
diff &amp;ndash;git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
index b5c1368..3ee7de6 100644
&amp;mdash; a/prolog/gv/gv_html.pl
+++ b/prolog/gv/gv_html.pl
@@ -44,6 +44,7 @@ cell:   &lt;TD&gt; label &lt;/TD&gt;
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(dcg/dcg_content)).
:- use_module(library(html/html_dcg)).&lt;/p&gt;
&lt;p&gt;@@ -209,12 +210,7 @@ text(Content)  &amp;ndash;&amp;gt; text([Content]).
% ```
%
% Supported attributes for BR:
-%   * &lt;code&gt;ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;&lt;/code&gt;
-%
-% Supported attributes for FONT:
-%   * COLOR=&amp;ldquo;color&amp;rdquo;
-%   * FACE=&amp;ldquo;fontname&amp;rdquo;
-%   * POINT-SIZE=&amp;ldquo;value&amp;rdquo;
+%   - &lt;code&gt;ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;textitem(br(Attrs)) &amp;ndash;&amp;gt; !,
html_element(br, Attrs).
diff &amp;ndash;git a/prolog/gv/gv_numeral.pl b/prolog/gv/gv_numeral.pl
new file mode 100644
index 0000000..4ba0d64
&amp;mdash; /dev/null
+++ b/prolog/gv/gv_numeral.pl
@@ -0,0 +1,87 @@
+:- module(&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_numeral,&lt;/li&gt;
&lt;li&gt;[&lt;/li&gt;
&lt;li&gt;gv_numeral//1 % ?Value:number&lt;/li&gt;
&lt;li&gt;]
+).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+/** &lt;module&gt; GraphViz numeral
+
+@author Wouter Beek
+@version 2014/05-2014/06, 2015/01
+*/
+
+:- use_module(library(dcg/dcg_abnf)).
+:- use_module(library(dcg/dcg_abnf_common)).
+:- use_module(library(dcg/dcg_ascii)).
+:- use_module(library(math/math_ext)).
+:- use_module(library(math/positional)).
+:- use_module(library(math/radconv)).
+:- use_module(library(math/rational_ext)).
+
+
+
+
+
+%! gv_numeral(?Value:compound)// .
+%
+% # Syntax
+%
+% &lt;code&gt;bnf +% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? ) +% &lt;/code&gt;
+%
+% ## Generation
+%
+% In the generative case, three notations are allowed (also see below):
+%   1. (non-zero integer-part)
+%   2. (decimal-separator) (non-zero fractional)
+%   3. (non-zero integer-part) (decimal-separator) (non-zero fractional)
+%
+% The following notations are explicitly excluded due to verbosity:
+%   - (non-zero integer-part) (decimal-separator)
+%   - (non-zero integer-part) (decimal-separator) (zero fractional)
+%   - (zero integer-part) (decimal-separator) (non-zero fractional)
+%
+% The following notations are also excluded, but since they violate
+%  well-formedness:
+%   - (non-zero integer-part) (non-zero fractional)
+%   - (decimal-separator)
+
+gv_numeral(N) &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(   {ground(N)}&lt;/li&gt;
&lt;li&gt;-&amp;gt;  &amp;lsquo;[-]?&#39;(N),&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {N0 is abs(N)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {rational_parts(N0, I, F)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; (   % [1] The fractional is zero, so only write the integer part
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     %     and do not write the decimal separator.
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {F =:= 0}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; -&amp;gt;  {positional(I, IW)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]+&#39;(IW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ;   % [2] The integer part is zero, so only write the fractional part,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     %     preceded by the decimal separator.
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {I =:= 0}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; -&amp;gt;  &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {positional_fraction(FW, F)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]*&#39;(FW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ;   % [3] Both the integer part and the fractional are non-zero,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     %     so write both of them, with the decimal separator in-between.
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {positional(I, IW)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]+&#39;(IW),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {positional_fraction(FW, F)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]*&#39;(FW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; )
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;;   &amp;lsquo;[-]?&#39;(Sg),&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; (   &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     &#39;[0-9]+&#39;(FW),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     {IW = []}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ;   &#39;[0-9]+&#39;(IW),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     (   &amp;quot;.&amp;quot;,
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;         &#39;[0-9]*&#39;(FW)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     ;   {FW = []}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     )
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; ),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {rational_parts_weights(N0, IW, FW)},
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; {N is copysign(N0, Sg)}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;).
diff &amp;ndash;git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
deleted file mode 100644
index 4382aa6..0000000
&amp;mdash; a/prolog/tree/tree_viz.pl
+++ /dev/null
@@ -1,65 +0,0 @@
-:- module(&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;tree_viz,&lt;/li&gt;
&lt;li&gt;[&lt;/li&gt;
&lt;li&gt;tree_export_graph/2, % +Tree, ExportG&lt;/li&gt;
&lt;li&gt;tree_export_graph/3, % +Tree, ExportG, +Opts&lt;/li&gt;
&lt;li&gt;tree_viz/2,          % +Tree, ?File&lt;/li&gt;
&lt;li&gt;tree_viz/3           % +Tree, ?File, +Opts&lt;/li&gt;
&lt;li&gt;]
-).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;--module-tree-visualization&#34;&gt;-/** &lt;module&gt; Tree visualization&lt;/h2&gt;
&lt;h2 id=&#34;-export-trees-to-graphviz&#34;&gt;-Export trees to GraphViz.&lt;/h2&gt;
&lt;h2 id=&#34;--1&#34;&gt;-@author Wouter Beek
-@version 2016/01-2016/02
-*/&lt;/h2&gt;
&lt;h2 id=&#34;---use_modulelibrarytrees_tree&#34;&gt;-:- use_module(library(graph/build_export_graph)).
-:- use_module(library(gv/gv_file)).
-:- use_module(library(ordsets)).
-:- use_module(library(tree/l_tree)).
-:- use_module(library(tree/s_tree)).&lt;/h2&gt;
&lt;p&gt;-:- predicate_options(tree_export_graph/3, 3, [&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(build_export_graph/4, 4)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;]).
-:- predicate_options(tree_viz/3, 3, [&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(graph_viz/3, 3),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;pass_to(tree_to_graph/3, 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;]).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;--opts-are-passed-to-build_export_graph4&#34;&gt;-%! tree_export_graph(+Tree, -ExportG) is det.
-%! tree_export_graph(+Tree, -ExportG, +Opts) is det.
-% Opts are passed to build_export_graph/4.&lt;/h2&gt;
&lt;p&gt;-tree_export_graph(Tree, ExportG) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tree_export_graph(Tree, ExportG, []).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-tree_export_graph(Tree, ExportG, Opts) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(   is_s_tree(Tree)&lt;/li&gt;
&lt;li&gt;-&amp;gt;  tree_to_graph(Tree, G)&lt;/li&gt;
&lt;li&gt;;   is_l_tree(Tree)&lt;/li&gt;
&lt;li&gt;-&amp;gt;  l_tree_to_graph(Tree, G)&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;build_export_graph(G, ExportG, Opts).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;--options-are-passed-to-export_graph_to_gv_file3-tree_to_graph3&#34;&gt;-%! tree_viz(+Tree, ?File) is det.
-%! tree_viz(+Tree, ?File, +Opts) is det.
-% Stores the given tree term into a GraphViz file.
-%
-% Options are passed to export_graph_to_gv_file/3, tree_to_graph/3.&lt;/h2&gt;
&lt;p&gt;-tree_viz(Tree, File) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tree_viz(Tree, File, []).&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-tree_viz(Tree, File, Opts) :-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tree_export_graph(Tree, ExportG, Opts),&lt;/li&gt;
&lt;li&gt;graph_viz(ExportG, File, Opts).
diff &amp;ndash;git a/test/test.pl b/test/test.pl
index 83dc023..c1bdca0 100644
&amp;mdash; a/test/test.pl
+++ b/test/test.pl
@@ -6,10 +6,8 @@
:- use_module(library(gv/gv_attrs)).
:- use_module(library(gv/gv_attr_type)).
:- use_module(library(gv/gv_color)).
-:- use_module(library(gv/gv_dom)).
:- use_module(library(gv/gv_file)).
:- use_module(library(gv/gv_graph)).
:- use_module(library(gv/gv_graph_comp)).
:- use_module(library(gv/gv_html)).
-%/tree
-:- use_module(library(tree/tree_viz)).
+:- use_module(library(gv/gv_numeral)).&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt; 
&amp;lt;h2 id=&amp;quot;148&amp;quot;&amp;gt; 148: 正在比较变动前 4e2d9f1 和变动后 6359c9c &amp;lt;/h2&amp;gt;
[back to content](#compare)
 
``` diff
 
diff --git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
index 3ee7de6..3e06db0 100644
--- a/prolog/gv/gv_html.pl
+++ b/prolog/gv/gv_html.pl
@@ -210,7 +210,12 @@ text(Content)  --&amp;gt; text([Content]).
 % ```
 %
 % Supported attributes for BR:
-%   - `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
+%   * `ALIGN=&amp;quot;CENTER|LEFT|RIGHT&amp;quot;`
+%
+% Supported attributes for FONT:
+%   * COLOR=&amp;quot;color&amp;quot;
+%   * FACE=&amp;quot;fontname&amp;quot;
+%   * POINT-SIZE=&amp;quot;value&amp;quot;
 
 textitem(br(Attrs)) --&amp;gt; !,
   html_element(br, Attrs).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;149&#34;&gt; 149: 正在比较变动前 6359c9c 和变动后 00537d0 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index e6fb117..4d0f7d1 100644
--- a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -2,22 +2,19 @@
   fca_viz,
   [
     fca_export_graph/2, % +Context, -ExportGraph
-    fca_export_graph/3, % +Context:compound
-                        % -ExportGraph:compound
-                        % :Options:list(compound)
-    fca_viz/2, % +Context, ?File
-    fca_viz/3 % +Context:compound
-              % ?File:atom
-              % :Options:list(compound)
+    fca_export_graph/3, % +Context, -ExportGraph, :Opts
+    fca_viz/2,          % +Context, ?File
+    fca_viz/3           % +Context, ?File, :Opts
   ]
 ).
 
 /** &amp;lt;module&amp;gt; FCA visualization
 
 @author Wouter Beek
-@version 2015/11-2015/12
+@version 2015/11-2016/01
 */
 
+:- use_module(library(aggregate)).
 :- use_module(library(dcg/dcg_collection)).
 :- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(dcg/dcg_pl)).
@@ -36,7 +33,7 @@
    ]).
 :- predicate_options(fca_viz/3, 3, [
      pass_to(fca_export_graph/3, 3),
-     pass_to(gv_export/3, 3)
+     pass_to(graph_viz/3, 3)
    ]).
 
 is_meta(concept_label).
@@ -88,8 +85,15 @@ fca_viz(Context, File):-
 
 fca_viz(Context, File, Opts1):-
   meta_options(is_meta, Opts1, Opts2),
+  statistics(process_cputime, Time1),
   fca_export_graph(Context, ExportG, Opts2),
-  gv_export(ExportG, File, Opts2).
+  ExportG = graph(_,_,Es,_),
+  aggregate_all(max(N), (member(edge(V1,V2,_), Es), (N = V1 ; N = V2)), N),
+  ignore(option(number_of_vertices(N), Opts2)),
+  statistics(process_cputime, Time2),
+  Time is Time2 - Time1,
+  ignore(option(process_cputime(Time), Opts2)),
+  graph_viz(ExportG, File, Opts2).
 
 
 
diff --git a/prolog/gv/gv_dom.pl b/prolog/gv/gv_dom.pl
index e85849d..b0ece01 100644
--- a/prolog/gv/gv_dom.pl
+++ b/prolog/gv/gv_dom.pl
@@ -10,7 +10,7 @@
 /** &amp;lt;module&amp;gt; GraphViz DOM
 
 @author Wouter Beek
-@version 2015/07
+@version 2015/07, 2016/01
 */
 
 :- use_module(library(gv/gv_file)).
@@ -30,6 +30,6 @@
 gv_dom(ExportG, Dom, Opts1):-
   % Make sure the file type of the output file is SvgDom.
   merge_options([output(svg)], Opts1, Opts2),
-  gv_export(ExportG, ToFile, Opts2),
+  graph_viz(ExportG, ToFile, Opts2),
   svg_dom(ToFile, Dom),
   delete_file(ToFile).
diff --git a/prolog/gv/gv_file.pl b/prolog/gv/gv_file.pl
index 4cf12a8..993fcee 100644
--- a/prolog/gv/gv_file.pl
+++ b/prolog/gv/gv_file.pl
@@ -1,18 +1,15 @@
 :- module(
   gv_file,
   [
-    gv_export/2, % +ExportGraph:compound
-                 % ?File:atom
-    gv_export/3 % +ExportGraph:compound
-                % ?File:atom
-                % +Options:list(nvpair)
+    graph_viz/2, % +ExportG, ?File
+    graph_viz/3  % +ExportG, ?File, +Opts
   ]
 ).
 
 /** &amp;lt;module&amp;gt; GraphViz file
 
 @author Wouter Beek
-@version 2015/07, 2015/10-2015/11
+@version 2015/07, 2015/10-2015/11, 2016/01
 */
 
 :- use_module(library(code_ext)).
@@ -23,7 +20,7 @@
 :- use_module(library(os/process_ext)).
 :- use_module(library(string_ext)).
 
-:- predicate_options(gv_export/3, 3, [
+:- predicate_options(graph_viz/3, 3, [
      pass_to(file_to_gv/3, 3)
    ]).
 :- predicate_options(file_to_gv/3, 3, [
@@ -40,14 +37,8 @@ user:module_uses(gv_file, program(dot)).
 
 
 
-%! gv_export(+ExportGraph:compound, ?File:atom) is det.
-% Wrapper around gv_export/3 with default options.
-
-gv_export(ExportG, File):-
-  gv_export(ExportG, File, []).
-
-
-%! gv_export(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
+%! graph_viz(+ExportGraph:compound, ?File:atom) is det.
+%! graph_viz(+ExportGraph:compound, ?File:atom, +Options:list(compound)) is det.
 % Returns a file containing a GraphViz visualization of the given graph.
 %
 % The following options are supported:
@@ -60,7 +51,9 @@ gv_export(ExportG, File):-
 %     Default is `pdf`.
 %     For possible values see gv_output_type/1.
 
-gv_export(ExportG, File, Opts):-
+graph_viz(ExportG, File):-
+  graph_viz(ExportG, File, []).
+graph_viz(ExportG, File, Opts):-
   once(phrase(gv_graph(ExportG), Cs)),
 
   % Be thread-safe.
diff --git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
new file mode 100644
index 0000000..35430da
--- /dev/null
+++ b/prolog/tree/tree_viz.pl
@@ -0,0 +1,62 @@
+:- module(
+  gv_tree,
+  [
+    tree_export_graph/2, % +Tree, ExportG
+    tree_export_graph/3, % +Tree, ExportG, +Opts
+    tree_viz/2,          % +Tree, ?File
+    tree_viz/3           % +Tree, ?File, +Opts
+  ]
+).
+
+/** &amp;lt;module&amp;gt; Tree visualization
+
+Export trees to GraphViz.
+
+@author Wouter Beek
+@version 2016/01
+*/
+
+:- use_module(library(graph/build_export_graph)).
+:- use_module(library(gv/gv_file)).
+:- use_module(library(ordsets)).
+
+:- predicate_options(tree_export_graph/3, 3, [
+     pass_to(build_export_graph/4, 4)
+   ]).
+:- predicate_options(tree_viz/3, 3, [
+     pass_to(graph_viz/3, 3),
+     pass_to(tree_to_graph/3, 3)
+   ]).
+
+
+
+
+
+%! tree_export_graph(+Tree, -ExportG) is det.
+%! tree_export_graph(+Tree, -ExportG, +Opts) is det.
+% Opts are passed to build_export_graph/4.
+
+tree_export_graph(Tree, ExportG) :-
+  tree_export_graph(Tree, ExportG, []).
+tree_export_graph(t(H,Subtrees), ExportG, Opts) :-
+  maplist(tree_export_graph, Subtrees, ExportGs),
+  maplist(unpack_graph, ExportGs, SubVs, SubEs),
+  ord_union([[H]|SubVs], Vs),
+  ord_union(SubEs, Es),
+  build_export_graph(graph(Vs,Es), ExportG, Opts).
+
+unpack_graph(graph(Vs,Es), Vs, Es).
+
+
+
+%! tree_viz(+Tree, ?File) is det.
+%! tree_viz(+Tree, ?File, +Opts) is det.
+% Stores the given tree term into a GraphViz file.
+%
+% Options are passed to export_graph_to_gv_file/3, tree_to_graph/3.
+
+tree_viz(Tree, File) :-
+  tree_viz(Tree, File, []).
+tree_viz(Tree, File, Opts) :-
+  tree_export_graph(Tree, ExportG, Opts),
+  graph_viz(ExportG, File, Opts).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;150&#34;&gt; 150: 正在比较变动前 00537d0 和变动后 acadc39 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
index 35430da..030dc0a 100644
--- a/prolog/tree/tree_viz.pl
+++ b/prolog/tree/tree_viz.pl
@@ -1,5 +1,5 @@
 :- module(
-  gv_tree,
+  tree_viz,
   [
     tree_export_graph/2, % +Tree, ExportG
     tree_export_graph/3, % +Tree, ExportG, +Opts
@@ -19,6 +19,7 @@ Export trees to GraphViz.
 :- use_module(library(graph/build_export_graph)).
 :- use_module(library(gv/gv_file)).
 :- use_module(library(ordsets)).
+:- use_module(library(tree/tree)).
 
 :- predicate_options(tree_export_graph/3, 3, [
      pass_to(build_export_graph/4, 4)
@@ -39,8 +40,8 @@ Export trees to GraphViz.
 tree_export_graph(Tree, ExportG) :-
   tree_export_graph(Tree, ExportG, []).
 tree_export_graph(t(H,Subtrees), ExportG, Opts) :-
-  maplist(tree_export_graph, Subtrees, ExportGs),
-  maplist(unpack_graph, ExportGs, SubVs, SubEs),
+  maplist(tree_to_graph, Subtrees, Gs),
+  maplist(unpack_graph, Gs, SubVs, SubEs),
   ord_union([[H]|SubVs], Vs),
   ord_union(SubEs, Es),
   build_export_graph(graph(Vs,Es), ExportG, Opts).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;151&#34;&gt; 151: 正在比较变动前 acadc39 和变动后 51359c6 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index aecbe07..dacfbe9 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -24,7 +24,7 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 @author Wouter Beek
 @see http://www.graphviz.org/content/dot-language
-@version 2015/07-2015/08, 2015/10-2015/12
+@version 2015/07-2015/08, 2015/10-2016/01
 */
 
 :- use_module(library(apply)).
@@ -199,9 +199,7 @@ gv_id(double_quoted_string(Atom)) --&amp;gt; !,
   &amp;quot;\&amp;quot;&amp;quot;, atom(Atom), &amp;quot;\&amp;quot;&amp;quot;.
 % Numerals.
 gv_id(N) --&amp;gt;
-  {number(N)}, !,
-  % @tbd Use gv_numeral//1.
-  number(N).
+  gv_numeral(N), !.
 % Alpha-numeric strings.
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
@@ -264,6 +262,22 @@ gv_node_id(Id) --&amp;gt; {type_error(gv_node_id, Id)}.
 
 
 
+%! gv_numeral(-Number)// is det.
+% ```bnf
+% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
+% ```
+
+gv_numeral(N) --&amp;gt;
+  (&amp;quot;-&amp;quot; -&amp;gt; {Sg = -1} ; {Sg = 1}),
+  (   &amp;quot;.&amp;quot;
+  -&amp;gt;  {I = 0}, +(digit, Ds), {pos_frac(Ds, Frac)}
+  ;   +(digit, Ds1), {pos_sum(Ds1, I)},
+      (&amp;quot;.&amp;quot; -&amp;gt; *(digit, Ds2), {pos_frac(Ds2, Frac)} ; {Frac = 0.0})
+  ),
+  {N is Sg * (I + Frac)}.
+
+
+
 %! gv_port// is det.
 
 gv_port --&amp;gt; gv_port_location, (gv_port_angle ; &amp;quot;&amp;quot;).
@@ -279,7 +293,7 @@ gv_port_location --&amp;gt; &amp;quot;:[&amp;quot;, gv_id(_), &amp;quot;,&amp;quot;, gv_id(_), &amp;quot;]&amp;quot;.
 
 %! gv_compass_pt(+Direction:oneof([&#39;_&#39;,c,e,n,ne,nw,s,se,sw,w]))// .
 % ```
-% compass_pt : (n | ne | e | se | s | sw | w | nw | c | _)
+% compass_pt : ( n | ne | e | se | s | sw | w | nw | c | _ )
 % ```
 
 gv_compass_pt(&#39;_&#39;) --&amp;gt; &amp;quot;_&amp;quot;.
diff --git a/prolog/gv/gv_numeral.pl b/prolog/gv/gv_numeral.pl
deleted file mode 100644
index 4ba0d64..0000000
--- a/prolog/gv/gv_numeral.pl
+++ /dev/null
@@ -1,87 +0,0 @@
-:- module(
-  gv_numeral,
-  [
-    gv_numeral//1 % ?Value:number
-  ]
-).
-
-/** &amp;lt;module&amp;gt; GraphViz numeral
-
-@author Wouter Beek
-@version 2014/05-2014/06, 2015/01
-*/
-
-:- use_module(library(dcg/dcg_abnf)).
-:- use_module(library(dcg/dcg_abnf_common)).
-:- use_module(library(dcg/dcg_ascii)).
-:- use_module(library(math/math_ext)).
-:- use_module(library(math/positional)).
-:- use_module(library(math/radconv)).
-:- use_module(library(math/rational_ext)).
-
-
-
-
-
-%! gv_numeral(?Value:compound)// .
-%
-% # Syntax
-%
-% ```bnf
-% (&#39;-&#39;)? ( &#39;.&#39; [0-9]+ | [0-9]+ ( &#39;.&#39; [0-9]* )? )
-% ```
-%
-% ## Generation
-%
-% In the generative case, three notations are allowed (also see below):
-%   1. (non-zero integer-part)
-%   2. (decimal-separator) (non-zero fractional)
-%   3. (non-zero integer-part) (decimal-separator) (non-zero fractional)
-%
-% The following notations are explicitly excluded due to verbosity:
-%   - (non-zero integer-part) (decimal-separator)
-%   - (non-zero integer-part) (decimal-separator) (zero fractional)
-%   - (zero integer-part) (decimal-separator) (non-zero fractional)
-%
-% The following notations are also excluded, but since they violate
-%  well-formedness:
-%   - (non-zero integer-part) (non-zero fractional)
-%   - (decimal-separator)
-
-gv_numeral(N) --&amp;gt;
-  (   {ground(N)}
-  -&amp;gt;  &#39;[-]?&#39;(N),
-      {N0 is abs(N)},
-      {rational_parts(N0, I, F)},
-      (   % [1] The fractional is zero, so only write the integer part
-          %     and do not write the decimal separator.
-          {F =:= 0}
-      -&amp;gt;  {positional(I, IW)},
-          &#39;[0-9]+&#39;(IW)
-      ;   % [2] The integer part is zero, so only write the fractional part,
-          %     preceded by the decimal separator.
-          {I =:= 0}
-      -&amp;gt;  &amp;quot;.&amp;quot;,
-          {positional_fraction(FW, F)},
-          &#39;[0-9]*&#39;(FW)
-      ;   % [3] Both the integer part and the fractional are non-zero,
-          %     so write both of them, with the decimal separator in-between.
-          {positional(I, IW)},
-          &#39;[0-9]+&#39;(IW),
-          &amp;quot;.&amp;quot;,
-          {positional_fraction(FW, F)},
-          &#39;[0-9]*&#39;(FW)
-      )
-  ;   &#39;[-]?&#39;(Sg),
-      (   &amp;quot;.&amp;quot;,
-          &#39;[0-9]+&#39;(FW),
-          {IW = []}
-      ;   &#39;[0-9]+&#39;(IW),
-          (   &amp;quot;.&amp;quot;,
-              &#39;[0-9]*&#39;(FW)
-          ;   {FW = []}
-          )
-      ),
-      {rational_parts_weights(N0, IW, FW)},
-      {N is copysign(N0, Sg)}
-  ).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;152&#34;&gt; 152: 正在比较变动前 51359c6 和变动后 73047b3 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index caabaa0..6231cc3 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -50,18 +50,18 @@ Vertex coordinates:
 ---
 
 @author Wouter Beek
-@version 2015/07, 2015/09-2015/12
+@version 2015/07, 2015/09-2016/01
 */
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/dcg_call)).
 :- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(graph/s/s_graph)).
-:- use_module(library(lambda)).
 :- use_module(library(list_ext)).
 :- use_module(library(option_ext)).
 :- use_module(library(ordsets)).
 :- use_module(library(pairs)).
+:- use_module(library(yall)).
 
 :- predicate_options(build_export_graph/4, 4, [
      pass_to(edge_term/3, 3),
@@ -142,9 +142,9 @@ build_export_graph(G, ExportG):-
 build_export_graph(G, graph(VTerms2,VRanks,ETerms,GAttrs), Opts1):-
   graph_components(G, Vs, Es),
   meta_options(is_meta, Opts1, Opts2),
-  maplist(\V^VTerm^vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms1),
+  maplist([V,VTerm]&amp;gt;&amp;gt;vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms1),
   build_export_ranks(Vs, VTerms1, VRanks, VTerms2, Opts2),
-  maplist(\E^ETerm^edge_term(Vs, E, ETerm, Opts2), Es, ETerms),
+  maplist([E,ETerm]&amp;gt;&amp;gt;edge_term(Vs, E, ETerm, Opts2), Es, ETerms),
   graph_attributes(GAttrs, Opts2).
 
 graph_components(graph(Vs,Es), Vs, Es):- !.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;153&#34;&gt; 153: 正在比较变动前 73047b3 和变动后 e4c4586 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
index 030dc0a..071d3c0 100644
--- a/prolog/tree/tree_viz.pl
+++ b/prolog/tree/tree_viz.pl
@@ -13,13 +13,14 @@
 Export trees to GraphViz.
 
 @author Wouter Beek
-@version 2016/01
+@version 2016/01-2016/02
 */
 
 :- use_module(library(graph/build_export_graph)).
 :- use_module(library(gv/gv_file)).
 :- use_module(library(ordsets)).
-:- use_module(library(tree/tree)).
+:- use_module(library(tree/l_tree)).
+:- use_module(library(tree/s_tree)).
 
 :- predicate_options(tree_export_graph/3, 3, [
      pass_to(build_export_graph/4, 4)
@@ -39,14 +40,14 @@ Export trees to GraphViz.
 
 tree_export_graph(Tree, ExportG) :-
   tree_export_graph(Tree, ExportG, []).
-tree_export_graph(t(H,Subtrees), ExportG, Opts) :-
-  maplist(tree_to_graph, Subtrees, Gs),
-  maplist(unpack_graph, Gs, SubVs, SubEs),
-  ord_union([[H]|SubVs], Vs),
-  ord_union(SubEs, Es),
-  build_export_graph(graph(Vs,Es), ExportG, Opts).
 
-unpack_graph(graph(Vs,Es), Vs, Es).
+tree_export_graph(Tree, ExportG, Opts) :-
+  (   is_s_tree(Tree)
+  -&amp;gt;  s_tree_to_graph(Tree, G)
+  ;   is_l_tree(Tree)
+  -&amp;gt;  l_tree_to_graph(Tree, G)
+  ),
+  build_export_graph(G, ExportG, Opts).
 
 
 
@@ -58,6 +59,7 @@ unpack_graph(graph(Vs,Es), Vs, Es).
 
 tree_viz(Tree, File) :-
   tree_viz(Tree, File, []).
+
 tree_viz(Tree, File, Opts) :-
   tree_export_graph(Tree, ExportG, Opts),
   graph_viz(ExportG, File, Opts).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;154&#34;&gt; 154: 正在比较变动前 e4c4586 和变动后 7b991bb &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index 8fa78af..d7f133e 100644
--- a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -46,10 +46,10 @@
 /** &amp;lt;module&amp;gt; GraphViz attribute types
 
 @author Wouter Beek
-@version 2015/07, 2015/11
+@version 2015/07, 2015/11, 2016/02
 */
 
-:- use_module(library(dcg/basics), except([string//1])).
+:- use_module(library(dcg/dcg_ext), except([string//1])).
 :- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(gv/gv_html)).
 
@@ -256,7 +256,7 @@ input_changeable(true) --&amp;gt; &amp;quot;!&amp;quot;.
 %! pointList(+Points:list(compound))// .
 
 pointList(Points) --&amp;gt;
-  *(point, Points, []).
+  *(point, Points).
 
 
 
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index 3232c97..faa3828 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -14,11 +14,11 @@
 @author Wouter Beek
 @tbd Color value `transparent` is only available in the output formats
      ps, svg, fig, vmrl, and the bitmap formats.
-@version 2015/08, 2015/10
+@version 2015/08, 2015/10, 2016/02
 */
 
 :- use_module(library(apply)).
-:- use_module(library(dcg/basics)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(dcg/dcg_content)).
 :- use_module(library(lists)).
 :- use_module(library(os/file_ext)).
@@ -40,7 +40,7 @@ color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
   color(rgb(Red,Green,Blue)),
   hex_color(Alpha).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
-  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value], []).
+  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value]).
 color(Name) --&amp;gt;
   {gv_color(_, Name)},
   atom(Name).
@@ -56,7 +56,7 @@ hsv_color(D, Head, Tail):-
 %! colorList(+Pairs:list(pair(compound,float)))// .
 
 colorList(L) --&amp;gt;
-  &#39;+&#39;(wc, L, []).
+  &#39;+&#39;(wc, L).
 
 wc(Color-Float) --&amp;gt;
   color(Color),
diff --git a/test/test.pl b/test/test.pl
index c1bdca0..83dc023 100644
--- a/test/test.pl
+++ b/test/test.pl
@@ -6,8 +6,10 @@
 :- use_module(library(gv/gv_attrs)).
 :- use_module(library(gv/gv_attr_type)).
 :- use_module(library(gv/gv_color)).
+:- use_module(library(gv/gv_dom)).
 :- use_module(library(gv/gv_file)).
 :- use_module(library(gv/gv_graph)).
 :- use_module(library(gv/gv_graph_comp)).
 :- use_module(library(gv/gv_html)).
-:- use_module(library(gv/gv_numeral)).
+%/tree
+:- use_module(library(tree/tree_viz)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;155&#34;&gt; 155: 正在比较变动前 7b991bb 和变动后 fa1518f &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
index 190b988..75a83a0 100644
--- a/data/gv_attrs_scrape.pl
+++ b/data/gv_attrs_scrape.pl
@@ -25,8 +25,7 @@ gv_attr(
 */
 
 :- use_module(library(apply)).
-:- use_module(library(dcg/basics), except([string//1])).
-:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(gv/gv_attr_type)).
 :- use_module(library(http/http_download)).
 :- use_module(library(iostream)).
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index 4d0f7d1..1392db9 100644
--- a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -16,7 +16,7 @@
 
 :- use_module(library(aggregate)).
 :- use_module(library(dcg/dcg_collection)).
-:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(dcg/dcg_pl)).
 :- use_module(library(fca/fca)).
 :- use_module(library(graph/build_export_graph)).
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index 6231cc3..ef74aa7 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -54,8 +54,7 @@ Vertex coordinates:
 */
 
 :- use_module(library(apply)).
-:- use_module(library(dcg/dcg_call)).
-:- use_module(library(dcg/dcg_phrase)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(graph/s/s_graph)).
 :- use_module(library(list_ext)).
 :- use_module(library(option_ext)).
diff --git a/prolog/gv/gv_attr_type.pl b/prolog/gv/gv_attr_type.pl
index d7f133e..f55fce5 100644
--- a/prolog/gv/gv_attr_type.pl
+++ b/prolog/gv/gv_attr_type.pl
@@ -50,7 +50,6 @@
 */
 
 :- use_module(library(dcg/dcg_ext), except([string//1])).
-:- use_module(library(dcg/dcg_phrase)).
 :- use_module(library(gv/gv_html)).
 
 
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index b26af73..11230b9 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -14,7 +14,7 @@
 */
 
 :- use_module(library(apply)).
-:- use_module(library(dcg/dcg_call)).
+:- use_module(library(dcg/dcg_ext)).
 :- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
 :- use_module(library(lists)).
 :- use_module(library(os/file_ext)).
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index faa3828..a63d9c4 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -19,7 +19,6 @@
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_content)).
 :- use_module(library(lists)).
 :- use_module(library(os/file_ext)).
 
diff --git a/prolog/gv/gv_graph.pl b/prolog/gv/gv_graph.pl
index 5c937ce..c95c9cc 100644
--- a/prolog/gv/gv_graph.pl
+++ b/prolog/gv/gv_graph.pl
@@ -20,7 +20,6 @@ In GraphViz vertices are called &#39;nodes&#39;.
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_content)).
 :- use_module(library(gv/gv_graph_comp)).
 :- use_module(library(lists)).
 :- use_module(library(option)).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index dacfbe9..367534b 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -29,7 +29,6 @@ a_list = ID &amp;quot;=&amp;quot; ID [&amp;quot;,&amp;quot;] [a_list]
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_content)).
 :- use_module(library(gv/gv_attrs)).
 :- use_module(library(gv/gv_html)).
 :- use_module(library(error)).
diff --git a/prolog/gv/gv_html.pl b/prolog/gv/gv_html.pl
index 3e06db0..b5c1368 100644
--- a/prolog/gv/gv_html.pl
+++ b/prolog/gv/gv_html.pl
@@ -44,7 +44,6 @@ cell:   &amp;lt;TD&amp;gt; label &amp;lt;/TD&amp;gt;
 */
 
 :- use_module(library(dcg/dcg_ext)).
-:- use_module(library(dcg/dcg_content)).
 :- use_module(library(html/html_dcg)).
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;156&#34;&gt; 156: 正在比较变动前 fa1518f 和变动后 8593ed6 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/graph/build_export_graph.pl b/prolog/graph/build_export_graph.pl
index ef74aa7..5134069 100644
--- a/prolog/graph/build_export_graph.pl
+++ b/prolog/graph/build_export_graph.pl
@@ -60,7 +60,6 @@ Vertex coordinates:
 :- use_module(library(option_ext)).
 :- use_module(library(ordsets)).
 :- use_module(library(pairs)).
-:- use_module(library(yall)).
 
 :- predicate_options(build_export_graph/4, 4, [
      pass_to(edge_term/3, 3),
@@ -141,11 +140,15 @@ build_export_graph(G, ExportG):-
 build_export_graph(G, graph(VTerms2,VRanks,ETerms,GAttrs), Opts1):-
   graph_components(G, Vs, Es),
   meta_options(is_meta, Opts1, Opts2),
-  maplist([V,VTerm]&amp;gt;&amp;gt;vertex_term(Vs, V, VTerm, Opts2), Vs, VTerms1),
+  maplist(vertex_term0(Vs, Opts2), Vs, VTerms1),
   build_export_ranks(Vs, VTerms1, VRanks, VTerms2, Opts2),
-  maplist([E,ETerm]&amp;gt;&amp;gt;edge_term(Vs, E, ETerm, Opts2), Es, ETerms),
+  maplist(edge_term0(Vs, Opts2), Es, ETerms),
   graph_attributes(GAttrs, Opts2).
 
+vertex_term0(Vs, Opts, V, VTerm) :- vertex_term(Vs, V, VTerm, Opts).
+
+edge_term0(Vs, Opts, E, ETerm) :- edge_term(Vs, E, ETerm, Opts).
+
 graph_components(graph(Vs,Es), Vs, Es):- !.
 graph_components(G, Vs, Es):-
   s_graph_components(G, Vs, Es).
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index 367534b..f316cb7 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -198,7 +198,9 @@ gv_id(double_quoted_string(Atom)) --&amp;gt; !,
   &amp;quot;\&amp;quot;&amp;quot;, atom(Atom), &amp;quot;\&amp;quot;&amp;quot;.
 % Numerals.
 gv_id(N) --&amp;gt;
-  gv_numeral(N), !.
+  {number(N)}, !,
+  {number_codes(N, Cs)},
+  Cs.
 % Alpha-numeric strings.
 gv_id(Atom) --&amp;gt;
   {atom_codes(Atom, [H|T])},
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;157&#34;&gt; 157: 正在比较变动前 8593ed6 和变动后 cc53b1e &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 11230b9..1e7c93b 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -10,11 +10,12 @@
 /** &amp;lt;module&amp;gt; GraphViz attributes
 
 @author Wouter Beek
-@version 2015/07-2015/08, 2015/10
+@version 2015/07-2015/08, 2015/10, 2016/03
 */
 
 :- use_module(library(apply)).
 :- use_module(library(dcg/dcg_ext)).
+:- use_module(library(error)).
 :- use_module(library(gv/gv_attr_type), [gv_attr_type//1]).
 :- use_module(library(lists)).
 :- use_module(library(os/file_ext)).
@@ -33,11 +34,11 @@
 % Use the default if no value is given.
 gv_attr_value(Context, Name=Value) --&amp;gt;
   {
-    var(Value), !,
+    var(Value),
     gv_attr(Name, UsedBy, _, DefaultValue, _, _),
     % Check validity of context.
     memberchk(Context, UsedBy)
-  },
+  }, !,
   gv_attr_value(Context, Name=DefaultValue).
 gv_attr_value(Context, Name=Value) --&amp;gt;
   {
@@ -56,8 +57,10 @@ gv_attr_value(Context, Name=Value) --&amp;gt;
 
     % Check validity of Value w.r.t. minimum value -- if available.
     check_minimum(Value, Minimum)
-  },
+  }, !,
   dcg_call(gv_attr_type:Dcg, Value).
+gv_attr_value(_, Name=_) --&amp;gt;
+  {existence_error(gv_attr, Name)}.
 
 
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;158&#34;&gt; 158: 正在比较变动前 cc53b1e 和变动后 202a241 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/tree/tree_viz.pl b/prolog/tree/tree_viz.pl
index 071d3c0..4382aa6 100644
--- a/prolog/tree/tree_viz.pl
+++ b/prolog/tree/tree_viz.pl
@@ -43,7 +43,7 @@ tree_export_graph(Tree, ExportG) :-
 
 tree_export_graph(Tree, ExportG, Opts) :-
   (   is_s_tree(Tree)
-  -&amp;gt;  s_tree_to_graph(Tree, G)
+  -&amp;gt;  tree_to_graph(Tree, G)
   ;   is_l_tree(Tree)
   -&amp;gt;  l_tree_to_graph(Tree, G)
   ),
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;159&#34;&gt; 159: 正在比较变动前 202a241 和变动后 858b5fb &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
index 75a83a0..d43346f 100644
--- a/data/gv_attrs_scrape.pl
+++ b/data/gv_attrs_scrape.pl
@@ -30,8 +30,8 @@ gv_attr(
 :- use_module(library(http/http_download)).
 :- use_module(library(iostream)).
 :- use_module(library(lists)).
-:- use_module(library(msg_ext)).
 :- use_module(library(pl/pl_term)).
+:- use_module(library(print_ext)).
 :- use_module(library(xpath)).
 :- use_module(library(xpath/xpath_table)).
 
diff --git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
index 3ac5d44..5d220d9 100644
--- a/data/gv_color_scrape.pl
+++ b/data/gv_color_scrape.pl
@@ -15,8 +15,8 @@
 :- use_module(library(http/http_download)).
 :- use_module(library(iostream)).
 :- use_module(library(lists)).
-:- use_module(library(msg_ext)).
 :- use_module(library(pl/pl_term)).
+:- use_module(library(print_ext)).
 :- use_module(library(xpath)).
 :- use_module(library(xpath/xpath_table)).
 
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;160&#34;&gt; 160: 正在比较变动前 858b5fb 和变动后 260b62d &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_attrs.pl b/prolog/gv/gv_attrs.pl
index 1e7c93b..4a92d5b 100644
--- a/prolog/gv/gv_attrs.pl
+++ b/prolog/gv/gv_attrs.pl
@@ -2,7 +2,7 @@
   gv_attrs,
   [
     gv_attr_value//2 % +Context:oneof([cluster,edge,graph,node,subgraph])
-                     % +Attribute:nvpair
+                     % +Attr
   ]
 ).
 :- ensure_loaded(library(&#39;gv/gv_attrs.data&#39;)).
@@ -24,12 +24,11 @@
 
 
 
-%! gv_attr_value(
-%!   +Context:oneof([cluster,edge,graph,node,subgraph]),
-%!   +Attribute:compound
-%! )// is det.
+%! gv_attr_value(+Context, +Attr)// is det.
 % Uses the default value in case Value is uninstantiated.
 % Otherwise, performs a typecheck and converts the given value.
+%
+% Context can be either `cluster`, `edge`, `graph`, `node` or `subgraph`.
 
 % Use the default if no value is given.
 gv_attr_value(Context, Name=Value) --&amp;gt;
diff --git a/prolog/gv/gv_graph_comp.pl b/prolog/gv/gv_graph_comp.pl
index f316cb7..30ea9c5 100644
--- a/prolog/gv/gv_graph_comp.pl
+++ b/prolog/gv/gv_graph_comp.pl
@@ -85,7 +85,7 @@ gv_edge_operator(Dir) --&amp;gt;
 %! gv_generic_attributes_statement(
 %!   +Kind:oneof([edge,graph,node]),
 %!   +Indent:nonneg,
-%!   +CategoryAttributes:list(nvpair)
+%!   +CategoryAttrs
 %! )//
 % A GraphViz statement describing generic attributes for a category of items.
 %
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;161&#34;&gt; 161: 正在比较变动前 260b62d 和变动后 a6886ca &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/gv/gv_dom.pl b/prolog/gv/gv_dom.pl
index b0ece01..30c4263 100644
--- a/prolog/gv/gv_dom.pl
+++ b/prolog/gv/gv_dom.pl
@@ -1,9 +1,7 @@
 :- module(
   gv_dom,
   [
-    gv_dom/3 % +ExportGraph:compound
-             % -Dom:list(compound)
-             % +Options:list(compound)
+    gv_dom/3 % +ExportG, -Dom, +Opts
   ]
 ).
 
@@ -15,17 +13,13 @@
 
 :- use_module(library(gv/gv_file)).
 :- use_module(library(option)).
-:- use_module(library(svg/svg_dom)).
+:- use_module(library(svg/svg_ext)).
 
 
 
 
 
-%! gv_dom(
-%!   +ExportGraph:compound,
-%!   -Dom:list(compound),
-%!   +Options:list(compound)
-%! ) is det.
+%! gv_dom(+ExportG, -Dom, +Opts) is det.
 
 gv_dom(ExportG, Dom, Opts1):-
   % Make sure the file type of the output file is SvgDom.
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;162&#34;&gt; 162: 正在比较变动前 a6886ca 和变动后 41914a2 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/pack.pl b/pack.pl
index 203cbfc..989108a 100644
--- a/pack.pl
+++ b/pack.pl
@@ -4,6 +4,6 @@ home(&#39;https://github.com/wouterbeek/plGraphViz&#39;).
 maintainer(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
 name(plGraphViz).
 packager(&#39;Wouter Beek&#39;, &#39;me@wouterbeek.com&#39;).
-requires(&#39;Prolog_Library_Collection&#39;).
+requires(&#39;Prolog-Library-Collection&#39;).
 title(plGraphViz).
-version(&#39;0.0.17&#39;).
+version(&#39;0.0.1&#39;).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;163&#34;&gt; 163: 正在比较变动前 41914a2 和变动后 05a5fd2 &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
index d43346f..8730e13 100644
--- a/data/gv_attrs_scrape.pl
+++ b/data/gv_attrs_scrape.pl
@@ -30,7 +30,7 @@ gv_attr(
 :- use_module(library(http/http_download)).
 :- use_module(library(iostream)).
 :- use_module(library(lists)).
-:- use_module(library(pl/pl_term)).
+:- use_module(library(pl_term)).
 :- use_module(library(print_ext)).
 :- use_module(library(xpath)).
 :- use_module(library(xpath/xpath_table)).
diff --git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
index 5d220d9..7bfc290 100644
--- a/data/gv_color_scrape.pl
+++ b/data/gv_color_scrape.pl
@@ -15,7 +15,7 @@
 :- use_module(library(http/http_download)).
 :- use_module(library(iostream)).
 :- use_module(library(lists)).
-:- use_module(library(pl/pl_term)).
+:- use_module(library(pl_term)).
 :- use_module(library(print_ext)).
 :- use_module(library(xpath)).
 :- use_module(library(xpath/xpath_table)).
diff --git a/prolog/gv/gv_color.pl b/prolog/gv/gv_color.pl
index a63d9c4..ac319dc 100644
--- a/prolog/gv/gv_color.pl
+++ b/prolog/gv/gv_color.pl
@@ -34,12 +34,12 @@
 
 color(rgb(Red,Green,Blue)) --&amp;gt; !,
   &amp;quot;#&amp;quot;,
-  &#39;#&#39;(3, hex_color, [Red,Green,Blue]).
+  #(3, hex_color, [Red,Green,Blue]).
 color(rgbs(Red,Green,Blue,Alpha)) --&amp;gt; !,
   color(rgb(Red,Green,Blue)),
   hex_color(Alpha).
 color(hsv(Hue,Saturation,Value)) --&amp;gt; !,
-  &#39;#&#39;(3, hsv_color, [Hue,Saturation,Value]).
+  #(3, hsv_color, [Hue,Saturation,Value]).
 color(Name) --&amp;gt;
   {gv_color(_, Name)},
   atom(Name).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;164&#34;&gt; 164: 正在比较变动前 05a5fd2 和变动后 fd6c59b &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/prolog/fca/fca_viz.pl b/prolog/fca/fca_viz.pl
index 1392db9..083dbb2 100644
--- a/prolog/fca/fca_viz.pl
+++ b/prolog/fca/fca_viz.pl
@@ -15,7 +15,6 @@
 */
 
 :- use_module(library(aggregate)).
-:- use_module(library(dcg/dcg_collection)).
 :- use_module(library(dcg/dcg_ext)).
 :- use_module(library(dcg/dcg_pl)).
 :- use_module(library(fca/fca)).
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;165&#34;&gt; 165: 正在比较变动前 fd6c59b 和变动后 121e68f &lt;/h2&gt;
[back to content](#compare)
&lt;pre&gt;&lt;code class=&#34;language-diff&#34;&gt; 
diff --git a/data/gv_attrs_scrape.pl b/data/gv_attrs_scrape.pl
index 8730e13..bcc7654 100644
--- a/data/gv_attrs_scrape.pl
+++ b/data/gv_attrs_scrape.pl
@@ -1,7 +1,7 @@
 :- module(
   gv_attrs_scrape,
   [
-    gv_attrs_scrape/1 % +File:atom
+    gv_attrs_scrape/1 % +File
   ]
 ).
 
@@ -11,45 +11,41 @@ Writes compound terms of the following form to file:
 
 ```prolog
 gv_attr(
-  ?Name:atom,
+  ?Name,
   ?UsedBy:list(oneof([cluster,edge,graph,node,subgraph])),
   ?Types:list(atom),
   ?Default,
   ?Minimum,
-  ?Notes:atom
+  ?Notes
 ) is nondet.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/10
+@version 2015/10, 2016/07
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
:- use_module(library(dcg/dcg_ext)).
+:- use_module(library(debug)).
:- use_module(library(gv/gv_attr_type)).
:- use_module(library(http/http_download)).
-:- use_module(library(iostream)).
:- use_module(library(lists)).
+:- use_module(library(os/io)).
:- use_module(library(pl_term)).
:- use_module(library(print_ext)).
:- use_module(library(xpath)).
:- use_module(library(xpath/xpath_table)).
+:- use_module(library(yall)).&lt;/p&gt;
&lt;p&gt;-%! gv_attrs_scrape(+File:atom) is det.
+%! gv_attrs_scrape(+File) is det.&lt;/p&gt;
&lt;p&gt;gv_attrs_scrape(File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;setup_call_cleanup(&lt;/li&gt;
&lt;li&gt;open_any(File, write, Write, Close, []),&lt;/li&gt;
&lt;li&gt;verbose(&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; gv_attrs_download(Write),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; &amp;quot;Updating the GraphViz attributes table.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;close_any(Close)&lt;/li&gt;
&lt;li&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;debug(gv, &amp;ldquo;Updating the GraphViz attributes table.&amp;rdquo;, []),&lt;/li&gt;
&lt;li&gt;call_to_stream(File, [In,Meta,Meta]&amp;raquo;gv_attrs_download(In)).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;gv_attrs_download(Write):-
@@ -78,7 +74,7 @@ gv_attrs_iri(&amp;lsquo;&lt;a href=&#34;http://www.graphviz.org/doc/info/attrs.html%27%29&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.graphviz.org/doc/info/attrs.html&#39;)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;% HELPERS %&lt;/p&gt;
&lt;p&gt;-%! translate_default(+Default1:atom, -Default2:atom) is det.
+%! translate_default(+Default1, -Default2) is det.&lt;/p&gt;
&lt;p&gt;% The empty string is represented by the empty atom.
translate_default(&#39;&amp;quot;&amp;quot;&amp;rsquo;, &amp;lsquo;&#39;):- !.
diff &amp;ndash;git a/data/gv_color_scrape.pl b/data/gv_color_scrape.pl
index 7bfc290..102a02a 100644
&amp;mdash; a/data/gv_color_scrape.pl
+++ b/data/gv_color_scrape.pl
@@ -1,40 +1,36 @@
:- module(
gv_color_scrape,
[&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gv_color_scrape/1 % +File:atom&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;gv_color_scrape/1 % +File
]
).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/** &lt;module&gt; GraphViz: Scrape colors&lt;/p&gt;
&lt;p&gt;@author Wouter Beek
-@version 2015/10
+@version 2015/10, 2016/07
*/&lt;/p&gt;
&lt;p&gt;:- use_module(library(apply)).
+:- use_module(library(debug)).
:- use_module(library(http/http_download)).
-:- use_module(library(iostream)).
:- use_module(library(lists)).
+:- use_module(library(os/io)).
:- use_module(library(pl_term)).
:- use_module(library(print_ext)).
:- use_module(library(xpath)).
:- use_module(library(xpath/xpath_table)).
+:- use_module(library(yall)).&lt;/p&gt;
&lt;p&gt;-%! gv_color_scrape(+File:atom) is det.
+%! gv_color_scrape(+File) is det.&lt;/p&gt;
&lt;p&gt;gv_color_scrape(File):-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;setup_call_cleanup(&lt;/li&gt;
&lt;li&gt;open_any(File, write, Write, Close, []),&lt;/li&gt;
&lt;li&gt;verbose(&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; gv_color_download(Write),
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; &amp;quot;Updating the GraphViz color table.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;),&lt;/li&gt;
&lt;li&gt;close_any(Close)&lt;/li&gt;
&lt;li&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;debug(io, &amp;ldquo;Updating the GraphViz color table.&amp;rdquo;, []),&lt;/li&gt;
&lt;li&gt;call_to_stream(File, [In,Meta,Meta]&amp;raquo;gv_color_download(In)).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;gv_color_download(Write):-&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; 
总共进行了 166 次比较

&amp;lt;h2 id=&amp;quot;time&amp;quot;&amp;gt;3. 时间变化表&amp;lt;/h2&amp;gt;




[1. 6ced089      Sun Jun 1 16:12:35 2014 +0200       2 years, 4 months ago3d8b517      Sun Jun 1 16:16:39 2014 +0200       2 years, 4 months ago](#1)

[2. ccd942c      Sun Jun 1 18:20:43 2014 +0200       2 years, 4 months ago](#2)

[3. 0b3607d      Wed Jun 4 08:57:28 2014 +0200       2 years, 4 months ago](#3)

[4. acf4ec3      Thu Jun 5 08:38:17 2014 +0200       2 years, 4 months ago](#4)

[5. c1ad93f      Fri Jun 6 10:15:07 2014 +0200       2 years, 4 months ago](#5)

[6. c7c8226      Sat Jun 14 05:01:29 2014 +0200       2 years, 3 months ago](#6)

[7. 0cd29ea      Sat Jun 14 15:55:52 2014 +0200       2 years, 3 months ago](#7)

[8. 13f7fbf      Mon Jun 16 07:40:22 2014 +0200       2 years, 3 months ago](#8)

[9. 5520d75      Thu Jun 19 12:39:17 2014 +0200       2 years, 3 months ago](#9)

[10. 8656a39      Thu Jun 19 13:08:10 2014 +0200       2 years, 3 months ago](#10)

[11. 7421981      Tue Jul 8 13:55:06 2014 +0200       2 years, 2 months ago](#11)

[12. bfcb63b      Tue Jul 22 20:14:34 2014 +0200       2 years, 2 months ago](#12)

[13. 84afd69      Sun Jul 27 21:09:43 2014 +0200       2 years, 2 months ago](#13)

[14. c2bfd3f      Sun Jul 27 23:12:11 2014 +0200       2 years, 2 months ago](#14)

[15. fa364fc      Mon Jul 28 10:20:16 2014 +0200       2 years, 2 months ago](#15)

[16. 3c900f4      Mon Jul 28 19:41:10 2014 +0200       2 years, 2 months ago](#16)

[17. 65cc1c3      Mon Jul 28 20:45:42 2014 +0200       2 years, 2 months ago](#17)

[18. 20e1f21      Mon Jul 28 21:27:58 2014 +0200       2 years, 2 months ago](#18)

[19. e2e9fc1      Tue Jul 29 06:03:54 2014 +0200       2 years, 2 months ago](#19)

[20. 4b72d15      Thu Jul 31 17:43:40 2014 +0200       2 years, 2 months ago](#20)

[21. 54248f7      Thu Jul 31 23:50:20 2014 +0200       2 years, 2 months ago](#21)

[22. 3b9a773      Sun Aug 3 13:57:00 2014 +0200       2 years, 2 months ago](#22)

[23. 1e9a910      Sun Aug 3 18:45:43 2014 +0200       2 years, 2 months ago](#23)

[24. 6dc1cf5      Sun Aug 3 21:37:53 2014 +0200       2 years, 2 months ago](#24)

[25. 76ea35d      Wed Aug 6 12:57:55 2014 +0200       2 years, 2 months ago](#25)

[26. 2a2728b      Wed Aug 6 12:59:11 2014 +0200       2 years, 2 months ago](#26)

[27. 7f9fc82      Wed Aug 6 13:03:10 2014 +0200       2 years, 2 months ago](#27)

[28. 5baddb5      Wed Aug 6 15:58:46 2014 +0200       2 years, 2 months ago](#28)

[29. 95bfe7f      Fri Aug 15 19:38:14 2014 +0200       2 years, 1 month ago](#29)

[30. f1322fa      Tue Aug 19 09:37:49 2014 +0200       2 years, 1 month ago](#30)

[31. 474bea8      Tue Aug 19 09:41:38 2014 +0200       2 years, 1 month ago](#31)

[32. 262cb2a      Tue Aug 19 10:29:37 2014 +0200       2 years, 1 month ago](#32)

[33. e7e6033      Fri Aug 22 09:46:08 2014 +0200       2 years, 1 month ago](#33)

[34. e17bf44      Wed Aug 27 16:55:24 2014 +0200       2 years, 1 month ago](#34)

[35. 6596aa1      Fri Sep 12 12:28:26 2014 +0200       2 years ago](#35)

[36. 87e8982      Sat Sep 13 19:35:04 2014 +0200       2 years ago](#36)

[37. cb6aada      Tue Sep 16 13:16:25 2014 +0200       2 years ago](#37)

[38. 7c8125b      Fri Oct 17 01:53:51 2014 +0200       1 year, 11 months ago](#38)

[39. 6a38f95      Sun Oct 19 01:24:45 2014 +0200       1 year, 11 months ago](#39)

[40. ebb86cd      Fri Oct 31 21:02:15 2014 +0100       1 year, 11 months ago](#40)

[41. 1549e44      Sun Nov 2 02:14:33 2014 +0100       1 year, 11 months ago](#41)

[42. 61ddca2      Mon Nov 3 16:24:02 2014 +0100       1 year, 11 months ago](#42)

[43. 26f07e7      Mon Nov 3 16:24:09 2014 +0100       1 year, 11 months ago](#43)

[44. f78b4f8      Tue Nov 4 09:03:10 2014 +0100       1 year, 11 months ago](#44)

[45. 3109362      Tue Nov 11 11:48:43 2014 +0100       1 year, 10 months ago](#45)

[46. df0ab09      Tue Nov 11 11:48:51 2014 +0100       1 year, 10 months ago](#46)

[47. 73e976b      Tue Nov 11 12:03:09 2014 +0100       1 year, 10 months ago](#47)

[48. 090c25d      Tue Nov 11 21:33:59 2014 +0100       1 year, 10 months ago](#48)

[49. daed8bf      Thu Nov 13 16:58:28 2014 +0100       1 year, 10 months ago](#49)

[50. 528b9af      Thu Nov 13 20:06:16 2014 +0100       1 year, 10 months ago](#50)

[51. e594ae6      Fri Nov 14 06:30:50 2014 +0100       1 year, 10 months ago](#51)

[52. bbefbf7      Tue Nov 18 21:35:37 2014 +0100       1 year, 10 months ago](#52)

[53. 0cc5421      Wed Nov 19 07:34:19 2014 +0100       1 year, 10 months ago](#53)

[54. dbc602d      Wed Nov 19 07:36:24 2014 +0100       1 year, 10 months ago](#54)

[55. a2456df      Wed Nov 19 07:50:35 2014 +0100       1 year, 10 months ago](#55)

[56. 20c6017      Thu Nov 20 13:22:27 2014 +0100       1 year, 10 months ago](#56)

[57. f694d77      Fri Nov 21 17:40:21 2014 +0100       1 year, 10 months ago](#57)

[58. af5d96d      Tue Nov 25 18:19:59 2014 +0100       1 year, 10 months ago](#58)

[59. ab4b616      Tue Nov 25 18:30:40 2014 +0100       1 year, 10 months ago](#59)

[60. 74bd19d      Tue Nov 25 19:26:26 2014 +0100       1 year, 10 months ago](#60)

[61. 8ffff6f      Tue Nov 25 19:54:56 2014 +0100       1 year, 10 months ago](#61)

[62. ac3423a      Tue Nov 25 19:55:05 2014 +0100       1 year, 10 months ago](#62)

[63. 57932e4      Tue Nov 25 19:55:29 2014 +0100       1 year, 10 months ago](#63)

[64. 315b16e      Wed Nov 26 10:37:08 2014 +0100       1 year, 10 months ago](#64)

[65. 898b5d2      Thu Nov 27 19:38:08 2014 +0100       1 year, 10 months ago](#65)

[66. 4279a49      Fri Nov 28 08:09:47 2014 +0100       1 year, 10 months ago](#66)

[67. c173073      Sat Nov 29 09:16:14 2014 +0100       1 year, 10 months ago](#67)

[68. 107c515      Sat Nov 29 14:46:11 2014 +0100       1 year, 10 months ago](#68)

[69. 8f574bb      Tue Dec 2 21:15:18 2014 +0100       1 year, 10 months ago](#69)

[70. d7088dd      Thu Dec 11 09:40:51 2014 +0100       1 year, 9 months ago](#70)

[71. 94ed05d      Sun Dec 14 17:06:03 2014 +0100       1 year, 9 months ago](#71)

[72. f481060      Tue Dec 16 13:41:32 2014 +0100       1 year, 9 months ago](#72)

[73. ce492ef      Tue Dec 16 19:44:03 2014 +0100       1 year, 9 months ago](#73)

[74. ddef555      Wed Dec 17 12:02:35 2014 +0100       1 year, 9 months ago](#74)

[75. af27fdd      Thu Dec 18 18:21:38 2014 +0100       1 year, 9 months ago](#75)

[76. f390238      Fri Jan 23 12:55:56 2015 +0100       1 year, 8 months ago](#76)

[77. c5f7d82      Fri Jan 23 13:27:31 2015 +0100       1 year, 8 months ago](#77)

[78. acf6467      Sun Jan 25 16:18:18 2015 +0100       1 year, 8 months ago](#78)

[79. 6656a2d      Sat Jan 31 15:45:06 2015 +0100       1 year, 8 months ago](#79)

[80. 256c9ce      Thu Feb 26 13:08:27 2015 +0100       1 year, 7 months ago](#80)

[81. bf4ebea      Thu Feb 26 13:13:50 2015 +0100       1 year, 7 months ago](#81)

[82. 70aec99      Sat Mar 7 08:53:44 2015 +0100       1 year, 7 months ago](#82)

[83. e06e6ba      Sat Mar 7 08:54:13 2015 +0100       1 year, 7 months ago](#83)

[84. 0fd12ca      Sat Mar 7 08:54:32 2015 +0100       1 year, 7 months ago](#84)

[85. 67c4157      Sat Mar 7 08:59:37 2015 +0100       1 year, 7 months ago](#85)

[86. b972e2b      Sun Mar 8 11:20:27 2015 +0100       1 year, 6 months ago](#86)

[87. 8bbc84c      Sat Mar 21 08:41:10 2015 +0100       1 year, 6 months ago](#87)

[88. 033fa14      Wed Mar 25 07:15:07 2015 +0100       1 year, 6 months ago](#88)

[89. fdb5a9e      Wed Apr 1 12:20:17 2015 +0200       1 year, 6 months ago](#89)

[90. 6ec582e      Thu Apr 2 01:08:43 2015 +0200       1 year, 6 months ago](#90)

[91. 68b53b8      Tue Apr 7 11:12:17 2015 +0200       1 year, 6 months ago](#91)

[92. 46e8f3c      Sat May 9 19:05:41 2015 +0200       1 year, 4 months ago](#92)

[93. 3162d88      Sun May 10 13:39:33 2015 +0200       1 year, 4 months ago](#93)

[94. 714b2e0      Wed May 27 14:23:39 2015 +0200       1 year, 4 months ago](#94)

[95. af7a387      Wed Jun 3 16:54:25 2015 +0200       1 year, 4 months ago](#95)

[96. 7b434e3      Wed Jun 10 10:08:40 2015 +0200       1 year, 3 months ago](#96)

[97. dcbcb4d      Thu Jul 16 16:17:22 2015 +0200       1 year, 2 months ago](#97)

[98. 50a3dbc      Fri Jul 17 00:31:37 2015 +0200       1 year, 2 months ago](#98)

[99. a97e8e1      Fri Jul 17 16:56:02 2015 +0200       1 year, 2 months ago](#99)

[100. 9513a9b      Sat Jul 18 23:46:30 2015 +0200       1 year, 2 months ago](#100)

[101. 7163f60      Sat Jul 18 23:55:52 2015 +0200       1 year, 2 months ago](#101)

[102. b2f4aef      Sat Jul 18 23:56:17 2015 +0200       1 year, 2 months ago](#102)

[103. ba30c25      Sun Jul 19 00:07:47 2015 +0200       1 year, 2 months ago](#103)

[104. 0eea41b      Sun Jul 19 00:16:37 2015 +0200       1 year, 2 months ago](#104)

[105. c1691bd      Mon Jul 20 17:00:42 2015 +0200       1 year, 2 months ago](#105)

[106. 3de9fc2      Mon Jul 20 18:25:07 2015 +0200       1 year, 2 months ago](#106)

[107. cb34d89      Mon Jul 20 22:42:07 2015 +0200       1 year, 2 months ago](#107)

[108. 7f0e20f      Mon Jul 20 22:59:24 2015 +0200       1 year, 2 months ago](#108)

[109. c16a7a7      Mon Jul 20 23:04:42 2015 +0200       1 year, 2 months ago](#109)

[110. 8bbb08c      Mon Jul 20 23:17:33 2015 +0200       1 year, 2 months ago](#110)

[111. 34c8b1a      Mon Aug 3 15:44:26 2015 +0200       1 year, 2 months ago](#111)

[112. d883d06      Mon Aug 3 16:16:42 2015 +0200       1 year, 2 months ago](#112)

[113. 66ac0a0      Mon Aug 3 16:33:28 2015 +0200       1 year, 2 months ago](#113)

[114. ab5a102      Mon Aug 3 16:40:48 2015 +0200       1 year, 2 months ago](#114)

[115. 65f43b8      Mon Aug 3 23:15:08 2015 +0200       1 year, 2 months ago](#115)

[116. c6de3d1      Tue Aug 4 22:58:51 2015 +0200       1 year, 2 months ago](#116)

[117. cab2231      Tue Aug 4 22:59:42 2015 +0200       1 year, 2 months ago](#117)

[118. 008c5e6      Thu Aug 6 10:21:06 2015 +0200       1 year, 2 months ago](#118)

[119. dba5c72      Thu Aug 6 10:22:03 2015 +0200       1 year, 2 months ago](#119)

[120. eff64ee      Thu Aug 6 10:22:14 2015 +0200       1 year, 2 months ago](#120)

[121. 89eb423      Mon Aug 17 16:44:01 2015 +0200       1 year, 1 month ago](#121)

[122. 2346997      Tue Aug 18 20:51:29 2015 +0200       1 year, 1 month ago](#122)

[123. d22d50e      Tue Sep 8 11:41:49 2015 +0200       1 year ago](#123)

[124. e64cc35      Wed Sep 23 21:43:10 2015 +0200       12 months ago](#124)

[125. 763a529      Tue Oct 13 23:03:01 2015 +0200       11 months ago](#125)

[126. d962f81      Tue Oct 13 23:03:13 2015 +0200       11 months ago](#126)

[127. 63a5cd7      Tue Oct 13 23:03:37 2015 +0200       11 months ago](#127)

[128. ce95c3c      Sat Oct 17 00:38:49 2015 +0200       11 months ago](#128)

[129. 44cd5a6      Fri Oct 23 16:09:04 2015 +0200       11 months ago](#129)

[130. c0c5e18      Fri Oct 30 17:02:09 2015 +0100       11 months ago](#130)

[131. 603344f      Fri Oct 30 21:35:33 2015 +0100       11 months ago](#131)

[132. 2679253      Wed Nov 4 20:52:30 2015 +0100       11 months ago](#132)

[133. a5e20f8      Wed Nov 4 21:59:20 2015 +0100       11 months ago](#133)

[134. bc3c502      Wed Nov 4 22:19:15 2015 +0100       11 months ago](#134)

[135. 7ec98aa      Wed Nov 4 23:36:40 2015 +0100       11 months ago](#135)

[136. 984d3b9      Thu Nov 5 08:27:05 2015 +0100       11 months ago](#136)

[137. 4401e20      Thu Nov 5 11:01:08 2015 +0100       11 months ago](#137)

[138. 2247466      Thu Nov 5 18:03:51 2015 +0100       11 months ago](#138)

[139. f4a9322      Sun Nov 15 23:56:27 2015 +0100       10 months ago](#139)

[140. 0d2712a      Sun Nov 22 09:56:29 2015 +0100       10 months ago](#140)

[141. 3518985      Sun Dec 6 12:45:05 2015 +0100       10 months ago](#141)

[142. 322ca62      Fri Dec 11 10:48:06 2015 +0100       10 months ago](#142)

[143. c4bf9ea      Fri Dec 11 23:00:58 2015 +0100       9 months ago](#143)

[144. 2a6dafd      Fri Dec 11 23:02:28 2015 +0100       9 months ago](#144)

[145. 145615e      Sat Dec 12 13:28:11 2015 +0100       9 months ago](#145)

[146. f16acca      Sun Dec 13 00:31:18 2015 +0100       9 months ago](#146)

[147. 4e2d9f1      Sun Dec 13 11:53:34 2015 +0100       9 months ago](#147)

[148. 6359c9c      Mon Dec 21 00:18:29 2015 +0100       9 months ago](#148)

[149. 00537d0      Mon Jan 4 18:45:14 2016 +0100       9 months ago](#149)

[150. acadc39      Mon Jan 4 19:04:12 2016 +0100       9 months ago](#150)

[151. 51359c6      Tue Jan 5 00:14:06 2016 +0100       9 months ago](#151)

[152. 73047b3      Fri Feb 5 10:25:43 2016 +0100       8 months ago](#152)

[153. e4c4586      Fri Feb 12 00:46:53 2016 +0100       7 months ago](#153)

[154. 7b991bb      Thu Feb 25 19:26:04 2016 +0000       7 months ago](#154)

[155. fa1518f      Tue Mar 1 21:13:23 2016 +0100       7 months ago](#155)

[156. 8593ed6      Wed Mar 2 21:05:20 2016 +0000       7 months ago](#156)

[157. cc53b1e      Wed Mar 2 21:07:13 2016 +0000       7 months ago](#157)

[158. 202a241      Sat Mar 5 21:45:52 2016 +0100       7 months ago](#158)

[159. 858b5fb      Sun Mar 20 09:13:59 2016 +0100       6 months ago](#159)

[160. 260b62d      Sun Mar 20 10:38:39 2016 +0100       6 months ago](#160)

[161. a6886ca      Sat Apr 2 10:22:32 2016 +0200       6 months ago](#161)

[162. 41914a2      Tue May 3 20:54:24 2016 +0200       5 months ago](#162)

[163. 05a5fd2      Tue Jun 21 08:36:10 2016 +0200       3 months ago](#163)

[164. fd6c59b      Wed Jul 13 00:04:57 2016 +0200       2 months ago](#164)

[165. 121e68f      Fri Jul 22 20:39:31 2016 +0200       9 weeks ago](#165)


&amp;lt;h2 id=&amp;quot;short&amp;quot;&amp;gt;4. 列出简要信息&amp;lt;/h2&amp;gt;

``` vim
 
 13 files changed, 1618 insertions(+)
 load_project.pl           | 102 ++++++++++
 load.pl                   |  12 ++
 index.pl                  |   2 +
 gv_numeral.pl             |  71 +++++++
 gv_html.pl                |  60 ++++++
 gv_file.pl                | 250 +++++++++++++++++++++++
 gv_dot.pl                 | 496 ++++++++++++++++++++++++++++++++++++++++++++++
 gv_color.pl               |  96 +++++++++
 gv_attrs.pl               | 109 ++++++++++
 gv_attr_type.pl           | 415 ++++++++++++++++++++++++++++++++++++++
 Prolog-Library-Collection |   1 +
 .gitmodules               |   3 +
 .gitignore                |   1 +

    Initial commit.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#1&#34;&gt;1. commit 6ced089ad776b55034adbd4a806db296bcb1229c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 5 insertions(+), 1 deletion(-)
 plHtml                    | 1 +
 Prolog-Library-Collection | 2 +-
 .gitmodules               | 3 +++

    Upped PLC,plHtml.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#2&#34;&gt;2. commit 3d8b517ba04a977e793d64d240cc8169fec42606&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 plHtml                    | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped PLC,plHtml

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#3&#34;&gt;3. commit ccd942cd22b0bacee488b08a1756227759fa125d&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 3 insertions(+), 3 deletions(-)
 gv_color.pl     | 2 +-
 gv_attrs.pl     | 2 +-
 gv_attr_type.pl | 2 +-

    * [GV_ATTRS,GV_COLOR,DEB] Summarize messages for downloading HTML.
    * [GV_ATTR_TYPE,FIX] Wrong module name.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#4&#34;&gt;4. commit 0b3607d3305882967ec58a223d0dffb6a56d1b75&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 142 insertions(+), 16 deletions(-)
 gv_color.pl | 61 ++++++++++++++++++++++++++++++++++----
 gv_attrs.pl | 97 ++++++++++++++++++++++++++++++++++++++++++++++++++++++-------

    * [GV_ATTRS,GV_COLOR,NEW] Added persistency, so GraphViz settings are (re)download only when the locally stored data dump is not fresh anymore.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#5&#34;&gt;5. commit acf4ec31ef12d0de84f0496e621a90dcec5ae55c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 gv_color.pl | 2 +-
 gv_attrs.pl | 2 +-

    Freshness lifetime from 1H to 100D :-P

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#6&#34;&gt;6. commit c1ad93f719fe68580e65e748e8c45a43ad1649a9&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 plHtml                    | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped submodules

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#7&#34;&gt;7. commit c7c8226840bb23fa5bb0ae2e4f8371364d3f49fa&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 29 insertions(+), 11 deletions(-)
 load_project.pl | 34 ++++++++++++++++++++++++++--------
 load.pl         |  6 +++---

    * [DEP] Alterations to startup procedure.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#8&#34;&gt;8. commit 0cd29ea088b348bcb5c8162352c4ead1b3340568&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 plHtml                    | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped submodules

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#9&#34;&gt;9. commit 13f7fbf9548fb66541f600b9b728bde73fb9830e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 6 files changed, 169 insertions(+), 45 deletions(-)
 gv_tree.pl      |  39 ++++++++++++++++++++
 gv_gif.pl       | 109 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 gv_file.pl      |  40 +++------------------
 gv_color.pl     |  10 ++++--
 gv_attrs.pl     |   2 +-
 gv_attr_type.pl |  14 ++++----

    * [GV_GIF,NEW] New module supporting the construction of GIF representations.
    * [GV_TREE,SC] Separate module for GV export of trees.
    * [GV_COLOR,FIX] Add support for GV color names.
    * [GV_ATTR_TYPE,NEW] Added string//1.
    * [GV_ATTRS,FIX] Parsing can be det here.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#10&#34;&gt;10. commit 5520d7540db4ab0936ef3f65ccc36f2305235bf0&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_attr_type.pl | 2 +-

    * [GV_ATTR_TYPE,DOC] Fixed typo.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#11&#34;&gt;11. commit 8656a39b30e28c3d00365c88a8e7ab1620bccce5&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 78 insertions(+), 83 deletions(-)
 gv_tree.pl |  16 ++++---
 gv_file.pl | 145 +++++++++++++++++++++++++++++--------------------------------

    * [GV_FILE,SC] Added predicate options declarations.
    * [GV_FILE,EXT] Add file type support for exporting to plain DOT.
    * [GV_FILE,SC] Move options argument to the last position.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#12&#34;&gt;12. commit 74219816f9f78f463cab91c4caba175ba66d4ff8&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 6 insertions(+), 6 deletions(-)
 gv_file.pl | 12 ++++++------

    * [GV_FILE,SC] Renamed predicate.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#13&#34;&gt;13. commit bfcb63b1206edd43cd6bb8d05d2884e2e49a463a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 77 insertions(+), 68 deletions(-)
 gv_file.pl | 145 ++++++++++++++++++++++++++++++++-----------------------------

    * [GV_FILE,FIX] Fix and cleanup for compiling GraphViz files.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#14&#34;&gt;14. commit 84afd69f990121eb49b2a4de4562ef080b846aca&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 54 insertions(+), 43 deletions(-)
 gv_gif.pl | 97 +++++++++++++++++++++++++++++++++++----------------------------

    * [GV_GIF,SC] Thorough cleanup of this module. We intend to extend its functionality with various optional predicates for assigning vertex, edges, and graph properties.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#15&#34;&gt;15. commit c2bfd3fc20c95592d66362ac67aa70fabeb078af&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 150 insertions(+), 39 deletions(-)
 gv_gif.pl | 145 ++++++++++++++++++++++++++++++++++++++++++++++++++++++--------
 gv_dot.pl |  44 +++++++++----------

    * [GV_GIF,EXT] Added several options for setting vertex, edges, and graph properties.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#16&#34;&gt;16. commit fa364fcd664277967e3fda7cb9db94bf5fc01fed&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 5 insertions(+), 19 deletions(-)
 gv_gif.pl | 24 +++++-------------------

    minor

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#17&#34;&gt;17. commit 3c900f481412a5425124ee4e9b345b2d0fd51f50&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 insertions(+)
 gv_gif.pl | 4 ++++

    * [GV_GIF,FIX] Added missing predication options declarations.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#18&#34;&gt;18. commit 65cc1c3c03f790ca21e3b23424f467e258b9080a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 16 insertions(+), 23 deletions(-)
 gv_gif.pl  | 18 +++++++++---------
 gv_file.pl | 21 +++++++--------------

    Various small fixes.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#19&#34;&gt;19. commit 20e1f2146881894d53c471f40ba74bf7fb99a21d&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 insertions(+), 5 deletions(-)
 gv_file.pl | 7 ++-----

    * [GV_FILE,FIX] When not given an output file, create one based on the input file.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#20&#34;&gt;20. commit e2e9fc1e79108306bb284a2b7adc5760dfeb2087&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 1 insertion(+), 5 deletions(-)
 gv_gif.pl  | 2 +-
 gv_file.pl | 4 ----

    * [SC] Minor.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#21&#34;&gt;21. commit 4b72d15e5999528c55d08ce04bd65622f328ec67&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_gif.pl | 2 +-

    * [SC] Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#22&#34;&gt;22. commit 54248f7423f80e8d756ce659667e218fba14b22c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_gif.pl | 2 +-

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#23&#34;&gt;23. commit 3b9a7736d901f1382bbe83b9cb2304c6e6fc698a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 insertions(+), 2 deletions(-)
 gv_gif.pl | 4 ++--

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#24&#34;&gt;24. commit 1e9a91074ca1d64a6b07bb7197f41c88146c3aca&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 3 insertions(+), 3 deletions(-)
 gv_gif.pl | 6 +++---

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#25&#34;&gt;25. commit 6dc1cf5ff51ce47e0917042dd8ba9c88750cc8fa&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 109 deletions(-)
 gv_gif.pl | 109 --------------------------------------------------------------

    Moved GV_GIF to plGraph.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#26&#34;&gt;26. commit 76ea35d03b83f0221658bb29491c90cf137fd377&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    merge

Merge: 76ea35d 6dc1cf5
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#27&#34;&gt;27. commit 2a2728b1d1699995d677889a6d958f1c4da87403&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 223 deletions(-)
 gv_tree.pl |   4 +-
 gv_gif.pl  | 221 -------------------------------------------------------------

    Removed gv_gif.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#28&#34;&gt;28. commit 7f9fc826a469a17a3cb10db847e4e4836aad35b2&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 16 insertions(+), 17 deletions(-)
 gv_file.pl |  3 +--
 gv_dot.pl  | 30 +++++++++++++++---------------

    minor

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#29&#34;&gt;29. commit 5baddb53811463c2e0b21abf2fd8ff8a85f0206c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 22 insertions(+), 10 deletions(-)
 gv_file.pl | 12 +++++-------
 gv_dot.pl  | 20 +++++++++++++++++---

    * [GV_FILE,FIX] Sometimes an output file need not be specified and is created on the fly.
    * [GV_DOT,FIX] In DOT files, no newline has to occur after global attribute assertions that are not followed by specific content (i.e., nodes and edges).

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#30&#34;&gt;30. commit 95bfe7fb78f8b4c24337d13dde25fe6df8197469&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 plHtml                    | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#31&#34;&gt;31. commit f1322fad81caf9df086379e668520294ba9d7935&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 deletions(-)
 index.pl | 2 --

    Removed index.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#32&#34;&gt;32. commit 474bea8afd0c1a1837b296832e5ffa988df4551b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 43 deletions(-)
 gv_tree.pl | 43 -------------------------------------------

    * [SC] Relocated GV_TREE to plTree.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#33&#34;&gt;33. commit 262cb2aa4ed4ed2f68100c3727f041a4cf82f8d0&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 6 files changed, 59 insertions(+), 51 deletions(-)
 gv_numeral.pl   |  7 ++++---
 gv_html.pl      |  2 +-
 gv_dot.pl       | 61 ++++++++++++++++++++++++++++++---------------------------
 gv_color.pl     | 21 +++++++++++---------
 gv_attrs.pl     |  5 +++--
 gv_attr_type.pl | 14 ++++++-------

    * [SC] Sync to plDcg,DCG_ABNF.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#34&#34;&gt;34. commit e7e6033f6d88356193053d724b37550d441f4642&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    Merge branch &#39;master&#39; of https://github.com/wouterbeek/plGraphViz

Merge: 2a2728b e7e6033
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#35&#34;&gt;35. commit e17bf44417fb2060c7648d47c24af161a3849199&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 deletion(-)
 gv_file.pl | 1 -

    * [SC] Module input cleanup.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#36&#34;&gt;36. commit 6596aa127934e47c89e39c7ad091be6da5fbefd0&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 plHtml                    | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#37&#34;&gt;37. commit 87e8982ea1c86d70490d7eb713f01f024118035e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 gv_dot.pl   | 2 +-
 gv_attrs.pl | 2 +-

    Sync to plDcg.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#38&#34;&gt;38. commit cb6aada737c0d58746811205cc753a53b7dc2301&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 9 insertions(+), 13 deletions(-)
 gv_file.pl  | 18 ++++++++----------
 gv_color.pl |  4 +---

    WINDOWS-SPECIFIC HACK TO RUN DOT!

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#39&#34;&gt;39. commit 7c8125b1c80c092487f760dabd464b4a3a366414&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 3 insertions(+), 2 deletions(-)
 gv_file.pl | 5 +++--

    FIXED: Reverted Windows-specific hack.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#40&#34;&gt;40. commit 6a38f954ddaff61cbda0e191ceb514a84155ab3a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 10 files changed, 98 insertions(+), 17 deletions(-)
 run.pl                    |  9 ++++++++
 plHtml                    |  2 +-
 plDcg                     |  1 +
 load_project.pl           | 22 ++++++++++---------
 load.pl                   | 11 +++++-----
 debug_project.pl          | 55 +++++++++++++++++++++++++++++++++++++++++++++++
 debug.pl                  |  7 ++++++
 Prolog-Library-Collection |  2 +-
 .gitmodules               |  3 +++
 .gitignore                |  3 +++

    DEPLOYMENT: Updated to modern startup architecture.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#41&#34;&gt;41. commit ebb86cdfd67c1bc273905eb28be11d152520110e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 255 insertions(+), 91 deletions(-)
 gv_html.pl | 249 ++++++++++++++++++++++++++++++++++++++++++++++++++-----------
 gv_dot.pl  |  97 ++++++++++++------------

    ADDED: Rewrote the HTML-like labels grammar for GraphViz.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#42&#34;&gt;42. commit 1549e4403d3f7e1b9896964adcfe0d0ec41dc72f&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 16 insertions(+), 4 deletions(-)
 plHtml                    |  2 +-
 plDcg                     |  2 +-
 debug_project.pl          | 14 +++++++++++++-
 Prolog-Library-Collection |  2 +-

    Upped submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#43&#34;&gt;43. commit 61ddca2f413b7a5de86faf85cb8e3c2e189c2b42&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    Merge branch &#39;master&#39; of https://github.com/wouterbeek/plGraphViz

Merge: 61ddca2 1549e44
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#44&#34;&gt;44. commit 26f07e7108914550f16186bbba55a4260eae44ff&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 49 insertions(+), 31 deletions(-)
 plDcg                     |  2 +-
 gv_attrs.pl               | 40 +++++++++++++++++++++++++++++-----------
 gv_attr_type.pl           | 36 ++++++++++++++++++------------------
 Prolog-Library-Collection |  2 +-

    DOCUMENTATION: Added for GraphViz attributes processing.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#45&#34;&gt;45. commit f78b4f859295fd561bef8b168034b563e6203300&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_file.pl | 2 +-

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#46&#34;&gt;46. commit 310936292c5fbbce7260ebe51380f829990dcc97&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
     Merge branch &#39;temp&#39;

Merge: f78b4f8 3109362
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#47&#34;&gt;47. commit df0ab09e882cc7b9ddc1d3fb12ef92612b9826ab&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 11 files changed, 25 insertions(+), 8 deletions(-)
 plUri                     | 1 +
 plSvg                     | 1 +
 plHttp                    | 1 +
 plHtml                    | 2 +-
 plDcg                     | 2 +-
 load.pl                   | 9 ++++++---
 gv_dot.pl                 | 2 +-
 gv_color.pl               | 3 ++-
 gv_attrs.pl               | 1 +
 Prolog-Library-Collection | 2 +-
 .gitmodules               | 9 +++++++++

    DEPLOYMENT: Added plHttp, plSvg, plUri.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#48&#34;&gt;48. commit 73e976b27beeda081abfa60931b7d85bea79ab96&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 5 files changed, 5 insertions(+), 5 deletions(-)
 plUri                     | 2 +-
 plHttp                    | 2 +-
 plHtml                    | 2 +-
 plDcg                     | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#49&#34;&gt;49. commit 090c25dfb4bdd81e95818c65bc8a3b39bc5566d8&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 8 files changed, 7 insertions(+), 16 deletions(-)
 plUri                     | 1 -
 plSvg                     | 1 -
 plHttp                    | 1 -
 plHtml                    | 2 +-
 plDcg                     | 2 +-
 load_project.pl           | 5 ++++-
 Prolog-Library-Collection | 2 +-
 .gitmodules               | 9 ---------

    DEPLOYMENT: Removed several submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#50&#34;&gt;50. commit daed8bfe18cb686c77eb0c0fd2a1ae7443992204&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 13 files changed, 125 insertions(+), 124 deletions(-)
 plUri                     |   1 +
 plHtml                    |   2 +-
 plDcg                     |   2 +-
 load.pl                   |   2 -
 gv_numeral.pl             | 100 +++++++++++++++++++++++++---------------------
 gv_html.pl                |  75 +++++++++++++++++-----------------
 gv_file.pl                |  18 ---------
 gv_dot.pl                 |  39 ++++++++++--------
 gv_color.pl               |   1 +
 gv_attrs.pl               |   3 +-
 gv_attr_type.pl           |   1 +
 Prolog-Library-Collection |   2 +-
 .gitmodules               |   3 ++

    6. DEPLOYMENT: Added plUri.
    5. Sync to submodules.
    4. CLEANUP: Spacing in GraphViz HTML-like label syntax.
    3. CLEANUP: Markdown code block markup.
    2. CLEANUP: Rewrote part of the GraphViz numeral grammar to be easier to process.
    1. DOC: Added documentation for GraphViz numeral grammar.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#51&#34;&gt;51. commit 528b9af184c39b53f8f5c6bc383a993f1400a71e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 insertions(+), 4 deletions(-)
 gv_color.pl | 8 ++++----

    minor

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#52&#34;&gt;52. commit e594ae6c5b4c633db0fef804161071337af3a78d&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_color.pl | 2 +-

    minor

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#53&#34;&gt;53. commit bbefbf7ce3c322755ce29a18c4cf1c0dd15ef57e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 5 files changed, 98 insertions(+), 20 deletions(-)
 load_project.pl  | 25 ++++++++++++---------
 gv_color.pl      | 10 ---------
 debug_project.pl | 66 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 debug.pl         |  9 ++++++++
 README.md        |  8 +++++++

    Updated load procedure.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#54&#34;&gt;54. commit 0cc5421aa59c8eac6e8fed89327f2b27bdbf43d2&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
            debug_project.pl
            debug.pl
    Conflicts:
    
    Merge branch &#39;master&#39; of https://github.com/wouterbeek/plGraphViz

Merge: 0cc5421 bbefbf7
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#55&#34;&gt;55. commit dbc602d82db54d2b604b86dde60b835b81021d0b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 3 insertions(+), 4 deletions(-)
 plHtml      | 2 +-
 gv_color.pl | 5 ++---

    CLEANUP: GraphViz color persistent store now reuses PLC support module.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#56&#34;&gt;56. commit a2456df77c592e7303311540f9578c5c401a9cda&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_numeral.pl | 2 +-

    FIXED: Do not write the plus sign for positive integer GraphViz numberals.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#57&#34;&gt;57. commit 20c60172730ce564528fad1ae6a43b6fdde21dac&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 3 insertions(+), 3 deletions(-)
 plUri                     | 2 +-
 plDcg                     | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#58&#34;&gt;58. commit f694d776f9e329832a492602cf5161019d293f89&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 12 files changed, 545 insertions(+), 263 deletions(-)
 plUri                     |   2 +-
 plHtml                    |   2 +-
 plDcg                     |   2 +-
 gv_html.pl                | 221 ++++++++++++++++++++++++++++------------------
 gv_file.pl                | 202 +++++++++++++++++++++++++-----------------
 gv_dot.pl                 | 129 +++++++++++++++------------
 gv_attrs.pl               |  63 +++++++------
 gv_attr_type.pl           |  76 +++++++++++++---
 example2.png              | Bin 0 -&amp;gt; 8121 bytes
 example1.png              | Bin 0 -&amp;gt; 4166 bytes
 README.md                 | 109 ++++++++++++++++++++++-
 Prolog-Library-Collection |   2 +-

    6. FIXED: Various fixes while using HTML-like labels for the first time.
    5. CLEANUP: Simplified method and output options.
    4. ENHANCED: Added support for many more method and output values.
    3. CLEANUP: Simplified attribute value generation: write directly i.o. first typechecking.
    2. FIXED: Quote escString. Not clear from GV grammar.
    1. DOC: Added documentation on top-level use.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#59&#34;&gt;59. commit af5d96dfda6172b8a13f3030d810bd2709031111&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 38 insertions(+), 4 deletions(-)
 README.md | 42 ++++++++++++++++++++++++++++++++++++++----

    DOC: Added documentation.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#60&#34;&gt;60. commit ab4b616bb9e2251a496c37afd0a7e56937b944b9&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 3 insertions(+), 3 deletions(-)
 gv_dot.pl       | 4 ++--
 gv_attr_type.pl | 2 +-

    FIXED: GraphViz strings surrounded must be enclosed by double quotes.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#61&#34;&gt;61. commit 74bd19d68c153b8ca75d5926b2a2131f7bb844d0&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 8 insertions(+)
 README.md | 8 ++++++++

    DOC: Added installation.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#62&#34;&gt;62. commit 8ffff6f0c98e4207c773ad995563f6a8433e3f73&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    Merge branch &#39;master&#39; of https://github.com/wouterbeek/plGraphViz

Merge: 8ffff6f 74bd19d
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#63&#34;&gt;63. commit ac3423a3430ed91079209d895191cb911609cdc3&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 Prolog-Library-Collection | 2 +-

    Upped submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#64&#34;&gt;64. commit 57932e48a824da4670dbaf89d8f8a2e238954b50&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_file.pl | 2 +-

    rename

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#65&#34;&gt;65. commit 315b16ed91a4138cbfe7c79aad89dad7e48f1870&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 deletions(-)
 gv_file.pl | 4 ----

    CLEANUP: Removed redundant declaration and module import.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#66&#34;&gt;66. commit 898b5d2ccb3dc13754a1de853bd62e3dda1ef6e9&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 19 insertions(+), 11 deletions(-)
 gv_file.pl | 30 +++++++++++++++++++-----------

    CLEANUP: Renamed gif-&amp;gt;export_graph.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#67&#34;&gt;67. commit 4279a49aa9e92a73f702edd0c2b6c90131a50556&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 10 insertions(+), 10 deletions(-)
 gv_html.pl | 16 ++++++++--------
 gv_dot.pl  |  4 ++--

    CEANUP: Use Markdown notation.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#68&#34;&gt;68. commit c173073758805b29105db834aa14c51fea65156c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 gv_color.pl | 2 +-
 gv_attrs.pl | 2 +-

    Syc to plHtml.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#69&#34;&gt;69. commit 107c515057dc9ef9d4b2fe7b6ed12923b7826eae&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 insertions(+), 4 deletions(-)
 gv_attrs.pl | 8 ++++----

    minor

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#70&#34;&gt;70. commit 8f574bb2cbf341b17734a8269a329276148221e7&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 insertions(+), 2 deletions(-)
 gv_dot.pl | 4 ++--

    Sync to plDcg.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#71&#34;&gt;71. commit d7088dd180fdf3295f14e65c614f2e643235cdc2&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 insertions(+), 2 deletions(-)
 README.md | 4 ++--

    DOC: Sync to self.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#72&#34;&gt;72. commit 94ed05d9e4a46ca4b111e0312a31b1423c84495e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+)
 gv_file.pl | 1 +

    deb

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#73&#34;&gt;73. commit f48106006fc0ea042800de086191c56ea939d324&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 29 insertions(+), 53 deletions(-)
 gv_file.pl      |  8 +++----
 gv_dot.pl       | 65 +++++++++++++++++----------------------------------------
 gv_attr_type.pl |  9 ++++++--

    4. FIXED: Added PDF file type registration.
    3. FIXED: Removed the requirement of a given GraphViz output file having a file extension that matches its media type.
    2. FIXED: Double quoted string support for GraphViz was broken.
    1. FIXED: Dobule quotes are now auto-escaped in GraphViz escStrings.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#74&#34;&gt;74. commit ce492efd1bb82bdbb7611d52ae3d1092b9cdcf8b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 1 insertion(+), 3 deletions(-)
 gv_html.pl      | 2 --
 gv_attr_type.pl | 2 +-

    2. FIXED: Use of HTML-like labels revealed typo.
    1. FIXED: Removed ambiguity for linebreak specification in GraphViz HTML-like labels.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#75&#34;&gt;75. commit ddef555cdb626a0ab6afc9e3d727cb4149ba6ed0&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 gv_dot.pl   | 2 +-
 gv_color.pl | 2 +-

    minor

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#76&#34;&gt;76. commit af27fdd8f2f08169cb445a48002894f088e4fa93&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 43 insertions(+), 41 deletions(-)
 gv_numeral.pl   | 67 ++++++++++++++++++++++++++++++---------------------------
 gv_attr_type.pl | 17 +++++++--------

    ENHANCED: Rewrite of GraphViz numerals.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#77&#34;&gt;77. commit f390238d2ec4965ca62f09850307fdc438e43ffb&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 insertions(+), 1 deletion(-)
 gv_numeral.pl | 5 ++++-

    Sync to plDcg.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#78&#34;&gt;78. commit c5f7d822cbc6ba77814581c071fb8f74130979af&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 5 insertions(+), 2 deletions(-)
 gv_numeral.pl   | 2 +-
 gv_color.pl     | 3 ++-
 gv_attr_type.pl | 2 ++

    FIXED: Missing module imports.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#79&#34;&gt;79. commit acf64671787994db76761c96da10a3eca42f0d65&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 4 insertions(+), 3 deletions(-)
 gv_numeral.pl   | 2 ++
 gv_attr_type.pl | 5 ++---

    FIXED: Use float// i.o. detailed double implementation (scientific notation issue).

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#80&#34;&gt;80. commit 6656a2d769a8e2e7ec1a38a4f58fb6be58bdf735&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 4 insertions(+), 4 deletions(-)
 plUri                     | 2 +-
 plHtml                    | 2 +-
 plDcg                     | 2 +-
 Prolog-Library-Collection | 2 +-

    Upped submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#81&#34;&gt;81. commit 256c9cec27b53f609ad80ab8f66cb0d0cb6b6530&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 11 files changed, 111 insertions(+), 73 deletions(-)
 plDcg            |  1 -
 load.pl          |  1 -
 gv_numeral.pl    | 15 +++++++--------
 gv_html.pl       |  6 +++---
 gv_file.pl       | 24 ++++++++++++------------
 gv_dot.pl        | 18 +++++++++---------
 gv_color.pl      | 27 +++++++++++++++------------
 gv_attrs.pl      | 23 ++++++++++++-----------
 gv_attr_type.pl  | 16 ++++++++--------
 debug_project.pl | 50 +++++++++++++++++++++++++++++++++++++++++++++-----
 .gitmodules      |  3 ---

    Sync to submodules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#82&#34;&gt;82. commit bf4ebead2a5fb2bb5772632676e636c756b256b5&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 6 files changed, 53 insertions(+), 18 deletions(-)
 plUri                     |  2 +-
 plHtml                    |  2 +-
 plDcg                     |  2 +-
 gv_attrs.pl               | 13 ++++--------
 debug_project.pl          | 50 ++++++++++++++++++++++++++++++++++++++++++-----
 Prolog-Library-Collection |  2 +-

    merge

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#83&#34;&gt;83. commit 70aec99207ccbb33e23b3af547346ef1a2923fc1&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    merge

Merge: 70aec99 bf4ebea
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#84&#34;&gt;84. commit e06e6ba9af125b82c1f19b4481e748559f847ba6&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 plUri  | 2 +-
 plHtml | 2 +-

    Upped submodules

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#85&#34;&gt;85. commit 0fd12ca246d674d21d912881698711dde72bd0d3&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 12 insertions(+), 15 deletions(-)
 README.md | 27 ++++++++++++---------------

    DOC: spacing

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#86&#34;&gt;86. commit 67c415721c41e9e05cbdba40bb4735f3951f11bb&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 28 insertions(+), 16 deletions(-)
 gv_color.pl | 22 ++++++++++++++--------
 gv_attrs.pl | 22 ++++++++++++++--------

    ENHANCED: Print progress/problems of initializing GraphViz colors and attributes to the console.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#87&#34;&gt;87. commit b972e2b2e40c6f50b3055873bdec06836d687c91&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 10 insertions(+), 11 deletions(-)
 gv_file.pl | 21 ++++++++++-----------

    Sync to process update in PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#88&#34;&gt;88. commit 8bbc84c721b287890d8fa305e5b700b5ec4fa00b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 7 files changed, 32 insertions(+), 40 deletions(-)
 run.pl                    |  2 ++
 plUri                     |  2 +-
 plHtml                    |  2 +-
 gv_file.pl                | 62 ++++++++++++++++++++---------------------------
 README.md                 |  1 -
 Prolog-Library-Collection |  2 +-
 .gitignore                |  1 +

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#89&#34;&gt;89. commit 033fa1448bea11bd52bbf85e1296b8788b313ede&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 9 insertions(+), 3 deletions(-)
 gv_attrs.pl     | 4 ++--
 gv_attr_type.pl | 8 +++++++-

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#90&#34;&gt;90. commit fdb5a9e7bd35c963bc12c9cf2da47310576c981a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    merge

Merge: 8bbc84c fdb5a9e
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#91&#34;&gt;91. commit 6ec582e33df1feff0eca315974a4daf7555e3878&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 gv_color.pl | 2 +-
 gv_attrs.pl | 2 +-

    Sync to plHtml.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#92&#34;&gt;92. commit 68b53b8f39e5500b7bf7f6527e358fcfe755e938&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 gv_color.pl | 2 +-
 gv_attrs.pl | 2 +-

    Sync to plHtml.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#93&#34;&gt;93. commit 46e8f3ce8458bae27a39985b7e2d6ab01c1e70a7&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 insertions(+), 2 deletions(-)
 gv_file.pl | 4 ++--

    DOC: Small fix to documentation.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#94&#34;&gt;94. commit 3162d883a592da6feb510bc183d89e03a88726d4&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 4 insertions(+), 2 deletions(-)
 gv_dot.pl       | 1 +
 gv_color.pl     | 2 +-
 gv_attrs.pl     | 1 +
 gv_attr_type.pl | 2 +-

    FIXED: Module imports.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#95&#34;&gt;95. commit 714b2e0424dbe8f892e9f1bbf288a3e76236d4a3&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 gv_attr_type.pl | 2 +-

    FIXED: Module import conflict.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#96&#34;&gt;96. commit af7a3871a7525e0c4c27905989ad6c12e1b3dcd9&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 4 insertions(+), 3 deletions(-)
 gv_numeral.pl | 5 +++--
 gv_color.pl   | 2 +-

    FIXED: Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#97&#34;&gt;97. commit 7b434e315484e5160f9e0f9201bdb9643f47de08&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 272 insertions(+), 285 deletions(-)
 gv_graph.pl | 229 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 gv_file.pl  | 127 ++++++++++-----------------------
 gv_dot.pl   | 201 ++--------------------------------------------------

    Started simplifying stuff.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#98&#34;&gt;98. commit dcbcb4d01410d71b4e1cdf8e2ab7a6ce5cff96ca&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 8 files changed, 389 insertions(+), 137 deletions(-)
 gv_util.pl                | 260 ++++++++++++++++++++++++++++++++++++++++++++++
 gv_html.pl                |   4 +-
 gv_file.pl                |   9 +-
 gv_dot.pl                 | 102 +++++++++---------
 gv_color.pl               |  29 ++++--
 gv_attrs.pl               |  78 +++++++-------
 gv_attr_type.pl           |  42 ++++----
 Prolog-Library-Collection |   2 +-

    Many utils from PLC are needed...

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#99&#34;&gt;99. commit 50a3dbc39532e583ace2d71cfed7eeb0db813c87&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 17 files changed, 98 insertions(+), 630 deletions(-)
 run.pl                    |  11 --
 plUri                     |   1 -
 plHtml                    |   1 -
 load_project.pl           | 125 ----------------------
 load.pl                   |  13 ---
 gv_util.pl                | 260 ----------------------------------------------
 gv_numeral.pl             |  20 ++--
 gv_html.pl                |  17 ++-
 gv_graph.pl               |  26 ++---
 gv_file.pl                |   2 +
 gv_dot.pl                 |  57 +++++-----
 gv_color.pl               |  24 ++---
 gv_attrs.pl               |  13 ++-
 gv_attr_type.pl           |  44 ++++----
 debug_project.pl          | 106 -------------------
 debug.pl                  |   7 --
 Prolog-Library-Collection |   1 -

    Sync to updated PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#100&#34;&gt;100. commit a97e8e1fec071b7306a9aa6ad43749d08780d96f&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 12 files changed, 272 insertions(+), 216 deletions(-)
 test/test.pl                                 |  10 +
 test/debug.pl                                |  15 ++
 gv_numeral.pl =&amp;gt; prolog/gv/gv_numeral.pl     |   1 -
 gv_html.pl =&amp;gt; prolog/gv/gv_html.pl           |   2 +-
 gv_dot.pl =&amp;gt; prolog/gv/gv_graph_comp.pl      | 264 ++++++++++++++-------------
 gv_graph.pl =&amp;gt; prolog/gv/gv_graph.pl         |  19 +-
 gv_file.pl =&amp;gt; prolog/gv/gv_file.pl           |   7 +-
 gv_color.pl =&amp;gt; prolog/gv/gv_color.pl         |  34 +---
 gv_attrs.pl =&amp;gt; prolog/gv/gv_attrs.pl         |  40 ++--
 gv_attr_type.pl =&amp;gt; prolog/gv/gv_attr_type.pl |  66 +++----
 pack.pl                                      |   9 +
 LICENSE.txt                                  |  21 +++

    ADDED: Created full Prolog Pack.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#101&#34;&gt;101. commit 9513a9be8a25ceb2ce966b3d4ed4b63407c42716&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 9 insertions(+), 7 deletions(-)
 prolog/gv/gv_color.pl | 16 +++++++++-------

    FIXED: Non-determinism in downloading the GraphViz color table.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#102&#34;&gt;102. commit 7163f602709cfede798f72fd36980cbbe8816545&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 pack.pl | 2 +-

    Pack version 0.0.2

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#103&#34;&gt;103. commit b2f4aef718c0cd2f190a4bbea1855af89bae6cbe&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 3 insertions(+), 2 deletions(-)
 prolog/gv/gv_graph_comp.pl | 3 ++-
 pack.pl                    | 2 +-

    FIXED: Attributes represented as compound terms.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#104&#34;&gt;104. commit ba30c25127b0f70c041a4bf4c7c57a242591fdcf&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 13 insertions(+), 7 deletions(-)
 prolog/gv/gv_file.pl | 18 ++++++++++++------
 pack.pl              |  2 +-

    ENHANCED: Make up an output file name in case none is given.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#105&#34;&gt;105. commit 0eea41b6c6c2e70118b1921d5e531f6e2ed016ee&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 5 files changed, 41 insertions(+), 6 deletions(-)
 prolog/gv/gv_html.pl  |  2 +-
 prolog/gv/gv_dom.pl   | 35 +++++++++++++++++++++++++++++++++++
 prolog/gv/gv_color.pl |  4 ++--
 prolog/gv/gv_attrs.pl |  4 ++--
 pack.pl               |  2 +-

    ADDED: gv_dom/3.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#106&#34;&gt;106. commit c1691bd808d6880f39fc486617c5faa1a3a68674&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 373 insertions(+), 11 deletions(-)
 test/test.pl                       |  19 +-
 prolog/gv/gv_attrs.pl              |   3 +-
 prolog/graph/build_export_graph.pl | 360 +++++++++++++++++++++++++++++++++++++
 pack.pl                            |   2 +-

    ADDED: build_export_graph/3.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#107&#34;&gt;107. commit 3de9fc2a336afab3994d30c3c4a2f98475ab9652&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 17 insertions(+), 5 deletions(-)
 prolog/gv/gv_color.pl | 10 ++++++++--
 prolog/gv/gv_attrs.pl | 10 ++++++++--
 pack.pl               |  2 +-

    FIXED: No longer use persistency_ext which gave permission errors.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#108&#34;&gt;108. commit cb34d89fd0cce9b5a4fbf3bf6434f6771081c67a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 4 insertions(+), 3 deletions(-)
 prolog/gv/gv_graph.pl | 5 +++--
 pack.pl               | 2 +-

    FIXED: Typo in GraphViz DOT generation.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#109&#34;&gt;109. commit 7f0e20fd402f669cb59621a07203f08866cbff04&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 19 insertions(+), 19 deletions(-)
 prolog/graph/build_export_graph.pl | 36 ++++++++++++++++++------------------
 pack.pl                            |  2 +-

    FIXED: Name-value pairs to option compounds.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#110&#34;&gt;110. commit c16a7a7cd7bec0fa9f65e9835478c351d396677b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 5 insertions(+), 5 deletions(-)
 prolog/gv/gv_graph_comp.pl | 2 +-
 prolog/gv/gv_graph.pl      | 6 +++---
 pack.pl                    | 2 +-

    FIXED: Added determinism to GraphViz DOT generation.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#111&#34;&gt;111. commit 8bbb08c76fac066a3fa22a840a3bd4bd64e7293c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 13 insertions(+), 8 deletions(-)
 prolog/gv/gv_file.pl  | 9 +++++++--
 prolog/gv/gv_color.pl | 6 +++---
 prolog/gv/gv_attrs.pl | 4 ++--
 pack.pl               | 2 +-

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#112&#34;&gt;112. commit 34c8b1a9c74ba8cbf8f5985638b220ad573fe6ce&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 5 insertions(+), 2 deletions(-)
 prolog/graph/build_export_graph.pl | 5 ++++-
 pack.pl                            | 2 +-

    FIXED: Support for edge/2 besides edge/3 compound terms.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#113&#34;&gt;113. commit d883d0607e5ba30ce42e845fdc6d4459ea2fab2f&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 3 insertions(+), 2 deletions(-)
 prolog/graph/build_export_graph.pl | 3 ++-
 pack.pl                            | 2 +-

    FIXED: By default the label of a graph is the empty string.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#114&#34;&gt;114. commit 66ac0a091089347967dcc64ee8832f30acb91ce2&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 3 insertions(+), 3 deletions(-)
 prolog/gv/gv_attr_type.pl | 4 ++--
 pack.pl                   | 2 +-

    FIXED: escaping of double quotes labels was broken.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#115&#34;&gt;115. commit ab5a1028be0707fea663d35fa1e76a9a62b78262&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 971 insertions(+), 1 deletion(-)
 gv_color.log | 802 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 gv_attrs.log | 169 +++++++++++++
 .gitignore   |   1 -

    DEPLOYMENT: Include default version of settings files since GraphViz Web site is often offline.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#116&#34;&gt;116. commit 65f43b8ebe93dd39c5a75f8506cc957ae817a8fe&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 7 files changed, 984 insertions(+), 15 deletions(-)
 test/gv_attrs.log          | 169 ++++++++++
 prolog/gv/gv_graph_comp.pl |  14 +-
 prolog/gv/gv_color.pl      |   4 +-
 prolog/gv/gv_color.log     | 802 +++++++++++++++++++++++++++++++++++++++++++++
 prolog/gv/gv_attrs.pl      |   6 +-
 pack.pl                    |   2 +-
 .gitignore                 |   2 -

    merge

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#117&#34;&gt;117. commit c6de3d1b6f875da1868a26b81855d96f9799196b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    merge

Merge: c6de3d1 65f43b8
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#118&#34;&gt;118. commit cab2231f8ca7bc9ce02552cddcb74079ff3cb386&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 169 insertions(+)
 prolog/gv/gv_attrs.log | 169 +++++++++++++++++++++++++++++++++++++++++++++++++

    ADDED: atts log.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#119&#34;&gt;119. commit 008c5e632ccdcf0f58199ba24a24b06f7a73a87c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 pack.pl | 2 +-

    0.0.16

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#120&#34;&gt;120. commit dba5c72fafb666266f6494de7d8d6542c2e12e75&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 pack.pl | 2 +-

    0.0.17

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#121&#34;&gt;121. commit eff64ee3c829d1ab86f734d36b6a9ebd0915f9bc&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 15 deletions(-)
 test/debug.pl | 15 ---------------

    DEBUG: cleanup.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#122&#34;&gt;122. commit 89eb423af6cf856a936e8c0cdcaa7ba667f0c9c6&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 7 insertions(+), 9 deletions(-)
 test/test.pl               | 2 --
 prolog/gv/gv_graph_comp.pl | 4 ++--
 prolog/gv/gv_graph.pl      | 6 +++---
 prolog/gv/gv_attr_type.pl  | 4 ++--

             Thanks to Markus Triska.
    CLEANUP: Use * i.o. &#39;*&#39; for predicate names.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#123&#34;&gt;123. commit 2346997feabccf63c0dde7abe7de810fbbf53f6b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 8 insertions(+), 10 deletions(-)
 prolog/graph/build_export_graph.pl | 9 ++++++++-
 .gitmodules                        | 9 ---------

    ADDED: Wrapper build_export_graph/2.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#124&#34;&gt;124. commit d22d50e477d8b53eade745f23d64fc5c7177ac79&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 218 insertions(+)
 install | 218 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

    ADDED: Install script.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#125&#34;&gt;125. commit e64cc3593e4a6d15a00d32b3dda690536d52c414&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 27 insertions(+), 31 deletions(-)
 prolog/gv/gv_file.pl  | 48 ++++++++++++++++++++++--------------------------
 prolog/gv/gv_color.pl |  6 +++---
 prolog/gv/gv_attrs.pl |  4 ++--

    CLEAN: various cleanups.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#126&#34;&gt;126. commit 763a529e2b01af1a5f8da6a89f19bc7d6d8119a2&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    Merge branch &#39;master&#39; of https://github.com/wouterbeek/plGraphViz

Merge: 763a529 e64cc35
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#127&#34;&gt;127. commit d962f818fa3094e1f3ccab245a94232147a5e7cf&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 218 deletions(-)
 install | 218 ----------------------------------------------------------------

    CLEAN: no install

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#128&#34;&gt;128. commit 63a5cd72e1751cb08e8a304e0eaefd6ba6454d82&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 17 insertions(+), 15 deletions(-)
 prolog/gv/gv_color.pl |  5 +++--
 prolog/gv/gv_attrs.pl | 27 ++++++++++++++-------------

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#129&#34;&gt;129. commit ce95c3c892470ce2fe09bb364d428059c99e6ca0&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 20 insertions(+), 15 deletions(-)
 prolog/gv/gv_graph_comp.pl | 28 +++++++++++++++-------------
 prolog/gv/gv_attr_type.pl  |  7 +++++--

    FIXED: Support for strings/atoms.
    DEBUG: Throw exceptions in several spots of the DOT grammar.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#130&#34;&gt;130. commit 44cd5a661f0811904e11770a6388dd1495540620&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 35 insertions(+), 30 deletions(-)
 prolog/graph/build_export_graph.pl | 65 ++++++++++++++++++++------------------

    EHANCED: `build_export_graph/[2,3]&#39; support S-represented ugraphs.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#131&#34;&gt;131. commit c0c5e1890ea65a0f67c37e4e9d4c2d29ccdf8111&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 10 files changed, 1154 insertions(+), 2166 deletions(-)
 prolog/gv/gv_color.pl   |  79 +----
 prolog/gv/gv_color.log  | 802 ------------------------------------------------
 prolog/gv/gv_color.data | 802 ++++++++++++++++++++++++++++++++++++++++++++++++
 prolog/gv/gv_attrs.pl   | 148 +--------
 prolog/gv/gv_attrs.log  | 169 ----------
 prolog/gv/gv_attrs.data | 169 ++++++++++
 gv_color.log            | 802 ------------------------------------------------
 gv_attrs.log            | 169 ----------
 data/gv_color_scrape.pl |  56 ++++
 data/gv_attrs_scrape.pl | 124 ++++++++

    Library percistency is too unreliable to do this, as is the GV Web site.
    DEPLOYMENT: Distribute scripts for scraping the GraphViz Web site.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#132&#34;&gt;132. commit 603344fe57e9747bf1f2f7e90537ee2e4fe20c36&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 9 insertions(+), 4 deletions(-)
 prolog/gv/gv_file.pl | 13 +++++++++----

    ENHANCED: Specify that module gv_file requires program dot to be installed.
    CLEAN: Use PLC supplied abstraction predicate for running an external process.
    Allows Prolog to show warnings when running a program that depends on DOT support when it&#39;s not currently installed.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#133&#34;&gt;133. commit 267925349145c9919435cc83625479c87ceb904c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 103 insertions(+), 5 deletions(-)
 test/test.pl             |  2 ++
 prolog/gv/gv_file.pl     | 19 ++++++++---
 prolog/fca/fca_export.pl | 87 ++++++++++++++++++++++++++++++++++++++++++++++++

    ADDED: Module fca_export providing fca_export/[2,3] and three vertex label writers.
    DOC: Fixed mode for gv_export/[2,3]&#39;s output file argument.
    ADDED: Wrapper gv_export/2.
    Added support for exporting FCA lattices.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#134&#34;&gt;134. commit a5e20f86f351a3d8ab562fd3e0a76bf6c959ddbc&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 7 insertions(+), 2 deletions(-)
 prolog/fca/fca_export.pl | 9 +++++++--

    ENHANCED: Do not display reflexive edges in FCA lattice export.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#135&#34;&gt;135. commit bc3c50241b899b7201647cd475d66f74073c4b6f&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 73 insertions(+), 52 deletions(-)
 prolog/gv/gv_graph_comp.pl         | 68 ++++++++++++++------------------------
 prolog/gv/gv_graph.pl              |  2 +-
 prolog/graph/build_export_graph.pl | 31 ++++++++++++++---
 prolog/fca/fca_export.pl           | 24 +++++++++++---

    ADDED: Generate ranks for exported graphs based on rank assignment function for vertices.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#136&#34;&gt;136. commit 7ec98aac5f8783118fc4e1443cdd168bd2f854a1&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 insertions(+), 17 deletions(-)
 prolog/fca/fca_export.pl | 19 ++-----------------

    Use the new FCA Hasse construction predicate from PLC for exporting FCA diagrams.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#137&#34;&gt;137. commit 984d3b9ad1b22f5221e0d27ceccb6873e46b9ca5&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 48 insertions(+), 47 deletions(-)
 prolog/graph/build_export_graph.pl |  8 ++--
 prolog/fca/fca_export.pl           | 87 +++++++++++++++++++-------------------

    Improved the way in which FCE-specific options are passed to FCA export.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#138&#34;&gt;138. commit 4401e203e457575fedd614b8794360f3eb350cd5&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 35 insertions(+), 14 deletions(-)
 prolog/fca/fca_export.pl | 49 ++++++++++++++++++++++++++++++++++--------------

    ADDED: Support for option `attribute_label/1&#39;.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#139&#34;&gt;139. commit 22474664404e3b42da3137dfb33983c82eb40d9a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 8 insertions(+), 8 deletions(-)
 prolog/gv/gv_graph_comp.pl | 12 ++++++------
 prolog/gv/gv_graph.pl      |  4 ++--

    CLEAN: Sync to indent/tab updates in PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#140&#34;&gt;140. commit f4a9322a1ff02370019c53e8c3ae673fe691010b&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 138 insertions(+), 218 deletions(-)
 prolog/gv/gv_graph_comp.pl |  71 +++++-------
 prolog/gv/gv_color.pl      |   3 +-
 prolog/gv/gv_attr_type.pl  | 282 ++++++++++++++++++---------------------------

    Simplified DOT generating grammar.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#141&#34;&gt;141. commit 0d2712a7b0e2b5d4c32fbdccc0829e645b4d1601&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 86 insertions(+), 108 deletions(-)
 prolog/gv/gv_html.pl               | 83 ++++++++++++++------------------------
 prolog/gv/gv_graph_comp.pl         | 14 +++----
 prolog/gv/gv_graph.pl              | 70 +++++++++++++++++++-------------
 prolog/graph/build_export_graph.pl | 27 ++++---------

    CLEAN: Use dcg_ext to simplify grammars in gv_graph, gv_html and gv_graph_comp.
    CLEAN: Reuse option_has_var_value/1 from PLC to simplify code.
    Cleanups to sync with improved DCG support in PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#142&#34;&gt;142. commit 35189854afd8cfb82985a6a1c40742f18ef0c671&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 46 insertions(+), 22 deletions(-)
 test/test.pl                             |  2 +-
 prolog/fca/{fca_export.pl =&amp;gt; fca_viz.pl} | 66 ++++++++++++++++++++++----------

    ADDED: `fca_export/[2,3]&#39; which can be reused by plRdf.
    CLEAN: Renamed `fca_export&#39; -&amp;gt; `fca_viz&#39; for consistency with other modules.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#143&#34;&gt;143. commit 322ca62bb5509825b5ccb1688ba9303bdeae9ead&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 57 insertions(+), 35 deletions(-)
 test/test.pl                             | 20 +++++-----
 prolog/gv/gv_graph_comp.pl               |  2 +-
 prolog/graph/build_export_graph.pl       |  5 +--
 prolog/fca/{fca_export.pl =&amp;gt; fca_viz.pl} | 65 +++++++++++++++++++++-----------

    various

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#144&#34;&gt;144. commit c4bf9eacf0960339a5dce8ca0d422f3e1ab829d0&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
    #       test/test.pl
    #       prolog/fca/fca_viz.pl
    # Conflicts:
    
    Merge branch &#39;master&#39; of https://github.com/wouterbeek/plGraphViz

Merge: c4bf9ea 322ca62
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#145&#34;&gt;145. commit 2a6dafd998ef482cf9ea80003822f3b07ab9251e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 insertions(+), 3 deletions(-)
 prolog/fca/fca_viz.pl | 7 ++++---

    FIXED: Expand meta-options correctly.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#146&#34;&gt;146. commit 145615e02046b65d1fbf061dfa77fea462fb3b4f&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 15 insertions(+), 48 deletions(-)
 prolog/fca/fca_viz.pl | 63 ++++++++++++---------------------------------------

    CLEAN: Simplified FCA concept label writing.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#147&#34;&gt;147. commit f16acca2418fbb9e0d879e9ef5e90bbf48fdb41e&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 22 insertions(+), 50 deletions(-)
 prolog/graph/build_export_graph.pl | 62 ++++++++++++--------------------------
 prolog/fca/fca_viz.pl              | 10 ++----

    CLEAN: Simplified vertex label API.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#148&#34;&gt;148. commit 4e2d9f122f66784ae362c054118cc39ffa9f7f7c&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 6 insertions(+), 1 deletion(-)
 prolog/gv/gv_html.pl | 7 ++++++-

    DOC: Added attributes supported for FONT.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#149&#34;&gt;149. commit 6359c9ca232b6fbdeac6b75b6ac36576ce7ab6ac&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 4 files changed, 87 insertions(+), 28 deletions(-)
 prolog/tree/tree_viz.pl | 62 +++++++++++++++++++++++++++++++++++++++++++++++++
 prolog/gv/gv_file.pl    | 25 +++++++-------------
 prolog/gv/gv_dom.pl     |  4 ++--
 prolog/fca/fca_viz.pl   | 24 +++++++++++--------

    CLEAN: Renamed some predicates for consistency.
    ADDED: Tree visualization module.
    ADDED: Options number_of_vertices/1 and process_cputime/1 for fca_viz/3.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#150&#34;&gt;150. commit 00537d0e997b0759cbd2494eaedb0a688a7ba270&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 insertions(+), 3 deletions(-)
 prolog/tree/tree_viz.pl | 7 ++++---

    minor

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#151&#34;&gt;151. commit acadc3940eb3822bbc1ae02a9dfbab2d0f7a8aab&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 19 insertions(+), 92 deletions(-)
 prolog/gv/gv_numeral.pl    | 87 ----------------------------------------------
 prolog/gv/gv_graph_comp.pl | 24 ++++++++++---

    ENHANCED: Now using the grammar for GraphViz numberals.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#152&#34;&gt;152. commit 51359c6bc9865b90c02fce32e1fcbd3e37406982&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 4 insertions(+), 4 deletions(-)
 prolog/graph/build_export_graph.pl | 8 ++++----

    CLEAN: lambda -&amp;gt; yall.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#153&#34;&gt;153. commit 73047b3b8e12f4a922a3ac73fa515b983b9fc8ee&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 11 insertions(+), 9 deletions(-)
 prolog/tree/tree_viz.pl | 20 +++++++++++---------

    ENHANCED: Support both labeled and unlabeled trees in tree-2-graphviz conversion.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#154&#34;&gt;154. commit e4c4586bf31c358724bc00e6c0805682df0ab249&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 10 insertions(+), 8 deletions(-)
 test/test.pl              | 4 +++-
 prolog/gv/gv_color.pl     | 8 ++++----
 prolog/gv/gv_attr_type.pl | 6 +++---

    FIXED: Sync to updated to DCGs in PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#155&#34;&gt;155. commit 7b991bb4cc9e47c2651023295ef20cdc268f8c6a&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 9 files changed, 4 insertions(+), 11 deletions(-)
 prolog/gv/gv_html.pl               | 1 -
 prolog/gv/gv_graph_comp.pl         | 1 -
 prolog/gv/gv_graph.pl              | 1 -
 prolog/gv/gv_color.pl              | 1 -
 prolog/gv/gv_attrs.pl              | 2 +-
 prolog/gv/gv_attr_type.pl          | 1 -
 prolog/graph/build_export_graph.pl | 3 +--
 prolog/fca/fca_viz.pl              | 2 +-
 data/gv_attrs_scrape.pl            | 3 +--

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#156&#34;&gt;156. commit fa1518fbfb15aec820ab5d54b452ec4fce811899&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 9 insertions(+), 4 deletions(-)
 prolog/gv/gv_graph_comp.pl         | 4 +++-
 prolog/graph/build_export_graph.pl | 9 ++++++---

    FIXED: gv_id should write numbers.
    FIXED: Yall does not work.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#157&#34;&gt;157. commit 8593ed6499a6b6a58ebf0cce4602aea05ca639de&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 7 insertions(+), 4 deletions(-)
 prolog/gv/gv_attrs.pl | 11 +++++++----

    DEBUG: Exception when unknown GV attr encountered.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#158&#34;&gt;158. commit cc53b1ea7fbf553c17b191ce6b1af3fac33133da&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 insertion(+), 1 deletion(-)
 prolog/tree/tree_viz.pl | 2 +-

    FIXED: Typo in predicate name.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#159&#34;&gt;159. commit 202a241a884c68a46b1dd77e95929bfa31e9e9f8&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 2 insertions(+), 2 deletions(-)
 data/gv_color_scrape.pl | 2 +-
 data/gv_attrs_scrape.pl | 2 +-

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#160&#34;&gt;160. commit 858b5fb43ded8c4df92935df002bf15586dd9569&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 5 insertions(+), 6 deletions(-)
 prolog/gv/gv_graph_comp.pl | 2 +-
 prolog/gv/gv_attrs.pl      | 9 ++++-----

    Sync to PLC.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#161&#34;&gt;161. commit 260b62d34b352c2ccae4c085321497aa30f670ba&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 3 insertions(+), 9 deletions(-)
 prolog/gv/gv_dom.pl | 12 +++---------

    minor cleanup

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#162&#34;&gt;162. commit a6886ca8272a99b4d14f866b54fe16993b714011&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 2 insertions(+), 2 deletions(-)
 pack.pl | 4 ++--

    pack

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#163&#34;&gt;163. commit 41914a2d39ceca347ebcc4785cf5615c9c7f8376&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 3 files changed, 4 insertions(+), 4 deletions(-)
 prolog/gv/gv_color.pl   | 4 ++--
 data/gv_color_scrape.pl | 2 +-
 data/gv_attrs_scrape.pl | 2 +-

    sync

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#164&#34;&gt;164. commit 05a5fd2488c4e28c0eae9db4d9c9df4f550f4c3d&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 1 file changed, 1 deletion(-)
 prolog/fca/fca_viz.pl | 1 -

    cleanup

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#165&#34;&gt;165. commit fd6c59b31ebd0ac9927495460dcd4c762ac5681d&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;
 2 files changed, 19 insertions(+), 27 deletions(-)
 data/gv_color_scrape.pl | 20 ++++++++------------
 data/gv_attrs_scrape.pl | 26 +++++++++++---------------

    CLEAN: Use module io for simplified stream calling @gv_attrs_scrape,gv_color_scrape

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;#166&#34;&gt;166. commit 121e68f9ab3b47128c9fb365aed6891f9e91a568&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;code&#34;&gt; The shell code for generate navigation for source Tree &lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;# git log --help  特别有用
#bash /e/gethead.sh &amp;gt; graph.log

## first part
echo &amp;quot;+ [1. 源码比较目录](#compare)&amp;quot;
echo &amp;quot;+ [2. 文件细节](#detail)&amp;quot;
echo &amp;quot;+ [3. 时间变化表](#time)&amp;quot;
echo &amp;quot;+ [4. 列出简要信息](#short)&amp;quot;

## second part
echo &amp;quot;&amp;quot;
echo &amp;quot;&amp;lt;h2 id=\&amp;quot;compare\&amp;quot;&amp;gt;1. 比较目录&amp;lt;/h2&amp;gt;&amp;quot;
echo &amp;quot;&amp;quot;
sign=0
count=1
for i in `git log --decorate --oneline|awk &#39;{print $1}&#39;|tac`;
do if (( sign&amp;lt;1 ))
then 
	sign=2; 
        before=$i; 
else 
	#content[$count]=&amp;quot;\[$count: 正在比较变动前 $before 和变动后 $i\]\[$count\]&amp;quot;
	echo &amp;quot;+ [$count: 正在比较变动前 $before 和变动后 $i](#$count)&amp;quot;
	#content[$count]=&#39;[$count: 正在比较变动前 $before 和变动后 $i][$count]&#39;
	count=$(($count+1))
    before=$i; 
fi
done;


## third part
echo &amp;quot;&amp;quot;
echo &amp;quot;&amp;lt;h2 id=\&amp;quot;detail\&amp;quot;&amp;gt;2. 文件细节&amp;lt;/h2&amp;gt;&amp;quot;
echo &amp;quot;&amp;quot;
sign=0
count=1
for i in `git log --decorate --oneline|awk &#39;{print $1}&#39;|tac`;
do if (( sign&amp;lt;1 ))
then 
	sign=2; 
        before=$i; 
else 
	echo \&amp;lt;h2 id=\&amp;quot;$count\&amp;quot;\&amp;gt; $count: &amp;quot;正在比较变动前&amp;quot; $before &amp;quot;和变动后&amp;quot; $i \&amp;lt;\/h2\&amp;gt;
    echo &amp;quot;[back to content](#compare)&amp;quot;

	#content[$count]=&amp;quot;\[$count: 正在比较变动前 $before 和变动后 $i\]\[$count\]&amp;quot;
	#echo &amp;quot;[$count: 正在比较变动前 $before 和变动后 $i][$count]&amp;quot;
	#content[$count]=&#39;[$count: 正在比较变动前 $before 和变动后 $i][$count]&#39;
    echo &amp;quot; &amp;quot;
    echo &amp;quot;\`\`\` diff&amp;quot;
    echo &amp;quot; &amp;quot;
	git diff $before $i
    echo &amp;quot; &amp;quot;
    echo &amp;quot;\`\`\`&amp;quot;
    echo &amp;quot; &amp;quot;
	count=$(($count+1))
    before=$i; 
fi
done;

echo &amp;quot;总共进行了&amp;quot; $count &amp;quot;次比较&amp;quot;

## fourth part
#echo &amp;quot;时间变化表:&amp;quot;

echo &amp;quot;&amp;quot;
echo &amp;quot;&amp;lt;h2 id=\&amp;quot;time\&amp;quot;&amp;gt;3. 时间变化表&amp;lt;/h2&amp;gt;&amp;quot;

echo &amp;quot;&amp;quot;
#git log --pretty=format:&amp;quot;%h      %cd       %cr&amp;quot;|awk &#39;{print &amp;quot;[&amp;quot;NR&amp;quot;. &amp;quot;$0&amp;quot;](#&amp;quot;NR&amp;quot;)\n&amp;quot;}&#39;|tac 
git log --pretty=format:&amp;quot;%h      %cd       %cr&amp;quot;|tac|awk &#39;{print &amp;quot;[&amp;quot;NR&amp;quot;. &amp;quot;$0&amp;quot;](#&amp;quot;NR&amp;quot;)\n&amp;quot;}&#39;

## fifth part
echo &amp;quot;&amp;quot;
echo &amp;quot;&amp;lt;h2 id=\&amp;quot;short\&amp;quot;&amp;gt;4. 列出简要信息&amp;lt;/h2&amp;gt;&amp;quot;
echo &amp;quot;&amp;quot;

echo &amp;quot;\`\`\` vim&amp;quot;
echo &amp;quot; &amp;quot;

git log --stat|tac|awk -v count=1 &#39;{if(/^commit/){gsub(/$/,&amp;quot;](#&amp;quot;count&amp;quot;)&amp;quot;);count=count+1}; print $0} &#39; |sed &#39;/^Date/d&#39;|sed &#39;/^Author/d&#39;|sed /^commit/&#39;i```\n&#39;|sed /^commit/&#39;a \\n``` vim&#39; |awk -v count=1 &#39;{if(/^commit/){gsub(/commit/,&amp;quot;[&amp;quot;count&amp;quot;. commit&amp;quot;);count=count+1};print $0;}&#39;

## one bug ,you need to delete the last sentence generate by the code



&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>打印的书籍(prolog&#43;scheme&#43;空气动力学方面)</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/07/19/da-yin-de-shu-ji-prolog-plus-scheme-plus-kong-qi-dong-li-xue-fang-mian/</link>
      <pubDate>Tue, 19 Jul 2016 20:52:17 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/07/19/da-yin-de-shu-ji-prolog-plus-scheme-plus-kong-qi-dong-li-xue-fang-mian/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Edsger_W._Dijkstra&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Edsgar Dijkstar&lt;/a&gt;写过不少程序语言和逻辑编程的好书，比如&lt;a href=&#34;https://www.amazon.cn/A-Discipline-of-Programming-Dijkstra-E/dp/013215871X?ie=UTF8&amp;amp;*Version*=1&amp;amp;*entries*=0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A Discipline of programming&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;尾随之后的是David Gries写的&lt;a href=&#34;http://item.jd.com/1104449344.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the science of programing. TSOP&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/books/logic.jpg&#34; alt=&#34;logic&#34;&gt;&lt;/p&gt;
&lt;p&gt;在空气动力学领域，生于1937年的&lt;a href=&#34;https://en.wikipedia.org/wiki/John_D._Anderson&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;John D. Anderson&lt;/a&gt;是一位航空领域多产的作家，其中&lt;a href=&#34;http://product.dangdang.com/23454699.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;空气动力学基础&lt;/a&gt;更是经典的经典。
西门子之前根据Michel Geradim的&lt;a href=&#34;http://as.wiley.com/WileyCDA/WileyTitle/productCd-0471489905.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Flexible Multibody Dynamics: a finite element approach&lt;/a&gt;编写有限元多体分析软件系统（具体名字忘记）,与之类似的是绿皮书 Ahmed A. Shabana编写的&lt;a href=&#34;https://www.amazon.com/Dynamics-Multibody-Systems-Ahmed-Shabana/dp/1107042658?ie=UTF8&amp;amp;*Version*=1&amp;amp;*entries*=0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Dynamics of Multibody Systems&lt;/a&gt;也是多体动力学领域不错的好书。
J.Blazek写了一本计算流体动力学的好书Computational Fluid Dynamics:Principles and Applications]&lt;a href=&#34;http://www.sciencedirect.com/science/book/9780080445069&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;19&lt;/a&gt;.当然Pijush K. Kundu写的&lt;a href=&#34;https://www.amazon.com/dp/012405935X/ref=pd_lpo_sbs_dp_ss_1?pf_rd_p=1944687602&amp;amp;pf_rd_s=lpo-top-stripe-1&amp;amp;pf_rd_t=201&amp;amp;pf_rd_i=0123821002&amp;amp;pf_rd_m=ATVPDKIKX0DER&amp;amp;pf_rd_r=CX15VAHTQNHS6GGN3W1M&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fluid Mechanic&lt;/a&gt;也是经典之著
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/books/pro1.jpg&#34; alt=&#34;pro1&#34;&gt; ,&lt;img src=&#34;https://jueqingsizhe66.github.io/images/books/pro2.jpg&#34; alt=&#34;pro2&#34;&gt;, &lt;img src=&#34;https://jueqingsizhe66.github.io/images/books/pro3.jpg&#34; alt=&#34;pro3&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;之前，提及了程序语言，在这个领域不得不说是Dan Friedman.这位老顽童曾经写过很多本大象书籍，比如 &lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BTLS/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the little scheme,TLS&lt;/a&gt; , &lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BTSS/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the season scheme,TSS&lt;/a&gt;, &lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BRS/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the reason scheme,TRS&lt;/a&gt;,写完TRS之后最经常说的是&amp;quot;Can it run backward？&amp;quot;,
&lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BALJ/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;a little java,ALJ&lt;/a&gt;, &lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BTML/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the little mler,TLM&lt;/a&gt;, &lt;a href=&#34;http://www.eopl3.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Essential of programing language,EOPL&lt;/a&gt;,以及进一步
像逻辑学领域进军的&lt;a href=&#34;http://the-little-prover.github.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the little prover&lt;/a&gt;,立志要建一个类似于&lt;a href=&#34;https://coq.inria.fr/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;coq&lt;/a&gt;的证明式语言系统(法国人写的软件一般是动物，比如&lt;a href=&#34;https://ocaml.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ocaml&lt;/a&gt;，coq),刚刚建了一个很bang的&lt;a href=&#34;https://github.com/the-little-prover/j-bob&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;J-Bob&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/books/dan-friedman.jpg&#34; alt=&#34;Dan&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;关于函数式编程，还有一类是比较纯函数式编程比如Haskell，ML等。Haskell有很多不错的书籍比如Bryan O&amp;rsquo;Sullivan写的 &lt;a href=&#34;http://book.realworldhaskell.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Real World Haskell&lt;/a&gt;以及来自斯洛文尼亚的 Miran LipoVaca写的&lt;a href=&#34;http://learnyouahaskell.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Learn You a Haskell for Great Good&lt;/a&gt;(中文版为&lt;a href=&#34;http://fleurer-lee.com/lyah/introduction.htm#%E5%85%B3%E4%BA%8E%E8%BF%99%E4%B8%AA%E6%95%99%E7%A8%8B&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Haskell趣味指南&lt;/a&gt;) ,而Ml语言比如Ocaml也又不错的比如&lt;a href=&#34;https://realworldocaml.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Real World Ocaml&lt;/a&gt;, 特别是纯函数语言可以加深你对语言设计方面的理解。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/books/haskell.jpg&#34; alt=&#34;Haskell&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;万物都有其道，有其逻辑。当逻辑被质疑，不能成立，则得推翻，进而重构，关于logic programming，首先得认识的是Prolog。并以三个比较好的入门阶段式书籍&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;http://vuh-la-risprt.herts.ac.uk/portal/en/persons/william-clocksin%2803529872-f654-4e70-a76c-3cc790d188ce%29.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;William F. ClockSin&lt;/a&gt;的 &lt;a href=&#34;http://www.springer.com/cn/book/9783540006787&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Programming in prolog&lt;/a&gt;,从1984年开始到2003年.&lt;/li&gt;
&lt;li&gt;William F. Clocksin的 &lt;a href=&#34;http://www.springer.com/cn/book/9783540629719&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;clauses and Effect&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;P. Deransart 的&lt;a href=&#34;http://www.springer.com/cn/book/9783540593041&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Prolog: the standard&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;另外还有一些比较经典的书籍是 &lt;a href=&#34;http://learnprolognow.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;learn Prolog Now!&lt;/a&gt;,&lt;a href=&#34;http://www.springer.com/cn/book/9781447154860?token=prtst0416p&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Logic Programming with Prolog&lt;/a&gt;,&lt;a href=&#34;https://mitpress.mit.edu/books/art-prolog&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the-art-of-prolog&lt;/a&gt; 这本书入门也不错,&lt;a href=&#34;http://link.springer.com/book/10.1007/978-1-4471-0401-8&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;prolog versue you&lt;/a&gt;.
以及面向人工智能和图像处理的方面的prolog书籍, 比如&lt;a href=&#34;http://www.abebooks.com/PROLOG-Programming-Artificial-Intelligence-4th-Revised/5962501764/bd&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PROLOG Programming for Artificial Intelligence (4th Revised edition) &lt;/a&gt;,&lt;a href=&#34;http://link.springer.com/book/10.1007/3-540-34336-9&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;An Introduction to Language Processing with Perl and Prolog &lt;/a&gt;,&lt;a href=&#34;http://link.springer.com/book/10.1007/978-3-642-41464-0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Language Processing with Perl and Prolog &lt;/a&gt;,&lt;a href=&#34;http://link.springer.com/book/10.1007/978-1-4471-0401-8&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Intelligent Image Processing in Prolog&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/books/prolog.jpg&#34; alt=&#34;prolog&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>prolog小游戏</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/07/19/prologxiao-you-xi/</link>
      <pubDate>Tue, 19 Jul 2016 19:35:37 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/07/19/prologxiao-you-xi/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/prolog/games.png&#34; alt=&#34;games&#34;&gt;&lt;/p&gt;
&lt;p&gt;prolog 作为一门logic programming language,逻辑推理是它的强项。游戏也是一个逻辑推理的过程，prolog照样可以，通过该游戏的写作可以让你熟悉&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;事实和规则。&lt;/li&gt;
&lt;li&gt;built-in predicates.&lt;/li&gt;
&lt;li&gt;IO&lt;/li&gt;
&lt;li&gt;cut-fail操作&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;游戏源代码如下，进一步参考&lt;a href=&#34;http://tieba.baidu.com/p/128101598&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;prolog教程&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-prolog&#34;&gt;:-dynamic here/1.

room(kitchen).
room(office).
room(hall). 
room(&#39;dining room&#39;).
room(cellar). 
door(office, hall).
door(kitchen, office).
door(hall, &#39;dining room&#39;).
door(kitchen, cellar).
door(&#39;dining room&#39;, kitchen).

location(desk, office).
location(apple, kitchen). 
location(flashlight, desk). 
location(&#39;washing machine&#39;, cellar).
location(nani, &#39;washing machine&#39;).
location(broccoli, kitchen).
location(crackers, kitchen).
location(knife, kitchen).
location(computer, office).

location(envelope, desk). 
location(stamp, envelope).
location(key, envelope). /* more interesting thing*/

edible(apple).
edible(crackers).
tastes_yucky(broccoli).

/* You are here now in the  game.*/
here(kitchen). 
where_food(X,Y) :- location(X,Y),edible(X).
where_food(X,Y) :- location(X,Y),tastes_yucky(X).

connect(X,Y):-door(X,Y).
connect(X,Y):-door(Y,X).


/*list all things in the correspondign room*/
list_things(Place) :- location(X,Place),tab(2),write(X),nl,fail.

list_things(_).  /* always correct  AnyPlace&#39;s value we don&#39;t care, 只能用_ underscore)*/


list_things_to_eat(Place) :- where_food(X,Place),tab(2),write(X),nl,fail.
list_things_to_eat(_) .


list_connections(Place) :- connect(X,Place),tab(2),write(X),nl,fail.
list_connections(_).


look:- here(Place), write(&#39;You are in the &#39;),write(Place),write(&#39; now!&#39;),nl,write(&#39;You can see:&#39;),nl,
list_things(Place),write(&#39;what the things you can eat  are below:&#39;),nl,list_things_to_eat(Place),
write(&#39;You can also go to &#39;),nl,list_connections(Place).






c_to_f(C,F):- F is C*9/5+32.
freezeing(F):-F=&amp;lt;32.

goto(Place) :- can_go(Place),move(Place),look.
can_go(Place) :- here(X),connect(X,Place).
can_go(_) :- write(&#39;You can&#39;&#39;t get there from here.&#39;),nl,fail.
move(Place):- retract(here(Y)),asserta(here(Place)).


take(X):- can_take(X),take_object(X).

can_take(Thing) :-here(Place),location(Thing,Place).
can_take(Thing) :- write(&#39;There is no &#39;),write(Thing),write(&#39; Here&#39;),nl,fail.

take_object(X):- retract(location(X,_)),asserta(hava(X)),write(&#39;taken&#39;),nl.


backtracking_assert(X):- asserta(X). 
backtracking_assert(X):- retract(X),fail. 


is_contained_in(T1,T2) :- location(T1,T2).
is_contained_in(T1,T2) :- location(X,T2),is_contained_in(T1,X).


object(candle,red   ,small,1).
object(apple ,red   ,small,1).
object(apple ,green ,small,1).
object(apple ,blue  ,big,50).
object(desk,brwon,dimension(6,3,3),90).
object(desk,color(brwon),size(dimension(6,3,3)),weight(90)).
object(desk,color(brwon),size(large),weight(90)).

location_s(object(candle,red    ,small,1),kitchen).
location_s(object(apple ,bluired ,small,1),kitchen).
location_s(object(apple ,green   ,small,1),kitchen).
location_s(object(apple ,blue  ,big,50),kitchen).


can_take_s(Thing) :- here(Room),location_s(object(Thing,_,small,_),Room).
can_take_s(Thing) :- here(Room),location_s(object(Thing,_,big,_),Room),write(&#39;The &#39;),write(Thing),
                write(&#39; is too big to carry!&#39;),nl,fail.
can_take_s(Thing) :- here(Room),not(location_s(object(Thing,_,_,_),Room)),write(&#39;There is no &#39;),
                write(Thing),write(&#39;Here.&#39;),nl,fail.

list_things_s(Place) :- location_s(object(Thing,Color,Size,Weight),Place),
    write(&#39;A &#39;),write(Size),tab(1),write(Color),tab(1),write(Thing),write(&#39;,weighing &#39;),
    write_weight(Weight),nl,fail.
list_things_s(_).

write_weight(1):-write(&#39;1 pound&#39;).
write_weight(W):-W&amp;gt;1,write(W),write(&#39; pounds&#39;).


loc_list([apple,broccoil,crackers],kitchen).
loc_list([desk,computer],office).
loc_list([flashlight,envelope],desk).
loc_list([stamp,key],envelope).
loc_list([&#39;Washing machine&#39;],cellar).
loc_list([nani],&#39;Washing machine&#39;).
loc_list([],hall). /* empty list*/

/*length1([zha,df,gs],H).*/
length1([],0).
length1([H|T],N) :- length1(T,M),N is M+1.

member(X,[X|List]).
member(X,[Element|List]) :- member(X,List).

prefix([],List).
prefix([X|Prefix],[X|List]):- prefix(Prefix,List).

suffix(Suffix,Suffix).
prefix(Suffix,[X|List]) :- suffix(Suffix,List).

vowel(X) :- member(X,[a,e,i,o,u]).
digit(D) :- member(D,[&#39;0&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;]).

/*reverse([ ],[ ]).
reverse([X|L],Rev) :- reverse(L,RL), append(RL,[X],Rev).*/

/*reverse([a,b,v],Rl).*/
reverse([ ],[ ]).
reverse(L,RL) :- reverse(L,[ ],RL).

reverse([ ],RL,RL).
reverse([X|L],PRL,RL) :- reverse(L,[X|PRL],RL).

/* isort([6,3,6,2,4,64,234],Sl) */

isort([ ],[ ]).
isort([X|UnSorted],AllSorted) :- isort(UnSorted,Sorted),
                                 insert(X,Sorted,AllSorted).

insert(X,[ ],[X]).
insert(X,[Y|L],[X,Y|L]) :- X =&amp;lt; Y.
insert(X,[Y|L],[Y|IL]) :-  X &amp;gt; Y, insert(X,L,IL).


facTail(0,1).
facTail(N,F) :- N &amp;gt; 0, facTail(N,1,F).

facTail(1,F,F).
facTail(N,PP,F) :- N &amp;gt; 1, NPp is N*PP, M is N-1, 
       facTail(M,NPp,F). 


fibTail(0,1).
fibTail(1,1).
fibTail(N,F) :- N &amp;gt; 1, fibTail(N,1,1,F).

fibTail(2,F1,F2,F) :- F is F1 + F2.
fibTail(N,F1,F2,F) :- N &amp;gt; 2, N1 is N - 1, NF1 is F1 + F2,
    fibTail(N1,NF1,F1,F).

/*
primes(PL) :- natlist(2,L2), sieve(L2,PL).

sieve([ ],[ ]).
sieve([P|L],[P|IDL]) :- sieveP(P,L,PL), sieve(PL,IDL).

sieveP(P,[ ],[ ]). 
sieveP(P,[N|L],[N|IDL]) :- N mod P  &amp;gt;  0, sieveP(P,L,IDL).
sieveP(P,[N|L],   IDL)  :- N mod P =:= 0, sieveP(P,L,IDL).
*/
/*
merge( List1, List2, List3 ) :-
 ( List1 = [], !, List3 = List2 );
 ( List2 = [], !, List3 = List1 );
 ( List1 = [X|L1], List2 = [Y|L2 ),
((X &amp;lt; Y, ! Z = X, merge( L1, List2, L3 ) );
( Z = Y, merge( List1, L2, L3 ) )),
  List3 = [Z|L3].
*/

merge([],List2,List2).
merge(List1,[],List1).

merge([X|List1],[Y|List2],[Z|List3]) :- X&amp;lt;Y,!,merge(List1,List2,List3).
merge(List1,[Y|List2],[Y|List3]) :- merge(List1,List,List3).
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>java小结</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/07/19/javaxiao-jie/</link>
      <pubDate>Tue, 19 Jul 2016 18:42:25 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/07/19/javaxiao-jie/</guid>
      <description>&lt;p&gt;很长没有做java小结，把最近浏览的几个链接添上去。&lt;/p&gt;
&lt;p&gt;java小结&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/JpressProjects/jpress&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Jpress&lt;/a&gt; 是一个不错的cms开源平台，慢慢可以取代wordpress,且速度较快。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://luxiaolei.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;路小磊&lt;/a&gt;的工具包&lt;a href=&#34;https://github.com/looly/hutool&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Hutools utility&lt;/a&gt;有在更新中。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;sourceTree可以用来做软件开发跟踪，内核当然是git。
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/javaSourceTree.png&#34; alt=&#34;sourcetree&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>matlab小结</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/</link>
      <pubDate>Tue, 19 Jul 2016 18:41:57 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/</guid>
      <description>&lt;p&gt;最近，有做一个图像处理的项目，总结出一些有用的maltlab小工具。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;Numsubplot&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;windRose&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;多项式拟合&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt;箭头&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5&#34;&gt;误差带&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6&#34;&gt;matlab编程配置&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7&#34;&gt;cell and array&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;1&#34;&gt;1. Numsubplot&lt;/h2&gt;
&lt;p&gt;在进行分析的时候，有时候可能需要多图打印，numsubplot还是挺方便的。使用可以看注释部分&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-matlab&#34;&gt;    function [p,n]=numSubplots(n)
% function [p,n]=numSubplots(n)
    %
    % Purpose
    % Calculate how many rows and columns of sub-plots are needed to
    % neatly display n subplots. 
    %
    % Inputs
    % n - the desired number of subplots.     
    %  
    % Outputs
    % p - a vector length 2 defining the number of rows and number of
    %     columns required to show n plots.     
    % [ n - the current number of subplots. This output is used only by
    %       this function for a recursive call.]
    %
    %
    %
    % Example: neatly lay out 13 sub-plots
% &amp;gt;&amp;gt; p=numSubplots(13)
    % p = 
    %     3   5
    % for i=1:13; subplot(p(1),p(2),i), pcolor(rand(10)), end 
    %
    %
    % Rob Campbell - January 2010


    while isprime(n) &amp;amp; n&amp;gt;4, 
    n=n+1;
end

p=factor(n);

if length(p)==1
p=[1,p];
return
end


while length(p)&amp;gt;2
if length(p)&amp;gt;=4
p(1)=p(1)*p(end-1);
p(2)=p(2)*p(end);
p(end-1:end)=[];
else
p(1)=p(1)*p(2);
p(2)=[];
end    
p=sort(p);
end


%Reformat if the column/row ratio is too large: we want a roughly
%square design 
while p(2)/p(1)&amp;gt;2.5
N=n+1;
[p,n]=numSubplots(N); %Recursive!
end

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt;2. Winrose&lt;/h2&gt;
&lt;p&gt;a. 可以用于绘制风玫瑰图，也就是风向变量和风速变量
b. 也可以用于绘制单一变量的玫瑰图，比如角度玫瑰图&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-matlab&#34;&gt;function [figure_handle,colorSeq,barX,barY,count,speeds,directions,Table] = WindRose(direction,speed,varargin)
    %  WindRose  Draw a Wind Rose knowing direction and speed
    %
    %  [figure_handle,count,speeds,directions,Table] = WindRose(direction,speed);
    %  [figure_handle,count,speeds,directions,Table] = WindRose(direction,speed,&#39;parameter1&#39;,value1,...);
    %
    %  figure_handle is the handle of the figure containing the chart
    %  count is the frequency for each speed (ncolumns = nspeeds) and for each direction (nrows = ndirections).
    %  speeds is a 1 by n vector containing the values for the speed intervals
    %  directions is a m by 1 vector containing the values in which direction intervals are centered
    %  Table is a (4+m) by (3+m) cell array (excel-ready), containing Frequencies for each direction and for each speed. 
    %
    %  User can specify direction angle meaning North and East winds, so
    %  the graphs is shown in the desired reference
    %
    %     Example
    %     d = 360 * rand(10000,1); % My reference is North = 0? East = 90?
    %     v = 30*rand(10000,1);
    % 
    %     [figure_handle,count,speeds,directions,Table] = WindRose(d,v,&#39;anglenorth&#39;,0,&#39;angleeast&#39;,90,&#39;freqlabelangle&#39;,45);
    %
    % PARAMETER          CLASS         DEFAULT VALUE         DESCRIPTION
    %------------------------------------------------------------------------------------------------------------------------------------------------------------
    % &#39;centeredin0&#39;      Logical.      true                  Is first angular bin centered in 0 (-5 to 5)? -&amp;gt; CeteredIn0 = true // or does it start in 0 (0 to 10)? -&amp;gt; CeteredIn0 = false.
    % &#39;ndirections&#39;      Numeric.      36                    Number of direction bins (subdivisions) to be shown.
    % &#39;freqround&#39;        Numeric.      1                     Maximum frquency value will be rounded to the first higher whole multiple of FrequenciesRound. Only applies if &#39;maxfrequency&#39; is specified.
    % &#39;nfreq&#39;            Numeric.      5                     Draw this number of circles indicating frequency.
    % &#39;speedround&#39;       Numeric.      [] (auto)             Maximum wind speed will be rounded to the first higher whole multiple of WindSpeedRound.
    % &#39;nspeeds&#39;          Numeric.      [] (auto)             Draw this number of windspeeds subdivisions (bins). Default is 6 if &#39;speedround&#39; is specified. Otherwise, default is automatic.
    % &#39;maxfrequency&#39;     Numeric.      [] (auto) or 6        Set the value of the maximum frequency circle to be displayed. Be careful, because bins radius keep the original size.
    % &#39;freqlabelangle&#39;   Numeric.      [] (auto)             Angle in which frequecy labels are shown. If this value is empty, frequency labels will NOT be shown. Trigonometric reference. 0=Right, 90=Up.
    % &#39;titlestring&#39;      Cell/String.  {&#39;Wind Rose&#39;;&#39; &#39;}     Figure title. It is recommended to include an empty line below the main string.
    % &#39;lablegend&#39;        String.       &#39;Wind speeds in m/s&#39;  String that will appear at the top of the legend. Can be empty.
    % &#39;cmap&#39;             String.       &#39;jet&#39;                 String with the name of a colormap function. If you put inv before the name of the funcion, colors will be flipped (e.g. &#39;invjet&#39;, &#39;invautum&#39;, &#39;invbone&#39;, ...). Use any of the built-in functions (autumn, bone, colorcube, cool, copper, flag, gray, hot, hsv, jet, lines, pink, prism, spring, summer, white, winter). See doc colormap for more information.
    % &#39;height&#39;           Numeric.      2/3*screensize        Figure inner height in pixels. Default is 2/3 of minimum window dimension;
    % &#39;width&#39;            Numeric.      2/3*screensize        Figure inner width in pixels.
    % &#39;figcolor&#39;         Color Code.   &#39;w&#39;                   Figure color, any admitted matlab color format. Default is white.
    % &#39;textcolor&#39;        Color Code.   &#39;k&#39;                   Text and axis color, any admitted matlab color format. Default is black.
    % &#39;labels&#39;           CellString    {&#39;N&#39;,&#39;S&#39;,&#39;E&#39;,&#39;W&#39;}     Specify North South East West in a cell array of strings.
    % &#39;labelnorth&#39;       String.       &#39;N&#39;                   Label to indicate North. Be careful if you specify &#39;labels&#39; and &#39;labelnorth&#39;. Last parameter specified will be the one used.
    % &#39;labelsouth&#39;       String.       &#39;S&#39;                   Label to indicate South. Be careful if you specify &#39;labels&#39; and &#39;labelsouth&#39;. Last parameter specified will be the one used.
    % &#39;labeleast&#39;        String.       &#39;E&#39;                   Label to indicate East.  Be careful if you specify &#39;labels&#39; and &#39;labeleast&#39; . Last parameter specified will be the one used.
    % &#39;labelwest&#39;        String.       &#39;W&#39;                   Label to indicate West.  Be careful if you specify &#39;labels&#39; and &#39;labelwest&#39; . Last parameter specified will be the one used.
    % &#39;titlefontweight&#39;  String.       &#39;bold&#39;                Title font weight. You can use &#39;normal&#39;,&#39;bold&#39;,&#39;light&#39;,&#39;demi&#39;
    % &#39;legendvariable&#39;   String.       &#39;W_S&#39;                 Variable abbreviation that appears inside the legend. You can use TeX sequences.
    % &#39;anglenorth&#39;       Numeric.       90                   Direction angle meaning North wind. Default is 90 for North (trigonometric reference). If you specify &#39;north&#39; angle, you need to specify &#39;east&#39; angle, so the script knows how angles are referenced.
    % &#39;angleeast&#39;        Numeric.       0                    Direction angle meaning East wind.  Default is  0 for East  (counterclockwise).        If you specify &#39;east&#39; angle, you need to specify &#39;north&#39; angle, so the script knows how angles are referenced.
    % &#39;minradius&#39;        Numeric        1/30                 Minimum radius of the wind rose, relative to the maximum frequency radius. An empty circle of this size appears if greater than 0.
    % &#39;legendtype&#39;       Numeric        2                    Legend type continuous = 1, separated boxes = 2
    %
    %
    % by Daniel Pereira - dpereira@s2msolutions.com
    %
    % 2014/Jul/14 - First version

    %% Check funciton call
    if nargin&amp;lt;2
    error(&#39;WindRose needs at least two inputs&#39;);
    elseif mod(length(varargin),2)~=0
    error(&#39;Inputs must be paired: WindRose(Speed,Direction,&#39;&#39;PropertyName&#39;&#39;,PropertyValue,...)&#39;);
elseif ~isnumeric(speed) || ~isnumeric(speed)
    error(&#39;Speed and Direction must be numeric arrays.&#39;);
elseif ~isequal(size(speed),size(direction))
    error(&#39;Speed and Direction must be the same size.&#39;);
    end

    %% Default parameters
    SCS              = get(0,&#39;screensize&#39;);

    CeteredIn0       = true;
    ndirections      = 36;
    FrequenciesRound = 1;
    NFrequencies     = 5;
    WindSpeedRound   = [];
    NSpeeds          = [];
    circlemax        = [];
    FreqLabelAngle   = [];
    TitleString      = {&#39;Wind Rose&#39;;&#39; &#39;};
%lablegend        = &#39;Wind Speeds in m/s&#39;;
lablegend        = &#39;flow angle in °&#39;;
colorfun         = &#39;jet&#39;;
height           = min(SCS(3:4))*2/3;
width            = min(SCS(3:4))*2/3;
figcolor         = &#39;[1,1,1]&#39;;
TextColor        = &#39;[0,0,0]&#39;;
% label.N          = &#39;N&#39;;
% label.S          = &#39;S&#39;;
% label.W          = &#39;W&#39;;
% label.E          = &#39;E&#39;;
label.N          = &#39;90°&#39;;
label.S          = &#39;270°&#39;;
label.W          = &#39;180°&#39;;
label.E          = &#39;0°&#39;;
titlefontweight  = &#39;bold&#39;;
legendvariable   = &#39;W_S&#39;;
RefN             = 90;
RefE             = 0;
min_radius       = 1/30;
LegendType       = 2;

%% User-.specified parameters

    for i=1:2:numel(varargin)
switch lower(varargin{i})
    case &#39;centeredin0&#39;
    CeteredIn0       = varargin{i+1};
case &#39;ndirections&#39;
ndirections      = varargin{i+1};
case &#39;freqround&#39;
FrequenciesRound = varargin{i+1};
case &#39;nfreq&#39;
NFrequencies     = varargin{i+1}; 
case &#39;speedround&#39;
WindSpeedRound   = varargin{i+1};
case &#39;nspeeds&#39;
NSpeeds          = varargin{i+1};
case &#39;freqlabelangle&#39;
FreqLabelAngle   = varargin{i+1};
case &#39;titlestring&#39;
TitleString      = varargin{i+1};
case &#39;lablegend&#39;
lablegend        = varargin{i+1};
case &#39;cmap&#39;
colorfun         = varargin{i+1};
case &#39;height&#39;
height           = varargin{i+1};
case &#39;width&#39;
width            = varargin{i+1};
case &#39;figcolor&#39;
figcolor         = varargin{i+1};
case &#39;textcolor&#39;
TextColor        = varargin{i+1};
case &#39;min_radius&#39;
min_radius       = varargin{i+1};
case &#39;maxfrequency&#39;
circlemax = varargin{i+1};
case &#39;titlefontweight&#39;
titlefontweight  = varargin{i+1};
case &#39;legendvariable&#39;
legendvariable   = varargin{i+1};
case &#39;legendtype&#39;
LegendType       = varargin{i+1};
case &#39;labelnorth&#39;
label.N          = varargin{i+1};
case &#39;labelsouth&#39;
label.S          = varargin{i+1};
case &#39;labeleast&#39;
label.E          = varargin{i+1};
case &#39;labelwest&#39;
label.W          = varargin{i+1};
case &#39;labels&#39;
label.N          = varargin{i+1}{1};
label.S          = varargin{i+1}{2};
label.E          = varargin{i+1}{3};
label.W          = varargin{i+1}{4};
case &#39;anglenorth&#39;
k = any(arrayfun(@(x) strcmpi(x,&#39;angleeast&#39;),varargin));
if ~k
error(&#39;Reference angles need to be specified for AngleEAST and AngleNORTH directions&#39;);
end
case &#39;angleeast&#39;
k = find(arrayfun(@(x) strcmpi(x,&#39;anglenorth&#39;),varargin));
if isempty(k)
    error(&#39;Reference angles need to be specified for AngleEAST and AngleNORTH directions&#39;);
    else
    RefE         = varargin{i+1};
RefN         = varargin{k+1};
end
if abs(RefN-RefE)~=90
error(&#39;The angles specified for north and east must differ in 90 degrees&#39;);
end
otherwise
error([varargin{i} &#39; is not a valid property for WindRose function.&#39;]);
end
end

speed            = reshape(speed,[],1);                                    % Convert wind speed into a column vector
direction        = reshape(direction,[],1);                                % Convert wind direction into a column vector
NumberElements   = numel(direction);                                       % Coun the actual number of elements, to consider winds = 0 when calculating frequency.
dir              = mod((RefN-direction)/(RefN-RefE)*90,360);               % Ensure that the direction is between 0 and 360?
speed            = speed(speed&amp;gt;0);                                         % Only show winds higher than 0. 縒hy? See next comment.
dir              = dir(speed&amp;gt;0);                                           % Wind = 0 does not have direction, so it cannot appear in a wind rose, but the number of appeareances must be considered.

figure_handle = figure(&#39;color&#39;,figcolor,&#39;units&#39;,&#39;pixels&#39;,&#39;position&#39;,[SCS(3)/2-width/2 SCS(4)/2-height/2 width height],&#39;menubar&#39;,&#39;none&#39;,&#39;toolbar&#39;,&#39;none&#39;);
%% Bin Directions
N     = linspace(0,360,ndirections+1);                                     % Create ndirections direction intervals (ndirections+1 edges)
N     = N(1:end-1);                                                        % N is the angles in which direction bins are centered. We do not want the 360 to appear, because 0 is already appearing.
n     = 180/ndirections;                                                   % Angle that should be put backward and forward to create the angular bin, 1st centered in 0
if ~CeteredIn0                                                             % If user does not want the 1st bin to be centered in 0?
N = N+n;                                                               % Bin goes from 0 to 2n (N to N+2n), instead of from -n to n (N-n to N+n), so Bin is not centered in 0 (N) angle, but in the n (N+n) angle
end

    %% Wind speeds/velocities
if ~isempty(WindSpeedRound)
    if isempty(NSpeeds); NSpeeds = 6; end                                  % Default value for NSpeeds if not user specified
    vmax      = ceil(max(speed)/WindSpeedRound)*WindSpeedRound;            % Max wind speed rounded to the nearest whole multiple of WindSpeedRound (Use round or ceil as desired)
    if vmax==0; vmax=WindSpeedRound; end;                      % If max wind speed is 0, make max wind to be WindSpeedRound, so wind speed bins are correctly shown.
    vwinds    = linspace(0,vmax,NSpeeds);                                  % Wind speeds go from 0 to vmax, creating the desired number of wind speed intervals
    else
    figure2 = figure(&#39;visible&#39;,&#39;off&#39;); plot(speed);                        % Plot wind speed
    vwinds = get(gca,&#39;ytick&#39;); delete(figure2);                            % Yaxis will automatically make divisions or us.
if ~isempty(NSpeeds)
    vwinds = linspace(min(vwinds),max(vwinds),NSpeeds);
    end
    end

    %% Histogram in each direction + Draw
    count     = PivotTableCount(N,n,vwinds,speed,dir,NumberElements);          % For each direction and for each speed, value of the radius that the windorose must reach (Accumulated in speed).

if isempty(circlemax)
    circlemax = ceil(max(max(count))/FrequenciesRound)*FrequenciesRound;   % Round highest frequency to closest whole multiple of theFrequenciesRound  (Use round or ceil as desired)
    end
    min_radius = min_radius*circlemax;

    DrawPatches(N,n,vwinds,count,colorfun,figcolor,min_radius);% Draw the windrose, knowing the angles, the range for each direction, the speed ranges, the count (frequency) values and the colormap used.

    %% Constant frequecy circles and x-y axes + Draw + Labels

    [x,y]     = cylinder(1,50); x = x(1,:); y = y(1,:);                        % Get x and y for a unit-radius circle
    circles   = linspace(0,circlemax,NFrequencies+1); circles = circles(2:end);% Radii of the circles that must be drawn (frequencies). We do not want to spend time drawing radius=0.

    radius    = circles   + min_radius;
    radiusmax = circlemax + min_radius;

    plot(x&#39;*radius,y&#39;*radius,&#39;:&#39;,&#39;color&#39;,TextColor);                           % Draw circles
    plot(x*radiusmax,y*radiusmax,&#39;-&#39;,&#39;color&#39;,TextColor);                       % Redraw last circle

    axisangles = 0:30:360; axisangles = axisangles(1:end-1);                   % Angles in which to draw the radial axis (trigonometric reference)
    R = [min_radius;radiusmax];
    plot(R*cosd(axisangles),R*sind(axisangles),&#39;:&#39;,&#39;color&#39;,TextColor);         % Draw radial axis, in the specified angles

    FrequecyLabels(circles,radius,FreqLabelAngle,TextColor);                   % Display frequency labels
    CardinalLabels(radiusmax,TextColor,label);                                 % Display N, S, E, W

    %% Title and Legend
    title(TitleString,&#39;color&#39;,TextColor,&#39;fontweight&#39;,titlefontweight);         % Display a title
    set(gca,&#39;outerposition&#39;,[0 0 1 1]);                                        % Check that the current axis fills the figure.
    if LegendType==2
    leyenda = CreateLegend(vwinds,lablegend,legendvariable);               % Create a legend cell string
    l       = legend(leyenda,&#39;location&#39;,&#39;southwest&#39;);                      % Display the legend wherever (position is corrected)
    PrettyLegend(l,TextColor);                                   % Display the legend in a good position
    elseif LegendType==1
    disp(vwinds);
    caxis([vwinds(1) vwinds(end)]);
    colorbar(&#39;YTick&#39;,vwinds);
    end

    %% Outputs
    [count,speeds,directions,Table,colorSeq,barX,barY] = CreateOutputs(count,vwinds,N,n,RefN,RefE);

function count = PivotTableCount(N,n,vwinds,speed,dir,NumberElements)
    count  = zeros(length(N),length(vwinds));
for i=1:length(N)
    d1 = mod(N(i)-n,360);                                              % Direction 1 is N-n
    d2 = N(i)+n;                                                       % Direction 2 is N+n
if d1&amp;gt;d2                                                           % If direction 1 is greater than direction 2 of the bin (d1 = -5 = 355, d2 = 5)
    cond = or(dir&amp;gt;=d1,dir&amp;lt;d2);                                     % The condition is satisfied whenever d&amp;gt;=d1 or d&amp;lt;d2
    else                                                               % For the rest of the cases,
    cond = and(dir&amp;gt;=d1,dir&amp;lt;d2);                                    % Both conditions must be met for the same bin
    end
    counter    = histc(speed(cond),vwinds);                            % If vmax was for instance 25, counter will have counts for these intervals: [&amp;gt;=0 y &amp;lt;5] [&amp;gt;=5 y &amp;lt;10] [&amp;gt;=10 y &amp;lt;15] [&amp;gt;=15 y &amp;lt;20] [&amp;gt;=20 y &amp;lt;25] [&amp;gt;=25]
    if isempty(counter); counter = zeros(1,size(count,2)); end         % If counter is empty for any reason, set the counts to 0.
    count(i,:) = cumsum(counter);                                      % Computing cumsum will make count to have the counts for [&amp;lt;5] [&amp;lt;10] [&amp;lt;15] [&amp;lt;20] [&amp;lt;25] [&amp;gt;=25] (cumulative count, so we have the radius for each speed)
    end
    count = count/NumberElements*100;                                      % Frequency in percentage

function DrawPatches(N,n,vwinds,count,colorfun,figcolor,min_radius)
    inv = strcmp(colorfun(1:3),&#39;inv&#39;);                                     % INV = First three letters in cmap are inv
    if inv; colorfun = colorfun(4:end); end                                % if INV, cmap is the rest, excluding inv
    color = feval(colorfun,256);                                           % Create color map
    color = interp1(linspace(1,length(vwinds),256),color,1:length(vwinds));% Get the needed values.
    if inv; color = flipud(color); end;                                    % if INV, flip upside down the colormap
    plot(0,0,&#39;.&#39;,&#39;color&#39;,figcolor,&#39;markeredgecolor&#39;,figcolor,&#39;markerfacecolor&#39;,figcolor); % This will create an empty legend entry.
    hold on; axis square; axis off;
for i=1:length(N)
    for j=length(vwinds)👎1
                          if j&amp;gt;1
                          r(1) = count(i,j-1);
                          else
                          r(1) = 0;                                                  % For the first case, radius is 0
                          end
                          r(2)  = count(i,j);
                          r     = r+min_radius;

                          alpha = linspace(-n,n,100)+N(i);
                          x1    = r(1) * sind(fliplr(alpha));
                          y1    = r(1) * cosd(fliplr(alpha));
                          x     = [x1 r(2)*sind(alpha)];                           % Create circular sectors
                          y     = [y1 r(2)*cosd(alpha)];
                          fill(x,y,color(j,:),&#39;edgecolor&#39;,hsv2rgb(rgb2hsv(color(j,:)).*[1 1 0.7])); % Draw them in the specified coloe. Edge is slightly darker.
                          %text(x(1),y(1),num2str(count(i,j)));  %% add label
                          end
                          end

function FrequecyLabels(circles,radius,angulo,TextColor)
    s = sind(angulo); c = cosd(angulo);                                      % Get the positions in which labels must be placed
    if c&amp;gt;0; ha = &#39;left&#39;;   elseif c&amp;lt;0; ha = &#39;right&#39;; else ha = &#39;center&#39;; end % Depending on the sign of the cosine, horizontal alignment should be one or another
    if s&amp;gt;0; va = &#39;bottom&#39;; elseif s&amp;lt;0; va = &#39;top&#39;;   else va = &#39;middle&#39;; end % Depending on the sign of the sine  , vertical   alignment should be one or another
for i=1:length(circles)
    text(radius(i)*c,radius(i)*s,[num2str(circles(i)) &#39;%&#39;],&#39;HorizontalAlignment&#39;,ha,&#39;verticalalignment&#39;,va,&#39;color&#39;,TextColor); % display the labels for each circle
    end
    rmin = radius(1)-abs(diff(radius(1:2)));
    if rmin&amp;gt;0
    if c&amp;gt;0; ha = &#39;right&#39;; elseif c&amp;lt;0; ha = &#39;left&#39;;   else ha = &#39;center&#39;; end % Depending on the sign of the cosine, horizontal alignment should be one or another
    if s&amp;gt;0; va = &#39;top&#39;;   elseif s&amp;lt;0; va = &#39;bottom&#39;; else va = &#39;middle&#39;; end % Depending on the sign of the sine  , vertical   alignment should be one or another
    text(rmin*c,rmin*s,&#39;0%&#39;,&#39;HorizontalAlignment&#39;,ha,&#39;verticalalignment&#39;,va,&#39;color&#39;,TextColor); % display the labels for each circle
    end

function CardinalLabels(circlemax,TextColor,labels)
    text( circlemax,0,[&#39; &#39; labels.E],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); % East  label
    text( circlemax*cos(30*pi/180),circlemax*sin(30*pi/180),[&#39; 30°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); % East  label
    text( circlemax*cos(60*pi/180),circlemax*sin(60*pi/180),[&#39; 60°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); 
    text( (circlemax+3)*cos(120*pi/180),(circlemax+3)*sin(120*pi/180),[&#39;120°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); 
    text( (circlemax+4)*cos(150*pi/180),(circlemax+4)*sin(150*pi/180),[&#39;150°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); 
    text( (circlemax+4)*cos(210*pi/180),(circlemax+4)*sin(210*pi/180),[&#39;210°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); 
    text( (circlemax+3)*cos(240*pi/180),(circlemax+3)*sin(240*pi/180),[&#39;240°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor);     
    text( circlemax*cos(300*pi/180),circlemax*sin(300*pi/180),[&#39; 300°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); 
    text( circlemax*cos(330*pi/180),circlemax*sin(330*pi/180),[&#39; 330°&#39;],&#39;HorizontalAlignment&#39;,&#39;left&#39;  ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); 
    text(-circlemax,0,[labels.W &#39; &#39;],&#39;HorizontalAlignment&#39;,&#39;right&#39; ,&#39;verticalalignment&#39;,&#39;middle&#39;,&#39;color&#39;,TextColor); % West  label
    text(0, circlemax,labels.N      ,&#39;HorizontalAlignment&#39;,&#39;center&#39;,&#39;verticalalignment&#39;,&#39;bottom&#39;,&#39;color&#39;,TextColor); % North label
    text(0,-circlemax,labels.S      ,&#39;HorizontalAlignment&#39;,&#39;center&#39;,&#39;verticalalignment&#39;,&#39;top&#39;   ,&#39;color&#39;,TextColor); % South label
    xlim([-circlemax circlemax]);
    ylim([-circlemax circlemax]);

function leyenda = CreateLegend(vwinds,lablegend,legendvariable)
    leyenda = cell(length(vwinds),1);                                      % Initialize legend cell array
for j=1:length(vwinds)
    if j==length(vwinds)                                               % When last index is reached
    string = sprintf(&#39;%s %s %g&#39;,legendvariable,&#39;\geq&#39;,vwinds(j));  % Display wind &amp;lt;= max wind
    else                                                               % For the rest of the indices
    string = sprintf(&#39;%g %s %s &amp;lt; %g&#39;,vwinds(j),&#39;\leq&#39;,legendvariable,vwinds(j+1)); % Set v1 &amp;lt;= v2 &amp;lt; v1
    end
    string = regexprep(string,&#39;0 \leq&#39;,&#39;0 &amp;lt;&#39;);                         % Replace &amp;quot;0 &amp;lt;=&amp;quot; by &amp;quot;0 &amp;lt;&amp;quot;, because wind speed = 0 is not displayed in the graph.
    leyenda{length(vwinds)-j+1} = string;
    end
    leyenda = [lablegend; leyenda];                                        % Add the title for the legend

function PrettyLegend(l,TextColor)
    set(l,&#39;units&#39;,&#39;normalized&#39;,&#39;box&#39;,&#39;off&#39;);                               % Do not display the box
    POS = get(l,&#39;position&#39;);                                               % get legend position (width and height)
    set(l,&#39;position&#39;,[0 1-POS(4) POS(3) POS(4)],&#39;textcolor&#39;,TextColor);    % Put the legend in the upper left corner
    uistack(l,&#39;bottom&#39;);                                                   % Put the legend below the axis

function [count,speeds,directions,Table,colorSeq,barX,barY] = CreateOutputs(count,vwinds,N,n,RefN,RefE)
    count          = [count(:,1) diff(count,1,2)];                         % Count had the accumulated frequencies. With this line, we get the frequency for each single direction and each single speed with no accumulation.
    speeds         = vwinds;                                               % Speeds are the same as the ones used in the Wind Rose Graph
    directions     = mod(RefN - N&#39;/90*(RefN-RefE),360);                    % Directions are the directions in which the sector is centered. Convert function reference to user reference
    vwinds(end+1)  = inf;                                                  % Last wind direction is inf (for creating intervals)

    [directions,i] = sort(directions);                                     % Sort directions in ascending order
    count          = count(i,:);                                           % Sort count in the same way.

    wspeeds        = cell(1,length(vwinds)-1);
for i=1:(length(vwinds)-1)
    if vwinds(i) == 0; s1 = &#39;(&#39;; else s1 = &#39;[&#39;; end                     % If vwinds(i) =0 interval is open, because count didn&#39;t compute windspeed = 0.
    wspeeds{i} = [s1 num2str(vwinds(i)) &#39; , &#39; num2str(vwinds(i+1)) &#39;)&#39;];% Create wind speed intervals
    end

    wdirs = cell(length(directions),1);
for i=1:length(directions)
    wdirs{i} = sprintf(&#39;[%g , %g)&#39;,mod(directions(i)-n,360),directions(i)+n); % Create widn direction intervals
    end

    %     countMark         = find(count == max(max(count)));
    %     countColumnLength = length(directions);
    %     foundIndex        = countMark -countColumnLength * floor(countMark/countColumnLength);
    %     colorSeq          = [mod(directions(foundIndex)-n,360),directions(foundIndex)+n];
    WindZeroFreqency = 100-sum(sum(count));                                % Wind speed = 0 appears 100-sum(total) % of the time. It does not have direction.
    WindZeroFreqency = WindZeroFreqency*(WindZeroFreqency/100&amp;gt;eps);        % If frequency/100% is lower than eps, do not show that value.

    Table            = [{&#39;Frequencies (%)&#39;},{&#39;&#39;},{&#39;Wind Speed Interval&#39;},repmat({&#39;&#39;},1,numel(wspeeds));&#39;Direction Interval (?&#39;,&#39;Direction ~&#39;,wspeeds,&#39;TOTAL&#39;;[wdirs num2cell(directions) num2cell(count) num2cell(sum(count,2))]]; % Create table cell. Ready to xlswrite.
            Table(end+1,:)   = [{&#39;[0 , 360)&#39;,&#39;TOTAL&#39;},num2cell(sum(count,1)),{sum(sum(count))}];
    Table(end+1,1:2) = {&#39;No Direction&#39;, &#39;Wind Speed = 0&#39;};  % Show Wind Speed = 0 on table.
    %% find max count
    colorBar1 = sum(count,2);
    foundIndex       = find(colorBar1 == max(colorBar1));
    colorSeq         = [mod(directions(foundIndex)-n,360),directions(foundIndex)+n];
    barIndex =  find(colorBar1&amp;gt;0);
    barX = [];
    barY = [];
for i = 1:length(barIndex)
    barX(i) = directions(i);
    barY(i) = colorBar1(i);
    end
    %bp = bar(barX,barY);
    %bp(1).LineWidth = 3;
    %bp(foundIndex).EdgeColor = &#39;red&#39;;

    Table{end,end}   = WindZeroFreqency;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3&#34;&gt;3. 多项式拟合&lt;/h2&gt;
&lt;p&gt;可以自己更改n为不同的多项式&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-matlab&#34;&gt;function [t,y1,a]=getfitLine(x,y,TapeLine)
    n=5;

    p = polyfit(x,y,n); 
    for i=1:n+1
    a(i)= p(i); 
    end
    t = linspace(x(1),x(length(x)),TapeLine);  
    if n==1;
    y1=a(1)*t+a(2);
    elseif n==2;
    y1=a(1)*t.^2+a(2)*t+a(3);
    elseif n==3;
    y1 = a(1)*t.^3 + a(2)*t.^2 + a(3)*t + a(4); 
    elseif n==4;
    y1 = a(1)*t.^4 + a(2)*t.^3 + a(3)*t.^2 + a(4)*t+a(5);
    elseif n==5
    y1= a(1)*t.^5+a(2)*t.^4+a(3)*t.^3+a(4)*t.^2+a(5)*t+a(6);
    end


    end

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4&#34;&gt;4. 不错的在图片中绘制箭头&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-matlab&#34;&gt;    function hn=arrow3(p1,p2,s,w,h,ip,alpha,beta)
% ARROW3 (R13)
    %   ARROW3(P1,P2) draws lines from P1 to P2 with directional arrowheads.
    %   P1 and P2 are either nx2 or nx3 matrices.  Each row of P1 is an
    %   initial point, and each row of P2 is a terminal point.
    %
    %   ARROW3(P1,P2,S,W,H,IP,ALPHA,BETA) can be used to specify properties
    %   of the line, initial point marker, and arrowhead.  S is a character
    %   string made with one element from any or all of the following 3
    %   columns:
    %
    %     Color Switches      LineStyle            LineWidth
    %     ------------------  -------------------  --------------------
%     k  blacK (default)  -  solid (default)   0.5 points (default)
    %     y  Yellow           :  dotted            0   no lines
    %     m  Magenta          -. dashdot           /   LineWidthOrder
    %     c  Cyan             -- dashed
    %     r  Red              *  LineStyleOrder            _______ __  
    %     g  Green                                       ^        |    
    %     b  Blue                                       / \       |    
    %     w  White                        Arrowhead    /   \   Height  
    %     a  Asparagus                                /     \     |    
    %     d  Dark gray                               /       \    |    
    %     e  Evergreen                              /___   ___\ __|__  
    %     f  Firebrick                             |    | |    |       
    %     h  Hot pink                              |-- Width --|       
    %     i  Indigo                                |    | |    |       
    %     j  Jade                                       | |            
    %     l  Light gray                                 | |            
    %     n  Nutbrown                                   | |            
    %     p  Pear                                       | |            
    %     q  kumQuat                      Line       --&amp;gt;| |&amp;lt;--LineWidth
    %     s  Sky blue                                   | |            
    %     t  Tawny                                      | |            
    %     u  bUrgundy                                   | |            
    %     v  Violet                                     | |            
    %     z  aZure                                      | |            
    %     x  random                       Initial      /   \           
    %     o  colorOrder                   Point    --&amp;gt;(     )&amp;lt;--IP     
    %     |  magnitude                    Marker       \_ _/           
    %
    %     -------------------------------------------------------------
    %                          Color Equivalencies
    %     -------------------------------------------------------------
    %     ColorOrder     Arrow3         |     Simulink       Arrow3
    %     ----------     ----------     |     ----------     ----------
    %     Color1         Blue           |     LightBlue      aZure
    %     Color2         Evergreen      |     DarkGreen      Asparagus
    %     Color3         Red            |     Orange         kumQuat
    %     Color4         Sky blue       |     Gray           Light gray
    %     Color5         Violet         |
    %     Color6         Pear           |
    %     Color7         Dark gray      |
    %     -------------------------------------------------------------
    %
    %   The components of S may be specified in any order.  Invalid
    %   characters in S will be ignored and replaced by default settings.
    %
    %   Prefixing the color code with &#39;_&#39; produces a darker shade, e.g.
    %   &#39;_t&#39; is dark tawny; prefixing the color code with &#39;^&#39; produces a
    %   lighter shade, e.g. &#39;^q&#39; is light kumquat.  The relative brightness
    %   of light and dark color shades is controlled by the scalar parameter
    %   BETA.  Color code prefixes do not affect black (k), white (w), or
    %   the special color switches (xo|).
    %
    %   ColorOrder may be achieved in two fashions:  The user may either
    %   set the ColorOrder property (using RGB triples) or define the
    %   global variable ColorOrder (using a string of valid color codes).
    %   If the color switch is specified with &#39;o&#39;, and the global variable
    %   ColorOrder is a string of color codes (color switches less &#39;xo|&#39;,
            %   optionally prefixed with &#39;_&#39; or &#39;^&#39;), then the ColorOrder property
    %   will be set to the sequence of colors indicated by the ColorOrder
    %   variable.  The color sequence &#39;bersvpd&#39; matches the default
    %   ColorOrder property.  If the color switch is specified with &#39;o&#39;, and
    %   the global variable ColorOrder is empty or invalid, then the current
    %   ColorOrder property will be used.  Note that the ColorOrder variable
    %   takes precedence over the ColorOrder property.
    %
    %   The magnitude color switch is used to visualize vector magnitudes
    %   in conjunction with a colorbar.  If the color switch is specified
    %   with &#39;|&#39;, colors are linearly interpolated from the current ColorMap
    %   according to the length of the associated line.  This option sets
    %   CLim to [MinM,MaxM], where MinM and MaxM are the minimum and maximum
    %   magnitudes, respectively.
    %
    %   The current LineStyleOrder property will be used if LineStyle is
    %   specified with &#39;*&#39;.  MATLAB cycles through the line styles defined
    %   by the LineStyleOrder property only after using all colors defined
    %   by the ColorOrder property.  If however, the global variable
    %   LineWidthOrder is defined, and LineWidth is specified with &#39;/&#39;,
    %   then each line will be drawn with sequential color, linestyle, and
    %   linewidth.
    %
    %   W (default = 1) is a vector of arrowhead widths; use W = 0 for no
    %   arrowheads.  H (default = 3W) is a vector of arrowhead heights.  If
    %   vector IP is neither empty nor negative, initial point markers will
    %   be plotted with diameter IP; for default diameter W, use IP = 0.
    %   The units of W, H and IP are 1/72 of the PlotBox diagonal.
    %
    %   ALPHA (default = 1) is a vector of FaceAlpha values ranging between
    %   0 (clear) and 1 (opaque).  FaceAlpha is a surface (arrowhead and
            %   initial point marker) property and does not affect lines.  FaceAlpha
    %   is not supported for 2D rendering.
    %
    %   BETA (default = 0.4) is a scalar that controls the relative
    %   brightness of light and dark color shades, ranging between 0 (no
            %   contrast) and 1 (maximum contrast).
    %
    %   Plotting lines with a single color, linestyle, and linewidth is
    %   faster than plotting lines with multiple colors and/or linestyles.
    %   Plotting lines with multiple linewidths is slower still.  ARROW3
    %   chooses renderers that produce the best screen images; exported
    %   or printed plots may benefit from different choices.
    %
    %   ARROW3(P1,P2,S,W,H,&#39;cone&#39;,...) will plot cones with bases centered
    %   on P1 in the direction given by P2.  In this instance, P2 is
    %   interpreted as a direction vector instead of a terminal point.
    %   Neither initial point markers nor lines are plotted with the &#39;cone&#39;
    %   option.
    %
    %   HN = ARROW3(P1,P2,...) returns a vector of handles to line and
    %   surface objects created by ARROW3.
    %
    %   ARROW3 COLORS will plot a table of named colors with default
    %   brightness.  ARROW3(&#39;colors&#39;,BETA) will plot a table of named
    %   colors with brightness BETA.
    %
    %   ARROW3 attempts to preserve the appearance of existing axes.  In
    %   particular, ARROW3 will not change XYZLim, View, or CameraViewAngle.
    %   ARROW3 does not, however, support stretch-to-fill scaling.  AXIS
    %   NORMAL will restore the current axis box to full size and remove any
    %   restrictions on the scaling of units, but will likely result in
    %   distorted arrowheads and initial point markers.  See
    %   (arrow3_messes_up_my_plots.html).
    %
    %   If a particular aspect ratio or variable limit is required, use
    %   DASPECT, PBASPECT, AXIS, or XYZLIM commands before calling ARROW3.
    %   Changing limits or aspect ratios after calling ARROW3 may alter the
    %   appearance of arrowheads and initial point markers.  ARROW3 sets
    %   XYZCLimMode to manual for all plots, sets DataAspectRatioMode to
    %   manual for linear plots, and sets PlotBoxAspectRatioMode to manual
    %   for log plots and 3D plots.  CameraViewAngleMode is also set to
    %   manual for 3D plots.
    %
    %   ARROW3 UPDATE will restore the appearance of arrowheads and
    %   initial point markers that have become corrupted by changes to
    %   limits or aspect ratios.  ARROW3(&#39;update&#39;,SF) will redraw initial
    %   point markers and arrowheads with scale factor SF.  If SF has one
%   element, SF scales W, H and IP.  If SF has two elements, SF(1)
    %   scales W and IP, and SF(2) scales H.  If SF has three elements,
    %   SF(1) scales W, SF(2) scales H, and SF(3) scales IP.  All sizes are
    %   relative to the current PlotBox diagonal.
    %
    %   ARROW3 UPDATE COLORS will update the magnitude coloring of
    %   arrowheads, initial point markers, and lines to conform to the
    %   current ColorMap.
    %
    %   HN = ARROW3(&#39;update&#39;,...) returns a vector of handles to updated
    %   objects.
    %
    %   EXAMPLES:
    %
    %     % 2D vectors
%     arrow3([0 0],[1 3])
    %     arrow3([0 0],[1 2],&#39;-.e&#39;)
    %     arrow3([0 0],[10 10],&#39;--x2&#39;,1)
    %     arrow3(zeros(10,2),50*rand(10,2),&#39;x&#39;,1,3)
    %     arrow3(zeros(10,2),[10*rand(10,1),500*rand(10,1)],&#39;u&#39;)
    %     arrow3(10*rand(10,2),50*rand(10,2),&#39;x&#39;,1,[],1)
    %
    %     % 3D vectors
%     arrow3([0 0 0],[1 1 1])
    %     arrow3(zeros(20,3),50*rand(20,3),&#39;--x1.5&#39;,2)
    %     arrow3(zeros(100,3),50*rand(100,3),&#39;x&#39;,1,3)
    %     arrow3(zeros(10,3),[10*rand(10,1),500*rand(10,1),50*rand(10,1)],&#39;a&#39;)
    %     arrow3(10*rand(10,3),50*rand(10,3),&#39;x&#39;,[],[],0)
    %
    %     % 3D animation
    %     t=(0:pi/40:8*pi)&#39;; u=cos(t); v=sin(t);
    %     plot3(20*t,u,v)
    %     axis([0,600,-1.5,1.5,-1.5,1.5])
%     grid on, view(35,25)
    %     hold on
%     pbaspect([1.8,1.4,1])
    %     arrow3(zeros(3),diag([500,1.5,1.5]),&#39;l&#39;,0.7,[],0)
    %     p=[20*t,u,v]; inc=4:1:length(t);
    %     p2=p(inc,:); p1=p(inc-1,:);
    %     hn=arrow3(p1(1,:),p2(1,:),&#39;0_b&#39;,0.7);
    %     for i=2:1:length(p1)
%       delete(hn)
    %       hn=arrow3(p1(i,:),p2(i,:),&#39;0_b&#39;,0.7);
%       pause(0.01)
    %     end
    %     hold off
    %
    %     % Cone plot
    %     t=(pi/8:pi/8:2*pi)&#39;; p1=[cos(t) sin(t) t]; p2=repmat([0 0 1],16,1);
    %     arrow3(p1,p2,&#39;x&#39;,2,4,&#39;cone&#39;), hold on
    %     plot3(p1(:,1),p1(:,2),p1(:,3)), hold off
    %     pause % change cone size
    %     arrow3(&#39;update&#39;,[1,2])
    %
    %     % Just for fun
    %     arrow3(zeros(100,3),50*rand(100,3),&#39;x&#39;,8,4,[],0.95)
    %     light(&#39;position&#39;,[-10 -10 -10],&#39;style&#39;,&#39;local&#39;)
    %     light(&#39;position&#39;,[60,60,60]), lighting gouraud
    %
    %     % ColorOrder variable, color code prefixes, and Beta
    %     global ColorOrder, ColorOrder=&#39;^ui^e_hq^v&#39;;
    %     theta=[0:pi/22:pi/2]&#39;;
    %     arrow3(zeros(12,2),[cos(theta),sin(theta)],&#39;1.5o&#39;,1.5,[],[],[],0.5)
    %
    %     % ColorOrder property, LineStyleOrder, and LineWidthOrder
    %     global ColorOrder, ColorOrder=[];
    %     set(gca,&#39;ColorOrder&#39;,[1,0,0;0,0,1;0.25,0.75,0.25;0,0,0])
    %     set(gca,&#39;LineStyleOrder&#39;,{&#39;-&#39;,&#39;--&#39;,&#39;-.&#39;,&#39;:&#39;})
    %     global LineWidthOrder, LineWidthOrder=[1,2,4,8];
    %     w=[1,2,3,4]; h=[4,6,4,2];
    %     arrow3(zeros(4,2),[10*rand(4,1),500*rand(4,1)],&#39;o*/&#39;,w,h,0)
    %
    %     % Magnitude coloring
    %     colormap spring
    %     arrow3(20*randn(20,3),50*randn(20,3),&#39;|&#39;,[],[],0)
    %     set(gca,&#39;color&#39;,0.7*[1,1,1])
    %     set(gcf,&#39;color&#39;,0.5*[1,1,1]), grid on, colorbar
    %     pause % change the ColorMap and update colors
    %     colormap hot
    %     arrow3(&#39;update&#39;,&#39;colors&#39;)
    %
    %     % LogLog plot
    %     set(gca,&#39;xscale&#39;,&#39;log&#39;,&#39;yscale&#39;,&#39;log&#39;);
    %     axis([1e2,1e8,1e-2,1e-1]); hold on
    %     p1=repmat([1e3,2e-2],15,1);
    %     q1=[1e7,1e6,1e5,1e4,1e3,1e7,1e7,1e7,1e7,1e7,1e7,1e6,1e5,1e4,1e3];
    %     q2=1e-2*[9,9,9,9,9,7,5,4,3,2,1,1,1,1,1]; p2=[q1&#39;,q2&#39;];
    %     global ColorOrder, ColorOrder=[];
    %     set(gca,&#39;ColorOrder&#39;,rand(15,3))
    %     arrow3(p1,p2,&#39;o&#39;), grid on, hold off
    %
    %     % SemiLogX plot
    %     set(gca,&#39;xscale&#39;,&#39;log&#39;,&#39;yscale&#39;,&#39;linear&#39;);
    %     axis([1e2,1e8,1e-2,1e-1]); hold on
    %     p1=repmat([1e3,0.05],15,1);
    %     q1=[1e7,1e6,1e5,1e4,1e3,1e7,1e7,1e7,1e7,1e7,1e7,1e6,1e5,1e4,1e3];
    %     q2=1e-2*[9,9,9,9,9,7,5,4,3,2,1,1,1,1,1]; p2=[q1&#39;,q2&#39;];
    %     arrow3(p1,p2,&#39;x&#39;), grid on, hold off
    %
    %     % SemiLogY plot
    %     set(gca,&#39;xscale&#39;,&#39;linear&#39;,&#39;yscale&#39;,&#39;log&#39;);
    %     axis([2,8,1e-2,1e-1]); hold on
    %     p1=repmat([3,2e-2],17,1);
    %     q1=[7,6,5,4,3,7,7,7,7,7,7,7,7,6,5,4,3];
    %     q2=1e-2*[9,9,9,9,9,8,7,6,5,4,3,2,1,1,1,1,1]; p2=[q1&#39;,q2&#39;];
    %     set(gca,&#39;LineStyleOrder&#39;,{&#39;-&#39;,&#39;--&#39;,&#39;-.&#39;,&#39;:&#39;})
    %     arrow3(p1,p2,&#39;*&#39;,1,[],0), grid on, hold off
    %
    %     % Color tables
    %     arrow3(&#39;colors&#39;)           % default color table
    %     arrow3(&#39;colors&#39;,0.3)       % low contrast color table
    %     arrow3(&#39;colors&#39;,0.5)       % high contrast color table
    %
    %     % Update initial point markers and arrowheads
    %     % relative to the current PlotBox diagonal
    %     arrow3(&#39;update&#39;)           % redraw same size
    %     arrow3(&#39;update&#39;,2)         % redraw double size
    %     arrow3(&#39;update&#39;,0.5)       % redraw half size
    %     arrow3(&#39;update&#39;,[0.5,2,1]) % redraw W half size,
    %                                %        H double size, and
    %                                %        IP same size
    %
    %     See also (arrow3_examples.html), (arrow3_messes_up_my_plots.html).

    %   Copyright(c)2002-2011 Version 5.14
%     Tom Davis (tdavis@metzgerwillard.com)
    %     Jeff Chang

    %   Revision History:
    %
    %     07/27/11 - Added animation example. (TD)
    %     05/13/09 - Corrected spelling errors (TD)
    %     03/16/08 - Updated contact information (TD)
%     10/23/07 - Corrected zero magnitude exclusion (TD)
    %     09/08/07 - Added cone plot option; removed adaptive grid
    %                spacing; corrected scale factor; removed &amp;quot;nearly&amp;quot;
    %                tight limits (TD)
%     07/24/07 - Ignore zero-magnitude input (TD)
    %     07/08/07 - Modified named colors to match named Simulink
    %                colors; added light and dark shades for basic
%                colors (ymcrgb) (TD)
    %     07/01/07 - Modified named colors to match default ColorOrder
    %                colors (TD)
    %     06/24/07 - Error checking for empty P1, P2 (TD)
    %     06/17/07 - Trim colors,W,H,IP,ALPHA to LENGTH(P1) (TD)
    %     05/27/07 - Magnitude coloring and documentation revision (TD)
%     03/10/07 - Improved code metrics (TD)
    %     02/21/07 - Preserve existing axis appearance;
    %                use relative sizes for W, H, and IP;
    %                removed version checking; minor bug fixes (TD) 
    %     01/09/04 - Replaced calls to LINSPACE, INTERP1, and
%                COLORMAP (TD)
    %     12/17/03 - Semilog examples, CAXIS support, magnitude
    %                coloring, and color updating; use CData instead
    %                of FaceColor; minor bug fixes (TD)
    %     07/17/03 - Changed 2D rendering from OpenGL to ZBuffer;
%                defined HN for COLORS and UPDATE options (TD)
    %     02/27/03 - Replaced calls to RANDPERM, VIEW, REPMAT, SPHERE,
    %                and CYLINDER; added ZBuffer for log plots, RESET
%                for CLA and CLF, and ABS for W and H (TD)
    %     02/01/03 - Added UPDATE scale factor and MATLAB version
    %                checking, replaced call to CROSS (TD)
%     12/26/02 - Added UserData and UPDATE option (TD)
    %     11/16/02 - Added more named colors, color code prefix,
    %                global ColorOrder, ALPHA , and BETA (TD)
    %     10/12/02 - Added global LineWidthOrder,
    %                vectorized W, H and IP (TD)
    %     10/05/02 - Changed CLF to CLA for subplot support,
    %                added ColorOrder and LineStyleOrder support (TD)
    %     04/27/02 - Minor log plot revisions (TD)
%     03/26/02 - Added log plot support (TD)
    %     03/24/02 - Adaptive grid spacing control to trade off
%                appearance vs. speed based on size of matrix (JC)
    %     03/16/02 - Added &amp;quot;axis tight&amp;quot; for improved appearance (JC)
    %     03/12/02 - Added initial point marker (TD)
%     03/03/02 - Added aspect ratio support (TD)
    %     03/02/02 - Enhanced program&#39;s user friendliness (JC)
    %                (lump Color, LineStyle, and LineWidth together)
%     03/01/02 - Replaced call to ROTATE (TD)
    %     02/28/02 - Modified line plotting,
    %                added linewidth and linestyle (TD)
    %     02/27/02 - Minor enhancements on 3D appearance (JC)
    %     02/26/02 - Minor enhancements for speed (TD&amp;amp;JC)
%     02/26/02 - Optimize PLOT3 and SURF for speed (TD)
    %     02/25/02 - Return handler, error handling, color effect,
    %                generalize for 2D/3D vectors (JC)
    %     02/24/02 - Optimize PLOT3 and SURF for speed (TD)
%     02/23/02 - First release (JC&amp;amp;TD)

    %-------------------------------------------------------------------------
    % Error Checking
    global LineWidthOrder ColorOrder
    if nargin&amp;lt;8 || isempty(beta), beta=0.4; end
    beta=abs(beta(1)); if nargout, hn=[]; end
    if strcmpi(p1,&#39;colors&#39;)                            % plot color table
    if nargin&amp;gt;1, beta=abs(p2(1)); end
    LocalColorTable(1,beta); return
    end
    fig=gcf; ax=gca;
    if strcmpi(p1,&#39;update&#39;), ud=get(ax,&#39;UserData&#39;);    % update
    LocalLogCheck(ax);
    if size(ud,2)&amp;lt;13, error(&#39;Invalid UserData&#39;), end
    set(ax,&#39;UserData&#39;,[]); sf=[1,1,1]; flag=0;
    if nargin&amp;gt;1
    if strcmpi(p2,&#39;colors&#39;), flag=1;               % update colors
    elseif ~isempty(p2)                            % update surfaces
    sf=p2(1)*sf; n=length(p2(:));
    if n&amp;gt;1, sf(2)=p2(2); if n&amp;gt;2, sf(3)=p2(3); end, end
    end
    end
    H=LocalUpdate(fig,ax,ud,sf,flag); if nargout, hn=H; end, return
    end
    InputError=[&#39;Invalid input, type HELP &#39;,upper(mfilename),...
    &#39; for usage examples&#39;];
    if nargin&amp;lt;2, error(InputError), end
    [r1,c1]=size(p1); [r2,c2]=size(p2);
    if c1&amp;lt;2 || c1&amp;gt;3 || r1*r2==0, error(InputError), end
    if r1~=r2, error(&#39;P1 and P2 must have same number of rows&#39;), end
    if c1~=c2, error(&#39;P1 and P2 must have same number of columns&#39;), end
    p=sum(abs(p2-p1),2)~=0; cone=0;
    if nargin&amp;gt;5 &amp;amp;&amp;amp; ~isempty(ip) &amp;amp;&amp;amp; strcmpi(ip,&#39;cone&#39;)  % cone plot
    cone=1; p=sum(p2,2)~=0;
    if ~any(p), error(&#39;P2 cannot equal 0&#39;), end
    set(ax,&#39;tag&#39;,&#39;Arrow3ConePlot&#39;);
    elseif ~any(p), error(&#39;P1 cannot equal P2&#39;)
    end
if ~all(p)
    warning(&#39;Arrow3:ZeroMagnitude&#39;,&#39;Zero magnitude ignored&#39;)
    p1=p1(p,:); p2=p2(p,:); [r1,c1]=size(p1);
    end
    n=r1; Zeros=zeros(n,1);
    if c1==2, p1=[p1,Zeros]; p2=[p2,Zeros];
    elseif ~any([p1(:,3);p2(:,3)]), c1=2; end
    L=get(ax,&#39;LineStyleOrder&#39;); C=get(ax,&#39;ColorOrder&#39;);
    ST=get(ax,&#39;DefaultSurfaceTag&#39;); LT=get(ax,&#39;DefaultLineTag&#39;);
    EC=get(ax,&#39;DefaultSurfaceEdgeColor&#39;);
    if strcmp(get(ax,&#39;nextplot&#39;),&#39;add&#39;) &amp;amp;&amp;amp; strcmp(get(fig,&#39;nextplot&#39;),&#39;add&#39;)
    Xr=get(ax,&#39;xlim&#39;); Yr=get(ax,&#39;ylim&#39;); Zr=get(ax,&#39;zlim&#39;);
    [xs,ys,xys]=LocalLogCheck(ax); restore=1;
    if xys, mode=&#39;auto&#39;;
    if any([p1(:,3);p2(:,3)]), error(&#39;3D log plot not supported&#39;), end
    if (xs &amp;amp;&amp;amp; ~all([p1(:,1);p2(:,1)]&amp;gt;0)) || ...
    (ys &amp;amp;&amp;amp; ~all([p1(:,2);p2(:,2)]&amp;gt;0))
    error(&#39;Nonpositive log data not supported&#39;)
    end
    else mode=&#39;manual&#39;;
    if strcmp(get(ax,&#39;WarpToFill&#39;),&#39;on&#39;)
    warning(&#39;Arrow3:WarpToFill&#39;,[&#39;Stretch-to-fill scaling not &#39;,...
            &#39;supported;\nuse DASPECT or PBASPECT before calling ARROW3.&#39;]);
    end
    end
    set(ax,&#39;XLimMode&#39;,mode,&#39;YLimMode&#39;,mode,&#39;ZLimMode&#39;,mode,...
            &#39;CLimMode&#39;,&#39;manual&#39;);
    else restore=0; cla reset; xys=0; set(fig,&#39;nextplot&#39;,&#39;add&#39;);
    if c1==2, azel=[0,90]; else azel=[-37.5,30]; end
    set(ax,&#39;UserData&#39;,[],&#39;nextplot&#39;,&#39;add&#39;,&#39;View&#39;,azel);
    end

    %-------------------------------------------------------------------------
    % Style Control
    [vc,cn]=LocalColorTable(0); prefix=&#39;&#39;; OneColor=0;
    if nargin&amp;lt;3, [c,ls,lw]=LocalValidateCLSW;% default color, linestyle/width
    else 
    [c,ls,lw]=LocalValidateCLSW(s);
    if length(c)&amp;gt;1, if sum(&#39;_^&#39;==c(1)), prefix=c(1); end, c=c(2); end
    if c==&#39;x&#39;                              % random named color (less white)
    [ignore,i]=sort(rand(1,23)); c=cn(i,:);        %#ok
    elseif c==&#39;o&#39;                                    % ColorOrder
if length(ColorOrder)
    [c,failed]=LocalColorMap(lower(ColorOrder),vc,cn,beta);
    if failed, ColorOrderWarning=[&#39;Invalid ColorOrder &#39;,...
    &#39;variable, current ColorOrder property will be used&#39;];
    warning(&#39;Arrow3:ColorOrder&#39;,ColorOrderWarning)
    else C=c;
    end
    end, c=C;
    elseif c==&#39;|&#39;, map=get(fig,&#39;colormap&#39;);          % magnitude coloring
    M=(p1-p2); M=sqrt(sum(M.*M,2)); minM=min(M); maxM=max(M);
    if maxM-minM&amp;lt;1, minM=0; end
    set(ax,&#39;clim&#39;,[minM,maxM]); c=LocalInterp(minM,maxM,map,M);
    elseif ~sum(vc==c), c=&#39;k&#39;; ColorWarning=[&#39;Invalid color switch, &#39;,...
    &#39;default color (black) will be used&#39;];
    warning(&#39;Arrow3:Color&#39;,ColorWarning)
    end
    end
    if length(c)==1                                    % single color
    c=LocalColorMap([prefix,c],vc,cn,beta); OneColor=1;
    end
    set(ax,&#39;ColorOrder&#39;,c); c=LocalRepmat(c,[ceil(n/size(c,1)),1]);
    if ls~=&#39;*&#39;, set(ax,&#39;LineStyleOrder&#39;,ls); end       % LineStyleOrder
    if lw==&#39;/&#39;                                         % LineWidthOrder
if length(LineWidthOrder)
    lw=LocalRepmat(LineWidthOrder(:),[ceil(n/length(LineWidthOrder)),1]);
    else lw=0.5; LineWidthOrderWarning=[&#39;Undefined LineWidthOrder, &#39;,...
    &#39;default width (0.5) will be used&#39;];
    warning(&#39;Arrow3:LineWidthOrder&#39;,LineWidthOrderWarning)
    end
    end
    if nargin&amp;lt;4 || isempty(w), w=1; end                % width
    w=LocalRepmat(abs(w(:)),[ceil(n/length(w)),1]);
    if nargin&amp;lt;5 || isempty(h), h=3*w; end              % height
    h=LocalRepmat(abs(h(:)),[ceil(n/length(h)),1]);
    if nargin&amp;gt;5 &amp;amp;&amp;amp; ~isempty(ip) &amp;amp;&amp;amp; ~cone               % ip
    ip=LocalRepmat(ip(:),[ceil(n/length(ip)),1]);
    i=find(ip==0); ip(i)=w(i);
    else ip=-ones(n,1);
    end
    if nargin&amp;lt;7 || isempty(alpha), alpha=1; end
    a=LocalRepmat(alpha(:),[ceil(n/length(alpha)),1]); % FaceAlpha

    %-------------------------------------------------------------------------
    % Log Plot
    if xys
    units=get(ax,&#39;units&#39;); set(ax,&#39;units&#39;,&#39;points&#39;);
    pos=get(ax,&#39;position&#39;); set(ax,&#39;units&#39;,units);
    if strcmp(get(ax,&#39;PlotBoxAspectRatioMode&#39;),&#39;auto&#39;)
    set(ax,&#39;PlotBoxAspectRatio&#39;,[pos(3),pos(4),1]);
    end
    par=get(ax,&#39;PlotBoxAspectRatio&#39;);
    set(ax,&#39;DataAspectRatio&#39;,[par(2),par(1),par(3)]);
    % map coordinates onto unit square
    q=[p1;p2]; xr=Xr; yr=Yr;
    if xs, xr=log10(xr); q(:,1)=log10(q(:,1)); end
    if ys, yr=log10(yr); q(:,2)=log10(q(:,2)); end
    q=q-LocalRepmat([xr(1),yr(1),0],[2*n,1]);
    dx=xr(2)-xr(1); dy=yr(2)-yr(1);
    q=q*diag([1/dx,1/dy,1]);
    q1=q(1:n,:); q2=q(n+1:end,:);
    else xs=0; ys=0; dx=0; dy=0; xr=0; yr=0;
    end

    %-------------------------------------------------------------------------
    % Line
    if ~cone
    set(ax,&#39;DefaultLineTag&#39;,&#39;arrow3&#39;);
    if length(lw)==1
    if lw&amp;gt;0
    if OneColor &amp;amp;&amp;amp; ls(end)~=&#39;*&#39; &amp;amp;&amp;amp; n&amp;gt;1 % single color, linestyle/width
    P=zeros(3*n,3); i=1:n;
    P(3*i-2,:)=p1(i,:); P(3*i-1,:)=p2(i,:); P(3*i,1)=NaN;
    H1=plot3(P(:,1),P(:,2),P(:,3),&#39;LineWidth&#39;,lw);
    else                               % single linewidth
    H1=plot3([p1(:,1),p2(:,1)]&#39;,[p1(:,2),p2(:,2)]&#39;,...
            [p1(:,3),p2(:,3)]&#39;,&#39;LineWidth&#39;,lw);
    end
    else H1=[];
    end
    else                                   % use LineWidthOrder
    ls=LocalRepmat(cellstr(L),[ceil(n/size(L,1)),1]);
    H1=Zeros;
    for i=1:n
    H1(i)=plot3([p1(i,1),p2(i,1)],[p1(i,2),p2(i,2)],...
            [p1(i,3),p2(i,3)],ls{i},&#39;Color&#39;,c(i,:),&#39;LineWidth&#39;,lw(i));
    end
    end
    else                                     % cone plot
    P=zeros(3*n,3); i=1:n;
    P(3*i-2,:)=p1(i,:); P(3*i-1,:)=p1(i,:); P(3*i,1)=NaN;
    H1=plot3(P(:,1),P(:,2),P(:,3));
    end

    %-------------------------------------------------------------------------
    % Scale
    if ~restore, axis tight, end
    ar=get(ax,&#39;DataAspectRatio&#39;); ar=sqrt(3)*ar/norm(ar);
    set(ax,&#39;DataAspectRatioMode&#39;,&#39;manual&#39;);
    if xys, sf=1;
    else xr=get(ax,&#39;xlim&#39;); yr=get(ax,&#39;ylim&#39;); zr=get(ax,&#39;zlim&#39;);
    sf=norm(diff([xr;yr;zr],1,2)./ar&#39;)/72;
    end

    %-------------------------------------------------------------------------
    % UserData
    c=c(1:n,:); w=w(1:n); h=h(1:n); ip=ip(1:n); a=a(1:n);
    set(ax,&#39;UserData&#39;,[get(ax,&#39;UserData&#39;);p1,p2,c,w,h,ip,a]);

    %-------------------------------------------------------------------------
    % Arrowhead
    whip=sf*[w,h,ip];
    if xys, whip=whip*sqrt(2)/72; p1=q1; p2=q2; end
    w=whip(:,1); h=whip(:,2); ip=whip(:,3);
    if cone                                            % cone plot
    delete(H1), H1=[];
    p2=p2./LocalRepmat(sqrt(sum(p2.*p2,2)),[1,3]);
    p2=p1+p2.*LocalRepmat(ar,[n,1]).*LocalRepmat(h,[1,3]);
    end
    W=(p1-p2)./LocalRepmat(ar,[n,1]);
    W=W./LocalRepmat(sqrt(sum(W.*W,2)),[1,3]);         % new z direction
    U=[-W(:,2),W(:,1),Zeros];
    N=sqrt(sum(U.*U,2)); i=find(N&amp;lt;eps); j=length(i);
    U(i,:)=LocalRepmat([1,0,0],[j,1]); N(i)=ones(j,1);
    U=U./LocalRepmat(N,[1,3]);                         % new x direction
    V=[W(:,2).*U(:,3)-W(:,3).*U(:,2),...               % new y direction
    W(:,3).*U(:,1)-W(:,1).*U(:,3),...
    W(:,1).*U(:,2)-W(:,2).*U(:,1)];

    m=20;                               % surface grid spacing
    set(ax,&#39;DefaultSurfaceTag&#39;,&#39;arrow3&#39;,&#39;DefaultSurfaceEdgeColor&#39;,&#39;none&#39;);
    r=[0;1]; theta=(0:m)/m*2*pi; Ones=ones(1,m+1);
    x=r*cos(theta); y=r*sin(theta); z=r*Ones;
    G=surface(x/2,y/2,z); dar=diag(ar);
    X=get(G,&#39;XData&#39;); Y=get(G,&#39;YData&#39;); Z=get(G,&#39;ZData&#39;);
    H2=Zeros; [j,k]=size(X);
    for i=1:n                           % translate, rotate, and scale
    H2(i)=copyobj(G,ax);
    xyz=[w(i)*X(:),w(i)*Y(:),h(i)*Z(:)]*[U(i,:);V(i,:);W(i,:)]*dar;
    x=reshape(xyz(:,1),j,k)+p2(i,1);
    y=reshape(xyz(:,2),j,k)+p2(i,2);
    z=reshape(xyz(:,3),j,k)+p2(i,3);
    LocalSetSurface(xys,xs,ys,dx,dy,xr,yr,...
            x,y,z,a(i),c(i,:),H2(i),2,m+1);
    end
    delete(G);

    %-------------------------------------------------------------------------
    % Initial Point Marker
if any(ip&amp;gt;0)
    theta=(-m:2:m)/m*pi; phi=(-m:2:m)&#39;/m*pi/2; cosphi=cos(phi);
    x=cosphi*cos(theta); y=cosphi*sin(theta); z=sin(phi)*Ones;
    G=surface(x*ar(1)/2,y*ar(2)/2,z*ar(3)/2);
    X=get(G,&#39;XData&#39;); Y=get(G,&#39;YData&#39;); Z=get(G,&#39;ZData&#39;);
    H3=zeros(n,1);
    for i=1:n                                        % translate
    if ip(i)&amp;gt;0
    H3(i)=copyobj(G,ax);
    x=p1(i,1)+X*ip(i); y=p1(i,2)+Y*ip(i); z=p1(i,3)+Z*ip(i);
    LocalSetSurface(xys,xs,ys,dx,dy,xr,yr,...
            x,y,z,a(i),c(i,:),H3(i),m+1,m+1);
    end
    end, delete(G);
    else H3=[];
    end

    %-------------------------------------------------------------------------
    % Finish
    if restore, xr=Xr; yr=Yr; zr=Zr;
    if xys, set(ax,&#39;DataAspectRatioMode&#39;,&#39;auto&#39;); end
    else
    axis tight
    xr=get(ax,&#39;xlim&#39;); yr=get(ax,&#39;ylim&#39;); zr=get(ax,&#39;zlim&#39;);
    set(ax,&#39;nextplot&#39;,&#39;replace&#39;);
    end
    azel=get(ax,&#39;view&#39;);
    if abs(azel(2))==90, renderer=&#39;ZBuffer&#39;; else renderer=&#39;OpenGL&#39;; c1=3; end
    set(fig,&#39;Renderer&#39;,renderer);
    set(ax,&#39;LineStyleOrder&#39;,L,&#39;ColorOrder&#39;,C,&#39;DefaultLineTag&#39;,LT,...
            &#39;DefaultSurfaceTag&#39;,ST,&#39;DefaultSurfaceEdgeColor&#39;,EC,...
            &#39;xlim&#39;,xr,&#39;ylim&#39;,yr,&#39;zlim&#39;,zr,&#39;clim&#39;,get(ax,&#39;CLim&#39;));
    if c1==3, set(ax,&#39;CameraViewAngle&#39;,get(ax,&#39;CameraViewAngle&#39;),...
            &#39;PlotBoxAspectRatio&#39;,get(ax,&#39;PlotBoxAspectRatio&#39;));
    end
    if nargout, hn=[H1(:);H2(:);H3(:)]; end

    %-------------------------------------------------------------------------
    % Local Functions
    %-------------------------------------------------------------------------
    % Update
function H=LocalUpdate(fig,ax,ud,sf,flag)
    global ColorOrder
    p1=ud(:,1:3); p2=ud(:,4:6); c=ud(:,7:9); a=ud(:,13);
    w=sf(1)*ud(:,10); h=sf(2)*ud(:,11); ip=sf(3)*ud(:,12);
    H=get(ax,&#39;children&#39;); tag=get(H,&#39;tag&#39;); type=get(H,&#39;type&#39;);
    delete(H(strcmp(tag,&#39;arrow3&#39;) &amp;amp; strcmp(type,&#39;surface&#39;)));
    set(fig,&#39;nextplot&#39;,&#39;add&#39;); set(ax,&#39;nextplot&#39;,&#39;add&#39;); H1=[];
    if flag, map=get(fig,&#39;colormap&#39;);                  % update colors
    M=(p1-p2); M=sqrt(sum(M.*M,2)); minM=min(M); maxM=max(M);
    H1=H(strcmp(tag,&#39;arrow3&#39;) &amp;amp; strcmp(type,&#39;line&#39;));
    MagnitudeWarning=[&#39;Cannot perform magnitude coloring on lines &#39;,...
    &#39;that\nwere drawn with a single color, linestyle, and linewidth&#39;];
    if length(H1)&amp;gt;1
    for i=1:length(H1)                             % update line colors
    x=get(H1(i),&#39;xdata&#39;); y=get(H1(i),&#39;ydata&#39;); z=get(H1(i),&#39;zdata&#39;);
    if length(x)&amp;gt;2                               % multiple lines
    warning(&#39;Arrow3:Magnitude&#39;,MagnitudeWarning), continue
    end
    m=sqrt((x(1)-x(2))^2+(y(1)-y(2))^2+(z(1)-z(2))^2);
    c=LocalInterp(minM,maxM,map,m); set(H1(i),&#39;color&#39;,c);
    end
    elseif length(H1)==1
    warning(&#39;Arrow3:Magnitude&#39;,MagnitudeWarning)
    end
    c=LocalInterp(minM,maxM,map,M);
    end
    set(ax,&#39;ColorOrder&#39;,c);                            % update surfaces
    ColorOrder=[];
    if strcmp(get(ax,&#39;tag&#39;),&#39;Arrow3ConePlot&#39;)
    H=arrow3(p1,p2,&#39;o&#39; ,w,h,&#39;cone&#39;,a);            % update cones
    else H=arrow3(p1,p2,&#39;o0&#39;,w,h,    ip,a);
    end, H=[H1(:);H(:)];
    set(ax,&#39;nextplot&#39;,&#39;replace&#39;);

    %-------------------------------------------------------------------------
    % SetSurface
function LocalSetSurface(xys,xs,ys,dx,dy,xr,yr,x,y,z,a,c,H,n,m)
    if xys
    x=x*dx+xr(1); y=y*dy+yr(1);
    if xs, x=10.^x; end
    if ys, y=10.^y; end
    end
    cd=zeros(n,m,3); cd(:,:,1)=c(1); cd(:,:,2)=c(2); cd(:,:,3)=c(3);
    set(H,&#39;XData&#39;,x,&#39;YData&#39;,y,&#39;ZData&#39;,z,&#39;CData&#39;,cd,&#39;FaceAlpha&#39;,a);

    %-------------------------------------------------------------------------
    % ColorTable
function [vc,cn]=LocalColorTable(n,beta)
    vc=&#39;kymcrgbadefhijlnpqstuvzw&#39;;                     % valid color codes
    %                k               y               m               c
    cn=[0.00,0.00,0.00; 1.00,1.00,0.00; 1.00,0.00,1.00; 0.00,1.00,1.00;
    %                r               g               b               a
    1.00,0.00,0.00; 0.00,1.00,0.00; 0.00,0.00,1.00; 0.42,0.59,0.24;
    %                d               e               f               h
    0.25,0.25,0.25; 0.00,0.50,0.00; 0.70,0.13,0.13; 1.00,0.41,0.71;
    %                i               j               l               n
    0.29,0.00,0.51; 0.00,0.66,0.42; 0.50,0.50,0.50; 0.50,0.20,0.00;
    %                p               q               s               t
    0.75,0.75,0.00; 1.00,0.50,0.00; 0.00,0.75,0.75; 0.80,0.34,0.00;
    %                u               v               z               w
    0.50,0.00,0.13; 0.75,0.00,0.75; 0.38,0.74,0.99; 1.00,1.00,1.00];

% Named Simulink Colors (zaql)
    % LightBlue = 0.38  0.74  0.99 = aZure
    % DarkGreen = 0.42  0.59  0.24 = Asparagus
    % Orange    = 1.00  0.50  0.00 = kumQuat
    % Gray      = 0.50  0.50  0.50 = Light gray
    %
% Default ColorOrder Property Colors (bersvpd)
    % Color1    = 0.00  0.00  1.00 = Blue
    % Color2    = 0.00  0.50  0.00 = Evergreen
    % Color3    = 1.00  0.00  0.00 = Red
    % Color4    = 0.00  0.75  0.75 = Sky blue
    % Color5    = 0.75  0.00  0.75 = Violet
    % Color6    = 0.75  0.75  0.00 = Pear
    % Color7    = 0.25  0.25  0.25 = Dark gray

    if n, clf reset                                    % plot color table
    name={&#39;blacK&#39;,&#39;Yellow&#39;,&#39;Magenta&#39;,&#39;Cyan&#39;,...
        &#39;Red&#39;,&#39;Green&#39;,&#39;Blue&#39;,&#39;Asparagus&#39;,...
            &#39;Dark gray&#39;,&#39;Evergreen&#39;,&#39;Firebrick&#39;,&#39;Hot pink&#39;,...
            &#39;Indigo&#39;,&#39;Jade&#39;,&#39;Light gray&#39;,&#39;Nutbrown&#39;,...
            &#39;Pear&#39;,&#39;kumQuat&#39;,&#39;Sky blue&#39;,&#39;Tawny&#39;,...
            &#39;bUrgundy&#39;,&#39;Violet&#39;,&#39;aZure&#39;,&#39;White&#39;};
c=[&#39;yptn&#39;;&#39;gjae&#39;;&#39;czsb&#39;;&#39;hmvi&#39;;&#39;qrfu&#39;;&#39;wldk&#39;];
set(gcf,&#39;DefaultAxesXTick&#39;,[],&#39;DefaultAxesYTick&#39;,[],...
        &#39;DefaultAxesXTickLabel&#39;,[],&#39;DefaultAxesYTickLabel&#39;,[],...
        &#39;DefaultAxesXLim&#39;,[0,0.75],&#39;DefaultAxesYLim&#39;,[0,0.75],...
        &#39;DefaultRectangleEdgeColor&#39;,&#39;none&#39;);
for i=1:24, subplot(4,6,i); box on
j=find(vc==c(i)); title(name{j});
dark=LocalBrighten(cn(j,:),-beta);
light=LocalBrighten(cn(j,:),beta);
rectangle(&#39;Position&#39;,[0,0.00,0.75,0.25],&#39;FaceColor&#39;,dark);
rectangle(&#39;Position&#39;,[0,0.25,0.75,0.25],&#39;FaceColor&#39;,cn(j,:));
rectangle(&#39;Position&#39;,[0,0.50,0.75,0.25],&#39;FaceColor&#39;,light);
rectangle(&#39;Position&#39;,[0,0.00,0.75,0.75],&#39;EdgeColor&#39;,&#39;k&#39;);
if rem(i,6)==1
set(gca,&#39;YTickLabel&#39;,{&#39;dark&#39;,&#39;normal&#39;,&#39;light&#39;},...
        &#39;YTick&#39;,[0.125,0.375,0.625]);
if i==19
text(0,-0.25,[&#39;{\bf\itARROW3}  Named Color Table  &#39;,...
        &#39;( \beta = &#39;,num2str(beta),&#39; )&#39;]);
end
end
end
end

%-------------------------------------------------------------------------
    % ColorMap
function [C,failed]=LocalColorMap(c,vc,cn,beta)
    n=length(c); failed=0; C=zeros(n,3); i=1; j=1;
    while 1
    if ~sum([vc,&#39;_^&#39;]==c(i)), failed=1; break, end
    if sum(&#39;_^&#39;==c(i))
    if i+1&amp;gt;n, failed=1; break, end
    if ~sum(vc==c(i+1)), failed=1; break, end
    cc=cn(vc==c(i+1),:); gamma=beta;
    if c(i)==&#39;_&#39;, gamma=-beta; end
    C(j,:)=LocalBrighten(cc,gamma); i=i+2;
    else C(j,:)=cn(vc==c(i),:); i=i+1;
    end
    if i&amp;gt;n, break, end, j=j+1;
    end
    if n&amp;gt;j, C(j+1:n,:)=[]; end

    %-------------------------------------------------------------------------
    % Brighten
function C=LocalBrighten(c,beta)
    if sum([c==0,c==1])==3 &amp;amp;&amp;amp; sum(c==0)&amp;lt;3 &amp;amp;&amp;amp; sum(c==1)&amp;lt;3
    if beta&amp;lt;0
    C=(1+beta)*c;
    else
    C=c;  C(C==0)=beta;
    end
    else
    C=c.^((1-min(1-sqrt(eps),abs(beta)))^sign(beta));
    end

    %-------------------------------------------------------------------------
    % Repmat
function B=LocalRepmat(A,siz)
    if length(A)==1, B(prod(siz))=A; B(:)=A; B=reshape(B,siz);
    else [m,n]=size(A); mind=(1:m)&#39;; nind=(1:n)&#39;;
    mind=mind(:,ones(1,siz(1))); nind=nind(:,ones(1,siz(2)));
    B=A(mind,nind);
    end

    %-------------------------------------------------------------------------
    % Interp
function v=LocalInterp(xmin,xmax,y,u)
    [m,n]=size(y); h=(xmax-xmin)/(m-1); p=length(u); v=zeros(p,n);
    k=min(max(1+floor((u-xmin)/h),1),m-1); s=(u-xmin)/h-k+1;
    for j=1:n, v(:,j)=y(k,j)+s.*(y(k+1,j)-y(k,j)); end
    v(v&amp;lt;0)=0; v(v&amp;gt;1)=1;

    %-------------------------------------------------------------------------
    % Check for supported log scales
function [xs,ys,xys]=LocalLogCheck(ax)
    xs=strcmp(get(ax,&#39;xscale&#39;),&#39;log&#39;);
    ys=strcmp(get(ax,&#39;yscale&#39;),&#39;log&#39;);
    zs=strcmp(get(ax,&#39;zscale&#39;),&#39;log&#39;);
    if zs, error(&#39;Z log scale not supported&#39;), end
    xys=xs+ys;
    if xys, azel=get(ax,&#39;view&#39;);
    if abs(azel(2))~=90, error(&#39;3D log plot not supported&#39;), end
    end

    %-------------------------------------------------------------------------
    % Generate valid value for color, linestyle and linewidth
function [c,ls,lw]=LocalValidateCLSW(s)
    if nargin&amp;lt;1, c=&#39;k&#39;; ls=&#39;-&#39;; lw=0.5;
    else
    % identify linestyle
    if findstr(s,&#39;--&#39;), ls=&#39;--&#39;; s=strrep(s,&#39;--&#39;,&#39;&#39;);
    elseif findstr(s,&#39;-.&#39;), ls=&#39;-.&#39;; s=strrep(s,&#39;-.&#39;,&#39;&#39;);
    elseif findstr(s,&#39;-&#39;), ls=&#39;-&#39;; s=strrep(s,&#39;-&#39;,&#39;&#39;);
    elseif findstr(s,&#39;:&#39;), ls=&#39;:&#39;; s=strrep(s,&#39;:&#39;,&#39;&#39;);
    elseif findstr(s,&#39;*&#39;), ls=&#39;*&#39;; s=strrep(s,&#39;*&#39;,&#39;&#39;);
    else ls=&#39;-&#39;;
    end

    % identify linewidth
    tmp=double(s);
    tmp=find(tmp&amp;gt;45 &amp;amp; tmp&amp;lt;58);
if length(tmp)
    if any(s(tmp)==&#39;/&#39;), lw=&#39;/&#39;; else lw=str2double(s(tmp)); end
    s(tmp)=&#39;&#39;;
    else lw=0.5;
    end

    % identify color
    if length(s), s=lower(s);
    if length(s)&amp;gt;1, c=s(1:2);
    else c=s(1); end
    else c=&#39;k&#39;;
    end
    end

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5&#34;&gt;5. 误差带&lt;/h2&gt;
    有时候可能输入平均值，和上下线误差，该程序比内置的errorbar更好用一些
&lt;pre&gt;&lt;code class=&#34;language-matlab&#34;&gt;function errorbare(sty,x,y,xbar,ybar,symbol)

    % ERRORBARE Enhanced Errorbar Function.
%   ERRORBARE(STY,X,Y,Xbar,Ybar,symbol) 
    %   It can draw errorbar along X/Y/Dual axis 
    %   in normal,semilog,loglog coordinate system,
    %   and adjust length of top line automatically,
    %   can also control dotstyle and color in the same way with errorbar.
    %
    %   If the lower and upper error range of x/y is different, they should be
    %   input as [lower,upper] if x/y is a column vector; 
    %   for a row vector, they should be [lower;uper].
    %
    %   parameter STY include 12 types: 
    %   v,h,d,vlogx,hlogx,dlogx,vlogy,hlogy,
    %       dlogy,vlogd,hlogd,dlogd 
    %   where
    %   v stands for vertical errorbar，
    %   h draws horizontal errorbar，
    %   d means dual direction,
    %   logx corresponding to semilogx，can use preffix v/h/d
    %   logy corresponding to semilogy，can use preffix v/h/d
    %   logd corresponding to loglog，can use preffix v/h/d

    %   误差棒函数增强版
%   ERRORBARE(STY,X,Y,Xbar,Ybar,symbol) 
    %   可在各个坐标系中沿X轴，Y轴方向，或者两轴方向绘制误差棒，
    %   能够根据所选坐标类型调整端点线长。
    %   增加对误差棒的线型控制，用法与原errorbar函数中相同
    %
    %   若上下限范围不同，X为列向量时应按照
    %   [下限,上限] 的格式输入，若为行向量则为 [下限;上限]
    %
    %   STY 参数包括 v,h,d,vlogx,hlogx,dlogx,vlogy,hlogy,
    %	dlogy,vlogd,hlogd,dlogd 共12种
    %   v 表示误差棒垂直，
    %   h 表示误差棒水平，
    %   d (dual) 显示双轴误差，
    %   logx 对应 semilogx，前缀 v,h,d 意义同上
    %   logy 对应 semilogy，前缀 v,h,d 意义同上
    %   logd 对应 loglog，前缀 v,h,d 意义同上

    %   For example,
    %	x = 1:10;
%	y = sin(x)+2;
%	e = std(y)*ones(size(x));
%	errorbare(x,y,e)	% use function &amp;quot;errorbar&amp;quot; directly
%	errorbare(x,y,e,&#39;or&#39;)
%	errorbare(&#39;v&#39;,x,y,e)	% &amp;quot;e&amp;quot; is error of &amp;quot;y&amp;quot;
%	errorbare(&#39;v&#39;,x,y,[e;2*e])  % try different error limits
%	errorbare(&#39;hlogx&#39;,x,y,e)    % &amp;quot;e&amp;quot; is error of &amp;quot;x&amp;quot; here，
%	errorbare(&#39;d&#39;,x,y,e,e)
%	errorbare(&#39;d&#39;,x,y,e,e,&#39;or&#39;)
%	errorbare(&#39;dlogd&#39;,x,y,e,e)
%
%   by Henry Sting  Email: henrysting@hotmail.com
%   $Revision: 1.2 $  $Date: 2010-2-8 $

lx=[];ux=[];ly=[];uy=[]; % 误差棒上下限
xl=[];xr=[];yl=[];yr=[]; % 端点短线左右限

if ~isstr(sty)
    if nargin == 3
errorbar(sty,x,y)
    return
    elseif nargin == 4
errorbar(sty,x,y,xbar)
    return
    elseif nargin &amp;gt; 4
    error(&#39;Please assign adopted coordinate system with symbol parameters.&#39;)
    end
    elseif isstr(sty)
if size(x)~=size(y)
    error(&#39;Coordinate array should be equal.&#39;)
    end
    if nargin == 4
    symbol=&#39;ob&#39;;
if length(x)~=length(xbar)
    error(&#39;Format of Xbar is illegal.&#39;)
    end
    if sty(1) == &#39;v&#39;
    ybar=xbar;xbar=[];
    elseif sty(1) == &#39;h&#39;
    ybar=[];
    elseif sty(1) == &#39;d&#39;
    error(&#39;Parameters are not enough.&#39;)
    else
    error(&#39;Symbol parameter is illegal.&#39;)
    end
elseif nargin == 5 &amp;amp; ~isstr(ybar)
    symbol=&#39;ob&#39;;
if length(x)~=length(xbar)
    error(&#39;Format of Xbar is illegal.&#39;)
elseif length(y)~=length(ybar)
    error(&#39;Format of Ybar is illegal.&#39;)
    end
elseif nargin == 5 &amp;amp; isstr(ybar)
    symbol=ybar;ybar=[];
if length(x)~=length(xbar)
    error(&#39;Format of Xbar is illegal.&#39;)
    end
    if sty(1) == &#39;v&#39;
    ybar=xbar;xbar=[];
    elseif sty(1) == &#39;h&#39;
    ybar=[];
    elseif sty(1) == &#39;d&#39;
    error(&#39;Parameters are not enough.&#39;)
    else
    error(&#39;Symbol parameter is illegal.&#39;)
    end
    elseif nargin == 6
if length(x)~=length(xbar)
    error(&#39;Format of Xbar is illegal.&#39;)
elseif length(y)~=length(ybar)
    error(&#39;Format of Ybar is illegal.&#39;)
    end
if ~isstr(symbol)
    error(&#39;Symbol should be string&#39;)
    end
    end
    end


    [ls,col,mark,msg] = colstyle(symbol); if ~isempty(msg), error(msg); end
    symbol = [ls mark col]; % Use marker only on data part
    esymbol = [&#39;-&#39; col]; % Make sure bars are solid


    % 转换为列距阵
    [a,b]=size(x);
    if a &amp;lt; b
    x=x&#39;;y=y&#39;;xbar=xbar&#39;;ybar=ybar&#39;;
    c=a;a=b;b=c;
    end

    %% 处理上下限不等
    [xa,xb]=size(xbar);
    if xb==1
    ux=xbar;lx=xbar; 
    elseif xb==2
    lx=xbar(:,1);ux=xbar(:,2);
    end

    [ya,yb]=size(ybar);
    if yb==1
    uy=ybar;ly=ybar; 
    elseif yb==2
    ly=ybar(:,1);uy=ybar(:,2);
    end

    %% 描点
    dx=(max(x(:))-min(x(:)))/100;
    dy=(max(y(:))-min(y(:)))/100;
    logn=10;
    if length(sty) == 1
    xl = x-dx; xr = x+dx; yl = y-dy; yr = y+dy; % 定义端点短线长度
    plot(x,y,symbol);hold on
    elseif length(sty) == 5 &amp;amp; sty(2:5) == &#39;logx&#39; 
    dx=(log(max(x(:)))-log(min(x(:))))/100;
    xl = x/logn^dx;xr = x*logn^dx;yl = y-dy; yr = y+dy; 
    semilogx(x,y,symbol);hold on
    elseif length(sty) == 5 &amp;amp; sty(2:5) == &#39;logy&#39; 
    dy=(log(max(y(:)))-log(min(y(:))))/100;
    yl = y/logn^dy;yr = y*logn^dy;xl = x-dx; xr = x+dx; 
    semilogy(x,y,symbol);hold on
    elseif length(sty) == 5 &amp;amp; sty(2:5) == &#39;logd&#39; 
    dx=(log(max(x(:)))-log(min(x(:))))/100;
    dy=(log(max(y(:)))-log(min(y(:))))/100;
    xl = x/logn^dx;xr = x*logn^dx; yl = y/logn^dy;yr = y*logn^dy;
    loglog(x,y,symbol);hold on
    end

    %% 纵向
    if sty(1) == &#39;v&#39; | sty(1) == &#39;d&#39;
    vx = zeros(a*9,b);
    vx(1:9:end,:) = x;
    vx(2:9:end,:) = x;
    vx(3:9:end,:) = NaN;
    vx(4:9:end,:) = xl;
    vx(5:9:end,:) = xr;
    vx(6:9:end,:) = NaN;
    vx(7:9:end,:) = xl;
    vx(8:9:end,:) = xr;
    vx(9:9:end,:) = NaN;

    vy = zeros(a*9,b);
    vy(1:9:end,:) = y-ly;
    vy(2:9:end,:) = y+uy;
    vy(3:9:end,:) = NaN;
    vy(4:9:end,:) = y-ly;
    vy(5:9:end,:) = y-ly;
    vy(6:9:end,:) = NaN;
    vy(7:9:end,:) = y+uy;
    vy(8:9:end,:) = y+uy;
    vy(9:9:end,:) = NaN;

    plot(vx,vy,esymbol,&#39;markersize&#39;,20)
    end
    %% 横向
    if sty(1) == &#39;h&#39; | sty(1) == &#39;d&#39;
    hx = zeros(a*9,b);
    hx(1:9:end,:) = x-lx;
    hx(2:9:end,:) = x+ux;
    hx(3:9:end,:) = NaN;
    hx(4:9:end,:) = x-lx;
    hx(5:9:end,:) = x-lx;
    hx(6:9:end,:) = NaN;
    hx(7:9:end,:) = x+ux;
    hx(8:9:end,:) = x+ux;
    hx(9:9:end,:) = NaN;

    hy = zeros(a*9,b);
    hy(1:9:end,:) = y;
    hy(2:9:end,:) = y;
    hy(3:9:end,:) = NaN;
    hy(4:9:end,:) = yl;
    hy(5:9:end,:) = yr;
    hy(6:9:end,:) = NaN;
    hy(7:9:end,:) = yl;
    hy(8:9:end,:) = yr;
    hy(9:9:end,:) = NaN;

    plot(hx,hy,esymbol,&#39;markersize&#39;,20)
    end
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;6&#34;&gt;6. 一种matlab编程配置写法&lt;/h2&gt;
&lt;p&gt;配置文件
Initial.db&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    0%%%%%%Configure
    0.01    
    0.99
    0.01
    0.99
    0%%%%%%getLine
    100
    15
    0
    30
    90
    50
    0%%%%%HSV
    0
    25
    170
    255
    30
    170
    30
    170
    0%%%%pile process cut
    100    %[100~200]
    0.8    %[0~1]
    0.73    %[0~1] 
    0.47   %[0~0.5]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/matlab/config.png&#34; alt=&#34;config&#34;&gt;
读取部分的核心部分，最终返回一个x_coordinate.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-matlab&#34;&gt;function [x_coordinate] = readConfTest(filename)
    RowNumber=getRowFromFile(filename); 
    f = fopen(filename) ; 
    tline = cell(1, RowNumber) ; 
    for i = 1 : RowNumber 
    tline{i} = fgetl(f);
    y = sscanf( tline{i} , &#39;%f&#39;) ;
    x_coordinate(i)=y;
    end

    end


function row=getRowFromFile(filename)
    fid=fopen(filename,&#39;rt&#39;); % t是告诉fread是这里文本文件
    row=1;
while ~feof(fid)
    % 一次性读取10000字符，计算其中的回车个数，其中10是回车的ASCII编码
    % &#39;*char&#39;表示每次读取一个字符，*表示输出也是字符
    % 放心fread现在已经可以自动识别中文了，万一还是识别不了，
    % 请在fopen中指定文件编码格式，比如gbk
    row=row+sum(fread(fid,10000,&#39;*char&#39;)==char(10));
    % 下面还有一个类似的方法，但是效率低很多，大概是上面的一半
    % &#39;char&#39;表示每次读取一个字符，但是默认输出double，
    % 也就是说读取char然后转换double中间有转换能快吗？
    % row=row+sum(fread(fid,10000,&#39;char&#39;)==10);
    end
    fclose(fid);
    %row=row+1;
    end

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;7&#34;&gt;7. Cell and array&lt;/h2&gt;
&lt;p&gt;a. 调用cell数据的方式是{} 区分于array（使用[]创建array）的()调用数组数据。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>prolog小结</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/07/19/prologxiao-jie/</link>
      <pubDate>Tue, 19 Jul 2016 18:41:13 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/07/19/prologxiao-jie/</guid>
      <description>&lt;p&gt;prolog编程工具: swi-prolog&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt; 1. cut-fail&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt; 2. prolog 相关链接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt; 3. prolog 调试&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt; 4. 可以尝试进行的主题阅读方式&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5&#34;&gt; 5. prolog基础知识点&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6&#34;&gt; 6. if-then-else的写法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7&#34;&gt; 7. DCS写法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#8&#34;&gt; 8. p99问题集&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#9&#34;&gt; 9. 几本不错的逻辑书籍&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#10&#34;&gt;10. 我购买的几本书籍&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;1&#34;&gt;1. cut-fail&lt;/h2&gt;
&lt;p&gt;结合The Science Of programming 和 Learn prolog now,觉得cut-fail的直觉应该如下：&lt;/p&gt;
&lt;p&gt;把proof development的过程和prolog的过程 结合起来！ 也就是cut-fail其实就是只进行内层的循环，而不跳出来，即内层执行完则结束。
参考TSOP P52 some general hints on developping proofs.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/prolog/someGeneral.png&#34; alt=&#34;TSOP&#34;&gt;&lt;/p&gt;
 &lt;h2 id=&#34;1&#34;&gt;2. prolog 相关链接&lt;/h2&gt;
&lt;p&gt;a. &lt;a href=&#34;http://www.swi-prolog.org/pldoc/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;swi-prolog&lt;/a&gt; . 注意SWI-Prolog比较强大的地方是开源，而且提供较多的libraries,提供较多的predicates.
b. &lt;a href=&#34;https://sicstus.sics.se/sicstus/docs/latest/html/sicstus.html/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;scisTus&lt;/a&gt; .   文档介绍得不错，不好的地方就是not free. 所以可以当作学习的地方。
c. &lt;a href=&#34;http://www.learnprolognow.org/lpnpage.php?pageid=online&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Learn Prolog Now!&lt;/a&gt;. 一个很好的入门教程 可以结合Leo Sterling的&lt;a href=&#34;https://github.com/konn/TAOP-Exercises&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;The art of prolog&lt;/a&gt;,和William F. ClockSin的Programming in Prolog(2003) 可以进一步查查&lt;a href=&#34;https://github.com/search?utf8=%E2%9C%93&amp;amp;q=Programming&amp;#43;in&amp;#43;Prolog&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github方向相关资料&lt;/a&gt;
d. &lt;a href=&#34;http://www.inf.ed.ac.uk/teaching/courses/aipp/#Lectures_&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Artificial Intelligence Programming in Prolog (AIPP)&lt;/a&gt;, EdinBurgh(prolog研究基地）的课程,内有很多pdf和ppt。
e. &lt;a href=&#34;https://github.com/samer--/prolog&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;samer_prolog&lt;/a&gt; 提供了很多的库，值得学习。
f. &lt;a href=&#34;http://www2.hawaii.edu/~nreed/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;learn prolog now课程&lt;/a&gt;.  附带一个&lt;a href=&#34;http://www.cnblogs.com/seaman-h-zhang/p/4615097.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;中文翻译&lt;/a&gt;.
g. &lt;a href=&#34;http://www.cse.unsw.edu.au/~billw/cs9414/notes/prolog/intro.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cs9414&lt;/a&gt;. INTRODUCTION TO PROLOG PROGRAMMING. 刚开始入门的就是它。
h. &lt;a href=&#34;http://www.cpp.edu/~jrfisher/www/prolog_tutorial/contents.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; J.R.Fisher 教程&lt;/a&gt;
j. 个人小介绍&lt;img src=&#34;https://jueqingsizhe66.github.io/images/prolog/introduction.png&#34; alt=&#34;introduction&#34;&gt;&lt;/p&gt;
 &lt;h2 id=&#34;1&#34;&gt;3. prolog 调试&lt;/h2&gt;
&lt;p&gt;a. trace  进行详细的跟踪，会call exit（正常退出） ，如果失败则fail，fail则会执行redo，直到exit或者fail退出。
b. notrace 使用notrace退出详细的跟踪。 类似的debug,nodebug.&lt;/p&gt;
&lt;p&gt;初始界面
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/prolog/swi-prolog-debug.png&#34; alt=&#34;initial&#34;&gt;&lt;/p&gt;
&lt;p&gt;添加predicate的trace
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/prolog/debug.png&#34; alt=&#34;trace&#34;&gt;&lt;/p&gt;
 &lt;h2 id=&#34;1&#34;&gt;4. 可以尝试进行的主题阅读方式&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
主题：Lists		Short Description: 一个经典的数据结构，其中的append/3将会用于differentiate lists中，进一步的运用于DCS(define clause statement)

The art of prolog(1986) Sterling and shapiro :	TAOP	
Learn Prolog Now Patrick Blackburn, Johan Bosand Kristina Striegnitz :	LPN	分两步讲解：1.Lists 2.More Lists(append reverse)
The Craft of Prolog Richard A.O Keefe  :	TCOP	
Adventure in Prolog(1990) Dennis Merriitt	AIP	
An Introduction to prolog programming (1990) Patrick Saint-Dizier	AITPP	
Prolog Verses you(1989) An Intouduction to logic Programming   A. -L. Johansson  A.Ericson-Granskog A.Edman	PVY	
Programming in prolog(2003) using ISO   Wiliam F. Clocksin ,Chrisopher S. Mellish	PIP	
Cases and effects  William F.clockSin(1997)	CAE	
Prolog the standard  P. DeranSart ,A.Eddbail, L. Cervoni	PTS	
Prolog and Natural-Language Analysis  Fernando C. N. Pereira and Stuart M. Shieber(1987)	PANLA	

&lt;/code&gt;&lt;/pre&gt;
 &lt;h2 id=&#34;5&#34;&gt;5. prolog基础知识点&lt;/h2&gt;
&lt;p&gt;a. cd(&amp;lsquo;路径&amp;rsquo;).
路径是你的文件系统路径。
b. pwd.     &lt;br&gt;
可以显示当前所在的路径。
c. [main]   &lt;br&gt;
其实相当于会去查询当前目录下的main.pl并把它加载进来(类似于consult(&amp;lsquo;路径/main.pl&amp;rsquo;).)，可以调用main里头的所有的predicates。
当然在文件内也可以写为：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-prolog&#34;&gt;:- [main].
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;d. file_search_path(demo,&amp;lsquo;路径&amp;rsquo;)
demo可以是任何的字符串，路径写对了，以后想要访问路径下的文件只需要&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-prolog&#34;&gt;:- [demo(文件名)].
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;6&#34;&gt;6. if-then-else的写法：&lt;/h2&gt;
  (A -&gt; B; C).   如果A成立则执行B，忽略C，如果A不成立，则执行C，忽略B.
 &lt;h2 id=&#34;7&#34;&gt;7. DCS写法&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-prolog&#34;&gt;
s --&amp;gt; simple_s,conj,simple_s.
s --&amp;gt; simple_s.
simple_s --&amp;gt; np(subject), vp.
np(_) --&amp;gt; det, n;det,adjectives,n.
np(X) --&amp;gt; pro(X).
vp --&amp;gt; v, np(object).
vp --&amp;gt; v.
det --&amp;gt; [the].
det --&amp;gt; [a].
n --&amp;gt; [woman].
n --&amp;gt; [man].
v --&amp;gt; [shoots].
adjectives --&amp;gt; adjective.
adjectives --&amp;gt; adjective,adjective.
adjective --&amp;gt; [young].
adjective --&amp;gt; [beautiful].
adjective --&amp;gt; [sunshine].
adjective --&amp;gt; [lovely].
adjective --&amp;gt; [sweet].
adjective --&amp;gt; [handsome].
pro(subject) --&amp;gt; [he].
pro(subject) --&amp;gt; [she].
pro(subject) --&amp;gt; [i].
pro(object) --&amp;gt; [him].
pro(object) --&amp;gt; [her].
pro(object) --&amp;gt; [me].

conj --&amp;gt; [and].
conj --&amp;gt; [or].
conj --&amp;gt; [but].
conj --&amp;gt; [so].


&lt;/code&gt;&lt;/pre&gt;
 &lt;h2 id=&#34;8&#34;&gt;8. [p99问题集][8].&lt;/h2&gt;
&lt;p&gt;编程界面&lt;img src=&#34;https://jueqingsizhe66.github.io/images/prolog/view.png&#34; alt=&#34;view&#34;&gt;和编程想法:多文件多库编程，最好还是类似搭积木的过程。&lt;/p&gt;
 &lt;h2 id=&#34;9&#34;&gt;9. 几本不错的逻辑书籍&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;A Discipline of Programming (Edsgar Dijkstar写的书，较难懂）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The-Science-Of-Programming（Edsgar Dijkstar 替作者Gries写了书评较基础  是1的简化并加入了很多例子）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Heijenoort.From Frege to Godel.A Source Book in Mathematical Logic_ 1879-1931. 类似于上面的数学逻辑。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;10&#34;&gt;10. 我购买的几本书籍&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/07/19/da-yin-de-shu-ji-prolog-plus-scheme-plus-kong-qi-dong-li-xue-fang-mian/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;书籍&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>能真正教会你编程能力的是重写</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/04/15/neng-zhen-zheng-jiao-hui-ni-bian-cheng-neng-li-de-shi-zhong-xie/</link>
      <pubDate>Fri, 15 Apr 2016 21:50:10 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/04/15/neng-zhen-zheng-jiao-hui-ni-bian-cheng-neng-li-de-shi-zhong-xie/</guid>
      <description>&lt;p&gt;写了很多的matlab，感觉就那样！
编了那么多数值fortran代码，也不见自己编程有多厉害！
练了那么多的java项目，也感觉自己的技术还不见飞涨！
用c语言摸索了好几年，也没见得有太深的见地！&lt;/p&gt;
&lt;p&gt;真正决定你对程序的深入理解，需要你去认识&lt;a href=&#34;http://www.eopl3.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;EOPL&lt;/a&gt;或者&lt;a href=&#34;https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-4.html#%25_toc_start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SICP&lt;/a&gt;，亦或者更简单的&lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BTLS/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TLS&lt;/a&gt;.
他们也许不能教你们做大的项目，却真切教会你编写程序，思考程序。&lt;/p&gt;
&lt;p&gt;回想起之前写的java项目，反反复复就为了构造一门解释器语言，用来输送数据到数据库进行操作，不断
在中间进行验证，保证传递数据的有效性，为了搭上这样的一个平台，反复重构了代码，采用了新技术，
不断采用接口来抽象，割分具体的关系，防止数据的污染。&lt;/p&gt;
&lt;p&gt;而这样做是为何？ 我之前没理解，后来做了一阶段程序语言设计方面的工作，写了多个解释器之后，我才发现总是基于
存在（任意）某一变量某一程序供你使用，你的目的就是使用这个程序或者变量来实现他的能力！然而为了懒惰，
你创建了很多工具（其实，应该是重构，重写）来不断让你的写的东西少点，同时能够达到更多的功能。&lt;/p&gt;
&lt;p&gt;这过程不好经历，也不好做，很多人也很少做，有些人不需要做，更多人没想做。大部分的企业级程序也不会教你去实现这一过程，
也不会跟你从程序理论去介绍。架空程序理论，完成一系列的工程项目成为了很多人编程的主要目的。减少深入思考的时间，
追逐敏捷性编程方式，忽略了闲暇的编程时间，一味着实现需求，个人感觉不是一个好的归宿、目的、追求，但却是一种好的生活手段、工作方式、效率实现。&lt;/p&gt;
&lt;p&gt;编程在我眼里是慢工出细活，所谓的快速开发的提出，我就不好奇，因为我不合适它。真正能够进一步提供自己对于写过程序理解，应该要自己能够写出一个解释器解释你写的程序，这个可以体现在&lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BTLS/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TLS&lt;/a&gt;,  &lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BTSS/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TSS&lt;/a&gt;  &lt;a href=&#34;http://www.eopl3.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;EOPL&lt;/a&gt;,  &lt;a href=&#34;https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-4.html#%25_toc_start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SICP&lt;/a&gt;等。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;let解释器&lt;/li&gt;
&lt;li&gt;letrec解释器&lt;/li&gt;
&lt;li&gt;proc解释器&lt;/li&gt;
&lt;li&gt;state解释器&lt;/li&gt;
&lt;li&gt;cps解释器&lt;/li&gt;
&lt;li&gt;type解释器&lt;/li&gt;
&lt;li&gt;oo解释器&lt;/li&gt;
&lt;li&gt;typeoo解释器&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>Ubuntu15.10-32bit-安装FastV8.15</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/04/15/ubuntu15-dot-10-32bit-an-zhuang-fastv8-dot-15/</link>
      <pubDate>Fri, 15 Apr 2016 14:46:04 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/04/15/ubuntu15-dot-10-32bit-an-zhuang-fastv8-dot-15/</guid>
      <description>&lt;p&gt;Fast8.15在4-15又发布了新版本，增加了相关功能，具体参考&lt;a href=&#34;https://nwtc.nrel.gov/FAST8&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FastV8.15&lt;/a&gt;.
下面就32bit ubuntu机子的安装过程做简要记录。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;运行fast源文件下的Compling 的makefile&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;gfortran: error: ../bin/libmap-1.20.10.so: 没有那个文件或目录
makefile:733: recipe for target &#39;../bin/FAST_glin32&#39; failed
make:  [../bin/FAST_glin32] Error 1

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;直接运行make，缺少libmap,可以参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/10/22/fast-in-ubuntu64bit-bian-yi-zhu-yi-shi-xiang/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;fast安装&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;安装LibMap&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;把libMap-1的Compling底下的driver_makefile修改一下你的FAST本地路径。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#FAST_DIR     = ../Source
#FAST_DIR     = C:/Users/bjonkman/Documents/DATA/DesignCodes/simulators/FAST/SVNdirectory/branches/BJonkman/Source
FAST_DIR     = /paper/FAST_8.15/ 

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;直接定位到MapDir/src的makefile，进行make一下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/bin/ld: cannot find -llapacke
/usr/bin/ld: cannot find -llapacke
collect2: error: ld returned 1 exit status
makefile:81: recipe for target &#39;all&#39; failed
make: *** [all] Error 1

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个原因是因为缺少lapacke开发者库,参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/10/22/fast-in-ubuntu64bit-bian-yi-zhu-yi-shi-xiang/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FAST安装&lt;/a&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apt-get install lapacke-dev*

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后就可以make，并把生成的libmap-1.2.so放入到fastdir的bin文件夹，没有则创建。
这样就完成了&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;测试&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Test02.fst&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;./FAST_glin32 Test02.fst 

 **************************************************************************************************
 FAST (v8.15.00a-bjj, 12-Apr-2016)

 Copyright (C) 2016 National Renewable Energy Laboratory

 This program comes with ABSOLUTELY NO WARRANTY. See the &amp;quot;license.txt&amp;quot; file distributed with this
 software for details.
 **************************************************************************************************

  Running FAST (v8.15.00a-bjj, 12-Apr-2016), compiled as a 32-bit application using single
  precision
  linked with NWTC Subroutine Library (v2.08.00, 5-Apr-2016)

  Heading of the FAST input file:
    FAST Certification Test #02: AWT-27CR2 with many DOFs with startup and shutdown and steady wind

  Running ElastoDyn (v1.03.02a-bjj, 8-Apr-2016).

  Running AeroDyn (v15.02.03, 12-Apr-2016).

  Running AirfoilInfo (v1.01.00a-bjj, 5-Apr-2016).

  Running BEM (v1.01.00a, 12-Apr-2016).

  Running InflowWind (v3.02.00a-bjj, 11-Apr-2016).
  Opening InflowWind input file:  ./AWT27/Test02_InflowWind.dat

  Running ServoDyn (v1.05.00a-bjj, 11-Mar-2016).
  Timestep: 0 of 20 seconds.

 Timestep: 2 of 20 seconds. Estimated final completion at 15:12:15.                               
 Timestep: 4 of 20 seconds. Estimated final completion at 15:12:14.                               
 Timestep: 6 of 20 seconds. Estimated final completion at 15:12:14.                               
 Timestep: 8 of 20 seconds. Estimated final completion at 15:12:14.                               
 Timestep: 10 of 20 seconds. Estimated final completion at 15:12:14.                              
 Timestep: 12 of 20 seconds. Estimated final completion at 15:12:14.                              
 Timestep: 14 of 20 seconds. Estimated final completion at 15:12:14.                              
 Timestep: 16 of 20 seconds. Estimated final completion at 15:12:14.                              
 Timestep: 18 of 20 seconds. Estimated final completion at 15:12:14.                              
 Timestep: 20 of 20 seconds. Estimated final completion at 15:12:14.                              
                                                                                                  
  Total Real Time:       9.788 seconds
  Total CPU Time:        9.708 seconds
  Simulation CPU Time:   9.636 seconds
  Simulated Time:        20 seconds
  Time Ratio (Sim/CPU):  2.0756

  FAST terminated normally.

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Test26.fst&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不通过的原因是没有编译DISCON_DLL.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;➞ ./FAST_glin32 Test26.fst 

 **************************************************************************************************
 FAST (v8.15.00a-bjj, 12-Apr-2016)

 Copyright (C) 2016 National Renewable Energy Laboratory

 This program comes with ABSOLUTELY NO WARRANTY. See the &amp;quot;license.txt&amp;quot; file distributed with this
 software for details.
 **************************************************************************************************

  Running FAST (v8.15.00a-bjj, 12-Apr-2016), compiled as a 32-bit application using single
  precision
  linked with NWTC Subroutine Library (v2.08.00, 5-Apr-2016)

  Heading of the FAST input file:
    FAST Certification Test #26: NREL 5.0 MW Baseline Wind Turbine (Onshore)

  Running ElastoDyn (v1.03.02a-bjj, 8-Apr-2016).

  Running BeamDyn (v1.01.03, 12-Apr-2016).

  Running BeamDyn (v1.01.03, 12-Apr-2016).

  Running BeamDyn (v1.01.03, 12-Apr-2016).

  Running AeroDyn (v15.02.03, 12-Apr-2016).

  Running AirfoilInfo (v1.01.00a-bjj, 5-Apr-2016).

  Running BEM (v1.01.00a, 12-Apr-2016).
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 3

  Running InflowWind (v3.02.00a-bjj, 11-Apr-2016).
  Opening InflowWind input file:  ./5MW_Baseline/NRELOffshrBsline5MW_InflowWind_12mps.dat

    Reading a 31x31 grid (145 m wide, 17.5 m to 162.5 m above ground) with a characteristic wind
    speed of 12 m/s. This full-field file was generated by TurbSim (v1.06.00, 21-Sep-2012) on
    07-Jan-2014 at 12:50:45.

    Processed 1442 time steps of 20-Hz full-field data (72.05 seconds).

  Running ServoDyn (v1.05.00a-bjj, 11-Mar-2016).

  Running ServoDyn Interface for Bladed Controllers (using GNU Fortran for Linux, 14-Oct-2015).

 FAST_InitializeAll:SrvD_Init:BladedInterface_Init:The dynamic library
 ./5MW_Baseline/ServoData/DISCON_win32.dll could not be loaded. Check that the file exists in the
 specified location and that it is compiled for 32-bit applications.

 FAST encountered an error during module initialization.
  Simulation error level: FATAL ERROR

  Aborting FAST.


&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;解决Test26无法运行&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;首先，定位到Fast的Compling目录，基本尚不修改，测试make（默认32bit）,通过。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make -f makefile_DISCON_DLL 
gfortran  -O2 -m32 -fbacktrace -ffree-line-length-none -x f95-cpp-input -C -DIMPLICIT_DLLEXPORT -fPIC -c ../CertTest/5MW_Baseline/ServoData/Source/DISCON.f90 -o Obj_lin32/DISCON.obj -J Obj_lin32 -B Obj_lin32
gfortran -shared -O2 -m32 -fbacktrace -fPIC -I Obj_lin32 -o ../CertTest/5MW_Baseline/ServoData/DISCON_glin32.so \
 Obj_lin32/DISCON.obj

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意一定得把 生成的DISCON_glin32.so路径写入到对应的NREL5MW Servodata的配置文件，比如&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Test26.fst文件：

&amp;quot;5MW_Baseline/NRELOffshrBsline5MW_Onshore_ServoDyn.dat&amp;quot;    ServoFile       - Name of file containing control and electrical-drive input parameters (quoted string)

&amp;quot;unused&amp;quot;      HydroFile       - Name of file containing hydrodynamic input parameters (quoted string)

NRELOffshrBsline5MW_Onshore_ServoDyn.dat 更改对应的DLL_FileName 为 ServoData/DISCON_glin32.so

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;注意还是得按照FAST 非windows平台的编译顺序把register编译好,然后一次MAP++ 和FAST，以及DISCONDLL.&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;─➞ ../bin/FAST_glin32 Test26.fst 

 **************************************************************************************************
 FAST (v8.15.00a-bjj, 12-Apr-2016)

 Copyright (C) 2016 National Renewable Energy Laboratory

 This program comes with ABSOLUTELY NO WARRANTY. See the &amp;quot;license.txt&amp;quot; file distributed with this
 software for details.
 **************************************************************************************************

  Running FAST (v8.15.00a-bjj, 12-Apr-2016), compiled as a 32-bit application using single
  precision
  linked with NWTC Subroutine Library (v2.08.00, 5-Apr-2016)

  Heading of the FAST input file:
    FAST Certification Test #26: NREL 5.0 MW Baseline Wind Turbine (Onshore)

  Running ElastoDyn (v1.03.02a-bjj, 8-Apr-2016).

  Running BeamDyn (v1.01.03, 12-Apr-2016).

  Running BeamDyn (v1.01.03, 12-Apr-2016).

  Running BeamDyn (v1.01.03, 12-Apr-2016).

  Running AeroDyn (v15.02.03, 12-Apr-2016).

  Running AirfoilInfo (v1.01.00a-bjj, 5-Apr-2016).

  Running BEM (v1.01.00a, 12-Apr-2016).
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 1
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 2
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 1, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 2, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 3, Blade = 3
 Warning: Turning off Unsteady Aerodynamics because C_nalpha is 0.  BladeNode = 4, Blade = 3

  Running InflowWind (v3.02.00a-bjj, 11-Apr-2016).
  Opening InflowWind input file:  ./5MW_Baseline/NRELOffshrBsline5MW_InflowWind_12mps.dat

    Reading a 31x31 grid (145 m wide, 17.5 m to 162.5 m above ground) with a characteristic wind
    speed of 12 m/s. This full-field file was generated by TurbSim (v1.06.00, 21-Sep-2012) on
    07-Jan-2014 at 12:50:45.

    Processed 1442 time steps of 20-Hz full-field data (72.05 seconds).

  Running ServoDyn (v1.05.00a-bjj, 11-Mar-2016).

  Running ServoDyn Interface for Bladed Controllers (using GNU Fortran for Linux, 14-Oct-2015).
  Timestep: 0 of 20 seconds.

 FAST_Solution0:CalcOutputs_And_SolveForInputs:SolveOption2:SrvD_CalcOutput:Running with torque
 and pitch control of the NREL offshore 5MW baseline wind turbine from DISCON.dll as written by J.
 Jonkman of NREL/NWTC for use in the IEA Annex XXIII OC3 studies.


 Timestep: 1 of 20 seconds. Estimated final completion at 16:45:58.                               
 Timestep: 2 of 20 seconds. Estimated final completion at 16:45:53.                               
 Timestep: 3 of 20 seconds. Estimated final completion at 16:45:58.                               
 Timestep: 4 of 20 seconds. Estimated final completion at 16:45:57.                               
 Timestep: 5 of 20 seconds. Estimated final completion at 16:45:57.                               
 Timestep: 6 of 20 seconds. Estimated final completion at 16:45:53.                               

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>program-as-data</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/03/30/program-as-data/</link>
      <pubDate>Wed, 30 Mar 2016 13:23:21 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/03/30/program-as-data/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/HtDP2e/part_three.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A program is like an essay. The first version is a draft, and drafts demand editing.&lt;/a&gt;
Program is also can be seen as data.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;直觉认识proc,提取body。&lt;/li&gt;
&lt;li&gt;对比识别。&lt;/li&gt;
&lt;li&gt;加壳。&lt;/li&gt;
&lt;li&gt;三行表格，n列迭代。&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(value-of (proc (var body)) env)
 = (value-of (proc-exp (procedure (var body env)) val) env)

 = (value-of body ([var=val] env))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;函数其实也是expression，它可以被consume也可以被produce.凭着这个脑中的
印象是否可以帮助你继续理解abstration和程序即数据的思想。&lt;/p&gt;
&lt;p&gt;所有的函数和数据犹如花生的壳和仁的关系。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/lisp/peanut.jpeg&#34; alt=&#34;peanut&#34;&gt;&lt;/p&gt;
&lt;p&gt;只有加壳就相当于是创建一层抽象，把类似的东西包裹起来，或者也可以换着一种思路
（每个壳里面都包着类似的花生仁，只不过可能存在些许不同）&lt;/p&gt;
&lt;h3 id=&#34;two-similar-functions&#34;&gt;Two similar functions&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;; Los -&amp;gt; Boolean
; does l contain &amp;quot;dog&amp;quot;
(define (contains-dog? l)
  (cond
    [(empty? l) #false]
    [else
     (or
       (string=? (first l) &amp;quot;dog&amp;quot;)
       (contains-dog?
         (rest l)))]))

	
; Los -&amp;gt; Boolean
; does l contain &amp;quot;cat&amp;quot;
(define (contains-cat? l)
  (cond
    [(empty? l) #false]
    [else
     (or
       (string=? (first l) &amp;quot;cat&amp;quot;)
       (contains-cat?
         (rest l)))]))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;加壳&#34;&gt;加壳&lt;/h3&gt;
&lt;p&gt;加上一个函数皮，并封上一层。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;; String Los -&amp;gt; Boolean
; determines whether l contains the string s
(define (contains? s l)
  (cond
    [(empty? l) #false]
    [else (or (string=? (first l) s)
              (contains? s (rest l)))]))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后我们就可以类似的改写了&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;; Los -&amp;gt; Boolean
; does l contain &amp;quot;dog&amp;quot;
(define (contains-dog? l)
  (contains? &amp;quot;dog&amp;quot; l))
	
	
; Los -&amp;gt; Boolean
; does l contain &amp;quot;cat&amp;quot;
(define (contains-cat? l)
  (contains? &amp;quot;cat&amp;quot; l))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个典型的过程就是函数抽象。进一步可以参考&lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/HtDP2e/part_three.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HowToDesginProgram&lt;/a&gt;和&lt;a href=&#34;http://www.ccs.neu.edu/home/matthias/BTLS/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TheLittleScheme&lt;/a&gt;.
Note: 你需要解析的其实是花生仁，但是你不得不先把壳打开或者通过另外一种方式，比如红外线等技术把它识别出来。&lt;/p&gt;
&lt;p&gt;也就是说进一步归纳的话，你首先得recognise识别出来，然后才能进行解析（提取其中的蛋白质、脂肪、热量等）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/lisp/baby.png&#34; alt=&#34;mybaby&#34;&gt;&lt;/p&gt;
&lt;p&gt;保护它的壳，给它提供营养，防止它受到感染和伤害。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://pressbin.com/tools/excel_to_html_table/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;表格转换链接&lt;/a&gt;.&lt;/p&gt;
&lt;table&gt;
      &lt;tr&gt;
                &lt;td&gt;index&lt;/td&gt;
                &lt;td&gt;0&lt;/td&gt;
                &lt;td&gt;1&lt;/td&gt;
                &lt;td&gt;2&lt;/td&gt;
                &lt;td&gt;…&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
                &lt;td&gt;M&lt;/td&gt;
                &lt;td&gt;a+S&lt;/td&gt;
                &lt;td&gt;a+1*W+S&lt;/td&gt;
                &lt;td&gt;a+2*W+S&lt;/td&gt;
                &lt;td&gt;…&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
                &lt;td&gt;f at M&lt;/td&gt;
                &lt;td&gt;f(a+S)&lt;/td&gt;
                &lt;td&gt;f(a+1*W+S)&lt;/td&gt;
                &lt;td&gt;f(a+2*W+S)&lt;/td&gt;
                &lt;td&gt;…&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
                &lt;td&gt;Area&lt;/td&gt;
                &lt;td&gt;W*f(a+S)&lt;/td&gt;
                &lt;td&gt;W*f(a+1*W+S)&lt;/td&gt;
                &lt;td&gt;W*f(a+2*W+S)&lt;/td&gt;
                &lt;td&gt;…&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
                &lt;td&gt;residual&lt;/td&gt;
                &lt;td&gt;60.00%&lt;/td&gt;
                &lt;td&gt;50.00%&lt;/td&gt;
                &lt;td&gt;40.00%&lt;/td&gt;
                &lt;td&gt;…&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
                &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;慢工才能出细活，通过三行表格n列迭代的形式(也可以进一步加大计算量变成n行表格n列迭代)理解递归迭代的过程,在一定的时间，进行一系列的列计算，并让时间推进，直到满足你想要的结果。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>scheme环境的几种表现形式-represtations</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/03/03/schemehuan-jing-de-ji-chong-biao-xian-xing-shi-represtations/</link>
      <pubDate>Thu, 03 Mar 2016 02:05:32 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/03/03/schemehuan-jing-de-ji-chong-biao-xian-xing-shi-represtations/</guid>
      <description>&lt;p&gt;scheme的解释器的构造，都需要enviroment类型的参与，environment类型的抽象确是影响到语言的具体性能。&lt;/p&gt;
&lt;p&gt;主要有以下四种类型(另一种未实现)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;环境关联表形式出现(cons cons&amp;hellip;)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;环境的列表出现 (list var val env)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;环境的过程实现(lambda ()形式)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt;环境的一种较为特殊的形式成堆变量的实现(list (list var) (list val))&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;1&#34;&gt; 1. 环境关联表形式出现 &lt;/h2&gt;
&lt;p&gt;此时是每一次都把一个键值对存入到环境中，逐次存入的过程(采用 &lt;em&gt;cons cons的形式&lt;/em&gt;)。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;((a . 1) (b . 1)  (c . 1))

empty-env  is &#39;()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体实现如下所示&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define empty-env
  (lambda() &#39;()))

(define extend-env
  (lambda (var val env)
    (cons (cons var val)
	  env)))

(define apply-env
  (lambda (env search-var)
    (cond
     ((null? env)
      (report-no-binding-found search-var))
     ((eqv? (caar env) search-var)
      (cdr (car env)))
     (else
      (apply-env (cdr env) search-var)))))

(define report-no-binding-found
  (lambda (search-var)
    (error &#39;apply-env &amp;quot;No binding for: &amp;quot; search-var)))

(define e
  (extend-env &#39;d 6
    (extend-env &#39;y 8
       (extend-env &#39;x 7
	  (extend-env &#39;y 14
	    (empty-env))))))

(equal?? (apply-env e &#39;d) 6)
(equal?? (apply-env e &#39;y) 8)
(equal?? (apply-env e &#39;x) 7)
(equal?? (apply-env e &#39;d) 6)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一种比较特殊的就是&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; a=1 b=2  a=3  c=5

 ((a 1 3) (b 2) (c 5))

 empty-env is &#39;()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;针对当前的关联表的一个很小的拓展&lt;/p&gt;
&lt;h3 id=&#34;增加一个has-binding-实现&#34;&gt;增加一个&lt;code&gt;has-binding&lt;/code&gt; 实现&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define has-binding?
  (lambda (env var)
    (cond
     ((null? env) #f)
     ((eqv? (caar env) var) #t)
     (else
      (has-binding? (cdr env) var)))))


(define e
  (extend-env &#39;d 6
     (extend-env &#39;y 8
        (extend-env &#39;x 7
           (extend-env &#39;y 14
              (empty-env))))))

(equal?? (has-binding? e &#39;d) #t)
(equal?? (has-binding? e &#39;y) #t)
(equal?? (has-binding? e &#39;x) #t)
(equal?? (has-binding? e &#39;z) #f)

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;拓展一个列表输入的功能extend-env&#34;&gt;拓展一个列表输入的功能&lt;code&gt;extend-env*&lt;/code&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define extend-env*
  (lambda (var-list val-list env)
    (if (null? var-list)
	env
	(let ((var (car var-list))
	      (val (car val-list)))
	  (extend-env* (cdr var-list)
		       (cdr val-list)
		       (extend-env var val env))))))

(equal?? (has-binding? (extend-env* &#39;(A) &#39;(1) e) &#39;A) #t)
(equal?? (has-binding? (extend-env* &#39;(A B C) &#39;(1 2 3) e) &#39;C) #t)

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt; 2.环境的列表出现  &lt;/h2&gt;
&lt;p&gt;此时使用一个标志位&lt;code&gt;extend-env&lt;/code&gt;每一次都把一个键值对存入到list环境中，&lt;font color=&#34;red&#34;&gt;嵌套&lt;/font&gt;存入的过程(采用 &lt;em&gt;cons cons的形式&lt;/em&gt;)。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; (extend 
   (list &#39;extend-env var exp (extend                        ;;;====其实&#39;extend-env 有点多余
                         (list &#39;extend-env var exp (extend  ;;;====其实&#39;extend-env 有点多余
                                               (empty-env))))))

 (1 (2 (3 6)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;且看具体实现如下&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;; empty-env : () -&amp;gt; Env
(define empty-env
  (lambda () (list &#39;empty-env)))

;; extend-env : Var * Schemeval * Env -&amp;gt; Env
(define extend-env
  (lambda (var val env)
    (list &#39;extend-env var val env)))     ;;;;;;;==================&amp;gt;关键位置

;; apply-env : Env * Var -&amp;gt; Schemeval
(define apply-env-rec
  (lambda (env search-var all)
    (cond
     ((eqv? (car env) &#39;empty-env)
      (report-no-binding-found search-var all))
     ((eqv? (car env) &#39;extend-env)
      (let ((saved-var (cadr env))        ;;;;;;;==================&amp;gt;关键位置  
	    (saved-val (caddr env))           ;;;;;;;==================&amp;gt;关键位置
	    (saved-env (cadddr env)))         ;;;;;;;==================&amp;gt;关键位置
	(if (eqv? search-var saved-var)
	    saved-val
	    (apply-env-rec saved-env search-var all))))  ;;;;;;;==================&amp;gt;不断更新最新的位置look up variable in the saved-env
     (else
      (report-invalid-env env)))))

(define apply-env
  (lambda (env search-var)
    (apply-env-rec env search-var env)))


(define display-env-rec
  (lambda (env)
    (if (eqv? (car env) &#39;extend-env)
	(let ((saved-var (cadr env))
	      (saved-env (cadddr env)))
	  (printf &amp;quot; ~a &amp;quot; saved-var)
	  (display-env-rec saved-env)))))


(define display-env
  (lambda (env)
    (printf &amp;quot;env: &amp;quot;)
    (display-env-rec env)
    (newline)))

(display-env e)

(define report-no-binding-found
  (lambda (search-var all)
    (display-env all)
    (error &#39;apply-env &amp;quot;No binding for&amp;quot; search-var)))

(define report-invalid-env
  (lambda (env)
    (error &#39;apply-env &amp;quot;Bad environment&amp;quot; env)))

(define e
  (extend-env &#39;d 6
      (extend-env &#39;y 8
         (extend-env &#39;x 7
            (extend-env &#39;y 14
                (empty-env))))))

(equal?? (apply-env e &#39;d) 6)
(equal?? (apply-env e &#39;y) 8)
(equal?? (apply-env e &#39;x) 7)


&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3&#34;&gt; 3.环境的过程实现&lt;/h2&gt;
&lt;p&gt;环境的过程实现是比较难理解的，因为该过程更少了递归的逐渐减少的表像，感觉所有都不变。&lt;/p&gt;
&lt;p&gt;具体实现如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;; data definition:
;; Env = Var -&amp;gt; Schemeval

;; empty-env : () -&amp;gt; Env
(define empty-env
  (lambda ()
    (cons (lambda (search-var)
	    (report-no-binding-found search-var))
	  (lambda ()
	    #t))))


;; extend-env : Var * Schemeval * Env -&amp;gt; Env
(define extend-env
  (lambda (saved-var saved-val saved-env)
    (cons (lambda (search-var)
	    (if (eqv? search-var saved-var)
		saved-val
		(apply-env saved-env search-var)))
	  (lambda ()
	    #f))))

;; apply-env : Env * Var -&amp;gt; Schemeval
(define apply-env
  (lambda (env search-var)
    ((car env) search-var)))

(define empty-env?
  (lambda (env)
    ((cdr env))))

(define report-no-binding-found
  (lambda (search-var)
    (error &#39;apply-env &amp;quot;No binding for ~s&amp;quot; search-var)))

(define report-invalid-env
  (lambda (env)
    (error &#39;apply-env &amp;quot;Bad environment: ~s&amp;quot; env)))

(define e
  (extend-env &#39;d 6
     (extend-env &#39;y 8
        (extend-env &#39;x 7
           (extend-env &#39;y 14
              (empty-env))))))

(equal?? (apply-env e &#39;d) 6)
(equal?? (apply-env e &#39;y) 8)
(equal?? (apply-env e &#39;x) 7)

(equal?? (empty-env? (empty-env)) #t)
(equal?? (empty-env? e) #f)

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4&#34;&gt; 4.环境的一种较为特殊的形式的实现 &lt;/h2&gt;
&lt;p&gt;如果若有的定义扎堆存在呢？也就是把所有变量放在一个列表中，值放在一个列表里面。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; x=3 y=4 z=5 c=6

 表现为 ((x y z c) (3 4 5 6))

 此时 empty-env is (()  ())
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define empty-env
  (lambda() &#39;()))


(define extend-env
  (lambda (var val env)
    (cons (list
	   (list var) (list val))
          env)))

(define extend-env*
  (lambda (var-list val-list env)
    (if (null? var-list)
	env
	(cons (list var-list val-list)
	      env))))

;; return a pair, for distinguish with val is #f
(define apply-current
  (lambda (vars vals search-var)
    (if (null? vars)
	(cons #f &#39;())
	(if (eqv? (car vars) search-var)
	    (cons #t (car vals))
	    (apply-current (cdr vars) (cdr vals) search-var)))))

(define apply-env
  (lambda (env search-var)
    (if (null? env)
     (report-no-binding-found search-var)
     (let ((val (apply-current (caar env) (cadar env) search-var)))
       (if (car val) (cdr val)
	   (apply-env (cdr env) search-var))))))

(define report-no-binding-found
  (lambda (search-var)
    (error &#39;apply-env &amp;quot;No binding for: &amp;quot; search-var)))


(define has-binding?
  (lambda (env var)
    (if (null? env)
	#f
	(let ((val (apply-current (caar env) (cadar env) var)))
	  (if (car val)
	      #t
	      (has-binding? (cdr env) var))))))


(define e (empty-env))
(equal?? e &#39;())

(define e (extend-env &#39;z 10 e))
(equal?? e &#39;(((z) (10))))

(define e (extend-env* &#39;(a b c d) &#39;(1 2 3 4) e))
(equal?? e &#39;(((a b c d) (1 2 3 4)) ((z) (10))))

(equal?? (apply-env e &#39;z) 10)
(equal?? (apply-env e &#39;d) 4)

(equal?? (has-binding? e &#39;z) #t)
(equal?? (has-binding? e &#39;d) #t)
(equal?? (has-binding? e &#39;m) #f)

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论&lt;/h2&gt;
&lt;p&gt;上述所谈的4种环境的实现，其实也就对应着四种不同的解释器的实现。环境实现的不同，对应者整个解释器的提取过程也就不一样。
整个解释器独立的解释每一个表达式的时候，所采用的方法也就会有所不一样。所以设计一个好的environment，对应的就是设计一个好的
数据结构，用于程序program解析的时候需要使用到的变量或者表达式数据，至关重要！&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>插入排序</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/28/cha-ru-pai-xu/</link>
      <pubDate>Sun, 28 Feb 2016 16:42:54 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/28/cha-ru-pai-xu/</guid>
      <description>&lt;p&gt;排序算法是一种比较常见的算法，一般包括冒泡排序，插入排序，快速排序等。
本文主要是关于插入排序。&lt;/p&gt;
&lt;h2 id=&#34;如何把一个数字插入到一个列表中&#34;&gt;如何把一个数字插入到一个列表中&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;;; using insert sort here

(define insert
  (lambda (lst elem)
    (cond ((null? lst) (list elem))
	  ((&amp;lt; elem (car lst))
	   (cons elem lst))
	  (else (cons (car lst)
		      (insert (cdr lst) elem))))))

(define sort-rec
  (lambda (prev now)
    (if (null? now)
	prev
	(sort-rec (insert prev (car now))
		  (cdr now)))))
(define sort
  (lambda (lst)
    (sort-rec &#39;() lst)))


&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;提取出判断条件&#34;&gt;提取出判断条件&lt;/h2&gt;
&lt;p&gt;利用pred代表小于号&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(define insert
  (lambda (lst elem pred)
     (cond
        ((null? lst) (list elem))
        ((pred elem (car lst))
          (cons elem lst))
        (else (cons (car lst)
                    (insert (cdr lst) elem pred))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(insert &#39;(1 2 3) &#39;4 &amp;lt;)
    (1 2 3 4)
(insert &#39;(1 2 3) &#39;0 &amp;lt;)
    (0 1 2 3)
(insert &#39;(1 3 2) &#39;4 &amp;lt;)
    (1 3 2 4)    ==&amp;gt; 这不是我们想要的
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;分析发现 insert仅仅是在判断满足条件的时候，直接退出，不管后面的大小问题，
&lt;font color=&#34;red&#34;&gt;我们不可以判断该元素之后的所有的字符的情况&lt;/font&gt;。&lt;/p&gt;
&lt;p&gt;然而该程序当作一个最小的模块，也就是加入我逐个提出判断列表，最终实现的是每提取一个元素
都和新构成的排序列表进行判断，那么也就算判断完成。&lt;/p&gt;
&lt;h2 id=&#34;对一个列表进行插入排序&#34;&gt;对一个列表进行插入排序&lt;/h2&gt;
&lt;p&gt;在原先insert的基础上，书写了sort-rec和sort-predicate&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;sort-rec 逐个判断最新的元素和新的临时列表的比较&lt;/li&gt;
&lt;li&gt;sort-predicate 仅仅是选择判断的标准。&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;(define sort-rec
  (lambda (prev now pred)
    (if (null? now)
        prev
        (sort-rec (insert prev (car now) pred)
                  (cdr now)
                  pred))))

(define sort/predicate
   (lambda (pred lst)
      (sort-rec &#39;() lst pred)))

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;sort-rec的prev在逐渐的变大，而now的部分在不断的变小&lt;/li&gt;
&lt;li&gt;也就是 sort-rec 的第一号位置不断变大，第二号位由于cdr作用不断变小。&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(sort/predicate &amp;lt; &#39;(1 6 5 7))

    prev          now
1.  ()         (1 6 5 7)
2.  (1)        (6 5 7)
3.  (1 6)      (5 7)
4.  (1 5 6)    (7)
5.  (1 5 6 7)  ()

计算结束，返回prev的值
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;于是我们就可以获得正确的结果&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(sort/predicate &amp;lt; &#39;(1 6 5 7))
    (1 5 6 7)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;利用内部define和letrec改写程序&#34;&gt;利用内部define和letrec改写程序&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;采用内部的define实现&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;可以保护函数的实现（只被使用一次）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define sort/predicate1
  (lambda (pred lst)
    (define sort-rec
      (lambda (prev now pred)
        (if (null? now)
           prev
           (sort-rec (insert prev (car now) pred)
                    (cdr now)
                    pred))))
    (define insert
      (lambda (lst elem pred)
        (cond
          ((null? lst) (list elem))
          ((pred elem (car lst))
           (cons elem lst))
          (else (cons (car lst)
                     (insert (cdr lst) elem pred))))))

     (sort-rec &#39;() lst pred)))

      (sort/predicate1 &amp;lt; &#39;(1 6 5 7))
    
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;采用letrec实现sort/predicate,主要是用&lt;code&gt;(letrec (() ...) ...)&lt;/code&gt; 结构&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define sort/predicate2
  (lambda (pred lst)
    (letrec ((sort-rec
              (lambda (prev now pred)
                (if (null? now)
                   prev
                   (sort-rec (insert prev (car now) pred)
                            (cdr now)
                            pred))))
             (insert
              (lambda (lst elem pred)
                (cond
                  ((null? lst) (list elem))
                  ((pred elem (car lst))
                   (cons elem lst))
                  (else (cons (car lst)
                             (insert (cdr lst) elem pred)))))))
      
      (sort-rec &#39;() lst pred))))

(sort/predicate2 &amp;lt; &#39;(1 6 5 7))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;每隔离一层抽象，相当于增加了一种变化&lt;/li&gt;
&lt;li&gt;了解插入排序的实现过程。&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>The Fifth interpreter with the implementation of letrec(Important)</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/28/the-fifth-interpreter-with-the-implementation-of-letrec-important/</link>
      <pubDate>Sun, 28 Feb 2016 06:02:57 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/28/the-fifth-interpreter-with-the-implementation-of-letrec-important/</guid>
      <description>&lt;p&gt;letrec的作用是可以定义内部函数。它的实现类似于let，只不过let实现的主要是局部变量，而他是局部的过程（持保留意见)&lt;/p&gt;
&lt;h2 id=&#34;错误1&#34;&gt;错误1.&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;  (define-datatype environment environment?
    (empty-env)
    (extend-env
     (bvar symbol?)  ;;;这边是一个 所以是symbol?
     (bval expval?)
     (saved-env environment?))
    (extend-env-rec
     (id symbol?)
     (bvar (list-of symbol?)) ;;这边和proc-val的定义发生了冲突  一个是symbol? 另外一个则是(list-of symbol?)
     (body expression?)
     (saved-env environment?)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;而在实际的extend-env-rec的实现中，则是调用了proc-val，所以并且传入到proc-val，为了保证一致性&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;;;;;;;;;;;;;;;;; environment constructors and observers ;;;;;;;;;;;;;;;;
(define apply-env
  (lambda (env search-sym)
    (cases environment env
           (empty-env ()
                      (error &#39;apply-env &amp;quot;No binding for ~s&amp;quot; search-sym))
           (extend-env (var val saved-env)
                       (if (eqv? search-sym var)
                           val
                           (apply-env saved-env search-sym)))
           (extend-env-rec (p-name b-var p-body saved-env)
                           (if (eqv? search-sym p-name)
                             ;; (proc-val (procedure b-var p-body env))  ;;;注意这里的变化！
                              (proc-val (procedure b-var p-body env #t)) ;;修改了一个bug 目的是可以追踪的作用
                               (apply-env saved-env search-sym))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以需要对应的修改proc-val&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  ;; proc? : SchemeVal -&amp;gt; Bool
  ;; procedure : Var * Exp * Env -&amp;gt; Proc
  (define-datatype proc proc? ;;;注意这边的变化 影响到apply-procedure
    (procedure
     ;(var symbol?)  ;;;为了保证和environment的define-datatype一直改为(list-of symbol?)
     (var (list-of symbol?))
     (body expression?)
     (env environment?)
     (trace boolean?))) ;;;需要考虑#t #f
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;错误2&#34;&gt;错误2.&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; (run &amp;quot;letrec double(x)=+(x,6) in (double 10)&amp;quot;)
enter: (x) = #(struct:num-val 10)
. . cdr: contract violation
  expected: pair?
  given: (num-val 10)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;原因在于原先的call-exp并没有遍历的过程，而新改进的apply-procedure则是需要遍历，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        (call-exp (rator rand)
                 (let ((proc (expval-&amp;gt;proc (value-of rator env)))
                       (arg (value-of rand env))) 
                   (apply-procedure proc arg)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;改进的call-exp&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        (call-exp (rator rands)
                 (let ((proc (expval-&amp;gt;proc (value-of rator env)))
                       (args (map (lambda (x) (value-of x env)) rands)))
                   (apply-procedure proc args)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;额外错误&#34;&gt;额外错误&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt; data-structures.scm:7:11: all-defined: not a provide sub-form in: (all-defined)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个错误是因为现在都是在使用&lt;code&gt;(all-defined-out)&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;为什么还是会出现如下的错误&#34;&gt;为什么还是会出现如下的错误&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;&amp;gt; (run &amp;quot;letrec double(x)
            = if zero?(x) then 0 else -((double -(x,1)), 2)
       in (double 6)&amp;quot;)
. . extend-env-rec: bad value for bvar field: &#39;(x)
&amp;gt; (run &amp;quot;if zero?(3) then 0 else -(3,2)&amp;quot;) 
(num-val 1)
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>The Fourth Interpreter about the traceproc</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/27/the-fourth-interpreter-about-the-traceproc/</link>
      <pubDate>Sat, 27 Feb 2016 21:49:18 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/27/the-fourth-interpreter-about-the-traceproc/</guid>
      <description>&lt;p&gt;程序的过程追踪能力体现着一个独特的优势，本文在&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/25/first-interpreter-from-eopl/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;First Interpreter&lt;/a&gt;,&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/27/the-second-interpreter-from-one/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Second Interpreter&lt;/a&gt;,&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/27/the-third-interpreter-implementing-proc/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Third Interpreter&lt;/a&gt;基础上实现新的解释器功能。&lt;/p&gt;
&lt;p&gt;实现效果:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    enter: x = #(struct:num-val 30)
    exting: result = #(struct:num-val 29)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;font size=&#34;2&#34; color=&#34;red&#34;&gt;老阮不狂谁会得？出门一笑大江横！&lt;/font&gt;&lt;/p&gt;
&lt;h2 id=&#34;langscm修改程序追踪部分&#34;&gt;lang.scm修改程序追踪部分&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;      ;;增加了trace-proc
          (expression (&amp;quot;traceproc&amp;quot; &amp;quot;(&amp;quot; identifier &amp;quot;)&amp;quot; expression) traceproc-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;至于proc的语法并不需要做任何的修改。&lt;/p&gt;
&lt;h2 id=&#34;data-structuresscm-进行部分修改&#34;&gt;data-structures.scm 进行部分修改&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;在修改trace-proc实现的情况下还得修改proc?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;原先的proc?实现&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;; proc? : SchemeVal -&amp;gt; Bool
  ;; procedure : Var * Exp * Env -&amp;gt; Proc
  (define-datatype proc proc?
    (procedure
     (var symbol?)
     (body expression?)
     (env environment?)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;改进后的&lt;code&gt;proc?&lt;/code&gt;实现,注意trace 是&lt;code&gt;boolean?&lt;/code&gt;类型。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;; proc? : SchemeVal -&amp;gt; Bool
  ;; procedure : Var * Exp * Env -&amp;gt; Proc
  (define-datatype proc proc?
    (procedure
     (var symbol?)
     (body expression?)
     (env environment?)
     (trace boolean?)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;interpscm-修改程序追踪部分&#34;&gt;interp.scm 修改程序追踪部分&lt;/h2&gt;
&lt;p&gt;由于proc?的类型实现发生了变化，所以需要进行对应的修改apply-procedure和value-of。&lt;/p&gt;
&lt;h3 id=&#34;apply-procedure的修改&#34;&gt;apply-procedure的修改&lt;/h3&gt;
&lt;p&gt;原先的apply-procedure实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define apply-procedure
    (lambda (proc1 val)
      (cases proc proc1
        (procedure (var body saved-env)
          (value-of body (extend-env var val saved-env))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;改进后的apply-procedure增加了trace?的判断&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;; apply-procedure : Proc * ExpVal -&amp;gt; ExpVal
  ;; Page: 79
  (define apply-procedure
    (lambda (proc1 val)
      (cases proc proc1
        (procedure (var body saved-env trace?)
                  (if trace? (printf &amp;quot;enter: ~a = ~a\n&amp;quot; var val) &#39;**proc**)
                  (let ((value (value-of body (extend-env var val saved-env))))
                    (if trace? (printf &amp;quot;exting: result = ~a\n&amp;quot; value) &#39;**proc**)
                    value)))))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;value-of-的修改&#34;&gt;value-of 的修改&lt;/h3&gt;
&lt;p&gt;原先的value-of实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  (proc-exp (var body)
                 (proc-val (procedure var body env)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;新改进的的value-of 实现:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;    (proc-exp (var body)
                 (proc-val (procedure var body env #f)))
    (traceproc-exp (var body)
                  (proc-val (procedure var body env #t)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;测试追踪修改的结果&#34;&gt;测试追踪修改的结果&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;proc(x) -(x, 1)&amp;quot;)
(run &amp;quot;(proc(x) -(x,1)  30)&amp;quot;)
(run &amp;quot;let f = traceproc (x) -(x,1) in (f 30)&amp;quot;)
(run &amp;quot;(proc(f)(f 30)  proc(x)-(x,1))&amp;quot;)
(run &amp;quot;let x = 3 in -(x,1)&amp;quot;)

    (proc-val (procedure &#39;x (diff-exp (var-exp &#39;x) (const-exp 1)) (list (list &#39;i (num-val 1)) (list &#39;v (num-val 5)) (list &#39;x (num-val 10))) #f))
    (num-val 29)
    enter: x = #(struct:num-val 30)
    exting: result = #(struct:num-val 29)
    (num-val 29)
    (num-val 29)
    (num-val 2)
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;&lt;font size=&#34;9&#34; color=&#34;yellow&#34;&gt;老阮不狂谁会得？出门一笑大江横！&lt;/font&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>The third Interpreter implementing Proc</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/27/the-third-interpreter-implementing-proc/</link>
      <pubDate>Sat, 27 Feb 2016 14:35:50 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/27/the-third-interpreter-implementing-proc/</guid>
      <description>&lt;p&gt;Scheme解释器的好处是可以不断的拓展自己语言的能力，&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/25/first-interpreter-from-eopl/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;The First-interpreter-from-eopl&lt;/a&gt;创建了一个较为简单let-language，实现了较为简单的减法运算和let局部变量赋值等功能。&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/27/the-second-interpreter-from-one/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;The Second Interpreter from on&lt;/a&gt;第一次扩展了基础的let-language，实现了四则运算，逻辑判断，列表操作,列表赋值等。&lt;/li&gt;
&lt;li&gt;这个版本的解释器进一步拓展了过程定义和过程调用的功能。&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;1. proc-language 的实现&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;2. Y-comb 的实现过程&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;3. 新语言的Y+实现&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id = &#34;1&#34;&gt; 1. proc-language 的实现 &lt;/h2&gt;
&lt;h3 id=&#34;langscm增加了过程定义和调用&#34;&gt;lang.scm增加了过程定义和调用&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;    ;;;new stuff
      (expression
       (&amp;quot;proc&amp;quot; &amp;quot;(&amp;quot; identifier &amp;quot;)&amp;quot; expression)
       proc-exp)
      
      (expression
       (&amp;quot;(&amp;quot; expression expression &amp;quot;)&amp;quot;)
       call-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;interpscm增加了过程定义和调用&#34;&gt;interp.scm增加了过程定义和调用&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;value-of 增加了proc-exp和call-exp的内部语言形式&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;      ;;;新增的proc-exp 和call-exp
        (proc-exp (var body)
                 (proc-val (procedure var body env)))
        
        (call-exp (rator rand)
                 (let ((proc (expval-&amp;gt;proc (value-of rator env)))
                       (arg (value-of rand env)))
                   (apply-procedure proc arg)))
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;apply-procedure 用于proc的实现&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; ;; proc-exp
 ;; apply-procedure : Proc * ExpVal -&amp;gt; ExpVal
  ;; Page: 79
  (define apply-procedure
    (lambda (proc1 val)
      (cases proc proc1
        (procedure (var body saved-env)
          (value-of body (extend-env var val saved-env))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;data-structuresscm增加了过程定义和调用&#34;&gt;data-structures.scm增加了过程定义和调用&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;在expval中拓展了proc?的判断&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  (define-datatype expval expval?
    (num-val
     (value number?))
    (bool-val
     (boolean boolean?))
    (pair-val
     (car expval?)
     (cdr expval?))
    (emptylist-val)
    ;;新增的proc-exp
    (proc-val 
     (proc proc?))
    )
  
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;增加expval-&amp;gt;proc类型转换的过程&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;proc其实就是一个closure的具体实现。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;;;新增的expval-&amp;gt;proc 和proc类
  ;; expval-&amp;gt;proc : ExpVal -&amp;gt; Proc
  (define expval-&amp;gt;proc
    (lambda (v)
      (cases expval v
        (proc-val (proc) proc)
        (else (expval-extractor-error &#39;proc v)))))
  
  ;; proc? : SchemeVal -&amp;gt; Bool
  ;; procedure : Var * Exp * Env -&amp;gt; Proc
  (define-datatype proc proc?
    (procedure
     (var symbol?)
     (body expression?)
     (env environment?)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;增加过程定义和调用的测试结果&#34;&gt;增加过程定义和调用的测试结果&lt;/h2&gt;
&lt;h3 id=&#34;error1&#34;&gt; 错误1 &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;. data-structures.scm:102:11: expression?: unbound identifier in module in: expression?
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;错误2&#34;&gt;错误2&lt;/h3&gt;
&lt;p&gt;如果按照错误1,把具体的expression?实现放入&lt;code&gt;data-structures.scm&lt;/code&gt;中，则会出现&lt;a href=&#34;#error1&#34;&gt;错误1&lt;/a&gt;的问题。&lt;/p&gt;
&lt;p&gt;expression?现在定义如下,具体参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/26/some-notations-in-the-design-of-the-language/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Some notations&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;expression ::= (var-exp ())
           ::= (const-exp ())
           ::= (zero?-exp ())
           ::= (if-exp ())
           ::= (diff-exp ())
           ::= (cons-exp ())
           ::= (car-exp ())
           ::= (cdr-exp ())
           ::= (null?-exp ())
           ::= (emptylist-exp)
           ::= (list-exp ())
           ::= (let-exp ())
           ::= (proc-exp ())
           ::= (call-exp ())
           ::= (letrec-exp ())  ;;并未再此体现

           ::= (less?-exp ())
           ::= (greater?-exp ())
           ::= (equal?-exp ())

           ::= (print-exp ())
           ::= (unpack-exp ())
           ::= (cond-exp ())

           ::= (add-exp ())
           ::= (mult-exp ())
           ::= (div-exp ())

           ::= (let*-exp ())

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;expression?实现如下:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  ;; datatype ;;;
  (define-datatype expression expression?
    (var-exp
     (id symbol?))
    (const-exp
     (num number?))
    (zero?-exp
     (expr expression?))
    (if-exp
     (predicate-exp expression?)
     (true-exp expression?)
     (false-exp expression?))
    ;;四则运算
    (minus-exp
     (body-exp expression?))
    (diff-exp
     (exp1 expression?)
     (exp2 expression?))
    (add-exp
     (exp1 expression?)
     (exp2 expression?))
    (mult-exp
     (exp1 expression?)
     (exp2 expression?))
    (div-exp
     (exp1 expression?)
     (exp2 expression?))
    
    ;;逻辑比较
    (equal?-exp
     (exp1 expression?)
     (exp2 expression?))
    (less?-exp
     (exp1 expression?)
     (exp2 expression?))
    (greater?-exp
     (exp1 expression?)
     (exp2 expression?))
    
    ;;列表操作
    (emptylist-exp)
    (cons-exp
     (exp1 expression?)
     (exp2 expression?))
    (car-exp
     (body expression?))
    (cdr-exp
     (body expression?))
    (null?-exp
     (body expression?))
    ;;list实现
    (list-exp
     (args (list-of expression?)))
    
    ;; cond实现
    (cond-exp
     (conds (list-of expression?))
     (acts (list-of expression?)))
  
    ;;let let*
    (let-exp
     (vars (list-of symbol?))  ;;;symbol不能写成symbols
     (vals (list-of expression?))
     (body expression?))
    
    (let*-exp
     (vars (list-of symbol?)) ;(vars (list-of symbols?))
     (vals (list-of expression?))
     (body expression?))
    
    ;;print实现
    (print-exp
     (arg expression?))
    ;;unpack实现
    (unpack-exp
     (args (list-of symbol?));(args (list-of identifier?))
     (vals expression?)
     (body expression?))
    
    ;;proc
    (proc-exp
     (var (list-of symbol?))
     (body expression?))
    (call-exp
     (rator expression?)
     (rand (list-of expression?)))
    
    )
  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么添加上expression？反而出现如下的错误？&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(require &amp;quot;data-structures.scm&amp;quot;)
(require &amp;quot;lang.scm&amp;quot;)  =》 There are some problems here.
top.scm:8:11: module: identifier already imported from: &amp;quot;data-structures.scm&amp;quot; at: expression in: &amp;quot;lang.scm&amp;quot;
  #(174 21)
  #(235 10)
module: identifier already imported from a different source in:
  expression
  &amp;quot;lang.scm&amp;quot;
  &amp;quot;data-structures.scm&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;分析发现是因为lang.scm其实已经定义了expression?, &lt;code&gt;sllgen:make-define-datatypes&lt;/code&gt;中通过the grammer定义了所有的expression?的实现。
所以如果在&lt;code&gt;top.scm&lt;/code&gt;中同时导入&lt;code&gt;lang.scm&lt;/code&gt; 和&lt;code&gt;data-structures.scm&lt;/code&gt;则会报错，重复定义。
&lt;strong&gt;&lt;code&gt;于是仅仅在data-structures.scm中增加require &amp;quot;lang.scm&amp;quot;即可&lt;/code&gt;&lt;/strong&gt;,
&lt;font size=&#34;10&#34; color=&#34;red&#34;&gt;结果通过！&lt;/font&gt;&lt;/p&gt;
&lt;h3 id=&#34;正确的测试结果&#34;&gt;正确的测试结果&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;proc(x) -(x, 1)&amp;quot;)
(run &amp;quot;(proc(x) -(x,1)  30)&amp;quot;)
(run &amp;quot;(proc(f)(f 30)  proc(x)-(x,1))&amp;quot;)
(run &amp;quot;let x = 3 in -(x,1)&amp;quot;)
;;new stuff, the Currying
(run &amp;quot;let f = proc (x) proc (y) -(x, -(0, y)) in ((f 10) 20)&amp;quot;)

    (proc-val (procedure &#39;x (diff-exp (var-exp &#39;x) (const-exp 1)) (list (list &#39;i (num-val 1)) (list &#39;v (num-val 5)) (list &#39;x (num-val 10)))))
    (num-val 29)
    (num-val 29)
    (num-val 2)
    (num-val 30)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt; 2. 一个y-combination的实现 &lt;/h2&gt;
&lt;p&gt;关于y-combination可以参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/05/17/cong-lambdadao-simple-plus-complexjie-shi-qi-zai-dao-shu-xing-chou-xiang/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;从lambda到simple+complex解释器再到树形抽象&lt;/a&gt;疑问关于y-comb的实现。
进一步可以参考:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[Fixed-point combinator] &lt;a href=&#34;https://en.wikipedia.org/wiki/Fixed-point_combinator#Fixed_point_combinators_in_lambda_calculus&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[Church and Turing] &lt;a href=&#34;http://www.yinwang.org/blog-cn/2013/07/13/church-turing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[Neil Jones的computation and complexity,使用一种while语言] &lt;a href=&#34;http://www.diku.dk/~neil/comp2book2007/book-whole.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Matthias Felleisen 和 Matthew Flatt 的[《Programming Languages and Lambda Calculi》] &lt;a href=&#34;http://www.cs.utah.edu/~mflatt/past-courses/cs7520/public_html/s06/notes.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;8&lt;/a&gt; 教你认识lambda&lt;/li&gt;
&lt;li&gt;[最经典的Y combinator] &lt;a href=&#34;http://www.ece.uc.edu/~franco/C511/html/Scheme/ycomb.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;9&lt;/a&gt; 看了10遍以上&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;y-comb基本思想&#34;&gt;Y-comb基本思想&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;通过增加一层lambda表达式，进行更高一级抽象&lt;/li&gt;
&lt;li&gt;beta规约原则&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;比如&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define fact 
 (lambda (op)
   (lambda ( x y) (op  x y))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;比如&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(f arg) ==  (lambda (arg) (f arg))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最为基本的fact实现是(构建与已经存在的fact)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define fact
 (lambda (x)
   (if (zero? x)
      0
      (fact (- x 1)))))

(fact 5)

120
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;而如果运用思想1(也就是隐藏fact的调用，而使用局部过程变量procedure),则变换为&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define fact
   (lambda (procedure)
     (lambda (x)
        (if (zero? x)
           0
           (procedure (- x 1))))))


((fact fact) 5)

120
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;于是有了下面的推导过程(把fact的表达式多给他还原 ，可以参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/26/some-notations-in-the-design-of-the-language/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;还原方法Some-notations&lt;/a&gt;)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; (define fact
    ((lambda (procedure)
       ((lambda (func-arg)  ;;吸收5
          (lambda (n)
            (if (zero? n)
                1
                (* n (func-arg (- n 1))))))
        (lambda (arg) ((procedure procedure) arg))))
     (lambda (procedure)
       ((lambda (func-arg) ;;吸收5
          (lambda (n)
            (if (zero? n)
                1
                (* n (func-arg (- n 1))))))
        (lambda (arg) ((procedure procedure) arg))))))


  (((lambda (procedure)
      (lambda (n)
        (if (zero? n)
            1
            (* n ((procedure procedure) (- n 1))))))
    (lambda (procedure)
      (lambda (n)
        (if (zero? n)
            1
            (* n ((procedure procedure) (- n 1)))))))
   5)

 (define fact1
   (lambda (x)
   (letrec ((F (lambda (procedure)
       ((lambda (func-arg)  ;;吸收5
          (lambda (n)
            (if (zero? n)
                1
                (* n (func-arg (- n 1))))))
        (lambda (arg) ((procedure procedure) arg))))))
     ((F F) x))))


  (define Y
    (lambda (X)
      ((lambda (procedure)
         (X (lambda (arg) ((procedure procedure) arg))))
       (lambda (procedure)
         (X (lambda (arg) ((procedure procedure) arg)))))))

  (((lambda (X)
      ((lambda (procedure)
         (X (lambda (arg) ((procedure procedure) arg))))
       (lambda (procedure)
         (X (lambda (arg) ((procedure procedure) arg))))))
    (lambda (func-arg)
      (lambda (n)
        (if (zero? n)
            1
            (* n (func-arg (- n 1)))))))
   5)

;;如何吸收F 形成(F F)的形式 产生循环的调用过程
;; 只能是通过lambda 算子 构造proc 从而获得完整的表达式
  (((lambda (X)
      ((lambda (F)
         (lambda (arg) ((F F) arg)))  ;;一定要保证lambda封闭  
       (lambda (procedure)
         (X (lambda (arg) ((procedure procedure) arg))))))
    (lambda (func-arg)
      (lambda (n)
        (if (zero? n)
            1
            (* n (func-arg (- n 1)))))))
   5)

(define Y 
  (lambda (X)
      ((lambda (F)
         (lambda (arg) ((F F) arg)))  ;;一定要保证lambda封闭
       (lambda (procedure)
         (X (lambda (arg) ((procedure procedure) arg)))))))

((Y   (lambda (func-arg)
      (lambda (n)
        (if (zero? n)
            1
            (* n (func-arg (- n 1))))))) 5)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到每增加一层(lambada (arg) &amp;hellip;) ，也就是(lambda (arg) (lambda (arg2)  (lambda (arg) &amp;hellip; )))，
也就是  &lt;code&gt;&amp;lt;procedure&amp;gt;::= (lambda (arg) (&amp;lt;expression&amp;gt; |&amp;lt;procedure&amp;gt;)) | &amp;lt;procedure&amp;gt;&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id=&#34;3&#34;&gt;新语言的Y+实现&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;let makemult = proc (maker) proc (x)
      if zero?(x)
            then 0
      else
            -(((maker maker) -(x,1)), -4)
      in let times4 = proc (x) ((makemult makemult) x) in (times4 3)&amp;quot;)

;; ==&amp;gt; (num-val 12)

;;times
(run &amp;quot;let makemult = proc (maker) proc (x) proc(y)
      if zero?(x) then 0
      else -((((maker maker) -(x, 1)) y), -(0, y))
      in let times = proc(x) proc(y)
                    (((makemult makemult) x) y)
      in ((times 3) 8)&amp;quot;)

;; -&amp;gt; (num-val 24)

(run &amp;quot;let makemult = proc (maker) proc (x) proc(y)
      if zero?(x) then 0
      else -((((maker maker) -(x, 1)) y), -(0, y))
      in let times = proc(x) proc(y)
                    (((makemult makemult) x) y)
      in let f = proc(func) proc(num)
        if zero?(num)
           then 1
        else
           ((times ((func func) -(num, 1))) num)
      in let fact = proc (x) ((f f) x)
      in (fact 5)&amp;quot;)


(num-val 12)
(num-val 24)
(num-val 120)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最终提取一个更为精简的y-comb&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;

(run &amp;quot;let makerec = proc (f)
        let d = proc (x)
          proc (z) ((f (x x)) z)
        in proc (n) ((f (d d)) n)
     in let maketimes4 = proc (f) proc (x)
          if zero?(x)
             then 0
          else -((f -(x,1)), -4)
      in let times4 = (makerec maketimes4) in (times4 3)&amp;quot;)

    (num-val 12)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论&lt;/h2&gt;
&lt;p&gt;Y-comb是一个痛苦和希望的承载者(持保留意见)，韵味十足.又像一个走过岁月年轮，在家等待着归家儿女的思妇，祈祷，承担。
Y-Comb需要丝丝宁静,雨夜飘过。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>The Second Interpreter from One</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/27/the-second-interpreter-from-one/</link>
      <pubDate>Sat, 27 Feb 2016 01:04:52 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/27/the-second-interpreter-from-one/</guid>
      <description>&lt;p&gt;在[First Interpreter From EOPL][1]中我们定义了一个最为基本的解释器，包含解释以下解释部分&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;const-exp&lt;/li&gt;
&lt;li&gt;diff-exp&lt;/li&gt;
&lt;li&gt;zero?-exp&lt;/li&gt;
&lt;li&gt;if-exp&lt;/li&gt;
&lt;li&gt;var-exp&lt;/li&gt;
&lt;li&gt;let-exp&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这六种是比较基础的形式，在此基础上我们可以增加四则运算，加入list操作，加入逻辑比较&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;1. 增加四则运算&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1.1&#34;&gt;1.1 lang.scm修改四则运算&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#1.2&#34;&gt;1.2 interp.scm修改四则运算&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#1.3&#34;&gt;1.3 测试四则运算结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;2. 增加逻辑比较&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#2.1&#34;&gt;2.1 lang.scm修改逻辑比较&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2.2&#34;&gt;2.2 interp.scm修改逻辑比较&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2.3&#34;&gt;2.3 测试逻辑比较结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;3. 加入列表操作&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#3.1&#34;&gt;3.1 lang.scm修改列表操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.2&#34;&gt;3.2 interp.scm修改列表操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.3&#34;&gt;3.3 data-structures.scm增加了expval值类型和4个操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.4&#34;&gt;3.4 测试修改列表操作结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt;4. list具体实现&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#4.1&#34;&gt;4.1 lang.scm修改list具体实现&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.2&#34;&gt;4.2 interp.scm修改list具体实现&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.3&#34;&gt;4.3 data-structures.scm修改list的具体实现&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.4&#34;&gt;4.3 测试list具体实现结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5&#34;&gt;5. cond条件比较&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#5.1&#34;&gt;5.1 lang.scm修改cond条件比较&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.2&#34;&gt;5.2 interp.scm修改cond条件比较&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.3&#34;&gt;5.3 测试cond条件比较结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6&#34;&gt;6. print显示&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#6.1&#34;&gt;6.1 lang.scm修改print显示&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6.2&#34;&gt;6.2 interp.scm修改print显示&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6.3&#34;&gt;6.3 测试print显示结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7&#34;&gt;7. let的改进和let*的加入&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#7.1&#34;&gt;7.1 let改进之interp.scm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7.2&#34;&gt;7.2 let改进之lang.scm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7.3&#34;&gt;7.3 let改进结果&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7.4&#34;&gt;7.4 let*的lang.scm具体实现&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7.5&#34;&gt;7.5 let*的interp.scm具体实现&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7.6&#34;&gt;7.6 let*的测试结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#8&#34;&gt;8. unpack列表赋值&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#8.1&#34;&gt;8.1 unpack的interp.scm修改&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#8.2&#34;&gt;8.2 unpack的lang.scm修改&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#8.3&#34;&gt;8.3 测试unpack修改结果&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;1&#34;&gt; 1. 增加四则运算  &lt;/h2&gt;
&lt;h3 id=&#34;1.1&#34;&gt; 1.1 lang.scm修改四则运算&lt;/h3&gt;
&lt;p&gt;在the-grammer增加如下expressions&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;      ;;;new add + * /
    (expression (&amp;quot;+&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;) add-exp)
    (expression (&amp;quot;*&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;) mult-exp)
    (expression (&amp;quot;/&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;) div-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;1.2&#34;&gt; 1.2 interp.scm修改四则运算&lt;/h3&gt;
&lt;p&gt;在value-of增加如下expressions&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;           (add-exp (exp1 exp2)
		    (let ((val1 (value-of exp1 env))
			  (val2 (value-of exp2 env)))
		      (let ((num1 (expval-&amp;gt;num val1))
			    (num2 (expval-&amp;gt;num val2)))
			(num-val
			 (+ num1 num2)))))
           (mult-exp (exp1 exp2)
                     (let ((val1 (value-of exp1 env))
                           (val2 (value-of exp2 env)))
                       (let ((num1 (expval-&amp;gt;num val1))
                             (num2 (expval-&amp;gt;num val2)))
                         (num-val
                          (* num1 num2)))))
           (div-exp (exp1 exp2)
		    (let ((val1 (value-of exp1 env))
			  (val2 (value-of exp2 env)))
		      (let ((num1 (expval-&amp;gt;num val1))
			    (num2 (expval-&amp;gt;num val2)))
			(num-val
			 (/ num1 num2)))))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;1.3&#34;&gt; 1.3 测试四则运算结果&lt;/h3&gt;
&lt;p&gt;在原先减法的基础上增加了乘法、加法和除法。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;let x = -(4,1) in +(x,1)&amp;quot;)
(run &amp;quot;let x = -(4,1) in *(x,2)&amp;quot;)
(run &amp;quot;let x = -(4,1) in /(x,2)&amp;quot;)

结果:
    (num-val 4)
    (num-val 6)
    (num-val 1 1/2)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt; 2. 增加逻辑比较  &lt;/h2&gt;
&lt;h3 id=&#34;2.1&#34;&gt; 2.1 lang.scm修改逻辑比较&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; ;;增加逻辑比较
    (expression (&amp;quot;equal?&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;) equal?-exp)
    (expression (&amp;quot;less?&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;) less?-exp)
    (expression (&amp;quot;greater?&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;) greater?-exp)
    (expression (&amp;quot;minus&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;)&amp;quot;) minus-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2.2&#34;&gt; 2.2 interp.scm修改逻辑比较&lt;/h3&gt;
``` scheme
           (equal?-exp (exp1 exp2)
                    (let ((val1 (value-of exp1 env))
                          (val2 (value-of exp2 env)))
                      (let ((num1 (expval-&gt;num val1))
                            (num2 (expval-&gt;num val2)))
                        (bool-val
                         (= num1 num2)))))
&lt;pre&gt;&lt;code&gt;       (less?-exp (exp1 exp2)
                (let ((val1 (value-of exp1 env))
                      (val2 (value-of exp2 env)))
                  (let ((num1 (expval-&amp;gt;num val1))
                        (num2 (expval-&amp;gt;num val2)))
                    (bool-val
                     (&amp;lt; num1 num2)))))

       (greater?-exp (exp1 exp2)
                (let ((val1 (value-of exp1 env))
                      (val2 (value-of exp2 env)))
                  (let ((num1 (expval-&amp;gt;num val1))
                        (num2 (expval-&amp;gt;num val2)))
                    (bool-val
                     (&amp;gt; num1 num2)))))
    (minus-exp (body-exp)
              (let ((val1 (value-of body-exp env)))
                (let ((num (expval-&amp;gt;num val1)))
                  (num-val (- 0 num)))))
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
&amp;lt;h3 id=&amp;quot;2.3&amp;quot;&amp;gt; 2.3 测试增加逻辑比较结果&amp;lt;/h3&amp;gt;

``` scheme
(run &amp;quot;if less?(1, 2) then 1 else 2&amp;quot;)
(run &amp;quot;if greater?(2, 1) then minus(1) else minus(2)&amp;quot;)

    (num-val 1)
    (num-val -1)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3&#34;&gt; 3. 加入列表操作  &lt;/h2&gt;
&lt;h3 id=&#34;3.1&#34;&gt; 3.1 lang.scm修改列表操作&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;;; 增加list比较
        ;;new stuff
    (expression (&amp;quot;cons&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;) cons-exp)
    (expression (&amp;quot;car&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;)&amp;quot;) car-exp)
    (expression (&amp;quot;cdr&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;)&amp;quot;) cdr-exp)
    (expression (&amp;quot;emptylist&amp;quot;) emptylist-exp)
    (expression (&amp;quot;null?&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;)&amp;quot;) null?-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3.2&#34;&gt; 3.2 interp.scm修改列表操作&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;        ;;;增加了list操作
        (emptylist-exp ()
                      (emptylist-val))
        (cons-exp (exp1 exp2)
                 (let ((val1 (value-of exp1 env))
                       (val2 (value-of exp2 env)))
                   (pair-val val1 val2)))
        (car-exp (body)
                (expval-car (value-of body env)))
        (cdr-exp (body)
                (expval-cdr (value-of body env)))
        (null?-exp (exp)
                  (expval-null? (value-of exp env)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3.3&#34;&gt; 3.3 data-structures.scm增加了expval值类型和4个操作&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;修改expval部分&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;增加了&lt;code&gt;pair-val&lt;/code&gt;和&lt;code&gt;emptylist-val&lt;/code&gt; 两个语言的新值，这也是区分之前的&lt;a href=&#34;#1&#34;&gt;四则运算&lt;/a&gt;和&lt;a href=&#34;#2&#34;&gt;逻辑比较&lt;/a&gt;的过程&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;    (pair-val
     (car expval?)
     (cdr expval?))
    (emptylist-val)
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;增加了4个expval类型变换操作&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;;增加4个expval-&amp;gt;操作
(define expval-&amp;gt;pair
  (lambda (v)
    (cases expval v
	   (pair-val (car cdr)
		     (cons car cdr))
	   (else (expval-extractor-error &#39;pair v)))))

(define expval-car
  (lambda (v)
    (cases expval v
	   (pair-val (car cdr) car)
	   (else (expval-extractor-error &#39;car v)))))

(define expval-cdr
  (lambda (v)
    (cases expval v
	   (pair-val (car cdr) cdr)
	   (else (expval-extractor-error &#39;cdr v)))))

(define expval-null?
  (lambda (v)
    (cases expval v
	   (emptylist-val () (bool-val #t))
	   (else (bool-val #f)))))

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3.4&#34;&gt; 3.4 测试修改列表操作结果&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;cons(1, 2)&amp;quot;)
(run &amp;quot;car (cons (1, 2))&amp;quot;)
(run &amp;quot;cdr (cons (1, 2))&amp;quot;)
(run &amp;quot;null? (emptylist)&amp;quot;)
(run &amp;quot;null? (cons (1, 2))&amp;quot;)

(run &amp;quot;let x = 4
        in cons(x,
          cons(cons(-(x,1),
                    emptylist),
                   emptylist))&amp;quot;)

    (pair-val (num-val 1) (num-val 2))
    (num-val 1)
    (num-val 2)
    (bool-val #t)
    (bool-val #f)
    (pair-val (num-val 4) (pair-val (pair-val (num-val 3) (emptylist-val)) (emptylist-val)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;错误的测试：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;&amp;gt; (run &amp;quot;car (3 5 3)&amp;quot;)
. . parsing: at line 1: looking for &amp;quot;)&amp;quot;, found number 5 in production
((string &amp;quot;car&amp;quot;) (string &amp;quot;(&amp;quot;) (non-term expression) (string &amp;quot;)&amp;quot;) (reduce #&amp;lt;procedure:car-exp&amp;gt;))
&amp;gt; (run &amp;quot;car (3,5)&amp;quot;)
. . parsing: at line 1: looking for &amp;quot;)&amp;quot;, found literal-string111 &amp;quot;,&amp;quot; in production
((string &amp;quot;car&amp;quot;) (string &amp;quot;(&amp;quot;) (non-term expression) (string &amp;quot;)&amp;quot;) (reduce #&amp;lt;procedure:car-exp&amp;gt;))
&amp;gt; (run &amp;quot;null? ()&amp;quot;)
. . parsing: at line 1: nonterminal &amp;lt;expression&amp;gt; can&#39;t begin with literal-string111 &amp;quot;)&amp;quot;
&amp;gt; (run &amp;quot;car (cons (3,5))&amp;quot;)
(num-val 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体原因是car-exp的定义是通过expval-car的实现，而expval-car接受的是cons创造的数据结构，所以出现了问题。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  (car-exp (body) (expval-car (value-of body env)))


(pair-val
 (car expval?)
 (cdr expval?))
(emptylist-val)


(define expval-car
  (lambda (v)
    (cases expval v
     (pair-val (car cdr) car)   ;;v在这边是expval类型,更具体来说是pair-val,其他类型没有对应的操作
                                ;;而在当前的情况细 pair-val只能通过cons创建！！
     (else (expval-extractor-error &#39;car v)))))


并需要增加pair-var?的数据类型

  (define-datatype expval expval?
    (num-val
     (value number?))
    (bool-val
     (boolean boolean?))
    (pair-val
     (car expval?)
     (cdr expval?))
    (emptylist-val))


可以参考value-of中关于cons-exp的定义：
    (cons-exp (exp1 exp2)
             (let ((val1 (value-of exp1 env))
                   (val2 (value-of exp2 env)))
               (pair-val val1 val2)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;注意操作符后面不是必须直接跟上括号空格会被直接忽略-而是应该保证括号的对称性&#34;&gt;注意操作符后面不是必须直接跟上括号(空格会被直接忽略) 而是应该保证括号的对称性。&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;&amp;gt; (run &amp;quot;* (3,4&amp;quot;)
. . parsing: at line 1: looking for &amp;quot;)&amp;quot;, found end-marker #f in production
((string &amp;quot;*&amp;quot;) (string &amp;quot;(&amp;quot;) (non-term expression) (string &amp;quot;,&amp;quot;) (non-term expression) (string &amp;quot;)&amp;quot;) (reduce #&amp;lt;procedure:mult-exp&amp;gt;))
&amp;gt; (run &amp;quot;+(3,4)&amp;quot;)
(num-val 7)
&amp;gt; (run &amp;quot;*(3,4)&amp;quot;)
(num-val 12)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4&#34;&gt; 4.list的具体实现 &lt;/h2&gt;
&lt;h3 id=&#34;4.1&#34;&gt; 4.1 lang.scm修改list具体实现&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
    (expression (&amp;quot;list&amp;quot; &amp;quot;(&amp;quot; (separated-list expression &amp;quot;,&amp;quot;) &amp;quot;)&amp;quot; ) list-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4.2&#34;&gt; 4.2 interp.scm修改list具体实现&lt;/h3&gt; 
&lt;ol&gt;
&lt;li&gt;增加一个apply-elm用于list操作。&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;; used as map for the list
(define apply-elm
  (lambda (env)
    (lambda (elem)
      (value-of elem env))))
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;增加了list类型&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;;; 增加了list操作
  (list-exp (args)
           (list-val (map (apply-elm env) args)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4.3&#34;&gt; 4.3 data-structures.scm修改list的具体实现 &lt;/h3&gt;
&lt;p&gt;增加了list-val的实现:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;;;增加了list的具体实现
  (define list-val
  (lambda (args)
    (if (null? args)
	(emptylist-val)
	(pair-val (car args)
		  (list-val (cdr args))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4.4&#34;&gt; 4.4 测试list具体实现的结果&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;list(1, 2, 3)&amp;quot;)
(run &amp;quot;car(cdr(list(1, 2, 3)))&amp;quot;)
(run &amp;quot;let x = 4
      in list(x, -(x,1), -(x,3))&amp;quot;)

    (pair-val (num-val 1) (pair-val (num-val 2) (pair-val (num-val 3) (emptylist-val))))
    (num-val 2)
    (pair-val (num-val 4) (pair-val (num-val 3) (pair-val (num-val 1) (emptylist-val))))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5&#34;&gt;5. cond条件比较 &lt;/h2&gt;
&lt;h3 id=&#34;5.1&#34;&gt; 5.1 lang.scm修改cond条件比较 &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;;增加了cond具体语法
;; new stuff
(expression (&amp;quot;cond&amp;quot; (arbno expression &amp;quot;==&amp;gt;&amp;quot; expression) &amp;quot;end&amp;quot;) cond-exp)

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.2&#34;&gt; 5.2 interp.scm修改cond条件比较 &lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;增加一个cond-val，之所以不在类似&lt;a href=&#34;#3&#34;&gt;加入列表实现&lt;/a&gt;和&lt;a href=&#34;#4&#34;&gt;list具体实现&lt;/a&gt;添加val转换，是因为cond-val涉及到value-of
程序，所以需要放在interp.scm中,放在apply-elm之后即可.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;;增加了cond-val的处理
;;new stuff
(define cond-val
  (lambda (conds acts env)
    (cond ((null? conds)
	   (error &#39;cond-val &amp;quot;No conditions got into #t&amp;quot;))
	  ((expval-&amp;gt;bool (value-of (car conds) env))
	   (value-of (car acts) env))
	  (else
	   (cond-val (cdr conds) (cdr acts) env)))))
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;在value-of中增加了具体的实现&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;        ;;;增加了cond操作
        	   (cond-exp (conds acts)
		     (cond-val conds acts env))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.3&#34;&gt; 5.3 测试cond条件比较结果&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;less?(1, 2)&amp;quot;)
(run &amp;quot;cond less?(1, 2) ==&amp;gt; 2 end&amp;quot;)
(run &amp;quot;cond less?(2, 1) ==&amp;gt; 1 greater?(2, 2) ==&amp;gt; 2  greater?(3, 2) ==&amp;gt; 3 end&amp;quot;)

    (bool-val #t)
    (num-val 2)
    (num-val 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;6&#34;&gt; 6. print显示 &lt;/h2&gt;
&lt;h3 id=&#34;6.1&#34;&gt; 6.1 lang.scm修改print显示&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;; new stuff
    (expression (&amp;quot;print&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;)&amp;quot;) print-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;6.2&#34;&gt; 6.2 interp.scm修改print显示&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;        ;;;增加了print
        (print-exp (arg)
                  (let ((val (value-of arg env)))
                    ;(print val)  ;;编译不通过 改为display
                    (display val) ;
                    (num-val 1)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;6.3&#34;&gt; 6.3 测试print显示结果&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;print( less? (1, 2))&amp;quot;)
    #(struct:bool-val #t)(num-val 1)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;7&#34;&gt; 7. let的改进和let*的加入 &lt;/h2&gt;
&lt;h3 id=&#34;一个问题&#34;&gt;一个问题&lt;/h3&gt;
&lt;p&gt;怎么会有问题？&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; (run &amp;quot;let x = 30
      in let x = -(x,1)
             y = -(x,2)
         in -(x, y)&amp;quot;)
. . parsing: at line 3: looking for &amp;quot;in&amp;quot;, found identifier y in production
((string &amp;quot;let&amp;quot;) (term identifier) (string &amp;quot;=&amp;quot;) (non-term expression) (string &amp;quot;in&amp;quot;) (non-term expression) (reduce #&amp;lt;procedure:let-exp&amp;gt;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;分析原先的let设计程序&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        (let-exp (var exp1 body)       
                (let ((val1 (value-of exp1 env)))
                  (value-of body
                           (extend-env var val1 env))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在这个具体实现其实并没有实现多重let的过程，所以导致有问题，所以下一步的关键问题是如何实现嵌套的let-exp解析。&lt;/p&gt;
&lt;h3 id=&#34;7.1&#34;&gt; let改进之interp.scm 修改 &lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;增加两个let-exp的辅助程序&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;; let-exp的嵌套实现
  
  (define value-of-vals
    (lambda (vals env)
      (if (null? vals)
         &#39;()
         (cons (value-of (car vals) env)
              (value-of-vals (cdr vals) env)))))
  
  (define extend-env-list
    (lambda (vars vals env)
      (if (null? vars)
         env
         (let ((var1 (car vars))
               (val1 (car vals)))
           (extend-env-list (cdr vars) (cdr vals) (extend-env var1 val1 env))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;改变letexp的具体实现&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
 ;       (let-exp (var exp1 body)       
 ;               (let ((val1 (value-of exp1 env)))
 ;                (value-of body
 ;                          (extend-env var val1 env))))
        
        (let-exp (vars vals body)
                (let ((_vals (value-of-vals vals env)))
                  (value-of body (extend-env-list vars _vals env))))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;7.2&#34;&gt; 7.2 let改进之lang.scm  &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;    (expression
  ;     (&amp;quot;let&amp;quot; identifier &amp;quot;=&amp;quot; expression &amp;quot;in&amp;quot; expression)
  ;     let-exp)
      (expression 
        (&amp;quot;let&amp;quot; (arbno identifier &amp;quot;=&amp;quot; expression) &amp;quot;in&amp;quot; expression) 
        let-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;还是没改好？&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;link: bad variable linkage;
 reference to a variable that is uninitialized
  reference phase level: 0
  variable module: &amp;quot;/home/canbetter/let-lang/lang.scm&amp;quot;
  variable phase: 0
  reference in module: &amp;quot;/home/canbetter/let-lang/interp.scm&amp;quot; in: a-program?
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;原因出现在let语法中增加了 &lt;code&gt;(arbno ...)&lt;/code&gt;操作。&lt;/p&gt;
&lt;p&gt;这个问题可以赘述到cond-exp的实现,其中也涉及到arbno的第一次键入。但是为什么会出现未初始化变量的情况？&lt;/p&gt;
&lt;p&gt;但是主要还是因为保存得不彻底！！导致了并未初始化，重新保存即可。&lt;/p&gt;
&lt;h3 id=&#34;7.3&#34;&gt; 7.3 let改进结果 &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;let x = -(4,1) in let x =+(x,1) in -(x,10)&amp;quot;)

    (num-val -6)
(run &amp;quot;let x = -(4,1) in let x =+(x,1)  y=-(x,10) in -(x,y)&amp;quot;)

    (num-val 11) ;; x=4 y=-(3,10)=-7  所以-(x,y)=11而不是 10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;那么如何实现一个let*，使得let中的x变化的值立即反映到y中。&lt;/p&gt;
&lt;h3 id=&#34;7.4&#34;&gt; 7.4 let*的lang.scm具体实现 &lt;/h3&gt;
&lt;p&gt;该实现方式基本上和&lt;a href=&#34;#7.2&#34;&gt;let的语法&lt;/a&gt;一样&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;      (expression (&amp;quot;let*&amp;quot; (arbno identifier &amp;quot;=&amp;quot; expression) &amp;quot;in&amp;quot; expression) let*-exp)
      
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;7.5&#34;&gt; 7.5 let*的interp.scm具体实现 &lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;增加了一个extend-env-list-iter操作,由于也是存在value-of所以放入interp.scm中。&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  (define extend-env-list-iter
    (lambda(vars vals env)
      (if (null? vars)
         env
         (let ((var1 (car vars))
               (val1 (value-of (car vals) env)))
           (extend-env-list-iter (cdr vars) (cdr vals)
                                (extend-env var1 val1 env))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;let*的类型定义&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
        (let*-exp (vars vals body)
                 (value-of body (extend-env-list-iter vars vals env)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;7.6&#34;&gt; 7.6 let*的测试结果 &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(run &amp;quot;let x = 30
      in let x = -(x,1)
             y = -(x,2)
         in -(x, y)&amp;quot;)

(run &amp;quot;let x = 30
      in let* x = -(x,1)
             y = -(x,2)
         in -(x, y)&amp;quot;)


    (num-val 1)
    (num-val 2)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;8&#34;&gt; 8. unpack列表赋值 &lt;/h2&gt;
&lt;h3 id=&#34;8.1&#34;&gt; 8.1 unpack的interp.scm修改 &lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;增加了extend-env-list-exp的操作，用于针对unpack的特殊的环境拓展,当然可以把它放在data-structures.scm中&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;;; 关于unpack的操作
  (define extend-env-list-exp
    (lambda (vars vals env)
      (if (null? vars)
         env
         (let ((var1 (car vars))
               (val1 (expval-car vals)))
           (extend-env-list-exp (cdr vars)
                               (expval-cdr vals)
                               (extend-env var1 val1 env))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;unpack-exp的具体实现:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;        (unpack-exp (vars vals body)
                   (let ((_vals (value-of vals env)))
                     (value-of body (extend-env-list-exp vars _vals env))))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;8.2&#34;&gt; 8.2 unpack的lang.scm修改   &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;;new stuff
    (expression (&amp;quot;unpack&amp;quot; (arbno identifier) &amp;quot;=&amp;quot; expression &amp;quot;in&amp;quot; expression) unpack-exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;8.3&#34;&gt; 8.3 测试unpack修改结果  &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;; new testcase
(run &amp;quot;let u = 7
      in unpack x y = cons(u, cons(3,emptylist))
      in -(x,y)&amp;quot;)


(num-val 4)  ;;;(x y)= (7 3)  -(7,3)=4
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论&lt;/h2&gt;
&lt;p&gt;这是这对[First Interpreter From EOPL][1] 的8个方面的拓展，对于认识语言的设计有很大的帮助。&lt;/p&gt;
&lt;p&gt;1[]:http://jueqingsizhe66.github.io/blog/2016/02/25/first-interpreter-from-eopl/&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Ydiff单文件夹的所有scm文件比较</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/26/ydiffdan-wen-jian-jia-de-suo-you-scmwen-jian-bi-jiao/</link>
      <pubDate>Fri, 26 Feb 2016 18:29:08 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/26/ydiffdan-wen-jian-jia-de-suo-you-scmwen-jian-bi-jiao/</guid>
      <description>&lt;p&gt;关于YDIff处理已经在[使用Ydiff工具生成文件差异比较文件][1]中提及，但是只是比较了两个文件夹之间的文件，
而如果是较为简单的单个文件的所有文件的比较？类似思路如下所示，&lt;/p&gt;
&lt;p&gt;一定要注意数组使用的是小括号包括起来，否则程序有问题。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
#遍历当前目录下的所有文件 并进行比较 最终结果存入final-result
#array1=`ls *.scm`
array1=(`ls *.scm`)  # 必须加上括号
mkdir final-result
for i in `seq 0 $((${#array1[@]}-1))`; do 
    #遍历从i之后的文件
    for j in ${array1[@]:$i+1:${#array1[@]}}; do 
        #echo ${array1[$i]},$j;
        dir1=${array1[$i]};
        dir2=$j;
        # 选取对应文件夹下的scm文件
            #export TestVari=$i
            /home/happycamp-of-lisp/wangying/ydiff/diff-lisp $dir1 ${dir2}

    done;
done;
        mv *.html final-result
        cp ./nav.js ./diff.css final-result


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ls会找出当前文件夹下的所有scm文件，然后利用bash中的数组操作，使用双重
循环进行遍历即可。
[1]:http://jueqingsizhe66.github.io/blog/2016/02/22/shi-yong-ydiffgong-ju-sheng-cheng-wen-jian-chai-yi-bi-jiao-wen-jian/&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Some notations in the design of the language</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/26/some-notations-in-the-design-of-the-language/</link>
      <pubDate>Fri, 26 Feb 2016 15:35:17 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/26/some-notations-in-the-design-of-the-language/</guid>
      <description>&lt;p&gt;What does it mean by Kleene star? What can it be used for?
It is not so important,but a good tools to record the grammer
of the language.目的就是如何更简洁地定义语法。&lt;/p&gt;
&lt;h2 id=&#34;几个基本字符&#34;&gt;几个基本字符&lt;/h2&gt;
&lt;h3 id=&#34;nonterminal-symbols&#34;&gt;Nonterminal Symbols&lt;/h3&gt;
&lt;p&gt;指代被定义的集合名字(These are the names of the sets being defined)，比如List-of-Int,List-of-Char&amp;hellip;,
这些集合有时候也被叫做语义分类(syntactic categories)&lt;/p&gt;
&lt;p&gt;而且一般是of连接词是小写，其他表征类型的是大写(capitalized)。
这是一个习惯，当然如果指引某个单一的元素的时候我们会用小写字母，
比如 Expression is a nonterminal, 可以写成&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  e &amp;lt;- Expression  or
  e is an expression
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然我们也可以写成更为简单的形式，叫做Backus-Naur Form(BNF),即用尖括号包裹小写字母表达式，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; &amp;lt;expression&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;terminal-symbols&#34;&gt;Terminal Symbols:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;left parenthesis 左括号 &lt;code&gt;(&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;right parenthesis 右括号 &lt;code&gt;)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;period 句号 点号  &lt;code&gt;.&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;productionthe-rules&#34;&gt;Production(The rules)&lt;/h3&gt;
&lt;p&gt;The rules are called productions.每一个Production包含left-handside（lhs),right-handside(rhs),并用&lt;code&gt;::=&lt;/code&gt;来连接
lhs和rhs，&lt;code&gt;::=&lt;/code&gt;也被读作&lt;em&gt;is or can be&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lhs一般是nonterminal symbol,表征的是语义类(syntactic category)&lt;/li&gt;
&lt;li&gt;rhs一般是由terminal symbols(比如left and right parenthesis ,or period)和nonterminal symbols 组合起来。&lt;/li&gt;
&lt;li&gt;rhs的主要作用是用来按照其他语义分类(每一行都叫做一种语义分类）和Terminal symbolsl指定(specify)对应语义类
的构造成员的方法(a method of constructing the members of the syntactic category)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Int ::= (1 2 3 ....)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Double ::= (1.11246 1.2 1.3 ...)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Char ::= (a b c ...)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Float ::= (1.1 1.2 1.3 ...)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;List-of-Int ::= ()&lt;/code&gt;
&lt;code&gt;List-of-Int ::= (Int . List-of-Int)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Lists ::= ()|(Scheme Val . List)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当然有时候我们也可以忽略第二个语义类的List-of-Int,比如&lt;/p&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;&lt;code&gt;List-of-Int ::= ()&lt;/code&gt;
&lt;code&gt;            ::= (Int . List-of-Int)&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当然我们也可以只用一行来表示语义类（归一为一条语义）：使用vertical bar(| ),也被读作or&lt;/p&gt;
&lt;ol start=&#34;8&#34;&gt;
&lt;li&gt;&lt;code&gt;List-of-Int ::= ()|(Int . List-of-Int)&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;另外我们也可以使用一种更为简洁的形式： 使用 Kleene Star利用大括号(flower braces), &lt;code&gt;{}*&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;9&#34;&gt;
&lt;li&gt;&lt;code&gt;List-of-Int ::= ({Int}*)&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其中&lt;code&gt;*&lt;/code&gt;表示的是0个或者0个以上，也可以变换为&lt;code&gt;+&lt;/code&gt;。
&lt;code&gt;+&lt;/code&gt;:表示的是一个或者一个以上.&lt;/p&gt;
&lt;ol start=&#34;10&#34;&gt;
&lt;li&gt;&lt;code&gt;List-of-Int ::= ({Int}+)&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当然我们也可以规定Int之间的分割标志,利用seperation list&lt;/p&gt;
&lt;ol start=&#34;11&#34;&gt;
&lt;li&gt;&lt;code&gt;List-of-Int ::= ({Int}*(,))  &lt;/code&gt;
表示的是&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;8
1,2
3,4,6
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;List-of-Int ::= (&lt;code&gt;{Int}*(;)&lt;/code&gt;)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;8
1;2
3;4;6
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id=&#34;语义推导syntactic-derivation练习&#34;&gt;语义推导(Syntactic derivation)练习&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;(14 . ()) is a List-of-Int?&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;List-of-Int
=&amp;gt; (Int . (List-of-Int))
=&amp;gt; (14  . (List-of-Int))
=&amp;gt; (14  . ())

so, it is true.
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;(-7 . (3 . (14 . ()))) is a List-of-Int?&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;List-of-Int
=&amp;gt; (Int . (List-of-Int))
=&amp;gt; (-7  . (List-of-Int))
=&amp;gt; (-7  . (3 . (List-of-Int)))
=&amp;gt; (-7  . (3 . (14 . (List-of-Int))))
=&amp;gt; (-7  . (3 . (14 . ())))

so, it is true.
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;(a b c) is a S-list?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因为&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;S-list = ({S-exp}(`*`))
S-exp  = Symbol | S-list
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;S-list
=&amp;gt; ({S-exp}(*))
=&amp;gt; {Symbol | S-list}(*)
=&amp;gt; {a | S-list}(*)
=&amp;gt; {a b |S-list}(*)
=&amp;gt; {a b c}

so, it is S-list
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;(bar (biz 4 6) (foo 1 2)) is a binary tree?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;二叉树是非常重要的数据结构，它的定义形式是&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  Bintree ::= Int| (Symbol Bintree Bintree)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以我们可以这样解析&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; Bintree
=&amp;gt;(Int|(Symbol Bintree Bintree))
=&amp;gt;(bar (Int|(Symbol Bintree Bintree)) (Int|(Symbol Bintree Bintree)))
=&amp;gt;(bar (biz (Int|(Symbol Bintree Bintree)) (Int|(Symbol Bintree Bintree))) 
       (foo (Int|(Symbol Bintree Bintree)) (Int|(Symbol Bintree Bintree))))
=&amp;gt;(bar (biz 4 6) 
       (foo (Int|(Symbol Bintree Bintree)) (Int|(Symbol Bintree Bintree))))
=&amp;gt;(bar (biz 4 6) 
       (foo 1 2))

So,it is true

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;(lambda (x) (+ x 6)) is a lambda calculus&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;lambda calculus 是程序语言设计中十分重要的小型语言。该门语言仅仅包含&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;变量引用(varient references)&lt;/li&gt;
&lt;li&gt;单参过程(procedures that takes a single argument)&lt;/li&gt;
&lt;li&gt;过程调用(procedure calls)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;定义如下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   LcExp ::= Identifier
         ::= (lambda (Identifier) LcExp)
         ::= (LcExp LcExp)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以我们可以判断如下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; LcExp
=&amp;gt; Identifier|(lambda (Identifier) LcExp)|(LcExp LcExp)
=&amp;gt; (lambda (Identifier) LcExp)
=&amp;gt; (lambda (x) Identifier|(lambda (Identifier) LcExp)|(LcExp LcExp))
=&amp;gt; (lambda (x) (LcExp LcExp))
=&amp;gt; (lambda (x) (+ Identifier|(lambda (Identifier) LcExp)|(LcExp LcExp)
                  Identifier|(lambda (Identifier) LcExp)|(LcExp LcExp)))
=&amp;gt; (lambda (x) (+ x
                  Identifier|(lambda (Identifier) LcExp)|(LcExp LcExp)))
=&amp;gt; (lambda (x) (+ x
                  6))

So, it is true.


&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论&lt;/h2&gt;
&lt;p&gt;上米那说的List-of-Int,Bintree，Lambda calculus等都可以叫做一种语义类，是一门语言
包含的原始类型。上面的syntatic derivation也可以被用来当作理论证明的一种入门，本质是递归理论。&lt;/p&gt;
&lt;p&gt;而其实他们都可以当作最为基本的解释器，因为他们在不断的解析他们所识别的expressions，上面的LcExp,
List-exp等都叫做expressions，也是解释器的元素。&lt;/p&gt;
&lt;p&gt;而假如我们有一个函数&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nth-element : List * Int -&amp;gt; SchemeVal
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;他说明的是nth-element是一个接受List和Int作为形参并返回SchemeVal的过程，也就是它属于LcExp范畴。&lt;/p&gt;
&lt;h2 id=&#34;subst采用kleene-star进行书写&#34;&gt;subst采用kleene star进行书写&lt;/h2&gt;
&lt;p&gt;subst的定义是&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;subst : Sym * Sym * S-list -&amp;gt; S-list
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下面的实现过程从最为原始的只能处理lat的形式变为能够处理任意嵌套的expressions形式。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket

;;替换在slist中old值出现的值为new值（引用值）
(define subst-original
  (lambda (new old slist)
    (if (null? slist)
	&#39;()
	(cons
	       (if (eqv? (car slist) old)
               new
               (car slist))
	 (subst new old (cdr slist))))))

;;map改进失败
(define subst-wrong
  (lambda (new old lst)
    (map (lambda (x) (if (eq? x old) new old)) lst)))
;;通过map 简化subst-original的原始写法
(define subst-map
  (lambda (new old lst)
    (map (lambda (x) (if (eq? x old) new x)) lst)))

;;;通过subst改进S-expression to list-expression
(define subst
  (lambda (new old slist)
    (if (null? slist)
	&#39;()
	(cons
	 (let ((sexp (car slist)))
	   (if (symbol? sexp)
	       (if (eqv? sexp old)
               new
               sexp)
	       (subst new old sexp)))
	 (subst new old (cdr slist))))))

;;;通过map 改进subst
(define subst-map-improve
  (lambda (new old lst)
    (map (lambda (x) (if (symbol? x) (if (eq? x old) new x) (subst-map new old x))) lst)))

(subst-original  &#39;a &#39;b &#39;(a b c (b b) d b))
;&#39;(a a c (a a) d a)
(subst-map &#39;a &#39;b &#39;(a b c (b b) d b))
;&#39;(a a c (b b) d a)
(subst-wrong &#39;a &#39;b &#39;(a b c (b b) d b))  ;;;错误在于所有的非old值都替换为old值了
;&#39;(b a b b b a)
(subst &#39;a &#39;b &#39;(a b c (b b) d b))
;;&#39;(a a c (a a) d a)
(subst-map-improve &#39;a &#39;b &#39;(a b c (b b) d b))
;&#39;(a a c (a a) d a)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个拓展的例子虽然和表达式的注释主题关系不大，但是确是对于递归递归理论的进一步阐述。递归要求满足两个条件。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;递归出口(null? slt)  (zero? (car lst)) &amp;hellip;&lt;/li&gt;
&lt;li&gt;逐渐朝向递归出口的算子 (cdr lst) (- n 1) &amp;hellip;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;define-datatype的运用&#34;&gt;define-datatype的运用&lt;/h2&gt;
&lt;p&gt;具体实现可以查看&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/19/the-implementation-of-define-datetype/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;The Implementation of Define-datatype&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;lc-exp-和s-list的具体实现&#34;&gt;Lc-Exp 和S-list的具体实现&lt;/h3&gt;
&lt;p&gt;上文所提记得Lc-Exp的定义为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    lc-exp  ::=identifier
            ::=(lambda (identifier) Lc-exp
            ::=(lc-exp lc-exp)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;它使用define-datatype的实现如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(define-datatype lc-exp lc-exp?
    (var-exp (var identifier?))
    (lambda-exp (bound-var identifier?)
                (body lc-exp?))
    (app-exp (rator lc-exp?)
             (rand lc-exp?))
)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;而S-list的定义再现：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   S-list   ::=({S-exp}*) 
   S-exp:=Symbol|S-list
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;他对应的实现如下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(define-datatype s-list s-list?
    (empty-s-list)
    (non-empty-s-list
        (first s-exp?)
        (rest s-list?))
)
(define-datatype s-exp s-exp?
    (symbol-s-exp (sym symbol?))
    (s-list-s-exp (slst s-list?))
)

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;expression-和-expval的具体定义和实现&#34;&gt;expression 和 expval的具体定义和实现&lt;/h3&gt;
&lt;p&gt;在Interpreter的过程中肯定涉及到expression的设计和value值的表现（&lt;strong&gt;把exp和val的键值对叫做解释器的字典&lt;/strong&gt;）
expression的具体定义是&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;expression ::= (var-exp ())
           ::= (const-exp ())
           ::= (zero?-exp ())
           ::= (if-exp ())
           ::= (diff-exp ())
           ::= (cons-exp ())
           ::= (car-exp ())
           ::= (cdr-exp ())
           ::= (null?-exp ())
           ::= (emptylist-exp)
           ::= (list-exp ())
           ::= (let-exp ())
           ::= (proc-exp ())
           ::= (call-exp ())
           ::= (letrec-exp ())  ;;并未再此体现
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体实现如下所示:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;;;; datatype ;;;
(define-datatype expression expression?
  (var-exp
   (id symbol?))
  (const-exp
   (num number?))
  (zero?-exp
   (expr expression?))
  (if-exp
   (predicate-exp expression?)
   (true-exp expression?)
   (false-exp expression?))
  (diff-exp
   (exp1 expression?)
   (exp2 expression?))
  (emptylist-exp)
  (cons-exp
   (exp1 expression?)
   (exp2 expression?))
  (car-exp
   (body expression?))
  (cdr-exp
   (body expression?))
  (null?-exp
   (body expression?))
  (list-exp
   (args (list-of expression?)))
  (let-exp
   (vars (list-of symbols?))
   (vals (list-of expression?))
   (body expression?))
  (proc-exp
   (var (list-of symbol?))
   (body expression?))
  (call-exp
   (rator expression?)
   (rand (list-of expression?))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;expval的定义(主要是用于scheme value)如下:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; expval ::= (num-val ())
        ::= (bool-val ())
        ::= (proc-val ())
        ::= (pair-val ())
        ::= (emptylist-val)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体实现如下 所示：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;;;; an expressed value is either a number, a boolean or a procval.
(define-datatype expval expval?
  (num-val
   (value number?))
  (bool-val
   (boolean boolean?))
  (proc-val
   (proc proc?))
  (pair-val
   (car expval?)
   (cdr expval?))
  (emptylist-val))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;proc的具体定义如下，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  proc ::= (procedure ())
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;proc的实现如下所示：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;;; proc? : SchemeVal -&amp;gt; Bool
;; procedure : Var * Exp * Env -&amp;gt; Proc
(define-datatype proc proc?
  (procedure
   (var (list-of symbol?))
   (body expression?)
   (env environment?)))


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然具体的Define-datatype的定义还得配合&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/23/casesde-zuo-yong/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cases的作用&lt;/a&gt;进行实现。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>First Interpreter from EOPL</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/25/first-interpreter-from-eopl/</link>
      <pubDate>Thu, 25 Feb 2016 11:20:09 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/25/first-interpreter-from-eopl/</guid>
      <description>&lt;p&gt;这是EOPL一个最为基本的解释器，后面的解释器都在此基础上进行改造，所以
得理解各个部分，并知道如何使用和改造。最终告诉的是解释器如何解释表达式(每一种语言的表达式)。
&lt;strong&gt;解释器解释表达式的问题&lt;/strong&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;1. 测试Interpreter程序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;2. 测试结果&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;3. 反思结果&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#3.1&#34;&gt;3.1 非expressions部分&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.2&#34;&gt;3.2 expressions部分&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt;4. 是解决问题，还是抽象问题？科学性何在?&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#4.1&#34;&gt;4.1 科学性问题何在？&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.2&#34;&gt;4.2 一个解释器该解决哪些问题？&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.3&#34;&gt;4.3 抽象的目的是什么&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5&#34;&gt;5.一个解释器的具体实现&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#5.1&#34;&gt;5.1 语言前端表现形式&lt;/a&gt; lang&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.2&#34;&gt;5.2 语言数据结构&lt;/a&gt; data-structures&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.3&#34;&gt;5.3 语言中间阶段&lt;/a&gt; environments&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.4&#34;&gt;5.4 语言核心阶段&lt;/a&gt; interpreter&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.5&#34;&gt;5.5 语言的初始化&lt;/a&gt; drscheme-init&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.6&#34;&gt;5.6 语言的测试程序&lt;/a&gt; tests&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5.7&#34;&gt;5.7 语言前端封装测试&lt;/a&gt;Top&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;1&#34;&gt; 1. 测试Interpreter程序&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;
;;测试一个
(run-tests! run equal-answer? 
   &#39;(
      (positive &amp;quot;11&amp;quot; 11)
    ))

;;测试二个
(run-tests! run-fn equal-answer? 
   &#39;(
     (positive &amp;quot;11&amp;quot; 11)   
     (if-eval-test-true &amp;quot;if zero?(-(11,11)) then 3 else 4&amp;quot; 3)
    ))
   
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt; 2. 测试结果&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;one test: positive&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;    test: positive
    correct

    no bugs found

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;two tests:positive if-else&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;    test: positive
    correct

    test: if-eval-test-true
    correct

    no bugs found
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3&#34;&gt; 3. 反思结果&lt;/h2&gt;
&lt;p&gt;结果测试很理想并没有错误，并且可以在test中不断增加判断语句。
而run-test的解析分为两个部分&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;expressions 这部分的工作主要是value-of&lt;/li&gt;
&lt;li&gt;非expressions  这部分的主要工作就是sligen通过the-grammer的定义进行解析&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3.1&#34;&gt; 3.1 非expressions部分&lt;/h3&gt;
&lt;p&gt;这部分需要配合value-of的define-datatype进行对应的变化，且看the-grammer代码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
  (define the-grammar
    &#39;((program (expression) a-program)

      (expression (number) const-exp)
      (expression
        (&amp;quot;-&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;)
        diff-exp)
      
      (expression
       (&amp;quot;zero?&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;)&amp;quot;)
       zero?-exp)

      (expression
       (&amp;quot;if&amp;quot; expression &amp;quot;then&amp;quot; expression &amp;quot;else&amp;quot; expression)
       if-exp)

      (expression (identifier) var-exp)

      (expression
       (&amp;quot;let&amp;quot; identifier &amp;quot;=&amp;quot; expression &amp;quot;in&amp;quot; expression)
       let-exp)   

      ))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到if,then,else都被当作不变的地方，而其中三个expressions被传动到value-of做进一步的解析。&lt;/p&gt;
&lt;h3 id=&#34;3.2&#34;&gt; 3. expressions部分&lt;/h3&gt;
&lt;p&gt;继续看value-of的部分，则是对if-exp,var-exp,let-exp,letrec-exp,diff-exp,zerp?-exp?等进行解析的过程。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define value-of
    (lambda (exp env)
      (cases expression exp

        (const-exp (num) (num-val num))

        (var-exp (var) (apply-env env var))

        (diff-exp (exp1 exp2)
          (let ((val1 (value-of exp1 env))
                (val2 (value-of exp2 env)))
            (let ((num1 (expval-&amp;gt;num val1))
                  (num2 (expval-&amp;gt;num val2)))
              (num-val
                (- num1 num2)))))

        (zero?-exp (exp1)
          (let ((val1 (value-of exp1 env)))
            (let ((num1 (expval-&amp;gt;num val1)))
              (if (zero? num1)
                (bool-val #t)
                (bool-val #f)))))
              
        (if-exp (exp1 exp2 exp3)
          (let ((val1 (value-of exp1 env)))
            (if (expval-&amp;gt;bool val1)
              (value-of exp2 env)
              (value-of exp3 env))))

        (let-exp (var exp1 body)       
          (let ((val1 (value-of exp1 env)))
            (value-of body
              (extend-env var val1 env))))

        )))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/19/the-implementation-of-define-datetype/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cases的实现&lt;/a&gt;,以及&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/23/casesde-zuo-yong/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cases的作用&lt;/a&gt;
当然&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/#1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TLS&lt;/a&gt;也提供了比如*const,*application等的定义&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;第一大部分 定义好整体框架
(define value
 (lambda (e)
  (meaning e (quote ()))))
(define meaning
 (lambda (e table)
  ((expression-to-action e) e table))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中的&lt;code&gt;(expression-to-action)&lt;/code&gt;就会产生对应的&lt;code&gt;*const*,*identifier*,*lambda* ,*cond*,*quote*,*application*&lt;/code&gt;以及&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/#2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TSS&lt;/a&gt;中新增加的&lt;code&gt;*set*,*define*,*let*&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;这两个部分是比较有趣的地方，规范了语言的前端部分，犹如左右手交换来交换去和penrose-stair&lt;img src=&#34;https://jueqingsizhe66.github.io/images/penrose-stair.png&#34; alt=&#34;penrose-stair&#34;&gt;
,进一步可以看看&lt;a href=&#34;http://df.xq0510.blog.163.com/blog/static/16013465820108704920944/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;盗墓笔记(inception)的评述&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;4&#34;&gt; 4. 是解决问题，还是抽象问题？科学性何在?&lt;/h2&gt;
&lt;p&gt;科学进步的每一步发展，不是通过不断抽象来直觉抽取出进步，而是通过直觉发现问题，在利用抽象的方式进行求解，从而获得进步。
而抽象其实就是通过&lt;strong&gt;interface&lt;/strong&gt;和&lt;strong&gt;implementation&lt;/strong&gt;来进行，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;interface的定义就是通过&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/19/the-implementation-of-define-datetype/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;define-datatype&lt;/a&gt;进行，&lt;/li&gt;
&lt;li&gt;implementation则是通过cases进行。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;4.1&#34;&gt;4.1 科学性问题何在？&lt;/h3&gt;
&lt;p&gt;现象和本质的探寻，透过现象看到本质，现象的产生都有其内在的原理，科学关注的是内在的本质联系。
scheme这门语言可以透过不断的抽象，产生许许多多的语言，但是这些语言层是否真的对科学问题有帮助，
这是值得怀疑的地方！科学必须要有怀疑！科学必须找寻问题所在，从而探索产生原因（持保留意见）。&lt;/p&gt;
&lt;h3 id=&#34;4.2&#34;&gt;4.2 一个解释器该解决哪些问题？&lt;/h3&gt;
&lt;p&gt;最基本的我觉得应该有两个：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;词法解析问题
解决我输入的字符串，该如何由scan&amp;amp;parse进行解析&lt;/li&gt;
&lt;li&gt;语义解析问题
解决我得到的表达式(expression),它怎么由value-of进行解析，到底是const-exp,var-exp,proc-exp,let-exp等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其实语言系列的表达主要有&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;imperative language(C,fortran)&lt;/li&gt;
&lt;li&gt;functional programming language(Lisp,ML,Haskell,Scheme)&lt;/li&gt;
&lt;li&gt;message passing language(OOP: Java,C++,)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;他们在解析程序的过程中都离不开上述的两个基本问题的解析，他们也被叫做&lt;strong&gt;前端(front-end)&lt;/strong&gt;。&lt;img src=&#34;https://jueqingsizhe66.github.io/images/lisp/front-end.png&#34; alt=&#34;front-end&#34;&gt;&lt;/p&gt;
&lt;p&gt;而任何语言如果仅仅有这个value的过程，而不会产生任何的effects，
比如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;print&lt;/li&gt;
&lt;li&gt;read&lt;/li&gt;
&lt;li&gt;modify the memory state or file system&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;那就太没有意思了，所以语言的完成需要他拓充到操作系统的处理、IO处理、显示处理，增加它的趣味性，而不是一味的解决问题（持保留意见）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;词法解析使我们获得从字符串到对应的语言的const-exp等的exp形式&lt;/li&gt;
&lt;li&gt;语义解析部分则是我们对const-exp等的具体实现部分&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以本质上来说这两点也是抽象的组成部分（&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/15/data-representation-the-same-interface-with-different-implementation/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;接口和实现&lt;/a&gt;）,所以本质上解决解释器的实现问题，其实就是&lt;strong&gt;如何抽象的问题?&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;4.3&#34;&gt;4.3 抽象的目的是什么？&lt;/h3&gt;
&lt;p&gt;在于解决现实出现的科学问题。
也就是这些问题都能够被设定的接口和实现通过递归进行解释，并最终获得结果(result or outcome)。&lt;/p&gt;
&lt;p&gt;而为什么要绕来绕去的谈这些问题呢？ 因为interpreter的实现过程本质也是递归的思想，在不断规约到一个结论。&lt;/p&gt;
&lt;h2 id=&#34;5&#34;&gt;5. 一个解释器的具体实现&lt;/h2&gt;
&lt;p&gt;参考EOPL第三章.&lt;/p&gt;
&lt;p&gt;一般过程是先思考新语言的表现形式lang.scm，设定几个数据类型放入data-structures.scm中,
然后我们需要给这两个阶段设定bridge，也就是环境封装.这样我们就可以写一个解释器interpreter,解释并获得最终结果。
简而言之，其实我们就是想看看计算机是如何解释我们输入的这句话，具体就是&lt;a href=&#34;https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-35.html#%25_sec_5.5&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;解释器如何解析输入的表达式&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;语言&lt;a href=&#34;#5.1&#34;&gt;前端表现形式&lt;/a&gt; lang&lt;/li&gt;
&lt;li&gt;语言&lt;a href=&#34;#5.2&#34;&gt;数据结构&lt;/a&gt; data-structures&lt;/li&gt;
&lt;li&gt;语言&lt;a href=&#34;#5.3&#34;&gt;中间阶段&lt;/a&gt; environments&lt;/li&gt;
&lt;li&gt;语言&lt;a href=&#34;#5.4&#34;&gt;核心阶段&lt;/a&gt; interpreter&lt;/li&gt;
&lt;li&gt;语言的&lt;a href=&#34;#5.5&#34;&gt;初始化&lt;/a&gt; drscheme-init&lt;/li&gt;
&lt;li&gt;语言的&lt;a href=&#34;#5.6&#34;&gt;测试程序&lt;/a&gt; tests&lt;/li&gt;
&lt;li&gt;语言&lt;a href=&#34;#5.7&#34;&gt;前端封装测试&lt;/a&gt;Top&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;5.1&#34;&gt;5.1 前端表现形式&lt;/h3&gt;
&lt;p&gt;保存为lang.scm&lt;/p&gt;
&lt;p&gt;该阶段的主要目的就是定义新生成的语言该是如何使用的？也就是语法部分。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(module lang

  ;; grammar for the LET language

  (lib &amp;quot;eopl.ss&amp;quot; &amp;quot;eopl&amp;quot;)                
  
  (require &amp;quot;drscheme-init.scm&amp;quot;)
  
  (provide (all-defined-out))

  ;;;;;;;;;;;;;;;; grammatical specification ;;;;;;;;;;;;;;;;
  
  (define the-lexical-spec
    &#39;((whitespace (whitespace) skip)
      (comment (&amp;quot;%&amp;quot; (arbno (not #\newline))) skip)
      (identifier
       (letter (arbno (or letter digit &amp;quot;_&amp;quot; &amp;quot;-&amp;quot; &amp;quot;?&amp;quot;)))
       symbol)
      (number (digit (arbno digit)) number)
      (number (&amp;quot;-&amp;quot; digit (arbno digit)) number)
      ))
  
  (define the-grammar
    &#39;((program (expression) a-program)

      (expression (number) const-exp)
      (expression
        (&amp;quot;-&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;,&amp;quot; expression &amp;quot;)&amp;quot;)
        diff-exp)
      
      (expression
       (&amp;quot;zero?&amp;quot; &amp;quot;(&amp;quot; expression &amp;quot;)&amp;quot;)
       zero?-exp)

      (expression
       (&amp;quot;if&amp;quot; expression &amp;quot;then&amp;quot; expression &amp;quot;else&amp;quot; expression)
       if-exp)

      (expression (identifier) var-exp)

      (expression
       (&amp;quot;let&amp;quot; identifier &amp;quot;=&amp;quot; expression &amp;quot;in&amp;quot; expression)
       let-exp)   

      ))
  
  ;;;;;;;;;;;;;;;; sllgen boilerplate ;;;;;;;;;;;;;;;;
  
  (sllgen:make-define-datatypes the-lexical-spec the-grammar)
  
  (define show-the-datatypes
    (lambda () (sllgen:list-define-datatypes the-lexical-spec the-grammar)))
  
  (define scan&amp;amp;parse
    (sllgen:make-string-parser the-lexical-spec the-grammar))
  
  (define just-scan
    (sllgen:make-string-scanner the-lexical-spec the-grammar))
  
  )
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.2&#34;&gt;5.2 数据结构&lt;/h3&gt;
&lt;p&gt;保存为data-structures.scm&lt;/p&gt;
&lt;p&gt;该阶段的主要目的就是定义对应的类型该具有什么样的接口，这些接口的实现部分在第四部分有具体的体现。
这部分就是程序的&lt;strong&gt;类型接口的转换部分&lt;/strong&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(module data-structures (lib &amp;quot;eopl.ss&amp;quot; &amp;quot;eopl&amp;quot;)

  ;; data structures for let-lang.

  (provide (all-defined-out))               ; too many things to list

;;;;;;;;;;;;;;;; expressed values ;;;;;;;;;;;;;;;;

;;; an expressed value is either a number, a boolean or a procval.

  (define-datatype expval expval?
    (num-val
      (value number?))
    (bool-val
      (boolean boolean?)))

;;; extractors:

  ;; expval-&amp;gt;num : ExpVal -&amp;gt; Int
  ;; Page: 70
  (define expval-&amp;gt;num
    (lambda (v)
      (cases expval v
	(num-val (num) num)
	(else (expval-extractor-error &#39;num v)))))

  ;; expval-&amp;gt;bool : ExpVal -&amp;gt; Bool
  ;; Page: 70
  (define expval-&amp;gt;bool
    (lambda (v)
      (cases expval v
	(bool-val (bool) bool)
	(else (expval-extractor-error &#39;bool v)))))

  (define expval-extractor-error
    (lambda (variant value)
      (eopl:error &#39;expval-extractors &amp;quot;Looking for a ~s, found ~s&amp;quot;
	variant value)))

;;;;;;;;;;;;;;;; environment structures ;;;;;;;;;;;;;;;;

;; example of a data type built without define-datatype

  (define empty-env-record
    (lambda () 
      &#39;()))

  (define extended-env-record
    (lambda (sym val old-env)
      (cons (list sym val) old-env)))
  
  (define empty-env-record? null?)
  
  (define environment?
    (lambda (x)
      (or (empty-env-record? x)
          (and (pair? x)
               (symbol? (car (car x)))
               (expval? (cadr (car x)))
               (environment? (cdr x))))))

  (define extended-env-record-&amp;gt;sym
    (lambda (r)
      (car (car r))))

  (define extended-env-record-&amp;gt;val
    (lambda (r)
      (cadr (car r))))

  (define extended-env-record-&amp;gt;old-env
    (lambda (r)
      (cdr r)))

)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.3&#34;&gt;5.3 中间阶段&lt;/h3&gt;
&lt;p&gt;保存为environments.scm&lt;/p&gt;
&lt;p&gt;该阶段的主要目的是为了解释当遇到一些变量或者之后的解释器的lambda（将在下一个版本解释器体现），如何保存下来
，并供对应程序使用。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(module environments (lib &amp;quot;eopl.ss&amp;quot; &amp;quot;eopl&amp;quot;) 
  
  ;; builds environment interface, using data structures defined in
  ;; data-structures.scm. 

  (require &amp;quot;data-structures.scm&amp;quot;)

  (provide init-env empty-env extend-env apply-env)

;;;;;;;;;;;;;;;; initial environment ;;;;;;;;;;;;;;;;
  
  ;; init-env : () -&amp;gt; Env
  ;; usage: (init-env) = [i=1, v=5, x=10]
  ;; (init-env) builds an environment in which i is bound to the
  ;; expressed value 1, v is bound to the expressed value 5, and x is
  ;; bound to the expressed value 10.
  ;; Page: 69

  (define init-env 
    (lambda ()
      (extend-env 
       &#39;i (num-val 1)
       (extend-env
        &#39;v (num-val 5)
        (extend-env
         &#39;x (num-val 10)
         (empty-env))))))

;;;;;;;;;;;;;;;; environment constructors and observers ;;;;;;;;;;;;;;;;

  (define empty-env
    (lambda ()
      (empty-env-record)))
  
  (define empty-env? 
    (lambda (x)
      (empty-env-record? x)))

  (define extend-env
    (lambda (sym val old-env)
      (extended-env-record sym val old-env)))

  (define apply-env
    (lambda (env search-sym)
      (if (empty-env? env)
	(eopl:error &#39;apply-env &amp;quot;No binding for ~s&amp;quot; search-sym)
	(let ((sym (extended-env-record-&amp;gt;sym env))
	      (val (extended-env-record-&amp;gt;val env))
	      (old-env (extended-env-record-&amp;gt;old-env env)))
	  (if (eqv? search-sym sym)
	    val
	    (apply-env old-env search-sym))))))

  )
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.4&#34;&gt;5.4 核心阶段&lt;/h3&gt;
&lt;p&gt;保存为interp.scm&lt;/p&gt;
&lt;p&gt;该阶段的主要目的就是编写针对第3阶段生成的var-exp、const-exp等expval的解析，算是核心部分，最终的结果的产生地，
后面的几个阶段只不过是针对这部分内容做了一些前端的准备，算是死门，而这部分和前面的词法解析、类型转换接口算是一个语言的生门部分。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(module interp (lib &amp;quot;eopl.ss&amp;quot; &amp;quot;eopl&amp;quot;)
  
  ;; interpreter for the LET language.  The \commentboxes are the
  ;; latex code for inserting the rules into the code in the book.
  ;; These are too complicated to put here, see the text, sorry.

  (require &amp;quot;drscheme-init.scm&amp;quot;)

  (require &amp;quot;lang.scm&amp;quot;)
  (require &amp;quot;data-structures.scm&amp;quot;)
  (require &amp;quot;environments.scm&amp;quot;)

  (provide value-of-program value-of)

;;;;;;;;;;;;;;;; the interpreter ;;;;;;;;;;;;;;;;

  ;; value-of-program : Program -&amp;gt; ExpVal
  ;; Page: 71
  (define value-of-program 
    (lambda (pgm)
      (cases program pgm
        (a-program (exp1)
          (value-of exp1 (init-env))))))

  ;; value-of : Exp * Env -&amp;gt; ExpVal
  ;; Page: 71
  (define value-of
    (lambda (exp env)
      (cases expression exp

        (const-exp (num) (num-val num))

        (var-exp (var) (apply-env env var))

        (diff-exp (exp1 exp2)
          (let ((val1 (value-of exp1 env))
                (val2 (value-of exp2 env)))
            (let ((num1 (expval-&amp;gt;num val1))
                  (num2 (expval-&amp;gt;num val2)))
              (num-val
                (- num1 num2)))))

        (zero?-exp (exp1)
          (let ((val1 (value-of exp1 env)))
            (let ((num1 (expval-&amp;gt;num val1)))
              (if (zero? num1)
                (bool-val #t)
                (bool-val #f)))))
              
        (if-exp (exp1 exp2 exp3)
          (let ((val1 (value-of exp1 env)))
            (if (expval-&amp;gt;bool val1)
              (value-of exp2 env)
              (value-of exp3 env))))

        (let-exp (var exp1 body)       
          (let ((val1 (value-of exp1 env)))
            (value-of body
              (extend-env var val1 env))))

        )))


  )

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.5&#34;&gt;5.5 初始化&lt;/h3&gt;
&lt;p&gt;保存为drscheme-init.scm&lt;/p&gt;
&lt;p&gt;该阶段主要目的是编写测试需要的套件，提供测试是否成功的判断标准。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;; drscheme-init.scm - compatibility file for DrScheme
;; usage: (require &amp;quot;drscheme-init.scm&amp;quot;)

;;; makes structs printable, and provides basic functionality for
;;; testing.  This includes pretty-printing and tracing.


(module drscheme-init mzscheme

  ;; show the contents of define-datatype values
  (print-struct #t)

  (require (lib &amp;quot;pretty.ss&amp;quot;))
  (provide (all-from (lib &amp;quot;pretty.ss&amp;quot;)))

  (require (lib &amp;quot;trace.ss&amp;quot;))
  (provide (all-from (lib &amp;quot;trace.ss&amp;quot;)))

  (provide make-parameter)

  (provide 
   run-experiment
   run-tests!
   stop-after-first-error
   run-quietly
   )
  
  ;; safely apply procedure fn to a list of args.
  ;; if successful, return (cons #t val)
  ;; if eopl:error is invoked, returns (cons #f string), where string is the
  ;; format string generated by eopl:error.  If somebody manages to raise a 
  ;; value other than an exception, then the raised value is reported.
  
  (define apply-safely
    (lambda (proc args)
      (with-handlers ([(lambda (exn) #t)      ; catch any error
                       (lambda (exn)          ; evaluate to a failed test result
                         (cons #f 
                               (if (exn? exn)
                                   (exn-message exn)
                                   exn)))])  
        (let ([actual (apply proc args)])
          (cons #t actual)))))

  ;; run-experiment :
  ;;  ((a ...) -&amp;gt; b) * (a ...) * b * (b * b -&amp;gt; bool)
  ;;  -&amp;gt; (cons bool b)
  
  ;; usage: (run-experiment fn args correct-answer equal-answer?)
  ;; Applies fn to args.  Compares the result to correct-answer. 
  ;; Returns (cons bool b) where bool indicates whether the
  ;; answer is correct.

  (define run-experiment
    (lambda (fn args correct-answer equal-answer?)
      (let*
          ((result (apply-safely fn args))
           ;; ans is either the answer or the args to eopl:error
           (error-thrown? (not (car result)))
           (ans (cdr result)))
          
        (cons
         (if (eqv? correct-answer &#39;error)
             error-thrown?
             (equal-answer? ans correct-answer))
         ans))))
  
  (define stop-after-first-error (make-parameter #f))
  (define run-quietly (make-parameter #t))
   
  ;; run-tests! : (arg -&amp;gt; outcome) * (any * any -&amp;gt; bool) * (list-of test)
  ;;             -&amp;gt; unspecified

  ;; where:
  ;; test ::= (name arg outcome)
  ;; outcome ::= ERROR | any
  
  ;; usage: (run-tests! run-fn equal-answer? tests)

  ;; for each item in tests, apply run-fn to the arg.  Check to see if
  ;; the outcome is right, comparing values using equal-answer?.

  ;; print a log of the tests.

  ;; at the end, print either &amp;quot;no bugs found&amp;quot; or the list of tests
  ;; failed. 
  
  ;; Normally, run-tests! will recover from any error and continue to
  ;; the end of the test suite.  This behavior can be altered by
  ;; setting (stop-after-first-error #t).

  (define (run-tests! run-fn equal-answer? tests)
    (let ((tests-failed &#39;()))
      (for-each
       (lambda (test-item)
         (let ((name (car test-item))
               (pgm (cadr test-item))
               (correct-answer (caddr test-item)))
           (printf &amp;quot;test: ~a~%&amp;quot; name)
           (let* ((result
                   (run-experiment
		     run-fn (list pgm) correct-answer equal-answer?))
                  (correct? (car result))
                  (actual-answer (cdr result)))
             (if (or
                   (not correct?)
                   (not (run-quietly)))
               (begin
                 (printf &amp;quot;~a~%&amp;quot; pgm)
                 (printf &amp;quot;correct outcome: ~a~%&amp;quot; correct-answer)
                 (printf &amp;quot;actual outcome:  &amp;quot;)
                 (pretty-display actual-answer)))
             (if correct?
                 (printf &amp;quot;correct~%~%&amp;quot;)
                 (begin
                   (printf &amp;quot;incorrect~%~%&amp;quot;)
                   ;; stop on first error if stop-after-first? is set:
                   (if (stop-after-first-error)
                       (error name &amp;quot;incorrect outcome detected&amp;quot;)) 
                   (set! tests-failed
                         (cons name tests-failed)))))))
       tests)
      (if (null? tests-failed)
          (printf &amp;quot;no bugs found~%&amp;quot;)
          (printf &amp;quot;incorrect answers on tests: ~a~%&amp;quot;
            (reverse tests-failed)))))

  )  
  
  
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.6&#34;&gt;5.6 测试程序&lt;/h3&gt;
&lt;p&gt;保存为tests.scm&lt;/p&gt;
&lt;p&gt;该阶段的主要目的就是编写测试语句，包括常量、变量、表达式、if、diff、let等语句的使用。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(module tests mzscheme
  
  (provide test-list)

  ;;;;;;;;;;;;;;;; tests ;;;;;;;;;;;;;;;;
  
  (define test-list
    &#39;(
  
      ;; simple arithmetic
      (positive-const &amp;quot;11&amp;quot; 11)
      (negative-const &amp;quot;-33&amp;quot; -33)
      (simple-arith-1 &amp;quot;-(44,33)&amp;quot; 11)
  
      ;; nested arithmetic
      (nested-arith-left &amp;quot;-(-(44,33),22)&amp;quot; -11)
      (nested-arith-right &amp;quot;-(55, -(22,11))&amp;quot; 44)
  
      ;; simple variables
      (test-var-1 &amp;quot;x&amp;quot; 10)
      (test-var-2 &amp;quot;-(x,1)&amp;quot; 9)
      (test-var-3 &amp;quot;-(1,x)&amp;quot; -9)
      
      ;; simple unbound variables
      (test-unbound-var-1 &amp;quot;foo&amp;quot; error)
      (test-unbound-var-2 &amp;quot;-(x,foo)&amp;quot; error)
  
      ;; simple conditionals
      (if-true &amp;quot;if zero?(0) then 3 else 4&amp;quot; 3)
      (if-false &amp;quot;if zero?(1) then 3 else 4&amp;quot; 4)
      
      ;; test dynamic typechecking
      (no-bool-to-diff-1 &amp;quot;-(zero?(0),1)&amp;quot; error)
      (no-bool-to-diff-2 &amp;quot;-(1,zero?(0))&amp;quot; error)
      (no-int-to-if &amp;quot;if 1 then 2 else 3&amp;quot; error)

      ;; make sure that the test and both arms get evaluated
      ;; properly. 
      (if-eval-test-true &amp;quot;if zero?(-(11,11)) then 3 else 4&amp;quot; 3)
      (if-eval-test-false &amp;quot;if zero?(-(11, 12)) then 3 else 4&amp;quot; 4)
      
      ;; and make sure the other arm doesn&#39;t get evaluated.
      (if-eval-test-true-2 &amp;quot;if zero?(-(11, 11)) then 3 else foo&amp;quot; 3)
      (if-eval-test-false-2 &amp;quot;if zero?(-(11,12)) then foo else 4&amp;quot; 4)

      ;; simple let
      (simple-let-1 &amp;quot;let x = 3 in x&amp;quot; 3)

      ;; make sure the body and rhs get evaluated
      (eval-let-body &amp;quot;let x = 3 in -(x,1)&amp;quot; 2)
      (eval-let-rhs &amp;quot;let x = -(4,1) in -(x,1)&amp;quot; 2)

      ;; check nested let and shadowing
      (simple-nested-let &amp;quot;let x = 3 in let y = 4 in -(x,y)&amp;quot; -1)
      (check-shadowing-in-body &amp;quot;let x = 3 in let x = 4 in x&amp;quot; 4)
      (check-shadowing-in-rhs &amp;quot;let x = 3 in let x = -(x,1) in x&amp;quot; 2)

      ))
  )
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5.7&#34;&gt;5.7 前端封装测试&lt;/h3&gt;
&lt;p&gt;保存为top.scm&lt;/p&gt;
&lt;p&gt;该阶段的目的就是测试这个新的解释器语言到底有没有用？他是否能够解释从tests中导入的
程序片段？是否测试通过。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(module top (lib &amp;quot;eopl.ss&amp;quot; &amp;quot;eopl&amp;quot;)
  
  ;; top level module.  Loads all required pieces.
  ;; Run the test suite with (run-all).

  (require &amp;quot;drscheme-init.scm&amp;quot;)
  (require &amp;quot;data-structures.scm&amp;quot;)  ; for expval constructors
  (require &amp;quot;lang.scm&amp;quot;)             ; for scan&amp;amp;parse
  (require &amp;quot;interp.scm&amp;quot;)           ; for value-of-program
  (require &amp;quot;tests.scm&amp;quot;)            ; for test-list
  
  ;; since this is the top-level module, we don&#39;t really need to
  ;; provide anything, but we do so just in case.  

  (provide run run-all)

  (provide test-all)

  (define (test-all) (run-all))

  ;; here are some other things that could be provided:

  ;;   (provide (all-defined-out))
  ;;   (provide (all-from &amp;quot;interp.scm&amp;quot;))
  ;;   (provide (all-from &amp;quot;lang.scm&amp;quot;))
  
  ;;;;;;;;;;;;;;;; interface to test harness ;;;;;;;;;;;;;;;;
  
  ;; run : String -&amp;gt; ExpVal
  ;; Page: 71
  (define run
    (lambda (string)
      (value-of-program (scan&amp;amp;parse string))))
  
  ;; run-all : () -&amp;gt; unspecified
  
  ;; runs all the tests in test-list, comparing the results with
  ;; equal-answer?  

  (define run-all
    (lambda ()
      (run-tests! run equal-answer? test-list)))
  
  (define equal-answer?
    (lambda (ans correct-ans)
      (equal? ans (sloppy-&amp;gt;expval correct-ans))))
  
  (define sloppy-&amp;gt;expval 
    (lambda (sloppy-val)
      (cond
        ((number? sloppy-val) (num-val sloppy-val))
        ((boolean? sloppy-val) (bool-val sloppy-val))
        (else
         (eopl:error &#39;sloppy-&amp;gt;expval 
                     &amp;quot;Can&#39;t convert sloppy value to expval: ~s&amp;quot;
                     sloppy-val)))))
    
  ;; run-one : symbol -&amp;gt; expval

  ;; (run-one sym) runs the test whose name is sym
  
  (define run-one
    (lambda (test-name)
      (let ((the-test (assoc test-name test-list)))
        (cond
          ((assoc test-name test-list)
           =&amp;gt; (lambda (test)
                (run (cadr test))))
          (else (eopl:error &#39;run-one &amp;quot;no such test: ~s&amp;quot; test-name))))))
 
  ;; (run-all)
  
  )


&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;</description>
    </item>
    
    <item>
      <title>Chicago really only has 7 characters?</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/24/chicago-really-only-has-7-characters/</link>
      <pubDate>Wed, 24 Feb 2016 17:19:30 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/24/chicago-really-only-has-7-characters/</guid>
      <description>&lt;p&gt;我在听&lt;a href=&#34;http://v.youku.com/v_show/id_XMTQ3NDEwODUyNA==.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SICP的优酷视频&lt;/a&gt;时，听到“芝加哥也可以说是具有7个字符，同时他也可以表述为美国的中西部伊利诺伊州的全美第三大国际大都市”.
它可以仅仅表示语言的表面意思，也可以表示语言中的隐含意思。这体现了语言实现的一种魅力，Chicago really only has 7 characters?&lt;/p&gt;
&lt;h2 id=&#34;value&#34;&gt;Value&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Value，价值。&lt;/li&gt;
&lt;li&gt;scheme的每一个程序都是由exressions构成，每一个expression都对应一个expression value，简称expval。&lt;/li&gt;
&lt;li&gt;expval对应的有exp-val和den-val。&lt;/li&gt;
&lt;li&gt;exp-val表示表达式的值，也就是可能是变量绑定也可能是列表(表达式)的值；而den-val单单只是变量绑定。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;为了分析每一个价值的过程，姑且把程序写为&amp;laquo;expressions&amp;raquo;&lt;/p&gt;
&lt;p&gt;如果&lt;code&gt;expressions=((lambda (x) (+ x 3)) 10)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;那么scheme如何解析？&lt;/p&gt;
&lt;p&gt;假定我们的解析程序叫做value-of,init-env是我们的初始环境(变量绑定或者字典),[10]表示scheme-val(每一种语言都有着自己的value),
[x=10]init-env表示拓展的环境&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(value-of &amp;lt;&amp;lt;expressions&amp;gt;&amp;gt;)
         =(value-of &amp;lt;&amp;lt;((lambda (x) (+ x 3)) 10)&amp;gt;&amp;gt;)
         =(value-of ((lambda (x) (+ x 3)) 10) init-env)
         =(apply-procedure (value-of &amp;lt;&amp;lt;(lambda (x) (+ x 3))&amp;gt;&amp;gt; init-env) 
                           (value-of 10 init-env))
         =(apply-procedure (procedure x &amp;lt;&amp;lt;(+ x 3))&amp;gt;&amp;gt; init-env) 
                           [10])
         =(value-of &amp;lt;&amp;lt;(+ x 3))&amp;gt;&amp;gt; [x=10]init-env) 
         =(apply-procedure (value-of + [x=10]init-env)
                           (value-of x [x=10]init-env)
                           (value-of 3 [x=10]init-env)
                )
         = (apply-procedure (procedure + [x=10]init-env)
                           [10]
                           [3] 
                )
         =(+ (val-num [10])  (val-num [3]))
         =(+ 10 3)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;刚开始&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;也许你不可能替代&amp;laquo;&amp;raquo;表达式的意思，&lt;/li&gt;
&lt;li&gt;你也可能不理解解析10的过程，&lt;/li&gt;
&lt;li&gt;你也分不清出解析lambda和+的不同（一种是自定义程序，一种是内置operator），&lt;/li&gt;
&lt;li&gt;甚至你不可以静下心来好好分析我正在说的话。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我想表达的是，程序给你的是program or data，而你作为语言的创造者或者使用者，你需要进一步体味program是什么？
&lt;strong&gt;Does program really has only 7 characters?&lt;/strong&gt;(思考你写过的程序的各个部分的用途，如何来的？)&lt;/p&gt;
&lt;p&gt;进一步的解析可以&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/#4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;参考&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&#34;源语言到目标语言的转变&#34;&gt;源语言到目标语言的转变&lt;/h2&gt;
&lt;p&gt;有一种程序员喜欢利用各种语言所具有的特色，组合使用语言形成自己的程序，内部是控制流动和数据流动。而从第一种语言
也就是源语言(source language)开始，利用变换，输入到第二种、第三种…… ，最终输入到目标语言(target language).程序并不是
我们想的单一性的语言调用，每一个问题都可以通过新构造一种新的语言进行求解(持保留意见)。现在已经有人能够作出输入一种输入和输出
结果，从而产生你要的scheme程序，也就是产生对应的语言解决这个问题。然而我们更需要思考的是变的表面含义。&amp;ldquo;变&amp;quot;的是什么？
可深入了解Dan. Friedman的&lt;a href=&#34;http://www.eopl3.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;EOPL&lt;/a&gt;程序设计书籍。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>cases的作用</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/23/casesde-zuo-yong/</link>
      <pubDate>Tue, 23 Feb 2016 12:10:12 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/23/casesde-zuo-yong/</guid>
      <description>&lt;p&gt;为什么要实现&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/19/the-implementation-of-define-datetype/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cases&lt;/a&gt;,目的在于进一步抽象简化过程。&lt;/p&gt;
&lt;h2 id=&#34;原先的程序&#34;&gt;原先的程序&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;      procedure :   Var * Exp * Env -&amp;gt;  Proc
apply-procedure :   Proc * ExpVal   -&amp;gt;  ExpVal
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; ;; procedure : Var * Exp * Env -&amp;gt; Proc
 ;; Page: 79
  (define procedure
    (lambda (var body env)
      (lambda (val)
        (value-of body (extend-env var val env)))))
  
  ;; apply-procedure : Proc * ExpVal -&amp;gt; ExpVal
  ;; Page: 79
  (define apply-procedure
    (lambda (proc val)
      (proc val)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;简化的程序&#34;&gt;简化的程序&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;apply-procedure : Proc * ExpVal -&amp;gt; ExpVal
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;; apply-procedure : Proc * ExpVal -&amp;gt; ExpVal
  ;; Page: 79
  (define apply-procedure
    (lambda (proc1 val)
      (cases proc proc1
        (procedure (var body saved-env)
          (value-of body (extend-env var val saved-env))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;通过cases的proc1找到输入的expressions（scheme的expressions即是数据）,转移val分配到extend-env中，&lt;/li&gt;
&lt;li&gt;通过变量名和变量列表&lt;code&gt;(var body...)&lt;/code&gt;引入var，&lt;/li&gt;
&lt;li&gt;并形成&lt;code&gt;(var val)&lt;/code&gt;词汇表打入saved-env，&lt;/li&gt;
&lt;li&gt;最后利用value-of解析body，也就是解析由&lt;code&gt;(var body saved-env)&lt;/code&gt;构成的closure，递归解析所有的body,
如果proc1满足&lt;code&gt;(procedure (var body saved-env))&lt;/code&gt;的形式，则通过value-of进行解析.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;saved-env是假定的保存的环境变量，而对应的apply-procedure的最终结果是&lt;code&gt;(proc1 val)&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;value-of实现&#34;&gt;value-of实现&lt;/h2&gt;
&lt;p&gt;它是在语言设计阶段比较重要的实现，在其中可以存在很多的变种。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  ;; value-of : Exp * Env -&amp;gt; ExpVal
  (define value-of
    (lambda (exp env)
      (cases expression exp

        ;\commentbox{ (value-of (const-exp \n{}) \r) = \n{}}
        (const-exp (num) (num-val num))

        ;\commentbox{ (value-of (var-exp \x{}) \r) = (apply-env \r \x{})}
        (var-exp (var) (apply-env env var))

        ;\commentbox{\diffspec}
        (diff-exp (exp1 exp2)
          (let ((val1 (value-of exp1 env))
                (val2 (value-of exp2 env)))
            (let ((num1 (expval-&amp;gt;num val1))
                  (num2 (expval-&amp;gt;num val2)))
              (num-val
                (- num1 num2)))))

        ;\commentbox{\zerotestspec}
        (zero?-exp (exp1)
          (let ((val1 (value-of exp1 env)))
            (let ((num1 (expval-&amp;gt;num val1)))
              (if (zero? num1)
                (bool-val #t)
                (bool-val #f)))))
              
        ;\commentbox{\ma{\theifspec}}
        (if-exp (exp1 exp2 exp3)
          (let ((val1 (value-of exp1 env)))
            (if (expval-&amp;gt;bool val1)
              (value-of exp2 env)
              (value-of exp3 env))))

        ;\commentbox{\ma{\theletspecsplit}}
        (let-exp (var exp1 body)       
          (let ((val1 (value-of exp1 env)))
            (value-of body
              (extend-env var val1 env))))
        
        (proc-exp (var body)
          (proc-val (procedure var body env)))

        (call-exp (rator rand)
          (let ((proc (expval-&amp;gt;proc (value-of rator env)))
                (arg (value-of rand env)))
            (apply-procedure proc arg)))

        )))
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;在value-of中，如果exp满足&lt;code&gt;if-exp (exp1 exp2 exp3)&lt;/code&gt;则解析乘对应的，&lt;/li&gt;
&lt;li&gt;依次类推,当看到&lt;code&gt;let-exp (va exp1 body)&lt;/code&gt;的形式则对应的进行演变.&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>通过Scheme读取文件</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/22/tong-guo-schemedu-qu-wen-jian/</link>
      <pubDate>Mon, 22 Feb 2016 22:54:21 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/22/tong-guo-schemedu-qu-wen-jian/</guid>
      <description>&lt;ol&gt;
&lt;li&gt;通过IO monad的open-input-file 读取文件&lt;/li&gt;
&lt;li&gt;通过read-line 读取接口文件&lt;/li&gt;
&lt;li&gt;通过name-loop命名loop来循环读取文件。&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;通过文件句柄读取文件，这边接口就是文件句柄&lt;/li&gt;
&lt;li&gt;现在还不清楚文件模式的几种类型
&lt;ul&gt;
&lt;li&gt;text&lt;/li&gt;
&lt;li&gt;append&lt;/li&gt;
&lt;li&gt;write（是否有）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;eof-object?判断是否文件末尾&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define read-file
  (lambda (filename)
    (let ([port (open-input-file filename #:mode &#39;text)])
      (let loop ([line (read-line port)]
                 [all &amp;quot;&amp;quot;])
        (cond
         [(eof-object? line) all]
         [else
          (loop (read-line port)
                (string-append all line &amp;quot;\n&amp;quot;))])))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;从这边提取出一个最常用的let loop循环可以用于很多地方，重复几条语句分析所有程序&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
    (let loop ([start 0] [toks &#39;()])
      (letv ([(tok newstart) (scan1 s start)])
        (cond
         [(eq? tok &#39;eof)
          (reverse toks)]
         [else
          (loop newstart (cons tok toks))])))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外，比如onstack? 用于判断是否存于栈&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;

(define onstack?
  (lambda (u v stk)
    (let loop ([stk stk] [trace &#39;()])
      (cond
       [(null? stk) #f]
       [(and (eq? u (car (car stk)))
             (eq? v (cdr (car stk))))
        (reverse (cons (car stk) trace))]
       [else
        (loop (cdr stk) (cons (car stk) trace))]))))

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>使用Ydiff工具生成文件差异比较文件</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/22/shi-yong-ydiffgong-ju-sheng-cheng-wen-jian-chai-yi-bi-jiao-wen-jian/</link>
      <pubDate>Mon, 22 Feb 2016 19:24:53 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/22/shi-yong-ydiffgong-ju-sheng-cheng-wen-jian-chai-yi-bi-jiao-wen-jian/</guid>
      <description>&lt;p&gt;Ydiff是一个不错的lisp语法分析工具(&lt;a href=&#34;https://github.com/yinwang0/ydiff&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;王垠编制&lt;/a&gt;).下面是该工具简单用途和使用说明。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;用途
主要是js，cpp，和lisp的分析，现在也有&lt;a href=&#34;https://github.com/yinwang0/pysonar2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;python&lt;/a&gt;,&lt;a href=&#34;https://github.com/yinwang0/pysonar2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ruby&lt;/a&gt;的分析工具。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用说明&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;编译的时候仅仅在项目下载之后，make一下即可生成对应的diff-cpp,diff-js,diff-lisp分析工具.
文件分为单文件和文件夹两种。&lt;/p&gt;
&lt;h2 id=&#34;单文件使用说明&#34;&gt;单文件使用说明&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt; diff-lisp *.scm *1.scm 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;文件夹使用方式&#34;&gt;文件夹使用方式&lt;/h2&gt;
&lt;p&gt;保存下面源代码为process-lisp.sh&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
dir1=let-lang
dir2=letrec-lang
for i in `ls ${dir1}/*.scm`
do
    export TestVari=$i
    /home/happycamp-of-lisp/wangying/ydiff/diff-lisp $i ${dir2}/${TestVari##*\/}
done


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然也可以改为&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
dir1=let-lang
dir2=letrec-lang
for i in `ls ${dir1}/*.scm`
do
    /home/happycamp-of-lisp/wangying/ydiff/diff-lisp $i ${dir2}/${i##*\/}
done


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;只要修改对应的文件夹dir1,dir2,就可以分析对应文件夹的scm所有文件,然后运用下面命令行，即可生成
对应的html文件,方便阅读&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bash process-lisp.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;数组引入进一步修改处理程序&#34;&gt;数组引入进一步修改处理程序&lt;/h2&gt;
&lt;p&gt;数组的shell操作参考&lt;a href=&#34;http://blog.csdn.net/liufei_learning/article/details/8000570&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;如下&lt;/a&gt;,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;定义的时候通过小括号包裹&lt;/li&gt;
&lt;li&gt;调用的时候通过${}&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注意 &lt;a href=&#34;http://blog.csdn.net/flowingflying/article/details/5146160&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;数据运算&lt;/a&gt;和判断(&lt;strong&gt;注意只有在双括号的小于号才是小于号&lt;/strong&gt;)的两个中括号&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;seq 1 $((${#array1[@]}-1))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;测试过很多错误的情况，比如&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;array1=(`ls -l|grep ^d|awk &#39;{print $9}&#39;`); 
echo ${array1[@]:0:${#array1[@]}-1};
export length1=${!array1[@]}; 
for i in ${array1[@]:1:length1-1}; do 
    for j in ${array1[@]:$i:length1}; do 
        echo $i,$j;
    done;
done;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;原因在于,${!}操作并不是把它当作数组形式，所以改为数组即可，使用seq。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;length1=${!array1[@]}
echo $length1 
    0 1 2 3

echo ${#length1[@]}
    1

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;正确的过程(&lt;strong&gt;注意$i+1&lt;/strong&gt;)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;array1=(`ls -l|grep ^d|awk &#39;{print $9}&#39;`);  
for i in `seq 1 $((${#array1[@]}-1))`; do 
    for j in ${array1[@]:$i+1:${#array1[@]}}; do 
        echo ${array1[$i]},$j;
    done;
done;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果,满足组合公式&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1,letrec-lang
1,lexaddr-lang
1,proc-lang
2,lexaddr-lang
2,proc-lang
3,proc-lang

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;批处理解析scm文件&#34;&gt;批处理解析scm文件&lt;/h2&gt;
&lt;p&gt;当文件夹下存在如下文件下，则可以进一步利用&lt;a href=&#34;#pi&#34;&gt;程序&lt;/a&gt;进行分析，注意拷贝nav.js和diff.css进行渲染&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ls┌─[root][canbetter-N53SM][±][master ?:10 ✗][2.2.1][/home/happycamp-of-lisp/EOPL2014/DF-eopl/chapter3/proc-lang/ds-rep]
└─➞ ls
compiled  data-structures.scm  drscheme-init.scm  environments.scm  interp.scm  lang.scm  tests.scm  top.scm

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;pi&#34;&gt;批处理程序&lt;/h3&gt;
```
array1=(`ls -l|grep ^d|awk &#39;{print $9}&#39;`); 
# 遍历所有文件夹 除了最后一个
for i in `seq 1 $((${#array1[@]}-1))`; do 
    #遍历从i之后的文件
    for j in ${array1[@]:$i:${#array1[@]}}; do 
        #echo ${array1[$i]},$j;
        dir1=${array1[$i]};
        dir2=$j;
        mkdir ${dir1}-${dir2}
        # 选取对应文件夹下的scm文件
        for k in `ls ${dir1}/*.scm`
        do
            #export TestVari=$i
            /home/happycamp-of-lisp/wangying/ydiff/diff-lisp $k ${dir2}/${k##*\/} 
        done
&lt;pre&gt;&lt;code&gt;    mv *.html ${dir1}-${dir2}
    cp ./nav.js ./diff.css ${dir1}-${dir2}
done;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;done;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
然后可以在terminal运行
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;python -m SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;在浏览器输入
    http://localhost:8000/ 


### 有问题的数组下标

数组下表是从0开始的！
``` sh

array1=(`ls -l|grep ^d|awk &#39;{print $9}&#39;`); 
# 遍历所有文件夹 除了最后一个
for i in `seq 0 $((${#array1[@]}-1))`; do 
    #遍历从i之后的文件
    for j in ${array1[@]:$i+1:${#array1[@]}}; do 
        #echo ${array1[$i]},$j;
        dir1=${array1[$i]};
        dir2=$j;
        mkdir ${dir1}-${dir2}
        # 选取对应文件夹下的scm文件
        for k in `ls ${dir1}/*.scm`
        do
            #export TestVari=$i
            /home/happycamp-of-lisp/wangying/ydiff/diff-lisp $k ${dir2}/${k##*\/} 
        done

        mv *.html ${dir1}-${dir2}
        cp ./nav.js ./diff.css ${dir1}-${dir2}
    done;
done;

mkdir final-result
for i in `seq 0 $((${#array1[@]}-1))`; do 
    #遍历从i之后的文件
    for j in ${array1[@]:$i+1:${#array1[@]}}; do 
        #echo ${array1[$i]},$j;
        dir1=${array1[$i]};
        dir2=$j;
        mv ${dir1}-${dir2} final-result
    done;
done;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样就完成了文件夹下所有的文件对比操作，当然得确保该文件夹下存在scm文件。&lt;/p&gt;
&lt;h2 id=&#34;进一步修改ydiff&#34;&gt;进一步修改YDiff？&lt;/h2&gt;</description>
    </item>
    
    <item>
      <title>The implementation of define-datatype</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/19/the-implementation-of-define-datetype/</link>
      <pubDate>Fri, 19 Feb 2016 11:40:28 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/19/the-implementation-of-define-datetype/</guid>
      <description>&lt;p&gt;设计一个语言很重要的一点就是有一个工具来创建接口，define-datatype和cases就是这种工具&lt;/p&gt;
&lt;h2 id=&#34;define-datatype&#34;&gt;define-datatype&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;; NOTE: datatypes are currently transparent, for the sake of EoPL&#39;s
;; use of `equal?&#39;

#lang racket/base

(require (for-syntax racket/base &amp;quot;private/utils.rkt&amp;quot;))

(define-syntax (define-datatype stx)
  (syntax-case stx ()
    [(_ name pred-name
        (variant-name (field-name field-pred) ...)
        ...)
     (let ([variant-names (syntax-&amp;gt;list #&#39;(variant-name ...))])
       ;; More syntax checks...
       (unless (identifier? #&#39;name)
         (raise-syntax-error
          #f &amp;quot;expected an identifier for the datatype name&amp;quot; stx #&#39;name))
       (unless (identifier? #&#39;pred-name)
         (raise-syntax-error
          #f &amp;quot;expected an identifier for the predicate name&amp;quot; stx #&#39;pred-name))
       (for ([vt     (in-list variant-names)]
             [fields (in-list (syntax-&amp;gt;list #&#39;((field-name ...) ...)))])
         (unless (identifier? vt)
           (raise-syntax-error
            &#39;cases &amp;quot;expected an identifier for the variant name&amp;quot; stx vt))
         (for ([field (in-list (syntax-&amp;gt;list fields))])
           (unless (identifier? field)
             (raise-syntax-error
              &#39;cases &amp;quot;expected an identifier for the field name&amp;quot; stx field))))
       ;; Count the fields for each variant:
       (with-syntax ([(variant-field-count ...)
                      (for/list ([x (in-list (syntax-&amp;gt;list
                                              #&#39;((field-name ...) ...)))])
                        (datum-&amp;gt;syntax (quote-syntax here)
                                       (length (syntax-&amp;gt;list x))
                                       #f))]
                     [(variant? ...)
                      (for/list ([vn (in-list variant-names)])
                        (datum-&amp;gt;syntax
                         vn
                         (string-&amp;gt;uninterned-symbol
                          (format &amp;quot;~a?&amp;quot; (syntax-e vn)))))]
                     [(variant-accessor ...)
                      (for/list ([vn (in-list variant-names)])
                        (datum-&amp;gt;syntax
                         vn
                         (string-&amp;gt;uninterned-symbol
                          (format &amp;quot;~a-accessor&amp;quot; (syntax-e vn)))))]
                     [(variant-mutator ...)
                      (generate-temporaries variant-names)]
                     [(make-variant ...)
                      (generate-temporaries variant-names)]
                     [(struct:variant ...)
                      (generate-temporaries variant-names)]
                     [(make-variant-name ...)
                      (for/list ([vn (in-list variant-names)])
                        (datum-&amp;gt;syntax
                         vn
                         (string-&amp;gt;symbol
                          (format &amp;quot;make-~a&amp;quot; (syntax-e vn)))))])
         #&#39;(begin
             (define-syntax name
               ;; Note: we&#39;re back to the transformer environment, here.
               ;; Also, this isn&#39;t a transformer function, so any direct
               ;;  use of the name will trigger a syntax error. The name
               ;;  can be found by `syntax-local-value&#39;, though.
               (let ([cert (syntax-local-certifier #t)])
                 (make-dt (cert #&#39;pred-name)
                          (list (make-vt (cert #&#39;variant-name)
                                         (cert #&#39;variant?)
                                         (cert #&#39;variant-accessor)
                                         variant-field-count)
                                ...))))
             ;; Bind the predicate and selector functions:
             (define-values (pred-name
                             variant-name ...
                             variant? ...
                             variant-accessor ...)
               ;; Create a new structure for the datatype (using the
               ;; datatype name in `struct&#39;, so it prints nicely).
               (let-values ([(struct:x make-x x? acc mut)
                             (make-struct-type &#39;name #f 0 0 #f null (make-inspector))])
                 (let-values ([(struct:variant make-variant variant?
                                variant-accessor variant-mutator)
                               (make-struct-type &#39;variant-name struct:x variant-field-count 0
                                                 #f
                                                 null
                                                 (make-inspector))]
                              ...)
                   ;; User-available functions:
                   (values
                    x? ;; The datatype predicate
                    ;; Create the constructor functions:
                    (let* ([vname &#39;variant-name]
                           [variant-name
                            (lambda (field-name ...)
                              (unless (field-pred field-name)
                                (error vname &amp;quot;bad value for ~a field: ~e&amp;quot;
                                       &#39;field-name field-name))
                              ...
                              (make-variant field-name ...))])
                      variant-name)
                    ...
                    variant? ...
                    variant-accessor ...))))
             ;; Compatibility bindings
             (define-values (make-variant-name ...) (values variant-name ...)))))]
    [(_ name pred-name variant ...)
     ;; Must be a bad variant...
     (for ([variant (in-list (syntax-&amp;gt;list #&#39;(variant ...)))])
       (syntax-case variant ()
         [(variant-name field ...)
          (let ([name #&#39;variant-name])
            (unless (identifier? name)
              (raise-syntax-error
               #f &amp;quot;expected an identifier for the variant name&amp;quot; stx name))
            ;; Must be a bad field:
            (for ([field (in-list (syntax-&amp;gt;list #&#39;(field ...)))])
              (syntax-case field ()
                [(field-name field-pred)
                 (let ([name #&#39;field-name])
                   (unless (identifier? name)
                     (raise-syntax-error
                      #f &amp;quot;expected an identifier for the field name&amp;quot; stx name)))]
                [_else
                 (raise-syntax-error
                  #f &amp;quot;expected a field name followed by a predicate expression, all in parentheses&amp;quot; stx field)])))]
         [_else
          (raise-syntax-error
           #f &amp;quot;expected a variant name followed by a sequence of field declarations, all in parentheses&amp;quot; stx variant)]))]
    [(_ name)
     (raise-syntax-error
      #f &amp;quot;missing predicate name and variant clauses&amp;quot; stx)]))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;cases&#34;&gt;cases&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define-syntax (cases stx)
  (syntax-case stx ()
    [(_ datatype expr
        clause
        ...)
     ;; Get datatype information:
     (let ([dt (and (identifier? #&#39;datatype)
                    (syntax-local-value #&#39;datatype (lambda () #f)))])
       (unless (dt? dt)
         (raise-syntax-error &#39;cases &amp;quot;not a datatype name&amp;quot; stx #&#39;datatype))

       ;; Parse clauses:
       (define-values (vts field-idss bodys else-body)
         (let loop ([clauses (syntax-&amp;gt;list #&#39;(clause ...))]
                    [saw-cases null])
           (if (null? clauses)
             (values null null null #f)
             (let ([clause (car clauses)])
               (syntax-case* clause ()
                             (lambda (a b)
                               (and (eq? (syntax-e b) &#39;else)
                                    (not (identifier-binding b))))
                 [(variant (field-id ...) body0 body1 ...)
                  (let* ([variant #&#39;variant]
                         [vt (ormap (lambda (dtv)
                                      (define vt-name (vt-name-stx dtv))
                                      (and (free-identifier=? variant vt-name)
                                           dtv))
                                    (dt-variants dt))]
                         [orig-variant (and vt (vt-name-stx vt))])
                    (unless orig-variant
                      (raise-syntax-error
                       #f
                       (format &amp;quot;not a variant of `~a&#39;&amp;quot;
                               (syntax-&amp;gt;datum #&#39;datatype))
                       stx
                       variant))

                    (let ([field-ids (syntax-&amp;gt;list #&#39;(field-id ...))])
                      (for ([fid (in-list field-ids)])
                        (unless (identifier? fid)
                          (raise-syntax-error
                           #f &amp;quot;expected an identifier for a field&amp;quot; stx fid)))
                      (let ([dtv (variant-assq variant (dt-variants dt))])
                        (unless (= (length field-ids) (vt-field-count dtv))
                          (raise-syntax-error
                           #f
                           (format
                            &amp;quot;variant case `~a&#39; for `~a&#39; has wrong field count (expected ~a, found ~a)&amp;quot;
                            (syntax-&amp;gt;datum variant)
                            (syntax-&amp;gt;datum #&#39;datatype)
                            (vt-field-count dtv)
                            (length field-ids))
                           stx
                           clause)))

                      ;; Check for duplicate local field ids:
                      (let ([dup (check-duplicate-identifier field-ids)])
                        (when dup
                          (raise-syntax-error
                           #f &amp;quot;duplicate field identifier&amp;quot; stx dup)))

                      ;; Check for redundant case:
                      (when (memq orig-variant saw-cases)
                        (raise-syntax-error #f &amp;quot;duplicate case&amp;quot; stx clause))

                      ;; This clause is ok:
                      (let-values ([(vts idss bodys else)
                                    (loop (cdr clauses) (cons orig-variant saw-cases))])
                        (values (cons vt vts)
                                (cons field-ids idss)
                                (cons #&#39;(begin body0 body1 ...) bodys)
                                else))))]
                 [(else body0 body1 ...)
                  (begin
                    (unless (null? (cdr clauses))
                      (raise-syntax-error
                       #f &amp;quot;else clause must be last&amp;quot; stx clause))
                    (values null null null #&#39;(begin body0 body1 ...)))]
                 [_else (raise-syntax-error #f &amp;quot;bad clause&amp;quot; stx clause)])))))
       ;; Missing any variants?
       (unless (or else-body (= (length vts) (length (dt-variants dt))))
         (define here (map vt-name-stx vts))
         (define missing
           (let loop ([l (dt-variants dt)])
             (cond [(null? l) &amp;quot;&amp;quot;]
                   [(ormap (lambda (i) (free-identifier=? (vt-name-stx (car l)) i)) here)
                    (loop (cdr l))]
                   [else (format &amp;quot; ~a~a&amp;quot;
                                 (syntax-e (vt-name-stx (car l)))
                                 (loop (cdr l)))])))
         (raise-syntax-error
          #f
          (format &amp;quot;missing cases for the following variants:~a&amp;quot; missing)
          stx))

       ;; Create the result:
       (with-syntax ([pred (dt-pred-stx dt)]
                     [(variant? ...) (map vt-predicate-stx vts)]
                     [((field-extraction ...) ...)
                      (for/list ([vt (in-list vts)])
                        (with-syntax ([accessor (vt-accessor-stx vt)])
                          (let loop ([n 0])
                            (if (= n (vt-field-count vt))
                              null
                              (cons #`(accessor v #,n)
                                    (loop (add1 n)))))))]
                     [((field-id ...) ...) field-idss]
                     [(body ...) bodys]
                     [else-body (or else-body
                                    #&#39;(error &#39;cases &amp;quot;no variant case matched&amp;quot;))])
         #&#39;(let ([v expr])
             (if (not (pred v))
               (error &#39;cases &amp;quot;not a ~a: ~s&amp;quot; (quote datatype) v)
               (cond
                 [(variant? v)
                  (let ([field-id field-extraction] ...)
                    body)]
                 ...
                 [else else-body])))))]))


&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;provide-datatype&#34;&gt;provide-datatype&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define-syntax (provide-datatype stx)
  (syntax-case stx ()
    [(_ datatype)
     (let ([dt (syntax-local-value #&#39;datatype (lambda () #f))])
       (unless (dt? dt)
         (raise-syntax-error #f &amp;quot;not a datatype name&amp;quot; stx #&#39;datatype))
       (with-syntax ([pred (dt-pred-stx dt)]
                     [(orig-variant ...) (map vt-name-stx (dt-variants dt))])
         #&#39;(provide datatype pred orig-variant ...)))]))

(provide define-datatype cases provide-datatype)



&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;基本形式&#34;&gt;基本形式&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define-datatype typename type-predicate-name
{(varient-name {(field-name predicate)}*)}+
)

(cases type-name expression
    {(variant-name ({field-name}*) consequent)}*
    (else default)
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一般type-predicate-name 和predicate 都是胃词判断&lt;/p&gt;
&lt;h2 id=&#34;lambda-church&#34;&gt;lambda church&lt;/h2&gt;
&lt;p&gt;lambda church expression(lc-exp)::=identifier
::=(lambda (identifier) Lc-exp
::=(lc-exp lc-exp)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define-datatype lc-exp lc-exp?
    (var-exp (var identifier?))
    (lambda-exp (bound-var identifier?)
                (body lc-exp?))
    (app-exp (rator lc-exp?)
             (rand lc-exp?))
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;S-list::=({s-exp}*)
s-exp:=Symbol|S-list&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define-datatype s-list s-list?
    (empty-s-list)
    (non-empty-s-list
        (first s-exp?)
        (rest s-list?))
)
(define-datatype s-exp s-exp?
    (symbol-s-exp (sym symbol?))
    (s-list-s-exp (slst s-list?))
)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;进一步使用&#34;&gt;进一步使用？&lt;/h2&gt;</description>
    </item>
    
    <item>
      <title>vim的乐趣</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/18/vimde-le-qu/</link>
      <pubDate>Thu, 18 Feb 2016 02:55:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/18/vimde-le-qu/</guid>
      <description>&lt;p&gt;vim有很多基础教程，我看过比较好的是&lt;a href=&#34;http://yannesposito.com/Scratch/en/blog/Learn-Vim-Progressively/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;learn vim progressively&lt;/a&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;% : Go to the corresponding (, {, [&lt;/li&gt;
&lt;li&gt;* (resp. #) : go to next (resp. previous) occurrence of the word under the cursor&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;abstract&#34;&gt;Abstract：&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#1&#34;&gt;1）在屏幕中移动光标&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#2&#34;&gt;2）在行内移动光标&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#3&#34;&gt;3）屏幕滚动&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#4&#34;&gt;4）多屏操作&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#4.1&#34;&gt;4.1 启动时候分屏 &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.2&#34;&gt;4.2 运行期间分屏&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.3&#34;&gt;4.3 运行期间光标移屏&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.4&#34;&gt;4.4 运行期间屏幕切换&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.5&#34;&gt;4.5 运行期间调整窗口大小&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.6&#34;&gt;4.6 运行期间关闭窗口&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;vi &amp;amp; vim 有编译模式与命令模式，下述光标移动操作均为命令模式下操作；&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;下文中以 ^ 符表示 Ctrl 键被按下，如 ^F 标示 Ctrl 与 F 键被同时按下；&lt;/li&gt;
&lt;li&gt;下文中以 + 号表示按下某键后再按另外按键，如 z + Enter 表示先按下 z 键，再按下 Enter 键；&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;1&#34;&gt;1，在屏幕中移动光标：&lt;/h2&gt;
&lt;p&gt;vi &amp;amp; vim 命令行模式操作移动光标位置都是指移动到要编辑单词、字母的前面。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    按键                                           操作描述
    h                                           光标左移一个字符；
    j                                           光标下移一行；
    k                                           光标上移一行；
    l                                           光标右移一个字符；

    数值  +  G                                  光标移至“数值”所指行的行首；
    ^H                                          光标移至当前屏幕显示首行的行首；
    ^M                                          光标移至当前屏幕显示的中间行的行首；
    ^L                                          光标移至当前屏幕显示的最后一行的行首；
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt;2，在文件行内移动光标：&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;    vi &amp;amp; vim 命令行模式操作光标行内移动，单词间以空格作为分隔字符，标点符号看作一个单词。

    按键                                          操作描述
    0    （数字零）                             光标移动到光标所在行的行首；
    $                                           光标移动到光标所在行的行末；
    w                                           光标移动到下一个单词的首字母前；
    b                                           光标移动到上一个单词的首字母前；
    e                                           光标移动到当前光标所在单词的最后字符前；
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3&#34;&gt;3，屏幕滚动：&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;    按键                                            操作描述
    ^F                                            屏幕向下滚动一屏；==&amp;gt;屏
    ^B                                            屏幕向上滚动一屏；
    ^D                                            屏幕向下滚动半屏；==&amp;gt;半屏
    ^U                                            屏幕向上滚动半屏；
    ^E                                            屏幕向下滚动一行；==&amp;gt;行
    ^Y                                            屏幕向上滚动一行；
    z + Enter                                     滚动屏幕，使当前光标所在行处于屏幕第一行；
    z + .                                         滚动屏幕，使当前光标所在行处于屏幕中间行；
    z + -                                         滚动屏幕，使当前光标所在行处于屏幕最后一行；
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4&#34;&gt;4, 多屏操作&lt;/h2&gt;
&lt;h3 id=&#34;4.1&#34;&gt; 4.1 启动时候分屏 &lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-vim&#34;&gt;vim -on/-On filename1 filename2....
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;小写的o表示水平拆分，&lt;/li&gt;
&lt;li&gt;大写的O表示垂直拆分，&lt;/li&gt;
&lt;li&gt;n表示需要拆分的个数，最后面跟上拆分后需要打开的文件名称&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;4.2&#34;&gt; 4.2 运行期间分屏 &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;     按键                                         操作描述
    :sp [filename]                              水平拆分出一个窗格，后面可以接要打开的文件名，如果没有则将当前窗口进行拆分
    :vsp [filename]                             垂直拆分出一个窗格
    :new [filename]                             水平拆分
    ^w+s                                        等效于:sp不带filename效果
    ^w+v                                        等效于:vsp不带filename效果
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4.3&#34;&gt; 4.3 运行期间光标移屏 &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;     按键                                         操作描述
    ^w+h                                        光标移动到左边窗口
    ^w+j                                        光标移动到下面窗口
    ^w+k                                        光标移动到上面窗口
    ^w+l                                        光标移动到右边窗口
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4.4&#34;&gt; 4.4 运行期间屏幕切换 &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;     按键                                         操作描述
    ^w+H                                        将当前窗口移动到最左边
    ^w+J                                        将当前窗口移动到最下面
    ^w+K                                        将当前窗口移动到最上面
    ^w+L                                        将当前窗口移动到最右边
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4.5&#34;&gt; 4.5 运行期间调整窗口大小 &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;     按键                                        操作描述
    ^w+=                                        一样大高度
    ^w+-                                        减小高度
    ^w++                                        增加高度

    ^w+&amp;lt;                                        减小宽度      ==&amp;gt;后来才知道分着这么细
    ^w+&amp;gt;                                        增大宽度
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4.6&#34;&gt; 4.6 运行期间关闭屏幕 &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;     按键                                        操作描述
    ^w+o                                        只留下当前窗口,其他窗口都进行关闭   ===&amp;gt;改命令很有作用！
    ^w+c                                        关闭当前窗口，若是最后一个 提示是否关闭
    ^w+q                                        关闭当前窗口，若是最后一个 仍然不提是关闭


    ^w+&amp;lt;                                        减小宽度
    ^w+&amp;gt;                                        增大宽度
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>基于continuation的cps表达式，保存计算过程</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/17/ji-yu-continuationde-cpsbiao-da-shi-bao-cun-ji-suan-guo-cheng/</link>
      <pubDate>Wed, 17 Feb 2016 16:55:50 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/17/ji-yu-continuationde-cpsbiao-da-shi-bao-cun-ji-suan-guo-cheng/</guid>
      <description>&lt;p&gt;CPS其实是实现branch分支的一种scheme技术，对于程序流程的控制具有
重要的作用。下面就一个细节对CPS进行简单说明。&lt;/p&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;nav id=&#34;TableOfContents&#34;&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#如果改变1-为3呢&#34;&gt;如果改变+1 为+3呢？&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#cps分析最好记住下面的分析方法&#34;&gt;CPS分析最好记住下面的分析方法&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define r #f)
(+ 1 (call/cc
(lambda (k)
(set! r k)
(+ 2 (k 3)))))

(r 0)
(r 10)

结果：
    4     ==&amp;gt; (+ 1 3)
    1     ==&amp;gt; (+ 1 0)
    11    ==&amp;gt; (+ 1 10)
分析：
    一般形式是 (+ 1 [])
    []代表着continuation的值，而整个continuation的返回值确是(+ 3 [c])
    在第一种情况下是3,紧接着0,最后10

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;如果改变1-为3呢&#34;&gt;如果改变+1 为+3呢？&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(+ 3 (call/cc
(lambda (k)
(set! r k)
(+ 2 (k 3)))))

(r 0)
(r 10)

结果:
    6     ==&amp;gt;(+ 3 3)
    3     ==&amp;gt;(+ 3 0)
    13    ==&amp;gt;(+ 3 10)


分析：
    一般形式是 (+ 3 [])
    []代表着continuation的值，而整个continuation的返回值确是(+ 3 [c])
    在第一种情况下是3,紧接着0,最后10
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;cps分析最好记住下面的分析方法&#34;&gt;CPS分析最好记住下面的分析方法&lt;/h2&gt;
&lt;p&gt;具体的过程参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Dead_Program&lt;/a&gt;,包括rember8的修改。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;Let&#39;s trace (rember8  (lambda (x) x))

ls | k

&#39;(1 2 8 3 4 6 7 8 5) | (lambda (x) x) = id
&#39;(2 8 3 4 6 7 8 5)   | (lambda (x) (id (cons 1 x))) = k2
&#39;(8 3 4 6 7 8 5)     | (lambda (x) (k2 (cons 2 x))) = k3  ==&amp;gt;不断存储计算结果

Once we hit the 8, we apply (k (cdr ls)) where k is k3 and ls is &#39;(8 3
4 6 7 8 5)

(k3 &#39;(3 4 6 7 8 5)) = (k2 (cons 2 &#39;(3 4 6 7 8 5)))      ==&amp;gt; what is k2?
(k2 &#39;(2 3 4 6 7 8 5)) = (id (cons 1 &#39;(2 3 4 6 7 8 5)))  ==&amp;gt; what is id?
(id &#39;(1 2 3 4 6 7 8 5)) = &#39;(1 2 3 4 6 7 8 5)            ==&amp;gt; what is final result?

And we&#39;re done.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;之所以写这个note的目的也是为了能够分析continuation的返回值。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>scheme IO实现来自于CPS或者haskell的monod范畴思想</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/17/scheme-ioshi-xian-lai-zi-yu-cpshuo-zhe-haskellde-monodfan-chou-si-xiang/</link>
      <pubDate>Wed, 17 Feb 2016 10:58:46 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/17/scheme-ioshi-xian-lai-zi-yu-cpshuo-zhe-haskellde-monodfan-chou-si-xiang/</guid>
      <description>&lt;p&gt;scheme中IO的实现类似于CPS在原来函数的基础上增加了一个控制变量。&lt;/p&gt;
&lt;p&gt;之前曾经写过&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CPS的控制过程&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;original-style&#34;&gt;original style&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define rember8
  (lambda (ls)
    (cond
      [(null? ls) &#39;()]
      [(= (car ls) 8) (cdr ls)]
      [else (cons (car ls) (rember8 (cdr ls)))])))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;cps-style&#34;&gt;cps style&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;1
(define rember8
  (lambda (ls k)
    (cond
      [(null? ls) (k &#39;())]                           ==&amp;gt; k
      [(= (car ls) 8) (cdr ls)]
      [else (cons (car ls) (rember8 (cdr ls)))])))

;2
(define rember8
  (lambda (ls k)
    (cond
      [(null? ls) (k &#39;())]
      [(= (car ls) 8) (k (cdr ls))]                  ==&amp;gt;k
      [else (rember8 (cdr ls) (lambda (x) (cons (car ls) x)))]))) ==&amp;gt; rember8

;3
(define rember8
  (lambda (ls k)
    (cond
      [(null? ls) (k &#39;())]
      [(= (car ls) 8) (k (cdr ls))]
      [else (rember8 (cdr ls) (lambda (x) (k (cons (car ls) x)))]))) ==&amp;gt;  k 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个k的作用将在IO中体现出来。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define o (open-output-file &amp;quot;greeting.txt&amp;quot;))
(display &amp;quot;hello&amp;quot; o)
(write-char #\space o)
(display &#39;world o)
(newline o)
(close-output-port o)


&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;结果：
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/greeting.png&#34; alt=&#34;result&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;其他io语法&#34;&gt;其他IO语法&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;open-input-file&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;;打开文件句柄 用于读操作
(define in10 (open-input-file &amp;quot;greeting.txt&amp;quot;))
;;利用read-char 读取单个字符char
(read-char in10)
(read-char in10)
(read-char in10)
;;利用read 读取一个字word
(read in10)
(read in10)
;;利用read-line读取一行字符
(read-line in10)
(read-line in10)
(read in10)

;;结果
    #\h             ==&amp;gt;read-char
    #\e             ==&amp;gt;read-char
    #\l             ==&amp;gt;read-char
    &#39;lo             ==&amp;gt;read
    &#39;world          ==&amp;gt;read
    &amp;quot;&amp;quot;              ==&amp;gt;read-line
    &amp;quot;made in DaXi&amp;quot;  ==&amp;gt;read-line
    #&amp;lt;eof&amp;gt;          ==&amp;gt;read
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;open-input-string&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; (define i (open-input-string &amp;quot;hello world&amp;quot;))
 (read-char i)
    #\h       ==&amp;gt;read-char
 (read-char i)
    #\e       ==&amp;gt;read-char
 (read-char i)
    #\l       ==&amp;gt;read-char
 (read i)
    &#39;lo       ==&amp;gt;read
 (read i)
    &#39;world    ==&amp;gt;read
 (read i)
    #&amp;lt;eof&amp;gt;    ==&amp;gt;read
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;open-output-string&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;;;定义字符串变量
(define op (open-output-string))
(write &#39;hello op)
(write-char #\, op)
(display &amp;quot; &amp;quot; op)
(display &amp;quot;world&amp;quot; op)

;;获取存取的值
(get-output-string op)


;;结果
    &amp;quot;hello,world&amp;quot;    ==&amp;gt; get-output-string
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中o的作用其实就是类似于k的作用，都是体现者一种程序的控制一种续延（具体未讲的十分清楚，待以后补充load等）。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>let and letrec makes programming orient object</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/16/let-and-letrec-makes-programming-orient-object/</link>
      <pubDate>Tue, 16 Feb 2016 21:35:15 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/16/let-and-letrec-makes-programming-orient-object/</guid>
      <description>&lt;p&gt;面向对象已经大行其道，而在scheme是如何实现，本文仅仅是刹那的思路，
可以通过let来定义局部变量，而可以通过letrec定义method的过程来实现
面向对象的数据抽象的能力。&lt;/p&gt;
&lt;h2 id=&#34;let-不具备局部传递功能&#34;&gt;let 不具备局部传递功能&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define  x 10)  ;;; x的值不会影响到局部变量的值
(let ((x 1) (y 2) (z 3))
   (list  x y z))

(define  x 10) ;;;x的值会影响到局部变量的值
(let ((x 1) (y x) (z 3))
   (list  x y z))

;结果
    (1 2 3)
    (1 10 3) 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;第一次注意看let的实现&#34;&gt;第一次注意看let的实现&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define-syntax
    (syntax-rules ()
        ((let ((var expr) ...) body ...) ((lambda (var ...) body ...) expr ...))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(let ((x 2) (y 3)) (+  x y)) 转变为
((lambda (x y) (+ x y)) 2 3) 的形式.&lt;/p&gt;
&lt;h2 id=&#34;let-star-具备局部传递功能&#34;&gt;let star 具备局部传递功能&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(let* (( x  1) (y  x) (z 3))
  (list x  y z))


;结果
    (1 1 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外有一种叫做fluid-let的暂时没有在这边出现&lt;/p&gt;
&lt;h2 id=&#34;letrec-具备自指的能力递归&#34;&gt;letrec 具备自指的能力(递归)&lt;/h2&gt;
&lt;p&gt;如果想定义一个procedure局部变量？
如果用let 或者let*都无法达到此目的，因为他们不能自指（也就是没有递归的能力）
而如果是letrec则是拥有此功能&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(letrec
    ((my-even? (lambda (x)
              (if (zero? x) #t
                 (my-odd? (-  x 1)))))
     (my-odd? (lambda (x)
                (if (zero? x) #f
                   (my-even? (- x 1))))))
  (my-even? 10) ;
  (my-odd? 10) ;;只会打印出最后一个结果
  )


;结果
    #f
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;named-let-一种更加紧凑的letrec&#34;&gt;Named Let 一种更加紧凑的letrec&lt;/h3&gt;
&lt;p&gt;在上文，let是用来指定局部变量，而letrec是来指定procedure，
现在我们可以用Named let来使letrec写起来更加紧凑些，但是
不适合书写多个局部方法的情况，比如：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(letrec ((countdown (lambda (i)
                      (if(= i 0) &#39;ole
                         (begin
                           (display i)
                           (newline)
                           (countdown (- i 1)))))))
  (countdown 10)) 

结果:
    10
    9
    8
    7
    6
    5
    4
    3
    2
    1
    &#39;ole
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(let countdown ((i 10))
  (if (= i 0) &#39;ole
     (begin
       (display i)
       (newline)
       (countdown (- i 1)))))

结果:
    10
    9
    8
    7
    6
    5
    4
    3
    2
    1
    &#39;ole
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;进一步实现留待以后&#34;&gt;进一步实现留待以后&lt;/h2&gt;</description>
    </item>
    
    <item>
      <title>Data Representation-The Same interface with Different implementation</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/15/data-representation-the-same-interface-with-different-implementation/</link>
      <pubDate>Mon, 15 Feb 2016 16:39:26 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/15/data-representation-the-same-interface-with-different-implementation/</guid>
      <description>&lt;p&gt;我们设定一个接口，该接口实现包括三个constructor和1个observer&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;zero&lt;/li&gt;
&lt;li&gt;successor&lt;/li&gt;
&lt;li&gt;predecessor&lt;/li&gt;
&lt;li&gt;zero?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当然也可以拓展该接口包括scheme-val-&amp;gt;my-val,my-val-&amp;gt;scheme-val,plus等。
下面看一下如何实现三个相同接口的实现，从而体味data abstraction(data
representation or data boundary).&lt;/p&gt;
&lt;h2 id=&#34;unary-implementation&#34;&gt;unary implementation&lt;/h2&gt;
&lt;h3 id=&#34;辅助测试程序&#34;&gt;辅助测试程序&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define-syntax equal??
  (syntax-rules ()
    ((_ test-exp correct-ans)
     (let ((evaluate-ans test-exp))
       (if (not (equal? evaluate-ans correct-ans))
          (printf &amp;quot;~s returned ~s~%, should have returned ~s~%&amp;quot;
                 &#39;test-exp
                 evaluate-ans
                 correct-ans)
          &#39;OK)))))

(define report-unit-tests-completed
(lambda (fn-name)
  (printf &amp;quot;unit tests completed: ~s~%&amp;quot; fn-name)))

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(let ()
  (define zero (lambda () &#39;()))
  (define is-zero? (lambda (n) (null? n)))
  (define successor (lambda (n) (cons #t n)))
  (define predecessor (lambda (n) (cdr n)))
  
  (define plus
    (lambda (x  y)
      (if (is-zero? x)
         y
         (successor (plus (predecessor x) y)))))
 (report-unit-tests-completed &#39;unary-representation)
  )

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;scheme-value-implementation&#34;&gt;scheme value implementation&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(let()
  (define  zero (lambda () 0))
  (define is-zero? (lambda (n) (zero? n)))
  (define successor (lambda (n) (+ n 1)))
  (define predecessor (lambda (n) (- n 1)))

  (define plus
    (lambda (x y)
      (if (is-zero? x)
         y
         (successor (plus (predecessor x) y)))))

  (equal??  (plus 3 7) 10)
 (printf &amp;quot;~s test completed.~% &amp;quot; &#39;scheme-number-presentation)
  )


&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5-inverse-implementation&#34;&gt;5-inverse implementation&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(let ()
  (define zero (lambda () 5))
  (define is-zero? (lambda (n) (=  n 5)))
  (define successor (lambda (n) (- n 5)))
  (define predecessor (lambda (n) (+ n 5)))
  (define plus
    (lambda (x y)
      (if (is-zero? x)
         y
         (successor (plus (predecessor x) y)))))

  (define scheme-int-&amp;gt;my-int
    (lambda (n)
      (if (zero? n) (zero)
         (successor (scheme-int-&amp;gt;my-int  (- n 1))))))

  (define my-int-&amp;gt;scheme-int
    (lambda  (n)
      (if (is-zero? n) 0
         (+ 1 (my-int-&amp;gt;scheme-int (predecessor n))))))

  (equal??
   (my-int-&amp;gt;scheme-int
    (plus (scheme-int-&amp;gt;my-int 3)
         (scheme-int-&amp;gt;my-int 7)))
   10)
(printf &amp;quot;~s unit tested completed&amp;quot; &#39;reverse-number-representation)
  )
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;拓展整体的接口程序&#34;&gt;拓展整体的接口程序&lt;/h2&gt;
&lt;p&gt;在上面的(let &amp;hellip;.) 中都可以添加如下的接口slots,
你会发现他们的实现在任意一种实现都是一样的过程，只要4个基本接口
实现一样那他们的result is the same.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;  (define scheme-int-&amp;gt;my-int
    (lambda (n)
      (if (zero? n) (zero)
         (successor (scheme-int-&amp;gt;my-int  (- n 1))))))

  (define my-int-&amp;gt;scheme-int
    (lambda  (n)
      (if (is-zero? n) 0
         (+ 1 (my-int-&amp;gt;scheme-int (predecessor n))))))

  (define plus
    (lambda (x y)
      (if (is-zero? x)
         y
         (successor (plus (predecessor x) y)))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;通过者三个实现过程认识[v] is the data representation of the v in certain
interface. 只要确定接口，那么实现有n种情况只要满足你的要求，从而达到问题的
求解。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>shuffle cards</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/14/shuffle-cards/</link>
      <pubDate>Sun, 14 Feb 2016 14:37:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/14/shuffle-cards/</guid>
      <description>&lt;p&gt;这个程序是参考&lt;a href=&#34;http://www.oschina.net/code/snippet_2363209_47912&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;洗牌&lt;/a&gt;而来，主要定位于scheme的算法运用实现。&lt;/p&gt;
&lt;p&gt;源代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket
;四种花色分别为黑桃(spade)、红心(heart)、梅花(club)、方块(diamond)
 
(define suits &#39;(&amp;quot;王&amp;quot; &amp;quot;黑桃&amp;quot; &amp;quot;红桃&amp;quot; &amp;quot;梅花&amp;quot; &amp;quot;方块&amp;quot;))
(define faces &#39;(&amp;quot;B&amp;quot; &amp;quot;L&amp;quot; &amp;quot;A&amp;quot; &amp;quot;2&amp;quot; &amp;quot;3&amp;quot; &amp;quot;4&amp;quot; &amp;quot;5&amp;quot; &amp;quot;6&amp;quot; &amp;quot;7&amp;quot; &amp;quot;8&amp;quot; &amp;quot;9&amp;quot; &amp;quot;10&amp;quot; &amp;quot;J&amp;quot; &amp;quot;Q&amp;quot; &amp;quot;K&amp;quot;))
 
;生成一张牌
(define (creat-card suit face)
    (cons suit face)
)
;生成n副牌
(define (creat-cards n mysuits myfaces)
        (define (afaces suit myfaces)
                (if (null? myfaces)
                    myfaces
                    (append (list (creat-card suit (car myfaces))) 
                             (afaces suit (cdr myfaces))
                     
                    )
                )
        )
        (define (asuits suits myfaces)
                (if (null? suits)
                    suits
                    (append  (afaces (car suits) myfaces)
                             (asuits (cdr suits) myfaces)
                    )
                 
                )
         
        )
         
        ;(make-list n (asuits mysuits myfaces))
        (define (n-cards n alist return) 
                (if (= n 0)
                    return
                    (n-cards (- n 1) alist (append return alist))
                )
        )
        ;(n-cards 4 &#39;(a b c d e) &#39;())
        (n-cards n (asuits mysuits myfaces) &#39;())
)
;显示牌 
(define (print-cards alist . number)
        (define (iter alist n num)
                (if (= 0 (remainder n num))
                    (newline)
                    &#39;ok
                )
                (if (null? alist)
                    (newline)
                    (begin (display (car alist)) 
                           (display &amp;quot;  &amp;quot;)
                           (iter (cdr alist) (+ n 1) num)
                    )
                )
        )
        (if (null? number)
            (iter alist 0 5)
            (iter alist 0 (car number))
        )
)
;获取牌的花色
(define (get-suit card)
    ((lambda (x) (cond ((equal? x &amp;quot;黑桃&amp;quot;) 4)
                       ((equal? x &amp;quot;红桃&amp;quot;) 3)
                       ((equal? x &amp;quot;梅花&amp;quot;) 2)
                       ((equal? x &amp;quot;方块&amp;quot;) 1)
                       ((equal? x &amp;quot;王&amp;quot;)   0)
                 )
     )
     
     (car card)
    )
)
 
;获取牌的数值
(define (get-face card)
    ((lambda (x) (cond ((equal? x &amp;quot;A&amp;quot;) 1)
                       ((equal? x &amp;quot;2&amp;quot;) 2)
                       ((equal? x &amp;quot;3&amp;quot;) 3)
                       ((equal? x &amp;quot;4&amp;quot;) 4)
                       ((equal? x &amp;quot;5&amp;quot;) 5)
                       ((equal? x &amp;quot;6&amp;quot;) 6)
                       ((equal? x &amp;quot;7&amp;quot;) 7)
                       ((equal? x &amp;quot;8&amp;quot;) 8)
                       ((equal? x &amp;quot;9&amp;quot;) 9)
                       ((equal? x &amp;quot;10&amp;quot;) 10)
                       ((equal? x &amp;quot;J&amp;quot;) 11)
                       ((equal? x &amp;quot;Q&amp;quot;) 12)
                       ((equal? x &amp;quot;K&amp;quot;) 13)
                       ((equal? x &amp;quot;B&amp;quot;) 30)
                       ((equal? x &amp;quot;L&amp;quot;) 20)
                 )
     )
     
     (cdr card)
    )
)
;洗牌
(define (shuffle-card cards)
        (define (append-amb x y return)
                (cond ((and (null? x) (null? y)) return)
                      ((null? x) (append return y))
                      ((null? y) (append return x))
                      (else      (append-amb (cdr y) 
                                             (cdr x) 
                                             (append return (append (list (car x)) (list (car y))))
                                 )
                      )
                 
                )
             
        )
        ;--
        (define (shuffle scards)
                ((lambda (x) 
                        (append-amb (list-tail scards x) (list-head scards x) &#39;()))
                 (random (length scards))
                  
                )
        )
        ;--
        (define (iter cards n)
                (if (= n 0)
                    cards
                    (iter (shuffle cards) (- n 1))
                )
        )
        ;--
        (iter cards (length cards))
        ;(shuffle cards)
)
;分牌(deal-card &#39;(1 2 3 4 5 6 7 8) 4) =&amp;gt; return ((1 5) (2 6) (3 7) (4 8))
;;还没完成
(define (deal-card alist n)
        (define (iter alist n return)
            (if (null? alist)
                return
                ;(append )
                &#39;ok
            )
        )
        (iter alist n &#39;())
             
)
;--------------------------------
;返回list中k以前的sublist
(define (list-head lst k)
    (if (zero? k)
        &#39;()
        (append (list (car lst)) (list-head (cdr lst) (- k 1)) )
     
    )
)
;-------------test---------------
(define x (creat-card &amp;quot;梅花&amp;quot; &amp;quot;8&amp;quot;))
(define k (creat-cards 1 (cdr suits) (cdr (cdr faces))))
(define n &#39;(1 2 3 4 5 6 7 8 9 10))
(print-cards k)
(print-cards (list-head k 9))
(print-cards (list-tail k 9) 13)
;(print-cards (shuffle-card k))
;------------------
;(display (shuffle-card n))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;运行结果&#34;&gt;运行结果&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;(黑桃 . A)  (黑桃 . 2)  (黑桃 . 3)  (黑桃 . 4)  (黑桃 . 5)  
(黑桃 . 6)  (黑桃 . 7)  (黑桃 . 8)  (黑桃 . 9)  (黑桃 . 10)  
(黑桃 . J)  (黑桃 . Q)  (黑桃 . K)  (红桃 . A)  (红桃 . 2)  
(红桃 . 3)  (红桃 . 4)  (红桃 . 5)  (红桃 . 6)  (红桃 . 7)  
(红桃 . 8)  (红桃 . 9)  (红桃 . 10)  (红桃 . J)  (红桃 . Q)  
(红桃 . K)  (梅花 . A)  (梅花 . 2)  (梅花 . 3)  (梅花 . 4)  
(梅花 . 5)  (梅花 . 6)  (梅花 . 7)  (梅花 . 8)  (梅花 . 9)  
(梅花 . 10)  (梅花 . J)  (梅花 . Q)  (梅花 . K)  (方块 . A)  
(方块 . 2)  (方块 . 3)  (方块 . 4)  (方块 . 5)  (方块 . 6)  
(方块 . 7)  (方块 . 8)  (方块 . 9)  (方块 . 10)  (方块 . J)  
(方块 . Q)  (方块 . K)  

(黑桃 . A)  (黑桃 . 2)  (黑桃 . 3)  (黑桃 . 4)  (黑桃 . 5)  
(黑桃 . 6)  (黑桃 . 7)  (黑桃 . 8)  (黑桃 . 9)  

(黑桃 . 10)  (黑桃 . J)  (黑桃 . Q)  (黑桃 . K)  (红桃 . A)  (红桃 . 2)  (红桃 . 3)  (红桃 . 4)  (红桃 . 5)  (红桃 . 6)  (红桃 . 7)  (红桃 . 8)  (红桃 . 9)  
(红桃 . 10)  (红桃 . J)  (红桃 . Q)  (红桃 . K)  (梅花 . A)  (梅花 . 2)  (梅花 . 3)  (梅花 . 4)  (梅花 . 5)  (梅花 . 6)  (梅花 . 7)  (梅花 . 8)  (梅花 . 9)  
(梅花 . 10)  (梅花 . J)  (梅花 . Q)  (梅花 . K)  (方块 . A)  (方块 . 2)  (方块 . 3)  (方块 . 4)  (方块 . 5)  (方块 . 6)  (方块 . 7)  (方块 . 8)  (方块 . 9)  
(方块 . 10)  (方块 . J)  (方块 . Q)  (方块 . K)  
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>斯基摩斯的乐园schemers</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/14/si-ji-mo-si-de-le-yuan-schemers/</link>
      <pubDate>Sun, 14 Feb 2016 14:11:54 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/14/si-ji-mo-si-de-le-yuan-schemers/</guid>
      <description>&lt;p&gt;作为一个schemer，你得去学习，编程，社交，工作，保持畅通等,
当然你最不该错过的是&lt;a href=&#34;http://www.schemers.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;斯基摩斯的乐园&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&#34;学习&#34;&gt;学习&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;FAQ&lt;/li&gt;
&lt;li&gt;textbooks书本&lt;/li&gt;
&lt;li&gt;videos&lt;/li&gt;
&lt;li&gt;blogs&lt;/li&gt;
&lt;li&gt;standards 标准手册&lt;/li&gt;
&lt;li&gt;tutorials 入门书籍&lt;/li&gt;
&lt;li&gt;bibliography 参考文献&lt;/li&gt;
&lt;li&gt;other documents 其他文档&lt;/li&gt;
&lt;li&gt;education 教育&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;通过以上几个部分可以完成你学习的过程。&lt;/p&gt;
&lt;h2 id=&#34;编程&#34;&gt;编程&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;implementation 通过实现一门语言&lt;/li&gt;
&lt;li&gt;libraries 通过调用库&lt;/li&gt;
&lt;li&gt;environments 通过搭建环境 了解环境&lt;/li&gt;
&lt;li&gt;Scheme Requests for Implementation&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;社交&#34;&gt;社交&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;中国lisp组织&lt;/li&gt;
&lt;li&gt;google讨论组&lt;/li&gt;
&lt;li&gt;开发者邮箱&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;工作&#34;&gt;工作&lt;/h2&gt;
&lt;p&gt;从工作中获得消息&lt;/p&gt;
&lt;h2 id=&#34;保持畅通&#34;&gt;保持畅通&lt;/h2&gt;
&lt;p&gt;从一些具体的新闻事件中获取消息&lt;/p&gt;
&lt;h2 id=&#34;斯基摩斯清单&#34;&gt;斯基摩斯清单&lt;/h2&gt;
&lt;p&gt;具体下面的事项参看&lt;a href=&#34;http://www.schemers.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;首页&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(case (what-would-you-like-to-do?)
  ((learn)
   (choose-from FAQ
                textbooks
                videos
                blogs
                standards
                tutorials
                bibliography
                other documents
                education))
  ((program)
   (choose-from implementations
                libraries
                environments
                SRFIs))
  ((socialize)
   (choose-from ABQ Lisp/Scheme - Albuquerque, NM, USA
                Chinese Lisp Users Group - China
                Bay Area Lisp &amp;amp; Scheme - Bay Area, CA, USA
                Scheme Boston and Boston Lisp Announce - Boston, MA, USA
                Denver Lispers - Denver, CO, USA
                Scheme UK - London, UK
                munich-lisp - Munich, Germany
                CRACL - Los Angeles, CA, USA
                Lambdaheads - Vienna, Austria
                FringeDC - Washington, DC, USA))
  ((work)
   (choose-from jobs))
  ((stay-informed)
   (choose-from events))
  (else
   (choose-from the lighter side
                wares
                other resources)))
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>chicken-scheme</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/14/chicken-scheme/</link>
      <pubDate>Sun, 14 Feb 2016 13:52:48 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/14/chicken-scheme/</guid>
      <description>&lt;p&gt;它的主要住用适用于产生exe文件，并且对应产生的c代码更加的有效，
运行效率较高。&lt;/p&gt;
&lt;h2 id=&#34;产生可运行文件&#34;&gt;产生可运行文件&lt;/h2&gt;
&lt;p&gt;该可运行的文件是通过chicken生成egg文件，也就是c语言,然后编译成机器代码。
所以运行效率更高一些。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;;; hello-world.scm
(print &amp;quot;Hello, world!&amp;quot;)

;;; Running it interpreted:
$ csi -s hello-world.scm 
Hello, world!

;;; Compiling and running the executable binary:
$ csc hello-world.scm 

$ ./hello-world
Hello, world!
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;http://www.call-cc.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chicken-scheme&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Notes from Teach yourself scheme</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/14/notes-from-teach-yourself-scheme/</link>
      <pubDate>Sun, 14 Feb 2016 11:56:24 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/14/notes-from-teach-yourself-scheme/</guid>
      <description>&lt;p&gt;The notes is published for rethinking what I am reading
in the book called [《Teach Yourself Scheme in Fixnum Days》][3].
It is a good book for introducing scheme(you&amp;rsquo;d better have read
the TLS)&lt;/p&gt;
&lt;h2 id=&#34;forms&#34;&gt;Forms&lt;/h2&gt;
&lt;p&gt;All expression can be inducted into Forms,such as define,begin,set! forms.
Before, I only said the define,begin,set! expression without forms.&lt;/p&gt;
&lt;h2 id=&#34;data-types&#34;&gt;Data Types&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;list&lt;/li&gt;
&lt;li&gt;vector&lt;/li&gt;
&lt;li&gt;procedure&lt;/li&gt;
&lt;li&gt;port (原来port也是数据类型的一种，这样就并入了文件的IO)
当然也包括open-string-port相当于创建了fortran的[内部文件][4]的作用。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;所有的形式(forms)在scheme其实都是一种对于数据的representation.要反复思考这个过程。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Data abstraction divides a data type into two pieces: an interface
and an implementation. The interface tells us what the data of the type
represents,what the operations on the data are,and what properties these
operations may be relied to have.The implementation provides a specific
representation of the data and code for the operations that make use
of that data representation.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;implicit-and-explicit&#34;&gt;implicit and explicit&lt;/h2&gt;
&lt;p&gt;lambda 的内部自带(begin &amp;hellip;)的作用，也就是可以连接多个expressions（forms）。
而if没有，对应的when，unless conditions则是存在隐式的implicit begin的作用。
并且when和unless其实就差在一个not表达式&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lambda implicit begin&lt;/li&gt;
&lt;li&gt;when   implicit begin&lt;/li&gt;
&lt;li&gt;unless implicit begin&lt;/li&gt;
&lt;li&gt;if     explicit begin&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;macro-expansion&#34;&gt;macro expansion&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;`(.. , &amp;hellip;)    叫做comon 形式&lt;/li&gt;
&lt;li&gt;`(&amp;hellip; ,@ &amp;hellip;)  叫做comon slice形式&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;jumpscps&#34;&gt;Jumps(CPS)&lt;/h2&gt;
&lt;p&gt;Continuation is the special contribution of the book.&lt;/p&gt;
&lt;p&gt;[很多其他的scheme解释器和编译器.][1] [Mit_scheme][2]
[1]: &lt;a href=&#34;http://tunes.org/wiki/scheme.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://tunes.org/wiki/scheme.html&lt;/a&gt;
[2]: &lt;a href=&#34;http://groups.csail.mit.edu/mac/projects/scheme/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://groups.csail.mit.edu/mac/projects/scheme/index.html&lt;/a&gt;
[3]: &lt;a href=&#34;http://ds26gte.github.io/tyscheme/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://ds26gte.github.io/tyscheme/index.html&lt;/a&gt;
[4]: &lt;a href=&#34;http://v.fcode.cn/video-internal_file.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://v.fcode.cn/video-internal_file.html&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Different data types decide the different operations</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/13/different-data-types-decide-the-different-operations/</link>
      <pubDate>Sat, 13 Feb 2016 13:33:06 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/13/different-data-types-decide-the-different-operations/</guid>
      <description>&lt;p&gt;Data types such as list,vector,array,linkedlist,tree etc, all have the self operations
to add,delete,modify the content referred.&lt;/p&gt;
&lt;h2 id=&#34;list&#34;&gt;List&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;    (define list-sum
     (lambda (lst)
      (if (null? lst)
       0
       (+ (car lst) (list-sum (cdr lst))))))
    (list-sum &#39;(1 2 3 4))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;vector&#34;&gt;Vector&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;    (define vector-sum
     (lambda (vec)
      (define vector-sum-help
       (lambda (vec n)
        ;(if (eq? n 0)
            (if (zero? n)
             (vector-ref vec 0)
             (+ (vector-ref vec n) (vector-sum-help vec (- n 1))))))
       (let ((n (vector-length vec)))
        (if (zero? n)
         0
         (vector-sum-help vec (- n 1)))))) ;;;wrong  (n)
     (vector-sum (vector 1 2 3 4))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;the-box-function-in-the-tss&#34;&gt;The box function in the TSS&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;     box 的作用虽然有点类似 kons kar kdr
     (define kons (lambda (kar kdr) (lambda (selector) (selector kar kdr))))
    (define kar (lambda (c) (c (lambda (a d) a))))
    (define kdr (lambda (c) (c (lambda (a d) d))))
(define kdr2 (lambda (c) (c (lambda (a d) (quote d)))))

    (kar (kons &#39;a &#39;b))
    (kdr (kons &#39;a &#39;b))
    (kdr2 (kons &#39;a &#39;b))
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Now let&#39;s see the function of the box.
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
    (define (box it)
     (lambda (sel)
      (sel it (lambda (new)
               (set! it new)))))

    (define (setbox box new)
     (box (lambda (it set)
           (set new))))

    (define (unbox box)
     (box (lambda (it set)
           it)))
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;我们使用的前提是通过box进行cons的作用
比如setbox
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;    ((lambda (it set) (set new)) it (lambda (new) (set! it new)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也就是 it对一个it 而set对应 (lambda (new) (set! it new))
所以这边真正起作用的就是第一个lambda里面的(set new)返回值
比如unbox&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    ((lambda (it set) it) it (lambda (new) (set! it new)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也就是此时 it依然对应it set对应的是(lambda (new) (set! it new))
所以这边真正起作用的就是第一个lambda里面的it返回值&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;所以box只不过是提供了一种映射结构，想到那关于数据结构的创建，把所有的基于这个框架的
变体放入首个位置，类似closure的table位置
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>It&#39;s a dead program.How to let it alive?</title>
      <link>https://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/</link>
      <pubDate>Tue, 09 Feb 2016 23:20:18 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/</guid>
      <description>&lt;p&gt;All programs are data.
All intepreters are program.
All Handware and software,or type checkers etc are interpreter.&lt;/p&gt;
&lt;p&gt;I think data conceives the soul,not only the fixed process,but changing vari-language.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1&#34;&gt;1.The Little Scheme interpreter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2&#34;&gt;2.The Season Scheme interpreter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3&#34;&gt;3.The CPS control struture&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#3.1&#34;&gt;3.1 how to add arguments?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.2&#34;&gt;3.2 what is the small stuff?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4&#34;&gt;4. how to evaluate or interpreter  a procedre?&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#4.1&#34;&gt;4.1 ordinary tracing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4.2&#34;&gt;4.2 cps tracing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5&#34;&gt;5. It is not the end&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;1&#34;&gt;The Little Scheme&lt;/h2&gt;
&lt;p&gt;Here below is the interpreter from TLS&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket
;;简单环境配置
    (define atom?
     (lambda (x)
      (and (not (pair? x)) (not (null? x)))))


    ;第一大部分 定义好整体框架
    (define value
     (lambda (e)
      (meaning e (quote ()))))
    (define meaning
     (lambda (e table)
      ((expression-to-action e) e table)))

    ;;第二大部分 解析atom and list action

    (define expression-to-action
     (lambda (e)
      (cond
       ((atom? e) (atom-to-action e))
       (else (list-to-action e)))))
    (define atom-to-action
     (lambda (e)
      (cond
       ((number? e) *const)
       ((eq? e #t) *const)
       ((eq? e #f) *const)
       ((eq? e (quote cons)) *const)
       ((eq? e (quote car)) *const)
       ((eq? e (quote cdr)) *const)
       ((eq? e (quote null?)) *const)
       ((eq? e (quote eq?)) *const)
       ((eq? e (quote atom?)) *const)
       ((eq? e (quote zero?)) *const)
       ((eq? e (quote add1)) *const)
       ((eq? e (quote sub1)) *const)
       ((eq? e (quote number?)) *const)
       (else *identifier))))
    (define list-to-action
     (lambda (e)
      (cond
       ((atom? (car e))
        (cond
         ((eq? (car e) (quote quote))
          *quote)
         ((eq? (car e) (quote lambda))
          *lambda)
         ((eq? (car e) (quote cond))
          *cond)
         (else *application)))
       (else *application))))

    ;; 第三大部分 定义 6星==5个special forms 和一个general forms（*application)

    ;;;环境额外配置 这些配置仅仅是为了增加可读性 无任何编程技巧
    (define first
     (lambda (p)
      (cond
       (else (car p)))))
    (define second
     (lambda (p)
      (cond
       (else car (cdr p)))))
    (define third
     (lambda (p)
      (cond
       (else car (cdr (cdr p))))))
(define text-of second)
    ;; *identifier
    (define table-of first)
    (define formals-of second)
(define body-of third)
    ;;*cond
    (define question-of first)
    (define answer-of second)
(define cond-lines-of cdr)
    ;;*application
    (define function-of car)
(define arguments-of cdr)

    (define build
     (lambda (s1 s2)
      (cond
       (else (cons s1
              (cons s2 (quote ())))))))
    ;;1st star
    (define *const
     (lambda (e table)
      (cond
       ((number? e) e)
       ((eq? e #t) #t)
       ((eq? e #f) #f)
       (else (build (quote primitive) e)))))
    ;;2nd star
    (define *quote
     (lambda (e table)
      (text-of e)))
    ;;3rd star
    (define *lambda
     (lambda (e table)
      (build (quote non-primitive)
       (cons table (cdr e)))))
    ;;4th star
    (define *identifier
     (lambda (e table)
      (lookup-in-table e table initial-table)))
    (define initial-table
     (lambda (name)
      (car (quote ()))))
    (define lookup-in-table
     (lambda (name table table-f)
      (cond
       ((null? table) (table-f name))
       (else (lookup-in-entry name
              (car table)
              ; (lambda (name)
                  ; (cdr table)
                  ; (table-f)))))))
(lambda (name)
 (lookup-in-table name
  (cdr table)
  table-f)))))))
    (define lookup-in-entry
     (lambda (name entry entry-f)
      (lookup-in-entry-help name
       (first entry)
       (second entry)
       entry-f)))
    (define lookup-in-entry-help
     (lambda (name names values entry-f)
      (cond
       ((null? names) (entry-f name))
       ((eq? (car names) name)
        (car values))
       (else (lookup-in-entry-help name
              (cdr names)
              (cdr values)
              entry-f)))))

    ;; 5th star
    (define *cond
     (lambda (e table)
      (evcon (cond-lines-of e) table)))
    (define evcon
     (lambda (lines table)
      (cond
       ((else? (question-of (car lines)))
        (meaning (answer-of (car lines))
         table))
       ((meaning (question-of (car lines))
         table)
        (meaning (answer-of (car lines))
         table))
       (else (evcon (cdr lines) table)))))

    (define else?
     (lambda (x)
      (cond
       ((atom? x) (eq? x (quote else)))
       (else #f))))


    ;;6th star 你需要解析arguments的各个部分这是evlis的工作
    (define *application
     (lambda (e table)
      (apply
       (meaning (function-of e) table)
       (evlis (arguments-of e) table))))

    (define evlis
     (lambda (args table)
      (cond
       ((null? args) (quote ()))
       (else
        (cons (meaning (car args) table)
         (evlis (cdr args) table))))))


    ;;第四大部分 进行 apply的定义 反向运用primitive和non-primitive 去除核心的primitive和non-primitive前缀，并升级环境

    (define apply
     (lambda (fun vals)
      (cond
       ((primitive? fun)
        (apply-primitive
         (second fun) vals))
       ((non-primitive? fun)
        (apply-closure
         (second fun) vals)))))

    (define primitive?
     (lambda (l)
      (eq? (first l) (quote primitive))))
    (define non-primitive?
     (lambda (l)
      (eq? (first l) (quote non-primitive))))
    (define apply-primitive
     (lambda (name vals)
      (cond
       ((eq? name (quote cons))
        (cons (first vals) (second vals)))
       ((eq? name (quote car))
        (car (first vals)))
       ((eq? name (quote cdr))
        ((eq? name (quote cdr))
         (cdr (first vals)))
        ((eq? name (quote null?))
         (null? (first vals)))
        ((eq? name (quote eq?))
         (eq? (first vals) (second vals)))
        ((eq? name (quote atom?))
         (:atom? (first vals)))
        ((eq? name (quote zero?))
         (zero? (first vals)))
        ((eq? name (quote add1))
         (add1 (first vals)))
        ((eq? name (quote sub1))
         (sub1 (first vals)))
        ((eq? name (quote number?))
         (number? (first vals)))))))
    (define :atom?
     (lambda (x)
      (cond
       ((atom? x) #t)
       ((null? x) #f)
       ((eq? (car x) (quote primitive))
#t)
       ((eq? (car x) (quote non-primitive))
#t)
       (else #f))))

    ;;closure=table+arguments+body ;;arguments 通过formals-of获取 body-of获取body
    (define apply-closure
     (lambda (closure vals)
      (meaning (body-of closure)
       (extend-table
        (new-entry
         (formals-of closure)
         vals)
        (table-of closure)))))
    (define new-entry build)
(define extend-table cons)


    ;;测试这个解释器
    ;(value (cons (* (+ 1 3) 4) &#39;hello)) ;;不通过
    (value (+ 2 4))
(value (* 15 (+ 2 4)))
    ;;(value (cons (quote (* (+ 1 3) 4)) (cons &#39;h &#39;()))) ;;测试不通过

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2&#34;&gt; The Season scheme&lt;/h2&gt;
&lt;p&gt;Here below is the interpreter from TLS&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket
;; The Seasoned Schemer
;; chapter 20
;; What&#39;s in Store ?

(define abort &#39;())

(define global-table &#39;())

(define (add1 n)
 (+ n 1))

(define (sub1 n)
 (- n 1))

    (define (atom? a)
     (and (not (pair? a))
      (not (null? a))))

(define (text-of x)
 (cadr x))

(define (formals-of x)
 (cadr x))

(define (body-of x)
 (cddr x))

(define (ccbody-of x)
 (cddr x))

(define (name-of x)
 (cadr x))

    (define (right-side-of x)
     (if (null? (cddr x))
      0
      (caddr x)))

(define (cond-lines-of x)
 (cdr x))

    (define (else? x)
     (if (atom? x)
      (eq? x &#39;else)
#f))

(define (question-of x)
 (car x))

(define (answer-of x)
 (cadr x))

(define (function-of x)
 (car x))

(define (arguments-of x)
 (cdr x))


(define (lookup table name)
 (table name))

    (define (extend name1 val table)
     (lambda (name2)
      (if (eq? name1 name2)
       val
       (table name2))))

    (define (define? e)
     (eq? (and (pair? e)
           (car e)) &#39;def))

(define (*define e)
 (set! global-table
  (extend (name-of e)
   (box (the-meaning (right-side-of e)))
   global-table)))

    (define (box it)
     (lambda (sel)
      (sel it (lambda (new)
               (set! it new)))))

    (define (setbox box new)
     (box (lambda (it set)
           (set new))))

    (define (unbox box)
     (box (lambda (it set)
           it)))

(define (the-meaning e)
 (meaning e lookup-in-global-table))

(define (lookup-in-global-table name)
 (lookup global-table name))

(define (meaning e table)
 ((expression-to-action e) e table))

(define (*quote e table)
 (text-of e))

(define (*identifier e table)
 (unbox (lookup table e)))

(define (*set e table)
 (setbox
  (lookup table (name-of e))
  (meaning (right-side-of e) table)))

    (define (*lambda e table)
     (lambda (args)
      (beglis (body-of e)
       (multi-extend (formals-of e)
        (box-all args)
        table))))

    ;; (define (beglis es table)
            ;; (cond
                ;; ((null? (cdr es))
                    ;; (meaning (car es) table))
                ;; (else ((lambda (val)
                            ;; (beglis (cdr es) table))
                        ;; (meaning (car es) table)))))

    ;; (define (beglis es table)
            ;; (let ((m (meaning (car es) table)))
                ;; (if (null? (cdr es))
                    ;; m
                    ;; ((lambda (val)
                            ;; (beglis (cdr es) table)) m))))

    ;; (define (beglis es table)
            ;; (let ((m (meaning (car es) table)))
                ;; (if (null? (cdr es))
                    ;; m
                    ;; (let ((val m))
                        ;; (beglis (cdr es) table)))))

    (define (beglis es table)
     (let ((m (meaning (car es) table))
           (d (cdr es)))
      (if (null? d)
       m
       (beglis d table))))

    ;; (define (box-all vals)
            ;; (if (null? vals)
                ;; &#39;()
                ;; (cons (box (car vals))
                    ;; (box-all (cdr vals)))))

    ;; (define (box-all vals)
            ;; (letrec
                ;; ((rec
                        ;; (lambda (vals acc)
                            ;; (if (null? vals)
                                ;; acc
                                ;; (rec (cdr vals)
                                    ;; (cons (box (car vals)) acc))))))
                ;; (rec (reverse vals) &#39;())))

    (define (box-all vals)
     (let loop ((vals (reverse vals))
                (acc &#39;()))
      (if (null? vals)
       acc
       (loop (cdr vals)
        (cons (box (car vals)) acc)))))

    (define (multi-extend names vals table)
     (if (null? names)
      table
      (extend (car names)(car vals)
       (multi-extend (cdr names)(cdr vals)
        table))))

    (define (*application e table)
     ((meaning (function-of e) table)
      (evlis (arguments-of e) table)))

    ;; (define (evlis args table)
            ;; (if (null? args)
                ;; &#39;()
                ;; ((lambda (val)
                        ;; (cons val
                            ;; (evlis (cdr args) table)))
                    ;; (meaning (car args) table))))

    ;; (define (evlis args table)
            ;; (if (null? args)
                ;; &#39;()
                ;; (cons (meaning (car args) table)
                    ;; (evlis (cdr args) table))))

    ;; (define (evlis args table)
            ;; (letrec
                ;; ((rec
                        ;; (lambda (args table acc)
                            ;; (if (null? args)
                                ;; acc
                                ;; (rec (cdr args)
                                    ;; table
                                    ;; (cons (meaning (car args) table)
                                        ;; acc))))))
                ;; (rec (reverse args) table &#39;())))

    (define (evlis args table)
     (let loop ((args (reverse args))
                (table table)
                (acc &#39;()))
      (if (null? args)
       acc
       (loop (cdr args) table
        (cons (meaning (car args) table)
         acc)))))

    (define (a-prim p)
     (lambda (args-in-a-list)
      (p (car args-in-a-list))))

    (define (b-prim p)
     (lambda (args-in-a-list)
      (p (car args-in-a-list)
       (cadr args-in-a-list))))

(define (*const e table)
 (cond
  ((number? e) e)
  ((eq? e #t) #t)
  ((eq? e #f) #f)
  ((eq? e &#39;cons)(b-prim cons))
  ((eq? e &#39;car )(a-prim car))
  ((eq? e &#39;cdr)(a-prim cdr))
  ((eq? e &#39;eq?)(b-prim eq?))
  ((eq? e &#39;atom?)(a-prim atom?))
  ((eq? e &#39;null?)(a-prim null?))
  ((eq? e &#39;zero?)(a-prim zero?))
  ((eq? e &#39;add1)(a-prim add1))
  ((eq? e &#39;sub1)(a-prim sub1))
  ((eq? e &#39;number)(a-prim number?))))

(define (*cond e table)
 (evcon (cond-lines-of e) table))

(define (evcon lines table)
 (cond
  ((else? (question-of (car lines)))
   (meaning (answer-of (car lines)) table))
  ((meaning (question-of (car lines)) table)
   (meaning (answer-of (car lines)) table))
  (else (evcon (cdr lines) table))))

(define (*letcc e table)
 (let/cc skip
  (beglis (ccbody-of e)
   (extend (name-of e)
    (box (a-prim skip) table)))))

(define (value e)
 (let/cc the-end
  (set! abort the-end)
  (if (define? e)
   (*define e)
   (the-meaning e))))

(define (the-empty-table name)
 (abort
  (cons &#39;no-answer
   (cons name &#39;()))))

    (define (expression-to-action e)
     (if (atom? e)
      (atom-to-action e)
      (list-to-action e)))

(define (atom-to-action e)
 (cond
  ((number? e) *const)
  ((eq? e #t) *const)
  ((eq? e #f) *const)
  ((eq? e &#39;cons) *const)
  ((eq? e &#39;car) *const)
  ((eq? e &#39;cdr) *const)
  ((eq? e &#39;null?) *const)
  ((eq? e &#39;eq?) *const)
  ((eq? e &#39;atom?) *const)
  ((eq? e &#39;zero?) *const)
  ((eq? e &#39;add1) *const)
  ((eq? e &#39;sub1) *const)
  ((eq? e &#39;number?) *const)
  (else *identifier)))

    (define (list-to-action e)
     (let ((a (car e)))
      (if (atom? a)
       (let ((prim-of? (lambda (x) (eq? x a ))))
        (cond
         ((prim-of? &#39;quote) *quote)
         ((prim-of? &#39;lambda) *lambda)
         ((prim-of? &#39;letcc) *letcc)
         ((prim-of? &#39;set!) *set)
         ((prim-of? &#39;cond) *cond)
         (else *application)))
       *application)))


(set! global-table (lambda (name)
                    (the-empty-table name)))
    (value (cons &#39;a &#39;b))
(value (+ (- 3 2) 6))


&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3&#34;&gt;The CPS control struture&lt;/h2&gt;
&lt;p&gt;Here below is the method how to change the ordinary subroutine to the continuation passing style &lt;a href=&#34;https://cgi.soic.indiana.edu/~c311/lib/exe/fetch.php?media=cps-notes.scm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ref.&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;First rule: whenever we see a lambda in the code we want to CPS, we have to add an argument, and then process the body&lt;/li&gt;
&lt;li&gt;Second rule: &amp;ldquo;Don&amp;rsquo;t sweat the small stuff!&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3.1&#34;&gt;how to add argument?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;orignial style:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define rember8
  (lambda (ls)
    (cond
      [(null? ls) &#39;()]
      [(= (car ls) 8) (cdr ls)]
      [else (cons (car ls) (rember8 (cdr ls)))])))
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;incompleted cps style:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define rember8
  (lambda (ls k)
    (cond
      [(null? ls) &#39;()]
      [(= (car ls) 8) (cdr ls)]
      [else (cons (car ls) (rember8 (cdr ls)))])))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3.2&#34;&gt;what is the small stuff?&lt;/h3&gt;
&lt;p&gt;Small stuff is stuff we know will terminate right away.
Don&amp;rsquo;t sweat the small stuff if we know it will be evaluated.
Don&amp;rsquo;t sweat the small stuff if it &lt;em&gt;might&lt;/em&gt; be evaluated, but instead
pass it to k.&lt;/p&gt;
&lt;p&gt;为了更好辨别，我们改为如下形式&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define rember8
  (lambda (ls k)
    (cond
      [(null? ls) (*k* &#39;())]
      [(= (car ls) 8) (*k* (cdr ls))]
      [else (*rember8* (cdr ls) (lambda (x) (*k* (cons (car ls) x))))])))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;凡是加上*号的，都代表者continuation的过程。
Why don&amp;rsquo;t null?, =, car, cdr, and cons count? Because they&amp;rsquo;re just
small stuff, and when we combine small stuff together in small ways,
the combination remains small.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Second, all arguments are small stuff. Yep, even the lambda in the
else line, because lambda is *always* small stuff.
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;complete cps style:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define rember8
  (lambda (ls k)
    (cond
      [(null? ls) (k &#39;())]
      [(= (car ls) 8) (k (cdr ls))]
      [else (rember8 (cdr ls) (lambda (x) (k (cons (car ls) x)))])))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4&#34;&gt;how to evaluate or interpreter  a procedre?&lt;/h2&gt;
&lt;h3 id=&#34;4.1&#34;&gt;ordinary tracing&lt;/h3&gt;
&lt;p&gt;we will develop a unimplemented language to do give an explanation to it.&lt;/p&gt;
&lt;p&gt;Here below is the main language(we can change it ,but now it is not the main cause.)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;1 eval
(define eval
   (lambda (Exp Env )
 (cond 
    ((number? Exp)  Exp)
    ((symbol? Exp) (looking Exp Env))
    ((eq? (car Exp) &#39;QUADE) (cadr Exp))
    ((eq? (car Exp) &#39;lambda) 
        (list &#39;Closure (cdr Exp) Env))
    ((eq? (car Exp) &#39;Cond) 
        （Evcond (cadr Exp） Env))
    (else
        (apply  
           (eval (car Exp) Env)
           (Evlist (cdr Exp) Env)))))) 

;2 apply
(define apply
   (lambda (PROC ARGS)
     (cond 
        ((primitive? PROC) 
          (Apply-primitive Proc ARGS))
        ((EQ? (car proc) &#39;closure)
          (EVAL  (cadadr proc)
            (Bind (caadr proc) 
                ARGS
               (Caddr proc))))
         (else error)))))

;;;Attention, primitvie?  apply-primitive  is not finished

;3 Evlist
(define Evlist
  (lambda (l Env)
    (cond 
      ((eq? (car l) &#39;()) &#39;())
      (else
         (cons (eval (car l) Env)
               (eval (cdr l) Env))))))

;4 Evcond
(define Evcond
   (lambda (clauses Env)
     (cond
        ((eq? clauses &#39;()) &#39;())
        ((eq? (caar clauses) &#39;else) 
            (eval (cadar clauses) Env))
         ((false? (Eval (caar clauses) Env))
            (Evcond (cdr clauses) Env))
         (else
            (Eval (cadar clauses) Env)))))

;;;Attention false? is not finished.

;5 looking
(define looking
   (lambda (sym env)
     (cond 
       ((eq? env &#39;()) (error &#39;unbound-value))
       (else
         ((lambda (vcell)
             (cond 
               ((eq? vcell &#39;())
                  (looking sym (cdr env)))
               (else (cdr vcell))))
           (assq sym (car env)))))))

;6 assq
(define assq
    (lambda (syms alist)
       (cond
         ((eq? alist &#39;()) &#39;())
         ((eq? syms (caar alist)) (car alist))
         (else (assq syms (cdr alist))))))


;7 Bind
(define Bind
   (lambda (vars vals Env)
     (cons (pair-up  vars vals) env)))

;8 Pair-up
(define Pair-up
   (lambda (vars vals)
     (cond 
        ((eq? vars &#39;())
            (cond 
               ((eq? vals? &#39;()) &#39;())
               (else (error &#39;Too-much-arguments))))
         ((eq? vals &#39;()) (error &#39;Too-few-arguments))
         (else 
           (cons (cons (car vars)  (car vals))
                  (pair-up (cdr vars) (cdr vals))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So now we can use the language below to interpret the form&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(eval &#39;(((lambda (x）（lambda (y) (+  x y))) 3) 4) e0)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Good explanation begin(kernal part)：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;

(apply (eval &#39;((lambda (x) (lambda (y) (+ x y))） 3）  e0)
       (Evlist &#39;(4) e0))

(apply (eval &#39;((lambda (x) (lambda (y) (+ x y))） 3）  e0)
       （cons (eval &#39;(4) e0) (evlist &#39;() e0)))

(apply (eval &#39;((lambda (x) (lambda (y) (+ x y))） 3）  e0)
       （cons 4 &#39;()))

(apply (eval &#39;((lambda (x) (lambda (y) (+ x y))） 3）  e0)
       &#39;(4))


(apply (apply (eval &#39;(lambda (x) (lambda (y) (+ x y))  e0)
       &#39;(3) )
      &#39;(4))

(apply (apply &#39;(closure ((x) (lambad (y) (+ x y))) e0) 
       &#39;(3) )
      &#39;(4))

(apply (eval (lambda (y) (+ x y)) e1)
      &#39;(4))

(apply &#39;(closure ((y) (+ x y)) e1)
      &#39;(4))

(eval &#39;(+ x y) e2)

(apply (Eval &#39;+ e2)  (Evlist &#39;(x y) e2))

(apply &#39;(add0101)  &#39;(3 4))   ;add0101 is the assemble executable binary code(speed fast)


（+ 3 4） = 7
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finished~  Good ~  Well done.&lt;/p&gt;
&lt;h3 id=&#34;4.2&#34;&gt;cps tracing&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Let&#39;s trace (rember8  (lambda (x) x))

ls | k

&#39;(1 2 8 3 4 6 7 8 5) | (lambda (x) x) = id
&#39;(2 8 3 4 6 7 8 5)   | (lambda (x) (id (cons 1 x))) = k2
&#39;(8 3 4 6 7 8 5)     | (lambda (x) (k2 (cons 2 x))) = k3

Once we hit the 8, we apply (k (cdr ls)) where k is k3 and ls is &#39;(8 3
4 6 7 8 5)

(k3 &#39;(3 4 6 7 8 5)) = (k2 (cons 2 &#39;(3 4 6 7 8 5)))
(k2 &#39;(2 3 4 6 7 8 5)) = (id (cons 1 &#39;(2 3 4 6 7 8 5)))
(id &#39;(1 2 3 4 6 7 8 5)) = &#39;(1 2 3 4 6 7 8 5)

And we&#39;re done.

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5&#34;&gt; It is not the end&lt;/h2&gt;
&lt;p&gt;how to change the procedure above? Leave to you.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Think in the variable and macro in the common lisp</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/11/01/think-in-the-variable-and-macro-in-the-common-lisp/</link>
      <pubDate>Sun, 01 Nov 2015 17:26:23 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/11/01/think-in-the-variable-and-macro-in-the-common-lisp/</guid>
      <description>&lt;p&gt;As you all know we can use defun to define a function in the common lisp,&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;
(defun add (x)
    (+ x 1))
(defun foo (a b c)
    (list  a b c))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Definition above is the most essential method to create a function. Due to the&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;convience&lt;/strong&gt; we will have to think about the variables and functions again.&lt;/p&gt;
&lt;p&gt;Writing thinking path: from thinking the variables to functions and get the knowledge of the common lisp.&lt;/p&gt;
&lt;h2 id=&#34;i-variables&#34;&gt;I. Variables&lt;/h2&gt;
&lt;p&gt;We we execute one function ,we should let the interpreter know:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;call the Mac first? or call the compiler first?&lt;/li&gt;
&lt;li&gt;Mac will not get the value of the variables ,but change the expression to  another forms&lt;/li&gt;
&lt;li&gt;But compiler will directly get the value of the variables.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Variables can be shown with &amp;amp;key,&amp;amp;optional,&amp;amp;rest,&amp;amp;body forms etc.&lt;/p&gt;
&lt;h3 id=&#34;keyword-variables&#34;&gt;keyword variables&lt;/h3&gt;
&lt;p&gt;The variables start with colon( it means :) is the keyword variables, but there are exception,&lt;/p&gt;
&lt;p&gt;such as in the defsystem(asdf grammer), you can depends on other system (depends on :macro-utilities)&lt;/p&gt;
&lt;p&gt;here macro-utilities is called as a system,not the keyword variables.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;
(defun foo (&amp;amp;key a (b 20) (c 30 c-p)) 
    (list  a b c c-p))

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;optional-variables&#34;&gt;optional variables&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;
(defun foo (a &amp;amp;optional (b 20) (c 30 c-p))  ;;c-supplied-p

    (list  a b c c-p))

;; it means the variables b and c is optional ,if b is not written in the
;; the parameter list, the interpreter will set b = 20,similary  c.

(defun make-rectangle (width &amp;amp;optional (height width)) ...)

;;; the rectangle will set height =width when height is not supplied.

(defun foo (a &amp;amp;optional (b 20) (c 30 c-supplied-p)) 

    (list  a b c c-supplied-p))


&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;rest-variables&#34;&gt;rest variables&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;
(defun format (stream string &amp;amp;rest values) ...)

(defun + (&amp;amp;rest numbers) ...)

(defmacro when (condition &amp;amp;rest body)
    `(if (not ,condition) (progn ,@body) ;; The difference between , and ,@ in the `() is ,@ will delete the brace more than once 

    ;; (if condition then-part [else-part])
)

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;body--variables&#34;&gt;body  variables&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;macro-definition&#34;&gt;macro definition&lt;/h3&gt;
&lt;p&gt;I think Mac(Macro-&amp;gt; defmacro) is a form to change the input of the variables.Actually it is&lt;/p&gt;
&lt;p&gt;most powerful tool in the lisp programming&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;
(format t &amp;quot;hello world&amp;quot;)

(defun backwords (str) 
    (reverse str))

(backwords (&amp;quot;hello world&amp;quot; t format))  ;; take care not (backwords &#39;(&amp;quot;hello world&amp;quot; t format))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So when you execute the backwords macro, the interpreter will tell the Mac to do the works.&lt;/p&gt;
&lt;p&gt;When  he finished his work. The compiler will continue execute the result of the Mac. That&lt;/p&gt;
&lt;p&gt;is the process of the macro function.&lt;/p&gt;
&lt;h2 id=&#34;ii-functions&#34;&gt;II. Functions&lt;/h2&gt;
&lt;p&gt;Orient Object Programming&amp;rsquo;s CLOS is  to tell you how to rearrange the functions and variables into one class.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;iii-format-function&#34;&gt;III. Format function&lt;/h2&gt;
&lt;p&gt;format is a most powerful decorate function to output in the common lisp.&lt;/p&gt;
&lt;p&gt;so every field in the format function , you should take note &lt;em&gt;~&lt;/em&gt; ,such as &lt;em&gt;~a&lt;/em&gt;, &lt;em&gt;~{~}&lt;/em&gt;, &lt;em&gt;~%&lt;/em&gt;, &lt;em&gt;~:a&lt;/em&gt;, &lt;em&gt;~r&lt;/em&gt;,&lt;em&gt;~d&lt;/em&gt; etc&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-common-lisp&#34;&gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;added-later&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>bash Array 和拓展的pattern match</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/10/24/bash-array-he-tuo-zhan-de-pattern-match/</link>
      <pubDate>Sat, 24 Oct 2015 15:36:57 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/10/24/bash-array-he-tuo-zhan-de-pattern-match/</guid>
      <description>&lt;p&gt;通过&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/10/23/bash-support-idede-xin-fa-xian/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Bash_It&lt;/a&gt;的学习，第一次意识到Shell数组的不一样的写法。
并且也看到Pattern Match的一些用途。&lt;/p&gt;
&lt;h2 id=&#34;1-array&#34;&gt;1 Array&lt;/h2&gt;
&lt;h3 id=&#34;11-bash数组定义&#34;&gt;1.1 Bash数组定义&lt;/h3&gt;
&lt;p&gt;通过(1,2,3)区分于fortran语言的(/1,2,3/).&lt;/p&gt;
&lt;p&gt;bash1=(34,5,6,4)&lt;/p&gt;
&lt;p&gt;bash2=(&amp;ldquo;34&amp;rdquo;,&amp;ldquo;5&amp;rdquo;,&amp;ldquo;5&amp;rdquo;,&amp;ldquo;4&amp;rdquo;)&lt;/p&gt;
&lt;h3 id=&#34;12-bash关联数组定义&#34;&gt;1.2 Bash关联数组定义&lt;/h3&gt;
&lt;p&gt;通过 -A开关选项定义一个关联数组。&lt;/p&gt;
&lt;p&gt;declare -A bash1&lt;/p&gt;
&lt;p&gt;bash1[&amp;ldquo;34&amp;rdquo;]=&amp;ldquo;53&amp;rdquo;&lt;/p&gt;
&lt;p&gt;bash1[&amp;ldquo;56&amp;rdquo;]=&amp;ldquo;45&amp;rdquo;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;declare -A array
for subscript in a b c d e
     do
         array[$subscript]=&amp;quot;$subscript $RANDOM&amp;quot;
     done

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也可以在&lt;em&gt;命令行使用&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  a=($(ls))  #而不是a=$(ls)

  #这样就可以使用
  ${a[1]}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;13-bash数组添加数据&#34;&gt;1.3 Bash数组添加数据&lt;/h3&gt;
&lt;p&gt;bash1+=&amp;ldquo;54&amp;rdquo;&lt;/p&gt;
&lt;h3 id=&#34;14-bash数组显示数据和便利&#34;&gt;1.4 Bash数组显示数据和便利&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;##单个显示
printf &amp;quot;%s\n&amp;quot; &amp;quot;${array[&amp;quot;c&amp;quot;]}&amp;quot;

##遍历
printf &amp;quot;%s\n&amp;quot; &amp;quot;${array[@]}&amp;quot;
printf &amp;quot;%s\n&amp;quot; &amp;quot;${array[*]}&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;15-拓展的操作&#34;&gt;1.5 拓展的操作&lt;/h3&gt;
&lt;p&gt;#表示长度的作用&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;${#array&lt;a href=&#34;http://www.gnu.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2&lt;/a&gt;}  现实第二个数组元素的长度&lt;/li&gt;
&lt;li&gt;${#array[@]}   显示全部数组元素的长度&lt;/li&gt;
&lt;li&gt;${#array[*]}  显示全部数组元素的长度&lt;/li&gt;
&lt;li&gt;${#array[@]:2:3}  获取第2个到3个的长度&lt;/li&gt;
&lt;li&gt;${!array[@]} !的作用是现实所有的key在数组当中。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;进一步参考&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.apress.com/9781484201220&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;pro_Bash_programming&lt;/a&gt;第五章 array部分&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;2-pattern-match&#34;&gt;2. PATTERN MATCH&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;?(pattern-list)   Matches zero or one occurrence of the given patterns
*(pattern-list)   Matches zero or more occurrences of the given patterns
+(pattern-list)   Matches one or more occurrences of the given patterns
@(pattern-list)   Matches one of the given patterns
!(pattern-list)   Matches anything except one of the given patterns
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;比如：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  $ ls +(ab|def)*+(.jpg|.gif)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;进一步参考  ls使用&lt;a href=&#34;http://www.linuxjournal.com/content/bash-extended-globbing&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PATTERN-MATCH&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Linux基础资料参考&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.gnu.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GNU官网&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://linux.vbird.org/linux_basic/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;鸟哥论坛&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://linux.about.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linux_About&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/bluebbc/tag/linux&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CN_Blogs的一个收集&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;3-事情流程&#34;&gt;3 事情流程&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;认定你的事情&lt;/li&gt;
&lt;li&gt;做&lt;/li&gt;
&lt;li&gt;检验&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;拓展为:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;认清楚这件事情；&lt;/li&gt;
&lt;li&gt;分析与这件事情有关的一切的一切；&lt;/li&gt;
&lt;li&gt;制定做好这件事情的计划；&lt;/li&gt;
&lt;li&gt;实施计划；&lt;/li&gt;
&lt;li&gt;验证这件事情的结果；&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>Bash Support IDE的新发现</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/10/23/bash-support-idede-xin-fa-xian/</link>
      <pubDate>Fri, 23 Oct 2015 00:28:00 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/10/23/bash-support-idede-xin-fa-xian/</guid>
      <description>&lt;p&gt;[Bash Support][1]实现一个vim的bash IDE工具。好处式可以较快捷的
输入命令和编程以及调试(bashdb)。&lt;/p&gt;
&lt;h2 id=&#34;支持的几种后缀文件&#34;&gt;支持的几种后缀文件&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;c 的.c  c++ 的.cc  .cpp  cc&lt;/li&gt;
&lt;li&gt;perl 的.pl&lt;/li&gt;
&lt;li&gt;awk的.awk&lt;/li&gt;
&lt;li&gt;shell的.sh&lt;/li&gt;
&lt;li&gt;vim的.vim文件&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;查看系统的各种template&#34;&gt;查看系统的各种template&lt;/h2&gt;
&lt;p&gt;&lt;font color=&#34;green&#34;&gt;当你新建一个*.sh文件&lt;/font&gt;
一定要记住的一个命令 \ntl,通过它可以知道各个template系统文件
都在干什么，以及如何使用那些快捷命令，比如\ckc \css \cfu \cc \cs  \se \sf 等。&lt;/p&gt;
&lt;h2 id=&#34;几个常见的macro&#34;&gt;几个常见的Macro&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;|FILENAME|&lt;/li&gt;
&lt;li&gt;|AUTHOR|&lt;/li&gt;
&lt;li&gt;|DATE|&lt;/li&gt;
&lt;li&gt;|TIME|&lt;/li&gt;
&lt;li&gt;|EMAIL|&lt;/li&gt;
&lt;li&gt;|ORGANIZATION|&lt;/li&gt;
&lt;li&gt;|AUTHORREF|&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;font color=&#34;red&#34;&gt;你可以在.vim/bundle/bash-support.vim/bash-support/templates/Template文件(
这边使用的是相对路径，我是通过bundle进行管理vim插件).&lt;/font&gt;&lt;/p&gt;
&lt;h2 id=&#34;css-的程序几个大的部分的注释&#34;&gt;css 的程序几个大的部分的注释&lt;/h2&gt;
&lt;p&gt;当你敲入\css会在vim的下端出现一个输入栏，有下面几个选项&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&amp;lsquo;GLOBAL DECLARATIONS&amp;rsquo;     : &amp;lsquo;GLOBAL DECLARATIONS&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;COMMAND LINE PROCESSING&amp;rsquo; : &amp;lsquo;COMMAND LINE PROCESSING&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;SANITY CHECKS&amp;rsquo;           : &amp;lsquo;SANITY CHECKS&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;FUNCTION DEFINITIONS&amp;rsquo;    : &amp;lsquo;FUNCTION DEFINITIONS&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;TRAPS&amp;rsquo;                   : &amp;lsquo;TRAPS&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;MAIN SCRIPT&amp;rsquo;             : &amp;lsquo;MAIN SCRIPT&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;STATISTICS AND CLEAN-UP&amp;rsquo; : &amp;lsquo;STATISTICS AND CLEAN-UP&amp;rsquo;,&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;font color=&#34;red&#34;&gt;具体可以查看你的bash-support.vim/bash-support/templates/comment.templates&lt;/font&gt;
在该文件的一开头就define了shell文件的注释头。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;技巧可以通过 G然后TAB就可以直接补全了。&lt;/em&gt;
之所以说他特别好是因为，根据[《Pro Bash Programming》][4], 提出的关于
写更好的shell script的建议，如下所示：&lt;/p&gt;
&lt;ol start=&#34;0&#34;&gt;
&lt;li&gt;Comments  文件开头的注释，以及单行注释、函数注释、块注释&lt;/li&gt;
&lt;li&gt;Initialization of variables  变量声明&lt;/li&gt;
&lt;li&gt;Function definitions  函数定义&lt;/li&gt;
&lt;li&gt;Runtime configuration (parse options, read configuration file, and so on) 通过getopt解析脚本选项和运行所需的配置文件的导入&lt;/li&gt;
&lt;li&gt;Sanity check (are all values reasonable?)   一些判断、检查&lt;/li&gt;
&lt;li&gt;Command Run  程序运行&lt;/li&gt;
&lt;li&gt;Process information (calculate, slice and dice lines, I/O, and so on)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
#:    Title: wfe - List words ending with PATTERN
#: Synopsis: wfe [-c|-h|-v] REGEX
#:     Date: 2009-04-13
#:  Version: 1.0
#:   Author: Chris F.A. Johnson
#:  Options: -c - Include compound words
#:           -h - Print usage information
#:           -v - Print version number

set -x
export PS4=&#39;+ $LINENO : &#39;
## Script metadata
scriptname=${0##*/}
description=&amp;quot;List words ending with REGEX&amp;quot;
usage=&amp;quot;$scriptname [-c|-h|-v] REGEX&amp;quot;
date_of_creation=2009-04-13
version=1.0
author=&amp;quot;Chris F.A. Johnson&amp;quot;

## File locations
dict=$HOME/words
wordfile=$dict/singlewords
compoundfile=$dict/Compounds

## Default is not to show compound words
compounds=

## Reular expression supplied on the command line
pattern=$1

## Function definitions

die() #@ DESCRIPTION: print error message and exit with supplied return code
{     #@ USAGE: die STATUS [MESSAGE]
  error=$1
  shift
  [ -n &amp;quot;$*&amp;quot; ] printf &amp;quot;%s\n&amp;quot; &amp;quot;$*&amp;quot; &amp;gt;&amp;amp;2
  exit &amp;quot;$error&amp;quot;
}

usage() #@ DESCRIPTION: print usage information
{       #@ USAGE: usage
        #@ REQUIRES: variable defined: $scriptname
  printf &amp;quot;%s - %s\n&amp;quot; &amp;quot;$scriptname&amp;quot; &amp;quot;$description&amp;quot;
  printf &amp;quot;USAGE: %s\n&amp;quot; &amp;quot;$usage&amp;quot;
}

version() #@ DESCRIPTION: print version information
{          #@ USAGE: version
           #@ REQUIRES: variables defined: $scriptname, $author and $version
  printf &amp;quot;%s version %s\n&amp;quot; &amp;quot;$scriptname&amp;quot; &amp;quot;$version&amp;quot;
  printf &amp;quot;by %s, %d\n&amp;quot; &amp;quot;$author&amp;quot; &amp;quot;${date_of_creation%%-*}&amp;quot;
  #printf &amp;quot;by %s, %d\n&amp;quot; &amp;quot;$author&amp;quot; &amp;quot;${date_of_creation%%-*&amp;quot;   指的那边错误不是真正的错误！一般需要往上找
}
## parse command-line options, -c, -h, and -v
echo $(( $OPTIND ))
while getopts chv var
do
   case $var in
     c) compounds=$compoundfile ;;
     h) usage; exit ;;
     v) version; exit ;;
   esac
done
shift $(( $OPTIND - 1 ))  ## move out one parameter and then position to the right by one step
                          ## 右移操作
regex=$1
echo $(( $regex ))
## sanity check
if [ -z &amp;quot;$pattern&amp;quot; ]
then 
    {
        echo &amp;quot;Search term missing&amp;quot;
        usage
    } &amp;gt;&amp;amp;2
    exit 1
fi
## Search $wordfile and $compounds if it is defined
{
   cat &amp;quot;$wordfile&amp;quot;
   if [ -n &amp;quot;$compounds&amp;quot; ]  # not null  -n ~ -z   n :nonzero  z:zero
   then
      cut -f1 &amp;quot;$compounds&amp;quot;
   fi
#}| grep -i &amp;quot;.$regex$&amp;quot; |sort -fu   #errror
}| grep -i &amp;quot;.$regex$&amp;quot; |sort -fu 
## Case-insensitive sort; remove duplicates


&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ckc的几种注释关键字&#34;&gt;ckc的几种注释关键字&lt;/h2&gt;
&lt;p&gt;当你敲入\ckc会在vim的下端出现一个输入栏，有下面几个选项&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&amp;lsquo;bug&amp;rsquo;         : &amp;lsquo;:BUG:|DATE| |TIME|:|AUTHORREF|: &lt;CURSOR&gt;&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;todo&amp;rsquo;        : &amp;lsquo;:TODO:|DATE| |TIME|:|AUTHORREF|: &lt;CURSOR&gt;&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;tricky&amp;rsquo;      : &amp;lsquo;:TRICKY:|DATE| |TIME|:|AUTHORREF|: &lt;CURSOR&gt;&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;warning&amp;rsquo;     : &amp;lsquo;:WARNING:|DATE| |TIME|:|AUTHORREF|: &lt;CURSOR&gt;&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;workaround&amp;rsquo;  : &amp;lsquo;:WORKAROUND:|DATE| |TIME|:|AUTHORREF|: &lt;CURSOR&gt;&amp;rsquo;,&lt;/li&gt;
&lt;li&gt;&amp;lsquo;new keyword&amp;rsquo; : &amp;lsquo;:&lt;CURSOR&gt;:|DATE| |TIME|:|AUTHORREF|: {+COMMENT+}&amp;rsquo;,&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;进一步的帮助参考[Bash Style Guide][2]
[1]:http://www.vim.org/scripts/script.php?script_id=365
[2]:https://lug.fh-swf.de/vim/vim-bash/StyleGuideShell.en.pdf
[3]: /images/linux/bash-keymap.png
[4]:http://www.apress.com/9781430219972/&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>FAST In Ubuntu64Bit 编译注意事项</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/10/22/fast-in-ubuntu64bit-bian-yi-zhu-yi-shi-xiang/</link>
      <pubDate>Thu, 22 Oct 2015 23:38:33 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/10/22/fast-in-ubuntu64bit-bian-yi-zhu-yi-shi-xiang/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://nwtc.nrel.gov/FAST8&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FAST(Fatigue,Aerodynamic,Struture,Turbulence)&lt;/a&gt;,是一款风力机的气动、水动力、
励磁、结构等几个部分的模拟&lt;a href=&#34;http://www.nrel.gov/docs/fy13osti/57228.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;工具&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;风力机系统的整体带入流风物理流动现象:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fast/WTSystem.png&#34; alt=&#34;Physical phenomena affecting a floating wind turbine system&#34;&gt;&lt;/p&gt;
&lt;p&gt;而本文主要讲的是如何在ubuntu64bit系统编译FAST使其可以使用。&lt;/p&gt;
&lt;h2 id=&#34;1-操作系统的位数&#34;&gt;1 操作系统的位数&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;找到Compiling文件夹下的makefile，然后将bits=32 改为64
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2registerexe编译&#34;&gt;2.register.exe编译&lt;/h2&gt;
&lt;p&gt;首先编译Source/dependecy/Registry 的makefile，然后生成一个register.exe 供给fast makefile使用&lt;/p&gt;
&lt;h2 id=&#34;3-map生成libmapso&#34;&gt;3. MAP++生成libmap.so&lt;/h2&gt;
&lt;p&gt;从官网https://nwtc.nrel.gov/MAP 下载map源文件，然后编译 生成一个libmap.so
注意： 必须是 lapack developer版本才可以，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; apt-get install lapack*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;并把so文件放到FAST目录下的bin文件夹（没有则创建），然后make fast的makefile即可。&lt;/p&gt;
&lt;h2 id=&#34;4-discon_dll编译使得nrel-5mw也能运行&#34;&gt;4 DISCON_DLL编译使得NREL 5MW也能运行&lt;/h2&gt;
&lt;p&gt;之前的三个步骤,在bin目录生成的FAST_glint64只能运行Test1-18.fst对应的机型.&lt;/p&gt;
&lt;p&gt;如果想运行Nrel-5MW（Test18-26.fst)必须是编译makefile_DISCON_DLL,并修改
CertTest/5MW_Baseline/ServDyn 的CertTest/5MW_Baseline/NRELOffshrBsline5MW_Onshore_ServoDyn.dat 更改对应的&lt;strong&gt;DLL_FileName&lt;/strong&gt; 为 &lt;em&gt;ServoData/DISCON_glin64.so&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&#34;41-编译方式&#34;&gt;4.1 编译方式&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;    make -f makefile_DISCON_DLL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;42注意有可能编译不通过&#34;&gt;4.2注意有可能编译不通过：&lt;/h3&gt;
&lt;p&gt;必须在makefile_DISCON_DLL中的  FFLAGS加入  -fPIC&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FFLAGS  = -O2 -m$(BITS) -fbacktrace -ffree-line-length-none -x f95-cpp-input -fPIC -C

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;针对与Fast开发者可以参考&lt;a href=&#34;https://nwtc.nrel.gov/FAST-Developers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FAST-Developers&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>基于现实，抽象现实，模拟现实</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/10/05/ji-yu-xian-shi-chou-xiang-xian-shi-mo-ni-xian-shi/</link>
      <pubDate>Mon, 05 Oct 2015 10:04:47 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/10/05/ji-yu-xian-shi-chou-xiang-xian-shi-mo-ni-xian-shi/</guid>
      <description>&lt;p&gt;信息与知识的不同在于，信息是暂时不被理解的知识，而当它被理解，并被组织，他也就成了知识。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;你的课题是什么&#34;&gt;你的课题是什么？&lt;/h2&gt;
&lt;p&gt;不再是老师布置的题目，而是基于现实，充分调研，提取你需要的信息，
进行分布式抽象，合理分类，构建知识系统，从而模拟你所expected的现实，
来论证理论……&lt;/p&gt;
&lt;p&gt;知识的存在就因为被interpreted or made sense,namely some what happened
have been interpreted and compared ,finnalys tored into your knowledge
system in the memory(in your head not in the world),更进一步可以阅读
《The Design of Everyday Things》.&lt;/p&gt;
&lt;h2 id=&#34;获取知识的途径&#34;&gt;获取知识的途径？&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;A goal &amp;ndash;&amp;gt;    Your expected things.What do you want?&lt;/li&gt;
&lt;li&gt;B plan &amp;ndash;&amp;gt;    what&amp;rsquo;s your actions to get what you want&lt;/li&gt;
&lt;li&gt;C specify  &amp;ndash;&amp;gt; what action can I do now? Design a conceptual model&lt;/li&gt;
&lt;li&gt;D perform  &amp;ndash;&amp;gt; How do I do it! Get affordance to execute the action&lt;/li&gt;
&lt;li&gt;E perceive &amp;ndash;&amp;gt; What happened after you done the action?&lt;/li&gt;
&lt;li&gt;F interpret &amp;ndash;&amp;gt; explain what happened?&lt;/li&gt;
&lt;li&gt;G compare   &amp;ndash;&amp;gt; it is okay? is it what you want? compare with what you want?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;BCD&lt;/code&gt; is called the stage of execute while &lt;code&gt;EFG&lt;/code&gt; is called the stage of evaluation. Also ,you can call &lt;code&gt;BCD&lt;/code&gt; stage as FeedForward which aid in understanding the process of what can you do.And &lt;code&gt;EFG&lt;/code&gt; stage can be also looked at as FeedBack stage which aid in understanding the process of what happened.&lt;/p&gt;
&lt;p&gt;In the stage of perceive, you can use some signifiers such as light,colors etc in order to communicate with people sucessfully.
In the stage of interpret, it means mapping the knowledge.&lt;/p&gt;
&lt;h2 id=&#34;大量文章的阅读方法&#34;&gt;大量文章的阅读方法&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;前言（引言）的第三段讲述作者为什么要进行这项工作、依据、方法（可能一些结果）&lt;/li&gt;
&lt;li&gt;文章中的图表（提出的表征方法和性能变化）&amp;ndash;技术手段&amp;ndash;研究路线&lt;/li&gt;
&lt;li&gt;结论（这些表征方法是否实现了既定的目标以及是否还需要优化（产物的性能怎么样？模拟的精度？未发现的自然现象？）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;摘要的阅读方法&#34;&gt;摘要的阅读方法&lt;/h2&gt;
&lt;p&gt;一般分为三句话。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;第一句话对应引言第一段。比如说某个东西多NB。&lt;/li&gt;
&lt;li&gt;第二句化对应引言第二段。这个NB东西的工作机理激发了我们设计新的方案的灵感&lt;/li&gt;
&lt;li&gt;第三句话对应Here we report。。回答四个问题&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;我们到底做了什么？&lt;/li&gt;
&lt;li&gt;怎么做的?&lt;/li&gt;
&lt;li&gt;为什么能做到？&lt;/li&gt;
&lt;li&gt;结果怎么样？&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;想把一个研究工作讲成一个好故事，最关键式该工作取得好的结果。上述过程也满足
SQCA原则，SQCA（situations&amp;mdash;conflict&amp;ndash;Questions&amp;mdash;Answers),很多人针对situations和conflicts基本上都不按章出牌。&lt;/p&gt;
&lt;p&gt;这些都是前人的一些经验，加油你的topic。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>fortran宫殿</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/08/09/fortrangong-dian/</link>
      <pubDate>Sun, 09 Aug 2015 15:06:38 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/08/09/fortrangong-dian/</guid>
      <description>&lt;p&gt;任何语言应该都可以有类似宫殿的想法，在纵横交错的街道中，能过找到进口和出口，
并可以使用很多条道路完成你想去的地方，而不是拘泥于一条道路。Fortran也是如此。
诞生于1951年左右的第一个面向对象的高级语言Fortran 语言，也已经65岁左右了，它以其
快速有效的科学数值计算，一直运用于科学研究领域中。
浅显针对fortran的理解&amp;mdash;-宫殿式的介绍.&lt;/p&gt;
&lt;h2 id=&#34;宫殿&#34;&gt;宫殿&lt;/h2&gt;
&lt;p&gt;宫殿蕴含着纵横交错，阡陌交通，但是确实零落有序，复合规律。通过宫殿群来认识这门科学语言。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/palace.jpg&#34; alt=&#34;宫殿&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;fortran&#34;&gt;fortran&lt;/h2&gt;
&lt;p&gt;fortran包含以下主要几个部分&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#3.1&#34;&gt;进口(初始化)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.2&#34;&gt;数组&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.3&#34;&gt;过程定义(子程序和函数)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.4&#34;&gt;模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.5&#34;&gt;出口&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3.6&#34;&gt;文件组合&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;3.1&#34;&gt; 进口&lt;/h3&gt;
&lt;p&gt;程序在开始设计的时候，需要变量初始化，也就是进行进口的布置。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/wumen.jpg&#34; alt=&#34;input&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;3.2&#34;&gt; 数组arrays and allocatable &lt;/h3&gt;
&lt;p&gt;有时候我们发现一条街到应该相同的样式，于是我们采用数组把具有相同的
数据形成放进一个一个的房屋。&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/wumen.jpg&#34; alt=&#34;arrays&#34;&gt;
fortran的dimension是相当常见的形式，因为他就是数组的体现。
一般房屋的建造都是需要allocatable的属性，也就是政府指定的可用地，利用allocate建房，使用完，废弃了，就deallocate。&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/zhengdi.jpg&#34; alt=&#34;zhengdi&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;3.3&#34;&gt;subroutine and function&lt;/h3&gt;
&lt;p&gt;房屋一多我们发现没法管理，于是我们就把很多的房屋放在对应的街道中去,也就是
subroutine或者function当中。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/street.png&#34; alt=&#34;街道&#34;&gt;&lt;/p&gt;
&lt;p&gt;另外有时候有一些已经在外建的subroutine和function一定得把他们的头和参数类型和end部分提交到program（政府）当中的INTERFACE当中，这样才能确定这块地的合法性等。
这也是为什么fortran中有时会有额外的子程序的定义（和主文件不在同一个文件夹当中），为了让主文件能够识别，使用INTERFACE把它嵌入进来(后来引入module减少了interface的作用)。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/zhai.jpg&#34; alt=&#34;interface&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;3.4&#34;&gt; 升级版的module&lt;/h3&gt;
&lt;p&gt;为了管理和维护房间(arrays)和街道(subs)，于是我们把他们放在一个一个区域当中。&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/module.png&#34; alt=&#34;module&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;3.5&#34;&gt; 出口 &lt;/h3&gt;
   当我们绕过了整个宫殿后，还需要布置一个或多个的出口。 ![output][5]
&lt;h3 id=&#34;3.6&#34;&gt; 然而我们发现我们需要更大的进口说明&lt;/h3&gt;
&lt;p&gt;有时候我们进一步组装多个输入文件，而为了方便，我们把他们组装成一个更大的进口装置，放置在最前面。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/fortran/square.jpg&#34; alt=&#34;square&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;后续&#34;&gt;后续&lt;/h2&gt;
&lt;p&gt;无论模块化，还是函数化，亦或者模式化，都是基于原先大的过程式变成的改成，
只不过是为了减少冗余、重复，同时简化和方便阅读，另外还有就是方便拓展。
&lt;em&gt;从现在开始可以建立你自己的fortranlibrary modal&lt;/em&gt; (&lt;font color=&#34;red&#34;&gt;一个不错的建议&lt;/font&gt;)&lt;/p&gt;
&lt;p&gt;fortran2003出来了个type这个数据结构的创建，方便的把多个变量或者数组组合成为一种数据类型，这就有点像3D打印的功能：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  type creat_a
    real :: a
    integer :: b
    real,allocatable :: c(:)
  end type creat_a
  
  type(creat_a) :: creat_b,creat_c
  
  creat_b%a = 1.0
  creat_b%b = 2
  allocate (creat_b%c(3))
  creat_b%c = 6.0
  
  creat_c = creat_b
  creat_c%b = 8

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;type的作用类似Hashkell的data的作用，没有行为只有数据类型。
先开个头……&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Shell_Programming_with_fewer_bugs</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/08/09/shell-programming-with-fewer-bugs/</link>
      <pubDate>Sun, 09 Aug 2015 14:37:30 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/08/09/shell-programming-with-fewer-bugs/</guid>
      <description>&lt;p&gt;shell的强大之处在于短小精悍，对于IO处理相当方便，当然也可以兼杂小型的数值计算（很少）。
shell脚本在编写过程中也会产生很多bug。本文借鉴《Pro-Bash-Programming》一书所提倡的：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;comment  写上开头注释&lt;/li&gt;
&lt;li&gt;Initialization of variables 变量初始化&lt;/li&gt;
&lt;li&gt;Function definitions  函数定义&lt;/li&gt;
&lt;li&gt;Runtime configuration 解析选项，读取配置文件等&lt;/li&gt;
&lt;li&gt;Sanity Check  经过Runtime配置之后，可能修改某些值，比如shift操作，所以需要判断变量的合理性&lt;/li&gt;
&lt;li&gt;Process information   最后才是计算、IO等&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;通过这中编写框架，可以减少错误。&lt;/p&gt;
&lt;p&gt;a. 首先保存最后的shell代码到一个文件wfe.sh
b. 其次下载所需要的字典文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  mkdir ~/words
  cd ~/words
 wget http://cfaj.freeshell.org/wordfinder/Compounds
 wget http://cfaj.freeshell.org/wordfinder/singlewords

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;c. 运行脚本&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
1. 获取帮助
  bash wfe.sh -h
2. 获取版本信息
  bash wfe.sh -v
3.单个单词查找  
  bash wfe.sh bro
4. 复合单词内查找（包含单个单词）
  bash wfe.sh -c bro 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;d. 源码文件：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
#:    Title: wfe - List words ending with PATTERN
#: Synopsis: wfe [-c|-h|-v] REGEX
#:     Date: 2009-04-13
#:  Version: 1.0
#:   Author: Chris F.A. Johnson
#:  Options: -c - Include compound words
#:           -h - Print usage information
#:           -v - Print version number

set -x
export PS4=&#39;+ $LINENO : &#39;

## 变量初始化
## Script metadata
scriptname=${0##*/}
description=&amp;quot;List words ending with REGEX&amp;quot;
usage=&amp;quot;$scriptname [-c|-h|-v] REGEX&amp;quot;
date_of_creation=2009-04-13
version=1.0
author=&amp;quot;Chris F.A. Johnson&amp;quot;

## File locations
dict=$HOME/words
wordfile=$dict/singlewords
compoundfile=$dict/Compounds  # 源代码作者在这边设下陷阱1  con--&amp;gt;com

## Default is not to show compound words
compounds=

## Reular expression supplied on the command line
pattern=$1

## Function definitions 函数定义 

#提倡使用这样编写函数@ Description @Usage：
die() #@ DESCRIPTION: print error message and exit with supplied return code
{     #@ USAGE: die STATUS [MESSAGE]
  error=$1
  shift
  [ -n &amp;quot;$*&amp;quot; ] printf &amp;quot;%s\n&amp;quot; &amp;quot;$*&amp;quot; &amp;gt;&amp;amp;2
  exit &amp;quot;$error&amp;quot;
}

usage() #@ DESCRIPTION: print usage information
{       #@ USAGE: usage
        #@ REQUIRES: variable defined: $scriptname
  printf &amp;quot;%s - %s\n&amp;quot; &amp;quot;$scriptname&amp;quot; &amp;quot;$description&amp;quot;
  printf &amp;quot;USAGE: %s\n&amp;quot; &amp;quot;$usage&amp;quot;
}

version() #@ DESCRIPTION: print version information
{          #@ USAGE: version
           #@ REQUIRES: variables defined: $scriptname, $author and $version
  printf &amp;quot;%s version %s\n&amp;quot; &amp;quot;$scriptname&amp;quot; &amp;quot;$version&amp;quot;
  printf &amp;quot;by %s, %d\n&amp;quot; &amp;quot;$author&amp;quot; &amp;quot;${date_of_creation%%-*}&amp;quot;
  #printf &amp;quot;by %s, %d\n&amp;quot; &amp;quot;$author&amp;quot; &amp;quot;${date_of_creation%%-*&amp;quot;   指的那边错误不是真正的错误！一般需要往上找
}

## parse command-line options, -c, -h, and -v 解析

echo $(( $OPTIND ))
while getopts chv var
do
   case $var in
     c) compounds=$compoundfile ;;
     h) usage; exit ;;
     v) version; exit ;;
   esac
done
shift $(( $OPTIND - 1 ))  ## move out one parameter and then position to the right by one step
                          ## 右移操作
regex=$1           ## 设下陷阱2 没有注册regex变量，却直接调用$regex
echo $(( $regex ))

## sanity check   设下陷阱3 没有进行错误检查

if [ -z &amp;quot;$pattern&amp;quot; ]
then 
    {
        echo &amp;quot;Search term missing&amp;quot;
        usage
    } &amp;gt;&amp;amp;2
    exit 1
fi


## Search $wordfile and $compounds if it is defined
{
   cat &amp;quot;$wordfile&amp;quot;
   if [ -n &amp;quot;$compounds&amp;quot; ]  # not null  -n ~ -z   n :nonzero  z:zero
   then
      cut -f1 &amp;quot;$compounds&amp;quot;
   fi
#}| grep -i &amp;quot;.$regex$&amp;quot; |sort -fu   #errror
}| grep -i &amp;quot;.$regex$&amp;quot; |sort -fu 

## Case-insensitive sort; remove duplicates


&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>AllFilesInFoldsToOneFile</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/08/09/allfilesinfoldstoonefile/</link>
      <pubDate>Sun, 09 Aug 2015 14:03:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/08/09/allfilesinfoldstoonefile/</guid>
      <description>&lt;ol&gt;
&lt;li&gt;find的使用&lt;/li&gt;
&lt;li&gt;更新了注释&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#!/bin/bash - 
#===============================================================================
#
#          FILE: browserNew.sh
# 
#         USAGE: ./browserNew.sh 
# 
#   DESCRIPTION: 
# 
#       OPTIONS: ---
#  REQUIREMENTS: ---
#          BUGS: ---
#         NOTES: ---
#        AUTHOR: Ye Zhaoliang (), zhaoturkkey@163.com
#  ORGANIZATION: YZL
#       CREATED: 2015年06月27日 15:19
#      REVISION:  ---
#===============================================================================

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  generateChapter
#   DESCRIPTION:  针对不同额文件采用不同的处理方法，判断目录 和判断脚本是一个重要的操作
#                 但是更为重要的是 find获得文集拿的绝对路径(相对于当前文件)
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------

## Function definition 

generateChapter() # @Description : 对不同文件进行不同处理
                  # @usage       : generatechapter
{
    # 妙用find 得到当前目录的相对路径 不需要不断的进入目录
    for var in `find . -name &amp;quot;*&amp;quot;`
    do
        if [[ -d  $var ]] # &amp;lt; cannot . Error
        then
            echo &amp;quot;${currentDir}${var#.}是一个目录&amp;quot; # 使用#号来删除之前的点号
    # 为什么会想到使用 ${var##*/}因为var是一个相对当前文件的绝对路径，所以经过测试发现他和${0}等效如果截取到最大长度的/的话
        elif [[ &amp;quot;${var##*/}&amp;quot; == &amp;quot;${0}&amp;quot; ]] # 一定要注意等式两边有空格
        then
            echo &amp;quot;${currentDir}${var#.} ${0} 脚本文件不处理&amp;quot;
        else
            getFile ${currentDir}${var#.} # 这边需要去除到第一个点号,这是才得到的处理方法
        fi

    done
}



#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  getFile
#   DESCRIPTION:  在每个文件的头部添加一些信息
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
getFile() #@ Description: 细节处理  包括产生开头 产生边框等
          #@ Usage      : getFile
{
    startString=&amp;quot;# -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------#&amp;quot;
    endString=&amp;quot;# --------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; ended &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------#&amp;quot;
       #echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo -e &amp;quot;\033[44;37m -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------\033[0m&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo  &amp;quot;# -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo $startString &amp;gt;&amp;gt; summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#startString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#startString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#startString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh ### 不加上$反而不行
   # echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
   # echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
    sed &#39;1,7d&#39; $1 &amp;gt;&amp;gt; summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#endString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#endString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#endString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo -e &amp;quot;\033[43;37m --------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; ended &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------\033[0m&amp;quot; &amp;gt;&amp;gt; summary.sh
    #echo &amp;quot;# --------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; ended &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------&amp;quot; &amp;gt;&amp;gt; summary.sh
    echo $endString &amp;gt;&amp;gt; summary.sh
    echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    
}

## variable initial 
currentDir=`pwd`


## processing information 
# 如果存在 summary.sh 证明已经存在了，就先把删掉， 因为这里是
# 采用追加的方式，而不是写入。
if [[ -e ./summary.sh ]]
then 
    rm -rf ./summary.sh
fi
# 调用产生所有的文件夹内的数据到一个文件中
generateChapter


&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Incompact3d的Makefile及DNS算法</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dde-makefileji-dnssuan-fa/</link>
      <pubDate>Mon, 22 Jun 2015 16:52:20 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dde-makefileji-dnssuan-fa/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://code.google.com/p/incompact3d&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Incompact3d&lt;/a&gt;是一个开源的基于fortran语言编写的DNS求解器，也是我研究生期间使用的开源源代码。
Incompact3d整体框架的介绍可以参考软件的&lt;a href=&#34;https://code.google.com/p/incompact3d/downloads/detail?name=user_guide_incompact3d_V1-1.pdf&amp;amp;can=2&amp;amp;q=&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;user-guide&lt;/a&gt;和文献&lt;a href=&#34;http://www.imperial.ac.uk/media/imperial-college/research-centres-and-groups/turbulence-mixing-and-flow-control-group/2009_LAIZET_JCP.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;High-order-compact schemes for incompressible flows: a simple and effcient method with the quasi-spectral accuary&lt;/a&gt;,还可以搜索&lt;a href=&#34;http://www.imperial.ac.uk/tmfc&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sylvain Laziet&lt;/a&gt; 相关的文章 ，只不过他并不是成熟的软件，很多的编译和后处理都可能出现问题，下面是我使用过程遇到的一些问题。
当然主要过程是，通过makefile编译，然后运行incompact3d，最后处理计算结果。&lt;/p&gt;
&lt;p&gt;#1 如何模拟？&lt;/p&gt;
&lt;p&gt;以周期性槽道流动(当然我也就会这么一种，其他都只是走了一小半）为例。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先是得到(不得不说，我也有点忘记)一个完全发展的旋转槽道流动(注意旋转源项的添加) (一般设置20000步可以了，只要收敛即可 大概一天)&lt;/li&gt;
&lt;li&gt;然后是获得完全发展槽道流动(也就是不加上旋转源项)(估计得三万步以上 大概一天)&lt;/li&gt;
&lt;li&gt;最后是获得统计的完全发展槽道流动.因为DNS获得的结果是非定常的，所以你得进行时均处理(当然时均程序得打开时均统计项 umean等)(我统计了20万步，大概花了4天时间。)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;步骤就是这样,大概一个较小的流程需要一周左右。&lt;/p&gt;
&lt;p&gt;Incompact3d比较特殊的是收敛性判定问题，上面的几个过程都需要使用实时&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/05/31/u-plus-y-plus/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;监控小程序&lt;/a&gt;
来观看速度散度和质量流量(质量流量是周期性槽道流动所特有的，所以最好进行实时显示)的收敛情况.另外你可以通过python的一个小脚本
来获得实时显示的图片，这样就能看到程序模拟得怎么样了，具体查看&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/06/11/ji-yu-pythonde-ju-yu-wang-wen-jian-gong-xiang-ruan-jian-simplehttpserverwithupload/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;python局域网上传和下载&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;#2 后处理方法
参考我的&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dru-he-tong-guo-jie-guo-chu-li-chu-ji-xian&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;pathline处理方法&lt;/a&gt;
一定要注意(real 8) 否则得到的结果肯定是错误的，这也是困扰我几星期的问题。&lt;/p&gt;
&lt;p&gt;#3 关于Makefile编译&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;#=======================================================================
# Makefile for Imcompact3D
#=======================================================================

# Choose pre-processing options
#   -DSHM	   - enable shared-memory implementation
#   -DDOUBLE_PREC  - use double-precision
OPTIONS = -DDOUBLE_PREC

# Choose an FFT engine, available options are:
#   essl       - IBM Blue Gene ESSL Library
#   fftw3      - FFTW version 3.x
#   generic    - A general FFT algorithm (no 3rd-party library needed)
#FFT= essl # I ignore
FFT = generic

# Paths to FFTW 3
FFTW3_PATH=   # full path of FFTW installation if using fftw3 engine above
FFTW3_INCLUDE = -I$(FFTW3_PATH)/include
FFTW3_LIB = -L$(FFTW3_PATH)/lib -lfftw3 -lfftw3f

# Paths to ESSL
ESSL_PATH=/bgsys/drivers/ppcfloor/comm/xl
ESSL_INCLUDE =
ESSL_LIB = -L$(ESSL_PATH)/lib -L/opt/ibmmath/lib64 -lesslbg

# Specify Fortran and C compiler names and flags here
# Normally, use MPI wrappers rather than compilers themselves 
# Supply a Fortran pre-processing flag together with optimisation level flags
# Some examples are given below:

#FC =  
#OPTFC = 
#CC = 
#CFLAGS = 

# PGI
#FC = ftn
#OPTFC = -fast -O3 -Mpreprocess
#CC = cc
#CFLAGS = -O3

# PathScale
#FC = ftn
#OPTFC = -Ofast -cpp
#CC = cc
#CFLAGS = -O3

# GNU 选用mpif90进行编译
FC = mpif90
OPTFC = -O0 -g  -fdefault-real-8 -fdefault-double-8 -funroll-loops -ftree-vectorize -fcray-pointer -cpp
CC = mpicc
CFLAGS = -O0
PLATFORM=gnu

#Blue Gene/Q : EDF R&amp;amp;D
#PREP=/bgsys/drivers/ppcfloor/comm/xl/bin/
#FC = $(PREP)mpixlf95_r
#OPTFC= -O3 -qsuffix=cpp=f90 -qinitauto -qautodbl=dbl4
##OPT_LK= -O3 -qinitauto -qautodbl=dbl4
#CFLAGS= -O3 -qinitauto -qautodbl=dbl4
#CC=$(PREP)mpixlc_r
#PLATFORM=bgq_xlf

# Cray
#FC = ftn
#OPTFC = -e Fm
#CC = cc
#CFLAGS = 

#-----------------------------------------------------------------------
# Normally no need to change anything below

# include PATH 
ifeq ($(FFT),generic)
  INC=
else ifeq ($(FFT),fftw3)
  INC=$(FFTW3_INCLUDE)
else ifeq ($(FFT),essl)
  INC=$(ESSL_INCLUDE)
endif

# library path
ifeq ($(FFT),generic)
   LIBFFT=
else ifeq ($(FFT),fftw3)
   LIBFFT=$(FFTW3_LIB)
else ifeq ($(FFT),essl)
   LIBFFT=$(ESSL_LIB)
endif

# List of source files
# 注意这边编译的模块，一般是需要的mod生成放在前面首先编译，如果不放前面会报错，解决办法 就是文件名放在前面即可,具体可以查看关于Makefile Fortran
SRC = decomp_2d.f90 glassman.f90 fft_$(FFT).f90 module_param.f90 io.f90 variables.f90 poisson.f90 schemes.f90 implicit.f90 convdiff.f90 user_module.f90 incompact3d.f90 navier.f90 derive.f90 parameters.f90 tools.f90 visu.f90

#-----------------------------------------------------------------------
# Normally no need to change anything below

ifneq (,$(findstring DSHM,$(OPTIONS)))
SRC := FreeIPC.f90 $(SRC)  
OBJ =	$(SRC:.f90=.o) alloc_shm.o FreeIPC_c.o
else
OBJ =	$(SRC:.f90=.o)
endif	

OPTION=$(OPTIONS)
from:=-D
to:=-WF,-D
TMP=$(subst $(from),$(to),$(OPTIONS))
ifeq ($(PLATFORM),bgp_xlf)
   OPTION=$(TMP)
endif
ifeq ($(PLATFORM),bgq_xlf)
   OPTION=$(TMP)
endif

all: incompact3d

alloc_shm.o: alloc_shm.c
	$(CC) $(CFLAGS) -c $&amp;lt;

FreeIPC_c.o: FreeIPC_c.c
	$(CC) $(CFLAGS) -c $&amp;lt;

incompact3d : $(OBJ)
	$(FC) -O0 -g -o $@ $(OBJ) $(LIBFFT)

%.o : %.f90
	$(FC) $(OPTFC) $(OPTION) $(INC) -c $&amp;lt;

.PHONY: clean 
clean:
	rm -f *~ *.o *.mod incompact3d

.PHONY: realclean
realclean: clean
	rm -f *~ \#*\#
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行方式:
我的电脑刚好是8线程，就用8线程运行，你也可以选用4或者更多.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;mpirun -np 8  incompact3d  &amp;gt; tail.out &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#4 The Algorithm of the DNS in Incompact3d&lt;/p&gt;
&lt;p&gt;Incompact3d的执行流程基本上是下面几个(当然得仔细阅读，并反复比对).我写得这段英文大体能够对得上.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;1. Initial the velocity field with noise(init subroutine).
2. Start the iterative process by guessing the pressure field. First we use convdiff subroutine take convection and diffusion of the flow into consideration.And then use pre_correc subroutine to correction the velocity value with the specified boundary condition.
3. Use the values of u,v,and w to get the initialize of the pp3 in the spectral space from subroutine divergence(…pp3,1…)(first sign to turbulent spot).Then we use poisson solver decomp_2d_poisson_stag to get the value of the pp3 in the spectral space.
4. Since they were obtained from the guessed values of u,v,w,the values pp3,when substituted into the divergence equation,will not necessarily satisfy that that equation.Hence ,using the gradp subroutine,get the pressure gradients in the physics space,then using corgp subroutine ,get the velocity correction by the pressure gradient in the physics space.Use subroutine divergence(…dv3,2…) to do another monitor for turbulent spot(second sign to turbulent spot) .At the end of the current step, we go to step2 again until the simulation have been fully developed.
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Incompact3d如何通过结果处理出迹线</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dru-he-tong-guo-jie-guo-chu-li-chu-ji-xian/</link>
      <pubDate>Mon, 22 Jun 2015 16:20:48 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/22/incompact3dru-he-tong-guo-jie-guo-chu-li-chu-ji-xian/</guid>
      <description>&lt;p&gt;Incompact3D获得的数据都是二进制的数据文件，为了获得内部的文件
需要进一步通过编程获得，下面是一个获得pathline的源代码。&lt;/p&gt;
&lt;p&gt;说明：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过 module.f90文件读取 nx ny nz的值&lt;/li&gt;
&lt;li&gt;把下面的源代码编译并放在ux uy uz所在的文件夹当中&lt;/li&gt;
&lt;li&gt;进一步的相关信息，可以参考注释。&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-fortran&#34;&gt;PROGRAM b
IMPLICIT NONE
Integer,parameter :: nx=128,ny=129,nz=84 
INTEGER :: I,J,K,COUNT,LN=128,COL=129,VOL=84
REAL(8),DIMENSION(nx,ny,nz) :: ux,uy,uz
CHARACTER(len=12)::NAME1=&amp;quot;Incompact3d&amp;quot;,NAME2=&amp;quot;ux&amp;quot;,NAME3=&amp;quot;uy&amp;quot;,NAME4=&amp;quot;uz&amp;quot;
character(len=15) :: temp,temp1,temp2,temp3
CHARACTER(len=20) :: CFILEux
integer :: num

real,dimension(nx):: y1
real,dimension(ny):: y2
real,dimension(nz):: y3

!generation of the mesh
do i=1,nx
   y1(i)=(i-1)*0.098174770425 !0.8 is DX ! incompact3d.prm的配置长度除以网格尺度即可。
enddo


do j=1,ny
   y2(j)=(j-1)*0.015503875968992248 !0.8 is DY
enddo


do k=1,nz
   y3(k)=(k-1)*0.04986655005702381!0.8 is DZ
enddo


! 下面只是对于读取文件进行的一个后处理，只是为了方便批处理而已
22 format(I1)
23 format(I2)
DO num=1,30
    if(num .lt. 10) then
        write(temp,22) num
        temp1 =trim(NAME2)//trim(&#39;00&#39;)//trim(temp)
        temp2 =trim(NAME3)//trim(&#39;00&#39;)//trim(temp)
        temp3 =trim(NAME4)//trim(&#39;00&#39;)//trim(temp)
    else 
        write(temp,23) num
        temp1 =trim(NAME2)//trim(&#39;0&#39;)//trim(temp)
        temp2 =trim(NAME3)//trim(&#39;0&#39;)//trim(temp)
        temp3 =trim(NAME4)//trim(&#39;0&#39;)//trim(temp)
    end if
    
! 产生实际的文件名
CFILEux=trim(&#39;./pathchange/&#39;)//trim(temp1)//&#39;.dat&#39;
!read the ux 读取ux00*的数据
OPEN(10,FILE=temp1,FORM=&#39;UNFORMATTED&#39;,&amp;amp;
ACCESS=&#39;DIRECT&#39;, RECL=8, STATUS=&#39;OLD&#39;)

! read the uy
OPEN(11,FILE=temp2,FORM=&#39;UNFORMATTED&#39;,&amp;amp;
ACCESS=&#39;DIRECT&#39;, RECL=8, STATUS=&#39;OLD&#39;)
!read the uz
OPEN(12,FILE=temp3,FORM=&#39;UNFORMATTED&#39;,&amp;amp;
ACCESS=&#39;DIRECT&#39;, RECL=8, STATUS=&#39;OLD&#39;)

! 新建一个结果文件，并添加上tecplot的数据头

OPEN(20,FILE=CFILEux,FORM=&#39;FORMATTED&#39;)
WRITE (20,&#39;(A6,A12)&#39;)               &#39;TITLE=&#39;,TRIM(ADJUSTL(NAME1))
 WRITE (20,&#39;(A36)&#39;)    &#39;VARIABLES=&amp;quot;X&amp;quot;,&amp;quot;Y&amp;quot;,&amp;quot;Z&amp;quot;,&amp;quot;VX&amp;quot;,&amp;quot;VY&amp;quot;,&amp;quot;VZ&amp;quot;&#39;
      WRITE (20,&#39;(A7,I4,A1,A2,I4,A1,A2,I4,A1,A7)&#39;) &#39;ZONE I=&#39;,LN,&#39;,&#39;,&#39;J=&#39;,COL,&#39;,&#39;,&#39;K=&#39;,VOL,&#39;,&#39;,&#39;F=POINT&#39;

COUNT = 1
DO K=1,nz
    DO J=1,ny
        DO I=1,nx
            READ(10,REC=COUNT) ux(I,J,K)
            READ(11,REC=COUNT) uy(I,J,K)
            READ(12,REC=COUNT) uz(I,J,K)
        !    WRITE(20,30) I,J,K,ux(I,J,K),uy(I,J,K),uz(I,J,K)
             WRITE(20,30) y1(i),y2(j),y3(k),ux(I,J,K),uy(I,J,K),uz(I,J,K)
            30 format(I3,1X,I3,1X,I3,1X,E11.4,1x,E11.4,1x,E11.4)
            COUNT = COUNT + 1
        ENDDO
    ENDDO
ENDDO
ENDDO
CLOSE(10)
CLOSE(11)
CLOSE(10)
CLOSE(20)
END PROGRAM b
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>积累和重写对于程序员很重要</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/22/ji-lei-he-zhong-xie-dui-yu-cheng-xu-yuan-hen-zhong-yao/</link>
      <pubDate>Mon, 22 Jun 2015 15:35:19 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/22/ji-lei-he-zhong-xie-dui-yu-cheng-xu-yuan-hen-zhong-yao/</guid>
      <description>&lt;p&gt;积累，你才能厚积而薄发。
重写，你才能进一步认识你的积累.
重写有时候会带来对于知识的进一步深入的理解.&lt;/p&gt;
&lt;p&gt;今天听了&lt;a href=&#34;http://www.fcode.cn&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fcode&lt;/a&gt;的一个视频讲座，一个立志于开源的非营利小团队，还有一个专门的Fortran Coder的qq群。听完感觉，自己真的很有缺点，之前上过一个java培训班，其实套路都一样，写代码，重复写，直到你睡觉醒来还能写，喝了半斤52度二锅头还能写。&lt;/p&gt;
&lt;p&gt;并且需要在一定的时间内回顾，重写之前你写过的东西，虽然听起来很简单，可是我经常也是忘记了这个该做的工作。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;积累&lt;/li&gt;
&lt;li&gt;重写&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这两项对于学习任何一个科目都至关重要和必不可少。武功再高,也要练操。&lt;/p&gt;
&lt;p&gt;fortran是简单，而且是基于解决数学、物理问题,擅长科学计算，而不是利用它做一个漂亮的界面。基本上fortran的很多算法都可以通过网络资源搜索得到，并进行适当修改，这也需要你去积累。但是fortran给你思维层次的改造不是特别明显，所以从这个角度来说，我并不觉得他是一门好的语言，但是他的计算能力还真的不错，特别是矩阵计算能力。也许我也该经常整理fortran相关的编程知识。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>字符串关键字的出现频率统计</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/14/zi-fu-chuan-guan-jian-zi-de-chu-xian-pin-lu-tong-ji/</link>
      <pubDate>Sun, 14 Jun 2015 01:50:24 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/14/zi-fu-chuan-guan-jian-zi-de-chu-xian-pin-lu-tong-ji/</guid>
      <description>&lt;p&gt;有时候我们需要统计一篇论文当中某个字符串的出现频率。
试验了，grep，awk，sed，wc -l等，最终发现awk的RS
完美的解决了问题。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/fhefh/archive/2011/11/16/2251656.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RS的用法&lt;/a&gt;
&lt;a href=&#34;http://blog.163.com/facteur@126/blog/static/23208030201282085943698/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;统计次数&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;关键字文件（可以不断的添加你要分析的字段):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;风力机
气动力
失谐
偏航
阵风
扭矩
功率
风切变
转速
风速
升力系数
阻力系数
升阻比


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;短短的几行shell语句解决了问题，优雅。
shell文件：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
#!/bin/bash - 
#===============================================================================
#
#          FILE: analysis.sh
# 
#         USAGE: ./analysis.sh 
# 
#   DESCRIPTION: 
# 
#       OPTIONS: ---
#  REQUIREMENTS: ---
#          BUGS: ---
#         NOTES: ---
#        AUTHOR: Ye Zhaoliang (), zhaoturkkey@163.com
#  ORGANIZATION: YZL
#       CREATED: 2015年06月14日 01:18
#      REVISION:  ---
#===============================================================================

while read lines
do
    awk -v RS=&amp;quot;$lines&amp;quot; &#39;END{print RS,--NR}&#39; qiu.org #减减表示减1
done &amp;lt; &amp;quot;analysis.data&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;搜索内容&#34;&gt;搜索内容&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;grep -n &amp;ldquo;内容关键字&amp;rdquo; 文件名路径&lt;/li&gt;
&lt;li&gt;awk &amp;lsquo;{if($0~关键字){}}&amp;rsquo;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;等。
3. sed &amp;lsquo;/关键字/p&amp;rsquo;&lt;/p&gt;
&lt;h2 id=&#34;结果&#34;&gt;结果&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;┌─[root][javazhao-N53SM][/paper]
└─➞ sh analysis.sh 
风力机 379
气动力 397
失谐 31
偏航 353
阵风 63
扭矩 171
功率 139
风切变 59
转速 172
风速 353
升力系数 27
阻力系数 13
升阻比 2

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>把时间和键盘写进script</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/13/ba-shi-jian-he-jian-pan-xie-jin-script/</link>
      <pubDate>Sat, 13 Jun 2015 20:00:58 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/13/ba-shi-jian-he-jian-pan-xie-jin-script/</guid>
      <description>&lt;p&gt;在Linux地下，脚本(script)编程是一个快捷的方式和内核(kernel)进行交流。
通常包含以下几种脚本编程:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bash shell(其他shell也类似)&lt;/li&gt;
&lt;li&gt;perl&lt;/li&gt;
&lt;li&gt;python&lt;/li&gt;
&lt;li&gt;ruby&lt;/li&gt;
&lt;li&gt;等等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我现在发现我们既可以处理文件中的信息，也同时可以处理硬件的东西，这些其实我就清楚，比如linux把很多的设备都虚拟为文件，只不过之前不知道怎么用。
接触到shell之后，我才发现比如键盘的东西都可以被写进脚本的，也就是电脑上的外接设备也是可以被写进程序当中的，当作计算机里面的一种概念。&lt;/p&gt;
&lt;h2 id=&#34;vim的脚本化操作&#34;&gt;vim的脚本化操作&lt;/h2&gt;
&lt;p&gt;把下段的代码保存为c.sh,主要功能是把双个除号改为井号，当作注释。
这样就可以把vim的action行为录为脚本。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
vim ./cData &amp;lt;&amp;lt;VIM &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 
:%s#//#\##
:wq 
VIM 
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;/dev/null 2&amp;gt;&amp;amp;1  拆为四部分来分析下:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;首先 0&amp;gt; 表示stdin标准输入; 1&amp;gt; 表示stdout标准输出; 2&amp;gt; 表示stderr错误输出;&lt;/li&gt;
&lt;li&gt;符号 &amp;gt;  等价于 1&amp;gt; (系统默认为1,省略了先); 所以&amp;quot;&amp;gt;/dev/null&amp;quot;等同于 &amp;ldquo;1&amp;gt;/dev/null&amp;rdquo;&lt;/li&gt;
&lt;li&gt;/dev/null 代表空设备文件&lt;/li&gt;
&lt;li&gt;&amp;amp; 可以理解为是&amp;quot;等同于&amp;quot;的意思，2&amp;gt;&amp;amp;1，即表示2的输出重定向等同于1
因此，&amp;gt;/dev/null 2&amp;gt;&amp;amp;1 也可以写成“1&amp;gt; /dev/null 2&amp;gt; &amp;amp;1”&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;那么本文标题的语句执行过程为：
1&amp;gt;/dev/null ：首先表示标准输出重定向到空设备文件，也就是不输出任何信息到终端，说白了就是不显示任何信息。
2&amp;gt;&amp;amp;1 ：接着，将标准错误输出重定向 到 标准输出，因为之前标准输出已经重定向到了空设备文件，所以标准错误输出也重定向到空设备文件。&lt;/p&gt;
&lt;p&gt;类似还有cat&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cat &amp;gt;&amp;gt; /etc/man.config &amp;lt;&amp;lt;EOF
MANPATH  /srv/httpd/man/
EOF

cat &amp;gt;&amp;gt; /etc/profile.d/http.sh &amp;lt;&amp;lt;EOF
export PATH=/srv/httpd/bin:$PATH
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;mysql的脚本化操作&#34;&gt;mysql的脚本化操作&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;mysql -u$user -p$password &amp;lt;&amp;lt; EOF  
FLUSH TABLES WITH READ LOCK;  
system lvcreate --snapshot -n $snap -L$snapsize /dev/$vg/$lv;  
UNLOCK TABLES;  
quit  
EOF 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;gnuplot的脚本化操作&#34;&gt;gnuplot的脚本化操作&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;gnuplot&amp;lt;&amp;lt;EOF   
set ter &#39;png&#39;   
set out &#39;$i/cpUp.png&#39;  
plot &amp;quot;$i/cpUp.txt&amp;quot; t &#39;cp&#39; w lp  
EOF 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;获得键盘输入的两种方式&#34;&gt;获得键盘输入的两种方式&lt;/h2&gt;
&lt;h3 id=&#34;使用read&#34;&gt;使用read&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
read -p &amp;quot;input a val:&amp;quot;  val
echo $val

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;使用stty&#34;&gt;使用stty&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
get_char(){
   SAVEDSTTY=`stty -g`
   stty -echo
   stty raw
   dd if=/dev/tty bs=1 count=1 2&amp;gt; /dev/null
   stty -raw
   stty echo
   stty $SAVEDSTTY
}
echo &amp;quot;Press any key to continue...&amp;quot;
char=`get_char`
read k
echo $k
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;不错的一个菜单输入&#34;&gt;不错的一个菜单输入&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
#字颜色：30—–37  
#字背景颜色范围：40—–47 

while :
do
    echo &amp;quot;\033[5m 1) china \033[0m&amp;quot; 
    echo &amp;quot;\033[32m 2) America \033[0m&amp;quot; 
    echo &amp;quot;\033[33m 3) Japan \033[0m&amp;quot; 
    echo &amp;quot;\033[34m 4) England \033[0m&amp;quot; 
    echo &amp;quot;\033[35m 5) France \033[0m&amp;quot; 
    echo &amp;quot;\033[36m 6) Spain \033[0m&amp;quot; 
    echo &amp;quot;\033[37m 7) Brazil \033[0m&amp;quot; 
    echo &amp;quot;\033[40;37m 8) Turkey \033[0m&amp;quot; 
    echo &amp;quot;\033[41;37m 9) Italy \033[0m&amp;quot; 
    echo &amp;quot;\033[42;37m 10) Germany \033[0m&amp;quot; 
    echo &amp;quot;\033[43;37m 11) Arabi \033[0m&amp;quot; 

    read -p &amp;quot;Please Enter the number [1-11]&amp;quot; val
    case $val in
        1) echo &amp;quot;\033[5m 1) You input the --&amp;gt; china\n \033[0m&amp;quot; 
            ;;
        2) echo &amp;quot;\033[32m 2) You input the --&amp;gt; America \n\033[0m&amp;quot; 
            ;;
        3) echo &amp;quot;\033[33m 3) You input the --&amp;gt; Japan\n \033[0m&amp;quot; 
            ;;
        4) echo &amp;quot;\033[34m 4) You input the --&amp;gt; England \n\033[0m&amp;quot; 
            ;;
        5) echo &amp;quot;\033[35m 5) You input the --&amp;gt; France \n \033[0m&amp;quot; 
            ;;
        6) echo &amp;quot;\033[36m 6) You input the --&amp;gt; Spain\n \033[0m&amp;quot; 
            ;;
        7) echo &amp;quot;\033[37m 7) You input the --&amp;gt; Brazil\n \033[0m&amp;quot; 
            ;;
        8) echo &amp;quot;\033[40;37m 8) You input the --&amp;gt; Turkey\n \033[0m&amp;quot; 
            ;;
        9) echo &amp;quot;\033[41;37m 9) You input the --&amp;gt; Italy\n \033[0m&amp;quot; 
            ;;
        10) echo &amp;quot;\033[42;37m 10) You input the --&amp;gt; Germany\n \033[0m&amp;quot; 
            ;;
        11) echo &amp;quot;\033[43;37m 11) You input the --&amp;gt; Arabi\n \033[0m&amp;quot; 
            ;;
        *) exit 0
            ;;
    esac
    echo &amp;quot;&amp;quot;
done

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/menu.png&#34; alt=&#34;结果&#34;&gt;&lt;/p&gt;
&lt;p&gt;持续更新本文的script的内容&amp;hellip;.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>基于python的局域网文件共享软件SimpleHTTPServerWithUpload</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/11/ji-yu-pythonde-ju-yu-wang-wen-jian-gong-xiang-ruan-jian-simplehttpserverwithupload/</link>
      <pubDate>Thu, 11 Jun 2015 23:00:09 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/11/ji-yu-pythonde-ju-yu-wang-wen-jian-gong-xiang-ruan-jian-simplehttpserverwithupload/</guid>
      <description>&lt;p&gt;我有两台电脑，都有IP，处于相同的局域网。
我想传递文件，然而我又不想用U盘，我也不想用teamview，更不想用比如百度盘、新浪盘，有道云笔记等。
我想要用命令行解决。python提供了一种解决方案。
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/shangchuan.png&#34; alt=&#34;上传&#34;&gt;&lt;/p&gt;
&lt;p&gt;python内部支持Simplehttpserver服务，所以只要装上python即可&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;python Simplehttpserver 

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;默认浏览器打开  127.0.0.1:8000
当然你也是可以指定端口比如801&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
python Simplehttpserver -m 801
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;此时打开浏览器输入：
127.0.0.1:801&lt;/p&gt;
&lt;p&gt;当然如果本机的Ip为121.195.172.217那么，另一台电脑的浏览器只需要输入
121.195.172.217:801即可打开本机的共享目录，非常方便。&lt;/p&gt;
&lt;h2 id=&#34;升级版的simplehttpserver-支持上传&#34;&gt;升级版的Simplehttpserver 支持上传&lt;/h2&gt;
&lt;p&gt;把下面的源代码保存为Simplehttpserverwithupload.py即可，然后运行他&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#!/usr/bin/env python

&amp;quot;&amp;quot;&amp;quot;Simple HTTP Server With Upload.

This module builds on BaseHTTPServer by implementing the standard GET
and HEAD requests in a fairly straightforward manner.

&amp;quot;&amp;quot;&amp;quot;


__version__ = &amp;quot;0.1&amp;quot;
__all__ = [&amp;quot;SimpleHTTPRequestHandler&amp;quot;]
__author__ = &amp;quot;bones7456&amp;quot;
__home_page__ = &amp;quot;http://li2z.cn/&amp;quot;

import os
import posixpath
import BaseHTTPServer
import urllib
import cgi
import shutil
import mimetypes
import re
try:
    from cStringIO import StringIO
except ImportError:
    from StringIO import StringIO


class SimpleHTTPRequestHandler(BaseHTTPServer.BaseHTTPRequestHandler):

    &amp;quot;&amp;quot;&amp;quot;Simple HTTP request handler with GET/HEAD/POST commands.

    This serves files from the current directory and any of its
    subdirectories.  The MIME type for files is determined by
    calling the .guess_type() method. And can reveive file uploaded
    by client.

    The GET/HEAD/POST requests are identical except that the HEAD
    request omits the actual contents of the file.

    &amp;quot;&amp;quot;&amp;quot;

    server_version = &amp;quot;SimpleHTTPWithUpload/&amp;quot; + __version__

    def do_GET(self):
        &amp;quot;&amp;quot;&amp;quot;Serve a GET request.&amp;quot;&amp;quot;&amp;quot;
        f = self.send_head()
        if f:
            self.copyfile(f, self.wfile)
            f.close()

    def do_HEAD(self):
        &amp;quot;&amp;quot;&amp;quot;Serve a HEAD request.&amp;quot;&amp;quot;&amp;quot;
        f = self.send_head()
        if f:
            f.close()

    def do_POST(self):
        &amp;quot;&amp;quot;&amp;quot;Serve a POST request.&amp;quot;&amp;quot;&amp;quot;
        r, info = self.deal_post_data()
        print r, info, &amp;quot;by: &amp;quot;, self.client_address
        f = StringIO()
        f.write(&#39;&amp;lt;!DOCTYPE html PUBLIC &amp;quot;-//W3C//DTD HTML 3.2 Final//EN&amp;quot;&amp;gt;&#39;)
        f.write(&amp;quot;&amp;lt;html&amp;gt;\n&amp;lt;title&amp;gt;Upload Result Page&amp;lt;/title&amp;gt;\n&amp;quot;)
        f.write(&amp;quot;&amp;lt;body&amp;gt;\n&amp;lt;h2&amp;gt;Upload Result Page&amp;lt;/h2&amp;gt;\n&amp;quot;)
        f.write(&amp;quot;&amp;lt;hr&amp;gt;\n&amp;quot;)
        if r:
            f.write(&amp;quot;&amp;lt;strong&amp;gt;Success:&amp;lt;/strong&amp;gt;&amp;quot;)
        else:
            f.write(&amp;quot;&amp;lt;strong&amp;gt;Failed:&amp;lt;/strong&amp;gt;&amp;quot;)
        f.write(info)
        f.write(&amp;quot;&amp;lt;br&amp;gt;&amp;lt;a href=\&amp;quot;%s\&amp;quot;&amp;gt;back&amp;lt;/a&amp;gt;&amp;quot; % self.headers[&#39;referer&#39;])
        f.write(&amp;quot;&amp;lt;hr&amp;gt;&amp;lt;small&amp;gt;Powered By: bones7456, check new version at &amp;quot;)
        f.write(&amp;quot;&amp;lt;a href=\&amp;quot;http://li2z.cn/?s=SimpleHTTPServerWithUpload\&amp;quot;&amp;gt;&amp;quot;)
        f.write(&amp;quot;here&amp;lt;/a&amp;gt;.&amp;lt;/small&amp;gt;&amp;lt;/body&amp;gt;\n&amp;lt;/html&amp;gt;\n&amp;quot;)
        length = f.tell()
        f.seek(0)
        self.send_response(200)
        self.send_header(&amp;quot;Content-type&amp;quot;, &amp;quot;text/html&amp;quot;)
        self.send_header(&amp;quot;Content-Length&amp;quot;, str(length))
        self.end_headers()
        if f:
            self.copyfile(f, self.wfile)
            f.close()
        
    def deal_post_data(self):
        boundary = self.headers.plisttext.split(&amp;quot;=&amp;quot;)[1]
        remainbytes = int(self.headers[&#39;content-length&#39;])
        line = self.rfile.readline()
        remainbytes -= len(line)
        if not boundary in line:
            return (False, &amp;quot;Content NOT begin with boundary&amp;quot;)
        line = self.rfile.readline()
        remainbytes -= len(line)
        fn = re.findall(r&#39;Content-Disposition.*name=&amp;quot;file&amp;quot;; filename=&amp;quot;(.*)&amp;quot;&#39;, line)
        if not fn:
            return (False, &amp;quot;Can&#39;t find out file name...&amp;quot;)
        path = self.translate_path(self.path)
        fn = os.path.join(path, fn[0])
        while os.path.exists(fn):
            fn += &amp;quot;_&amp;quot;
        line = self.rfile.readline()
        remainbytes -= len(line)
        line = self.rfile.readline()
        remainbytes -= len(line)
        try:
            out = open(fn, &#39;wb&#39;)
        except IOError:
            return (False, &amp;quot;Can&#39;t create file to write, do you have permission to write?&amp;quot;)
                
        preline = self.rfile.readline()
        remainbytes -= len(preline)
        while remainbytes &amp;gt; 0:
            line = self.rfile.readline()
            remainbytes -= len(line)
            if boundary in line:
                preline = preline[0:-1]
                if preline.endswith(&#39;\r&#39;):
                    preline = preline[0:-1]
                out.write(preline)
                out.close()
                return (True, &amp;quot;File &#39;%s&#39; upload success!&amp;quot; % fn)
            else:
                out.write(preline)
                preline = line
        return (False, &amp;quot;Unexpect Ends of data.&amp;quot;)

    def send_head(self):
        &amp;quot;&amp;quot;&amp;quot;Common code for GET and HEAD commands.

        This sends the response code and MIME headers.

        Return value is either a file object (which has to be copied
        to the outputfile by the caller unless the command was HEAD,
        and must be closed by the caller under all circumstances), or
        None, in which case the caller has nothing further to do.

        &amp;quot;&amp;quot;&amp;quot;
        path = self.translate_path(self.path)
        f = None
        if os.path.isdir(path):
            if not self.path.endswith(&#39;/&#39;):
                # redirect browser - doing basically what apache does
                self.send_response(301)
                self.send_header(&amp;quot;Location&amp;quot;, self.path + &amp;quot;/&amp;quot;)
                self.end_headers()
                return None
            for index in &amp;quot;index.html&amp;quot;, &amp;quot;index.htm&amp;quot;:
                index = os.path.join(path, index)
                if os.path.exists(index):
                    path = index
                    break
            else:
                return self.list_directory(path)
        ctype = self.guess_type(path)
        try:
            # Always read in binary mode. Opening files in text mode may cause
            # newline translations, making the actual size of the content
            # transmitted *less* than the content-length!
            f = open(path, &#39;rb&#39;)
        except IOError:
            self.send_error(404, &amp;quot;File not found&amp;quot;)
            return None
        self.send_response(200)
        self.send_header(&amp;quot;Content-type&amp;quot;, ctype)
        fs = os.fstat(f.fileno())
        self.send_header(&amp;quot;Content-Length&amp;quot;, str(fs[6]))
        self.send_header(&amp;quot;Last-Modified&amp;quot;, self.date_time_string(fs.st_mtime))
        self.end_headers()
        return f

    def list_directory(self, path):
        &amp;quot;&amp;quot;&amp;quot;Helper to produce a directory listing (absent index.html).

        Return value is either a file object, or None (indicating an
        error).  In either case, the headers are sent, making the
        interface the same as for send_head().

        &amp;quot;&amp;quot;&amp;quot;
        try:
            list = os.listdir(path)
        except os.error:
            self.send_error(404, &amp;quot;No permission to list directory&amp;quot;)
            return None
        list.sort(key=lambda a: a.lower())
        f = StringIO()
        displaypath = cgi.escape(urllib.unquote(self.path))
        f.write(&#39;&amp;lt;!DOCTYPE html PUBLIC &amp;quot;-//W3C//DTD HTML 3.2 Final//EN&amp;quot;&amp;gt;&#39;)
        f.write(&amp;quot;&amp;lt;html&amp;gt;\n&amp;lt;title&amp;gt;Directory listing for %s&amp;lt;/title&amp;gt;\n&amp;quot; % displaypath)
        f.write(&amp;quot;&amp;lt;body&amp;gt;\n&amp;lt;h2&amp;gt;Directory listing for %s&amp;lt;/h2&amp;gt;\n&amp;quot; % displaypath)
        f.write(&amp;quot;&amp;lt;hr&amp;gt;\n&amp;quot;)
        f.write(&amp;quot;&amp;lt;form ENCTYPE=\&amp;quot;multipart/form-data\&amp;quot; method=\&amp;quot;post\&amp;quot;&amp;gt;&amp;quot;)
        f.write(&amp;quot;&amp;lt;input name=\&amp;quot;file\&amp;quot; type=\&amp;quot;file\&amp;quot;/&amp;gt;&amp;quot;)
        f.write(&amp;quot;&amp;lt;input type=\&amp;quot;submit\&amp;quot; value=\&amp;quot;upload\&amp;quot;/&amp;gt;&amp;lt;/form&amp;gt;\n&amp;quot;)
        f.write(&amp;quot;&amp;lt;hr&amp;gt;\n&amp;lt;ul&amp;gt;\n&amp;quot;)
        for name in list:
            fullname = os.path.join(path, name)
            displayname = linkname = name
            # Append / for directories or @ for symbolic links
            if os.path.isdir(fullname):
                displayname = name + &amp;quot;/&amp;quot;
                linkname = name + &amp;quot;/&amp;quot;
            if os.path.islink(fullname):
                displayname = name + &amp;quot;@&amp;quot;
                # Note: a link to a directory displays with @ and links with /
            f.write(&#39;&amp;lt;li&amp;gt;&amp;lt;a href=&amp;quot;%s&amp;quot;&amp;gt;%s&amp;lt;/a&amp;gt;\n&#39;
                    % (urllib.quote(linkname), cgi.escape(displayname)))
        f.write(&amp;quot;&amp;lt;/ul&amp;gt;\n&amp;lt;hr&amp;gt;\n&amp;lt;/body&amp;gt;\n&amp;lt;/html&amp;gt;\n&amp;quot;)
        length = f.tell()
        f.seek(0)
        self.send_response(200)
        self.send_header(&amp;quot;Content-type&amp;quot;, &amp;quot;text/html&amp;quot;)
        self.send_header(&amp;quot;Content-Length&amp;quot;, str(length))
        self.end_headers()
        return f

    def translate_path(self, path):
        &amp;quot;&amp;quot;&amp;quot;Translate a /-separated PATH to the local filename syntax.

        Components that mean special things to the local file system
        (e.g. drive or directory names) are ignored.  (XXX They should
        probably be diagnosed.)

        &amp;quot;&amp;quot;&amp;quot;
        # abandon query parameters
        path = path.split(&#39;?&#39;,1)[0]
        path = path.split(&#39;#&#39;,1)[0]
        path = posixpath.normpath(urllib.unquote(path))
        words = path.split(&#39;/&#39;)
        words = filter(None, words)
        path = os.getcwd()
        for word in words:
            drive, word = os.path.splitdrive(word)
            head, word = os.path.split(word)
            if word in (os.curdir, os.pardir): continue
            path = os.path.join(path, word)
        return path

    def copyfile(self, source, outputfile):
        &amp;quot;&amp;quot;&amp;quot;Copy all data between two file objects.

        The SOURCE argument is a file object open for reading
        (or anything with a read() method) and the DESTINATION
        argument is a file object open for writing (or
        anything with a write() method).

        The only reason for overriding this would be to change
        the block size or perhaps to replace newlines by CRLF
        -- note however that this the default server uses this
        to copy binary data as well.

        &amp;quot;&amp;quot;&amp;quot;
        shutil.copyfileobj(source, outputfile)

    def guess_type(self, path):
        &amp;quot;&amp;quot;&amp;quot;Guess the type of a file.

        Argument is a PATH (a filename).

        Return value is a string of the form type/subtype,
        usable for a MIME Content-type header.

        The default implementation looks the file&#39;s extension
        up in the table self.extensions_map, using application/octet-stream
        as a default; however it would be permissible (if
        slow) to look inside the data to make a better guess.

        &amp;quot;&amp;quot;&amp;quot;

        base, ext = posixpath.splitext(path)
        if ext in self.extensions_map:
            return self.extensions_map[ext]
        ext = ext.lower()
        if ext in self.extensions_map:
            return self.extensions_map[ext]
        else:
            return self.extensions_map[&#39;&#39;]

    if not mimetypes.inited:
        mimetypes.init() # try to read system mime.types
    extensions_map = mimetypes.types_map.copy()
    extensions_map.update({
        &#39;&#39;: &#39;application/octet-stream&#39;, # Default
        &#39;.py&#39;: &#39;text/plain&#39;,
        &#39;.c&#39;: &#39;text/plain&#39;,
        &#39;.h&#39;: &#39;text/plain&#39;,
        })


def test(HandlerClass = SimpleHTTPRequestHandler,
         ServerClass = BaseHTTPServer.HTTPServer):
    BaseHTTPServer.test(HandlerClass, ServerClass)

if __name__ == &#39;__main__&#39;:
    test()
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>阅读openfoam源代码的小工具</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/10/yue-du-openfoamyuan-dai-ma-de-xiao-gong-ju/</link>
      <pubDate>Wed, 10 Jun 2015 23:19:42 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/10/yue-du-openfoamyuan-dai-ma-de-xiao-gong-ju/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;当你阅读源代码你是否厌倦了cd来cd去，于是想把他们堆在一个文件内&lt;/li&gt;
&lt;li&gt;而堆起来又不好看，于是想要打扮一下&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;于是写了下面的小程序，估计对于阅读有帮助，主要用到&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;shell变量处理&lt;/li&gt;
&lt;li&gt;shell变量长度&lt;/li&gt;
&lt;li&gt;find显示相对全路经&lt;/li&gt;
&lt;li&gt;==两边__不能有__空格，然而在赋值的时候必须没有空格&lt;/li&gt;
&lt;li&gt;利用函数思想，封装小寒数&lt;/li&gt;
&lt;li&gt;美观，把一个文件当作一个夹子进行显示&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;注意针对每一个版本都需要进行适当的修改&lt;/strong&gt;.在getFile中有一个sed命令一定要注意，那是删除行首的7行，针对不同文件，需要适当修改.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#!/bin/bash - 
#===============================================================================
#
#          FILE: browser.sh
# 
#         USAGE: ./browser.sh 
# 
#   DESCRIPTION:  注意针对每一个版本都需要进行适当的修改
# 
#       OPTIONS: ---
#  REQUIREMENTS: ---
#          BUGS: ---
#         NOTES: ---
#        AUTHOR: Ye Zhaoliang (), zhaoturkkey@163.com
#  ORGANIZATION: YZL
#       CREATED: 2015年06月10日 21:50
#      REVISION:  ---
#===============================================================================
#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  generateChapter
#   DESCRIPTION:  针对不同额文件采用不同的处理方法，判断目录 和判断脚本是一个重要的操作
#                 但是更为重要的是 find获得文集拿的绝对路径(相对于当前文件)
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------

generateChapter()
{
    # 妙用find 得到当前目录的相对路径 不需要不断的进入目录
    for var in `find . -name &amp;quot;*&amp;quot;`
    do
        if [[ -d  $var ]] # &amp;lt; cannot . Error
        then
            echo &amp;quot;${currentDir}${var#.}是一个目录&amp;quot; # 使用#号来删除之前的点号
        elif [[ &amp;quot;${var##*/}&amp;quot; == &amp;quot;${0}&amp;quot; ]] # 一定要注意等式两边有空格
        then
            echo &amp;quot;${currentDir}${var#.} ${0} 脚本文件不处理&amp;quot;
        else
            getFile ${currentDir}${var#.}
        fi

    done
}


#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  getFile
#   DESCRIPTION:  在每个文件的头部添加一些信息
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
getFile()
{
    startString=&amp;quot;# -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------#&amp;quot;
    endString=&amp;quot;# --------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; ended &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------#&amp;quot;
       #echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo -e &amp;quot;\033[44;37m -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------\033[0m&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo  &amp;quot;# -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo $startString &amp;gt;&amp;gt; summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#startString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#startString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#startString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh ### 不加上$反而不行
   # echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
   # echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
    sed &#39;1,7d&#39; $1 &amp;gt;&amp;gt; summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#endString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#endString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;#`printf &amp;quot;%$(( ${#endString}-2 ))s&amp;quot; &amp;quot; &amp;quot;`#&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo &amp;quot;#&amp;quot; &amp;gt;&amp;gt;summary.sh
    #echo -e &amp;quot;\033[43;37m --------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; ended &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------\033[0m&amp;quot; &amp;gt;&amp;gt; summary.sh
    #echo &amp;quot;# --------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;quot;$1&amp;quot; ended &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------&amp;quot; &amp;gt;&amp;gt; summary.sh
    echo $endString &amp;gt;&amp;gt; summary.sh
    echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    echo &amp;quot;&amp;quot; &amp;gt;&amp;gt;summary.sh
    
}

currentDir=`pwd`

# 如果存在 summary.sh 证明已经存在了，就先把删掉， 因为这里是
# 采用追加的方式，而不是写入。
if [[ -e ./summary.sh ]]
then 
    rm -rf ./summary.sh
fi
# 调用产生所有的文件夹内的数据到一个文件中

generateChapter

#sed -i &#39;/C++/d&#39; summary |sed &#39;/=========/d&#39;|sed &#39;/OpenFOAM/d&#39; | sed &#39;/Version/d&#39; | sed &#39;/Web/d&#39;|sed &#39;/anipulation/d&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;结果显示&#34;&gt;结果显示&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;# -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;/openfoamF708/tutorials/incompressible/icoFoam/cavity/system/fvSolution started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------#
#                                                                                                                                        #
#                                                                                                                                        #
#                                                                                                                                        #
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    &amp;quot;system&amp;quot;;
    object      fvSolution;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

solvers
{
    p
    {
        solver          PCG;
        preconditioner  DIC;
        tolerance       1e-06;
        relTol          0;
    }

    U
    {
        solver          smoothSolver;
        smoother        symGaussSeidel;
        tolerance       1e-05;
        relTol          0;
    }
}

PISO
{
    nCorrectors     2;
    nNonOrthogonalCorrectors 0;
    pRefCell        0;
    pRefValue       0;
}


#                                                                                                                                        #
#                                                                                                                                        #
#                                                                                                                                        #
# --------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;/openfoamF708/tutorials/incompressible/icoFoam/cavity/system/fvSolution ended &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------#



# -------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;/openfoamF708/tutorials/incompressible/icoFoam/cavity/system/fvSchemes started&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;-------------------#
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>ubuntu系统运用</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/10/ubuntuxi-tong-yun-yong/</link>
      <pubDate>Wed, 10 Jun 2015 13:50:55 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/10/ubuntuxi-tong-yun-yong/</guid>
      <description>&lt;p&gt;ubuntu系统，比如你用&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;tar -cvf \*.tar.gz 某个文件夹
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;会发现可以多窗口地执行。其实这也说明了一点linux系统的多用户、多线程地开发系统、使用系统。&lt;/p&gt;
&lt;p&gt;shell-script是一个比较有用的工具，沟通着用户(user)和内核(kernel)之间,我的理解是shell就是一个解释器(从lisp的解释器的角度来说,相互学习从函数式过渡到命令式)&lt;/p&gt;
&lt;p&gt;所以我会尝试着把我所有需要安装的software(app),都囊括在一个sh文件当中，所以我重装的时候只需要一个批处理即可。&lt;/p&gt;
&lt;p&gt;下面我分成以下5个部分&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1系统的Git管理&lt;/li&gt;
&lt;li&gt;2图形部分&lt;/li&gt;
&lt;li&gt;3语言部分&lt;/li&gt;
&lt;li&gt;4编辑部分&lt;/li&gt;
&lt;li&gt;5配置部分&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一一写上我会执行的操作，当然这些程序组合成为我自己使用的linux系统。方便我和linux的内核进行交流。&lt;/p&gt;
&lt;h2 id=&#34;1系统的git管理&#34;&gt;1系统的Git管理&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;apt-get install git,gitk,git-doc #rememeber how to configure
apt-get install git-flow #升级版的管理

git config --global user.name &amp;quot;ye zhaoliang&amp;quot;
git config --global user.email &amp;quot;zhaoturkkey@163.com&amp;quot;
ssh-keygen -t rsa -C &amp;quot;zhaoturkkey@163.com&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2图形部分&#34;&gt;2图形部分&lt;/h2&gt;
&lt;p&gt;有时候你希望把你的相关数据打印成图片，这样方便交流&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;apt-get install gnuplot
apt-get install graphviz
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3语言部分&#34;&gt;3语言部分&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;apt-get install gfortran 
apt-get install gcc 
apt-get install python
# drracket
# haskell
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4编辑部分&#34;&gt;4编辑部分&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;apt-get install vim   #rememeber how to configure
apt-get install vim-gtk

apt-get install emacs
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5配置部分&#34;&gt;5配置部分&lt;/h2&gt;
&lt;p&gt;在ubuntu管理系统经常会需要配置用户目录下的dotfiles，
比如登录相关文件.bashrc,.bash_logout,.bash_profile.
我会尝试着把我相关需要的文件夹备份在一个tar包。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;tar -xvf ./bash-it.tar.gz -C ~ # remember vcprompt
tar -xvf ./vim.tar.gz -C ~ # remember vim :BundleInstall
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#结论
通过上面五个部分，无法体现我使用linux的基本感觉&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;recur()
{
 查找(进入某个目录)
 判断(If,case)
 修改（配置 export 设置环境变量）
 recur
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;cfaj写的&lt;a href=&#34;shell-script:&#34;&gt;shell-script:&lt;/a&gt;和&lt;pro-bash-programming&gt;
主要教会我们的是我使用下划线新建一个临时函数，并使用下划线函数的大写字母来表征函数的返回值。然后使用${}变量引用来实现
版本号的截取并使用case进行分类选择，还有比如不同的系统的case选择。&lt;/p&gt;
&lt;h3 id=&#34;补充一个操作&#34;&gt;补充一个操作&lt;/h3&gt;
&lt;p&gt;如果你想要使得子程序可以掉哦你个函数，必须使用export命令导出，类似于变量&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
function func()
{
    echo &amp;quot;导出函数&amp;quot;
    }

export -f func
# 使用export -f 导出函数，只用于bash
# 使用export  DATE  等，导出系统变量

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;只有经过这样你的func才变成公有化。当然你也可以把脚本添加到path路径中。&lt;/p&gt;
&lt;h3 id=&#34;谨记一个失误&#34;&gt;谨记一个失误&lt;/h3&gt;
&lt;p&gt;无论是使用tar -cvf 打包，还是生成某个程序等，一定要检查一遍，是否能够运行，
当时就确认你的操作无误，否则后来会后悔(曾经打包了一个系统 发现都不能用了！
而那个系统也被我删掉了，可见我有多懊恼)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;tar: 跳转到下一个头
tar: 由于前次错误，将以上次的错误状态退出

当然有人说看看是不是需要使用tar -zxvf 而不是tar -xvf
我说我压缩的时候根本就没有用gzip，当然我也试了没效果，后来都删掉了。
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>搭建gitlab服务器及使用</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/09/da-jian-gitlabfu-wu-qi-ji-shi-yong/</link>
      <pubDate>Tue, 09 Jun 2015 19:22:07 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/09/da-jian-gitlabfu-wu-qi-ji-shi-yong/</guid>
      <description>&lt;p&gt;现在有很多的公开的代码服务器
比如最为出名的是&lt;a href=&#34;http://github.com&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github&lt;/a&gt;
Haskell开发的&lt;a href=&#34;http://darcs.net/Binaries&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Darcs&lt;/a&gt;
国内比较出名的是&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://git.oschina.net&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;开源中国&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://code.jd.com&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;京东&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;然而，很多时候我们并不想把所有的东西都公开，于是想有一个私有的云平台，这样
我们就可以让很多内部的人员(局域网)使用了，gitlab正是为一堆比较懒的人设计的基于git的平台搭建。&lt;/p&gt;
&lt;h2 id=&#34;参考链接&#34;&gt;参考链接&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.csdn.net/yanjiangbo/article/details/39154573&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CentOS下一键安装GitLab&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.2cto.com/os/201411/353292.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gitlab一键安装笔记&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://segmentfault.com/a/1190000002439923&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;使用Gitlab一键安装包后的日常备份恢复与迁移&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.2cto.com/os/201408/323795.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;一键安装 gitlab7 on rhel6.4 并设置邮件发送&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;开始安装&#34;&gt;开始安装&lt;/h3&gt;
&lt;p&gt;官网下载(我现在下载的版本是7.11.4.0  之前用的是7.1.1.0)
&lt;a href=&#34;https://bitnami.com/stack/gitlab/installer&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://bitnami.com/stack/gitlab/installer&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gitlab(更新版本的采用的是图形界面，之前的版本采用的是命令流,全面的图形化更方便些。现在是连启动都是图形界面了,比如gitlabci 也直接不需要用./ctlscript.sh start)
EmaikAddress : -977962857@qq.com
Login :xinran
passowrd:+++++++

配置gmail（省的自己配置)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用的过程既可以是在网页中直接使用，也可以直接使用类似github的命令流操作，
但是前提是必须配置好服务器，类似于&lt;a href=&#34;https://help.github.com/articles/set-up-git/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github的配置过程&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;安装完毕进行ssh配置的注意点&#34;&gt;安装完毕，进行ssh配置的注意点&lt;/h2&gt;
&lt;h3 id=&#34;问题是rakegemesrb里的一个block-有问题提醒rake-is-not-the-part-of-the-gem&#34;&gt;问题是rakegemes.rb里的一个block 有问题，提醒rake is not the part of the gem&lt;/h3&gt;
&lt;p&gt;我分享一下解决方法，我的登录用户假如是fluid,那么我们现在使用&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;ssh-keygen -t rsa -C &amp;quot;你的登录邮箱gitlab账户&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后你就可以复制在/home/fluid/.ssh/id_rsa.pub，粘帖到你的gitlab的网页管理中添加ssh keys ,
以前我犯的错误是以为提取gitlab在安装的时候新建的git 用户的authority_keys,现在看来还真是跟github的配置有点像，这样之后还有一个小问题，
你得是在登录用户fluid才是可以git push等基本操作，而在root用户则是有权限限制，但是紧接着我在root用户下再次ssh-keygen…
这样在/root/.ssh/id_rsa.pub又有一个新的key，你只要也把他添加到gitlab管理界面的profile setting里的ssh keys 添加一下就可以了.
所以变成和github一样可以用root用户，其实罗嗦那么久还是ssh-keygen问题，还有记得对应用户的key问题&lt;/p&gt;
&lt;h2 id=&#34;开始使用&#34;&gt;开始使用&lt;/h2&gt;
&lt;h3 id=&#34;我在网页上创建了一个项目&#34;&gt;我在网页上创建了一个项目&lt;/h3&gt;
&lt;p&gt;得到了如下信息:&lt;/p&gt;
&lt;p&gt;Global Setting&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;git config --global user.name &amp;quot;Administrator&amp;quot;
git config --global user.email &amp;quot;977962857@qq.com&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create a new repository&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;git clone git@127.0.1.1:xinran/f708OpenFoam.git cd f708OpenFoam
touch README.md
git add README.md
git commit -m &amp;quot;add README&amp;quot;
git push -u origin master
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Existing folder or Git repository&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cd existing_folder
git init
git remote add origin git@127.0.1.1:xinran/f708OpenFoam.git git push -u origin master
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后我cd /root/.ssh/
因为我之前已经设置好了git配置，不懂的人可以参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/05/29/githe-githubpei-zhi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;git和github的配置&lt;/a&gt;
然后拷贝id.pub的内容&lt;/p&gt;
&lt;h3 id=&#34;测试是否走通了&#34;&gt;测试是否走通了&lt;/h3&gt;
&lt;p&gt;我们很想知道到底我们已经配置好了服务器?也很想知道局域网内的客户端是否可以访问服务器？&lt;/p&gt;
&lt;p&gt;测试方法：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;root at fluidman-OptiPlex-990 in /opt/gitlab-7.1.1-0[21:17:36下午] 
$ ssh -T git@127.0.1.1
Welcome to GitLab, Anonymous!
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;局域网人员测试:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;比如我的127.195.172.64别人只要在浏览器输入 127.195.172.64:80然后就可以了！！
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;reate-repository创建仓库&#34;&gt;reate Repository（创建仓库）&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;mkdir common-util
cd common-util
git init
touch README
git add README
git commit -m &#39;first commit&#39;
git remote add origin git@127.0.0.1:devteam/common-util.git
git push -u origin master
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;对于已存在git项目&#34;&gt;对于已存在Git项目：&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cd existing_git_repo 
git remote add origin git@127.0.0.1:devteam/common-util.git 
git push -u origin master

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;开发完之后，你进行&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;测试&lt;/li&gt;
&lt;li&gt;检查&lt;/li&gt;
&lt;li&gt;再测试等过程&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;还需要进行提交.&lt;/p&gt;
&lt;h2 id=&#34;多用户问题&#34;&gt;多用户问题&lt;/h2&gt;
&lt;h3 id=&#34;注意验证用户&#34;&gt;注意验证用户&lt;/h3&gt;
&lt;p&gt;会被弄到垃圾邮件当中，
并且验证链接需要注意的是一定得改一下IP，
比如：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;http://127.0.1.1/users/confirmation?confirmation_token=AEHLjx2WR21sb3zULW5h
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;我的内网IP是(ubuntu :ifconfig    windows: cmd&amp;ndash;&amp;gt; ipconfig 进行查看)
121.195.172.217
那么就变为&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;http://121.195.172.217/users/confirmation?confirmation_token=AEHLjx2WR21sb3zULW5h
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;这步的一个完美解决方案是在装gitlab的时候domain不要填127.0.1.1而应该填你的固有IP（动态获取的IP的话，最好保持不断网，基本上也能够维持IP不变）这样以后就不许要修改了&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;我的目录分门别类目的是一个项目一个文件夹&#34;&gt;我的目录分门别类(目的是一个项目一个文件夹)&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;/
├── dns-of-incompact3d
├── dns-of-semtex
├── fortran-learning-and-some-tools
├── lisper
├── nreal-fast

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;我的一次使用提交&#34;&gt;我的一次使用提交&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;root at fluidman-OptiPlex-990 in /latex-chines-english[10:05:08上午]  on git:develop running make, make, make, and make
$ git push -u origin develop
Counting objects: 208, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (205/205), done.
Writing objects: 100% (208/208), 23.27 MiB | 7.67 MiB/s, done.
Total 208 (delta 40), reused 0 (delta 0)
To git@127.0.1.1:xinran/latex-chines-english.git
 * [new branch]      develop -&amp;gt; develop
分支 develop 设置为跟踪来自 origin 的远程分支 develop。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;很多事情关键在于__坚持__,代码服务器现在有了，关键是几个人协力合作的问题,比如一起往openfoam的风电(疯癫)方向发展。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>bash提醒框的制作</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/04/bashti-xing-kuang-de-zhi-zuo/</link>
      <pubDate>Thu, 04 Jun 2015 21:13:33 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/04/bashti-xing-kuang-de-zhi-zuo/</guid>
      <description>&lt;p&gt;一个elegant的提示窗口的制作。从_repeat到升级的优化版本（采用三步优化），然后到后来组装成alert函数。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;_repeat()
{
    #@ 使用方式： _repeat 要重复的字符串  重复次数
    #@  Usage : _repeat string number
    _REPEAT=  #set but empty
    echo $2
    while [[ ${#_REPEAT} -lt $2 ]]
    do
        _REPEAT=$_REPEAT$1
    done
}

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;_repeat &amp;quot;hello&amp;quot; 30
echo $_REPEAT
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  _repeat1
#   DESCRIPTION:  优化版本
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
_repeat1()
{
    #@ 使用方式： _repeat 要重复的字符串  重复次数
    #@  Usage : _repeat string number
    _REPEAT1=$1  #set and not empty, or unlimit recycle
    while [[ ${#_REPEAT1} -lt $2 ]]
    do
        _REPEAT1=$_REPEAT1$_REPEAT1$_REPEAT1 ## 3次优化
    done
    _REPEAT1=${_REPEAT1:0:$2} ##Trim到我们需要的长度
}

repeat()
{
    _repeat &amp;quot;$@&amp;quot;
    printf &amp;quot;%s\n&amp;quot; &amp;quot;$_REPEAT1&amp;quot;
}

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;_repeat1 &amp;quot;hello&amp;quot; 30
echo $_REPEAT1
repeat &amp;quot;hello 30&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;alert()
{
    _repeat1 &amp;quot;${2:-#}&amp;quot; $(( ${#1} + 8 )) ## ${2:-#} 如果$2未定义则使用#
    printf &#39;\a%s\n&#39; &amp;quot;$_REPEAT1&amp;quot; ## \a=BEL
    printf &#39;%2.2s %s %2.2s\n&#39; &amp;quot;$_REPEAT1&amp;quot; &amp;quot;$1&amp;quot; &amp;quot;$_REPEAT1&amp;quot; ## \a=BEL
    printf &#39;%s\n&#39; &amp;quot;$_REPEAT1&amp;quot;
}


alert &amp;quot;Do you really want to delete all the files?&amp;quot;

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>bash命令分类--架构在文件系统级别</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/03/bashming-ling-fen-lei-jia-gou-zai-wen-jian-xi-tong-ji-bie/</link>
      <pubDate>Wed, 03 Jun 2015 20:18:18 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/03/bashming-ling-fen-lei-jia-gou-zai-wen-jian-xi-tong-ji-bie/</guid>
      <description>&lt;p&gt;I have many years experience in the shell command, so I categoried some commands into
many categories,which let me understand the commands more clearly.
You can first practice &lt;a href=&#34;http://blog.chinaunix.net/uid-25932176-id-2973818.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;how to play with bash shell&lt;/a&gt;,then you can catch the topic afterward
&lt;a href=&#34;http://cfajohnson.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cfaj network&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;bit&#34;&gt;bit&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;programming language :
&lt;ul&gt;
&lt;li&gt;c ,c++ c#,java&lt;/li&gt;
&lt;li&gt;lisp,scheme,haskell etc&lt;/li&gt;
&lt;li&gt;bash,python,perl,ruby,etc&lt;/li&gt;
&lt;li&gt;javascript&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;word&#34;&gt;word&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;programming language :
&lt;ul&gt;
&lt;li&gt;c ,c++ c#,java&lt;/li&gt;
&lt;li&gt;lisp,scheme,haskell etc&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.vaikan.com/bash-scripting&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bash&lt;/a&gt;,python,perl,ruby,etc
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$() == () == `` means in the &lt;strong&gt;subshell&lt;/strong&gt; closure the commands; $((  )) == ((  )): mainly some algorithm operations&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;${} == {} means in the &lt;strong&gt;current shell&lt;/strong&gt; closure the commands;  ${{  }} == {{  }}&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;${#f}  calculate the variable f&amp;rsquo;s length&lt;/li&gt;
&lt;li&gt;${f:6}  get the string from 6 to end of the string&lt;/li&gt;
&lt;li&gt;${f:6:4} get the string from 6 to (6+4) of the string. ${f:${pos}:${len}}&lt;/li&gt;
&lt;li&gt;${f: -8} get the reverse from end to end+8&amp;rsquo;s string.&lt;/li&gt;
&lt;li&gt;${f/path?/x}  &amp;ndash;single replace&lt;/li&gt;
&lt;li&gt;${f//path?/x} &amp;ndash;globle replace&lt;/li&gt;
&lt;li&gt;${f#*/}  delete the characters until get across a  / from left to right(&lt;strong&gt;From means start point. To means end point&lt;/strong&gt;)
&lt;ul&gt;
&lt;li&gt;${var#*o}  remove the shortest string that matches PATTERN (the character &amp;lsquo;o&amp;rsquo;) from the begining of the expanded value&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;${f##*/} delete the caaracters until all the / symbols have been got across from left to right.
&lt;ul&gt;
&lt;li&gt;${0##*/} extract the name of a script from the $0 parameter,which contains the full path to the script&lt;/li&gt;
&lt;li&gt;similarly, you can use &amp;ldquo;${1%/&lt;em&gt;}&amp;rdquo;,&amp;quot;${2%/&lt;/em&gt;}&amp;quot;  &amp;hellip;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;${f%*/}  delete the characters until get across a  /  from right to left&lt;/li&gt;
&lt;li&gt;${f%%*/} delete the caaracters until all the / symbols have been got across from right to left.&lt;/li&gt;
&lt;li&gt;variable (&lt;strong&gt;- is used to set the unset value; + is used to set the set value&lt;/strong&gt;)
&lt;ul&gt;
&lt;li&gt;${var:-default} checks to see whether a variable is &lt;strong&gt;unset or empty&lt;/strong&gt;,if yes,then expands to a default string to var(if omit the colon? see below)&lt;code&gt;unset var or var=&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;${var:=default} 和${var:-default}很像，只不过他还多做了一个额外的功能，&lt;strong&gt;assign the default value to the variable&lt;/strong&gt;.而在${var:-|+default}的情况下，并没有指派给变量值。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;${var-default} checks to see whether a variable is &lt;strong&gt;unset&lt;/strong&gt;,if yes,then expands to a default string to var, &lt;code&gt;unset var&lt;/code&gt;,almost the same with colon&lt;/li&gt;
&lt;li&gt;${var:+alternative} use alternative value if $var &lt;strong&gt;is set and  not empty&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;${var+alternative} use alternative value if $var &lt;strong&gt;is set&lt;/strong&gt;,it does matter whether $var is  empty or not&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;${var^[a-m]}&lt;/li&gt;
&lt;li&gt;${var^^[a-m]} ## matches all characters from a to m inclusive! if match change to uppercase.NOTE:&lt;strong&gt;Only in Bash &amp;gt;=4.0&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;${var^^}  uppercase the string,such as toronto change to TORONTO&lt;/li&gt;
&lt;li&gt;${var^} Captitalize the string, such as toronto change to Toronto&lt;/li&gt;
&lt;li&gt;${var,,}  such as var=TORONTO change to toronto&lt;/li&gt;
&lt;li&gt;${var,,[N-Q]} such as var=TORONTO changes to ToRonTo&lt;/li&gt;
&lt;li&gt;ARRAY(use ${} to get the value of the array) Note: &lt;strong&gt;not POSIX standard ,but fit for bash shell&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${BASH_VERSINFO[0]}&amp;rdquo;    print the first element of the array BASH_VERSINFO bulit in the shell bash&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${BASH_VERSINFO[1]}&amp;rdquo;    print the second element of the array BASH_VERSINFO bulit in the shell bash&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${BASH_VERSINFO[*]}&amp;rdquo;    print the all element of the array BASH_VERSINFO bulit in the shell bash in one line as string&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${BASH_VERSINFO[@]}&amp;rdquo;    print the all element of the array BASH_VERSINFO bulit in the shell bash in different line&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${BASH_VERSINFO[@]:1:2}&amp;rdquo;    print the secondth and thirdth line element of the array BASH_VERSINFO bulit in the shell bash&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${#BASH_VERSINFO[*]}&amp;rdquo;    print the length of the array BASH_VERSINFO bulit in the shell bash&lt;/li&gt;
&lt;li&gt;construct an array 1
&lt;ul&gt;
&lt;li&gt;unset a&lt;/li&gt;
&lt;li&gt;a[${#a[@]}]=&amp;ldquo;1 $RANDOM&amp;rdquo; ## #{#a[@]} is 0&lt;/li&gt;
&lt;li&gt;a[${#a[@]}]=&amp;ldquo;2 $RANDOM&amp;rdquo; ## #{#a[@]} is 1&lt;/li&gt;
&lt;li&gt;a[${#a[@]}]=&amp;ldquo;3 $RANDOM&amp;rdquo; ## #{#a[@]} is 2&lt;/li&gt;
&lt;li&gt;a[${#a[@]}]=&amp;ldquo;4 $RANDOM&amp;rdquo; ## #{#a[@]} is 3  &amp;mdash;&amp;gt; finally we have a fourth element array a&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${a[@]}&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;construct an array 2
&lt;ul&gt;
&lt;li&gt;province=(Beijing Fujian Liaoning)&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;%s\n&amp;rdquo; &amp;ldquo;${province[@]}&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;construct an array (Associative Arrays must be declared before)
&lt;ul&gt;
&lt;li&gt;declare -A array1  ## &lt;strong&gt;if not declare -A array1 only keep the last one assignment operation&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;for subsricpt in a b c d e&lt;/li&gt;
&lt;li&gt;do&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;array[$subscript]=&amp;quot;$subscript $RANDOM&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;done&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;:%s:\n&amp;rdquo; &amp;ldquo;${array[&amp;ldquo;c&amp;rdquo;]}&amp;rdquo; ## print one value&lt;/li&gt;
&lt;li&gt;printf &amp;ldquo;:%s:\n&amp;rdquo; &amp;ldquo;${array[@]}&amp;rdquo; ## print one value&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$[[  ]] == [[  ]] &amp;ndash;&amp;gt; [[ =~ ]] (you can use variable match the regex expressions inside the  [[]])&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;some special remarks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;*(pattern [|pattern] &amp;hellip;)  the match occurence &amp;gt;=0&lt;/li&gt;
&lt;li&gt;+(pattern [|pattern] &amp;hellip;)  the match occurence &amp;gt;=1&lt;/li&gt;
&lt;li&gt;@(pattern [|pattern] &amp;hellip;)  the match occurence ==1&lt;/li&gt;
&lt;li&gt;?(pattern [|pattern] &amp;hellip;)  the match occurence ? I am a little confuse!&lt;/li&gt;
&lt;li&gt;&amp;amp;   let the command execute backward&lt;/li&gt;
&lt;li&gt;``  redirect an command output to the argument of another command&lt;/li&gt;
&lt;li&gt;; command separator&lt;/li&gt;
&lt;li&gt;| pipe symbol, put a command output redirect to another command&amp;rsquo;s input&lt;/li&gt;
&lt;li&gt;$# the numbers of the parameters while execute the shell scripts&lt;/li&gt;
&lt;li&gt;$@ the parameters  while execute the shell scripts(know every parameters) .Note use &amp;ldquo;$@&amp;rdquo;&lt;/li&gt;
&lt;li&gt;$* the parameters as a string while execute the shell scripts&lt;/li&gt;
&lt;li&gt;$! the PID number
&lt;ul&gt;
&lt;li&gt;${!var} 表示的是间接调用变量var,比如x=yes,var=x,如果直接使用echo $x得到yes,如果直接echo $var 得到的是x，如果使用echo ${!var}则是yes&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;${!}给你的感觉会好象是函数式变量，不断的变化中,类似的比如set &amp;ndash;具有更换positional parameters的作用&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;case中*[!0-9]*) 表示 非数字 ，在正则表达式中一般是使用[^0-9]&lt;/li&gt;
&lt;li&gt;&amp;quot;&amp;quot; 字符串中加上双引号的作用是&amp;quot;$a&amp;quot; ，[ &amp;ldquo;$a&amp;rdquo; == &amp;ldquo;abc str&amp;rdquo;] 避免太多参数的报错！&amp;ldquo;&amp;ldquo;起着连接的作用,变量的值包起来，防止中间有空格，一般字符串反而不需要.这边又扯到&lt;a href=&#34;http://blog.jobbole.com/46191&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;另一个问题&lt;/a&gt;，比如[[ $foo == bar ]]不会展开foo的值,也就是把空格也当作字符串字面值的整体，而[ $foo == bar ] 则会展开foo的值,也就空格会分隔原来的foo字符串，这样可能会出现多参数错误。所以加上双引号有好处，暂时无坏(针对变量)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;javascript&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tr
&lt;ul&gt;
&lt;li&gt;tr -d &amp;lsquo;abc&amp;rsquo;&lt;/li&gt;
&lt;li&gt;tr &amp;lsquo;[a-z]&amp;rsquo; &amp;lsquo;[A-Z]&amp;rsquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;seq&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;类似的可以参考&lt;a href=&#34;http://blog.useasp.net/archive/2014/06/02/summary-of-the-special-characters-in-shell-on-linux.aspx&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;shell符号&lt;/a&gt;,并且注意shell当中一个
比较大的书写问题是：等号两边不能有空格，括号和中括号两边最好有空格(比如最多的if判断）。&lt;/p&gt;
&lt;h2 id=&#34;line&#34;&gt;line&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;head&lt;/li&gt;
&lt;li&gt;tail&lt;/li&gt;
&lt;li&gt;sed&lt;/li&gt;
&lt;li&gt;grep(egrep)
&lt;ul&gt;
&lt;li&gt;grep -nR &amp;ldquo;neededWord&amp;rdquo; *&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;awk(actually it can be categoried into word manipulation)&lt;/li&gt;
&lt;li&gt;sort
&lt;ul&gt;
&lt;li&gt;sort -r -t :  -k 2&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;cut -d&amp;rdquo;:&amp;rdquo;  -f5&lt;/li&gt;
&lt;li&gt;read&lt;/li&gt;
&lt;li&gt;echo&lt;/li&gt;
&lt;li&gt;uniq&lt;/li&gt;
&lt;li&gt;join&lt;/li&gt;
&lt;li&gt;paste  (much simpler than join , just separte two parts with Tab)&lt;/li&gt;
&lt;li&gt;shift
&lt;ul&gt;
&lt;li&gt;shift 3    To remove the first three parameters(&lt;strong&gt;To means going to do,it is a target&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;shift &amp;ldquo;$#&amp;rdquo;  To remove all the parameters,$# contains the number of all the positional parameters&lt;/li&gt;
&lt;li&gt;shift $(( $# - 2 ))   Remove all but the last two positional parameters.Remember there are blank between (( and $  also between 2 and  )).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;set &amp;ndash;  Newparameters ## which is just replace the parameters with Newparameters
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;[ $# -ne 3 ] &amp;amp;&amp;amp; return 5
[ $1 -gt $2 ] &amp;amp;&amp;amp; { set -- $2 $1 $3; } ## line a   if $1&amp;gt;$2    replace $2 with $1  ,$1 with $2, the bigger in the righter
[ $2 -gt $3 ] &amp;amp;&amp;amp; { set -- $1 $3 $2; } ## line b:  $1 is the last time&#39;s $1 ,but $3 is the last time&#39;s $3(in line a)
[ $1 -gt $2 ] &amp;amp;&amp;amp; { set -- $2 $1 $3; } ## line c
_MAX3=$3
_MID3=$2
_MIN3=$1
} ```


&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;content&#34;&gt;content&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;cat&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;file&#34;&gt;file&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ls&lt;/li&gt;
&lt;li&gt;find -name &amp;quot;&amp;quot; src/&lt;/li&gt;
&lt;li&gt;locate&lt;/li&gt;
&lt;li&gt;touch&lt;/li&gt;
&lt;li&gt;wc -l&lt;/li&gt;
&lt;li&gt;rm -f&lt;/li&gt;
&lt;li&gt;cp&lt;/li&gt;
&lt;li&gt;mv&lt;/li&gt;
&lt;li&gt;source == .  ==&amp;gt; sourch *.sh  == . *.sh     source .bashrc == . bashrc&lt;/li&gt;
&lt;li&gt;&amp;gt;  == 1&amp;gt;&lt;/li&gt;
&lt;li&gt;&amp;gt;&amp;gt; == 1&amp;raquo;&lt;/li&gt;
&lt;li&gt;&amp;lt;  == &amp;lt;1&lt;/li&gt;
&lt;li&gt;split
&lt;ul&gt;
&lt;li&gt;split -b 300k &amp;hellip;&lt;/li&gt;
&lt;li&gt;split -l 300   (line=300 as an file)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;vim&lt;/li&gt;
&lt;li&gt;gnuplot&lt;/li&gt;
&lt;li&gt;graghviz&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;fildfolder&#34;&gt;fildfolder&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;cd&lt;/li&gt;
&lt;li&gt;mkdir&lt;/li&gt;
&lt;li&gt;rmdir&lt;/li&gt;
&lt;li&gt;cp -r&lt;/li&gt;
&lt;li&gt;mv&lt;/li&gt;
&lt;li&gt;tar
&lt;ul&gt;
&lt;li&gt;tar -cvf  src.tar.gz src/&lt;/li&gt;
&lt;li&gt;tar -xvf  src.tar.gz&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;system&#34;&gt;system&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;alias (make the command become convinient)&lt;/li&gt;
&lt;li&gt;unalias&lt;/li&gt;
&lt;li&gt;ulimit -a (try to think if there are ten person enter the Linux at the same time, and open th 1G file at the same time, the main machine means 10G. So the machine wil become busy.)&lt;/li&gt;
&lt;li&gt;set&lt;/li&gt;
&lt;li&gt;unset&lt;/li&gt;
&lt;li&gt;env&lt;/li&gt;
&lt;li&gt;history
&lt;ul&gt;
&lt;li&gt;!!  the last command(you can use the up and down arrow)&lt;/li&gt;
&lt;li&gt;!66 the 66th command  !line-number&lt;/li&gt;
&lt;li&gt;!al run the command begin with &amp;lsquo;al&amp;rsquo; nearest.!command&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;type&lt;/li&gt;
&lt;li&gt;kill -9&lt;/li&gt;
&lt;li&gt;crontab -e&lt;/li&gt;
&lt;li&gt;which&lt;/li&gt;
&lt;li&gt;who&lt;/li&gt;
&lt;li&gt;dmesg&lt;/li&gt;
&lt;li&gt;du -sh .&lt;/li&gt;
&lt;li&gt;make  (for compiling the system)&lt;/li&gt;
&lt;li&gt;fsck -c&lt;/li&gt;
&lt;li&gt;System Transplant
&lt;ul&gt;
&lt;li&gt;wget -R [website]&lt;/li&gt;
&lt;li&gt;curl -l&lt;/li&gt;
&lt;li&gt;git clone&lt;/li&gt;
&lt;li&gt;hg clone&lt;/li&gt;
&lt;li&gt;svn clone&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;system enter
&lt;ul&gt;
&lt;li&gt;ssh&lt;/li&gt;
&lt;li&gt;telnet&lt;/li&gt;
&lt;li&gt;ftp&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ifconfig&lt;/li&gt;
&lt;li&gt;all files with map relationship can form an ecosystem.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;network-topology&#34;&gt;Network topology&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;node (one computer one system)&lt;/li&gt;
&lt;li&gt;server (only supply with services)&lt;/li&gt;
&lt;li&gt;NIC (network interface card)  RJ-45
&lt;ul&gt;
&lt;li&gt;network interface port   which abstracted by the NIC .&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;route -n&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;bit &amp;ndash;&amp;gt; word &amp;ndash;&amp;gt; line &amp;ndash;&amp;gt; content &amp;ndash;&amp;gt; file &amp;ndash;&amp;gt; system.  ++Actually, you can use the function to abstraction several command.
What&amp;rsquo;s more ,you can use module or filefolder to do another bigger abstraction++.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;you can find that from bit manipulation to file manipulation,there are many commands used in the Linux system&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>emacs中有趣的词法编程</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/03/emacszhong-you-qu-de-ci-fa-bian-cheng/</link>
      <pubDate>Wed, 03 Jun 2015 14:35:50 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/03/emacszhong-you-qu-de-ci-fa-bian-cheng/</guid>
      <description>&lt;p&gt;词法编程最开始是有1984，Donald Knuth提出的&lt;a href=&#34;http://comjnl.oxfordjournals.org/content/27/2/97.full.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;词法编程&lt;/a&gt;.
另外可以参考&lt;a href=&#34;http://www.howardism.org/Technical/LP/introduction.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;emacs org-mode 词法编程&lt;/a&gt;和 &lt;a href=&#34;http://www.howardism.org/Technical/Emacs/literate-devops.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;emacs orgmode的高级词法编程&lt;/a&gt;
我的理解是词法编程，就是在文本和代码中交叉实现，不让代码只是代码，文本只是文本，其实这根函数式编成的思想是相似的，&lt;strong&gt;代码即数据，数据即代码&lt;/strong&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+begin_src sh
ls
hostname -I
#+end_src

#+results:
| activate.org                   |
| activate.png                   |
| activity.png                   |
| broken.png                     |
| communication.png              |
| data                           |
| digraph2.png                   |
| ditaa.org                      |
| ditta.png                      |
| emacs-chats                    |
| emacsconf2015                  |
| emacs-notes                    |
| gnuplot.org                    |
| gnuplot.png                    |
| #GTD.org#                      |
| gv01.png                       |
| javaTalentTest.org             |
| javaweb5.org                   |
| javaWriteRules.org             |
| latex.org                      |
| Learn.html                     |
| lispfile.org                   |
| literate-programming.org       |
| meeting_states.png             |
| multi.png                      |
| named.png                      |
| newLearningTakecar.el          |
| newLearningTakecar.org         |
| newLearningTakecar.org_archive |
| normal_task_states.png         |
| object.org                     |
| object.png                     |
| orgmode-babel-ditaa3.png       |
| org-mode-doc                   |
| org-mode.org                   |
| orgTest.org                    |
| outcome.sh                     |
| phone_states.png               |
| plantuml_example_states.png    |
| plantuml.org                   |
| scales.png                     |
| schemeToTime.org               |
| sequence.png                   |
| some_filename.png              |
| somefile.png                   |
| state.org                      |
| style                          |
| style.tar.gz                   |
| table.png                      |
| task.org                       |
| teaching.org                   |
| test-act2.png                  |
| test-act2.txt                  |
| test-act3.png                  |
| test-act3.txt                  |
| test-act4.png                  |
| test-act4.txt                  |
| test-act.png                   |
| test-act.txt                   |
| testChines.org                 |
| testgraph.org                  |
| thinking.org                   |
| time.png                       |
| usecase.org                    |
| usecase.png                    |
| vimium                         |
| 172.17.36.2                    |

** You must add the section :properties: and 🔚 ,or
nothing show.
:PROPERTIES:
:var: name1=&amp;quot;hello&amp;quot;
:END:
#+begin_src sh :var hosts=&amp;quot;10.0.2.1&amp;quot;
echo $hosts
echo $name1
#+end_src

#+results:
| 10.0.2.1 |
|    hello |


#+header: :var Dir=&amp;quot;/home/&amp;quot;
#+begin_src sh
cd $Dir
ls -lsh
#+end_src

#+results:
| 总用量 | 28K        |    |          |          |      |     |    |       |                      |
| 4.0K   | drwx------ | 43 | root     | root     | 4.0K | 5月 | 30 | 15:19 | happycamp-of-fortran |
| 4.0K   | drwx------ |  5 | root     | root     | 4.0K | 5月 | 30 | 15:36 | happycamp-of-gnuplot |
| 4.0K   | drwx------ | 31 | root     | root     | 4.0K | 6月 |  3 | 13:32 | happycamp-of-lisp    |
| 4.0K   | drwxr-xr-x | 50 | javazhao | javazhao | 4.0K | 6月 |  3 | 14:22 | javazhao             |
| 4.0K   | drwxr-xr-x |  7 | javazhao | javazhao | 4.0K | 4月 | 30 | 16:28 | lispbox-0.7          |
| 4.0K   | -rw-r--r-- |  1 | root     | root     | 1    | 5月 | 13 | 23:37 | MyOrgHome            |
| 4.0K   | drwxr-xr-x |  7 | root     | root     | 4.0K | 4月 | 10 | 22:18 | StudyCenter          |


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然emacs中也是可以结合gnuplot ,latex, plantuml,graphviz等。
具体可以参看
&lt;a href=&#34;http://www.3zso.com/archives/orgmode-babel.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.3zso.com/archives/orgmode-babel.html&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>我的Bash-It</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/03/wo-de-bash-it/</link>
      <pubDate>Wed, 03 Jun 2015 13:59:44 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/03/wo-de-bash-it/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://github.com/jueqingsizhe66/bash-it&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Bash-it&lt;/a&gt;是一个开源的bash框架，
我的第一感觉是他的themes主题不错，所以就用了，这是我采用的rjorgenson的主题
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/jiemian.png&#34; alt=&#34;rjorgenson&#34;&gt;&lt;/p&gt;
&lt;p&gt;Bash-it是源自于&lt;a href=&#34;https://github.com/robbyrussell/oh-my-zsh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;oh-my-zsh&lt;/a&gt;,
&lt;a href=&#34;http://ohmyz.sh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;zsh的一些相关展示&lt;/a&gt;
主要是调用了一些python和ruby的相关插件。&lt;/p&gt;
&lt;p&gt;##安装步骤&lt;/p&gt;
&lt;p&gt;很简单&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;git clone &amp;ndash;depth=1 &lt;a href=&#34;https://github.com/jueqingsizhe66/bash-it&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/jueqingsizhe66/bash-it&lt;/a&gt; ~/.bash-it (&lt;strong&gt;如果不加入&amp;ndash;depth=1会少一些文件,没有Enable文件夹&lt;/strong&gt;)
(或者把install.sh里面的enable改成available即可(因为作者可能删掉了enable)
)&lt;/li&gt;
&lt;li&gt;cd ~/.bash-it&lt;/li&gt;
&lt;li&gt;./install&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当然还需要安装一些&lt;a href=&#34;http://www.phodal.com/blog/use-bash-it-bash-framework/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;额外的插件&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;apt-get install docker()(有时候可能不需要)
&lt;ul&gt;
&lt;li&gt;sudo apt-get install docker.io&lt;/li&gt;
&lt;li&gt;sudo ln -sf /usr/bin/docker.io /usr/local/bin/docker&lt;/li&gt;
&lt;li&gt;sudo sed -i &amp;lsquo;$acomplete -F _docker docker&amp;rsquo; /etc/bash_completion.d/docker.io&lt;/li&gt;
&lt;li&gt;chmod 777 /var/run/docker.sock&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;pip install arg (首先得安装python-pip)&lt;/li&gt;
&lt;li&gt;安装chruby &lt;a href=&#34;https://github.com/postmodern/chruby&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/postmodern/chruby&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;apt-get install libpq-dev&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;现在安装完之后的感觉就是界面变得更好看些，其他没什么改变。&lt;/p&gt;
&lt;h3 id=&#34;注意&#34;&gt;注意&lt;/h3&gt;
&lt;p&gt;Bash_it的配置脚本和openfoam的配置脚本冲突，暂时未找到原因。&lt;/p&gt;
&lt;h3 id=&#34;补充theme配置&#34;&gt;补充theme配置&lt;/h3&gt;
&lt;p&gt;当你执行玩Bash-it的install脚本后，在~目录下会有~/.bashrc文件，修改其中的bash theme主题变量即可。
我现在使用的是doubletime_multiline_pyonly感觉还不错&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>bash智能分类升级版</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/06/02/bashzhi-neng-fen-lei-sheng-ji-ban/</link>
      <pubDate>Tue, 02 Jun 2015 14:35:57 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/06/02/bashzhi-neng-fen-lei-sheng-ji-ban/</guid>
      <description>&lt;ol&gt;
&lt;li&gt;加入了 seq 1 8  智能产生序列的方法
使得30度攻角的实验值也可以处理。&lt;/li&gt;
&lt;li&gt;判断文件夹内是否存在文件
[ -e &amp;ldquo;实验*.txt&amp;rdquo; ] 无法执行正则表达式
因为有可能没有对应攻角的&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;deleteDensity()
{
echo  &amp;quot;删除密度和来流&amp;quot;
if [ -d &amp;quot;modified&amp;quot; ]
then echo &amp;quot;modified文件夹已存在&amp;quot;
else 
mkdir modified
fi
for i in `ls *.txt`
    do 
        #echo $i
        # 之所以加入 iconv是因为 字符编码问题  怕找不到 密度 和来流动压行
        iconv -f gb18030 -t utf-8 $i|awk &#39;{print}&#39;|awk &#39;{if ($0 ~ /攻角/) {print $3;}else if($0 ~ /升力/){print $1,$4,$5}else if($0 ~ /^$/){print &#39;&#39;}else {print $3,$5;}}&#39;   |sed &#39;/密度/d&#39;|sed &#39;/来流动压/d&#39;|sed &#39;/^$/d&#39; &amp;gt;modified/$i 
    done
}

# 创建文件夹 从-10攻角到25度攻角

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  fenLei
#   DESCRIPTION:  对攻角实行分类，按照不同的攻角创建不同的文件夹
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
fenLei(){
cd modified  # 注意下面的所有函数 都运行在modified文件夹下
#for j in -10.00 -9.00 -8.00 -7.00 -6.00 -5.00 -4.00 -3.00 -2.00 -1.00 0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00 17.00 18.00 19.00 20.00 21.00 22.00 23.00 24.00 25.00 26.00 27.00 28.00 29.00 30.00
for j in `seq -10.00 30.00`
    do 
        if ! [ -d &amp;quot;a&amp;quot;$j ]
        then    
            mkdir &amp;quot;a&amp;quot;$j
        fi
    done
}

# 导入对应攻角文件到文件夹内

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  getFileIntoDir
#   DESCRIPTION:  使用Awk按照不同的攻角值 利用 print的功能调用shell，把对应文件拷贝到对应攻角文件夹下
#                注意-v在awk表示定义变量的间隔符
#                 已废弃
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------

getFileIntoDir(){
#cd modified
#for j in -10.00 -9.00 -8.00 -7.00 -6.00 -5.00 -4.00 -3.00 -2.00 -1.00 0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00 17.00 18.00 19.00 20.00 21.00 22.00 23.00 24.00 25.00 26.00 27.00 28.00 29.00 30.00
for j in `seq -10.00 30.00`
do 
    for i in `ls *.txt`
        do 
            awk &#39;{print}&#39; $i |awk -v B=&amp;quot;$i&amp;quot; -v A=&amp;quot;攻角：&amp;quot;&amp;quot;$j&amp;quot; -v C=&amp;quot;a&amp;quot;&amp;quot;$j&amp;quot; &#39;$0~A{print &amp;quot;cp &amp;quot;,B,&amp;quot; &amp;quot;C&amp;quot;/&amp;quot;B|&amp;quot;/bin/bash&amp;quot;}&#39;
        done
done
}

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  getFileIntoDirNew
#   DESCRIPTION:  新版本的getFileIntoDir 方式
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
#grep &amp;quot;攻角：25.00&amp;quot; *.txt|awk -F[:] &#39;{print $1}&#39;

getFileIntoDirNew(){
#for j in -10.00 -9.00 -8.00 -7.00 -6.00 -5.00 -4.00 -3.00 -2.00 -1.00 0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00 17.00 18.00 19.00 20.00 21.00 22.00 23.00 24.00 25.00 26.00 27.00 28.00 29.00 30.00
for j in `seq -10.00 30.00`
do 
        grep &amp;quot;攻角：$j&amp;quot; *.txt|awk -F[:] &#39;{print $1}&#39;|xargs -i mv {} &amp;quot;a&amp;quot;&amp;quot;$j&amp;quot;
done

}
## 清除空行

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  blankEmptyLine
#   DESCRIPTION:  利用sed -i命令直接处理文件中多余的空行
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
blankEmptyLine(){
# 在每个文件夹运行这些命令 清除空行 
#cd modified
for i in `ls -d */`
    do 
        #if [ -e $i/&amp;quot;实验*.txt&amp;quot; ] #由于不存在任何*.txt相关的东西 所以报错！ 但是不影响程序的进行 所以忽略
        #numBlank=`ls $i/*.txt|wc -l`  # 如果加上.txt反而不断报错
        numBlank=`ls $i/|wc -l`  # 这样就可以忽略掉 a26.00 --a30.00为空的情况
        echo $i&amp;quot;--Blank--&amp;quot;$numBlank
        if [ $numBlank -gt 0 ]
        then 
            sed -i &#39;/^\s*$/d&#39; $i/*.txt
        fi
    done
}

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  cal
#   DESCRIPTION:  把每个攻角下的文件，利用awk执行攻角平均  升力系数平均  和压力系数平均
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
cal(){
# 在每个文件夹下都运行此计算平均值 程序
#cd modified

for i in `ls -d */`
    do 
        #if [ -e $i/&amp;quot;实验*.txt&amp;quot; ]
        #numCal=`ls $i/*.txt|wc -l`
        numCal=`ls $i/|wc -l`
        echo $i&amp;quot;--Cal--&amp;quot;$numCal
        if [ $numCal -gt 0 ]
        then 
            #echo &amp;quot;$i ok&amp;quot;
            awk -F&amp;quot;[ ：]&amp;quot; &#39;BEGIN{num=0;}{if($0 ~/攻角/){f[FNR]=$1;g[FNR]=$4;num+=1;}else if($0 ~/升力系数/){f[fNR]=$1;g[FNR]+=$4;a[FNR]=$5;b[FNR]+=$9;}else if($0 ~/压力系数/){f[FNR]=$1;g[FNR]=$2}else{f[FNR]+=$1;g[FNR]+=$2;if(nbr&amp;lt;FNR) {nbr=FNR;}}}END{for(i=0;i&amp;lt;=nbr;i++){print f[i]/num,g[i]/num,a[i]/num,b[i]/num;} print num;};&#39; $i/*.txt&amp;gt;$i/modified.txt

        fi
    done
}


#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  plot
#   DESCRIPTION:  函数用于画图 调用gnuplot
#                 使用下面函数之前得安装gnuplot
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
plot(){

 #for i in `ls`;do num=`ls $i|wc -l`;let num=$[$num-1];sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num-2 &#39;{print A,$2*B}&#39; &amp;gt;&amp;gt; a.txt;sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $2}&#39; &amp;gt;&amp;gt; a.txt;done; 

 #   sed &#39;N;s/\n/ :/&#39; a.txt


# for i in `ls`;do num=`ls $i|wc -l`;let num=$[$num-1];sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num-2 &#39;{print $2*B}&#39; &amp;gt;&amp;gt; a.txt;sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $2}&#39; &amp;gt;&amp;gt; a.txt;done; 
 for i in `ls -d */` ## 用法思想和cp的处理一样
    do 
        #if [ -e $i/&amp;quot;实验数据*.txt&amp;quot; ] #  不支持正则写法
        #if [ -e $i/&amp;quot;实验数据*.txt&amp;quot; ]
        #numPlot=`ls $i/&amp;quot;*.txt&amp;quot;|wc -l`  # 错误写法 不要用双引号
        #numPlot=`ls $i/*.txt|wc -l` 
        numPlot=`ls $i/|wc -l` 
        #echo $i&amp;quot;--cl-cd--&amp;quot;$numPlot
        if [ $numPlot -gt 0 ]
        then
            num=`ls $i|wc -l`
            num=$(($num-1))
            #print $i,$num
            sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num &#39;{print $2*B}&#39; &amp;gt;&amp;gt; shengli.txt
            sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $2}&#39; &amp;gt;&amp;gt; shengli.txt
            sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num &#39;{print $2*B}&#39; &amp;gt;&amp;gt; zuli.txt
            sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $4}&#39; &amp;gt;&amp;gt; zuli.txt
        fi
    done
# 这是一个相当棒的技巧 把两行合并为一行
sed -i &#39;N;s/\n/ /&#39; shengli.txt
sort -n shengli.txt &amp;gt; shenglimodified.txt
sed -i &#39;N;s/\n/ /&#39; zuli.txt
sort -n zuli.txt &amp;gt; zulimodified.txt

# 两张图 第一张是cl  第二章图是cd
gnuplot&amp;lt;&amp;lt;EOF 
set ter &#39;png&#39; 
set out &#39;shengli.png&#39; 
plot &amp;quot;shenglimodified.txt&amp;quot; t &#39;cl&#39; w lp
EOF
gnuplot&amp;lt;&amp;lt;EOF 
set ter &#39;png&#39; 
set out &#39;zuli.png&#39; 
plot &amp;quot;zulimodified.txt&amp;quot; t &#39;cd&#39; w lp
EOF
rm -rf zuli.txt
rm -rf shengli.txt
}


#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  plotCp
#   DESCRIPTION:  用于打印cp曲线
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
plotCp(){
    # 之所以添加上 -d */ 的作用是 不要处理上一步产生的shengli.png 等文件，而只处理文件夹即可!
 for i in `ls -d */` # 注意一定是 */ 单独使用 ls -d没有效果
    do 
        #if [ -d $i ] &amp;amp;&amp;amp; [ -e $i/&amp;quot;实验数据*txt&amp;quot; ]  ;; 不支持正则写法
        # 新改进的地方 想则会采用 引进ls工具 并调用wc
        #
#IF [···] -a [···] 这样不行。 得改成 if [ ... -a ...] 或者 If [...] &amp;amp;&amp;amp; [..]
#这样吧，IF [···] &amp;amp;&amp;amp; [···] 
        numPlotCp=`ls $i/|wc -l` 
        #numPlotCp=`ls $i/*.txt|wc -l` 
        #echo $i&amp;quot;--Cp--&amp;quot;$numPlotCp
        if [ $numPlotCp -gt 0 ]
        then 
            sed -n &#39;6,47p&#39; $i/&amp;quot;modified.txt&amp;quot; &amp;gt;&amp;gt; $i/&amp;quot;cpUp.txt&amp;quot;;sed -n &#39;49,93p&#39; $i/&amp;quot;modified.txt&amp;quot; |sort -k 2 -nr &amp;gt;&amp;gt; $i/&amp;quot;cpUp.txt&amp;quot;;cpGrid
        fi
    done

}

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  cpGrid
#   DESCRIPTION:  注意  gnuplot必须放在句首
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
cpGrid(){
gnuplot&amp;lt;&amp;lt;EOF 
set ter &#39;png&#39; 
set out &#39;$i/cpUp.png&#39;
set xtics rotate by -45
set ytics rotate by -45
plot &amp;quot;$i/cpUp.txt&amp;quot; t &#39;cp&#39; w lp
EOF
}
# 执行函数
cd $1
pwd
deleteDensity
fenLei
getFileIntoDirNew
blankEmptyLine
cal
plot
plotCp



&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>git和github配置</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/29/githe-githubpei-zhi/</link>
      <pubDate>Fri, 29 May 2015 21:14:39 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/29/githe-githubpei-zhi/</guid>
      <description>&lt;p&gt;git是一个Linus开发的一个版本控制系统，其实就是一个文件系统而已。
下面是我总结的一些操作步骤，最终的目的是你可以提交信息到github，
并了解git和github之间的关系。&lt;/p&gt;
&lt;h2 id=&#34;1-打开git&#34;&gt;1. 打开git&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/1.png&#34; alt=&#34;打开&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-配置本地git环境&#34;&gt;2. 配置本地git环境&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/config.png&#34; alt=&#34;配置&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;3-github-注册用户&#34;&gt;3. Github 注册用户&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/register.png&#34; alt=&#34;注册&#34;&gt;&lt;/p&gt;
&lt;p&gt;账号邮箱最好是你刚才git本地配置！ 密码自己选&lt;/p&gt;
&lt;h2 id=&#34;4-ssh-公匙生成一路回车-就好由于我已经配置好了公匙所以显示是否覆盖&#34;&gt;4. ssh 公匙生成（一路回车 就好，由于我已经配置好了公匙所以显示是否覆盖。。。。。）&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/ssh.png&#34; alt=&#34;ssh&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;5-拷贝公匙到黏贴板ubuntu-得安装clip命令-apt-get-install-clip&#34;&gt;5. 拷贝公匙到黏贴板（ubuntu 得安装clip命令： apt-get install clip&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/copy.png&#34; alt=&#34;拷贝&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;6-登陆你的github用户&#34;&gt;6. 登陆你的github用户&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/enter.png&#34; alt=&#34;登录&#34;&gt;
自动切换到登陆后的界面
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/interface.png&#34; alt=&#34;界面1&#34;&gt;
然后，你点击配置，如上图所示。
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/interface2.png&#34; alt=&#34;界面2&#34;&gt;&lt;/p&gt;
&lt;p&gt;按照上图，打开添加公匙界面，然后利用下图的Add SSH key添加公匙。Title的内容随便写。。。。。。。主要是把公匙框填好即可
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/interface3.png&#34; alt=&#34;界面3&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/name.png&#34; alt=&#34;取名字&#34;&gt;&lt;/p&gt;
&lt;p&gt;网上说要测试，但是大部分情况，这样就算通过了，你也可以按照https://help.github.com/articles/generating-ssh-keys/
这个连接的说法进行测试，。。。。。。我现在一般不测试。。。。&lt;/p&gt;
&lt;h2 id=&#34;7-现在开始下载rupengfanyifanyi-的原始版本内容&#34;&gt;7. 现在开始下载RupengFanYi/fanyi 的原始版本内容&lt;/h2&gt;
&lt;p&gt;我是想把已经翻译的放在Finished文件夹下
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/folder.png&#34; alt=&#34;文件夹&#34;&gt;&lt;/p&gt;
&lt;p&gt;我们现在开始克隆这个项目《&amp;mdash;&amp;ndash;做正事了！！&lt;/p&gt;
&lt;p&gt;Git clone
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/clone.png&#34; alt=&#34;复制gtk项目&#34;&gt;&lt;/p&gt;
&lt;p&gt;记住，你可以切换到任意目录下进行git clone,你也可以把你的这个fanyi文件夹拷贝到任意文件夹
Cd f:/  就表示切换到f盘
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/changedirectory.png&#34; alt=&#34;切换目录&#34;&gt;&lt;/p&gt;
&lt;p&gt;既然已经git clone 了之后，我们现在开始进行第八步&lt;/p&gt;
&lt;h2 id=&#34;8--把你已经翻译的文件-比如html-复制到finished-文件夹表示已经翻译的&#34;&gt;8.  把你已经翻译的文件 比如*.html 复制到Finished 文件夹表示已经翻译的&lt;/h2&gt;
&lt;p&gt;一般不动fanyi文件夹里面的内容！我们只是把翻译好的文件拷贝到Finished然后上传&lt;/p&gt;
&lt;p&gt;然后再切回到主工作区（表示 fanyi文件夹下）
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/finished.png&#34; alt=&#34;完成&#34;&gt;&lt;/p&gt;
&lt;p&gt;下面字符界面操作流程：
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/solve.png&#34; alt=&#34;添加&#34;&gt;&lt;/p&gt;
&lt;p&gt;但是也可能push出现问题，
比如Gtk翻译01犯的错误
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/oneeroor.png&#34; alt=&#34;一个错误&#34;&gt;&lt;/p&gt;
&lt;p&gt;这个是因为，我实现更新了文件，而他的当前文件夹没有！所以发生了冲突&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/errorContent.png&#34; alt=&#34;报错内容&#34;&gt;
这就是报错的内容，所以你现在的解决办法办法是：
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/solve.png&#34; alt=&#34;解决&#34;&gt;
然后就ok了
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/ok.png&#34; alt=&#34;可以&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;总结&#34;&gt;总结&lt;/h2&gt;
&lt;p&gt;以后我们可以这样做
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/future.png&#34; alt=&#34;步骤1&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/future2.png&#34; alt=&#34;步骤2&#34;&gt;&lt;/p&gt;
&lt;p&gt;Gtk翻译01说有一个小问题：（仅供大家参考）
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/git/note.png&#34; alt=&#34;注意&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Haskell在脑海里的踪迹</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/29/haskellzai-nao-hai-li-de-zong-ji/</link>
      <pubDate>Fri, 29 May 2015 14:59:44 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/29/haskellzai-nao-hai-li-de-zong-ji/</guid>
      <description>&lt;p&gt;基于范畴理论，在每一个范畴里面都包含一个objects和fmap关系，利用functor映射到不同的category。
可以继续思考的是一个fmap:(*-&amp;gt;*)
一个fmap是可以充当形参的，因为他正如在一个&lt;a href=&#34;https://www.haskell.org/onlinereport/list.html#sect17.3&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;List module&lt;/a&gt;中
一个一个的破折号和箭头构成的map关系被放进List这个category中。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;module List ( 
    elemIndex, elemIndices,
    find, findIndex, findIndices,
    nub, nubBy, delete, deleteBy, (\\), deleteFirstsBy,
    union, unionBy, intersect, intersectBy,
    intersperse, transpose, partition, group, groupBy,
    inits, tails, isPrefixOf, isSuffixOf,
    mapAccumL, mapAccumR,
    sort, sortBy, insert, insertBy, maximumBy, minimumBy,
    genericLength, genericTake, genericDrop,
    genericSplitAt, genericIndex, genericReplicate,
    zip4, zip5, zip6, zip7,
    zipWith4, zipWith5, zipWith6, zipWith7,
    unzip4, unzip5, unzip6, unzip7, unfoldr,

    -- ...and what the Prelude exports
    -- []((:), []), -- This is built-in syntax
    map, (++), concat, filter,
    head, last, tail, init, null, length, (!!),
    foldl, foldl1, scanl, scanl1, foldr, foldr1, scanr, scanr1,
    iterate, repeat, replicate, cycle,
    take, drop, splitAt, takeWhile, dropWhile, span, break,
    lines, words, unlines, unwords, reverse, and, or,
    any, all, elem, notElem, lookup,
    sum, product, maximum, minimum, concatMap, 
    zip, zip3, zipWith, zipWith3, unzip, unzip3
    ) where
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;我们所看到&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;data  Bool  =  False | True deriving 
                             (Read, Show, Eq, Ord, Enum, Bounded)
data Int = -65532|...|-1|0|1|2|...|65532
data Integer = ...-2|-1|0|1|2|3|4|...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;从这边我们可以看到False ，True， 1，2，3，4&amp;hellip;.叫做Data constructor
而Bool,Integer叫做Type Constructor,所以你完全可以把类型当作数据，而这个类型包含表达式、函数、数据。&lt;/p&gt;
&lt;p&gt;类也包含&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;原子类型 Integer  Char   Integer-&amp;gt;Char(functions mapping from Integer to Char)&lt;/li&gt;
&lt;li&gt;结构类型 [Integer] 数字列表 (Integer,Char)数字字符tuple&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;比如：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;1::Int
inc::Integer-&amp;gt;Integer
[1]::[Integer]
(&#39;b&#39;,4)::[Char,Integer]

::可以读作 has type类型为
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;我们也会看到很多类的继承&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;  class Foo a =&amp;gt; Bar a where ...
  
  instance (Eq a, Show a) =&amp;gt; Foo [a] where ...
  
  instance Num a =&amp;gt; Bar [a] where ...


  class (Eq a) =&amp;gt; Ord a where
    (&amp;lt;),(&amp;lt;=),(&amp;gt;=),(&amp;gt;)::a-&amp;gt;a-&amp;gt;Bool
    max,min          ::a-&amp;gt;a-&amp;gt;a
    ----此时Eq叫做Ord的子类
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其实更多的可以参考&lt;a href=&#34;https://www.haskell.org/onlinereport/standard-prelude.html#sect8.2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Haskell 98 Report&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;当然你事先得知道类的定义&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;class cx =&amp;gt; C u where { cbody }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;class 方法被叫做haskell里的顶层声明。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;而有一些比较有趣的lambda转换&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;\x-&amp;gt;\y-&amp;gt;(+) x  y ---&amp;gt;  \x y -&amp;gt; (+) x  y

(x+) --&amp;gt; \y-&amp;gt;x+y
(+y) --&amp;gt; \x-&amp;gt;x+y
(+)  --&amp;gt; \x y -&amp;gt; x+y

(.) :: (b-&amp;gt;c) -&amp;gt;(a-b)-&amp;gt;(a-&amp;gt;c)
f.g  = \x-&amp;gt; f (g x)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在你编写函数的时候：
一个数据组和可以变为(x:xs) == x+xs完整的数据组和 ，只不过x代表这个数据组和的head部分，而xs表示tail部分
而如果 s@(x:xs) 其中的s代表就是整个数据组和了，这是一个不错的技巧。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;f (x:xs) = x❌xs
f s@(x:xs) = x:s
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然你也可能遇到Wild-cards情况&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;head (x:_) = x
head (_:xs) = xs
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;另外一个分支关于模式匹配的相似效果是case定义
f p11 &amp;hellip; p1k = e1
&amp;hellip;
f pn1 &amp;hellip; pnk = en
其中pij是模式组合，&lt;/p&gt;
&lt;p&gt;如果你使用case进行书写&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;f x1 x2 ... xk = case (x1,...,xk) of (p11,...,p1k) -&amp;gt; e1
                                        ...
                                      (pn1,...,pnk)-&amp;gt;en
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;比如下面：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;--采用模式匹配方式
take _ [] = []
take 0 [] = []
take n (x:xs) = x:take (n-1) xs


--采用case方式
take m ys = case (m,ys) of
    (0,_) -&amp;gt; []
    (_,[]) -&amp;gt; []
    (n,x:xs) -&amp;gt; x:take (n-1) xs
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;一个比较重要的functor的定义，因为它用于范畴之间的链接，主要是一个Functor类的实现和fmap函数的定义&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;class Functor f where
    fmap :: (a-&amp;gt;b) -&amp;gt; f a-&amp;gt;f b


对应的Functor实例是
instance Functor Tree where
    fmap f (Leaf x) = Leaf (f x)
    fmap f (Branch t1 t2) = Branch (f t1) (f t2)

之所以写上这个你会发现，我们使用
Date Tree a= Leaf a| Branch a a
只是定义了类型，但是该类型（或者说大点，叫做范畴）并没有定义fmap，基本上所有的calss类型定义完之后都需要使用instance Functor进行fmap的
定义,这样对象和映射的组合才够成了范畴。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;我们可能一直在用，但是并未知晓。当然上面需要特别注意的是实例声明额时候使用的是Tree，而不是Tree a.
也就是haskell和c++\java不同的是类型变量和methods的定义是分开的。
Haskell类类似于java的interface，定义的是一个协议，而不是一个定义一个对象本身。而且最重要的一个区别是haskell没有访问控制
修饰符比如public 、private。取而代之的是使用module模块系统用来隐藏和显示一个类的组成。&lt;/p&gt;
&lt;p&gt;其实写到这边，模块系统你可能有所理解，当然模式匹配在函数定义中也是训练的很多，参考&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/05/21/haskellku-wen-dang-jie-gou/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Haskell库文档结构&lt;/a&gt;
但是关于instance，你接触、练习还是有点少，所以这部分内容可以继续探索，包括IOMonad（一个新的IO范畴，可以当做一种抽象数据类型）
也包括图形化的制作等。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Bash智能分类文件并求值</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/27/bashzhi-neng-fen-lei-wen-jian-bing-qiu-zhi/</link>
      <pubDate>Wed, 27 May 2015 10:36:24 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/27/bashzhi-neng-fen-lei-wen-jian-bing-qiu-zhi/</guid>
      <description>&lt;p&gt;Bash是linux底下的一种shell实现，可以方便linux用户进行系统管理。他的核心就是
调用最有效的命令组合形成更加强大完美的管理和应用程序,这也是unix的哲学,通过调用between programs的&lt;strong&gt;关系&lt;/strong&gt;来&lt;strong&gt;get its power&lt;/strong&gt;而不是通过自己的程序。
shell编成的目的减少unix相关系统的管理员的人物&lt;/p&gt;
&lt;p&gt;下面介绍主要是bash语法，以及有bash语法调用awk，sed，grep等linux底下强大的工具实现一个文件智能分类，并对相应文件夹取平均。&lt;/p&gt;
&lt;p&gt;一些基本语法,虽然扎成一团，却静心选择。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt; 在单行模式下可以
echo {userA,userB,userC}-{home,bin,data}
echo {&amp;quot;userA&amp;quot;,&amp;quot;userB&amp;quot;,&amp;quot;userC&amp;quot;}-{&amp;quot;home&amp;quot;,&amp;quot;bin&amp;quot;,&amp;quot;data&amp;quot;}
echo `{userA,userB,userC}-{home,bin,data}` #error
echo &#39;{userA,userB,userC}-{home,bin,data}&#39;
 分号的作用 挡任连续指令的功能！（其实也可以用换行代替）


 一定要注意的bash的if语法，有空格：
 if [ &amp;quot;$?&amp;quot; != 0 ] 等价于  if test &amp;quot;$?&amp;quot; != 0    一定要注意[]之间有空格

 等价关系有条件：
 `command` 等价于 $(command)
 &amp;quot;&amp;quot; 约等于 &#39;&#39;  但是单引号不转义特殊字符  双引号不转义特殊字符

 另外需要注意这种情况，${var} 和$var的区别：
  基本上一样，$1...$9这个没区别，但是$10呢，${var}的这种就是${10}
而$var却是$10是$1后边带个0


 几个dollar开头的内置参数
 $$ shell脚本号
 $* 以一个单字符显示所有脚本传递的参数 $1 
 $#  传给shell程序的位置参数个数
 $0  脚本名称
 $n  脚本的第几个参数
 $((...))  ==&amp;gt; x=$(($x+1)) 对括号内的表达式求值

 逻辑操作符相关:
 and   statement &amp;amp;&amp;amp; statement &amp;amp;&amp;amp; .. 
 or statement || statement || .. 

 最常用的分支判断：
 if [ -f file_one ]  &amp;amp;&amp;amp; [ -f file_two ]
 then
 echo &amp;quot;in if&amp;quot;
 else
 echo &amp;quot;in else
 fi

 bash也在改进,比如：
 [[]] 是提高版的test  比如\&amp;gt;必须在[]和test中使用  在[[]]直接使用！
   #  所以以后改用[[]]

 下面几个${}开头的都是针对字符串的操作，可以剪切替换
${name:-default} 使用一个默认值（一般是空值）来代替那些空的或者没有赋值的变量name；
${name:=default}使用指定值来代替空的或者没有赋值的变量name；
${name:?message}如果变量为空或者未赋值，那么就会显示出错误信息并中止脚本的执行同时返回退出码1。
${#name} 给出name的长度
${name%word} 从name的尾部开始删除与word匹配的最小部分，然后返回剩余部分
${name%%word} 从name的尾部开始删除与word匹配的最长部分，然后返回剩余部分
${name#word} 从name的头部开始删除与word匹配的最小部分，然后返回剩余部分
${name##word} 从name的头部开始删除与word匹配的最长部分，然后返回剩余部分

（注，name为变量名，word为要匹配的字符串）
case${tao} in
a)      echo “a” ;;
b)      echo “b” ;;
esac

## 一些当行运行的指令，只在prompt运行窗口才有效
1 let
let &amp;quot;sus=2**3&amp;quot;
echo &amp;quot;sus = $sus&amp;quot; 
sus=[[2**3]]
echo &amp;quot;2**3&amp;quot;
echo &amp;quot;sus = $sus&amp;quot;,$sus
if [ 2**3 == 8] 
then  echo &amp;quot;hello&amp;quot;
else
    echo &amp;quot;fuck&amp;quot;
fi
 注意在shell #的命令行运行可以写上分号 



##  虽然有人说函数创建可以使用  
 [function] function_name[()]{
 commands
 [return ...]
}
 但是我发现加入function反而不行，于是使用 function_name(){}的风格

&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;无用的分号命令&#34;&gt;无用的分号命令&lt;/h1&gt;
&lt;p&gt;： 该命令什么都不做，但执行后会返回一个正确的退出代码，即exit 0。比如在if语句中，then后面不想做任何操作，但是又不能空着，这时就可以使用“:”来解决，如下&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;if [ &amp;quot;$i&amp;quot; -ne 1 ];then
    :
else
    echo &amp;quot;$i is not equal 1&amp;quot;
fi
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;特殊的点号&#34;&gt;特殊的点号&lt;/h1&gt;
&lt;p&gt;点号+ 文件名的作用 和 source+文件名的作用一样，都是在当前的shell执行命令
而 ./filename.sh 则是在子shell执行命令。
所以如果想要设置环境变量得用source+文件名或者. 文件名的方式。&lt;/p&gt;
&lt;h1 id=&#34;关于大括号和小括号的区别&#34;&gt;关于大括号和小括号的区别&lt;/h1&gt;
&lt;p&gt;大括号和小括号的作用都一样，都是把几个命令组合在一起，然而他们也有所区别。
()是在产生的子shell下执行，而{}是在当前的shell下执行
与前面讲到是使用&amp;quot;.  filename.sh&amp;quot;和&amp;quot;./filename.sh&amp;quot;的区别一样&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
# A=123
# (A=abc;echo $A);echo $A
abc
123
# { A=abc;echo $A; };echo $A
abc
abc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由此可见，() 子shell设置完，不会影响到父shell，因为父不会继承子，影响的只是
自身的shell。
&lt;em&gt;注意：()里面两边可以不使用空格，{}里面两边必须使用空格，且最后一个命令也需要以“；”结尾，表示命令结束。&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;中括号用于判断&#34;&gt;中括号用于判断&lt;/h1&gt;
&lt;p&gt;[] 与test命令一样，用于比较值以及检查文件类型。如下&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;[ &amp;ldquo;$A&amp;rdquo; = 123 ]：是字符串的测试，以测试 $A 是否为 1、2、3 这三个连续的&amp;quot;文字&amp;quot;。&lt;/li&gt;
&lt;li&gt;[ &amp;ldquo;$A&amp;rdquo; -eq 123 ]：是整数的测试，以测试 $A 是否等于&amp;quot;一百二十三&amp;quot;。&lt;/li&gt;
&lt;li&gt;[ -e &amp;ldquo;$A&amp;rdquo; ]：是关于文件的测试，以测试 123 这份&amp;quot;文件&amp;quot;是否存在&lt;/li&gt;
&lt;li&gt;[ -f &amp;ldquo;$A&amp;rdquo; ] : 判断是否存在文件&lt;/li&gt;
&lt;li&gt;[ -d &amp;ldquo;$A&amp;rdquo; ] : 判断是否存在文件夹&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;关于-单括号和双中括号的区别&#34;&gt;关于 单括号和双中括号的区别&lt;/h1&gt;
&lt;p&gt;[[]]可以说是[]的“增强版”，它能够将多个test命令支持的测试组合起来.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
# [[ (-d &amp;quot;$HOME&amp;quot;) &amp;amp;&amp;amp; (-w &amp;quot;$HOME&amp;quot;) ]] &amp;amp;&amp;amp; echo echo &amp;quot;home is a writable directory&amp;quot;  
home is a writable directory
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;两者的主要区别如下&#34;&gt;两者的主要区别如下：&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;数字测试： -eq -ne -lt -le -gt -ge，[&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; ]同 &lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; 一致
&lt;ul&gt;
&lt;li&gt;test int1 -eq int2  测试整数是否相等&lt;/li&gt;
&lt;li&gt;test int1 -ge int2  测试int1是否&amp;gt;=int2&lt;/li&gt;
&lt;li&gt;test int1 -gt int2  测试int1是否&amp;gt;int2&lt;/li&gt;
&lt;li&gt;test int1 -le  int2 测试int1是否&amp;lt;=int2&lt;/li&gt;
&lt;li&gt;test int1 -lt int2  测试int1是否&amp;lt;int2&lt;/li&gt;
&lt;li&gt;test int1 -ne int2  测试整数是否不相等&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;文件测试： -r、-l、-w、-x、-f、-d、-s、-nt、-ot，[&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; ]同 &lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; 一致
&lt;ul&gt;
&lt;li&gt;test -d file 指定文件是否目录&lt;/li&gt;
&lt;li&gt;test -f file 指定文件是否常规文件&lt;/li&gt;
&lt;li&gt;test -x file 指定文件是否可执行&lt;/li&gt;
&lt;li&gt;test -r file 指定文件是否可读&lt;/li&gt;
&lt;li&gt;test -w file 指定文件是否可写&lt;/li&gt;
&lt;li&gt;test -a file 指定文件是否存在&lt;/li&gt;
&lt;li&gt;test -s file 文件的大小是否非0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;字符串测试： &amp;gt; &amp;lt; =(同==) != -n -z，不可使用“&amp;lt;=”和“&amp;gt;=”，[&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; ]同 &lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; 一致，但在[]中，&amp;gt;和&amp;lt;必须使用\进行转义，即&amp;gt;和&amp;lt;
&lt;ul&gt;
&lt;li&gt;test str1=str2  测试字符串是否相等&lt;/li&gt;
&lt;li&gt;test str1!=str2  测试字符串是否不相等&lt;/li&gt;
&lt;li&gt;test str1 测试字符串是否不为空&lt;/li&gt;
&lt;li&gt;test -n str1 测试字符串是否不为空&lt;/li&gt;
&lt;li&gt;test -z str1 测试字符串是否为空&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;逻辑测试： []为 -a -o ! [&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; ] 为&amp;amp;&amp;amp; || !&lt;/li&gt;
&lt;li&gt;数学运算： [] 不可以使用 [&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; ]可以使用+ - * / %&lt;/li&gt;
&lt;li&gt;组合： 均可用各自逻辑符号连接的数字（运算）测试、文件测试、字符测试&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
# [ a \&amp;gt; 1 ] &amp;amp;&amp;amp; echo ture || echo false
ture
# [[ a &amp;gt; 1 ]] &amp;amp;&amp;amp; echo ture || echo false
ture
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;双中括号和双小括号&#34;&gt;双中括号和双小括号&lt;/h1&gt;
&lt;p&gt;(())专门来做数值运算，如果表达式求值为 0，则设置退出状态为 1；如果求值为非 0 值，则设置为 0。不需要对 (( 和 )) 之间的操作符转义。算术只对整数进行。除 0 会产生错误，但不会产生溢出。可以执行 C 语言中常见的算术、逻辑和位操作。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;((i=1+99));echo $i
100

i=99;((i++));echo $i
100

echo $((2**3))
8

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;注意：使用 (( )) 时，不需要空格分隔各值和运算符，使用[]和[[ ]] 时需要用空格分隔各值和运算符&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;find跳过指定目录&#34;&gt;find跳过指定目录&lt;/h1&gt;
&lt;p&gt;如果在查找文件时希望忽略某个目录，因为你知道那个目录中没有你所要查找的文件，那么可以使用-prune选项来指出需要忽略的目录。
在使用 -prune选项时要当心，因为如果你同时使用了-depth选项，那么-prune选项就会被find命令忽略。&lt;/p&gt;
&lt;h1 id=&#34;unix-tutorial-for-beginnerwwweesurreyacukteachingunix&#34;&gt;&lt;a href=&#34;www.ee.surrey.ac.uk/Teaching/Unix&#34;&gt;Unix Tutorial for Beginner&lt;/a&gt;&lt;/h1&gt;
&lt;h1 id=&#34;常用的bash命令学习httpvbirddicksuedutwlinux_basic0320bashphp-&#34;&gt;&lt;a href=&#34;http://vbird.dic.ksu.edu.tw/linux_basic/0320bash.php&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;常用的bash命令学习&lt;/a&gt;&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;wc -l&lt;/li&gt;
&lt;li&gt;sort -rn -t 2 -k :&lt;/li&gt;
&lt;li&gt;grep -n &amp;ldquo;bash&amp;rdquo; src&lt;/li&gt;
&lt;li&gt;join a.txt b.txt 两个文件有一列是相同的&lt;/li&gt;
&lt;li&gt;find /usr -name &amp;ldquo;hello&amp;rdquo; -type d -exec ls -l {} ;  使用-ok更为安全。&lt;/li&gt;
&lt;li&gt;find . -type f -atime -7 -print   7天前被访问的&lt;/li&gt;
&lt;li&gt;find . -type f -size -100M   +100M 大于100M  -100M小于10M
&lt;ul&gt;
&lt;li&gt;b&amp;mdash;&amp;ndash;块（512字节）&lt;/li&gt;
&lt;li&gt;c&amp;mdash;&amp;ndash;字节&lt;/li&gt;
&lt;li&gt;w&amp;mdash;&amp;ndash;字（2字节）&lt;/li&gt;
&lt;li&gt;k&amp;mdash;&amp;mdash;千字节（1024个字节）&lt;/li&gt;
&lt;li&gt;M&amp;mdash;&amp;ndash;兆字节&lt;/li&gt;
&lt;li&gt;G&amp;mdash;&amp;mdash;吉字节（1024M）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tr &amp;lsquo;A-Z&amp;rsquo; &amp;lsquo;a-z&amp;rsquo;&lt;/li&gt;
&lt;li&gt;echo &amp;lsquo;this is my passwd&amp;rsquo; |tr &amp;lsquo;abcdefghijklmnopqrstuvwxyz&#39;&amp;lsquo;zyxwvutsrqponmlkjihgfedcba&amp;rsquo;   tr也可以用于加密
解密：
echo &amp;lsquo;gsrh rh nb kzhhdw&amp;rsquo; |tr &amp;lsquo;zyxwvutsrqponmlkjihgfedcba&#39;&amp;lsquo;abcdefghijklmnopqrstuvwxyz&amp;rsquo;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;tr -d SET1 #用tr删除字符&lt;br&gt;
echo &amp;lsquo;Hello1234 World11111 44&amp;rsquo; |tr -d &amp;lsquo;0-9&amp;rsquo;&lt;br&gt;
HelloWorld&lt;br&gt;
10. grep -oP &amp;lsquo;(?&amp;lt;=+)fx&amp;rsquo; *&lt;br&gt;
grep -oP &amp;lsquo;(?&amp;lt;=+)fx(?=()&amp;rsquo; *
grep -onP &amp;lsquo;(?&amp;lt;=+)fx(?=()&amp;rsquo; *
11. cut -d &amp;ldquo;:&amp;rdquo; -f 1,3 /etc/passwd   类似于awk的字域
cut -d &amp;ldquo;:&amp;rdquo; -f 1,3,7 /etc/passwd&lt;/p&gt;
&lt;h1 id=&#34;一个综合性的案例&#34;&gt;一个综合性的案例&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  deleteDensity
#   DESCRIPTION:  去除密度和来流经验等行  采用  awk和sed组合删除！ 并把有用信息导入modified文件夹下
#                 iconv主要是考虑到windows下的中文字符无法被识别的问题
#                  这个步骤是复制，而第三个fileintoDirNew是通过mv来操作的
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
deleteDensity()
{
echo  &amp;quot;删除密度和来流&amp;quot;
if [ -d &amp;quot;modified&amp;quot; ]
then echo &amp;quot;modified文件夹已存在&amp;quot;
else 
mkdir modified
fi
for i in `ls *.txt`
    do 
        iconv -f gb18030 -t utf-8 $i|awk &#39;{print}&#39;|awk &#39;{if ($0 ~ /攻角/) {print $3;}else if($0 ~ /升力/){print $1,$4,$5}else if($0 ~ /^$/){print &#39;&#39;}else {print $3,$5;}}&#39;   |sed &#39;/密度/d&#39;|sed &#39;/来流动压/d&#39;|sed &#39;/^$/d&#39; &amp;gt;modified/$i 
    done
}

# 创建文件夹 从-10攻角到25度攻角

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  fenLei
#   DESCRIPTION:  对攻角实行分类，按照不同的攻角创建不同的文件夹
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
fenLei(){
cd modified  # 注意下面的所有函数 都运行在modified文件夹下
for j in -10.00 -9.00 -8.00 -7.00 -6.00 -5.00 -4.00 -3.00 -2.00 -1.00 0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00 17.00 18.00 19.00 20.00 21.00 22.00 23.00 24.00 25.00
    do 
        if ! [ -d &amp;quot;a&amp;quot;$j ]
        then    mkdir &amp;quot;a&amp;quot;$j
        fi
    done
}

# 导入对应攻角文件到文件夹内

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  getFileIntoDir
#   DESCRIPTION:  使用Awk按照不同的攻角值 利用 print的功能调用shell，把对应文件拷贝到对应攻角文件夹下
#                注意-v在awk表示定义变量的间隔符
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------

getFileIntoDir(){
#cd modified
for j in -10.00 -9.00 -8.00 -7.00 -6.00 -5.00 -4.00 -3.00 -2.00 -1.00 0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00 17.00 18.00 19.00 20.00 21.00 22.00 23.00 24.00 25.00
do 
    for i in `ls *.txt`
        do 
            awk &#39;{print}&#39; $i |awk -v B=&amp;quot;$i&amp;quot; -v A=&amp;quot;攻角：&amp;quot;&amp;quot;$j&amp;quot; -v C=&amp;quot;a&amp;quot;&amp;quot;$j&amp;quot; &#39;$0~A{print &amp;quot;cp &amp;quot;,B,&amp;quot; &amp;quot;C&amp;quot;/&amp;quot;B|&amp;quot;/bin/bash&amp;quot;}&#39;
        done
done
}

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  getFileIntoDirNew
#   DESCRIPTION:  新版本的getFileIntoDir 方式
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
#grep &amp;quot;攻角：25.00&amp;quot; *.txt|awk -F[:] &#39;{print $1}&#39;

getFileIntoDirNew(){
for j in -10.00 -9.00 -8.00 -7.00 -6.00 -5.00 -4.00 -3.00 -2.00 -1.00 0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00 17.00 18.00 19.00 20.00 21.00 22.00 23.00 24.00 25.00
do 
        grep &amp;quot;攻角：$j&amp;quot; *.txt|awk -F[:] &#39;{print $1}&#39;|xargs -i mv {} &amp;quot;a&amp;quot;&amp;quot;$j&amp;quot;
done

}
## 清除空行

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  blankEmptyLine
#   DESCRIPTION:  利用sed -i命令直接处理文件中多余的空行
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
blankEmptyLine(){
# 在每个文件夹运行这些命令 清除空行 
#cd modified
for i in `ls -d */`
    do 
        sed -i &#39;/^\s*$/d&#39; $i/*.txt
    done
}

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  cal
#   DESCRIPTION:  把每个攻角下的文件，利用awk执行攻角平均  升力系数平均  和压力系数平均
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
cal(){
# 在每个文件夹下都运行此计算平均值 程序
#cd modified

for i in `ls -d */`
    do 
        awk -F&amp;quot;[ ：]&amp;quot; &#39;BEGIN{num=0;}{if($0 ~/攻角/){f[FNR]=$1;g[FNR]=$4;num+=1;}else if($0 ~/升力系数/){f[fNR]=$1;g[FNR]+=$4;a[FNR]=$5;b[FNR]+=$9;}else if($0 ~/压力系数/){f[FNR]=$1;g[FNR]=$2}else{f[FNR]+=$1;g[FNR]+=$2;if(nbr&amp;lt;FNR) {nbr=FNR;}}}END{for(i=0;i&amp;lt;=nbr;i++){print f[i]/num,g[i]/num,a[i]/num,b[i]/num;} print num;};&#39; $i/*.txt&amp;gt;$i/modified.txt
    done
}


#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  plot
#   DESCRIPTION:  函数用于画图 调用gnuplot
#                 使用下面函数之前得安装gnuplot
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
plot(){

 #for i in `ls`;do num=`ls $i|wc -l`;let num=$[$num-1];sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num-2 &#39;{print A,$2*B}&#39; &amp;gt;&amp;gt; a.txt;sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $2}&#39; &amp;gt;&amp;gt; a.txt;done; 

 #   sed &#39;N;s/\n/ :/&#39; a.txt


# for i in `ls`;do num=`ls $i|wc -l`;let num=$[$num-1];sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num-2 &#39;{print $2*B}&#39; &amp;gt;&amp;gt; a.txt;sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $2}&#39; &amp;gt;&amp;gt; a.txt;done; 
 for i in `ls`
    do 
        num=`ls $i|wc -l`
        num=$(($num-1))
        #print $i,$num
        sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num &#39;{print $2*B}&#39; &amp;gt;&amp;gt; shengli.txt
        sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $2}&#39; &amp;gt;&amp;gt; shengli.txt
        sed -n &#39;2p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk -v A=$i -v B=$num &#39;{print $2*B}&#39; &amp;gt;&amp;gt; zuli.txt
        sed -n &#39;3p&#39; $i/&amp;quot;modified.txt&amp;quot;|awk &#39;{print $4}&#39; &amp;gt;&amp;gt; zuli.txt
    done

sed -i &#39;N;s/\n/ /&#39; shengli.txt
sort -n shengli.txt &amp;gt; shenglimodified.txt
sed -i &#39;N;s/\n/ /&#39; zuli.txt
sort -n zuli.txt &amp;gt; zulimodified.txt

gnuplot&amp;lt;&amp;lt;EOF 
set ter &#39;png&#39; 
set out &#39;shengli.png&#39; 
plot &amp;quot;shenglimodified.txt&amp;quot; t &#39;cl&#39; w lp
EOF
gnuplot&amp;lt;&amp;lt;EOF 
set ter &#39;png&#39; 
set out &#39;zuli.png&#39; 
plot &amp;quot;zulimodified.txt&amp;quot; t &#39;cd&#39; w lp
EOF
rm -rf zuli.txt
rm -rf shengli.txt
}


#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  plotCp
#   DESCRIPTION:  用于打印cp曲线
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
plotCp(){
 for i in `ls`
    do 
        if [ -d $i ]
            then sed -n &#39;6,47p&#39; $i/&amp;quot;modified.txt&amp;quot; &amp;gt;&amp;gt; $i/&amp;quot;cpUp.txt&amp;quot;;sed -n &#39;49,93p&#39; $i/&amp;quot;modified.txt&amp;quot; |sort -k 2 -nr &amp;gt;&amp;gt; $i/&amp;quot;cpUp.txt&amp;quot;;cpGrid
            fi
    done

}

#---  FUNCTION  ----------------------------------------------------------------
#          NAME:  cpGrid
#   DESCRIPTION:  注意  gnuplot必须放在句首
#    PARAMETERS:  
#       RETURNS:  
#-------------------------------------------------------------------------------
cpGrid(){
gnuplot&amp;lt;&amp;lt;EOF 
set ter &#39;png&#39; 
set out &#39;$i/cpUp.png&#39;
set xtics rotate by -45
set ytics rotate by -45
plot &amp;quot;$i/cpUp.txt&amp;quot; t &#39;cp&#39; w lp
EOF
}
# 执行函数
deleteDensity
fenLei
getFileIntoDirNew
blankEmptyLine
cal
plot
plotCp


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;http://dngood.blog.51cto.com/446195/703347&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;shell脚本集合1&lt;/a&gt;
&lt;a href=&#34;http://dngood.blog.51cto.com/446195/764563&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;shell脚本集合2&lt;/a&gt;
&lt;a href=&#34;http://dngood.blog.51cto.com/446195/1107458&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;shell脚本集合3&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>gnuplot的核心是plot</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/26/gnuplotde-he-xin-shi-plot/</link>
      <pubDate>Tue, 26 May 2015 23:48:15 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/26/gnuplotde-he-xin-shi-plot/</guid>
      <description>&lt;p&gt;gnuplot是一种科学绘图的开源软件，比origin强上不少。
而&lt;a href=&#34;http://orgmode.org/worg/org-contrib/babel/languages/ob-doc-gnuplot.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gnuplot的核心就是这个plot&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;数据表：&lt;/p&gt;
&lt;p&gt;注意 #+tblname:字段是emacs的org-mode可以识别的,可以通过#+begin_src 的:var data=data-table来引用这张表的数据。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+tblname: data-table
| x | y1 | y2 |
|---+----+----|
| 0 |  3 |  6 |
| 1 |  4 |  7 |
| 2 |  5 |  8 |
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外，本文一直会使用的引用emacs的babal_gnuplot在gnuplot当中的运用#begin_src gnuplot :var data=data-table :exports code :file foo.png分别代表的意思是&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;+ :var data=data-table
When data is to be plotted from a table, it is helpful to use a heading right above the table in the form #+tblname=data-table, where &amp;quot;data-table&amp;quot; is replaced with some short name to identify the table to gnuplot.
+ :exports {code, results, both, none}
When the code is run and the document exported (e.g. to HTML or \LaTeX PDF), what should appear? Just the code block itself? Only the produced output (in this case a plot of some sort)? Both the code and the accompanying results? Or nothing?
+ :file foo.{png,eps,etc.}
This option specifies where the resulting output should be put. If no option is given, a gnuplot window will open with the resultant plot. NOTE: Certain plot options may not output properly to gnuplot directly and thus must have the :file filename option in the header. If the error &amp;quot;Code block produced no output&amp;quot; recurs, try outputting to a file instead of directly to gnuplot.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外一个不需要记住的Named tics的写法如下&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;为了增加刻度标注&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;
set xtics (&amp;quot;Tic 1&amp;quot; -1, &amp;quot;Tic 2&amp;quot; 10, &amp;quot;Tic 3&amp;quot; 1001)
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;为了增加可读性&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;You can rotate tic marks for increased readability by specifying an angle at which to rotate their labels. Here is the syntax (substitute any angle value for -45):
set xtics rotate by -45
set ytics rotate by -45
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;为了阻止双轴&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;The gnuplot default is for tics to show up on both sides and the top and bottom of the graph. In other words, the tics on the left y-axis and bottom x-axis are &amp;quot;mirrored&amp;quot; to the opposing side of the plot borders. Stop this (tics only on left/bottom) by using:

set xtics nomirror
set ytics nomirror
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;步入正题--plot----the-core-of-the-gnuplot&#34;&gt;步入正题  Plot &amp;ndash; the core of the gnuplot&lt;/h1&gt;
&lt;h2 id=&#34;plot-what&#34;&gt;plot what?&lt;/h2&gt;
&lt;p&gt;function.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;f(x) = x**2
plot f(x)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;data.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;plot data using x:y
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;plot-how&#34;&gt;plot how?&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;plot data u 1:2 with lines
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;主要包括以下几种类型&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;points(p)&lt;/li&gt;
&lt;li&gt;dots(d)&lt;/li&gt;
&lt;li&gt;lines(l)&lt;/li&gt;
&lt;li&gt;linespoints(lp)&lt;/li&gt;
&lt;li&gt;impulses(i)&lt;/li&gt;
&lt;li&gt;steps&lt;/li&gt;
&lt;li&gt;boxes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当然你也可以使用(&amp;ndash;&amp;gt; 表示简写为)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lineweight &amp;ndash;&amp;gt; lw&lt;/li&gt;
&lt;li&gt;with &amp;ndash;&amp;gt; w&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;call-it-what&#34;&gt;call it what?&lt;/h2&gt;
&lt;p&gt;###你也可以给一张图加上title标题&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;plot data u 1:2 w lines lw 2 title &#39;Data Set 1&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;你也可以忽略一个plot的key使用notitle&#34;&gt;你也可以忽略一个plot的key，使用notitle&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;plot data u 1:2 w lines notitle, \
     data u 1:3 w points title &#39;Data Set 2&#39;, \
     data u 1:4 w lp title &#39;Data Set 3&#39;, \
     data u 1:5 w bars notitle
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这是一个相当重要的技巧。多组数据一起打印的时候，不需要打印所有的标题，这时候notitle特别有效，能让显示的时候特别清晰。&lt;/p&gt;
&lt;h2 id=&#34;any-more&#34;&gt;any more?&lt;/h2&gt;
&lt;p&gt;###想要多张图放在一起？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;f(x)=x**2
g(x)=x**3
h(x)=sqrt(x)
plot f(x),g(x),h(x)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;###想要打印一个表格？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;plot data u 1:2 w lines, data u 1:3 w points, \
data u 1:4 w lp

&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;很多例子&#34;&gt;很多例子&lt;/h1&gt;
&lt;p&gt;注意这边的 #+begin_src  #+end_src 是我在gnuplot的orgmode开启bable模式时候使用，具体你可以看一下&lt;a href=&#34;http://www.cnblogs.com/qlwy/archive/2012/06/15/2551034.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;如何在gnuplot使用org-mode&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;第一个函数打印&#34;&gt;第一个函数打印&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;#+begin_src gnuplot :exports code :file gnuplot.png
reset

set title &amp;quot;Putting it All Together&amp;quot;

set xlabel &amp;quot;X&amp;quot;
set xrange [-8:8]
set xtics -8,2,8


set ylabel &amp;quot;Y&amp;quot;
set yrange [-20:70]
set ytics -20,10,70

f(x) = x**2
g(x) = x**3
h(x) = 10*sqrt(abs(x))

plot f(x) w lp lw 1, g(x) w p lw 2, h(x) w l lw 3
#+end_src

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#+results:
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/gnuplot.png&#34; alt=&#34;gnuplot&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;basic-plot的数据表&#34;&gt;basic-plot的数据表&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+tblname:basic-plot
|   x |         y1 |         y2 |
|-----+------------+------------|
| 0.1 |      0.425 |      0.375 |
| 0.2 |     0.3125 |     0.3375 |
| 0.3 | 0.24999993 | 0.28333338 |
| 0.4 |      0.275 |    0.28125 |
| 0.5 |       0.26 |       0.27 |
| 0.6 | 0.25833338 | 0.24999993 |
| 0.7 | 0.24642845 | 0.23928553 |
| 0.8 |    0.23125 |     0.2375 |
| 0.9 | 0.23333323 |  0.2333332 |
|   1 |     0.2225 |       0.22 |

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;gnuplot中的打印basic-plot&#34;&gt;gnuplot中的打印basic-plot&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;#+begin_src gnuplot :var data=basic-plot :exports code :file table.png
set title &amp;quot;Putting it All Together&amp;quot;

set xlabel &amp;quot;X&amp;quot;
set xrange [0:1]
set xtics 0,0.1,1

set ylabel &amp;quot;Y&amp;quot;
set yrange [0.2:0.5]
set ytics 0.2,0.05,0.5
plot data u 1:2 w p lw 2 title &#39;x vs. y1&#39;, \
     data u 1:3 w lp lw 1 title &#39;x vx. y2&#39;
#+end_src
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;##xtics数据表&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+tblname:xtics
| Date      | Distance |
|-----------+----------|
| 8/25/2010 |      3.2 |
| 8/29/2010 |      3.0 |
| 9/1/2010  |      2.4 |
| 9/2/2010  |      2.5 |
| 9/5/2010  |      2.3 |
| 9//2010   |      2.0 |

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;gnuplot的gnuplot打印&#34;&gt;gnuplot的gnuplot打印&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;#+begin_src gnuplot :var data=xtics :exports code :file time.png
  reset

  set title &amp;quot;Running Stats&amp;quot;
  set xlabel &amp;quot;Date&amp;quot;
  set xtics rotate by -45
  set yrange [1:5]
  set ylabel &amp;quot;Distance (mi)&amp;quot;
  plot data u 2:xticlabels(1) w lp lw 2 notitle
#+end_src

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#+results:
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/time.png&#34; alt=&#34;time&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;表格加上标题&#34;&gt;表格加上标题&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+CAPTION: 表格的标题
| 1 | one                          |
| 2 | two                          |
| 3 | This is a long chunk of text |
| 4 | four                         |
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;|   | &amp;lt;6&amp;gt;    |
|---+--------|
| 1 | one    |
| 2 | two    |
| 3 | This=&amp;gt; |
| 4 | four   |
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;表格的特殊使用--用于统计&#34;&gt;表格的特殊使用  用于统计&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;| 数量 | 单价 |  总额 |
|------+------+-------|
|    2 | 3.55 |   6.9 |
|    4 | 4.34 | 17.36 |
|    5 | 3.44 |  17.2 |
|    5 |  5.6 |   28. |
#+TBLFM: $3=$1*$2

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;named-xtics-数据表&#34;&gt;named-xtics 数据表&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+caption: time-history
#+tblname: named-xtics
| tic name | x-value | Dead (y) | Live(l) |
|----------+---------+----------+---------|
| Civil    |    1861 |     0.62 |    0.63 |
| WWI      |    1914 |      9.8 |     9.9 |
| WWII     |    1939 |       24 |      25 |
| Nam      |    1955 |      1.5 |     1.6 |
| Gulf     |    1990 |     0.04 |    0.05 |
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;#+begin_src gnuplot :var data=named-xtics :exports code :file named.png
reset

set yrange [0:25]
set ylabel &amp;quot;Deaths (MM)&amp;quot;

set xtics (&amp;quot;1850&amp;quot; 1850, &amp;quot;2010&amp;quot; 2010)
set xrange [1850:2010]
set xlabel &amp;quot;Wars in Time&amp;quot;

set title &#39;War Deaths&#39;
  
plot data using 2:3:xticlabels(1) w p lw 3 t &#39;set1&#39;,\
     data u 2:4:xticlabels(1) title &#39;Set2&#39;
#+end_src
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#+results:
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/named.png&#34; alt=&#34;named-xtics&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;multi-axes数据表&#34;&gt;multi-axes数据表&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+tblname:multi-axes
| Date      |  Time | Distance |
|-----------+-------+----------|
| 8/25/2010 | 17:14 |      3.2 |
| 8/29/2010 | 14:00 |      2.4 |
| 9/1/2010  | 15:13 |      2.5 |
| 9/2/2010  | 13:45 |      2.3 |
| 9/5/2010  | 13:20 |      2.0 |
| 9//2010   | 16:35 |      2.8 |

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;#+begin_src gnuplot :var data=multi-axes :exports code :file multi.png
  reset

  set title &amp;quot;Running Stats&amp;quot;
  set size ratio square
  set key box linestyle -1

  set xlabel &amp;quot;Date&amp;quot;
  set xtics nomirror rotate by -45

  set yrange [9:21]
  set ylabel &amp;quot;Time (min)--Red&amp;quot;
  set ytics nomirror

  set y2range [1.5:3.5]
  set y2label &amp;quot;Distance (mi)--Green&amp;quot;
  set y2tics 0,0.5,3.5

  set style data points
  plot data u 2:xticlabels(1) axis x1y1 lw 3 title &#39;Time&#39;, \
       data u 3:xticlabels(1) axis x1y2 lw 3 title &#39;Distance&#39;
#+end_src
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#+results:
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/multi.png&#34; alt=&#34;multi-axes&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;diff-scales数据表&#34;&gt;diff-scales数据表&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+tblname:diff-scales
| tic name |    x-loc |  Pop |
|   10k BC | -10000 1 |      |
|          |    -9000 |    3 |
|          |    -8000 |    5 |
|          |    -7000 |    7 |
|          |    -6000 |   10 |
|          |    -5000 |   15 |
|          |    -4000 |   20 |
|          |    -3000 |   25 |
|          |    -2000 |   35 |
|          |    -1000 |   50 |
|          |     -500 |  100 |
|     AD 1 |        1 |  200 |
|     1000 |     1000 |  310 |
|     1750 |     1750 |  791 |
|     1800 |     1800 |  978 |
|     1850 |     1850 | 1262 |
|     1900 |     1900 | 1650 |
|     \&#39;50 |     1950 | 2519 |
|          |     1955 | 2756 |
|          |     1960 | 2982 |
|          |     1965 | 3335 |
|          |     1970 | 3692 |
|     \&#39;75 |     1975 | 4068 |
|          |     1980 | 4435 |
|          |     1985 | 4831 |
|          |     1990 | 5263 |
|          |     1995 | 5674 |
|          |     2000 | 6070 |
|     2005 |     2005 | 6454 |
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;#+begin_src gnuplot :var data=diff-scales :exports code :file scales.png
  reset

  set xrange [ -10000 : 1 ]
  set yrange [ 0 : 7000 ]
  set xlabel &amp;quot;Time&amp;quot;

  set multiplot

  set size 0.275,1
  set origin 0.0,0.0
  set lmargin 10
  set rmargin 0
  set ylabel &amp;quot;Population (MM)&amp;quot;
  set ytics nomirror
  plot data using 2:3:xticlabels(1) with lines lw 3 notitle

  set origin 0.275,0.0
  set size 0.15,1
  set format y &amp;quot;&amp;quot;
  set noytics
  set lmargin 0
  set rmargin 0
  set xrange [2 : 1750]
  set ylabel &amp;quot;&amp;quot;
  plot data using 2:3:xticlabels(1) with lines lw 3 notitle

  set origin 0.425,0.0
  set size 0.575,1
  set format y &amp;quot;&amp;quot;
  set noytics
  set lmargin 0
  set rmargin 2
  set xrange [1751 : 2005]
  set ylabel &amp;quot;&amp;quot;
  plot data using 2:3:xticlabels(1) with lines lw 3 notitle

  set nomultiplot
#+end_src
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#+results:
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/scales.png&#34; alt=&#34;scales&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;broken-axis-数据表&#34;&gt;broken-axis 数据表&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#+tblname: broken-axis
|  tic name | x-loc | Pre | Post |
| 10,000 BC |  1600 |   1 |      |
|           |  1650 |  15 |      |
|      AD 1 |  1700 | 200 |      |
|      1750 |  1750 |     |  791 |
|      1800 |  1800 |     |  978 |
|      1850 |  1850 |     | 1262 |
|      1900 |  1900 |     | 1650 |
|      \&#39;50 |  1950 |     | 2519 |
|           |  1955 |     | 2756 |
|           |  1960 |     | 2982 |
|           |  1965 |     | 3335 |
|           |  1970 |     | 3692 |
|      \&#39;75 |  1975 |     | 4068 |
|           |  1980 |     | 4435 |
|           |  1985 |     | 4831 |
|           |  1990 |     | 5263 |
|           |  1995 |     | 5674 |
|           |  2000 |     | 6070 |
|      2005 |  2005 |     | 6454 |

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-gnuplot&#34;&gt;#+begin_src gnuplot :var data=broken-axis :exports code :file broken.png
  reset

  A=1725
  B=1600
  C=2010
  D=0
  E=6500

  xoff=.005*(C-B)
  yoff=.02*(E-D)

  set arrow 1 from A-xoff, D to A+xoff, D nohead lw 2 lc rgb &amp;quot;#ffffff&amp;quot; front
  set arrow 2 from A-xoff, E to A+xoff, E nohead lw 2 lc rgb &amp;quot;#ffffff&amp;quot; front
  set arrow 3 from A-xoff-xoff, D-yoff to A+xoff-xoff, D+yoff nohead front
  set arrow 4 from A-xoff+xoff, D-yoff to A+xoff+xoff, D+yoff nohead front
  set arrow 5 from A-xoff-xoff, E-yoff to A+xoff-xoff, E+yoff nohead front
  set arrow 6 from A-xoff+xoff, E-yoff to A+xoff+xoff, E+yoff nohead front

  set xrange [B:C]
  set yrange [D:E]

  set xlabel &#39;Time&#39;
  set ylabel &#39;Population (MM)&#39;
  set title &#39;World Population&#39;

  plot data u 2:3:xticlabels(1) w l lw 3 notitle, data u 2:4:xticlabels(1) w l lw 3 lc 1 notitle

#+end_src
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/broken.png&#34; alt=&#34;broken&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>伟大的范畴理论</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/21/wei-da-de-fan-chou-li-lun/</link>
      <pubDate>Thu, 21 May 2015 20:56:51 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/21/wei-da-de-fan-chou-li-lun/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://yogsototh.github.io/Category-Theory-Presentation/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;范畴理论&lt;/a&gt;是数学上的一种新的语言和框架结构.
对于程序员来说，它是另一种思考方式，一种极度有效的方式来提取规律(Extremely
efficient for generalization)
Programming is doing Math.编成的工作其实就是数学的工作。&lt;/p&gt;
&lt;p&gt;范畴是一种表达事物(things) 和路径(ways)  to go between things.
这可以参考&lt;a href=&#34;http://think-like-a-git.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;thinking like a git&lt;/a&gt;，因为他也是一种基于范畴理论，
而延伸出来的实际产物，方便程序员对于development的管理。&lt;/p&gt;
&lt;p&gt;A Category C is defined by:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Objects ob(C),&lt;/li&gt;
&lt;li&gt;Morphisms hom(C),&lt;/li&gt;
&lt;li&gt;a Composition law (∘)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Functor : (ob-&amp;gt;ob)
&lt;img src=&#34;http://yogsototh.github.io/Category-Theory-Presentation/categories/img/mp/functor.png&#34; alt=&#34;Functor part1&#34;&gt;&lt;/p&gt;
&lt;p&gt;Functor : (hom-&amp;gt;hom)
&lt;img src=&#34;http://yogsototh.github.io/Category-Theory-Presentation/categories/img/mp/functor-morphism.png&#34; alt=&#34;Functor part2&#34;&gt;&lt;/p&gt;
&lt;p&gt;Endofunctors:
&lt;img src=&#34;http://yogsototh.github.io/Category-Theory-Presentation/categories/img/mp/functor-morphism.png&#34; alt=&#34;自指&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://yogsototh.github.io/Category-Theory-Presentation/categories/img/fractalcat.jpg&#34; alt=&#34;一只可爱的猫&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;categories-and-functors-form-a-category-cat&#34;&gt;Categories and functors form a category: Cat&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ob(Cat) are categories&lt;/li&gt;
&lt;li&gt;hom(Cat) are functors&lt;/li&gt;
&lt;li&gt;∘ is functor composition&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;a-haskell-functor-is-a-type-f------which-belong-to-the-type-class-functor--thus-instantiate-fmap--a---b---f-a---f-b&#34;&gt;A Haskell Functor is a type F :: * -&amp;gt; * which belong to the type class Functor ; thus instantiate fmap :: (a -&amp;gt; b) -&amp;gt; (F a -&amp;gt; F b).&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;F: ob(Hask)→ob(Hask)&lt;/li&gt;
&lt;li&gt;&amp;amp; fmap: hom(Hask)→hom(Hask)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;the-couple-ffmap-is-a-hasks-functor-if-for-any-x--f-a&#34;&gt;The couple (F,fmap) is a Hask&amp;rsquo;s functor if for any x :: F a:&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;fmap id x = x
fmap (f.g) x= (fmap f . fmap g) x
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>HaskellWiki</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/21/haskellwiki/</link>
      <pubDate>Thu, 21 May 2015 13:01:13 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/21/haskellwiki/</guid>
      <description>&lt;p&gt;一些常用的资料查询地。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.haskell.org/haskellwiki/Category:Tutorials&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;130 tutorials&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.haskell.org/haskellwiki/Category:Mathematics&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;46 articles on mathematicas&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.haskell.org/haskellwiki/Category:FAQ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;46 FAQ topics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.haskell.org/haskellwiki/Category:Community&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;186 articles on other Haskell communities&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://stackoverflow.com/questions/tagged?tagnames=haskell&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Stackoverflow:more than 10,000 problems discussed&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.reddit.com/r/haskell/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Reddit:类似于google group (more than 10,000 subbscribers)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://hackage.haskell.org/packages/archive/pkg-list.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Hackage 最终的收集网址&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.haskell.org/hoogle/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Hoogle:Haskell字典&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Haskell库文档结构</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/21/haskellku-wen-dang-jie-gou/</link>
      <pubDate>Thu, 21 May 2015 12:27:42 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/21/haskellku-wen-dang-jie-gou/</guid>
      <description>&lt;pre&gt;&lt;code&gt;/src
Folder for source-code
Setup.hs
Haskell build script
app.cabal
Cabal build script
README
Informative text file
LICENCE
Software licence statement
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下面是我的建立过程:&lt;/p&gt;
&lt;h2 id=&#34;1新建一个hello文件夹在hello文件夹新建一个src&#34;&gt;1新建一个HELLO文件夹,在HELLO文件夹新建一个src&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;mkdir HELLO
cd HELLO
mdkir src
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2-mainhs--在src内新建一个mainhs&#34;&gt;2 main.hs  在src内新建一个main.hs&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;module Main where

import Control.Monad

main=do
  putStrLn &amp;quot;Quit? y/n&amp;quot;
  ans &amp;lt;- getLine
  when (ans /= &amp;quot;y&amp;quot;) $ do
       putStrLn &amp;quot;not quiting&amp;quot;
       main
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3-cabal-init&#34;&gt;3 cabal init&lt;/h2&gt;
&lt;p&gt;Return to the* top* directory, and run cabal init.
It helps you fill out the following information:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Package name&lt;/li&gt;
&lt;li&gt;Package version&lt;/li&gt;
&lt;li&gt;License&lt;/li&gt;
&lt;li&gt;Author name&lt;/li&gt;
&lt;li&gt;Maintainer email&lt;/li&gt;
&lt;li&gt;Project homepage URL&lt;/li&gt;
&lt;li&gt;Project synopsis&lt;/li&gt;
&lt;li&gt;Build type&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal init
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/CGenie/haskell-snake/blob/master/snake.cabal&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;一个填写模板&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;至此现在你的文件结构应该是&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;$ tree
.
|-- HELLO.cabal
|-- LICENSE
|-- Setup.hs
`-- src
    `-- Main.hs

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;现在你就可以分享你的程序，而如果你要安装，则可以继续看下面简单操作&lt;/p&gt;
&lt;p&gt;Run +cabal install+ at the project directory
然后就会把你的执行程序放在~/.cabal/bin中了&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal install
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一定要注意 修改HELLO.cabal中的main-is,不要注释他，默认是注释
并且填入src的主文件名 Main.hs&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;

executable HELLO
  -- .hs or .lhs file containing the Main module.
   main-is: Main.hs            一定要补好，否则cabal install 失败
  
  -- Modules included in this executable, other than Main.
  -- other-modules:       
  
  -- Other library packages from which modules are imported.
  build-depends:       base ==4.6.*
  
  -- Directories containing source files.
  hs-source-dirs:      src
  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果是：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;$ cabal install
Resolving dependencies...
Configuring HELLO-1.0.0...
Building HELLO-1.0.0...
Preprocessing executable &#39;HELLO&#39; for HELLO-1.0.0...
[1 of 1] Compiling Main             ( src/Main.hs, dist/build/HELLO/HELLO-tmp/Main.o )
Linking dist/build/HELLO/HELLO ...
Installing executable(s) in /home/javazhao/.cabal/bin
Installed HELLO-1.0.0

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;此时的文档结构如下:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;$ tree
.
|-- dist
|   |-- build
|   |   |-- autogen
|   |   |   |-- cabal_macros.h
|   |   |   `-- Paths_HELLO.hs
|   |   `-- HELLO
|   |       |-- HELLO
|   |       `-- HELLO-tmp
|   |           |-- Main.hi
|   |           `-- Main.o
|   |-- package.conf.inplace
|   `-- setup-config
|-- HELLO.cabal
|-- LICENSE
|-- Setup.hs
`-- src
    `-- Main.hs
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一些额外知识：&lt;/p&gt;
&lt;p&gt;Open up Main.hs and add some documentation
&amp;ndash; | is the syntax for documenting function type signature, type declaration, or class declaration,记住&amp;ndash;和|中间有一个空格&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;module Main where

-- |This is the main function
main :: IO()
main = do
  putStrLn &amp;quot;What&#39;s your name?&amp;quot;
  name &amp;lt;- getLine
  putStrLn (&amp;quot;Hi &amp;quot; ++ name)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后就可以使用Haddock(前提是你运行了cabal install,这样你的文件夹下才有dist)
Haddock is a documentation engine&lt;/p&gt;
&lt;p&gt;首先需要安装alex：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal install alex
Linking dist/build/alex/alex ...
Installing executable(s) in /home/javazhao/.cabal/bin
Installed alex-3.1.4

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后安装happy&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal install happy

Linking dist/build/happy/happy ...
Installing executable(s) in /home/javazhao/.cabal/bin
Installed happy-1.19.5

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后安装haddock：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal install haddock
Linking dist/build/haddock/haddock ...
Installing library in /home/javazhao/.cabal/lib/haddock-2.13.2.1/ghc-7.6.3
Installing executable(s) in /home/javazhao/.cabal/bin
Registering haddock-2.13.2.1...
Installed haddock-2.13.2.1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后运行结果&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt; cabal haddock --executables
$ cabal haddock --executables 
Running Haddock for HELLO-1.0.0...
Preprocessing executable &#39;HELLO&#39; for HELLO-1.0.0...
Warning: The documentation for the following packages are not installed. No
links will be generated to these packages: base-4.6.0.1, rts-1.0,
ghc-prim-0.3.0.0, integer-gmp-0.5.0.0
Haddock coverage:
  50% (  1 /  2) in &#39;Main&#39;
Warning: Main: could not find link destinations for:
    GHC.Types.IO
Documentation created: dist/doc/html/HELLO/HELLO/index.html

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后你的文档就会存在dist/doc/html/HELLO/HELLO/index.html
这其实就是官网的那些类库网页的的产生方式.&lt;/p&gt;
&lt;p&gt;最终的文档结构：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;$ tree
.
|-- dist
|   |-- build
|   |   |-- autogen
|   |   |   |-- cabal_macros.h
|   |   |   `-- Paths_HELLO.hs
|   |   `-- HELLO
|   |       |-- HELLO
|   |       `-- HELLO-tmp
|   |           |-- Main.hi
|   |           `-- Main.o
|   |-- doc
|   |   `-- html
|   |       `-- HELLO
|   |           `-- HELLO
|   |               |-- doc-index.html
|   |               |-- frames.html
|   |               |-- haddock-util.js
|   |               |-- HELLO.haddock
|   |               |-- hslogo-16.png
|   |               |-- index-frames.html
|   |               |-- index.html
|   |               |-- Main.html
|   |               |-- mini_Main.html
|   |               |-- minus.gif
|   |               |-- ocean.css
|   |               |-- plus.gif
|   |               `-- synopsis.png
|   |-- package.conf.inplace
|   `-- setup-config
|-- HELLO.cabal
|-- LICENSE
|-- Setup.hs
`-- src
    `-- Main.hs

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;一个提醒httpswwwhaskellorghaddockdochtmlmarkuphtmlid564988-&#34;&gt;&lt;a href=&#34;https://www.haskell.org/haddock/doc/html/markup.html#id564988&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;一个提醒&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;以后写代码的时候，一定要注意标注&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用&amp;ndash; |&lt;/li&gt;
&lt;li&gt;使用{- -} 针对快注释&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://www.haskell.org/haddock/doc/html/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;一个链接关于haddock的用户指南&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Haskell common type signature(synopsis)</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/21/haskell-common-type-signature-synopsis/</link>
      <pubDate>Thu, 21 May 2015 10:54:48 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/21/haskell-common-type-signature-synopsis/</guid>
      <description>&lt;p&gt;Haskell是一门很深的(deep)语言，需要经常去考究，下面有一些渠道可以
经常去查阅类型的推理过程。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.haskell.org/onlinereport/standard-prelude.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Standard Prelude&lt;/a&gt;包含着基本的Preude加载的模块，类，函数等，相当具体。
现在终于发现haskell的&lt;a href=&#34;http://zhiwei.li/text/2011/04/real-world-haskell-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%9E%8B%E7%B1%BB/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;类型类&lt;/a&gt;其实就是抽象类或者比抽象类更抽象的接口类，通过class来定义(在java中无论是抽象类还是实体类都使用class,现在haskell区分来class定义抽象类或者接口类,date定义实体类)&lt;/p&gt;
&lt;p&gt;必须经常去查查这些函数的实现&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base/Data-Char.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Data.Char&lt;/a&gt; 100多个&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base/Data-List.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Data.List&lt;/a&gt; 200多个&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://downloads.haskell.org/~ghc/6.12.2/docs/html/libraries/containers-0.3.0.0/Data-Map.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Data.Map&lt;/a&gt; 200多个&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://downloads.haskell.org/~ghc/6.4.1/docs/html/libraries/base/Data-Set.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Data.Set&lt;/a&gt;  100多个&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;还有其他350种以上这种类型。。。&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;一个问题我们必须为要进行比较的不同类型使用不同名字的函数这很低效且令人厌烦如果能够只使用-&#34;&gt;一个问题：我们必须为要进行比较的不同类型使用不同名字的函数。这很低效且令人厌烦。如果能够只使用 ==&lt;/h1&gt;
&lt;p&gt;来比较任何东西将方便很多。== 在实现像 /=
这样的泛型函数也很有用，几乎对任何事物都有效。有了一个可以比较任意事物的函数，我们可以让自己的代码更通用：如果一段代码只是需要比较一些事物，它就应该可以接受任意数据类型，编译器知道如何比较它们。并且，如果后来增加了新的数据类型，已有的代码不需要进行修改。&lt;/p&gt;
&lt;h2 id=&#34;类型类定义一组函数这些函数依赖于所给定的数据的类型可以有不同的实现类型类看上去可能像面向对象编程中的对象但是它们确实很不相同&#34;&gt;类型类定义一组函数，这些函数依赖于所给定的数据的类型可以有不同的实现。类型类看上去可能像面向对象编程中的对象，但是它们确实很不相同。&lt;/h2&gt;
&lt;p&gt;让我们用类型类来解决本章前面的相等性测试的难题。首先，必须定义类型类本身。我们想要一个函数，它接受两个相同类型的参数并返回一个Bool值来表示两个参数是否相等。我们不关心参数的类型是什么，只是需要这种类型的两个项。这是我们的类型类的第一个定义：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;— file: ch06/eqclasses.hs
class BasicEq a where
   isEqual :: a -&amp;gt; a -&amp;gt; Bool
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这里声明了一个名为BasicEq的类型类，用字母a表示实例的类型。这个类型类的实例是任何实现了其中所定义的函数的类型。这个类型类定义了一个函数。这个函数取两个参数－都是这种实例的类型－并且返回一个Bool值。&lt;/p&gt;
&lt;p&gt;Haskell的类型类被设计来做这些事情。
Haskell中定义类型类的关键字是 class。不幸的是这可能会让来自面向对象编程的人们搞混，因为我们所说的并不是一回事！
第一行里面参数名a是任意选择的。可以用任何名字。关键点是，在函数中要列出类型时，必须用实例的名字。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://zhiwei.li/text/2011/04/real-world-haskell-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%9E%8B%E7%B1%BB/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;一些数值算子&lt;/a&gt;：&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;numeric-类型&#34;&gt;Numeric 类型&lt;/h1&gt;
&lt;p&gt;Haskell有一组非常强大的数字类型。从快速的32位或64位整数到任意精度的有理数都可以使用。你可能已经知道了像这样的操作符可以对所有这些类型使用。这个特性是用类型类实现的。作为附加的好处，它允许你定义自己的数字类型，并把它作为Haskell中的一等公民。&lt;/p&gt;
&lt;p&gt;在开始讨论数字类型时，先查看下这些类型本身。表6-1
“Numeric类型精选”描述了Haskell中最常用的数字类型。注意还有些其他的数字类型可用，用来实现与C交互等特定用途。&lt;/p&gt;
&lt;p&gt;###Table 6.1. Numeric 类型精选&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/rwh61.png&#34; alt=&#34;table6-1&#34;&gt;&lt;/p&gt;
&lt;p&gt;这些是相当多不同的数字类型。有一些像相加这样的操作，可以用在所有这些类型上。还有其他的入
asin，只用在浮点数类型上。表6－2“Numeric函数和常量精选”里总结了操作不同数字类型的函数，表6-3
“Numeric类的类型类实例”将类型与它们相应的类型类进行匹配。在读这个表时，记住Haskell的操作符只是函数： (+) 2 3 或者
2 + 3 结果都一样。按照习惯，把操作符作为函数时，写在括号里。&lt;/p&gt;
&lt;p&gt;###Table 6.2. “Numeric函数和常量精选”&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/rwh62.png&#34; alt=&#34;table6-2&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/rwh621.png&#34; alt=&#34;table6-2-1&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/rwh622.png&#34; alt=&#34;table6-2-2&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/rwh63.png&#34; alt=&#34;table6-3&#34;&gt;
经常需要在数字类型之间进行转换。表6-2
“”列出了很多可以用来做转换的函数。然而如何在任意两个类型间进行转换并不总是显而易见的。表6-4“在Numeric类型间转换”提供了如何在不同类型间转换的信息。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/rwh64.png&#34; alt=&#34;table6-4&#34;&gt;
可以用 round, ceiling 或者 floor 替代 truncate。&lt;/p&gt;
&lt;p&gt;在“扩展实例：Numeric类型”一节有其他的例子演示如何使用这些数字类型类。
相等性，顺序性，及比较我们已经说过了算术操作符如 + 可以用在所有不同的数字上。但是Haskell里还有些更加广泛的操作符。最明显的当然是相等性测试： == 和
/=。这些操作符定义在 Eq 类里。&lt;/p&gt;
&lt;p&gt;还有 &amp;gt;= 和 &amp;lt;= 这样的比较操作符。它们在 Ord
类型类中声明。它们在单独的类型类中，是因为有些类型如Handle，可以做相等性测试，但是没有办法表达特定的顺序。所有Ord的实例都可以用
Data.List.sort 来排序。&lt;/p&gt;
&lt;p&gt;几乎所有的Haskell类型都是Eq的实例，并且大部分是Ord的实例。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>One-parameter-Or-many-parameters?</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/21/one-parameter-or-many-parameters/</link>
      <pubDate>Thu, 21 May 2015 00:12:30 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/21/one-parameter-or-many-parameters/</guid>
      <description>&lt;p&gt;I have a &lt;strong&gt;question&lt;/strong&gt; about how to call the function when
we see the type declartion.我有一个关于阅读函数声明时候，如何调用函数的疑问。
比如:&lt;/p&gt;
&lt;p&gt;f :: (Double,Double,Double) -&amp;gt; (Double,Double)
It is one parameter, but it must be a tuple with three tuple elements&lt;/p&gt;
&lt;p&gt;::Double-&amp;gt;Double-&amp;gt;Double
&lt;strong&gt;What does it mean?&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;areAsceneding :: Integer-&amp;gt;Integer-&amp;gt;Integer-&amp;gt;Bool
areAsceneding a b c=a&amp;lt;b &amp;amp;&amp;amp; b&amp;lt;c

areasceneding 1 2 3
--get true
areasceneding 1 4 2
--get false
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Actually ,multiply parameter can changed into one parameter method by
currying!!&lt;/p&gt;
&lt;p&gt;You must care about the () means tuple data structure.
[] means list  data structure.&lt;/p&gt;
&lt;h2 id=&#34;绑定bindinghttpwwwjdoncomideahaskellhtml&#34;&gt;&lt;a href=&#34;http://www.jdon.com/idea/haskell.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;绑定Binding&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;　　Haskell使用=实现绑定，前面我们说=是引用透明的案例，是一种数学意义，实际是将两者绑定了。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;x = 2                   -- 两个连字符号表示注解

y = 3                   --    
main = let z = x + y    -- let 引入一个本地绑定
       in print z       -- 程序将打印 5
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Binding名称不能大写，绑定可以定义一个或多个参数的函数，函数和参数使用空格，这是Haskell区别其他语言的简洁之处：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;add arg1 arg2 = arg1 + arg2 -- 定义函数add
five = add 2 3 -- 调用函数add

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;　　括号可以包装复合表达式：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;bad = print add 2 3 -- error! (打印只能有一个参数)
main = print (add 2 3) -- ok, 使用一个参数5作为打印参数
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;变量是不可变的&#34;&gt;变量是不可变的&lt;/h2&gt;
&lt;p&gt;　　与命令式语言变量不同,Haskell绑定变量 不可变的：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;x = 5
x = 6 -- 错误, 不能再绑定x,但是在let中则是不一样
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;类型有下面几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bool - 有两个元素： True 或 False&lt;/li&gt;
&lt;li&gt;Char - unicode符合集合&lt;/li&gt;
&lt;li&gt;Int - 固定大小整数&lt;/li&gt;
&lt;li&gt;Integer - 无限大小整数&lt;/li&gt;
&lt;li&gt;Double - IEEE 浮点数字&lt;/li&gt;
&lt;li&gt;type1 -&amp;gt; type2 - 一个输入类型type1 到输出类型 type2的函数&lt;/li&gt;
&lt;li&gt;(type1, type2, &amp;hellip;, typeN) - 类型数组tuple&lt;/li&gt;
&lt;li&gt;() - 零数组tuple, 称为unit (类似C的void); 这个类型只有一个值：空。&lt;/li&gt;
&lt;li&gt;[Char]-&amp;gt; means  list pk tuple.&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>Haskell-someImportantResource</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/20/haskell-someimportantresource/</link>
      <pubDate>Wed, 20 May 2015 22:38:05 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/20/haskell-someimportantresource/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;The most important is:&lt;a href=&#34;hackage.haskell.org&#34;&gt;Hackage-haskell-Official&lt;/a&gt;
Maintains a central repository of open source Hakell libraries called Hackage.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.haskell.org/hoogle&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;The hoogle-the haskell dictionary&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://haskell.org/haskelwiki/Applications_and_libraries&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;The hackage-wiki&lt;/a&gt;
contains a section dedicated to information about particular Haskell libraries&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;rwh.readthedocs.org/en/latest&#34;&gt;一个中文Real-world-haskell翻译&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用Cabal，一个命令行的安装工具，类似vim的bundles Install，ubuntu的apt-get install, redhat的yum install *等，来安装
你需要的haskell的包和依赖
比如 安装HTTP library&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal install HTTP
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;cabal四个阶段：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fetches 获取&lt;/li&gt;
&lt;li&gt;configures 配置&lt;/li&gt;
&lt;li&gt;compiles 编译&lt;/li&gt;
&lt;li&gt;installs 安装&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以安装HTTP库（一般库也是一样)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Refresh the list
Download the recent list of packages&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal update
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Install the package
find any package from Hackage&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;cabal install HTTP
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Use
Cabal takes care of installing the package. The library can now be imported&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;---new file.hs
import Network.HTTP
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;使用&lt;a href=&#34;hackage.haskell.org/packages/HTTP&#34;&gt;hackage.haskell.org/packages/HTTP&lt;/a&gt;查看HTTP的使用方式
可以查看这个网页下的 Modules Network 包含着一些相关的函数。
比如我们点击，Network.HTTP就会给我们一个详细的函数使用说明的网页，他接受什么类型，返回什么类型。
SimpleHTTP 接受一个Request 对象，然后返回一个IO Monad。&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;Prelude Network.HTTP&amp;gt; import Network.HTTP
Prelude Network.HTTP&amp;gt; :t simpleHTTP
simpleHTTP
:: HStream ty =&amp;gt;
 Request ty -&amp;gt; IO (Network.Stream.Result (Response ty))
Prelude Network.HTTP&amp;gt; let myRequest=getRequest &amp;quot;http://www.baidu.com&amp;quot;
Prelude Network.HTTP&amp;gt; simpleHTTP myRequest &amp;gt;&amp;gt;= getResponseBody 
就会得到很多的内容！！！
&amp;gt;&amp;gt;=是什么玩意！！
Prelude Network.HTTP&amp;gt; :t (&amp;gt;&amp;gt;=)
(&amp;gt;&amp;gt;=) :: Monad m =&amp;gt; m a -&amp;gt; (a -&amp;gt; m b) -&amp;gt; m b
&amp;gt;&amp;gt;=其实就是网络编程的bind操作（绑定端口）

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Actually, go to &lt;a href=&#34;https://wiki.haskell.org/Haskell&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://wiki.haskell.org/Haskell&lt;/a&gt;, you will get resources you want.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Thinking about the dot symbol in haskell</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/20/thinking-about-the-dot-symbol-in-haskell/</link>
      <pubDate>Wed, 20 May 2015 17:30:36 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/20/thinking-about-the-dot-symbol-in-haskell/</guid>
      <description>&lt;p&gt;In haskell you can use () to embrace the function into an application&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;not odd 4   --&amp;gt;error
not (odd 4) --&amp;gt;right
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;you can also use $ (called a function application),it makes functions right
associative.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;not $ odd 4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;but more pretty and elegant method is use .&lt;/p&gt;
&lt;p&gt;It composes functions in a readable manner
f(g(h(k(x)))) is ugly
(f.g.h.k)(x) is pretty&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;(not.odd) 4
(length.head.words) &amp;quot;university of NCEPU&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Haskell&amp;rsquo;s all functions&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Data.List&lt;/li&gt;
&lt;li&gt;Data.Char&lt;/li&gt;
&lt;li&gt;Data.Map&lt;/li&gt;
&lt;li&gt;Data.Set
&amp;hellip;..and more than 350 others&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;in-the-datalist-module&#34;&gt;In the Data.List module:&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;Main Data.List&amp;gt; concat [&amp;quot;under&amp;quot;,&amp;quot;stand&amp;quot;,&amp;quot;ing&amp;quot;]
&amp;quot;understanding&amp;quot;
Main Data.List&amp;gt; any (==0) [1,1,1,1,1,0,0]
True
Main Data.List&amp;gt; sort &amp;quot;helo&amp;quot;
&amp;quot;ehlo&amp;quot;

--And over 200 more!
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;also-there-are-datachar&#34;&gt;Also there are Data.Char&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;Main Data.List&amp;gt; import Data.Char
Main Data.List Data.Char&amp;gt; isNumber &#39;h&#39;
False
Main Data.List Data.Char&amp;gt; toUpper &#39;t&#39;
Main Data.List Data.Char&amp;gt; Data.List.map ord [&#39;A&#39;..&#39;F&#39;]
[65,66,67,68,69,70]

--and over 100 more!
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;there-are-also-some-in-datamap&#34;&gt;There are also some in Data.Map&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;
Main Data.List Data.Char&amp;gt; import Data.Map
Main Data.List Data.Char Data.Map&amp;gt; let m = fromList[(&amp;quot;CS&amp;quot;,&amp;quot;Computer Science&amp;quot;),(&amp;quot;TLS&amp;quot;,&amp;quot;The Little Scheme&amp;quot;),(&amp;quot;TSS&amp;quot;,&amp;quot;The Season Scheme&amp;quot;)]
Main Data.List Data.Char Data.Map&amp;gt; m
fromList [(&amp;quot;CS&amp;quot;,&amp;quot;Computer Science&amp;quot;),(&amp;quot;TLS&amp;quot;,&amp;quot;The Little Scheme&amp;quot;),(&amp;quot;TSS&amp;quot;,&amp;quot;The Season Scheme&amp;quot;)]
Main Data.List Data.Char Data.Map&amp;gt; keys m
[&amp;quot;CS&amp;quot;,&amp;quot;TLS&amp;quot;,&amp;quot;TSS&amp;quot;]


Main Data.List Data.Char Data.Map&amp;gt; Data.Map.lookup &amp;quot;CS&amp;quot; m
Just &amp;quot;Computer Science&amp;quot;

and over 200 more!!!!
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;we-can-continue-see-dataset&#34;&gt;We can continue see Data.Set&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;
Main Data.List Data.Char Data.Map Data.Set&amp;gt; let a =Data.Set.fromList[1..58]
Main Data.List Data.Char Data.Map Data.Set&amp;gt; let b =Data.Set.fromList[53..100]
Main Data.List Data.Char Data.Map Data.Set&amp;gt; Data.Set.intersection a b
fromList [53,54,55,56,57,58]

Main Data.List Data.Char Data.Map Data.Set&amp;gt; Data.Set.findMax $ Data.Set.union a b
100

--and even 100 more
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;There are one problem: Some function multiple definition in the Data.List and Data.Map,So take note!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Solve the strong passwd&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;
strong x = length x &amp;gt; 14
           &amp;amp;&amp;amp; any isLower x
           &amp;amp;&amp;amp; any isUpper x
            &amp;amp;&amp;amp; any isDigit x


-- Designed by Jared Candelaria

--import Data.Char

strong :: String -&amp;gt; Bool
strong password = all ($ password) requirements
    where
        requirements = [minLength 15, 
                        any isUpper, 
                        any isLower, 
                        any isDigit]
        minLength n str = n &amp;lt;= length str
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>HaskellModule</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/20/haskellmodule/</link>
      <pubDate>Wed, 20 May 2015 13:49:57 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/20/haskellmodule/</guid>
      <description>&lt;p&gt;Reference &lt;a href=&#34;http://www.shuklan.com/haskell/lec05.html#/0/21&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;模块化，这样才能方便构建较大型的项目，解决更加复杂的问题。
其中MyData.hs是模块文件
注意，模块中添加类型时候使用(..);
添加函数时候直接使用函数名
TestMyData.hs是测试模块文件&lt;/p&gt;
&lt;p&gt;##基本语法结构：
module MyData
(  类型(..) &amp;hellip;.
函数名 &amp;hellip;)
where
类型声明 &amp;hellip;
函数声明 &amp;hellip;&lt;/p&gt;
&lt;p&gt;注意 MyData.hs一定是和module后面的MyData一样的！&lt;/p&gt;
&lt;h2 id=&#34;调用方式&#34;&gt;调用方式&lt;/h2&gt;
&lt;p&gt;import MyData&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;MyData.hs&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;module MyData
(MetricUnit(..),
    ImperialUnit(..),
    Measurement(..),
    convert
) where
-- How to use this module
-- new File Test.hs  
--    import MyData
--    reportMeasurement :: Measurement-&amp;gt;String
--    reportMeasurement (MyData.MetricMeasurement x u)
--    = (show  x) ++ &amp;quot; &amp;quot; ++ (show u)
--    reportMesuarement m
--    =reportMeasurement (convert m)
-- N.B. If there are another file use Meter type,it will fail
-- 1
data MetricUnit = Meter|Liter|KiloGram deriving (Show,Eq)
-- 2
data ImperialUnit = Yard
                    | Gallon
                    | Pound 
                    deriving (Show,Eq)
-- 3
data Measurement = MetricMeasurement Double MetricUnit
                    | ImperialMeasurement Double ImperialUnit
                   deriving (Show)   --If not,it will not show,Only
                            --in the type defition,but not function

-- 4
convert :: Measurement-&amp;gt; Measurement
-- Take attention for the () brace
convert (MetricMeasurement x u)
        | u == Meter  = ImperialMeasurement (1.0936*x) Yard
        | u == Liter  = ImperialMeasurement (0.2642*x) Gallon
        | u == KiloGram = ImperialMeasurement (2.2046*x) Pound
--wrong!
--        | u == &amp;quot;Meter&amp;quot;  = ImperialMeasurement (1.0936*x) Yard
--        | u == &amp;quot;Liter&amp;quot;  = ImperialMeasurement (0.2642*x) Gallon
--        | u == &amp;quot;KiloGram&amp;quot; = ImperialMeasurement (2.2046*x) Pound
convert (ImperialMeasurement x u)
        | u == Yard  = MetricMeasurement (0.9144*x) Meter
        | u == Gallon  = MetricMeasurement (3.7854*x) Liter
        | u == Pound = MetricMeasurement (0.4536*x) KiloGram


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;TestMyData.hs
&lt;em&gt;注意，一定不要把Measurement-写成了  Mesuarement等错误的文字&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;import MyData
reportMeasurement :: Measurement-&amp;gt;String
reportMeasurement (MyData.MetricMeasurement x u)
                = (show x) ++ &amp;quot; &amp;quot; ++ (show u)
reportMeasurement m =reportMeasurement (convert m)
--reportMeasurement (MyData.ImperialMeasurement x u)
--                = (show x) ++ &amp;quot; &amp;quot; ++ (show u)
---if imperial    let m = MetricMeasuremnt 2 Meter ...



&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;运行结果&#34;&gt;运行结果&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;--Main&amp;gt; reportMeasurement (convert (ImperialMeasurement 5 Pound))
--&amp;quot;2.268 KiloGram&amp;quot;
 
*Main&amp;gt; let m = ImperialMeasurement 5 Pound
*Main&amp;gt; reportMeasurement m
&amp;quot;2.268 KiloGram&amp;quot;

*Main&amp;gt; reportMeasurement (MetricMeasurement 5 Meter)
&amp;quot;5.0 Meter&amp;quot;

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Ubuntu gtk-fortran</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/19/ubuntu-gtk-fortran/</link>
      <pubDate>Tue, 19 May 2015 17:03:25 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/19/ubuntu-gtk-fortran/</guid>
      <description>&lt;p&gt;Fortran：一门古老的&lt;a href=&#34;http://micro.ustc.edu.cn/Fortran/ZJDing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;计算机数值科学计算语言&lt;/a&gt;,1950.&lt;/p&gt;
&lt;p&gt;Fortran的强项就是数值计算，图形编程是一个鸡肋所在，但是有时候又需要做一些图形的展示，借助于&lt;a href=&#34;http://www.gtk.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GTK+ project&lt;/a&gt;可以方便我们达到目的.&lt;/p&gt;
&lt;p&gt;GTK是c语言编写的源程序，运用到fortran需要相应的库转换,在github上找到一个&lt;a href=&#34;https://github.com/jueqingsizhe66/gtk-fortran&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gtk-fortran库&lt;/a&gt;.下面是ubuntu上面的搭建过程(windows 未实现,可以参考 gtk+makefile)&lt;/p&gt;
&lt;h2 id=&#34;ubuntu-搭建&#34;&gt;Ubuntu 搭建&lt;/h2&gt;
&lt;h3 id=&#34;环境搭建&#34;&gt;环境搭建&lt;/h3&gt;
&lt;p&gt;GTK3+是跨平台的，既可以在windows上使用，也可以在linux上使用
下面的代码可以直接打包进一个gtk.sh文件，直接运行sh gtk.sh进行安装&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#1 刚装好的Ubuntu系统中已经有GCC了，但是这个GCC几乎什么文件都不能编译，因为缺少一些必须的头文件，所以要安装build-essential这个软件包
sudo apt-get install build-essential
#2 安装GTK/GNOME开发环境  需要下载一系列的安装包，时间比较长
sudo apt-get install gnome-devel gnome-devel-docs 
#3 用于在编译GTK程序时自动找出头文件及库文件位置　　
sudo apt-get install pkg-config
#4安装 devhelp GTK文档查看程序 
sudo apt-get install devhelp
#5安装 gtk/glib 的API参考手册及其它帮助文档 
sudo apt-get install libglib2.0-doc libgtk2.0-doc
#6  安装基于GTK的界面GTK是开发Gnome窗口的c/c++语言图形库
sudo apt-get install glade libglade2-dev
##或者sudo apt-get install glade-gnome glade-common glade-doc 
#7安装gtk3.0 或者 将gtk+3.0所需的所有文件统通下载安装完毕 (安装时间较长)
sudo apt-get install libgtk3*

## 查看信息
# 查看 2.x 版本 
#pkg-config --modversion gtk+-3.0 
# 查看pkg-config的版本
#$pkg-config -version 
#查看是否安装了gtk 
#pkg-config --list-all | grep gtk 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个流程做完了，就可以进行gtk测试,当然仅仅是c语言的测试&lt;/p&gt;
&lt;h3 id=&#34;测试文件&#34;&gt;测试文件&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;//Helloworld.c

#include &amp;lt;gtk/gtk.h&amp;gt;  

int main(int argc,char *argv[])  
{  
    GtkWidget    *window;  
    GtkWidget    *label;  

    gtk_init(&amp;amp;argc,&amp;amp;argv);  

    /* create the main, top level, window */  
    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);  

    /* give it the title */  
    gtk_window_set_title(GTK_WINDOW(window),&amp;quot;Hello World&amp;quot;);  

    /* connect the destroy signal of the window to gtk_main_quit 
     * when the window is about to be destroyed we get a notification and 
     * stop the main GTK+ loop 
     */  
    g_signal_connect(window,&amp;quot;destroy&amp;quot;,G_CALLBACK(gtk_main_quit),NULL);  

    /* create the &amp;quot;Hello, World&amp;quot; label */  
    label = gtk_label_new(&amp;quot;GTK可以运行了！&amp;quot;);  

    /* and insert it into the main window */  
    gtk_container_add(GTK_CONTAINER(window),label);  

    /* make sure that everything, window and label, are visible */  
    gtk_widget_show_all(window);  

    /* start the main loop, and let it rest until the application is closed */  
    gtk_main();  

    return 0;  
}

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;编译&#34;&gt;编译&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;gcc -o Helloworld Helloworld.c `pkg-config --cflags --libs gtk+-3.0`
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;运行&#34;&gt;运行&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;./Helloworld

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果你得到一个小窗口&amp;quot;GTK可以运行了&amp;quot; 证明你的gtk环境是正确的。&lt;/p&gt;
&lt;p&gt;然后我们开始进一步配置gtk-fortran&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;下载
&lt;a href=&#34;https://github.com/jueqingsizhe66/gtk-fortran&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/jueqingsizhe66/gtk-fortran&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;编译&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;mkdir build
cd build

在gtk-fortran目录下：/home/happycamp-of-fortran/gtk-fortran/build
cmake ..
make 
make install

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;会得到如下结果:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;Install the project...
-- Install configuration: &amp;quot;release&amp;quot;
-- Installing: /usr/local/lib/libgtk-2-fortran.a
-- Installing: /usr/local/lib/libgtk-2-fortran.so.0.1
-- Installing: /usr/local/lib/libgtk-2-fortran.so
-- Installing: /usr/local/include/gtk-2-fortran/atk.mod
-- Installing: /usr/local/include/gtk-2-fortran/cairo.mod
-- Installing: /usr/local/include/gtk-2-fortran/gdk.mod
-- Installing: /usr/local/include/gtk-2-fortran/gdk_pixbuf.mod
-- Installing: /usr/local/include/gtk-2-fortran/g.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_container.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_button.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_entry.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_tree.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_menu.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_combobox.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_spin_slider.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_chooser.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_dialog.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_progress.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_accelerator.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_infobar.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_assistant.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_hl_misc.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_draw_hl.mod
-- Installing: /usr/local/include/gtk-2-fortran/gdk_pixbuf_hl.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_sup.mod
-- Installing: /usr/local/include/gtk-2-fortran/pango.mod
-- Installing: /usr/local/include/gtk-2-fortran/gdk_events.mod
-- Installing: /usr/local/include/gtk-2-fortran/gtk_os_dependent.mod
-- Installing: /usr/local/bin/gtk-2-fortran-modscan
-- Installing: /usr/local/share/gtk-fortran/gtk-2-fortran-index.csv
-- Installing: /usr/local/share/gtk-fortran/gtk-2-enumerators.lis
-- Installing: /usr/local/lib/pkgconfig/gtk-2-fortran.pc
-- Installing: /usr/local/share/man/man1/gtk-2-fortran-modscan.1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3: 测试软件
然后你就会发现
cd 到 /home/happycamp-of-fortran/gtk-fortran/examples
然后&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;root at javazhao-N53SM [19:27:20ä��午] in /home/happycamp-of-fortran/gtk-fortran/examples on git:master?
$ gfortran gtkhello2.f90 -o gtkhello2 `pkg-config --cflags --libs gtk-2-fortran` 

就可以了. 一定记住加入的是gtk-2-fortran 这个库。而不是gtk+-2.0或者gtk+-3.0,这两个库是针对c语言的。
$ ./gtkhello2 


&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>vim-haskell</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/18/vim-haskell/</link>
      <pubDate>Mon, 18 May 2015 14:04:37 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/18/vim-haskell/</guid>
      <description>&lt;p&gt;Haskell vim可以通过vimbar 安装到vim中。vimball是一个vim插件，可以很方便地帮你安装vba格式的插件。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/fudesign2008/article/details/7297949&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;直接用vim打开vba格式的文件，输入:so %即可安装&lt;/a&gt;，然后:q退出。&lt;/p&gt;
&lt;p&gt;删除插件也很方便，直接在vim里输入:RmVimball 插件名&lt;/p&gt;
&lt;p&gt;不用安装vimBall(vim7.3之后 自带)&lt;/p&gt;
&lt;p&gt;方法1：&lt;a href=&#34;http://projects.haskell.org/haskellmode-vim/vimfiles/haskellmode-20101118.vba&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Haskell vimmode安装文件下载&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;方法2：使用bundles&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;Bundle &#39;https://github.com/jueqingsizhe66/haskellmode-vim&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;安装说明&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;vim vbafiles&lt;/li&gt;
&lt;li&gt;:so %;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://projects.haskell.org/haskellmode-vim/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;configure vimrc&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;都需要配置docdir和browser，doc如果没有去windows底下的haskell phamtom拷贝一份&lt;/p&gt;
&lt;p&gt;windows:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;let g:haddock_browser=&amp;quot;E:\Program\ Files\Mozilla Firefox\firefox.exe&amp;quot;
let g:haddock_docdir=&amp;quot;C:\Program\ Files\Haskell\ Platform\2014.2.0.0\doc\html&amp;quot; 

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ubuntu :&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;
let g:haddock_browser=&amp;quot;/usr/bin/opera&amp;quot;
let g:haddock_docdir=&amp;quot;/home/happycamp-of-lisp/doc&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;最后建议还是emacs漂亮一些！&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>The-Little-Scheme-And-Part-Of-TSS</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/</link>
      <pubDate>Mon, 18 May 2015 09:25:11 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/</guid>
      <description>&lt;p&gt;这部分内容是我练习TLS和TSS的全部学习资料，里面有详细的记录和一些心路历程，以后慢慢修改。
总行数5800左右。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; I will introuduce The little scheme From the angles below
;;; 1:
;;;     why introuduce the concept
;;; 2:  
;;;     The main knowledge
;;; 3: 
;;;     Map-reduce 
;;;     .......
;;; 4:  How you describe the function works in  your own words? 
;;; 5:  How do you determine the output when you apply a function?Is it what you want?
;;;     no? why no?
;;;;Namely, Can you write down the definition of the function member? and its arguments
;;;     and refer to them as you go through the next group of questions????
;; Do not rush through this book! Read carefully
;;; From the introuduction chapter 
;;; else implicit said that if the condition is wrong do it recurly
;;;      also infer that after the recuring ,please go back to home along the Original road!
;;;  COns &#39;s function: save the buffer to the stack
;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;The first part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;
;;; The Basic operator
;;;   The primitive variables of scheme ::  car ,cdr(is pronounced as &amp;quot;could_er&amp;quot;,cons,  null? zero?
;;;                                         eq?(compare two non-numericas atoms),
;;;                                         or (or asks two questions,one at a time. If the first one is true
;;;                                         .Otherwise it asks the second question and answers with whatever the 
;;;                                         second question answers)
;;;                                         numbers,add1,sub1
;;;  COns &#39;s function: save the buffer to the stack
(define atom?
  (lambda (x)
    (and (not (pair? x)) (not (null? x)))))


;;;; New added after myracet1.rkt
;;;  I want to find ( a  h fd  fs)  but not ( a h (fd s) fs),so I want to create the lat?
;;;  can you describe what the function lat? does in your own words? *****************

;;;  lat? looks at each S-expression in a list ,in turn,and asks if each S-expression 
;;;  is an atom ,untill it runs out of S-expression. If it runs out without encountering 
;;;  a list,the value is #f. If it finds a list,the value is #f,false
;;;   What is the meaning of the question *else* ??  
;;;             *else* asks if else if true
;;;                is *else* true?  Yes,because the question else is always true!
;;;         so what is (else #f) means?  ----&amp;gt; as if else is true,If else is true--as it always is
;;; else implicit said that if the condition is wrong do it recurly
;;;      also infer that after the recuring ,please go back to home along the Original road!
;;;
;;;               --then the answer if #f ---false
;;;               In a word:   else is a question whose value is always (implicit)
(define lat?
  (lambda (l)
    (cond
      ((null? l) #t)
      ((atom? (car l)) (lat? (cdr l)))
      (else #f))))

;;;; New added after myracet1.rkt
;;;
(define &amp;gt;
  (lambda (n m)
    (cond 
      ((zero? n) #f)
      ((zero? m) #t)
      (else (&amp;gt; (sub1 n) (sub1 m))))))

;;; What is the maning of (&amp;gt; (sub1 n) (sub1 m))
;;;        Recur, but with both arguments reduced by one
(define dd
  (lambda (n m)
    (cond 
      ((zero? n) #f)
      ((zero? m) #t)
      (else (&amp;gt; (sub1 n) (sub1 m))))))

;;; Can you describe what leftmost does?
;;;      Here is our description:
;;;       &amp;quot;The function leftmost finds the leftmost atom in a non-empty list of S-expressions that does not
;;;       contain the empty list&amp;quot;
;;;
;;;       Is left a *-function?
;;;            It works on lists of S-expressions,but it only recurs on the car(so no)
;;;
;;;     Does leftmost need to ask questions about all three possible cases?
;;;       No,it only needs to ask two questions,We agreed that leftmost works on non-empty
;;;       list that don&#39;t contain empty list
;;;
;;;       So in a word,the two discussed before,1:recur in car(not together with cdr) 2:2 questions ,not 3 questions which S-expressions
;;;
;;;
;;;       Do you remember what (or ...) does?
;;;            (or as questions one at a time until it finds one that is true.Then (or ...) stops,making its value true.
;;;            If it cannot find a true argument,the value of (or...) is false
;;;
;;;     After so many illustration ,can you put in your own words what (and ....) does
;;;             We put in our words:(lispers&#39; words)
;;;             &amp;quot;(and ...) ask questions one at a time until it finds one whose value is false.Then (and ...) stops with false.
;;;              If none of the expressions are false,(and ...) is true.&amp;quot;
;;;
;;;     Both (and ...) and (or ...) can be expressed as abbreviations of (cond ...)-expressions:
;;;              (and a b) == (cond a b) (else #f))
;;;              (or a b) == (cond (a #t) (else b))
(define leftmost
  (lambda (l)
    (cond 
      ((atom? (car l)) (car l))
      (else (leftmost(car l))))))

(define rember
  (lambda (a lat)
    (cond 
      ((null? lat) (quote()))
      (else (cond
              ((eq? (car lat) a) (cdr lat))
              (else 
               (cons (car lat)
                     (rember a
                             (cdr lat)))))))))
;;; Can you write number? which is true if its argument is a numerica atom and false if it is anything else
;;;      No:number? like add1,sub1,zero?,car , cdr, cons,null?, eq?,and atom? is a primitive function
;;;
;;;      Can you write a function no-nums which gives as a final value a lat obtained by removing all the
;;;      numbers from the lat.

;;; Remember to use = for numbers
;;;                 eq? for all other atoms(non-numericas atoms)
;;;     eqan? contains two part to compare the two atoms: 1 a number   2:an atom
;;;     Can you assume that all funtions written using eq? can be generalized by replacing eq?
;;;          By eqan?   ------------------Yes,excpet,of course ,for eqan? itself
(define eqan?
  (lambda (a1 a2)
    (cond
      ((and (number? a1) (number? a2))
       (= a1 a2))
      ((or (number? a1) (number? a2))
       #f)
      (else (eq? a1  a2)))))

;;;after the introuction of (and  (or   define leftmost
;;; What is eqlist?
;;;
;;;  It is a function that determines if two lists are equals
;;;
;;; How many questions will eqlist? have to ask about it arguments?
;;;             Nine  --------------------------------------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;The first time so many questions!
;;;
;;; Can you explain why there are nine questions?
;;;        Here are out words:
;;;         &amp;quot;Each arguments may be either
;;;             ----empty
;;;             ----an atom consed onto a list,or
;;;             ----a list consed onto a list
;;;        For example,at the same time as the first argument may be the empty list,the 
;;;              seconds argument could be the empty list or have an atom or a list in the car position.&amp;quot;
;;;
;;;         Is it okay to asK (atom? (car l2)) in the second question?
;;;               Yes ,because we know that the second  list cannot be empty.otherwise the first question would have been true.
;;;
;;;         And why is the third question (null? l1)???
;;;              At that point ,we know that when the firs argument is empty,the second argument is neither empty list
;;;              nor a list with an atom as the first element .If(null? l1) is true now,the second argument must be a list whose first element
;;;              is also a list.
;;;
;;;         Does this mean the questions (and (null? l1) (null? l2)) and (or (null? l1) (null? l2)) 
;;;                suffice to determine the answer in the first three cases?
;;;             Yes .If the first question is true,eqlist? respoinse with #t; otherwise ,the answer if #f
(define eqlist?
  (lambda (l1 l2)
    (cond 
      ((and (null? l1) (null? l2)) #t)
      ((and (null? l1) (atom? (car l2))) #f)
      ((null? l1) #f)
      ((and (atom? (car l1)) (null? l2)) #f)
      ((and (atom? (car l1)) (atom? (car l2)))
       (and (eqan? (car l1) (car l2)) (eqlist? (cdr l1) (cdr l2))))
      ((atom? (car l1)) #f)
      ((null? l2) #f)
      ((atom? (car l2)) #f)
      (else
       (and (eqlist? (car l1) (car l2))
            (eqlist? (cdr l1) (cdr l2)))))))
(define eqlist1?
  (lambda (l1 l2)
    (cond 
      ((and (null? l1) (null? l2)) #t)
      ((or (null? l1) (null? l2)) #f)
      ((and (atom? (car l1)) (atom? (car l2)))
       (and (eqan? (car l1) (car l2)) (eqlist1? (cdr l1) (cdr l2))))
      ((or (atom? (car l1))
           (atom? (car l2)))
       #f)
      (else
       (and (eqlist1? (car l1) (car l2))
            (eqlist1? (cdr l1) (cdr l2)))))))

;;; So  What is an S-expresssion? 
;;;                                    An S-expression is either an atom or a (possibly empty) list of S-expressions.
;;;
;;;      How many questions does equal? ask to determine whether two S-empty are the same?
;;;           Four. The first argument  may be an atom or a list of S-expressions at the same time as the second argument may be
;;;           an atom or a list of S-expressions.
;;; can we summarize the second questions and the third question of the equal? 
;;;   as   (or (atom? s1) (atom? s2))
;;;              Yes, we can


(define equal?
  (lambda (s1 s2)
    (cond
      ((and (atom? s1) (atom? s2)) 
       (eqan? s1 s2))
      ((atom? s1) #f)
      ((atom? s2) #f)
      (else
       (eqlist? s1 s2)))))

(define equal1?
  (lambda (s1 s2)
    (cond
      ((and (atom? s1) (atom? s2)) 
       (eqan? s1 s2))
      ((or (atom? s1) (atom? s1))
       #f)
      (else
       (eqlist? s1 s2)))))

;;; The sixth chapter:
;;;    Is 1,3,1+3,1+3*4,cookie,3^y_5 all arithmetic expression?  Yes ,of course
;;;
;;; What is an arithmetic expression? in your words?
;;;       In ours:
;;;         &amp;quot;For the purpose of this chapter,an arithmetic expression is either an atom
;;;         (including numbers),or two arithmetic expressions combined by +,-,*,/,or expr.
;;;
;;; Is (n+3) an arithmetic expression?
;;;        Not really,since there are parentheses around n+3, our definition of arithmetic
;;;        expression does not mention parentheses....
;;;
;;; Could we think of (n+3) as an arithmetic expression?
;;;        Yes if we keep in mind that the parentheses are not really there (the empire&#39;s new clothes)
;;;
;;; What would you call (n+3)  
;;;                   we call it a representation for n+3
;;;         why is (n+3) a good representation?
;;;                  Because 
;;;                          1. (n+3) is an S-expression. 
;;;                               It can therefore serve as an argument for a function
;;;                          2.It stucturally resembles n+3
;;;
;;; True or false: (numbered? x)  True while x is 1
;;;
;;; How do you represent 3+4*5  ?                      ------&amp;gt; (3+4*5)
;;;
;;; What is numbered?     
;;;                     It is a function that determines whether a representation? of an arithmetic expression 
;;;                      contains only number besides the +,* and expr
;;;
;;; Now you can write a skeleton for numbered?
;;;           (define numbered?
;;;           (lambda (axep)
;;;           (cond 
;;;           (_________   _________)
;;;           (_________   _________)
;;;           (_________   _________)
;;;           (_________   _________))))
;;;
;;; What is the first question?        --------------(atom? axep)
;;; What is (eq? (car (cdr aexp)) (quote +))  ------It is the second question
;;; can you guess the third one (eq? (car (cdr aexp)) (quote *))
;;; And you must know the fourth one.                     (eq? (car (cdr aexp)) (quote )e)
;;;
;;; why do we ask four,instead of two,  
;;;          questions about the arithmetic expressions?
;;;          after all,arithmetic expressions like (1+3) are lats
;;;
;;;         ------------------------------Because we consider (1+3) as a representation of an arithmetic expression in 
;;;         list form,not as a list itself.And,an arithmetic expression is either a number,or two arithmetic expressions combined
;;;         by + ,*,expr.
;;;
(define numbered?
  (lambda (aexp)
    (cond
      ((atom? aexp) (number? aexp))
      ((eq? (car (cdr aexp)) (quote +))
       ...)
      ((eq? (car (cdr aexp)) (quote +))
       ...)
     ((eq? (car (cdr aexp)) (quote +))
       ...))))


(define numbered1?
  (lambda (aexp)
    (cond
      ((atom? aexp) (number? aexp))
      ((eq? (car (cdr aexp)) (quote +))
       (and (numbered? (car aexp))
            (numbered? 
              (car (cdr (cdr aexp))))))
      ((eq? (car (cdr aexp)) (quote +))
       (and (numbered? (car aexp))
            (numbered? 
              (car (cdr (cdr aexp))))))
     ((eq? (car (cdr aexp)) (quote +))
       (and (numbered? (car aexp))
            (numbered? 
              (car (cdr (cdr aexp)))))))))

;;; Since aexp was already understood to be an arithmetic expression,could we have written numbered? in a simpler way?

(defin numbered2?
       (lambda (aexp)
         (cond
           ((atom? aexp) (number? aexp))
           (else
             (and (numbered2? (car aexp))
                  (numbered2? 
                    (car (cdr (cdr aexp))))))))))

;;; why can we simplify ??-
;;;                        because we know we&#39;ve got the function right!

;;; We want to value the arithmetic expressions? ------------------
;;;
;;; THe seventh commandments!!
;;;
;;; Recur on the subparts that are of the same nature:
;;;            On the sublists of a list
;;;            on the subexpressions of an arithmetic expression
;;;
;;; To (3 + 4)    &#39;s value
(define value
  (lambda (nexp)
    (cond
      ((atom? nexp) nexp)
      ((eq? (car (cdr nexp)) (quote +))
       (+ (value (car nexp))
          (value (car (cdr (cdr nexp))))))
      ((eq? (car (cdr nexp)) (quote *))
       (+ (value (car nexp))
          (value (car (cdr (cdr nexp))))))
      (else
       (expr (value (car nexp))
          (value (car (cdr (cdr nexp)))))))))

;;; Can you think of a different representation of arithmetic expressions?
;;;          There are several of thme
;;;
;;;          (3 4 +)
;;;          (+ 3 4)
;;;          (plus 3 4)
;;;          (+ (* 3 6) (expr 8 2))
;;;         TO value (+ 3 4)
      
(define value1
  (lambda (nexp)
    (cond
      ((atom? nexp) nexp)
      ((eq? (car nexp) (quote +))
       (+ (value1 (car (cdr nexp)))
          (value1 (car (cdr (cdr nexp))))))
      ((eq? (car nexp) (quote *))
       (+ (value1 (car (cdr nexp)))
          (value1 (car (cdr (cdr nexp))))))
      (else
       (expr (value1 (car nexp))
          (value1 (car (cdr (cdr nexp)))))))))

;;;(1 2) is not a arithmetic expressions ,so we  violated The Seventh Commandments. (1 3) is not a subpart that is 
;;;   representation of an arithmetic expression! We obviosuly  recurred on a list.But,remember,not alll lists are representations
;;;   of arithmetic expressions. We have to recur subexpressions.
;;;   (3) is the (cdr (cdr nexp)) ,but (3) is not an arithmetic expressions,because there are no parentheses in our 
;;;   definition of the arithmetic expressions.

(define 1st-sub-exp
  (lambda (aexp)
    (cond
      (else (car (cdr aexp))))))

;;; why do we ask else,
;;;                   because the first question is also the last question
;;;
;;; Can we get by without (cons. ..) if we don&#39;t need to ask questions?
;;;        Yes remember one-liners from chapter4
;;;

(define 1st-sub-exp1
  (lambda (aexp)
      (car (cdr aexp))))


(define 2nd-sub-exp
  (lambda (aexp)
    (cond
      (else (car (cdr (cdr aexp)))))))

(define operator
  (lambda (aexp)
    (car aexp)))


(define value2
  (lambda (nexp)
    (cond
      ((atom? nexp) nexp)
      ((eq? (operator nexp) (quote +))
       (+ (value (1st-sub-exp1 nexp))
          (value (2nd-sub-exp nexp))))
      ((eq? (operator nexp) (quote +))
       (* (value (1st-sub-exp1 nexp))
          (value (2nd-sub-exp nexp))))
      (else
       (expr (value (1st-sub-exp1 nexp))
          (value (2nd-sub-exp nexp)))))))

;;; so it we chang the (define operator ) and (1st-sub-exp1) exchangeabley ,the different form of arithmetic expressioned.


;;;       ********************************************************************************
;;; The Eighth Commandments:
;;;       Use help functions to abstract from representation
;;;       ********************************************************************************
;;;
;;;
;;;
;;;       Have we seen representation? before
;;;                                      Yes ,we just did not tell you that were representations.
;;;                             For what entities have we used representations?
;;;                             Truth-values!  Numbers!
;;;                                              Numbers are representations?
;;;                                                    Yes ,for example 4 stands for the concpet four. we close the symbol because
;;;                                                    we are accustomed to arabic representation.
;;;                                              What else could we have used?
;;;                                                (() () () ())  would have serve just as well
;;;                                                what about  (((((((())))))))?  How about (I V)&amp;quot;
;;;                                         Do you know how many primitives we need for numbers?
;;;                                          Four: number? ,zero?, add1,and sub1-------------------------------------------&amp;lt;
;;;                                                            ****Do You know how many primitives we need for list?
;;;                                                                   Four:   atom? null? car cdr
;;;                                         Let&#39;s try anouther representation for numbers. How shall we represent zero now/
;;;                                                       () is our choice
;;;                                         How is one represented?
;;;                                                       (()) 
;;;
;;;                                         How is two represented?
;;;                                                       (() () )
;;;                                          Got it,What&#39;s Three?
;;;                                                       (() () ())
;;; So now write thefunction to test zero
(define sero?
  (lambda (n)
    (null? n)))
;;; write a function that is like add1
(define edd1
  (lambda (n)
    (cons (quote ()) n)))

;;;what about sub1
(define zub1
  (lambda (n)
    (cdr n)))

;;; so we can rewrite +
(define plus
  (lambda (n m)
    (cond
      ((sero? m) n)
      (else (edd1 (+ n (zub1 m)))))))

;;; but what&#39;s lat????t
;;;(define lat?
;;;  (lambda (l)
;;;  (cond
;;;      ((null? l) #t)
;;;      ((atom? (car l)) (lat? (cdr l)))
;;;      (else #f))))
;;; So (lat? (1 2 3))     why did you ask???  but now (lat? ((()) (()()) (()()()))) It is very false,!!!
;;;                                                 So you must beware of shadows!!!bugs implicit!!



;;;                         
;;; Why dow we ask (number? aexp) when we know that aexp is an atom?
;;;                   Because we want to know if all arithmetic expressions that are atoms are numbers

;;; Does equal1? ask enough questions? --The first commandments!!  
;;;              Yes,The questions cover all four possible cases

;; Now rewrite the eqlist? using equal???                --------------equal? is the most common ,which  S-expression as the arguments
    
(define eqlist1?
  (lambda (l1 l2)
    (cond
      ((and (null? l1) (null? l2)) #t)
      ((or (null? l1) (null? l2)) #f)
      (else
       (and (equal? (car l1) (car l2))
            (eqlist? (cdr l1) (cdr l2)))))))

;;;; THe sixth Commandments
;;;     Simplify  only  after the function is correct.   ---------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;

;;;; Can you describe what (rember1 a lat) do?
;;;          It takes an atom and a lat as its *arguments*,and makes a new *lat*
;;;          with the *first* occurrence of the atom in the old lat removed
;;;
;;;     How do we(lispers,implicitly) ask questions?
;;;            By using
;;;                   (cond
;;;                     (__________     ____________)
;;;                     (__________     ____________)
;;;                     (__________     ____________)
;;;                     ...
;;;                     (__________     ____________)).
;;;     How do we  remove the first occurrence of a in the rest of lat?
;;;             (rember a (cdr lat))
;;;
;;;
;;; Write down the function rember and its arguments, and refer to them as you go
;;; through the next sequence of questions(the unit test)
;;;    In our words:
;;;              &amp;quot;The function rember checked each atom of the lat , one at a time,
;;;               to see if it was the same  as the atom &#39;and&#39;.If the car was not the
;;;               same as the atom, we saved it to be consed to the final value later.
;;;               when rember found the atom &#39;and&#39;,it dropped it ,and consed the previous
;;;               atoms back onto the rest of the lat
;;;  ---------------------------------cons --------------------------------------
(define rember
  (lambda (a lat)
    (cond 
      ((null? lat) (quote ()))
      (else cond
            ((eq? (car lat) a) (cdr lat))
            (else (cons (car lat)
                        (rember a
                                (cdr lat))))))))

;;; Can you rewrite rember so that it reflects the abouve description
;;;
(define rembersimple
  (lambda (a lat)
    (cond
      ((null? lat) (quote ()))
      ((eq? (car lat) a) (cdr lat))
      (else (cons (car lat)
                  (rember a (cdr lat)))))))

;;;;  What is the meaning of the  (cons (car lat) (rember a (cdr lat))) 
;;;
;;;           This says to refer to the funciton rember but with the 
;;;           argument lat replaced by (cdr lat) and  that after we arrive at a value for
;;;           (rember a (cdr lat)) we must cons (car lat) --bacon --onto it
;;;
;;;           This also says we recur using the function rember, with the argument lat
;;;           replaced by (cdr lat),and that after we arrive at a value for (rember a (cdr lat))
;;;           we must cons (car lat)---lettuce --onto it
;;;
;;;
;;; Here is rember1  after we replace lat by a list l of S-expression 
(define rember1
  (lambda (s l)
    (cond
      ((null? l) (quote()))
      ((atom? (car l))
       (cond 
         ((equal? (car l) s) (cdr l))
             (else (cons (car l)
                         (rember1 s (cdr l))))))
      (else
       (cond
         ((equal? (car l) s) (cdr l ))
         (else (cons (car l)
                     (rember1 s 
                             (cdr l)))))))))
;;;  And how does that differ?
;;;        The funciton rember now removes the first matching S-expression s in l,
;;;                  instead of the first matching atom a in lat.
;;;    Is rember a  &amp;quot;star&amp;quot; function now? 
;;;             NO.
;;;     Why not?
;;;          because rember recurs with the cdr of l only (not togeterh with the car of l ,,correspoding to (define leftmost)
;;;; can we simplify rember1 ?
(define rember2
  (lambda (s l)
    (cond
      ((null? l) (quote()))
      (else 
       (cond
         ((equal? (car l) s) (cdr l))
         (else
          (cons (car l)
                (rember2 s (cdr l)0))))))))

;;; Can rember2 be further simplified????????????????????????
;;;   Yes,the inner(cond...) asks questions that the outer(cond...) could ask1
(define rember3
  (lambda (s l)
    (cond 
      ((null? l) (quote ()))
      ((equal? (car l) s) (cdr l))
      (else (cons (car l)
                  (rember3 s (cdr l)))))))

;;; &amp;quot;...*&amp;quot; makes us think &amp;quot;oh my gawd&amp;quot;
(define rember*
  (lambda (a l)
    (cond 
      ((null? l ) (quote ()))
      ((atom? (car l))
       (cond 
        ((eq? (car l) a)
         (rember* a (cdr l)))
        (else (cons (car l)
                    (rember* a (cdr l))))))
      (else (cons (rember* a (car l))
                  (rember* a (cdr l)))))))
;; Notice that now we are recurring down the car of the list,instead of just the cdr of the list


(define insertL
       (lambda (new old lat)
         (cond
           ((null? lat) (quote ()))
           (else (cond
                   ((eq? (car lat) old)
                    (cons new 
                          (cons old (cdr lat))))
                   (else (cons (car lat)
                               (insertL new old 
                                        (cdr lat)))))))))

;;;; after ------------------------------------&amp;lt;the (define firsts  
;;;In your own words, what does (insertR new old lat) do?
;;;     In our words:
;;;             &amp;quot;It takes three arguments: the atoms new  and old,and lat.
;;;             The function insertR builds a lat with new inserted to the
;;;             right of the *first* occurence of old
;;;
;;;
;;;     Which arguments changes when we recur with insertR?
;;;           lat, because we can only  look at one of its atoms at a time.
;;;
;;;     Which questions do we ask?
;;;       First, we ask (null? lat) .Second we ask else,because else is 
;;;       always the last question.
;;;     Which questions do we ask about the first elements?????? Still rember the typical element
;;;       in the (define firsts)
;;;
;;;     First,we ask (eq? (car lat) old ) .Then we ask else,because there are no other interesting cases
;;;  
;;;  COns &#39;s function: save the buffer to the stack
;;;
;;;  I want to write an procedure: which sort the list  afterwards?
;;;            So I want the change the function&#39; return value?????????????????????????
;;;            What I should do??
(define insertR
  (lambda (new old lat)
    (cond
      ((null? lat) (quote ()))
      (else (cond
              ((eq? (car lat) old)
               (cons old 
                     (cons new (cdr lat))))
              (else (cons (car lat)
                           (insertR new old 
                                    (cdr lat)))))))))

;;;; after the (define makeset1)

(define subset
  (lambda (new old lat)
    (cond 
      ((null? lat) (quote ()))
      (else (cond
              ((eq? (car lat) old)
               (cons new (cdr lat)))
              (else (cons (car lat)
                          (subset new old 
                                  (cdr lat)))))))))

(define subset2
  (lambda (new o1 o2 lat)
    (cond
      ((null? lat) (quote ()))
      (else (cond
              ((eq? (car lat) o1)
               (cons new (cdr lat)))
              ((eq? (car lat) o2)
               (cons new (cdr lat)))
              (else (cons (car lat)
                          (subset2 new o1 o2
                                   (cdr lat)))))))))


(define rember5
  (lambda (a lat)
    (cond 
      ((null? lat) (quote ()))
      ((eq? (car lat) a) (cdr lat))
      (else (cons (car lat)
                  (rember5 a (cdr lat)))))))

(define factorial 
    (lambda (x)
      (if (&amp;lt;= x 1) 1
          (* x (factorial (- x 1))))))

;;;;  after rember ---------------------------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;
;;; In  your own words , what does (firsts l) do
;;;          We tried the following:
;;;          &amp;quot;The function firsts takes one argument, a list,which is either
;;;          a null list or contains only non-empty lists. It builds another list
;;;          composed of the first S-expression(atom or list  or pair) of each internal list
;;;
;;;          REMEMBER THe Commandments
;;;
;;;          Why (define firsts
;;;                 (lambda (l)
;;;                  ...)                     Because we always state the function name,(lambda,and the 
;;;                                           argument(s) of the function
;;;          Why (cond ...)
;;;                                           Because we need to ask questions about the actual arguments
;;;          Why ((null? l) ...)
;;;                                           The first Commandments
;;;          Why (else
;;;                                           Because we only have two equstions to ask about the list l:
;;;                                                      either It is the null list,
;;;                                                                or it contains at least one non-empty list.
;;;                                                 And Because the last question is always else
;;;         Why (cons 
;;;                                           Because we are building  a list  -----The second commandments
;;;
;;;         Why (firsts (cdr l)) 
;;;                                           Because we can only  look at one S-expression at at time .
;;;                                                   To look at the rest,we must recur
;;;         why )))
;;;                                           Because these are the matching  parentheses for (cond, (lambda,
;;;                                           and (define, and they always appear at the end of a function 
;;;                                           definition
;;;
;;;        When we find a typical element of (firsts l) 
;;;                 what do we do with it?
;;;                                       --cons it onto the recursion --(firsts (cdr l))
;;;
;;;
;;;     The third commandments :
;;;                 When building a list, describe the first typical element,and then cons it onto the natural recursion
;;;         So What is the first typical element?
;;;                             -----------------------&amp;gt;  In the (define firsts  The typical element is (car (car l))
;;;            What  is the natural recursion?
;;;                            -----------------------&amp;gt; (firsts (cdr l))
;;;
;;;
;;;             ****************************we are still missing one important ingredient in our recipe!
;;;
;;;
;;;             So what is the meaning of (cons (car (car l))  (firsts (cdr l)))
;;;                           Save (car (car l)) ,and recur with (firsts (cdr l))
(define firsts
  (lambda (l)
    (cond
      ((null? l) (quote ()))
      (else (cons (car (car l))
                  (firsts (cdr l)))))))

(define multirember
  (lambda (a lat)
    (cond
      ((null? lat) (quote ()))
      (else
       (cond
         ((eq? (car lat) a)
          (multirember a (cdr lat)))
         (else (cons (car lat)
                     (multirember a (cdr lat)))))))))
;;; What is the meaning of (cons (car lat) (multirember a (cdr lat)))
;;;  Save (car lat) ---coffee ---- to be consed onto the value of (multirember a (cdr lat)) later
;;;  Now determine (multirember a (cdr lat))
;;;
;;;  THe Fourth commandments:
;;;         Always change at least one arguments while recuring.It must be changed to be closer to 
;;;         termination.The changing argument must be tested in the termination condition:
;;;                   When using cdr, test termination with null?, such as (null? lat)  lat is the 
;;;                   changing argument,so it occur in the terminal condition.

(define multiinsertR
  (lambda (new old lat)
    (cond
      ((null? lat) (quote ()))
      (else 
       (cond
         ((eq? (car lat) old)
          (cons (car lat)
                (cons new
                      (multiinsertR new old (cdr lat)))))
         (else (cons (car lat)
                     (multiinsertR new old (cdr lat)))))))))


(define multiinsertL
  (lambda (new old lat)
    (cond
      ((null? lat) (quote ()))
      (else 
       (cond
         ((eq? (car lat) old)
          (cons new
                (cons (car lat)
                      (multiinsertL new old (cdr lat)))))
         (else (cons (car lat)
                     (multiinsertL new old (cdr lat)))))))))

(define multisubset
  (lambda (new old lat)
    (cond
      ((null? lat) (quote ()))
      (else
       (cond
         ((eq? (car lat) old)
          (cons new
                (multisubset new old 
                             (cdr lat))))
         (else
          (cons (car lat)
                (multisubset new old 
                             (cdr lat)))))))))

(define add1
  (lambda (x)
    (+ x 1)))

(define sub1
  (lambda (x)
    (- x 1)))




; (define +
;   (lambda (n m)
;     (cond 
;       ((zero? m) n)
;       (else (add1 (+ n (sub1 m)))))))
; 
; (define -
;   (lambda (n m)
;     (cond 
;       ((zero? m) n)
;       (else (sub1 (- n (sub1 m)))))))
;
;
;
;;;  Can you describe how (- n m) works??
;;;    It takes two numbers as arguments,and reduces the second until it hits zeros.
;;;    It subtracts one from the result as many times as it did to cause the second 
;;;    one to reach zero!!!

;if add the box above the wrong to the expr define

;;;  What is the natural terminal condition for a list?
;;;              (null? l)
;;;
;;;  What is the natural terminal conditon for a tup?
;;;              (null? tup)
;;;              
;;; When we build a number from a list of numbers, what should the terminal condition line look like?
;;;               ((null? tup) 0)  ,just as ((null? l) (quote ()))  is ofter the terminal conditon line
;;;               for lists
;;;     So what is the terminal condition line of addtup?
;;;           What does addtup do?
;;;             It builds a number by totalling all the numbers in its arguments
;;;
;;;
;;; What is used in the natural recursion on a list?
;;;       (cdr lat)
;;;
;;; What is used in the natural recursion on a tup?
;;;        (cdr tup)
;;; Why?
;;;      Because the rest of a non-empty list is a list
;;;              The rest of a non-empty tup  is a tup
;;;
;;;
;;; How is a number defined?
;;;    It is either zero or it is one added to a res,
;;;           where rest is again  a number
;;;
;;; what is  the natural terminal condition for numbers?
;;;         (zero? n)
;;;
;;; What is the natural recursion on a number? (sub1 n)            (Cdr tup)  (cdr l)
;;;        (how many questions do we need to ask about a number?   ---------------&amp;lt; two
;;;
;;;        So The first commandments(revision)
;;;          When recurring on a list of atoms,lat, ask two questions about it: (null? lat) and else
;;;          When recurring on a number,n ,as two questions about it:(zero? n) and else
;;;
;;;
;;;    and What is the terminal condition line of addtup
;;;           ((null? tup) 0)
;;; So what is the natural recursion for addtup?
;;;           (addtup (cdr tup))
;;;
;;;     what does addtup use to build a number?
;;;               It uses + , because + builds numbers, too!!!!!!!!!!!!!!!!!!!!!!!!!!!
;;;
;;;
(define addtup
  (lambda (tup)
    (cond 
      ((null? tup) 0)
      (else (+ (car tup) (addtup (cdr tup)))))))

       ;;(cons (car tup) (addtup (cdr tup)))))))   The last line of function rember is the similar to the one in the addtup!!!!
       ;;
;;;; The fourth commandments(revision)
;;;  Always change at least one arguments while recurring. It must be changed to be closer to termination.The changing argument must
;;;  be tested in the termination condition:
;;;         when using cdr, test termination with  null? and
;;;         when using sub1, test termination with zero


(define expr
  (lambda (n m)
    (cond
      ((zero? m) 1)
      (else (* n (expr n (sub1 m)))))))


(define multiplication
  (lambda (n m)
    (cond 
      ((zero? m) 0)
      (else (+ n (multiplication n (sub1 m)))))))

(define divide
  (lambda ( n m)
    (cond
      ((&amp;lt; n m ) 0)
      (else (add1 (divide (- n m) m))))))


(define pick 
  (lambda (n lat)
    (cond 
      ((zero? (sub1 n)) (car lat))
      (else (pick (sub1 n) (cdr lat))))))

;;; Can you write number? which is true if its argument is a numerica atom and false if it is anything else
;;;      No:number? like add1,sub1,zero?,car , cdr, cons,null?, eq?,and atom? is a primitive function
;;;
;;;      Can you write a function no-nums which gives as a final value a lat obtained by removing all the
;;;      numbers from the lat.

;;; after (define rempick)  --------------------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;
(define no-nums
  (lambda (lat)
    (cond
      ((null? lat) (quote ()))
      (else
       (cond
         ((number? (car lat))
          (no-nums (cdr lat)))
         (else (cons (car lat)
                     (no-nums (cdr lat)))))))))

(define all-nums
  (lambda (lat)
    (cond
      ((null? lat) (quote ()))
      (else 
       (cond
         ((number? (car lat))
          (cons (car lat)
                (all-nums (cdr lat))))
         (else (all-nums (cdr lat))))))))

;;;;     after the define of eqan? (define eqan?)
;;;what does occur do?
;;;        the function occur which counts the number of times an atom a appears in a lat
(define occur
  (lambda (a lat)
    (cond 
      ((null? lat) 0)
      (else
       (cond
         ((eq? (car lat) a)
          (add1 (occur a (cdr lat))))
         (else (occur a (cdr lat))))))))

(define one?
  (lambda (n)
    (cond 
      ((zero? n) #f)
      (else (zero? (sub1 n))))))

(define one1? 
  (lambda (n)
    (cond
      (= n 1)
      (else #f))))
(define one11?
  (lambda (n)
    (= n 1)))
;;; Guess how we can further simplify this  function ,maing it a one-liner
;;;       By removing the (cond )clause.

(define negativeone?
  (lambda (n)
    (cond 
      ((zero? n) #f)
      (else (zero? (add1 n))))))

(define rember*
  (lambda (a l)
    (cond
      ((null? l) (quote ()))
      ((atom? (car l))
       (cond 
         ((eq? (car l) a)
          (rember* a (cdr l)))
         (else (cons (car l)
                     (rember* a (cdr l))))))
     (else (cons (rember* a (car l))
           (rember* a (cdr l)))))))

;;; After rember*            (define rember*) -----------------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;
;;; How are insertR* and rember* similar?
;;;        0--------------------Each function asks three questions,. Each function recurs on the car
;;;                  of its argument when it finds out that the argument&#39;s car is a list
;;;                  namely,They both recur with car,whenever the car is alist,as well as with the cdr
;;; ******************************************************************************************************************
;;;        The first commandments(Final version)
;;;          When recurring on  a list of atoms,lat,ask two questions about it:
;;;                       (null? lat) and else
;;;          When recurring on a number,n ,ask two questions about it:
;;;                       (zero? n) and else.
;;;          When recurring on a list of S-expression,l ,ask three questtion,about it:
;;;                       (null? l),(atom? (car l)) , and else
;;;
;;;
;;; ******************************************************************************************************************
;;; How are rember* and multirember different?
;;;         The function multirember does not recur with the car. The function rember* recurs with the car when if
;;;           finds out that the car is a list
;;;
;;; So how are all *-functions similar?
;;;          They all ask three questions and recur with the car as well as   with the cdr,whenever the car is a list
;;;          Why?
;;;                             Because all *-functions work on lists that are either 
;;;                                                                      ---empty
;;;                                                                      ---an atom consed onto a list,or
;;;                                                                      ---a list consed onto a list
;;;
;;; ******************************************************************************************************************
;;;
;;;         TheFourthe commandments(final version)
;;;             Always change at least one argument while recurring. 
;;;              when recurring on alist of atoms, lat,use (cdr lat.
;;;              When recurring on a number,n ,use (sub1 n). And  
;;;              when recurring on a list of S-expressions,l,use (car l) and (cdr l) if neither (null? l) nor (atom? (car l) are true
;;;
;;;              It must be changed to be closer to termination. The changing argument must be tested in the termination condition:
;;;                     When using cdr, test termination with null? and
;;;                     When using sub1, test termination with zero?
;;; ******************************************************************************************************************
(define insertR*
  (lambda (new old l)
    (cond 
      ((null? l) (quote ()))
      ((atom? (car l))
       (cond 
         ((eq? (car l) old)
          (cons old
                (cons new (insertR* new old (cdr l)))))
         (else (cons (car l)
                     (insertR* new old
                               (cdr l)))))
       (else (cons (insertR* new old
                            (car l))
             (insertR* new old (cdr l))))))))

;;; 
(define insertL*
  (lambda (new old l)
    (cond 
      ((null? l) (quote ()))
      ((atom? (car l))
       (cond 
         ((eq? (car l) old)
          (cons new
                (cons old (insertR* new old (cdr l)))))
         (else (cons (car l)
                     (insertL* new old
                               (cdr l)))))
       (else (cons (insertL* new old
                            (car l))
             (insertL* new old (cdr l)))))))


(define occur*
  (lambda (a l)
    (cond
      ((null? l) 0)
      ((atom? (car l 0))
       (cond
         ((eq? (car l) a)
          (add1 (occur* a (cdr l))))
         (else 
          (occur* a (cdr l)))))
      (else
       (+ (occur* a (car l))
          (occur* a (cdr l)))))))

;;;;
;;;  I introuduce how the (or (null? l) (atom? a))  works,Then I can go on 
;;;    introuducing the member
;;; else implicit said that if the condition is wrong do it recurly
;;;      also infer that after the recuring ,please go back to home along the Original road!
(define member*
  (lambda (a l)
    (cond
      ((null? l) #f)
      ((atom? (car l))
       (or (eq? (car l) a)
           (member* a (cdr l))))
      (else
       (or (member* a (car l))
           (member* a (cdr l)))))))
;;;
;;; The function tells:
;;;          (condition return values)
;;; Can you write down the definition of the function member? and its arguments
;;;     and refer to them as you go through the next group of questions????
(define member?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? (car lat) a)
                (member? a (cdr lat)))))))



(define first
  (lambda (p)
    (cond (else (car p)))))

(define second
  (lambda (p)
    (cond
      (else (car (cdr p))))))

;;;;Could  after (define subset? )        write a function (intersect?)
(define intersect?
  (lambda (set1 set2)
    (cond
      ((null? set1) #f)
      (else
        (cond
          ((member? (car set1) set2) #t)
          (else 
            (intersect? 
              (cdr set1) set2)))))))

(define intersect1?
  (lambda (set1 set2)
    (cond
      ((null? set1) #f)
      ((member? (car set1) set2) #t)
      (else 
            (intersect1? 
              (cdr set1) set2)))))

(define intersect2?
  (lambda (set1 set2)
    (cond
      ((null? set1) #f)
      (else (or (member? (car set1) set2)
                (intersect1? (cdr set1) set2))))))

(define intersect
  (lambda (set1 set2)
    (cond
      ((null? set1) (quote ()))
      ((member? (car set1) set2)
       (cons (car set1)
             (intersect (cdr set1) set2)))
      (else
       (intersect (cdr set1) set2)))))

(define intersect
  (lambda (set1 set2)
    (cond
      ((null? set1) (quote ()))
      ((member? (car set1) set2)
       (cons (car set1)
             (intersect (cdr set1) set2)))
      (else
       (intersect (cdr set1) set2)))))

;;;; In our words: It is a function that return s all the atoms
;;;in set1 that are not in the set2,That is ,xxx is the (set) difference functions=
(define xxx
  (lambda (set1 set2)
    (cond
      ((null? set1) (quote ()))
      ((member? (car set1) set2)
       (xxx (cdr set1) set2)))
      (else
        (cons (car set1)
              (xxx (cdr set1) set2)))))

(define instersectall
  (lambda (l-set)
    (cond
      ((null? (cdr l-set)) (car l-set))
      (else
        (interset (car l-set)
                  (intersectall (cdr l-set)))))))


(define union
  (lambda (set1 set2)
     (cond
       ((null? set1) set2)
       ((member? (car set1) set2)
        (union (cdr set1) set2))
       (else
        (cons (car set1)
              (union (cdr set1) (set2)))))))

(define build 
  (lambda (s1 s2)
    (cond 
      (else (cons s1 
                  (cons s2 (quote ())))))))


;;;;;;;;;;;;;;;;;;;;;;;The first part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;
;;;
;;;;;;;;;;;;;;;;;;;;;;;The second part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;  myracet2.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;
;;;Can you write a function  insert-g that would insert either at the left or at the right!!
;;;
;;;Which pieces differ?
;;;              The second lines differ from each other ,In insertL it is:
;;;               ((eq? (car l) old)
;;;                (cons new (cons old (cdr l))))
;;;               But in the insertR it is:
;;;               ((eq? (car l) old)
;;;                (cons new (cons old (cdr l))))
;;;
;;;         Put the difference in words!
;;;               We say:
;;;                      &amp;quot;The two functions cons old and new in a different order onto the cdr of the list l
;;;
;;;         So how can we get rid of the difference &amp;gt;
;;;                You probably guessed it: by passing in a function that expresses tha appropriate consing.
(define seqL
  (lambda (new old l)
    (cons new (cons old l))))
(define seqR
  (lambda (new old l)
    (cons old (cons new l))))

;;; so you can (insert-g seqL)  (insert-g seqR)
;;; (define insertL (insert-g seqL))
;;; (define insertR (insert-g seqR))
;;;
;;;
(define insert-g
  (lambda (seq)
    (lambda (new old l)
      (cond
        ((null? l) (quote ()))
        ((eq? (car l) old)
         (seq new old (cdr l)))
        (else (cons (car l)
                    ((insert-g seq) new old
                                    (cdr l))))))))
;;; So we can define insertL again with insert-g *****************************^-^************************************
;;; Do not pass in seqL this time.
(define insertL1
  (insert-g
    (lambda (new old l)
      (cons new (cons old l)))))

;;;;;; Perfect--- it is  a great abstraction!
;;;
;;;Is it better?
;;;      Yes,Because youu do not need to remember as many names,you can
;;;      (rember func-name &amp;quot;your-mind&amp;quot;) 
;;;                Where func-name is seqL
;;;
;;;                Do you remember the definition of subst
;;;                Yes! it looks like insert-L  insertR  .Just the answer of the second cond-line is differenct

(define subst
  (lambda (new old l)
    (cond
      ((null? l) (quote ()))
      ((eq? (car l) old)
       (cons new (cdr l)))
      (else (cons (car l)
                  (subst new old (cdr l)))))))

;subst insertL insertR the common property is else and different 
;operator so we can abstract them to the insert-g
(define seqS
  (lambda (new old l)
    (cons new l)))

(define subst1 (insert-g seqS))

(define seqrem
  (lambda (new old l)
    l))
(define yyy
  (lambda (a l)
    ((insert-g seqrem) #f a l)))
;;;;;What do you yyy is?
;;;            Surprise ! It is our old friend rember,
;;;            Step through the evaluation of (yyy a l)
;;;            where 
;;;                a  is sausage
;;;                and l is (pizza with sausage and bacon)
;;;             What role does #f paly?
;;;             New in the insertL and insertR   ,a is old in the insertL and insertR
;;;
;;;
;;;             **********************************************************************
;;;             THe ninth commandments:
;;;              Abstract the common patterns with a new function.
;;;
;;;             **********************************************************************
;;;

;;;So can you simplify the function (define value1)
;;; Can you write the funciton atom-to-function 
;;;         which:
;;;               1: Taes one argument x 
;;;               2: returns the function + if (eq? x (quote +))
;;;                  returns the function * if (eq? x (quote *))
;;;                  returns the function expr if (eq? x (quote expr))
;;;
(define atom-to-function
  (lambda (x)
    (cond
      ((eq? x (quote +) +))
      ((eq? x (quote *) *))
      (else expr))))
;;;(atom-to-function (operator nexp))

(define value3
  (lambda (nexp)
    ((atom? nexp) nexp)
    (else
      ((atom-to-function
         (operator nexp))
       (value3 (1st-sub-exp nexp))
       (value3 (2nd-sub-exp nexp))))))


(define multirember
  (lambda (a lat)
    (cond 
      ((null? lat) (quote ()))
      ((eq? (car lat) a)
       (multirember a (cdr lat)))
      (else (cons (car lat)
                  (multirember a (cdr lat)))))))

(define multirember-f
  (lambda (test?)
    (lambda (a lat)
      (cond 
        ((null? lat) (quote ()))
        ((test? a (car lat))
         ((multirember-f test?) a
                               (cdr lat)))
        (else (cons (car lat)
                    ((multirember test?)  a 
                                          (cdr lat))))))))

(define multirember-eq? (multirember-f &#39;eq?))

;;; After the insturciton os a pair----&amp;gt;  
(define first
  (lambda (p)
    (cond 
      (else (car p)))))
(define second 
  (lambda (p)
    (cond 
      (else (car (cdr p))))))
(define third
  (lambda (p)
    (cond 
      (else (car (cdr (cdr p)))))))
(define third1
  (lambda (l)
    (car (cdr (cdr l)))))
(define build
  (lambda (s1 s2)
    (cond 
      (else (cons s1
                  (cons s2 (quote ())))))))

;;;; After the (define fun?)
;;;
(define revrel
  (lambda (rel)
    (cond
      ((null? rel) (quote ()))
      (else
       (cons (build
              (second  (car rel))
              (first (car rel)))
             (revrel (cdr rel)))))))
;; maybe we can abstract the build part,because it&#39;s the pair part
;;
;; Now do you see how representabtion aids readability????
;;         second   first is the (car (car rel))         second is (car (cdr (car rel)
;; so it can hide the build inverse process 
;;
;; Suppose we had the funciton revpair that reversed the two componets of a pair like this:
;;
(define revpair;;hide the build process
  (lambda (pair)
    (build (second pair) (first pair))))

(define revrel1
  (lambda (rel)
    (cond
      ((null? rel) (quote ()))
      (else
       (cons (revpair (car rel));so it can be hided
             (revrel1 (cdr rel)))))))
(define member?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? (car lat) a)
                (member? a (cdr lat)))))))
  
;;; The 7 chapter ,,after the numbered
(define set?
  (lambda (lat)
    (cond
      ((null? lat) #t)
      (else
       (cond 
         ((member? (car lat) (cdr lat)) #f
               )
         (else
          (set? (cdr lat))))))))

;;; simplify set?              -------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;
(define set1?
  (lambda (lat)
    (cond 
      ((null? lat) #t)
      ((member? (car lat) (cdr lat)) #f)
      (else (set? (cdr lat))))))
;;; Were you surprised to see the function member? appear in the definition of set?
;;;       You should not be,because we have written memeber? already,and now we can 
;;;       use it whenever we want
         

(define makeset
  (lambda (lat)
    (cond
      ((null? lat) (quote ()))
      ((member? (car lat) (cdr lat))
       (makeset (cdr lat)))
      (else (cons (car lat)
                  (makeset (cdr lat)))))))
(define makeset1
  (lambda (lat)
    (cond
      ((null? lat) (quote ()))
      (else (cons (car lat)
                  (makeset (multirember (car lat) (cdr lat))))))))
;;; Describe in your own words how the second definition of makeset works?????
;;;        Here are our words:
;;;         &amp;quot;&amp;quot;THe function makeset remembers to cons the first atom in the lat onto the result of the
;;;          natural recursion ,after removing all occurences of the first atom from the rest of the lat.
;;;
(define subset?
  (lambda (set1 set2)
    (cond
      ((null? set1) #t)
      (else (cond
              ((member? (car set1) set2)
               (subset? (cdr set1) set2))
              (else #f))))))

;;; can you  write a shorter version of subset?
(define subset1?
  (lambda (set1 set2)
    (cond
      ((null? set1) #t )
      ((member? (car set1) set2)
       (subset? (cdr set1) set2))
      (else #f)))

;;; Try to write subset1? with (and ...)

(define subset2?
  (lambda (set1 set2)
    (cond
      ((null? set1) #t)
      (else
        (and (member? (car set1) set2)
             (subset? (cdr set1) set2))))))

;;; equip list
;;;
(define eqset?
  (lambda (set1 set2)
    (cond
      ((subset? set1 set2)
       (subset? set2 set1))
      (else #f))))

(define eqset1?
  (lambda (set1 set2)
    (cond
      (else
      (and (subset? set1 set2)
       (subset? set2 set1))))))

(define eqset2?
  (lambda (set1 set2)
      (and (subset? set1 set2)
       (subset? set2 set1))))


(define firsts
  (lambda (rel)
    (cond
      ((null? rel) (quote ()))
      (else
       (cons (first (car rel))
             (firsts (cdr rel)))))))
(define seconds
  (lambda (rel)
    (cond
      ((null? rel) (quote ()))
      (else
       (cons (second (car rel))
             (seconds (cdr rel)))))))
;; one important known : in the (else,things is called recur
;; in the cond&#39;s first question is called the end condtion
;; multi and sigle is recognise by the doing&#39;s if satisfied the 
;; questions!
;;
;; After te define (pair)
;;
;;Is fun? a simple one-liner?  It sure is
;;
;;How do we reprensent a finite function?
;;       For us(lispers)m
;;                         a finite function is a list of pairs in which
;;                         no first element of any pair is the same as any
;;                         other first element
(define fun?
  (lambda (rel)
    (set? (firsts rel))))


;
(define fullfun?;;fun is also a relation
  (lambda (fun);;fullfun is based on the fun
    (set? (seconds fun))))

;;fullfun&#39;s another name is one-to-one
;;so we can define it another way
(define one-to-one?
  (lambda (fun)
    (fun? (revrel fun))))


(define expr
  (lambda (n m)
    (cond
      ((zero? m) 1)
      (else
       (* n (expr n (- m 1)))))))

(define cookies
  (lambda ()
    (bake
      (quote (350 degrees))
      (quote (12 minitus))
      (mix
        (quote (walnuts 1 cup))
        (quote (chocolate-chips 16 ounces))
        mix
        (mix
          (quote (flour 2 cups))
          (quote (oatmeal 2 cups))
          (quote (salt .5 teaspoon))
          (quote (baking-powder 1 teaspoon))
          (quote (baking-soda 1 teaspoon)))
        (mix
          (quote (eggs 2 large))
          (quote (vanilla 1 teaspoon))
          (cream
            (quote (butter 1 cup))
            (quote (sugar 2 cups))))))))
;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Y
;;;The Fifth commandments:
;;;  When building a  value with +, always use 0 for the value of the terminating line,for adding 0 does not change the value of an addiction
;;;  When building a  value with *, always use 1 for the value of the termination line,for multiplying 1 does not change the value of a multiplication
;;;  When building a  value with cons, always consider () for the value of the terminating line
;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Y
;;;
;;; What does (tup+ tup1 tup2) do?
;;;         It adds the first number of tup1 to the first number of tup2,then it adds the second number of tup1 to the second number of tup2,etc
;;;               building a tup of answers,for tups of the same length
;;; What is the unusal about tup+?
;;;         It looks at each element of two tups at the same time,or in other words, it recus on two tups.
;;;
;;; If you recur on one tup how many questions do you have to ask?
;;;         two,they are (null? tup) and else
;;;
;;; When recuring on two tups, how many question need to be asked about the tups? 
;;;      Four: if the first tup is empty or none-empty,and if the second tup is empty or non-emptyy
;;;      Do you mean the questions (and (null? tup1) (null? tup2)) (null? tup1) (null? tup2) and else 
;;;
;;;      But can the first tup be () at the same time as the second is other than ().
;;;         No ,because the tups must have the same length
;;;     Does this mean (and (null? tup1) (null? tup2))  and else are the only questions we need to ask?
;;;     Yes!
(define tup+
  (lambda (tup1 tup2)
    (cond
      ((and  (null? tup1) (null? tup2))
       (quote ()))
      (else
        (cons (+ (car tup1) (car tup2))
              (tup+ (cdr tup1) (cdr tup2)))))))
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;  Why  does the natural recursion include the cdr of bouth arguments?
;;;      Because the typical element of the final value use the car of both tups,so now
;;;      we are ready to consider the rest of both tups -----------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;Yes the right logic
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
(define tup++
  (lambda (tup1 tup2)
    (cond
      ((and (null? tup1) (null? tup2)) 
       (quote ()))
      ((null? tup1) tup2)
      ((null? tup2) tup1)
      (else
        (cons (+ (car tup1) (car tup2))
              (tup++  
                (cdr tup1) (cdr tup2)))))))

;;;; can you simplify it????????????????????????????////
(define tup+++
  (lambda (tup1 tup2)
    (cond
      ((null? tup1) tup2)
      ((null? tup2) tup1)
      (else
        (cons (+ (car tup1) (car tup2))
              (tup+++  
                (cdr tup1) (cdr tup2)))))))



(define atom-to-function
  (lambda (x)
    (cond 
      ((eq? x (quote +)) +)
      ((eq? x (quote *)) *)
      ((eq? x (quote ^)) expr)
      ((eq? x (quote eq?)) eq?)
      (else -))))
; (rember-f (atom-to-function &#39;eq?) &#39;ff &#39;(dfds gi ff sd))  
;
; In the common lisp:
;            L: (funcall test? (car l) a) ,use the funcall when invoking a function argument or a function that has 
;            not been defuned
(define rember-f
  (lambda (test? a l)
    (cond 
      ((null? l) (quote ()))
      (else
       (cond 
         ((test? (car l) a) (cdr l));;I think here needs atom2function
         (else (cons (car l)
                     (rember-f test? a 
                               (cdr l)))))))))

;;; The short version! 
(define rember1-f
  (lambda (test? a l)
    (cond 
      ((null? l) (quote ()))
      ((test? (car l) a) (cdr l));;I think here needs atom2function
      (else (cons (car l)
                     (rember-f test? a 
                               (cdr l)))))))
;;; What kind of values can functions return&amp;gt;
;;;                  Lists and atoms
;;;                       But in the eye of us ,all the things are the lists and atoms
;;;                        so we can return all the kind of values
;;;                        so what about function themselves? Yes
;;;                         such as (lambda (a l) ...) is a function of two arguments ,a and l! returns the function!
;;;                 This is calld &amp;quot;Curry-ing&amp;quot;
;;;     In the scheme ,Using (define ...)give the preceding function a name,
;;;     but in theCL: (define eq?-c  (a) (function (lambda (x) (eq x a))))
;;;     while the scheme : (define eq?-c (lambda (a) (lambda (x) (eq? x a))))

(define insertL-f
  (lambda (test?)
    (lambda (new old l)
      (cond 
        (( null? l) (quote ()))
        ((test? (car l) old)
         (cons new (cons old (cdr l))))
        (else (cons (car l)
                    ((insertL-f test?) new old
                                       (cdr l))))))))
(define insertR-f
  (lambda (test?)
    (lambda (new old l)
      (cond 
        (( null? l) (quote ()))
        ((test? (car l) old)
         (cons old (cons new (cdr l))))
        (else (cons (car l)
                    ((insertR-f test?) new old
                                       (cdr l))))))))
;;The basic principle
;;(name --&amp;gt;(null? ---&amp;gt;(eq?    ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;                ---&amp;gt;(eqan?   ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;                ---&amp;gt;(equal?  ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;                ---&amp;gt;(eqlist? ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;sometimes we abstuct the condition to adapt to different state
;; sometimes we abstuct the operations to simplify it
(define multirember1 
 (lambda (a lat)
   (cond
     ((null? lat) (quote ()))
     ((eq? (car lat) a)
      (multirember a (cdr lat)))
     (else (cons (car lat)
                 (multirember a (cdr lat)))))))
(define multirember1-f
  (lambda (test?)
    (lambda (a lat)
      (cond
        ((null? lat) (quote ()))
        ((test? a (car lat))
         ((multirember1-f test?) a 
                                (cdr lat)))
        (else (cons (car lat)
                    ((multirember1-f test?)  a 
                                            (cdr lat))))))))
;;((multirember1-f (atom-to-function &#39;eq?)) &#39;fd &#39;(sgs fd gasdg fd))
;;&#39;(sgs gasdg)
;;(define multirember1-eq (multirember1-f (atom-to-function &#39;eq?)))
;;Actually:
;;((multirember1-f eq?) &#39;fd &#39;(gsd fd gjsi fd go))
;;direct apply function eq?,That doesn&#39;t need (eq?, I learn from
;; (multiremberT eq?-salad)
(define rembern
  (lambda (a l)
    ((insert-g seqrem) #f a l)));;seqrem doesn&#39;t need (seqrem solve my ?.
(define seqrem
  (lambda (new old l) 
    l))

(define multiremberT
  (lambda (test? lat)
    (cond
      ((null? lat) (quote ()))
      ((test? (car lat))
       (multiremberT test? (cdr lat)))
      (else
       (cons (car lat)
             (multiremberT test? 
                           (cdr lat)))))))
(define eq?-c
  (lambda (a)
    (lambda (x)
      (eq? x a))))
(define eq?-salad (eq?-c &#39;salad))
;;(multiremberT eq?-salad &#39;(fsfd salad fsdf sald sg salad))

;;; What is the name of the third arguments that multiremberco uses for the natural recursion?
;;; what is the name of the third argument ? And do you know what col stands for?
;;;       The name col is short for &amp;quot;collector&amp;quot;, A collector is sometimes called a continuation
(define multiremberco
  (lambda (a lat col)
    (cond 
      ((null? lat)
       (col (quote ()) (quote ())))
      ((eq? (car lat) a)
       (multiremberco a 
                      (cdr lat)
                      (lambda (newlat seen) 
                        (col newlat (cons (car lat) seen)))))
      (else
       (multiremberco a 
                      (cdr lat)
        )             (lambda (newlat seen)
                        (col (cons (car lat) newlat)
                             seen)))))))

(define a-friend
  (lambda (x y)
    (null? y)))
;(multiremberco &#39;tuna &#39;(sfds tuna fsd jif) a-friend)
;#f
;&amp;gt; (multiremberco &#39;tuna &#39;(sfds tuna1 fsd jif) a-friend)
;#t
;;how can  you get another value in the col
;;
;;can you write this definition differently!  Do you mean the new way where we put tuna into the definition?
;;  col is to a-frined what (car lat) is to tuna.   so we can replace the col with a-frined
;;
(define new-friend
  (lambda (newlat seen)
    (a-friend newlat
         (cons (quote tuna) seen))))

;;;; So ANd now?
;;;      multiremberco finds out that(null? lat) is true, which means that it uses the collector on two empty lists.
;;;        which collector is this?
;;;          It is new-friend.
;;; how does a-friend differ from new-friend ?
;;;              New-friend uses a-friend on the empty list and 
;;;               the value of (cons (quote tuna) (quote ()))
;;;
;;; And what does the old-collector do (a-friend) with such arguments?
;;;              It answers #f,because its second argument is (tuna),which is not the empty list!

;;;;;;;; I don&#39;t know that the list length ,so easy but I don&#39;t think it clearly!!!!
;;;What is terminal condition ?  (null? lat)
;;;what is terminal condition line ? ((null? lat) 0)   (terminal_contition terminal_value)
;;;what is the (+1 (length (cdr lat)))
;;;        build the number with +,so the terminal condition line is ((null? lat) 0)   use (cdr lat) to closer the terminal!
(define length
  (lambda (lat)
    (cond 
      ((null? lat) 0)
      (else (+ 1 (length (cdr lat)))))))

;;; a is tuna and lat is (and tuna)  col is a-friend
(define latest-friend
  (lambda (newlat seen)
    (a-friend (cons (quotee and) newlat)
              seen))))

;;The third collector : the last-friend
(define last-friend
  (lambda (newlat seen)
    (length newlat)))
;;;;;;;;;;;;;****************************************************************************
;;;;;;;;;;;;;****************************************************************************
;;;;;;;;;;;;;****************************************************************************
;;;;So  what does (multiremberco a lat f) do?
;;;      It looks at every atom of the lat to see whether 
;;;      it is eq? to a.Those atoms that are  not  are collected in one list ls1
;;;      it is eq? to a.The others which the answer is true    are collected in second list ls2
;;;
;;;      Finally  it determine the value of (f ls1 ls2)
;;;
;;;      Namely under the process of time(timestep=0,1,2,3,n-1),In the col it classify the data: use cons 
;;;              while at the last time(timestep=n) in the a-friend (col) it determine the cons datas!!

;;;;;;;;;;;;;****************************************************************************
;;;;;;;;;;;;;****************************************************************************
;;;;;;;;;;;;;****************************************************************************
;;;;;;;;;;;;;****************************************************************************
;;;        The Tenth commandments:
;;;            Build functions to collect more than one value at a time.
;;;
;;;;;;;;;;;;;****************************************************************************
;&amp;gt; (multiremberco &#39;tuna &#39;(tunanfdfj tuan jsidjf tuna) last-friend)
;3

;;actually
;;The basic principle
;;(name --&amp;gt;(null? (col (quote()...)---&amp;gt;(eq?    ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;                ---&amp;gt;(eqan?   ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;                ---&amp;gt;(equal?  ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;                ---&amp;gt;(eqlist? ---&amp;gt;single (cons new (cdr l))    --&amp;gt;(else
;;                            ---&amp;gt;multi (cons new (name (cdr l)))--&amp;gt;(else
;;sometimes we abstuct the condition to adapt to different state
;; sometimes we abstuct the operations to simplify it
;;multiremboco sometimes we want to change the return value,so co it

(define multiinsertLR
  (lambda (new oldL oldR lat)
    (cond
      ((null? lat) (quote ()))
      ((eq? (car lat) oldL)
       (cons new 
             (cons oldL
                   (multiinsertLR new oldL oldR
                                  (cdr lat)))))
      ((eq? (car lat) oldR)
       (cons oldR
             (cons new
                   (multiinsertLR new oldL oldR
                                 (cdr lat)))))
      (else
        (cons (car lat)
              (multiinsertLR new oldL oldR (cdr lat)))))))

;;;; The function multiinsertLRco is to multiinsertLR what multiremberco is to multirember
;;;           Does this mean that multiinsertLRco takes one more argument than multiinsertLR?
;;;            Yes! and what kind of argument is it? 
;;;                   It is a collector function.
(define multiinsertLRco
  (lambda (new oldL oldR lat col)
    (cond
      ((null? lat)
       (col (quote ()) 0 0))
      ((eq? (car lat) oldL)
       (multiinsertLRco new oldL oldR
                        (cdr lat)
                        (lambda (newlat L R)
                          (col (cons new 
                                     (cons oldL newlat))
                               (+ 1 L) R))))
      ((eq? (car lat) oldR)
       (multiinsertLRco new oldL oldR
                        (cdr lat)
                        (lambda (newlat L R)
                          (col (cons oldR
                                     (cons new newlat))
                               L (+ 1 R)))))
      (else
       (multiinsertLRco new oldL oldR 
                        (cdr lat)
                        (lambda (newlat L R)
                          (col (cons (car lat) newlat)
                               L R)))))))

(define even?
  (lambda (n)
    (= (* (/ n 2) 2) n)))

(define /  ;rewrite the divide to replace the origianl divide from Drracket
  (lambda (n m)
    (cond
      ((&amp;lt; n m) 0)
      (else
       (+ 1 (/ (- n m) m))))))
(define evens-only*
  (lambda (l)
    (cond
      ((null? l) (quote ()))
      ((atom? (car l))
       (cond
         ((even? (car l))
          (cons (car l)
                (evens-only* (cdr l))))
         (else
          (evens-only* (cdr l)))))
      (else (cons (evens-only* (car l))
                  (evens-only* (cdr l)))))))
(define atom?
  (lambda (x)
    (and (not (pair? x)) (not (null? x)))))

;;;  Can you explain what (evens-only*co (carl) ...) accomplishes?
;;;      It visits every number in the car of l and collects the list without odd numbers,the
;;;      product of the even numbers,and the sum of the odd numbers.
;;;      So it is the most complicated,actually not very easy to be understood!
;;;         You can understand with another lat,so you how to associate two lat!
;;;         Youknow (even? (car l)) is in  a lat,so it do +*cons in the lat&#39;s number!
;;;
(define evens-only*co
  (lambda (l col)
    (cond
      ((null? l)
       (col (quote ()) 1 0))
      ((atom? (car l))
       (cond 
         ((even? (car l))
          (evens-only*co (cdr l)
                         (lambda (newl p s)
                           (col (cons (car l) newl);if it is evens ,so cons it into the newl
                                (* (car l) p) s))))
         (else (evens-only*co (cdr l)
                              (lambda (newl p s)
                                (col newl p (+ (car l) s)))))))
       (else (evens-only*co (car l)
                            (lambda (al ap as)
                              (evens-only*co (cdr l)
                                             (lambda (dl dp ds)
                                               (col (cons al dl)
                                                    (* ap dp)
                                                    (+ as ds))))))))))

;the fourth collector :: the last-last-friend
(define the-last-last-friend
  (lambda (newl product sum)
    (cons sum 
          (cons product 
                newl))))
;&amp;gt; (evens-only*co &#39;(45389 63 45 6 4 234  6 4 23 52 43) the-last-last-friend)
;&#39;(45563 7008768 6 4 234 6 4 52)

;;;;  after the length !!!!(define length) -------------------------------------&amp;lt;
;;;  use car !!   zero?  sub1
(define pick
  (lambda (n lat)
    (cond
      ((zero? (sub1 n)) (car lat))
      (else (pick (sub1 n) (cdr lat))))))

(define rempick
  (lambda (n lat)
    (cond 
      ((zero? (sub1 n)) (cdr lat))
      (else (cons (car lat)
                  (rempick (sub1 n) (cdr lat))))
      ;;;; because n  lat is occur in the terminal condition!!!!!
;;; use the function one? to rewrite the function rempick that removes the nth atom from a lat.
;;;
;;;
(define rempick1
  (lambda (n lat)
    (cond 
      ((one? n) (cdr lat))
      (else (cons (car lat)
                  (rempick ((sub1 n)
                            (cdr lat))))))))

(define keep-looking
  (lambda (a sorn lat)
    (cond
      ((number? sorn)
       (keep-looking a (pick sorn lat) lat))
      (else (eq? sorn a)))))

(define looking
  (lambda (a lat)
    (keep-looking a (pick 1 lat) lat)))
;&amp;gt; (looking &#39;cavier &#39;(6 2 4 cavier 5 7 3))
;#t

(define eternity
  (lambda (x)
    (eternity x)))
;;it doesn&#39;t stop ,because the goal is not absolutely, rather then
;; 相对的

;;; This is trivival; It&#39;s not even recursive
;;; What does shift do?
;;;   Here are our words:
;;;     The shift function takes a pair whose first component is a pair and builds a pair
;;;     by shifting the second part of the first component into the second component!
;;;
;;;     So what is the meaning of component?  --------Component can means atom,pair and list
;;;                  Now it means pair.
(define shift 
  (lambda (pair)
    (build (first (first pair))
           (build (second (first pair))
                  (second pair)))))
;&amp;gt; (shift &#39;((fsd fd)(fd gs)))
;&#39;(fsd (fd (fd gs)))
(define align
  (lambda (pora)
    (cond 
      ((atom? pora) pora)
      ((a-pair? (first pora))
       (align (shift pora)))
      (else (build (first pora)
                   (align (second pora)))))))
;;; What does it  have in common with keep-looking 
;;;          Both functions change their arguments for their recursive uses but in neither
;;;          case is the change guaranteed to get us closer to the goal
;;;
;;; Why are we not guaranteed that align makes progress?
;;;                In the second cond-line shift creates an argument for align that 
;;;                is not a part of the original argument.
;;;
;;; Which commandment does that violate?
;;;              The Seventh Commandment.
;;;
;;; Is the new argument at least  smaller than the original one?
;;;            It does not look that way
;;;
;;; Why not?
;;;           The function shift only rearranges the pair it gets.
;;; And?
;;;           Both the result and the argument of shift have the same number of atoms.
;;; Can you write a function that counts the number of atoms
;;; After the (define intersectall)
;;;
;;;align do what shift can&#39;t do?
;;;        Such as  (align &#39;(a b))         but (shift &#39;(a b)) will get wrong message.
(define a-pair?
  (lambda (x)
    (cond
      ((atom? x) #f)
      ((null? x) #f)
      ((null? (cdr x)) #f)
      ((null? (cdr (cdr x))) #t)
      (else #f))))
;;; how can you refer to the first S-expression of a pair?
;;;      By taking the car of the pari
;;; How can you refer to the second S-expression of a pair?
;;;      By taking the car of the cdr of the pair
;;;
;;; How can you build a pair with two atoms?
;;;  You cons the first ne onto the cons of the second one onto (). Thatis (cons x1 (cons x2 (quote ())))
;;;
;;;  How can you build a pair with two S-expressions?
;;;   you cns the first one onto the cons of the second one onto ().That is
;;;   (cons s1 (cons s2 (quote ()))) or (cons x1 (cons x2 (quote ())))
;;;
;;;   Did you notice the difference between the last two answers?
;;;     No ,there aren&#39;t any
;;;
;;;Is align a partial function?
;;;        We don&#39;t now yet.There may be arguments for which it keeps aligning things.
;;;
;;; Is there something else that changes about the arguments to align and its recursive uses?
;;;        Yes, there is .The first component of a  pair becomes simpler,though the second component becomes more complicated
;;;
;;; In what way is the first component simpler?
;;;       IT is only a part (IT intelligent technique is equal to it) of the original pair&#39;s first component.
;;;
;;; Doesn&#39;t this mean that lenght * is the wrong function for determining the length of the argument? Can you find a better function
;;;         A better function should pay more attention to the first component
;;;
;;; How much more attention should we pay to the first component?
;;;          At least twice as much
;;;          Do you mean something like weight*
;;;     DOes This mean that the arguments get simpler?
;;;       Yes ,the weigth* of align&#39;s arguments become successively smaller
;;;     Is align a partial function?
;;;        No,it yields a value for every argument rather than the partial function looking and looking again.
;;;
(define length*
  (lambda (pora)
    (cond 
      (( atom? pora) 1)
      (else
       (+ (length* (first pora))
          (length* (second pora)))))))

(define weight*
  (lambda (pora)
    (cond 
      ((atom? pora) 1)
      (else
       (+ (* (weight* (first pora)) 2)
          (weight* (second pora)))))))

;;;  Here is shuffle which is like align but uses revpair from chapter7, instead of shift:(when the first component is a-pair?
;;;       THen do revpair.
;;; The function shuffle and revpair swap the components of pairs when the first component is a pair...
;;;
;;; Does this mean that shuffle is total?
;;;        We don&#39;t know yet.(actually  it is not.)
;;; Okay,let&#39;s do something interesting. What is the value of (shuffle x) where x is ((a b) (c d))
;;;
;;; And how are you going to do that?
;;;          We are going to determine the value (shuffle pora) where pora is ((c d) (a b))
;;;
;;; Doesn&#39;t this mean that we need to know the value of (shuffle (revpair pora))
;;;            where (revpair pora) is ((a b) (c d))  , yes we do.
;;;
;;; And?
;;;         The function shuffle is not total because it now swaps the components of the pair again, which means that we start all over.
(define shuffle
  (lambda (pora)
    (cond
      ((atom? pora) pora)
      ((a-pair? (first pora))
       (shuffle (revpair pora)))
      (else (build (first pora)
                   (shuffle (second pora)))))))
;&amp;gt; (shuffle &#39;(a (b c)))
;&#39;(a (b c))
;&amp;gt; (shuffle &#39;(a b c))
;&#39;(a b)
;&amp;gt; (shuffle &#39;(a b))
;&#39;(a b)
;;;;         Thankyou ,Lother Collatz(1910-1990)! It doesn&#39;t yield a value for 0, but otherwise nobody knows.
(define C
  (lambda (n)
    (cond
      ((one? n) 1)
      (else
        (cond
          ((even? n) (C (/ n 2)))
          (else (C (add1 (* 3 n)))))))))

;;;;          Thank you,Wilhelm ackermann(1853-1946)
(define A
  (lambda (n m)
    (cond
      ((zero? n) (+ 1 m))
      ((zero? m) (A (- 1 n) 1))
      (else (A (sub1 n)
               (A n (sub1 m)))))))
;;; What does A have in common with shuffle and looking?
;;;         A&#39;s arguments ,like shuffle&#39;s and looking&#39;s,  do not necessarily decrease for the recursion
;;;
;;; Dose A always give an answer? 
;;;         Yes,it&#39;s total
;;;
;;; Wouldn&#39;t it be great if we could write a function that tells us whether some function returns with a 
;;; value for every  argument.
;;;        It sure would.Now that we have seen function that never return a value or return a value so lat that 
;;;        it is too late ,we should have some tool like this around
;;;Okay,let&#39;s write it
;;;
;;;            It sounds complicated.A function can work for many different arguments
;;; Then let&#39;s make it simpler.For a warm-up exercise,let&#39;s focus on a function that checks whether some function stops
;;; for just the empty list,the simplest of all arguments.
;;;          That world simplify it a lot
;;; Here is the beginning of this function:
;;;
;;; (define will-stop?  (lambda (f) ...)))
;;;
;;;
;;; What does it do?  Do will-stop? return a value for all arguments?
;;; That&#39;s the easy part: we said that it either returns #t or #f,depending on whether the argument stops when applied to ()
;;;
;;; Is will-stop? total then?
;;;   Yes,it is.It always return #t or #f
;;;
;;;okay here is  a function that could be an interesting argument for will-stop?
(define last-try
  (lambda(x)
    (and (will-stop? last-try)
         (eternity x)))))

    ;;; what is (will-stop? last-try)
    ;;;
    ;;; What does it do?
    ;;;
    ;;; Here is our meaning:
    ;;;    &amp;quot;we took a really close look at the two possible cases.IF we can define will-stop?,
    ;;;     then (will-stop? last-try) must yield either #t or #f.Bu it cannot- due to the very
    ;;;     definition of what will-stop? is supposed to do.This must mean that will-stop? cannot 
    ;;;     be defined&amp;quot;
    ;;;
    ;;;     Because you know,let&#39;s make up some examples.
    ;;;     what is the value of (will-stop? last-try) (eternity (quote ()))))
    ;;;         That depends on the value of (will-stop? last-try)
    ;;;
    ;;;         we said that will-stop? will stop,so it must return #t or #f,
    ;;;         let&#39;s say (will-stop? last-try) is #f ,yes,itis .we predict just the opposite
    ;;;            if the value of (will-stop? last-try) is #f,which really means that last-try
    ;;;            will not stop..
    ;;;        So we must have been wrong about (will-stop? last-try) (because it cannot be stopped)
    ;;;               That&#39;s correct.It must return #t,because will-stop? always gives an answer. we
    ;;;               said it total(assume)
    ;;;         Fine. If(will-stop? last-try) is #t. What is the value of (last-try (quote ())) in the definition of last-try.
    ;;;           Now we just need to determine the value of (and #t (eternity (quote ()))
    ;;;           which is the same as the value of (eternity (quote ()))
    ;;;
    ;;;           What is the value of (eternity (quote ())) 
    ;;;                 It doesn&#39;t have a value.we know that it doesn&#39;t stop
    ;;;                 !
    ;;;         But that means that we were wrong again!!! The will-stop? neither return #f nor #t. What the hell
    ;;;                will-stop? will return?
    ;;;
    ;;;         So will-stop? cannot be defined.
    ;;;         Is this unique?
    ;;;                Yes , it is .It makes will-stop? the first function that we can describe percisely but cannot 
    ;;;                define in our language.
    ;;;
    ;;;         Is there any way around this problem?
    ;;;                No ,thank you  ,Alan M. Turing (1912-1954)
    ;;;                and Kurt Godel(1906-1978)
    ;;;
    ;;;         What is (define...)
    ;;;                 That is an interesting question. We just saw that (define...) doesn&#39;t work for will-stop?.
    ;;;
    ;;;             So what are the recurive definition?
    ;;;               Hold tight,take a deep breath,and plunge forward when you&#39;re ready.


;;;;;;;;;;;;;;;;;;;;;;;The second part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;****************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;
;;;
;;;
;;;;;;;;;;;;;;;;;;;;;;;The third part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;   myracet3.rkt;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(define length 
  (lambda (l)
    (cond 
      ((null? l) 0)
      (else (+ 1 (length (cdr l)))))))
(define eternity
  (lambda (x)
    (eternity x)))
(lambda (l)
    (cond 
      ((null? l ) 0)
      (else (+ 1 (eternity (cdr l))))))
;length&amp;lt;=1
(lambda (l)
    (cond 
      ((null? l) 0)
      (else 
       (+ 1 
          ((lambda (l)
             (cond 
               ((null? l) 0)
               (else (+ 1 
                        (eternity (cdr l))))))
           (cdr l))))))

;length &amp;lt;=2
(lambda (l)
    (cond 
      ((null? l) 0)
      (else
       (+ 1
        ((lambda (l)
           (cond
             ((null? l) 0)
             (else 
              (+ 1
                 ((lambda (l)
                    (cond
                      ((null? l) 0)
                      (else
                       (+ 1
                          (eternity
                           (cdr l))))))
                  (cdr l))))))
         (cdr l))))))

;;; Now what do you thin recursion is?
;;;           What do you mean?
;;;
;;; Well,we have seen how to determine the length of a list with no items,with no more that
;;; one item,with no more than two items,and so on. How could we get the function length back.
;;;           If we could write an infinite function in the style of length0 ,length1,length2..
;;;           then we could write lengthinfinite,which would determine the length of all lists
;;;           we can make.
;;;     But we cannot write an infinite function. No we can&#39;t, (yes ,we can&#39;t mae it)
;;;
;;;      And we still have all these repetitions and patterns in these functions. yes we do.
;;;
;;;      What do these pattern look like?
;;;               All these programs contain a function that looks like length.Perhaps we should
;;;               abstract out this function: see The Ninth Commandment.
;;;     We need a function that looks just lie length but starts with (lambda (length) ...).
;;;
;;;Do you mean this?
;;;((lambda (length)
;;;(lambda (l)  (cond ((null? l) 0)  (else (add1 (length (cdr l)))))) eternity)
;;;       Yes,that&#39;s okay. It creates length0
;;;so rewrite length1  in the same style
;;;See below.
;;;
;;;
;we need a function that looks just like length 
;but starts with (lambda (length)...) and inside it is not 
;(lambda (length) but maybe (lambda (l)
;length0
(lambda (legnth)
  (lambda (l)
      (cond 
        ((null? l) 0)
        (else (add1 (length (cdr l))))))
    eternity)


;length1
((lambda (f)
    (lambda (l)
      (cond 
        ((null? l) 0)
        (else 
         (+ 1 (f (cdr l)))))))
   ((lambda (g)
      (lambda (l)
        (cond 
          ((null? l) 0)
          (else (+ 1 (g (cdr l)))))))
    eternity))

;;  Do we have to use length to name the argument?
;;         No ,we just used f and g. As long as we are consistent,everything&#39;s okay
;length2
;;length &amp;lt;=2
((lambda (length)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (+ 1 (length (cdr l)))))))
 ((lambda (length)
    (lambda (l)
      (cond
        ((null? l) 0)
        (else (+ 1 (length (cdr l)))))))
  ((lambda (length)
     (lambda (l)
       (cond
         ((null? l) 0)
         (else (+ 1 (length (cdr l)))))))
   eternity)))

;;; close,  But there are still repetitions.  True,let&#39;s get rid of it.
;;;
;;;  Where should we start?
;;;         Name the function that takes length as an argument and that returns a function that looks like length.
;;;  What&#39;s a good-name for this function?
;;;           how about mk-length  for &amp;quot;make length&amp;quot;
;;;
;let eternity move ahead , eternity in the first part
((lambda (mk-length)
   (mk-length eternity))
 (lambda (length)
   (lambda (l)
     (cond 
       ((null? l) 0)
       (else (+ 1 (length (cdr l))))))))

((lambda (mk-length)
   ;;提取池
   (mk-length 
    (mk-length eternity)))
 ;;发生池
 (lambda (length)
   (lambda (l)
     (cond 
       ((null? l) 0)
       (else (+ 1 (length (cdr l))))))))
;;length&amp;lt;=2
((lambda (mk-length)
   ;;提取池
   (mk-length 
    (mk-length 
     (mk-length eternity))))
 ;;发生池
 (lambda (length)
   (lambda (l)
     (cond 
       ((null? l) 0)
       (else (+ 1 (length (cdr l))))))))
 ;;length &amp;lt;=3
 ((lambda (mk-length)
   ;;提取池
   (mk-length 
    (mk-length 
     (mk-length
      (mk-length eternity)))))

  ;;;;              So   What is recursion like?
  ;;;                             It is like an infinite tower of applications of mk-length to ab arbitrary function.
  ;;;               Do you really need an infinite tower?
  ;;;                      Not really of course.Everytime we use length we only need a finite number,but we never know 
  ;;;                      know many.
  ;;;               could we guess how many we need?
  ;;;                     Sure,but we may not guess a large enough number!
  ;;;               When do  we  find out that we didn&#39;t guess a large enough number?
  ;;;                     When we apply the function eternity that is  passed to innermost mk-length.
  ;;;               What if we could create another application of mk-length to eternity at this point?
  ;;;                       That would only postpone the problem by one and besides,how could we do that?
  ;;;
  ;;;                Well,since nobody cares what function we passwd to mk-length we could pass it mk-length initially.
  ;;;                      That&#39;s the right idea(right?       )             And then we invoke mk-length on eternity and the 
  ;;;                      result of this on the cdr so that we get one more piece of this tower.
 ;;发生池
 (lambda (length)
   (lambda (l)
     (cond 
       ((null? l) 0)
       (else (+ 1 (length (cdr l))))))))
 
 ;;how if we replace the eternity with the mk-length
 
 ;length0; 因为没有人关心我们到底我们传递什么给mk-length 如果他是无穷的话
 ;那我们可不可以第一次初始化的时候就传递给他 mk-length 来替代eternity呢？
 ;;; Yes,we could even use mk-length instead of length.
 ((lambda (mk-length)
     (mk-length mk-length))
   (lambda (length)
     (lambda (l)
       (cond 
         ((null? l) 0)
         (else (+ 1 
                  (length (cdr l))))))))
 ;;和上面一样
 ((lambda (mk-length)
     (mk-length mk-length))
   (lambda (mk-length)
     (lambda (l)
       (cond 
         ((null? l) 0)
         (else (+ 1 
                  (mk-length (cdr l))))))))
 ;; WHy would we want to do that?
 ;;         All names are equal, but some names are more equal than others! (with apologies to George Orwell(1903-1950)
 ;;         True: as long as we use the names consistently ,we are just fine.
 ;;
 ;;     And mk-length is a far more equal  name than length. If we use a name like mk-length, it is a  contstant reminder that
 ;;      the first argument to mk-length is mk-length
 
 ;;我们为什么想着上面的做法呢？
 ;;因为所有的名字都是一样的，但是有些名字是更一样比其他
 ((lambda (mk-length)
    (mk-length mk-length))
  (lambda (mk-length)
    (lambda (l)
      (cond 
        ((null? l) 0)
        (else (add1 
               ((mk-length eternity)
                (cdr l))))))))
 
 ((lambda (mk-length)
    (mk-length mk-length))
  (lambda (mk-length)
    ((lambda (length)
       (lambda (l)
         (cond
           ((null? l) 0)
           (else (add1 (length (cdr l)))))))
     (mk-length mk-length))))

;;; How about this?
;;;     Yes,this looks just fine.
;;; Let&#39;s see thether it works?
;;;      Yes ,okay
;;; First,we need to know the value of it?

 
 ;;; what would  you call this  function above?
 ;;;        It&#39;s length,of course
 ;;;
 ;;;    How does it work?
 ;;;           It keeps adding recurive uses by  passing mk-length to itself,just as it is about to expire
 ;;;
 ;;;           One problem is left: it  no longer contains the function that looks like length.
 ;;;
 ;;;           can you fix the (mk-length mk-length) .?
 ;;;            We could extract this new application of mk-length to itself and call it length
 ;;;        WHy?
 ;;;             Because it really makes the function length.
 
 ;;since (mk-length mk-length returns a fucntion of one argument,
 ;;does (lambda (x) ((mk-length mk-length) x)) retrun a function of
 ;;one argument? Actually,it is a function
 ;;
 ;;Okay ,let&#39;s do this to the application of mk-length to itself
  ((lambda (mk-length)
    (mk-length mk-length))
  (lambda (mk-length)
    (lambda (l)
      (cond 
        ((null? l) 0)
        (else (add1 
               ((lambda (x)
                  ((mk-length mk-length) x))
                (cdr l))))))))
  
  ;;move out the new function so that we get length back
  ;;Why can&#39;t you move out (lambda (x) ((mk-length mk-length) x))  
  ;;       
  ;;            Because you add the (lambda (length)  which is like the definition of define.(actually are)
  ;;            also here the meaning of length is  (lambda(x) ((mk-length mk-length) x)),so you can use the
  ;;            usage of lambda(length) and the definition of length in the same S-expressions!!(By zhaoliang)
  ;;                    You know the same S-expression (the same parathese here)
  ;;
  ;;            Is it okay to move out the function?
  ;;                     Yes,we just always did the opposite by replacing a name with its value. Here we
  ;;                     extract a value and give it a name.
  ;;            Can we extract the function in the box(p171) that looks like length and give it a name
  ;;                          Yes,it does not depend on mk-length at all!
  ((lambda (mk-length)
     (mk-length mk-length))
   (lambda (mk-length)
     ((lambda (length)
        (lambda (l)
          (cond 
            ((null? l) 0)
            (else
             (add1 (length (cdr l)))))))
      (lambda (x)
        ((mk-length mk-length) x)))))


;;;;;;;;;;;;;;;;;;;;;;;The third part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;***************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;The fourth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;  myracet4.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;; Is this the right function!             ------you can check back the nottation above.
;;;
;;;Here the definition of le(lambda (length)...) and the usage of le (lambda (le)...) is in the same 
;;;S-expressions!!(the same parathese)
;;;
((lambda (le)
   ((lambda (mk-length)
      (mk-length mk-length))
    (lambda (mk-length)
      (le (lambda (x)
            ((mk-length mk-length) x))))))
 (lambda (length)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (add1 (length (cdr l))))))))

;;;; Let&#39;s separate the funtion that makes length from the function that looks like length.
(lambda (le)
  ((lambda (mk-length)
     (mk-length mk-length))
   (lambda (mk-length)
     (le (lambda (x)
           ((mk-length mk-length) x))))))
;;; Does this function have a name?
;;;         Yes ,it is called the application-order Y combinator.
(define Y
  (lambda (le)
    ((lambda (f) 
       (f f))
     (lambda (f)
       (le (lambda (x)
             ((f f) x)))))))
;;; the above function is replace the mk-length with  f ,so it looks more common!      BUt
;;;      it lacks the definition of (le)  just the usage of le.so it means the Y combinator.
;;;
;;;      (lambda (length)
;;;            (lambda  (l)
;;;                 ...           ---&amp;lt; it is the definition of function length
;;;
;;;     ((lambda  (le)
;;;          ...
;;;        )
;;;     (lambda (length)
;;;         ...
;;;         ))
;;;                             ----&amp;lt;  it is the definition of function le is the (lambda (length)...)) and the use 
;;;                             of the le is in the (lambda (le) ...)   Take care what the left parathese and right 
;;;                             parathese I utilize.
;;;                             ----------------------which is similar to apply-closure that contains three part
;;;                                                            table-of   form-of    body-of


;; An entry is a pair of lists whose first list is a set. Also ,the two lists must be of equal 
;; length.Make up some examples for entries
;;              Here are some examples:
;;              ((appetizer entree beverage)
;;              (pate boeuf vin))
;;
;;              and
;;              ((appetizer entree beverage)
;;              (beer beer beer)  ---------------------------&amp;lt; but the second list can be not a set
;;
;;              and 
;;              (( beverage dessert)
;;               ((food is) (number one with us)))
;;
;;
;;How can we build an entry from a set of names and a list of values?
;;           (define new-entry build)           ----&amp;gt;Try to build our examples with this function.
;;
;;What is (lookup-in-entry name entry)
;;     where name is entree
;;
;;     and entry is ((appetizer entree beverage)
;;                   (food tastes  good))
;;                ------------------------------&amp;gt;tastes
;;
;;      What if name is dessert
;;             In this case we would like to leave the decision about what to do with the user of lookup-in-entry
;;      How can we accomplish this?
;;             lookup-in-entry takes an additional argument this is invoked when name is not found in the first 
;;                list of an entry.
;;
;;      How many arguments do you think this extra function should take?
;;            We think it should take one , name. Why?
;;
;;;;;;;;;;;;;;;;;;;;;;;The fourth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;***************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;The fifth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;myracet5.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;
;;;

(define atom?
  (lambda (x)
    (and (not (pair? x)) (not (null? x)))))
  
(define build
  (lambda (s1 s2)
    (cond
      (else (cons s1
                  (cons s2 (quote ())))))))
((lambda (nothing)
     (cond
       (nothing (quote something))
       (else (quote nothing))))
   #t)

;;;; Here is our dfinition of lookup-in-entry:
(define lookup-in-entry
  (lambda (name entry entry-f)
    (lookup-in-entry-help name
                          (first entry)
                          (second entry)
                          (entry-f))))
;;;Finish the function lookup-in-entry-help-----------------
;;;
;;;
(define lookup-in-entry-help
  (lambda (name names values entry-f)
    (cond
      ((null? names) (entry-f name))
      ((eq? (car names) name)
       (car values))
      (else (lookup-in-entry-help name
                                  (cdr names)
                                  (cdr values)
                                  entry-f)))))
;;;     A table(based on entries) (also   called an environment) is a list of entries.Here is one example: The empty table
;;;     ,represented by ()
;;;     Make up some others.
;;;      Here is another one:
;;;                          (((appetizer entree beverage)
;;;                            (pate boeuf vin))
;;;                            ((beverage desert)
;;;                             ((food is) (number one with us)))
;;;                           )
;;;
;;;         Define the function extend-table which takes an entry and a table (possibly the empty one)
;;;         and create a new table by putting the new entry in front of the old table.
;;;         (define extend-table cons)
;;;
;;; What is  
;;;         (lookup-in-table name table table-f)
;;;          where 
;;;                 name is entree
;;;                 table is (((entree dessert)
;;;                            (spaghetti spumoni))
;;;                           ((appetizer entree beverage)
;;;                            (food tastes good)))
;;;                 and 
;;;                    table-f is (lambda (name) ...)
;;;
;;;             -----&amp;gt; It could be either spaghetti or tastes,but lookup-in-table searches the list of entries in order
;;;                    So it is spaghetti
;;;
;;; Can you describe what the following function 
;;; represents:
;;;            (lambda (name)
;;;                (lookup-in-table name
;;;                     (cdr table)
;;;                     table-f))
;;;
;;;                     ---------------------------&amp;gt; This function is the action to take when the name is not found in the first entry
;;;                                                  In one table there are a set of entries (set means each of the entries is different 
;;;                                                  from each other)
;;;
;;; Have we chosen a good representation for expressions?
;;;           Yes .They are all S-expressions so they can be data for functions.
;;; What kind of functions?
;;;           For example ,value(later on ,the value is defined as another name  compiler.(like gcc  gfortran  ifort  python perl etc)
;;;
;;; Do you remember value from chapter 6?
;;;          Recall that value is the function that returns the natural value of expressions.
;;;
;;; What is the value of
;;;  (car (quote (a b c)))
;;;         We don&#39;t even know  what (quote (a b c)) is .---------------------------------&amp;lt;&amp;lt;&amp;lt;&amp;lt;The original state of you learning english!
;;;                                                                          You don&#39;t know &#39;am&#39; &#39;are&#39; &#39;is&#39; etc.
;;;
;;;What is the value of
;;;      (cons rep-a
;;;        (cons rep-b
;;;          (cons rep-c
;;;             (quote ()))))
;;;
;;;     Where 
;;;       rep-a is a
;;;       rep-b is b
;;;     and
;;;       rep-c is c
;;;                                         ==================&amp;gt;&amp;gt; It is the same as (a b c)
;;;
;;;And what is the value of
;;; (cons rep-car
;;;     (cons (cons rep-quote
;;;              (cons 
;;;                  (cons rep-a
;;;                     (cons rep-b
;;;                        (cons rep-c
;;;                             (quote ()))))
;;;                  (quote ())))
;;;       (quote ())))
;;;       where 
;;;         rep-car is car
;;;         rep-quote is quote
;;;         rep-a is a
;;;         rep-b is b
;;;         and
;;;         rep-c is c
;;;                                        ====================&amp;gt;&amp;gt; It is the representation of the expressions:
;;;                                                                      (car (quote (a b c)))
;;;
;;;                                                                      ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
;;;                                                                      The above is  what I say: Lisp is the data with program!
;;;                                                                              Data can be code,code can also become data!
;;;
;;; What is value of
;;;      (car (quote (a b c)))           
;;;                                       =====================&amp;gt;&amp;gt; a
;;; What is (value e)
;;;      where 
;;;          e is (car (quote (a b c)))
;;;                                       =====================&amp;gt;&amp;gt; a
;;; What is (value e)
;;;       where 
;;;           e is (quote (car (quote (a b c))))
;;;                                       =====================&amp;gt;&amp;gt; (car (quote (a b c)))
;;;
;;; What is (value e)
;;;        where
;;;            e is (add1 6)
;;;                                        ====================&amp;gt;&amp;gt; 7
;;; What is (value e)
;;;        where 
;;;            e is 6
;;;                                        ====================&amp;gt;&amp;gt; 6 .because numbers are constants
;;; What is (value e)
;;;        where 
;;;            e is (quote nothing)
;;;                                        ====================&amp;gt;&amp;gt; nothing
;;; What is (value e)
;;;         where
;;;           e is ((lambda (nothing)
;;;                    (cons nothing (quote ())))
;;;                 (quote 
;;;                    (from nothing comes something)))
;;;                                        ====================&amp;gt;&amp;gt; ((from nothing come something)).
;;;
;;;
;;;
;;; What is (value e)
;;;        where 
;;;            e is ((lambda (nothing)
;;;                     (cond
;;;                        (nothing (quote something))
;;;                        (else (quote nothing))))
;;;                  #t)             -------------------------&amp;lt; It means nothing is #t(The semtatics of language (the infer of language))
;;;
;;;                                       =====================&amp;gt;&amp;gt; something
;;;
;;; What is the type of e
;;;         where  
;;;              e is 6
;;;                                        ====================&amp;gt;&amp;gt; *const
;;; What is the type of e
;;;         where 
;;;              e is #f
;;;                                       ======================&amp;gt;&amp;gt; *const
;;; What is (value e)
;;;         where 
;;;              e is #f                 ======================&amp;gt;&amp;gt; #f
;;;; What is the type of e
;;;         where 
;;;              e is cons
;;;                                       ======================&amp;gt;&amp;gt; *const             -----------------------&amp;gt;I think is must be somethin wrong 
;;;                                                                                   -----------------------&amp;gt;I think it is primitive car
;;;                                                                                   -----------------------&amp;gt;I am wrong ,primitive is also *const
;;;;; What is the type of e
;;;         where 
;;;              e is car
;;;                                       ======================&amp;gt;&amp;gt; (primitive car)
;;;
;;;;;; What is the type of e
;;;         where 
;;;              e is (quote nothing)
;;;                                       ======================&amp;gt;&amp;gt; *quote
;;; What is the type of e
;;;         where 
;;;              e is nothing
;;;                                       ======================&amp;gt;&amp;gt; *identifier
;;;;;; What is the type of e
;;;         where 
;;;              e is (lambda (x y) (cons x y))
;;;                                       ======================&amp;gt;&amp;gt; *lambda
;;; What is the type of e
;;;         where 
;;;              e is ((lambda (nothing)
;;;                      (cond
;;;                          (nothing (quote something))
;;;                          (else (quote nothing))))
;;;                     #t)
;;;                                       ======================&amp;gt;&amp;gt; *application
;;; What is the type of e
;;;         where 
;;;              e is (cond
;;;                      (nothing  (quote something))
;;;                      (else (quote nothing)))
;;;                                       ======================&amp;gt;&amp;gt; *cond
;;;
;;; How many types do you think there are?
;;;                          we found six:
;;;                                         *const
;;;                                         *quote
;;;                                         *identifier
;;;                                         *lambda
;;;                                         *cond
;;;                                         and
;;;                                           *application
;;; How do you think we should represent types?
;;;              We choose functions.We call these functions &amp;quot;action&amp;quot;;------------------------------------&amp;lt;In python ,it is called as objects
;;;                                                                   or,in oop(orient object programming) ,it is called as objects
;;;
;;; If actions are functions that do &amp;quot;the right thing&amp;quot;  when applied to the appropriate type of expression,
;;;                 What should value do?
;;;     You guessed it. It would have to find out the type of expression it was passed  and then use the associated action.
;;;
;;; Do you remember atom-to-function from chapter8?
;;;         We found atom-to-function usefule when we rewrote value for numbered expressions.

;;;
;;;
(define lookup-in-table
  (lambda (name table table-f)
    (cond 
      ((null? table) (table-f name))
      (else (lookup-in-entry name
                             (car table)
                             (lambda (name)
                               (lookup-in-table name
                                                (cdr table)
                                                (table-f))))))))
(lambda (name table table-f)
    (lookup-in-table name
                     (cdr table)
                     (table-f)))
;;; Below is a function that produces the correct action (or function) for each possible S-expression:
;;;
;;; The top level make-up
(define expression-to-action
  (lambda (e)
    (cond
      ((atom? e) (atom-to-action e))
      (else (list-to-action e)))))

;;; IN the III-formed S-expressions suchas (quote a b), () , (lambda (#t) #t),(lambda (4) 4)  ,(lambda (car) car)
;;;         (lambda a),(cond (3 c) (else b) (5 a)) , And (1 2) are not considered here.They can be detected by an 
;;;         appropriate function to which S-expressions are submitted before they are passed to value.

(define atom-to-action
  (lambda (e)
    (cond
      ((number? e) *const)
      ((eq? e #t) *const)
      ((eq? e #f) *const)
      ((eq? e (quote cons)) *const)
      ((eq? e (quote car)) *const)
      ((eq? e (quote cdr)) *const)
      ((eq? e (quote null?)) *const)
      ((eq? e (quote eq?)) *const)
      ((eq? e (quote atom?)) *const)
      ((eq? e (quote zero?)) *const)
      ((eq? e (quote add1)) *const)
      ((eq? e (quote sub1)) *const)
      ((eq? e (quote number?)) *const)
      (else *identifier))))
;;;; so *const is consed by three parts: primitive part ,number , #t or #f part.(not include string part, because string part is called *identifier)
;;;
;;;By zhaoliang
;;;It means that the following identifier can see the list as its function&#39;s argument!    --------------------------&amp;lt;
(define list-to-action
  (lambda (e)
    (cond
      ((atom? (car e))
       (cond
         ((eq? (car e) (quote quote))
          *quote)
         ((eq? (car e) (quote lambda))
          *lambda)
         ((eq? (car e) (quote cond))
          *cond)
         (else *application)))
      (else *application))))

;;;;; So the compiler is comming on the way............................
;;;       If we assuming the expression-to-action works,we can use it to define value and meanning
;;;
;;;
(define value
  (lambda (e)
    (meaning e (quote ()))))  ;;;Now table is empty set.
(define meaning
  (lambda (e table)
    ((expression-to-action e) e table)))

;;;; The function value, together with all the functions it uses ,is called an interpreter.(Note that: all the relevent function value use
;;;
;;;The function value approximates the function eval  available in Schemes(and Lisp)
;;;
;;;How many arguments should actions take according to the above?
;;;
;;;             Two,the expression e and a table
;;;
;;;
;;; Here is the action for constants:
;;;
;;;
;;;
(define *const
  (lambda (e table)
    (cond 
      ((number? e) e)
      ((eq? e #t) #t)
      ((eq? e #f) #f)
      (else (build (quote primitive) e)))))  ;;;;-----------------&amp;lt;&amp;lt;&amp;lt;&amp;lt; Yes,primitive car,primitive con,primitive cdr

;;; Here is the action for constants:
;;; 
;;;
(define *quote
  (lambda (e table)
    (text-of e)))

(define first
  (lambda (p)
    (cond 
      (else (car p)))))

(define second
  (lambda (p)
    (cond
      (else car (cdr p)))))

(define third
  (lambda (p)
    (cond 
      (else car (cdr (cdr p))))))

(define text-of second)

;;; Have we used the table yet?
;;;                   No, But we will in a moment.
;;;
;;; Why do we need the table?
;;;                   To remember the values of identifiers
;;;
;;;; Given that the table contains the values of identifiers ,write the action of *identifier
;;;
(define *identifier
  (lambda (e table)
    (lookup-in-table e table initial-table)))

;;; Here is the initial-table ---------------------------------------------&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;
(define initial-table
  (lambda (name)
    (car (quote ()))))

;;; When is it used?
;;;                       Let&#39;s hope never. Why?
;;
;;What is the value of (lambda (x) x)
;;         We don&#39;t know yet, But we know that it must be the representation for a non-primitive
;;                  function.
;;
;;  How are non-primitive functions different from primitives?
;;   We know what primitives do;  non-primitives are defined by their argumentss and their function bodier
;;                                                     ^^^^^ ^^ ^^^^^ ^^^^^^^^^^ ^^^ ^^^^^ ^^^^^^^^ ^^^^^^
;;                                                     What does it mean?
;;                                                      arguments (x y ...)       function bodier: x
;;  So when we want to use a non-primitive we need to remember its formal arguments and its function body.
;;       At least. Fortunately this is just the cdr of a lambda expression! Because the car of the lambda expression is lambda
;;
;;  And what else do we need to remember?
;;                             
;;                              We wll also put the table in,just in case we might need it later
;;
;;  And How do we represent this?
;;                   In a list,of course.
;;
;; Here is the action *lambda
;;
(define *lambda
  (lambda (e table)
    (build (quote non-primitive)
           (cons table (cdr e)))))
;;; What is (meanning a table)
;;;        where
;;;              e is (lambda (x) (cons x y))
;;;        and
;;;              table is (((y z) ((8) 9)))
;;;
;;;              ==========================================&amp;gt;&amp;gt;&amp;gt; (non-primitive
;;;                                                                   (   (((y z) ((8) 9)))         (x)             (cons x y)   ))
;;;                                                                       ^^^^^^^^^^^^^^^^^         ^^^             ^^^^^^^^^^^^^^^
;;;                                                                           table                 formals             body
;;;It is probably a good idea to define some help functions for getting back the parts in this three elements
;;;list (i.e. the tables,the formal arguments,and the body).
;;;
(define table-of first)
(define formals-of second)
(define body-of third)


;;; Describe (cond...) in your own words
;;;     
;;;      It is a special form that takes any number of cond-lines. It considers
;;;      each line in turn. If the question part on the left is false, it looks
;;;      at the rest of the lines.Otherwise it proceeds to answer the right part.
;;;       If it sees an else-line,it treats that cond-line as if its question part
;;;       were true.

;;;;
;;; Here is the function evcon that does what we said in words
;;;
(define evcon
  (lambda (lines table)
    (cond 
      ((else? (question-of (car lines)))
       (meaning (answer-of (car lines))
                table))
      ((meaning (question-of (car lines))
                table)
       (meaning (answer-of (car lines))
                table))
      (else (evcon (cdr lines) table)))))

;;;; else? determine whether the (car expression)  is else or not!
(define else?
  (lambda (x)
    (cond
      ((atom? x) (eq? x (quote else)))
      (else #f))))
;;; didn&#39;t we violate the First Commandment?
;;;          Yes,we don&#39;t ask (null? lines), so one of the questions in every cond better be true
(define question-of first)
(define answer-of second)

;;; Now use the function evcon to write the *cond action
;;; 
;;; Here is the action for *cond
;;;
(define *cond
  (lambda (e table)
    (evcon (cond-lines-of e) table)))
;;; Aren&#39;t these help functions useful?
;;;          Yes they make things quite a bit more readable.But you already knew that.
;;;
;;; Do you understand *cond now?
;;;           Perhaps not
;;;
;;; How can you become familiar with it?
;;;         The best way is to try an example.
;;;         A good one (examples ) is
;;;                (*cond e table)
;;;                  where 
;;;                       e is (cond (coffee klatsch) (else (party))
;;;                  and 
;;;                       table is (((coffee) (#t))
;;;                                 ((klatsch party) (5 (6))))
(define cond-lines-of cdr)

;;; Have we seen how the table gets used?
;;;            Yes,*lambda and *identifier use it
;;;
;;;But how do the identifiers get into the table?
;;;            In the only action we have not defined:
;;;                      *application
;;;                      ^^^^^^^^^^^^
;;;                      ||||||||||||
;;; How is an application represented?
;;;       
;;;        An application us a list of  expressions whose car position contains an expression whose value is a function.
;;;
;;;How does an application differ from a special form, like (and ...) (or ...) or (cond ...)
;;;     An application must always determine the meaning of all its arguments.
;;; Before we can apply a function ,do we have to get the meaning of all of its arguments?
;;;       Yes.
;;;
;;; Write a function evils that takes a list of (representations of) arguments and a table, and
;;;  returns a list composed of the meaning of each argument
;;;
(define evlis
  (lambda (args table)
    (cond
      ((null? args) (quote ()))
      (else
       (cons (meaning (car args) table)  ;;; really  importan  for every argument!
             (evlis (cdr args) table))))))
;;;; What else do we need before we can determine the meaning of an application?
;;;
;;;We need to find out what its function-of means
;;;
;;;And what then?
;;;  
;;;  Then we apply the meaning of the function to the meaning of the arguments
;;;
;;;  Here is *application
;;;
(define *application
  (lambda (e table)
    (apply
     (meaning (function-of e) table)
     (evlis (arguments-of e) table))))
;;; Of course, we just have to define apply , function-of, and arguments-of correctly
;;;
(define function-of car)

(define arguments-of cdr)

;;;; How many different kinds of functions are there?
;;;
;;;     Two: primitive and non-primitive
;;; What are the two representation of functions?
;;;
;;; (primitive primitive-name)
;;; and (non-primitive (table formals body))
;;;      The list (table formals body) is called a  closure record.
;;;
;;;      Write primitive? and non-primitive?
(define primitive?
  (lambda (l)
    (eq? (first l) (quote primitive))))
(define non-primitive?
  (lambda (l)
    (eq? (first l) (quote non-primitive))))
;;;
;;; If fun does not evaluate to either a primitive or a non-primitive as
;;;         in the expression ((lambda (x) (x 5)) 3) ------&amp;lt;&amp;lt;&amp;lt; This expression cannot be detected in the now preocedure
;;;         there is no answer. The function apply approximatly the funcion apply available in Scheme (and lisp)
;;;
(define apply
  (lambda (fun vals)
    (cond
      ((primitive? fun)
       (apply-primitive
        (second fun) vals))
      ((non-primitive? fun)
       (apply-closure
        (second fun) vals)))))

;;;; This is the definition of apply-primitive
;;;
(define apply-primitive
  (lambda (name vals)
    (cond
      ((eq? name (quote cons))
       (cons (first vals) (second vals)))
      ((eq? name (quote car))
       (car (first vals)))
      ((eq? name (quote cdr))
       (cdr (first vals)))
      ((eq? name (quote null?))
       (null? (first vals)))
      ((eq? name (quote eq?))
       (eq? (first vals) (second vals)))
      ((eq? name (quote atom?))
       (:atom? (first vals)))
      ((eq? name (quote zero?))
       (zero? (first vals)))
      ((eq? name (quote add1))
       (add1 (first vals)))
      ((eq? name (quote sub1))
       (sub1 (first vals)))
      ((eq? name (quote number?))
       (number? (first vals))))))
(define :atom?
  (lambda (x)
    (cond
      ((atom? x) #t)
      ((null? x) #f)
      ((eq? (car x) (quote primitive))
       #t)
      ((eq? (car x) (quote non-primitive))
       #t)
      (else #f))))
;;;Is apply-closure  the only function left?
;;;        Yes,and apply-closure must extent the table
;;;                    extent the table?
;;;
;;;     how could we first find the result of (f a b)
;;;     where
;;;       f is (lambda (x y) (cons x y))
;;;       a is 1
;;;       and 
;;;       b  is (2)
;;;
;;;       ===================That&#39;s tricky. But we know what to do to find the meaning of (cons x y)
;;;                                               where 
;;;                                                     table is (((x y)
;;;                                                                (1 (2)))).
;;;
;;;  Table is the contain of the variables defined by you!!!
;;;  Why can we do this?
;;;           Here ,we don&#39;t need apply-closure
;;;
;;; Can you generalize the last two steps?
;;;                                 Applying a non-primitive function --a closure---to
;;;                                 a list of values  is the same as finding the meaning  of 
;;;                                 closure&#39;s body with its table extended by an entry of the form
;;;                                 (formals values)
;;;                                 In this entry,formals is the formals of closure and values is 
;;;                                 the result of evils
;;;
(define apply-closure
  (lambda (closure vals)
    (meaning (body-of closure)
             (extend-table
              (new-entry
               (formals-of closure)
               vals)
              (table-of closure)))))
;;;; This is a complicated function and it deserves an example.
;;;         In the following,
;;;              closure is ((((u v w)          ;;; entry name
;;;                            (1 2 3))         ;;; entry value
;;;                            ((x y  z)        ;;;;entry name
;;;                             (4 5 6)))       ;;;; entry value
;;;                            (x y)             ;;; formal
;;;                            (cons z x))        ;;; body 
(define new-entry build)
(define extend-table cons)


;;;;;;;;;;;;;;;;;;;;;;;The fifth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;****************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;The sixth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;; myracet6.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;
;;;
;;;

(define member1?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? a (car lat))
                (member1? a (cdr lat)))))))
;;the most common thinking,find it and then continul
(define is-first?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (eq? (car lat) a)))))

(define two-in-a-row?
  (lambda (lat)
    (cond
      ((null? lat) #f)
      (else
       (or (is-first? (car lat) (cdr lat))
           (two-in-a-row? (cdr lat)))))))
;;;the development, more close,but if-first-b must use
;;the two-in-a-row? ,so can we write a version which 
;;didn&#39;t use two-in-a-row? at all?
(define is-first-b?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? (car lat) a )
                (two-in-a-row? lat))))))
(define two-in-a-row-b?
  (lambda (lat)
    (cond 
      ((null? lat) #f)
      (else
       (is-first-b? (car lat) (cdr lat))))))
;;the is-first-b? only do the job about eq?,so why can I
;;let is-first-b? also do another thing,recur. So I
;;don&#39;t need two-in-a-row? again.
(define is-first-c?
  (lambda (preceding lat)
    (cond
      ((null? lat) #f)
      (else
       (or (eq? (car lat) preceding)
           (is-first-c? (car lat)
                        (cdr lat)))))))
(define two-in-a-row-c?
  (lambda (lat)
    (cond 
      ((null? lat) #f)
      (else (is-first-c? (car lat)
                         (cdr lat))))))
;;although two-in-a-row-c? and two-in-a-row-b? look
;;the same in the shape;
;;but the essence is not the same!
;;version b, is just encasual the is-first? and two-
;;in-a-row?
;;version c, is updated version, used it by itself?

(define sum-of-prefixes-b
  (lambda (sonssf tup)
    (cond
      ((null? tup) (quote ()))
      (else (cons (+ sonssf (car tup))
                  (sum-of-prefixes-b
                   (+ sonssf (car tup));;thinking hole
                   (cdr tup)))))))
;;not leave before,important for your thinking
;;(sum-of-prefixes-b 0 &#39;(1 3 5))
;;two arguments

(define pick
  (lambda (n lat)
    (cond
      ((eq? n 1) (car lat))
      (else 
       (pick (- n 1) (cdr lat))))))


(define scramble-b
  (lambda (tup rev-pre)
    (cond
      ((null? tup) (quote ()))
      (else
       (cons (pick (car tup)
                   (cons (car tup) rev-pre))
             (scramble-b (cdr tup)
                         (cons (car tup) rev-pre)))))))
;;&amp;gt;  (scramble-b &#39;(1 1 1 3 4 2 1 1 9 2) (quote ()))
;;&#39;(1 1 1 1 1 4 1 1 1 9)
;;(scramble-b &#39;(2 1 1 3 4 2 1 1 9 2) (quote ())) have a bug
;;&amp;gt; (scramble-b &#39;(1 2 1 3 4 2 1 1 9 2) (quote ()))
;;&#39;(1 1 1 2 2 4 1 1 1 9)

;;the base procedure
;;result     rev-pre
;;1          1
;;1 1        2(tup di er wei) 1
;;1 1 1      1(tup di san wei) 2 1
;;1 1 1 2    3 1 2 1 (from here to select the index 3 so is 2)
;;1 1 1 2 2  4 3 1 2 1  (select the index 4 of lat)
;;1 1 1 2 2 4    2 4 3 1 2 1
;;1 1 1 2 2 4 1  1 2 4 3 1 2 1
;;1 1 1 2 2 4 1 1     1 1 2 4 3 1 2 1
;;1 1 1 2 2 4 1 1 1   9 1 1 2 4 2 1 2 1
;;1 1 1 2 2 4 1 1 1 9   2 9 1 1 2 4 2 1 2 1
;;actually in the list of the lat,
;;the first number in the rev-pre expose the target I 
;;should get from the rev-pre,so on the one-hand,I should
;;pick-up the value according the index from varient and
;;increasing lat ,on the second hand I should constuct
;;the varient list of revpre!
;;step1 car the current tup 
;;step2 and put it into the list of revpre
;;step3 watch the index it on the list of revpre
;;step4 put the index value into the results! ok!

;;;;;;;;;;;;;;;;;;;;;;;The sixth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;
; Chapter 11 of The Seasoned Schemer:
; Welcome Back to the Show
;
; Code examples assemled by Peteris Krumins (peter@catonmat.net).
; His blog is at http://www.catonmat.net  --  good coders code, great reuse.
;
; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw
;

; Remember member? from The Little Schemer? (http://bit.ly/4GjWdP)
; It finds if an element &#39;a&#39; is in a list of atoms &#39;lat&#39;.
;
(define member?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? a (car lat))
                (member? a (cdr lat)))))))



; member? helper function
;
(define member1?
  (lambda (a l)
    (letrec
      ((yes? (lambda (l)
               (cond
                 ((null? l) #f)
                 ((eq? (car l) a) #t)
                 (else (yes? (cdr l)))))))
      (yes? l))))


; is-first? function finds out whether the next element in lat, if there is
; one, is identical to this element.
;
(define is-first?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (eq? (car lat) a)))))

; two-in-a-row? function determines whether any atom occurs twice in a row.
;
(define two-in-a-row?
  (lambda (lat)
    (cond
      ((null? lat) #f)
      (else
        (or (is-first? (car lat) (cdr lat))
            (two-in-a-row? (cdr lat)))))))

; Examples of two-in-a-row?
;
(two-in-a-row? &#39;(Italian sardines spaghetti parsley))           ; false
(two-in-a-row? &#39;(Italian sardines sardines spaghetti parsley))  ; true
(two-in-a-row? &#39;(Italian sardines more sardines spaghetti))     ; false

; Another version of two-in-a-row? that leaves decision of what to do to
; is-first-b?
;
(define two-in-a-row-2?
  (lambda (lat)
    (cond
      ((null? lat) #f)
      (else
       (is-first-b? (car lat) (cdr lat))))))

; is-first-b? function for two-in-a-row-2?
;
(define is-first-b?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? (car lat) a)
                (two-in-a-row-2? lat))))))

; Examples of two-in-a-row-2?
;
(two-in-a-row-2? &#39;(Italian sardines spaghetti parsley))           ; false
(two-in-a-row-2? &#39;(Italian sardines sardines spaghetti parsley))  ; true
(two-in-a-row-2? &#39;(Italian sardines more sardines spaghetti))     ; false

; Another version of two-in-a-row? that recurs itself instead of using
; is-first?
;
(define two-in-a-row-b?
  (lambda (preceding lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? (car lat) preceding)
                (two-in-a-row-b? (car lat) (cdr lat)))))))

; The final version of two-in-a-row?
;
(define two-in-a-row-final?
  (lambda (lat)
    (cond
      ((null? lat) #f)
      (else (two-in-a-row-b? (car lat) (cdr lat))))))

(two-in-a-row-final? &#39;(Italian sardines spaghetti parsley))           ; false
(two-in-a-row-final? &#39;(Italian sardines sardines spaghetti parsley))  ; true
(two-in-a-row-final? &#39;(Italian sardines more sardines spaghetti))     ; false

; Helper function for upcoming sum-of-prefixes function
;
(define sum-of-prefixes-b
  (lambda (sonssf tup)     ; sonssf stands for &#39;sum of numbers seen so far&#39;
    (cond
      ((null? tup) &#39;())
      (else (cons (+ sonssf (car tup))
                  (sum-of-prefixes-b
                   (+ sonssf (car tup))
                   (cdr tup)))))))

; sum-of-prefixes function finds the running sum of a list of numbers
;
(define sum-of-prefixes
  (lambda (tup)
    (sum-of-prefixes-b 0 tup)))

; Examples of sum-of-prefixes
;
(sum-of-prefixes &#39;(2 1 9 17 0))   ; &#39;(2 3 12 29 29)
(sum-of-prefixes &#39;(1 1 1 1 1))    ; &#39;(1 2 3 4 5)
(sum-of-prefixes &#39;(1 1 1))        ; &#39;(1 2 3)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The eleventh commandment                                                   ;
;                                                                            ;
; Use additional arguments when a function needs to know what the other      ;
; arguments to the function have been like so far.                           ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Remember the pick function from chapter 4 of The Little Schemer?
;
(define pick
  (lambda (n lat)
    (cond
      ((one? n) (car lat))
      (else (pick (sub1 n) (cdr lat))))))

; It uses one? and sub1 helper functions
;
(define one?
  (lambda (n) (= n 1)))

(define sub1
  (lambda (n) (- n 1)))

; scramble-b is a helper function for scramble
;
(define scramble-b
  (lambda (tup rev-pre)
    (cond
      ((null? tup) &#39;())
      (else
       (cons (pick (car tup) (cons (car tup) rev-pre))
             (scramble-b (cdr tup)
                         (cons (car tup) rev-pre)))))))

; scramble
(define scramble
  (lambda (tup)
    (scramble-b tup &#39;())))

; Examples of scramble
;
(scramble &#39;(1 1 1 3 4 2 1 1 9 2))       ; &#39;(1 1 1 1 1 4 1 1 1 9)
(scramble &#39;(1 2 3 4 5 6 7 8 9))         ; &#39;(1 1 1 1 1 1 1 1 1)
(scramble &#39;(1 2 3 1 2 3 4 1 8 2 10))    ; &#39;(1 1 1 1 1 1 1 1 2 8 2)

;
; Chapter 12 of The Seasoned Schemer:
; Take Cover
;
; Code examples assemled by Peteris Krumins (peter@catonmat.net).
; His blog is at http://www.catonmat.net  --  good coders code, great reuse.
;
; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw
;

; add1 primitive
;
(define add1
  (lambda (x) (+ x 1)))

; The Y-combinator
;
(define Y
  (lambda (le)
    ((lambda (f) (f f))
     (lambda (f)
       (le (lambda (x) ((f f) x)))))))

; length function written via Y-combinator and applied to &#39;(a b c)
;
((Y (lambda (length)
     (lambda (l)
       (cond
         ((null? l) 0)
         (else (add1 (length (cdr l)))))))) &#39;(a b c))  ; produces output 3

; No need to pass &#39;a&#39; around in multirember
; Use Y-combinator not to pass it around
;
(define multirember
  (lambda (a lat)
    ((Y (lambda (mr)
          (lambda (lat)
            (cond
              ((null? lat) &#39;())
              ((eq? a (car lat)) (mr (cdr lat)))
              (else
               (cons (car lat) (mr (cdr lat))))))))
     lat)))

; Example of multirember
;
(multirember &#39;a &#39;(a b c a a a x))             ; &#39;(b c x)

; multirember via letrec
;
(define multirember-letrec
  (lambda (a lat)
    ((letrec
       ((mr (lambda (lat)
              (cond
                ((null? lat) &#39;())
                ((eq? a (car lat)) (mr (cdr lat)))
                (else
                  (cons (car lat) (mr (cdr lat))))))))
       mr)
     lat)))

; Example of multirember-letrec
;
(multirember-letrec &#39;a &#39;(a b c a a a x))      ; &#39;(b c x) 

; Structure of letrec
;
; ((letrec ((mr ...)) mr) values)

; Another way to write multirember via letrec
;
(define multirember-letrec-2
  (lambda (a lat)
    (letrec
      ((mr (lambda (lat)
             (cond
               ((null? lat) &#39;())
               ((eq? a (car lat)) (mr (cdr lat)))
               (else
                 (cons (car lat) (mr (cdr lat))))))))
       (mr lat))))

; Another test of applying multirember-letrec-2
;
(multirember-letrec-2 &#39;a &#39;(a b c a a a x))      ; &#39;(b c x) 

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The twelfth commandment                                                    ;
;                                                                            ;
; Use (letrec ...) to remove arguments that do not change for recursive      ;
; applications.                                                              ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Yet another way to write multirember via letrec
;
(define multirember-letrec-3
  (letrec
    ((mr (lambda (a lat)
           (cond
             ((null? lat) &#39;())
             ((eq? (car lat) a) (mr a (cdr lat)))
             (else
               (cons (car lat) (mr a (cdr lat))))))))
    mr))

; Test multirember-letrec-3
;
(multirember-letrec-3 &#39;a &#39;(a b c a a a x))      ; &#39;(b c x) 

; The member? function determines if the given element is in the list
;
(define member?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      ((eq? (car lat) a) #t)
      (else (member? a (cdr lat))))))

; Test member?
;
(member? &#39;x &#39;(a b c x d e f))   ; #t
(member? &#39;x &#39;(a b c d e f))     ; #f

; member? via letrec
;
(define member-letrec?
  (lambda (a l)
    ((letrec
       ((yes? (lambda (l)
                (cond
                  ((null? l) #f)
                  ((eq? (car l) a) #t)
                  (else (yes? (cdr l)))))))
     yes?)
    l)))

; Test member-letrec?
;
(member-letrec? &#39;x &#39;(a b c x d e f))   ; #t
(member-letrec? &#39;x &#39;(a b c d e f))     ; #f

; Another member? via letrec
;
(define member-letrec-2?
  (lambda (a l)
    (letrec
      ((yes? (lambda (l)
               (cond
                 ((null? l) #f)
                 ((eq? (car l) a) #t)
                 (else (yes? (cdr l)))))))
      (yes? l))))

; Test member-letrec-2?
;
(member-letrec-2? &#39;x &#39;(a b c x d e f))   ; #t
(member-letrec-2? &#39;x &#39;(a b c d e f))     ; #f

; The union function takes two sets and merges them
;
(define union
  (lambda (set1 set2)
    (cond
      ((null? set1) set2)
      ((member? (car set1) set2) 
       (union (cdr set1) set2))
      (else
        (cons (car set1) (union (cdr set1) set2))))))

; Example of union
;
(union
  &#39;(tomatoes and macaroni casserole)
  &#39;(macaroni and cheese)) ; &#39;(tomatoes and macaroni casserole cheese)

; union via letrec
;
(define union-letrec
  (lambda (set1 set2)
    (letrec
      ((U (lambda (set)
            (cond
              ((null? set) set2)
              ((member? (car set) set2)
               (U (cdr set)))
              (else
                (cons (car set) (U (cdr set))))))))
      (U set1))))

; Test of union-letrec
;
(union-letrec
  &#39;(tomatoes and macaroni casserole)
  &#39;(macaroni and cheese)) ; &#39;(tomatoes and macaroni casserole cheese)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The thirteenth commandment                                                 ;
;                                                                            ;
; Use (letrec ...) to hide and to protect functions.                         ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(define union-letrec-protected
  (lambda (set1 set2)
    (letrec
      ((U (lambda (set)
            (cond
              ((null? set) set2)
              ((M? (car set) set2)
               (U (cdr set)))
              (else
                (cons (car set) (U (cdr set)))))))
       (M?
         (lambda (a lat)
           (cond
             ((null? lat) #f)
             ((eq? (car lat) a) #t)
             (else
               (M? a (cdr lat)))))))
      (U set1))))

; Test of union-letrec-protected
;
(union-letrec-protected
  &#39;(tomatoes and macaroni casserole)
  &#39;(macaroni and cheese)) ; &#39;(tomatoes and macaroni casserole cheese)

; Fixing M? to follow 12th commandment
;
(define union-letrec-protected-12
  (lambda (set1 set2)
    (letrec
      ((U (lambda (set)
            (cond
              ((null? set) set2)
              ((M? (car set) set2)
               (U (cdr set)))
              (else
                (cons (car set) (U (cdr set)))))))
       (M?
         (lambda (a lat)
           (letrec
             ((N? (lambda (lat)
                    (cond
                      ((null? lat) #f)
                      ((eq? (car lat) a) #t)
                      (else
                        (N? (cdr lat)))))))
             (N? lat)))))
      (U set1))))

; Test of union-letrec-protected-12
;
(union-letrec-protected-12
  &#39;(tomatoes and macaroni casserole)
  &#39;(macaroni and cheese)) ; &#39;(tomatoes and macaroni casserole cheese)

; The two-in-a-row? checks if a lat contains two equal elements
;
(define two-in-a-row?
  (lambda (lat)
    (letrec
      ((W (lambda (a lat)
            (cond
              ((null? lat) #f)
              ((eq? a (car lat)) #t)
              (else
                (W (car lat) (cdr lat)))))))
      (cond
        ((null? lat) #f)
        (else (W (car lat) (cdr lat)))))))

; Test two-in-a-row?
; 
(two-in-a-row? &#39;(Italian sardines spaghetti parsley))           ; #f
(two-in-a-row? &#39;(Italian sardines sardines spaghetti parsley))  ; #t
(two-in-a-row? &#39;(Italian sardines more sardines spaghetti))     ; #f

; Another version of two-in-a-row?
;
(define two-in-a-row-2?
  (letrec
    ((W (lambda (a lat)
          (cond
            ((null? lat) #f)
            ((eq? a (car lat)) #t)
            (else
              (W (car lat) (cdr lat)))))))
    (lambda (lat)
      (cond
        ((null? lat) #f)
        (else (W (car lat) (cdr lat)))))))

; Test two-in-a-row-2?
;
(two-in-a-row-2? &#39;(Italian sardines spaghetti parsley))           ; #f
(two-in-a-row-2? &#39;(Italian sardines sardines spaghetti parsley))  ; #t
(two-in-a-row-2? &#39;(Italian sardines more sardines spaghetti))     ; #f

; The sum-of-prefixes finds the running sum of a list of numbers
;
(define sum-of-prefixes
  (lambda (tup)
    (letrec
      ((S (lambda (sss tup)
            (cond
              ((null? tup) &#39;())
              (else
                (cons (+ sss (car tup))
                      (S (+ sss (car tup)) (cdr tup))))))))
      (S 0 tup))))

; Examples of sum-of-prefixes
;
(sum-of-prefixes &#39;(2 1 9 17 0))   ; &#39;(2 3 12 29 29)
(sum-of-prefixes &#39;(1 1 1 1 1))    ; &#39;(1 2 3 4 5)
(sum-of-prefixes &#39;(1 1 1))        ; &#39;(1 2 3)



(define intersect
  (lambda (set1 set2)
    (cond
      ((null? set1) &#39;())  ; don&#39;t forget the 1st commandment
      ((member? (car set1) set2)
       (cons (car set1) (intersect (cdr set1) set2)))
      (else
        (intersect (cdr set1) set2)))))

; It needs member? helper function
;
(define member?
  (lambda (a l)
    (letrec
      ((yes? (lambda (l)
               (cond
                 ((null? l) #f)
                 ((eq? (car l) a) #t)
                 (else (yes? (cdr l)))))))
      (yes? l))))

; Examples of intersect
;
(intersect &#39;(a b x c d) &#39;(q w e x r t y a))     ; &#39;(a x)
(intersect &#39;(a b x c d) &#39;())                    ; &#39;()
(intersect &#39;() &#39;())                             ; &#39;()
(intersect &#39;() &#39;(a b x c d))                    ; &#39;()
(intersect &#39;(a b x c d) &#39;(a b x c d))           ; &#39;(a b x c d)

; We forgot the 12th commandment - use letrec to remove arguments
; that do not change for recursive applications
;
(define intersect-letrec
  (lambda (set1 set2)
    (letrec
      ((I (lambda (set)
            (cond
              ((null? set) &#39;())
              ((member? (car set) set2)
               (cons (car set) (I (cdr set))))
              (else
                (I (cdr set)))))))
      (I set1))))

; Test of intersect-letrec
;
(intersect-letrec &#39;(a b x c d) &#39;(q w e x r t y a))     ; &#39;(a x)
(intersect-letrec &#39;(a b x c d) &#39;())                    ; &#39;()
(intersect-letrec &#39;() &#39;())                             ; &#39;()
(intersect-letrec &#39;() &#39;(a b x c d))                    ; &#39;()
(intersect-letrec &#39;(a b x c d) &#39;(a b x c d))           ; &#39;(a b x c d)

; The intersectall function finds intersect of a bunch of sets
;
(define intersectall
  (lambda (lset)
    (cond
      ((null? lset) &#39;())
      ((null? (cdr lset)) (car lset))
      (else
        (intersect (car lset)
                   (intersectall (cdr lset)))))))

; Examples of intersectall


; Examples of intersectall
;
(intersectall &#39;((a) (a) (a)))                   ; &#39;(a)
(intersectall &#39;((a) () (a)))                    ; &#39;()
(intersectall &#39;())                              ; &#39;()
(intersectall &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)



(define intersectall-letrec
  (lambda (lset)
    (letrec
      ((A (lambda (lset)
            (cond
              ((null? (cdr lset)) (car lset))
              (else
                (intersect (car lset)
                           (A (cdr lset))))))))
      (cond
        ((null? lset) &#39;())
        (else (A lset))))))

; Tests of intersectall-letrec
;
(intersectall-letrec &#39;((a) (a) (a)))                   ; &#39;(a)
(intersectall-letrec &#39;((a) () (a)))                    ; &#39;()
(intersectall-letrec &#39;())                              ; &#39;()
(intersectall-letrec &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)




; Introducing letcc
;
(define intersectall-letcc
  (lambda (lset)
    (call-with-current-continuation
      (lambda (hop)
        (letrec
          ((A (lambda (lset)
                (cond
                  ((null? (car lset)) (hop &#39;()))
                  ((null? (cdr lset)) (car lset))
                  (else
                    (intersect (car lset)
                               (A (cdr lset))))))))
          (cond
            ((null? lset) &#39;())
            (else (A lset))))))))

; Tests of intersectall-letcc
;
(intersectall-letcc &#39;((a) (a) (a)))                   ; &#39;(a)
(intersectall-letcc &#39;((a) () (a)))                    ; &#39;()
(intersectall-letcc &#39;())                              ; &#39;()
(intersectall-letcc &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)



; intersectall that returns abruptly and promptly
;
(define intersectall-ap
  (lambda (lset)
    (call-with-current-continuation
      (lambda (hop)
        (letrec
          ((A (lambda (lset)
                (cond
                  ;;;hop one
                  ((null? (car lset)) (hop &#39;()))
                  ((null? (cdr lset)) (car lset))
                  (else
                    (I (car lset)
                       (A (cdr lset)))))))
           (I (lambda (s1 s2)
                (letrec
                  ((J (lambda (s1)
                        (cond
                          ((null? s1) &#39;())
                          ((member? (car s1) s2)
                           ;;;get the one you need
                           (cons (car s1) (J (cdr s1))))
                          (else
                            (J (cdr s1)))))))
                  (cond
                    ;;;hop two
                    ((null? s2) (hop &#39;()))
                    (else (J s1)))))))
          (cond
            ((null? lset) &#39;())
            (else (A lset))))))))

; Tests of intersectall-ap
;
(intersectall-ap &#39;((a) (a) (a)))                   ; &#39;(a)
(intersectall-ap &#39;((a) () (a)))                    ; &#39;()
(intersectall-ap &#39;())                              ; &#39;()
(intersectall-ap &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)

; rember function via letrec
;
;
;
; Chapter 14 of The Seasoned Schemer:
; Let There Be Names
;
; Code examples assemled by Peteris Krumins (peter@catonmat.net).
; His blog is at http://www.catonmat.net  --  good coders code, great reuse.
;
; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw
;

; atom? primitive
;
(define atom?
  (lambda (x)
   (and (not (pair? x)) (not (null? x)))))  

; add1 primitive
;
(define add1
  (lambda (n)
    (+ n 1)))

; The leftmost function finds the leftmost atom in a non-empty list of
; s-expressions that does not contain the empty list.
;
(define leftmost
  (lambda (l)
    (cond
      ((atom? (car l)) (car l))
      (else (leftmost (car l))))))

; Example of leftmost
;
(leftmost &#39;(((a) b) (c d)))         ; &#39;a

; Example of not-applicable leftmost
;
; (leftmost &#39;((() a) ()))           ; not applicable because leftmost item is an empty list

; Let&#39;s fix this.
;
(define leftmost-fixed
  (lambda (l)
    (cond
      ((null? l) &#39;())
      ((atom? (car l)) (car l))
      (else
        (cond
          ((atom? (leftmost-fixed (car l)))
           (leftmost-fixed (car l)))
          (else (leftmost-fixed (cdr l))))))))

; Examples of leftmost-fixed
;
(leftmost-fixed &#39;(((x) b) (c d)))   ; &#39;x
(leftmost-fixed &#39;(((x) ()) () (e))) ; &#39;x
(leftmost-fixed &#39;(((() x) ())))     ; &#39;x
(leftmost-fixed &#39;(((()) ())))       ; &#39;()

(define leftmost-let
  (lambda (l)
    (cond
      ((null? l) &#39;())
      ((atom? (car l)) (car l))
      (else
        (let ((a (leftmost-let (car l))))
          (cond
            ((atom? a) a)
            (else (leftmost-let (cdr l)))))))))

; Tests of leftmost-let
;
(leftmost-let &#39;(((y) b) (c d)))   ; &#39;y
(leftmost-let &#39;(((y) ()) () (e))) ; &#39;y
(leftmost-let &#39;(((() y) ())))     ; &#39;y
(leftmost-let &#39;(((()) ())))       ; &#39;()

; The rember1* function removes the leftmost occurrence of a in l
;
(define rember1*
  (lambda (a l)
    (cond
      ((null? l) &#39;())
      ((atom? (car l))
       (cond
         ((eq? (car l) a) (cdr l))
         (else
           (cons (car l) (rember1* a (cdr l))))))
      (else
        (cond
          ((equal? (rember1* a (car l)) (car l)) ; if the list with &#39;a&#39; removed doesn&#39;t change
           (cons (car l) (rember1* a (cdr l))))  ; then recurse
          (else
            (cons (rember1* a (car l)) (cdr l)))))))) ; otherwise remove &#39;a&#39;

; Examples of rember1*
;
(rember1*
  &#39;salad
  &#39;((Swedish rye) (French (mustard salad turkey)) salad))
; ==&amp;gt; &#39;((Swedish rye) (French (mustard turkey)) salad)

(rember1*
  &#39;meat
  &#39;((pasta meat) pasta (noodles meat sauce) meat tomatoes))
; ==&amp;gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)

; rember1* rewritten using the 12th commandment
;
(define rember1*-letrec
  (lambda (a l)
    (letrec
      ((R (lambda (l)
            (cond
              ((null? l) &#39;())
              ((atom? (car l))
               (cond
                 ((eq? (car l) a) (cdr l))
                 (else
                   (cons (car l) (R (cdr l))))))
              (else
                (cond
                  ((equal? (R (car l)) (car l)) ; if the list with &#39;a&#39; removed doesn&#39;t change
                   (cons (car l) (R (cdr l))))  ; then recurse
                  (else
                    (cons (R (car l)) (cdr l))))))))) ; otherwise remove &#39;a&#39;
      (R l))))

; Tests of rember1*-letrec
;
(rember1*-letrec
  &#39;salad
  &#39;((Swedish rye) (French (mustard salad turkey)) salad))
; ==&amp;gt; &#39;((Swedish rye) (French (mustard turkey)) salad)

(rember1*-letrec
  &#39;meat
  &#39;((pasta meat) pasta (noodles meat sauce) meat tomatoes))
; ==&amp;gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)

; rember* rewritten using the 12th commandment and let
;
(define rember1*-letrec-let
  (lambda (a l)
    (letrec
      ((R (lambda (l)
            (cond
              ((null? l) &#39;())
              ((atom? (car l))
               (cond
                 ((eq? (car l) a) (cdr l))
                 (else
                   (cons (car l) (R (cdr l))))))
              (else
                (let ((av (R (car l))))
                  (cond
                    ((equal? (car l) av)         ; if the list with &#39;a&#39; removed didn&#39;t change
                     (cons (car l) (R (cdr l)))) ; then recurse
                    (else
                      (cons av (cdr l))))))))))  ; otherwise remove &#39;a&#39;
      (R l))))

; Tests of rember1*-letrec-let
;
(rember1*-letrec-let
  &#39;salad
  &#39;((Swedish rye) (French (mustard salad turkey)) salad))
; ==&amp;gt; &#39;((Swedish rye) (French (mustard turkey)) salad)

(rember1*-letrec-let
  &#39;meat
  &#39;((pasta meat) pasta (noodles meat sauce) meat tomatoes))
; ==&amp;gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The fifteenth commandment (preliminary version)                            ;
;                                                                            ;
; Use (let ...) to name the values of repeated expressions.                  ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; The depth* function finds the max depth of an s-expression
;
(define depth*
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l)) (depth* (cdr l)))
      (else
        (cond
          ((&amp;gt; (depth* (cdr l))
              (add1 (depth* (car l))))
           (depth* (cdr l)))
          (else
            (add1 (depth* (car l)))))))))

; Examples of depth*
;
(depth* &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth* &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth* &#39;(c (b (a b) a) a))                                              ; 3

; depth* rewritten using let
;
(define depth*-let
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l)) (depth*-let (cdr l)))
      (else 
        (let ((a (add1 (depth*-let (car l))))
              (d (depth*-let (cdr l))))
          (cond
            ((&amp;gt; d a) d)
            (else a)))))))

; Tests of depth*-let
;
(depth*-let &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-let &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-let &#39;(c (b (a b) a) a))                                              ; 3

; Another version of depth*
;
(define depth*-let-2
  (lambda (l)
    (cond
      ((null? l) 1)
      (else
        (let ((d (depth*-let-2 (cdr l))))
          (cond
            ((atom? (car l)) d)
            (else
              (let ((a (add1 (depth*-let-2 (car l)))))
                (cond
                  ((&amp;gt; d a) d)
                  (else a))))))))))

; Tests of depth*-let
;
(depth*-let-2 &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-let-2 &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-let-2 &#39;(c (b (a b) a) a))                                              ; 3

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The fifteenth commandment (revised version)                                ;
;                                                                            ;
; Use (let ...) to name the values of repeated expressions in a function     ;
; definition if they may be evaluated twice for one and the same use of the  ;
; function.                                                                  ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; depth* via if
;
(define depth*-if
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l))
       (depth*-if (cdr l)))
      (else
        (let ((a (add1 (depth* (car l))))
              (d (depth* (cdr l))))
          (if (&amp;gt; d a) d a))))))

; Tests of depth*-if
;
(depth*-if &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-if &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-if &#39;(c (b (a b) a) a))                                              ; 3

; depth* via max
;
(define depth*-max
  (lambda (l)
    (cond
      ((null? l) 1)
      ((atom? (car l))
       (depth*-max (cdr l)))
      (else
        (max
          (add1 (depth*-max (car l)))
          (depth*-max (cdr l)))))))

; Tests of depth*-max
;
(depth*-max &#39;((pickled) peppers (peppers pickled)))                          ; 2
(depth*-max &#39;(margarine ((bitter butter) (makes) (batter (bitter))) butter)) ; 4
(depth*-max &#39;(c (b (a b) a) a))                                              ; 3

; Not interested in scramble problem, skipping it.

; leftmost via letcc
;
(define leftmost-letcc
  (lambda (l)
    (call-with-current-continuation
      (lambda (skip)
        (lm l skip)))))

; lm is leftmost-letcc&#39;s helper function
;
(define lm
  (lambda (l out)
    (cond
      ((null? l) &#39;())
      ((atom? (car l)) (out (car l)))
      (else
        (let () ; can also use &#39;begin&#39;
          (lm (car l) out)
          (lm (cdr l) out))))))

(leftmost-letcc &#39;(((x) b) (c d)))   ; &#39;x
(leftmost-letcc &#39;(((x) ()) () (e))) ; &#39;x
(leftmost-letcc &#39;(((() x) ())))     ; &#39;x
(leftmost-letcc &#39;(((()) ())))       ; &#39;()

; letfmost following 13th and 14th commandments
;
(define leftmost-1314
  (letrec
    ((lm (lambda (l out)
           (cond
             ((null? l) &#39;())
             ((atom? (car l)) (out (car l)))
             (else
               (begin
                 (lm (car l) out)
                 (lm (cdr l) out)))))))
    (lambda (l)
      (call-with-current-continuation
        (lambda (skip)
          (lm l skip))))))

(leftmost-1314 &#39;(((x) b) (c d)))   ; &#39;x
(leftmost-1314 &#39;(((x) ()) () (e))) ; &#39;x
(leftmost-1314 &#39;(((() x) ())))     ; &#39;x
(leftmost-1314 &#39;(((()) ())))       ; &#39;()

; another way to follow 13th and 14th commandments
;
(define leftmost-13142
  (lambda (l)
      (letrec
        ((lm (lambda (l out)
               (cond
                 ((null? l) &#39;())
                 ((atom? (car l)) (out (car l)))
                 (else
                   (begin
                     (lm (car l) out)
                     (lm (cdr l) out)))))))
        (call-with-current-continuation
          (lambda (skip)
            (lm l skip))))))

(leftmost-13142 &#39;(((x) b) (c d)))   ; &#39;x
(leftmost-13142 &#39;(((x) ()) () (e))) ; &#39;x
(leftmost-13142 &#39;(((() x) ())))     ; &#39;x
(leftmost-13142 &#39;(((()) ())))       ; &#39;()

; yet another way
;
(define leftmost-131422
  (lambda (l)
    (call-with-current-continuation
      (lambda (skip)
        (letrec
          ((lm (lambda (l)
                 (cond
                   ((null? l) &#39;())
                   ((atom? (car l)) (skip (car l)))
                   (else
                     (begin
                       (lm (car l))
                       (lm (cdr l))))))))
          (lm l))))))

(leftmost-131422 &#39;(((x) b) (c d)))   ; &#39;x
(leftmost-131422 &#39;(((x) ()) () (e))) ; &#39;x
(leftmost-131422 &#39;(((() x) ())))     ; &#39;x
(leftmost-131422 &#39;(((()) ())))       ; &#39;()

; rember1* via letcc
;
(define rember1*-letcc
  (lambda (a l)
    (letrec
      ((rm (lambda (a l oh)
             (cond
               ((null? l) (oh &#39;no))
               ((atom? (car l))
                (if (eq? (car l) a)
                  (cdr l)
                  (cons (car l) (rm a (cdr l) oh))))
               (else
                 (let ((new-car
                         (call-with-current-continuation
                           (lambda (oh)
                             (rm a (car l) oh)))))
                   (if (atom? new-car)
                     (cons (car l) (rm a (cdr l) oh))
                     (cons new-car (cdr l)))))))))
      (let ((new-l
              (call-with-current-continuation
                (lambda (oh)
                  (rm a l oh)))))
        (if (atom? new-l)
          l
          new-l)))))

; Tests of rember1*-letcc
;
(rember1*-letcc
  &#39;salad
  &#39;((Swedish rye) (French (mustard salad turkey)) salad))
; ==&amp;gt; &#39;((Swedish rye) (French (mustard turkey)) salad)

(rember1*-letcc
  &#39;meat
  &#39;((pasta meat) pasta (noodles meat sauce) meat tomatoes))
; ==&amp;gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)

(rember1*-letcc
  &#39;a
  &#39;((foo bar) baz))
; ==&amp;gt; &#39;((foo bar) baz)


;
; Chapter 16 of The Seasoned Schemer:
; Ready, Set, Bang!
;
; Code examples assemled by Peteris Krumins (peter@catonmat.net).
; His blog is at http://www.catonmat.net  --  good coders code, great reuse.
;
; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw
;

; sub1 primitive
;
(define sub1
  (lambda (n)
    (- n 1)))

; add1 primitive
;
(define add1
  (lambda (n)
    (+ n 1)))

; atom? primitive
;
(define atom?
  (lambda (x)
   (and (not (pair? x)) (not (null? x)))))  

; member? helper function
;
(define member?
  (lambda (a l)
    (letrec
      ((yes? (lambda (l)
               (cond
                 ((null? l) #f)
                 ((eq? (car l) a) #t)
                 (else (yes? (cdr l)))))))
      (yes? l))))


; Code examples start here
;
(define sweet-tooth
  (lambda (food)
    (cons food (cons &#39;cake &#39;()))))

(define last &#39;angelfood)

(sweet-tooth &#39;fruit)        ; &#39;(fruit cake)
last                        ; &#39;angelfood

; The sweet-toothL function saves the last food
;
(define sweet-toothL
  (lambda (food)
    (set! last food)
    (cons food (cons &#39;cake &#39;()))))

(sweet-toothL &#39;chocolate)   ; &#39;(chocolate cake)
last                        ; &#39;chocolate

(sweet-toothL &#39;fruit)       ; &#39;(fruit cake)
last                        ; &#39;fruit

(define ingredients &#39;())

; The sweet-toothR function builds a list of foods
;
(define sweet-toothR
  (lambda (food)
    (set! ingredients
      (cons food ingredients))
    (cons food (cons &#39;cake &#39;()))))

(sweet-toothR &#39;chocolate)   ; &#39;(chocolate cake)
ingredients                 ; &#39;(chocolate)

(sweet-toothR &#39;fruit)       ; &#39;(fruit cake)
ingredients                 ; &#39;(fruit chocolate)

(sweet-toothR &#39;cheese)      ; &#39;(cheese cake)
ingredients                 ; &#39;(cheese fruit chocolate)

(sweet-toothR &#39;carrot)      ; &#39;(carrot cake)
ingredients                 ; &#39;(carrot cheese fruit chocolate)

; The deep function wraps pizza in n parenthesis
;
(define deep
  (lambda (m)
    (cond
      ((zero? m) &#39;pizza)
      (else
        (cons (deep (sub1 m)) &#39;())))))

; Example of deep
;
(deep 3)                    ; &#39;(((pizza)))
(deep 0)                    ; &#39;pizza

; The deepR1 function remembers the numbers deep has seen so far
;
(define Ns1 &#39;())
(define deepR1
  (lambda (n)
    (set! Ns1 (cons n Ns1))
    (deep n)))

; Examples of deepR1
;
(deepR1 3)                  ; &#39;(((pizza)))
Ns1                         ; (3)
(deepR1 0)                  ; &#39;pizza
Ns1                         ; (0 3)

; The deepR function remembers the numbers and the results
;
(define Ns &#39;())
(define Rs &#39;())
(define deepR
  (lambda (n)
    (let ((result (deep n)))
      (set! Ns (cons n Ns))
      (set! Rs (cons result Rs))
      result)))

; Examples of deepR
;
(deepR 3)                   ; &#39;(((pizza)))
Ns                          ; &#39;(3)
Rs                          ; &#39;((((pizza))))
(deepR 5)                   ; &#39;(((((pizza)))))
Ns                          ; &#39;(5 3)
Rs                          ; &#39;((((((pizza))))) (((pizza))))
(deepR 3)                   ; &#39;(((pizza)))
Ns                          ; &#39;(3 5 3)
Rs                          ; &#39;((((pizza))) (((((pizza))))) (((pizza))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The nineteenth commandment                                                 ;
;                                                                            ;
; Use (set! ...) to remember valuable things between two distinct uses of a  ;
; function.                                                                  ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; The find function finds pizza in Rs
;
(define find
  (lambda (n Ns Rs)
    (letrec
      ((A (lambda (ns rs)
            (cond
              ((= (car ns) n) (car rs))
              (else
                (A (cdr ns) (cdr rs)))))))
      (A Ns Rs))))

; Examples of find
;
(find 3 Ns Rs)              ; &#39;(((pizza)))
(find 5 Ns Rs)              ; &#39;(((((pizza)))))
;(find 7 Ns Rs)             ; not applicable at this time

; The deepM function either uses find or computes pizza (temporary version)
;
(define deepM-tmp
  (lambda (n)
    (if (member? n Ns)
      (find n Ns Rs)
      (deepR n))))

Ns                          ; &#39;(3 5 3)
Rs                          ; &#39;((((pizza))) (((((pizza))))) (((pizza))))

(set! Ns (cdr Ns))
(set! Rs (cdr Rs))

Ns                          ; &#39;(5 3)
Rs                          ; &#39;((((((pizza))))) (((pizza))))

; The final deepM version
;
(define deepM
  (lambda (n)
    (if (member? n Ns)
      (find n Ns Rs)
      (let ((result (deep n)))
        (set! Rs (cons result Rs))
        (set! Ns (cons n Ns))
        result))))

; Examples of deepM
(deepM 3)                   ; &#39;(((pizza)))
(deepM 6)                   ; &#39;((((((pizza))))))

; Redefining deep
;
(define deep
  (lambda (m)
    (cond
      ((zero? m) &#39;pizza)
      (else (cons (deepM (sub1 m)) &#39;())))))

(deepM 9)                   ; &#39;(((((((((pizza)))))))))

Ns                          ; &#39;(9 8 7 6 5 3)

; Redefining deepM to folow 16th commandment
;
(define deepM
  (let ((Rs &#39;())
        (Ns &#39;()))
    (lambda (n)
      (if (member? n Ns)
        (find n Ns Rs)
        (let ((result (deep n)))
          (set! Rs (cons result Rs))
          (set! Ns (cons n Ns))
          result)))))

; Tests of the new deepM
;
(deepM 10)                  ; &#39;((((((((((pizza))))))))))
(deepM 16)                  ; &#39;((((((((((((((((pizza))))))))))))))))

; Better answer for find on empty lists
;
(define find
  (lambda (n Ns Rs)
    (letrec
      ((A (lambda (ns rs)
            (cond
              ((null? ns) #f)
              ((= (car ns) n) (car rs))
              (else
                (A (cdr ns) (cdr rs)))))))
      (A Ns Rs))))

; And a better deepM
;
(define deepM
  (let ((Rs &#39;())
        (Ns &#39;()))
    (lambda (n)
      (let ((exists (find n Ns Rs)))
        (if (atom? exists)
          (let ((result (deep n)))
            (set! Rs (cons result Rs))
            (set! Ns (cons n Ns))
            result)
          exists)))))

; Example of the new deepM
;
(deepM 10)                  ; &#39;((((((((((pizza))))))))))
(deepM 16)                  ; &#39;((((((((((((((((pizza))))))))))))))))
(deepM 0)                   ; &#39;pizza


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
;              Take a deep breath or a deep pizza, now.                      ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Our good, old friend length
;
(define lengthz
  (lambda (l)
    (cond
      ((null? l) 0)
      (else (add1 (lengthz (cdr l)))))))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

; length via set!
;
(define lengthz
  (lambda (l) 0))

(set! lengthz
  (lambda (l)
    (cond
      ((null? l) 0)
      (else (add1 (lengthz (cdr l)))))))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

; length via set! again
;
(define lengthz
  (let ((h (lambda (l) 0)))
    (set! h
      (lambda (l)
        (cond
          ((null? l) 0)
          (else (add1 (h (cdr l)))))))
    h))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The seventeenth commandment (final version)                                ;
;                                                                            ;
; Use (set! x ...) for (let ((x ...)) ...) only if there is at least one     ;
; (lambda ... between it and the (let ...), or if the new value for x is a   ;
; function that refers to x                                                  ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Another way to write length
;
(define h1              ; h1 is actually an anonymous name
  (lambda (l) 0))

(define lengthz
  (let ()
    (set! h1
      (lambda (l)
        (cond
          ((null? l) 0)
          (else (add1 (h1 (cdr l)))))))
    h1))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

; Another way
;
(define h2              ; h2 is actually an anonymous name
  (lambda (l)
    (cond
      ((null? l) 0)
      (else (add1 (h2 (cdr l)))))))

(define lengthz
  (let () h2))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

; length again
;
(define lengthz
  (let ((h (lambda (l) 0)))
    (set! h
      (lambda (l)
        (cond
          ((null? l) 0)
          (else (add1 (h (cdr l)))))))
    h))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

; Let&#39;s eliminate parts that are specific to length
;
(define L
  (lambda (lengthz)
    (lambda (l)
      (cond
        ((null? l) 0)
        (else (add1 (lengthz (cdr l))))))))

(define lengthz
  (let ((h (lambda (l) 0)))
    (set! h
      (L (lambda (arg) (h arg))))
    h))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

; Y-bang - the applicative-order imperative y-combinator
; (discovered by Peter Landin)
;
(define Y-bang
  (lambda (f)
    (letrec
      ((h (f (lambda (arg) (h arg)))))
      h)))

(define lengthz (Y-bang L))

; Test length
;
(lengthz &#39;())        ; 0
(lengthz &#39;(a b x))   ; 3

; depth* via Y-bang
;
(define D
  (lambda (depth*)
    (lambda (s)
      (cond
        ((null? s) 1)
        ((atom? (car s)) (depth* (cdr s)))
        (else
          (max (add1 (depth* (car s))) (depth* (cdr s))))))))

(define depth* (Y-bang D))

; Test depth*
;
(depth* &#39;())                ; 1
(depth* &#39;(((pizza)) ()))    ; 3

; The bizarre function
;
(define biz
  (let ((x 0))
    (lambda (f)
      (set! x (add1 x))
      (lambda (a)
        (if (= a x)
          0
          (f a))))))

; Another way to write bizarre
;
(define x1 0)               ; anonymous var
(define biz
  (lambda (f)
    (set! x1 (add1 x1))
    (lambda (a)
      (if (= a x1)
        0
        (f a)))))

; The Y-Combinator
;
(define Y
  (lambda (le)
    ((lambda (f) (f f))
     (lambda (f)
       (le (lambda (x) ((f f) x)))))))

((Y biz) 5)

; ((Y-bang biz) 5)          ; doesn&#39;t compute... why?


;
; Chapter 17 of The Seasoned Schemer:
; We Change, Therefore We Are!
;
; Code examples assemled by Peteris Krumins (peter@catonmat.net).
; His blog is at http://www.catonmat.net  --  good coders code, great reuse.
;
; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw
;

; The atom? primitive
;
(define atom?
  (lambda (x)
   (and (not (pair? x)) (not (null? x)))))  

; The sub1 primitive
;
(define sub1
  (lambda (n)
    (- n 1)))

; The add1 primitive
;
(define add1
  (lambda (n)
    (+ n 1)))

; The deep function wraps pizza in m parenthesis
;
(define deep
  (lambda (m)
    (if (zero? m)
      &#39;pizza
      (cons (deep (sub1 m)) &#39;()))))

; Examples of deep
;
(deep 3)                ; &#39;(((pizza)))
(deep 0)                ; &#39;pizza

; The deepM function remembers calls to deep
;
; The deepM function uses find function to find n in Ns and return 
; the correct value from Rs
;
(define find
  (lambda (n Ns Rs)
    (letrec
      ((A (lambda (ns rs)
            (cond
              ((null? ns) #f)
              ((= (car Ns) n) (car Rs))
              (else
                (A (cdr ns) (cdr rs)))))))
      (A Ns Rs))))

(define deepM
  (let ((Rs &#39;())
        (Ns &#39;()))
    (letrec
      ((D (lambda (m)
            (if (zero? m)
              &#39;pizza
              (cons (deepM (sub1 m)) &#39;())))))
      (lambda (n)
        (let ((exists (find n Ns Rs)))
          (if (atom? exists)
            (let ((result (D n)))
              (set! Rs (cons result Rs))
              (set! Ns (cons n Ns))
              result)
            exists))))))

; Examples of deepM
;
(deepM 3)               ; &#39;(((pizza)))
(deepM 0)               ; &#39;pizza

; No need to use letrec in deepM
;
(define deepM-letrec
  (let ((Rs &#39;())
        (Ns &#39;())
        (D (lambda (m)
              (if (zero? m)
                &#39;pizza
                (cons (deepM-letrec (sub1 m)) &#39;())))))
    (lambda (n)
      (let ((exists (find n Ns Rs)))
        (if (atom? exists)
          (let ((result (D n)))
            (set! Rs (cons result Rs))
            (set! Ns (cons n Ns))
            result)
          exists)))))

; Test of the new deepM
;
(deepM-letrec 3)               ; &#39;(((pizza)))
(deepM-letrec 0)               ; &#39;pizza

; No need for D in deepM
;
(define deepM-D
  (let ((Rs &#39;())
        (Ns &#39;()))
    (lambda (n)
      (let ((exists (find n Ns Rs)))
        (if (atom? exists)
          (let ((result ((lambda (m)
                           (if (zero? m)
                             &#39;pizza
                             (cons (deepM-D (sub1 m)) &#39;()))) n)))
            (set! Rs (cons result Rs))
            (set! Ns (cons n Ns))
            result)
          exists)))))

; Test of the new deepM
;
(deepM-D 3)               ; &#39;(((pizza)))
(deepM-D 0)               ; &#39;pizza

; No need for the 2nd lambda 
;
(define deepM-2nd
  (let ((Rs &#39;())
        (Ns &#39;()))
    (lambda (n)
      (let ((exists (find n Ns Rs)))
        (if (atom? exists)
          (let ((result (if (zero? n)
                            &#39;pizza
                            (cons (deepM-2nd (sub1 n)) &#39;()))))
            (set! Rs (cons result Rs))
            (set! Ns (cons n Ns))
            result)
          exists)))))

; Test of the new deepM
;
(deepM-2nd 3)               ; &#39;(((pizza)))
(deepM-2nd 0)               ; &#39;pizza

; The consC function counts number of conses needed to build
; n-deep pizza
;
(define consC
  (let ((N 0))
    (lambda (x y)
      (set! N (add1 N))
      (cons x y))))

; No way to get N out of this consC, so we need the counter
; function that will hold the count
;
(define counter 0)

; And a modification of consC
;
(define consC
  (let ((N 0))
    (set! counter (lambda() N))
    (lambda (x y)
      (set! N (add1 N))
      (cons x y))))
        
; And we need to modify deep
;
(define deep
  (lambda (m)
    (if (zero? m)
      &#39;pizza
      (consC (deep (sub1 m)) &#39;()))))

(deep 5)            ; &#39;(((((pizza)))))
(counter)           ; 5

(deep 7)            ; &#39;(((pizza))
(counter)           ; 12                ;;; (5 + 7) 

; Let&#39;s determine how many cons&#39;es are necessary to find
; values of (deep 0) ... (deep 1000).
;
(define supercounter
  (lambda (f)
    (letrec
      ((S (lambda (n)
            (if (zero? n)
              (f n)
              (let ()
                (f n)
                (S (sub1 n)))))))
      (S 1000)
      (counter))))

; Try out supercounter
;
(supercounter deep)         ; 500512    ;;; not 500500 as expected

; Need to wipe out counter before using it again
;
(define set-counter 0)

(define consC
  (let ((N 0))
    (set! counter (lambda() N))
    (set! set-counter
      (lambda (x) (set! N x)))
    (lambda (x y)
      (set! N (add1 N))
      (cons x y))))

(set-counter 0)

; Try out supercounter again
;
(supercounter deep)

; How many conses are used by (deepM 5)?
; Need to modify deepM to use consC first.
;
(define deepM-consC
  (let ((Rs &#39;())
        (Ns &#39;()))
    (lambda (n)
      (let ((exists (find n Ns Rs)))
        (if (atom? exists)
          (let ((result
                  (if (zero? n)
                    &#39;pizza
                    (consC (deepM-consC (sub1 n)) &#39;()))))
            (set! Rs (cons result Rs))
            (set! Ns (cons n Ns))
            result)
          exists)))))

; How many conses are used by (deepM 5)?
;
(deepM 5)           ; &#39;(((((pizza)))))
(counter)           ; 500505    ;;; because we forgot to reset counter

(set-counter 0)
(deepM-consC 5)     ; &#39;(((((pizza)))))
(counter)           ; 5

(deep 7)            ;
(counter)           ; ??? the book says it should be 0, I get 12, why?

(supercounter deepM-consC)  ; ??? how did this work? it didn&#39;t take an argument?

; Book has also talks about conses in rember* function but I am not interested
; in it at the moment.



;
; Chapter 18 of The Seasoned Schemer:
; We Change, Therefore We Are the Same!
;
; Code examples assemled by Peteris Krumins (peter@catonmat.net).
; His blog is at http://www.catonmat.net  --  good coders code, great reuse.
;
; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw
;

; The atom? primitive
;
(define atom?
  (lambda (x)
   (and (not (pair? x)) (not (null? x)))))  

; The sub1 primitive
;
(define sub1
  (lambda (n)
    (- n 1)))

; The add1 primitive
;
(define add1
  (lambda (n)
    (+ n 1)))

; The lots function creates lots of eggs
;
(define lots
  (lambda (n)
    (cond
      ((zero? n) &#39;())
      (else
        (cons &#39;egg (lots (sub1 n)))))))

; The lenkth function counts the eggs
;
(define lenkth
  (lambda (l)
    (cond
      ((null? l) 0)
      (else
        (add1 (lenkth (cdr l)))))))

; Examples of lots and lenkth
;
(lots 3)                ; &#39;(egg egg egg)
(lots 5)                ; &#39;(egg egg egg egg egg)
(lots 12)               ; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)
(lenkth (lots 3))       ; 3
(lenkth (lots 5))       ; 5
(lenkth (lots 15))      ; 15

; Create 4 eggs from 3 eggs
;
(cons &#39;egg (lots 3))    ; &#39;(egg egg egg egg)

; consC, counter, set-counter from chapter 17
;
(define counter (lambda() 0))
(define set-counter (lambda () 0))
(define consC
  (let ((N 0))
    (set! counter (lambda() N))
    (set! set-counter
      (lambda (x) (set! N x)))
    (lambda (x y)
      (set! N (add1 N))
      (cons x y))))

; Add an egg at the end
;
(define add-at-end
  (lambda (l)
    (cond
      ((null? (cdr l))
       (consC (car l) (cons &#39;egg-end &#39;())))
      (else
        (consC (car l) (add-at-end (cdr l)))))))

; Example of add-at-end
;
(add-at-end (lots 3))   ; &#39;(egg egg egg egg-end)

(counter)               ; 3

; Add an egg at the end without making any new conses except for the last one
;
(define add-at-end-too
  (lambda (l)
    (letrec
      ((A (lambda (ls)
            (cond
              ((null? (cdr ls))
               (set-cdr! ls (cons &#39;egg-end2 &#39;())))
              (else
                (A (cdr ls)))))))
      (A l)
      l)))

; Example of add-at-end-too
;
(set-counter 0)
(add-at-end-too (lots 3))   ; &#39;(egg egg egg egg-end2)
(counter)                   ; 0

; kons the magnificent
;
(define kons
  (lambda (kar kdr)
    (lambda (selector)          ; returns lambda (selector)
      (selector kar kdr))))     ; calls selector with kar and kdr arguments

; kar
;
(define kar
  (lambda (c)                   ; applies selector on (a d) and returns &#39;a (car)
    (c (lambda (a d) a))))

; kdr
;
(define kdr
  (lambda (c)                   ; applies selector on (a d) and returns d (cdr)
    (c (lambda (a d) d))))

; Examples of kons kar kdr
;
(kar (kons &#39;a &#39;()))                 ; &#39;a
(kdr (kons &#39;a &#39;()))                 ; &#39;()
(kar (kdr (kons &#39;a (kons &#39;b &#39;())))) ; &#39;b
(kar (kons &#39;a (kons &#39;b &#39;())))       ; &#39;a

; Another cons
;
(define bons
  (lambda (kar)
    (let ((kdr &#39;()))
      (lambda (selector)
        (selector
          (lambda (x) (set! kdr x))
          kar
          kdr)))))

; Another kar
;
(define bar
  (lambda (c)
    (c (lambda (s a d) a))))

; Another kdr
;
(define bdr
  (lambda (c)
    (c (lambda (s a d) d))))

; set-kdr
;
(define set-kdr
  (lambda (c x)
    ((c (lambda (s a d) s)) x)))

; create kons using set-kdr and bons
;
(define kons2
  (lambda (a d)
    (let ((c (bons a)))
      (set-kdr c d)
      c)))

; Example of kons2 bar and bdr
;
(bar (kons2 &#39;a &#39;(1 2 3)))       ; &#39;a
(bdr (kons2 &#39;a &#39;(1 2 3)))       ; &#39;(1 2 3)

; Now eggs again
;
(define dozen (lots 12))

dozen           ; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)
                ; used 12 conses

(define bakers-dozen (add-at-end dozen))

bakers-dozen    ; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end)
                ; used 13 conses (25 total now)

(define bakers-dozen-too (add-at-end-too dozen))

bakers-dozen-too    ; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end egg-end2)
                    ; used 1 cons (26 total)

(define bakers-dozen-again (add-at-end dozen))

bakers-dozen-again  ; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end egg-end2 egg-end)
                    ; used 14 conses (40 total)

(define same?
  (lambda (c1 c2)
    (cond
      ((and (null? c1) (null? c2)) #t)
      ((or (null? c1) (null? c2)) #f)
      (else
       (let ((t1 (cdr c1))
             (t2 (cdr c2)))
         (set-cdr! c1 1)
         (set-cdr! c2 2)
         (let ((v (= (cdr c1) (cdr c2))))
           (set-cdr! c1 t1)
           (set-cdr! c2 t2)
           v))))))

(same? dozen dozen)                     ; #t
(same? dozen bakers-dozen)              ; #f
(same? dozen bakers-dozen-too)          ; #t
(same? dozen bakers-dozen-again)        ; #f
(same? bakers-dozen bakers-dozen-too)   ; #f   ;;; the book says #t???

; The last-kons function returns the last cons in a non-empty kons-list
;
(define last-kons
  (lambda (ls)
    (cond
      ((null? (cdr ls)) ls)
      (else (last-kons (cdr ls))))))

(define long (lots 12))                 ; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)

(set-cdr! (last-kons long) long)        ; #0 = &#39;(egg egg egg egg egg egg egg egg egg egg egg . #0#) 

; The finite-lenkth function returns length of a list
; or #f if it&#39;s an infinite list
;
(define finite-lenkth
  (lambda (p)
    (call-with-current-continuation
      (lambda (infinite)
        (letrec
          ((C (lambda (p q)
                (cond
                  ((same? p q) (infinite #f))
                  ((null? q) 0)
                  ((null? (cdr q)) 1)
                  (else
                    (+ (C (sl p) (qk q)) 2)))))
           (qk (lambda (x) (cdr (cdr x))))
           (sl (lambda (x) (cdr x))))
          (cond
            ((null? p) 0)
            (else
              (add1 (C p (cdr p))))))))))

; Examples of finite-lenkth
;
(define not-so-long (lots 5))         ; &#39;(egg egg egg egg egg)
(finite-lenkth not-so-long)           ; 5
(finite-lenkth long)                  ; #f

; Guy&#39;s Favorite Pie
;
(define mongo
  (cons &#39;pie
   (cons &#39;a
    (cons &#39;la
     (cons &#39;mode &#39;())))))
(set-cdr! (cdr (cdr (cdr mongo))) (cdr mongo))

; mongo

;
; Chapter 19 of The Seasoned Schemer:
; Absconding with the Jewels
;
; Code examples assemled by Peteris Krumins (peter@catonmat.net).
; His blog is at http://www.catonmat.net  --  good coders code, great reuse.
;
; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw
;

; The atom? primitive
;
(define atom?
  (lambda (x)
   (and (not (pair? x)) (not (null? x)))))  

; The sub1 primitive
;
(define sub1
  (lambda (n)
    (- n 1)))

; Our friend deep
;
(define deep
  (lambda (m)
    (cond
      ((zero? m) &#39;pizza)
      (else (cons (deep (sub1 m)) &#39;())))))

; Example of deep
;
(deep 6)                    ; &#39;((((((pizza))))))

; Six layers creates six layered pizza
;
(define six-layers
  (lambda (p)
    (cons (cons (cons
    (cons (cons (cons p &#39;()) &#39;()) &#39;()) &#39;()) &#39;()) &#39;())))

; Example of six-layers
;
(six-layers &#39;pizza)         ; &#39;((((((pizza))))))

; Four layers makes a four layered pizza
;
(define four-layers
  (lambda (p)
    (cons (cons (cons
    (cons p &#39;()) &#39;()) &#39;()) &#39;())))

; Example of four-layers
;
(four-layers &#39;pizza)        ; &#39;((((pizza))))

; The deepB function does layering
;
(define toppings 0)
(define deepB
  (lambda (m)
    (cond
      ((zero? m)
       (call-with-current-continuation
         (lambda (jump)
           (set! toppings jump)
           &#39;pizza)))
      (else
        (cons (deepB (sub1 m)) &#39;())))))

; Example of deepB
;
(deepB 6)                   ; &#39;((((((pizza)))))), but what does jump do?

; Six layers again
;
(six-layers &#39;mozzarella)    ; &#39;((((((mozarella))))))

; Now the toppings
;
(toppings &#39;mozzarella)      ; &#39;((((((mozarella))))))
(toppings &#39;cake)            ; &#39;((((((cake))))))
(toppings &#39;pizza)           ; &#39;((((((pizza))))))

; What about his
;
(cons (toppings &#39;cake) &#39;()) ; it&#39;s still &#39;((((((cake)))))) and not &#39;(((((((cake)))))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                            ;
; The twentieth commandment                                                  ;
;                                                                            ;
; When thinking about a value created with (letcc ...), write down the       ;
; function that is equivalent but does not forget. Then, when you use it,    ;
; remember to forget.                                                        ;
;                                                                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Deep&amp;amp;co
;
(define deep&amp;amp;co
  (lambda (m k)
    (cond
      ((zero? m) (k &#39;pizza))
      (else
        (deep&amp;amp;co (sub1 m)
         (lambda (x) (k (cons x &#39;()))))))))

; Examples of deep&amp;amp;co
;
(deep&amp;amp;co 0 (lambda (x) x))          ; &#39;pizza
(deep&amp;amp;co 6 (lambda (x) x))          ; &#39;((((((pizza))))))
(deep&amp;amp;co 2 (lambda (x) x))          ; &#39;((pizza))

; Deep&amp;amp;coB
;
(define deep&amp;amp;coB
  (lambda (m k)
    (cond
      ((zero? m)
       (let ()
         (set! toppings k)
         (k &#39;pizza)))
    (else
      (deep&amp;amp;coB (sub1 m)
        (lambda (x)
          (k (cons x &#39;()))))))))

; Examples of deep&amp;amp;coB
;
(deep&amp;amp;coB 6 (lambda (x) x))         ; &#39;((((((pizza))))))
(deep&amp;amp;coB 4 (lambda (x) x))         ; &#39;((((pizza))))

; toppings is now four-layers

(toppings &#39;cake)                    ; &#39;((((cake))))
(cons
  (toppings &#39;cake)
  (toppings &#39;cake))                 ; &#39;(((((cake)))) (((cake))))

; Remember two-in-a-row?
;
(define two-in-a-row?
  (letrec
    ((W (lambda (a lat)
          (cond
            ((null? lat) #f)
            (else
              (let ((nxt (car lat)))
                (or
                  (eq? nxt a)
                  (W nxt (cdr lat)))))))))
    (lambda (lat)
      (cond
        ((null? lat) #f)
        (else (W (car lat) (cdr lat)))))))

; Examples of two-in-a-row?
;
(two-in-a-row? &#39;(mozzarella cake mozzarella))      ; #f
(two-in-a-row? &#39;(mozzarella mozzarella cake))      ; #t

; walk
;
(define leave &#39;0)
(define walk
  (lambda (l)
    (cond
      ((null? l) &#39;())
      ((atom? (car l))
       (leave (car l)))
      (else
        (begin
          (walk (car l))
          (walk (cdr l)))))))

; we need leave
(define start-it
  (lambda (l)
    (call-with-current-continuation
      (lambda (here)
        (set! leave here)
        (walk l)))))

; Example of start-it
;
(start-it &#39;((potato) (chips (chips (with))) fish))  ; &#39;potato

; waddle, just like walk but remembers where it left
;
(define fill 0)
(define waddle
  (lambda (l)
    (cond
      ((null? l) &#39;())
      ((atom? (car l))
       (begin
         (call-with-current-continuation
           (lambda (rest)
             (set! fill rest)
             (leave (car l))))
         (waddle (cdr l))))
      (else
        (begin
          (waddle (car l))
          (waddle (cdr l)))))))

; A new start
;
(define start-it2
  (lambda (l)
    (call-with-current-continuation
      (lambda (here)
        (set! leave here)
        (waddle l)))))

; Example of start-it2
;
(start-it2 &#39;((donuts) (cheerios (cheerios (spaghettios))) donuts))
; ===&amp;gt; &#39;donuts

; get-next gets the next atom
;
(define get-next
  (lambda (x)
    (call-with-current-continuation
      (lambda (here-again)
        (set! leave here-again)
        (fill &#39;go)))))

; Examples of get-next
;
(get-next &#39;go)      ; &#39;cheerios
(get-next &#39;go)      ; &#39;cheerios
(get-next &#39;go)      ; &#39;paghettios
(get-next &#39;go)      ; &#39;donuts
(get-next &#39;go)      ; &#39;()

; get-first
;
(define get-first
  (lambda (l)
    (call-with-current-continuation
      (lambda (here)
        (set! leave here)
        (waddle l)
        (leave &#39;())))))

; Examples of get-first and get-next
;
(get-first &#39;(fish (chips)))     ; &#39;fish
(get-next &#39;go)                  ; &#39;chips
(get-next &#39;go)                  ; &#39;()

; And now the two-in-a-row*?
;
(define two-in-a-row*?
  (letrec
    ((T? (lambda (a)
           (let ((n (get-next 0)))
             (if (atom? n)
               (or (eq? n a) (T? n))
               #f))))
     (get-next
       (lambda (x)
         (call-with-current-continuation
           (lambda (here-again)
             (set! leave here-again)
             (fill &#39;go)))))
     (fill (lambda (x) x))
     (waddle
       (lambda (l)
         (cond
           ((null? l) &#39;())
           ((atom? (car l))
            (begin              ; or (let() ...
              (call-with-current-continuation
                (lambda (rest)
                  (set! fill rest)
                  (leave (car l))))
              (waddle (cdr l))))
           (else
             (begin
               (waddle (car l))
               (waddle (cdr l)))))))
     (leave (lambda (x) x)))
    (lambda (l)
      (let ((fst (call-with-current-continuation
                   (lambda (here)
                     (set! leave here)
                     (waddle l)
                     (leave &#39;())))))
        (if (atom? fst) (T? fst) #f)))))

; Examples of two-in-a-row*?
;
(two-in-a-row*? &#39;(((food) ()) (((food)))))      ; #t
(two-in-a-row*? &#39;(a (b (c (d))) () () (d)))     ; #t
(two-in-a-row*? &#39;())                            ; #f
(two-in-a-row*? &#39;(((((a))))))                   ; #f


&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>加法之后也需减法</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/17/jia-fa-zhi-hou-ye-xu-jian-fa/</link>
      <pubDate>Sun, 17 May 2015 22:46:35 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/17/jia-fa-zhi-hou-ye-xu-jian-fa/</guid>
      <description>&lt;p&gt;老子道德经说&lt;a href=&#34;http://www.jdon.com/46727&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;道生一，一生二，二生三，三生万物&lt;/a&gt;，这句话符合构造定律Constructal Law.&lt;/p&gt;
&lt;p&gt;学习过&lt;a href=&#34;http://www.cnblogs.com/haippy/archive/2012/06/04/2535197.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;git&lt;/a&gt;的人知道(可以参考&lt;a href=&#34;http://www.berlinix.com/it/git.php&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;git入门&lt;/a&gt;)，git体现的本质其实就是分支的思想,他就像是一块一块的&lt;a href=&#34;http://www.programblings.com/2008/06/07/the-illustrated-guide-to-recovering-lost-commits-with-git/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;积木&lt;/a&gt;一样。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://think-like-a-git.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Thinking like a git&lt;/a&gt;教会我们 Facebook其实也是范畴的集合&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/tree.png&#34; alt=&#34;十分漂亮的树形图&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/city.jpg&#34; alt=&#34;城市的树形图&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Haskell的IO main</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/17/haskellde-io-main/</link>
      <pubDate>Sun, 17 May 2015 21:48:03 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/17/haskellde-io-main/</guid>
      <description>&lt;p&gt;main在Haskell充当类似c系列语言的exe文件的头函数
main对应的类型是&lt;a href=&#34;http://learnyoua.haskell.sg/content/zh-tw/ch09/input-and-output.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IO Something&lt;/a&gt;
比如下列源码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;main = do 
    putStrLn &amp;quot;Hello Hello&amp;quot; 
    putStrLn &amp;quot;Hello, what&#39;s your name?&amp;quot; 
    name &amp;lt;- getLine 
    putStrLn $ &amp;quot;Read this carefully, because this is your future: &amp;quot; ++  name 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Windows 输出：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;c:\&amp;gt;ghc --make hello.hs -o Hello 
[1 of 1] Compiling Main             ( hello.hs, hello.o ) 
Linking Hello.exe ... 

c:\&amp;gt;Hello.exe 
Hello Hello 
Hello, what&#39;s your name? 
yezhaoliang 
Read this carefully, because this is your future: yezhaoliang 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ubuntu 输出:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;root at javazhao-N53SM [21:52:10ä��午] in /home/happycamp-of-lisp on git:develop+?
$ ghc --make hello12.hs -o hello12
[1 of 1] Compiling Main ( hello12.hs, hello12.o )
Linking hello12 ...

root at javazhao-N53SM [21:52:25ä��午] in /home/happycamp-of-lisp on git:develop+?
$ ./hello12
Hello Hello
Hello, what&#39;s your name?
yezhaoliang
Read this carefully, because this is your future: yezhaoliang

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Haskell天生的具备跨平台的特点&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>The greatest weapons</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/17/the-greatest-weapons/</link>
      <pubDate>Sun, 17 May 2015 19:01:59 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/17/the-greatest-weapons/</guid>
      <description>&lt;p&gt;Everything in Haskell has a Type
Here are some Type declarations.&lt;/p&gt;
&lt;p&gt;These are your greatest weapons.&lt;/p&gt;
&lt;p&gt;head :: [a] -&amp;gt; a &amp;ndash; gets the first element of a list&lt;/p&gt;
&lt;p&gt;tail :: [a] -&amp;gt; [a] &amp;ndash; gets everything but the first element&lt;/p&gt;
&lt;p&gt;last :: [a] -&amp;gt; a &amp;ndash; gets the last element of a list&lt;/p&gt;
&lt;p&gt;init :: [a] -&amp;gt; [a] &amp;ndash; gets everything but the last element&lt;/p&gt;
&lt;p&gt;(++) :: [a] -&amp;gt; [a] -&amp;gt; [a] &amp;ndash; concatenates two lists together&lt;/p&gt;
&lt;p&gt;(:) :: a -&amp;gt; [a] -&amp;gt; [a] &amp;ndash; prepends an element to a list&lt;/p&gt;
&lt;p&gt;fst  :: (a,b) -&amp;gt; a &amp;ndash; gets the first element of a tuple&lt;/p&gt;
&lt;p&gt;snd  :: (a,b) -&amp;gt; b &amp;ndash; gets the second element of a tuple&lt;/p&gt;
&lt;p&gt;(!!) :: [a]-&amp;gt;Int a&lt;/p&gt;
&lt;h3 id=&#34;数学中λ-calculus的表示法为&#34;&gt;数学中λ-calculus的表示法为：&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;λx.t&lt;/li&gt;
&lt;li&gt;λx[t]&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;“λ”不具有任何特殊意思，标识着其表达式中的可取一数值x带入。
t是表达式（例如x+3、x^2+2x+1等）。&lt;/p&gt;
&lt;h3 id=&#34;代入数值p的表示法为&#34;&gt;代入数值p的表示法为：&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;(λx.t)p&lt;/li&gt;
&lt;li&gt;(λx[t])p&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;lispscheme的λ表示法与数值代入&#34;&gt;Lisp|scheme的λ表示法与数值代入：&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(lambda (x) (+ x 1))
((lambda (x) (+ x 1) 10))
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;haskell&#34;&gt;Haskell：&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;\x -&amp;gt; x+1
(\x -&amp;gt; x+1)10

Prelude&amp;gt; map (\x-&amp;gt;x+1) [1..10]
[2,3,4,5,6,7,8,9,10,11]

\ para1 para2-&amp;gt;(return value) 
\ (para1,para2) -&amp;gt; (return value)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;lambda-calculus&#34;&gt;Lambda Calculus&lt;/h3&gt;
&lt;p&gt;前面提到了Haskell是基于__Lambda Calculus__的，所以在学习Haskell之前，我们有必要了解一下Lambda Caculus的一些基本的内容，方便我们后面正式介绍Haskell。其实，Lambda Calculus是所有函数式语言的基础，要学习FP，最好都了解一下Lambda Calculus。下面对Lambda Calculus做一个简单的介绍：&lt;/p&gt;
&lt;h4 id=&#34;基本的语法lambda-calculus的核心是表达式expression用fp语言写的程序执行的过程本质上就是对表达式求值的过程&#34;&gt;基本的语法：Lambda Calculus的核心是表达式(Expression)，用FP语言写的程序执行的过程，本质上就是对表达式求值的过程&lt;/h4&gt;
&lt;p&gt;expression := variable | function | application
funciton := λvariable.expression (.前面部分为定义(definition)，后面部分为函数体(body))
application := expression expression&lt;/p&gt;
&lt;p&gt;另外一种表述方法:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;&amp;lt;expr&amp;gt; ::= &amp;lt;identifier&amp;gt; 
&amp;lt;expr&amp;gt; ::= lambda &amp;lt;identifier-list&amp;gt;. &amp;lt;expr&amp;gt; 
&amp;lt;expr&amp;gt; ::= (&amp;lt;expr&amp;gt; &amp;lt;expr&amp;gt;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;前两条语法用于生成lambda表达式（lambda函数），如：
lambda x y. x + y
haskell里面为了简洁起见用“\”来代替希腊字母lambda，它们形状比较相似。故而上面的定义也可以写成：
\ x y. x + y&lt;/p&gt;
&lt;h4 id=&#34;变量的bound与free&#34;&gt;变量的bound与free:&lt;/h4&gt;
&lt;p&gt;λx.xy →x is bound, y is free&lt;/p&gt;
&lt;h4 id=&#34;表达式化简reduction的基本法则&#34;&gt;表达式化简（Reduction)的基本法则:&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;α−reduction: λx.E→λy.E[y/x]
β−reduction:((λx.E)z)→E[z/x]
η−reduction(if x is not free in E): λx.(Ex)→E
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Alpha转换公理：例如，“lambda x y. x + y”转换为“lambda a b. a + b”。换句话说，函数的参数起什么名字没有关系，可以随意替换，只要函数体里面对参数的使用的地方也同时注意相应替换掉就是了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Beta转换公理：例如，“(lambda x y. x + y) 2 3”转换为“2 + 3”。这个就更简单了，也就是说，当把一个lambda函数用到参数身上时，只需用实际的参数来替换掉其函数体中的相应变量即可。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;http://mindhacks.cn/2006/10/15/cantor-godel-turing-an-eternal-golden-diagonal/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;软件工程里面的一条黄金定律：“任何问题都可以通过增加一个间接层来解决&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;变量替换&#34;&gt;变量替换&lt;/h4&gt;
&lt;p&gt;[y/x]E →  substitute  all occurrences of x in E to y&lt;/p&gt;
&lt;p&gt;以上是Lambda Calculus的一些基础知识，读者朋友现在不理解没有关系，等后面讲到Haskell中相关的部分就可以理解了。对于抑制不住自已的好奇心的朋友，可以在这里：&lt;a href=&#34;http://en.wikipedia.org/wiki/Lambda_calculus&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://en.wikipedia.org/wiki/Lambda_calculus&lt;/a&gt;做进一步的了解。&lt;/p&gt;
&lt;p&gt;在之前做的&lt;a href=&#34;http://jueqingsizhe66.github.io/blog/2015/05/17/cong-lambdadao-simple-plus-complexjie-shi-qi-zai-dao-shu-xing-chou-xiang/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;lambda的推导&lt;/a&gt;其实都只是针对单个参数，包括&lt;a href=&#34;http://shuklan.com/haskell/lec03.html#/0/15&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Haskell也是强调单参数的调用&lt;/a&gt;，如果多惨数那就是用curry来解决(funny多参数)
关于多参数的lambda推到比较少见，但是多参数都是可以通过curry实现。&lt;/p&gt;
&lt;p&gt;比如Haskell的实现:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;Prelude&amp;gt; :type take
take :: Int -&amp;gt; [a] -&amp;gt; [a]
Prelude&amp;gt; let takeFive = take 5
Prelude&amp;gt; :type takeFive
takeFive :: [a] -&amp;gt; [a]
Prelude&amp;gt; takeFive [1..]
[1,2,3,4,5]
	   
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>从lambda到simple&#43;complex解释器再到树形抽象</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/17/cong-lambdadao-simple-plus-complexjie-shi-qi-zai-dao-shu-xing-chou-xiang/</link>
      <pubDate>Sun, 17 May 2015 11:32:07 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/17/cong-lambdadao-simple-plus-complexjie-shi-qi-zai-dao-shu-xing-chou-xiang/</guid>
      <description>&lt;h2 id=&#34;定义一个eternity函数并尝试是否可以执行&#34;&gt;定义一个eternity函数，并尝试是否可以执行&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define eternity
(lambda (x)
   (eternity x)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其实eternity永远在执行着，无法退出&lt;/p&gt;
&lt;h3 id=&#34;1下面式子只能计算列表的长度0的且永远不会调用eternity&#34;&gt;1.下面式子只能计算列表的长度&amp;lt;=0的,且永远不会调用eternity&lt;/h3&gt;
&lt;p&gt;; Function to calculate length of just empty list.
;
((lambda (len)
(lambda (l)
(cond
((null? l) 0)
(else (+ 1 (len (cdr l)))))))
eternity)&lt;/p&gt;
&lt;h3 id=&#34;2下面式子只能计算列表的长度1的且永远不会调用eternity&#34;&gt;2.下面式子只能计算列表的长度&amp;lt;=1的,且永远不会调用eternity&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;; For lists with length &amp;lt;= 1
;
((lambda (mk-length)
  (mk-length mk-length))
 (lambda (mk-length)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (+ 1 ((mk-length eternity) (cdr l))))))))


&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3下面式子只能计算列表的长度2的且永远不会调用eternity&#34;&gt;3.下面式子只能计算列表的长度&amp;lt;=2的,且永远不会调用eternity&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;; For lists with length &amp;lt;= 2
;
((lambda (len)
  (lambda (l)
    (cond
      ((null? l) 0)
      (else (+ 1 (len (cdr l)))))))
 ((lambda (len)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (+ 1 (len (cdr l)))))))
  ((lambda (len)
    (lambda (l)
      (cond
        ((null? l) 0)
        (else (+ 1 (len (cdr l)))))))
   eternity)))
 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;如果我们进行一次变换&#34;&gt;如果我们进行一次变换&lt;/h2&gt;
&lt;h3 id=&#34;1把eternity替换成mk-length&#34;&gt;1.把eternity替换成mk-length&lt;/h3&gt;
&lt;p&gt;我们发现结果是它可以变成处理无限长度的列表了。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(((lambda (mk-length)
  (mk-length mk-length))
 (lambda (mk-length)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (+ 1 ((mk-length mk-length) (cdr l))))))))
 &#39;(a b c 1 g))  ; 5

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;然而我们对他进一步提取发现报错了&#34;&gt;然而我们对他进一步提取发现报错了&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;((lambda (mk-length)
  (mk-length mk-length))
 (lambda (mk-length)
   ((lambda (len)
     (lambda (l)
       (cond
         ((null? l) 0)
         (else (+ 1 (len (cdr l)))))))
    (mk-length mk-length)))) ; Aborting!: maximum recursion depth exceeded

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;为什么不行&#34;&gt;为什么不行？&lt;/h3&gt;
&lt;p&gt;原因在于 我们需要的是lambda类型的procedure才可以，而函数调用形式则是不行。
然而有一种转换方式如下：&lt;/p&gt;
&lt;p&gt;(f x) ==&amp;gt; (lambda (arg) (f arg) x)&lt;/p&gt;
&lt;p&gt;于是我们得到新的升级版的mk-length&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
((lambda (mk-length)
  (mk-length mk-length))
 (lambda (mk-length)
   ((lambda (len)
     (lambda (l)
       (cond
         ((null? l) 0)
         (else (+ 1 (len (cdr l)))))))
    (lambda (x) ((mk-length mk-length) x)))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;我们发现还是不够满意，我们想把中间的一坨拿到后面去，于是再次抽象一层
也就是我们需要 把(lambda (len) &amp;hellip; (cdr l))部分 移到最外头&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;((lambda (le)
  ((lambda (mk-length)
    (mk-length mk-length))
   (lambda (mk-length)
     (le (lambda (x) ((mk-length mk-length) x))))))
 (lambda (len)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (+ 1 (len (cdr l))))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然而如果我们把后面的(lambda (len))部分去掉&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(lambda (le)
  ((lambda (mk-length)
    (mk-length mk-length))
   (lambda (mk-length)
     (le (lambda (x) ((mk-length mk-length) x))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;他其实就是下面的骨架：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(lambda (le)
  ((lambda ()
    ())
   (lambda ()
     (le (lambda (x) (() x))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果我们使用f来填加：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(lambda (le)
    ((lambda (f)
      (f f))
     (lambda (f)
       (le (lambda (x) ((f f) x))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;他其实就是Y-lambda. 我们所谓的define，let,set!都可以从lambda 推出来。&lt;/p&gt;
&lt;h3 id=&#34;let宏&#34;&gt;let宏&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define-syntax
    (syntax-rules ()
        ((let ((var expr) ...) body ...) ((lambda (var ...) body ...) expr ...))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也就是我们以后完全可以用&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define Y
  (lambda (le)
    ((lambda (f) (f f))
     (lambda (f)
       (le (lambda (x) ((f f) x)))))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y-lambda 执行一个 代表lambda的函数子f。&lt;/p&gt;
&lt;p&gt;比如,求最大值(&lt;em&gt;注意：(lambda (func-arg) func-arg是可以不存在的部分,永远不会被执行&lt;/em&gt;)):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;; 求个数

((Y (lambda (len)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (+ 1 (len (cdr l))))))))  &#39;(3 2 3  6 1))

;;; 求最大值
 ((Y (lambda (func-arg)
        (lambda (l)
          (cond
            ((null? l) &#39;no-list)
            ((null? (cdr l)) (car l))
            (else (max (car l) (func-arg (cdr l)))))))) &#39;(3 2 5 3 425))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外我们发现y-lambda可以写成更优雅、对称的形式:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define Y
  (lambda (le)
    ((lambda (f)
      (le (f f))) ;;; 
     (lambda (f)
       (le (lambda (x) ((f f) x)))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Add le()  is not necessay
But the code can be
More beautiful and symmetry&lt;/p&gt;
&lt;h3 id=&#34;然而其实我的想法只不过是他的复制&#34;&gt;然而其实我的想法只不过是他的复制&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define Y1
  (lambda (le)
    ((lambda (fun)
      (fun fun))  ;; 这是基于抽象的方式,也就是把后面的(lambda (f))  带入其中

     (lambda (f)
       (le (lambda (x) ((f f) x)))))))

((Y1 
 (lambda (fun-arg)
   (lambda (l)
     (cond
       ((null? l) 0)
       (else (+ 1 (fun-arg (cdr l)))))))) &#39;(3 5 2 42))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;简单计算器解释器&#34;&gt;简单计算器解释器&lt;/h2&gt;
&lt;p&gt;来自&lt;a href=&#34;http://pythoner.org/wiki/774/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wangyin&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;; 以下三个定义 env0, ent-env, lookup 是对环境(environment)的基本操作:

;; 空环境
(define env0 &#39;())

;; 扩展。对环境 env 进行扩展，把 x 映射到 v，得到一个新的环境
(define ext-env
  (lambda (x v env)
    (cons `(,x . ,v) env)))

;; 查找。在环境中 env 中查找 x 的值
(define lookup
  (lambda (x env)
    (let ([p (assq x env)])
      (cond
       [(not p) x]
       [else (cdr p)]))))

;; 闭包的数据结构定义，包含一个函数定义 f 和它定义时所在的环境
(struct Closure (f env))

;; 解释器的递归定义（接受两个参数，表达式 exp 和环境 env）
;; 共 5 种情况（变量，函数，调用，数字，算术表达式）
(define interp1
  (lambda (exp env)
    (match exp                                          ; 模式匹配 exp 的以下情况（分支）
      [(? symbol? x) (lookup x env)]                    ; 变量
      [(? number? x) x]                                 ; 数字
      [`(lambda (,x) ,e)                                ; 函数
       (Closure exp env)]
      [`(,e1 ,e2)                                       ; 调用
       (let ([v1 (interp1 e1 env)]
             [v2 (interp1 e2 env)])
         (match v1
           [(Closure `(lambda (,x) ,e) env1)
            (interp1 e (ext-env x v2 env1))]))]
      [`(,op ,e1 ,e2)                                   ; 算术表达式
       (let ([v1 (interp1 e1 env)]
             [v2 (interp1 e2 env)])
         (match op
           [&#39;+ (+ v1 v2)]
           [&#39;- (- v1 v2)]
           [&#39;* (* v1 v2)]
           [&#39;/ (/ v1 v2)]))])))

;; 解释器的“用户界面”函数。它把 interp1 包装起来，掩盖第二个参数，初始值为 env0
(define interp
  (lambda (exp)
    (interp1 exp env0)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
(interp (+ 2 65))
(interp (* 3 2))
(interp (/ 3 23))



&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;复杂解释器&#34;&gt;复杂解释器&lt;/h2&gt;
&lt;p&gt;分为五个部分&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;*const&lt;/li&gt;
&lt;li&gt;*cond&lt;/li&gt;
&lt;li&gt;*identifier(loop-up-evironment)&lt;/li&gt;
&lt;li&gt;*quote&lt;/li&gt;
&lt;li&gt;*lambda&lt;/li&gt;
&lt;li&gt;*Aplication(Not Promitive)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;具体可以看&lt;The little scheme&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket
;;don&#39;t look down on it, it is the full interpretor!
;;Take care to read it!
(define atom?
  (lambda (x)
    (and (not (pair? x)) (not (null? x)))))
  
(define build
  (lambda (s1 s2)
    (cond
      (else (cons s1
                  (cons s2 (quote ())))))))
((lambda (nothing)
     (cond
       (nothing (quote something))
       (else (quote nothing))))
   #t)

(define lookup-in-entry
  (lambda (name entry entry-f)
    (lookup-in-entry-help name
                          (first entry)
                          (second entry)
                          (entry-f))))
(define lookup-in-entry-help
  (lambda (name names values entry-f)
    (cond
      ((null? names) (entry-f name))
      ((eq? (car names) name)
       (car values))
      (else (lookup-in-entry-help name
                                  (cdr names)
                                  (cdr values)
                                  entry-f)))))
(define lookup-in-table
  (lambda (name table table-f)
    (cond 
      ((null? table) (table-f name))
      (else (lookup-in-entry name
                             (car table)
                             (lambda (name)
                                                (cdr table)
                                                (table-f))))))))
(lambda (name table table-f)
    (lookup-in-table name
                     (cdr table)
                     (table-f)))
(define expression-to-action
  (lambda (e)
    (cond
      ((atom? e) (atom-to-action e))
      (else (list-to-action e)))))
(define *const
  (lambda (e table)
    (cond 
      ((number? e) e)
      ((eq? e #t) #t)
      ((eq? e #f) #f)
      (else (build (quote primitive) e)))))
(define atom-to-action
  (lambda (e)
    (cond
      ((number? e) *const)
      ((eq? e #t) *const)
      ((eq? e #f) *const)
      ((eq? e (quote cons)) *const)
      ((eq? e (quote car)) *const)
      ((eq? e (quote cdr)) *const)
      ((eq? e (quote null?)) *const)
      ((eq? e (quote eq?)) *const)
      ((eq? e (quote atom?)) *const)
      ((eq? e (quote zero?)) *const)
      ((eq? e (quote add1)) *const)
      ((eq? e (quote sub1)) *const)
      ((eq? e (quote number?)) *const)
      (else *identifier))))
(define list-to-action
  (lambda (e)
    (cond
      ((atom? (car e))
       (cond
         ((eq? (car e) (quote quote))
          *quote)
         ((eq? (car e) (quote lambda))
          *lambda)
         ((eq? (car e) (quote cond))
          *cond)
         (else *application)))
      (else *application))))

(define *quote
  (lambda (e table)
    (text-of e)))
(define first
  (lambda (p)
    (cond 
      (else (car p)))))
(define second
  (lambda (p)
    (cond
      (else car (cdr p)))))
(define third
  (lambda (p)
    (cond 
      (else car (cdr (cdr p))))))
(define text-of second)

(define table-of first)
(define formals-of second)
(define body-of third)
(define *identifier
  (lambda (e table)
    (lookup-in-table e table initial-table)))
(define initial-table
  (lambda (name)
    (car (quote ()))))
(define *lambda
  (lambda (e table)
    (build (quote non-primitive)
           (cons table (cdr e)))))

(define evcon
  (lambda (lines table)
    (cond 
      ((else? (question-of (car lines)))
       (meaning (answer-of (car lines))
                table))
      ((meaning (question-of (car lines))
                table)
       (meaning (answer-of (car lines))
                table))
      (else (evcon (cdr lines) table)))))

(define else?
  (lambda (x)
    (cond
      ((atom? x) (eq? x (quote else)))
      (else #f))))
(define question-of first)
(define answer-of second)

(define *cond
  (lambda (e table)
    (evcon (cond-lines-of e) table)))
(define cond-lines-of cdr)

(define evlis
  (lambda (args table)
    (cond
      ((null? args) (quote ()))
      (else
       (cons (meaning (car args) table)
             (evlis (cdr args) table))))))
(define *application
  (lambda (e table)
    (apply
     (meaning (function-of e) table)
     (evlis (arguments-of e) table))))
(define function-of car)
(define arguments-of cdr)
(define primitive?
  (lambda (l)
    (eq? (first l) (quote primitive))))
(define non-primitive?
  (lambda (l)
    (eq? (first l) (quote non-primitive))))
(define apply
  (lambda (fun vals)
    (cond
      ((primitive? fun)
       (apply-primitive
        (second fun) vals))
      ((non-primitive? fun)
       (apply-closure
        (second fun) vals)))))

(define apply-primitive
  (lambda (name vals)
    (cond
      ((eq? name (quote cons))
       (cons (first vals) (second vals)))
      ((eq? name (quote car))
       (car (first vals)))
      ((eq? name (quote cdr))
      ((eq? name (quote cdr))
       (cdr (first vals)))
      ((eq? name (quote null?))
       (null? (first vals)))
      ((eq? name (quote eq?))
       (eq? (first vals) (second vals)))
      ((eq? name (quote atom?))
       (:atom? (first vals)))
      ((eq? name (quote zero?))
       (zero? (first vals)))
      ((eq? name (quote add1))
       (add1 (first vals)))
      ((eq? name (quote sub1))
       (sub1 (first vals)))
      ((eq? name (quote number?))
       (number? (first vals))))))
(define :atom?
  (lambda (x)
    (cond
      ((atom? x) #t)
      ((null? x) #f)
      ((eq? (car x) (quote primitive))
       #t)
      ((eq? (car x) (quote non-primitive))
       #t)
      (else #f))))
(define apply-closure
  (lambda (closure vals)
    (meaning (body-of closure)
             (extend-table
              (new-entry
               (formals-of closure)
               vals)
              (table-of closure)))))
(define new-entry build)
(define extend-table cons)

(define value
  (lambda (e)
    (meaning e (quote ()))))
(define meaning
  (lambda (e table)
    ((expression-to-action e) e table)))

(value (+ 3 4 (* 3 1)))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;树形抽象&#34;&gt;树形抽象&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;一个lat 中的一个删除&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define rember3
  (lambda (s l)
    (cond 
      ((null? l) (quote ()))
      ((equal? (car l) s) (cdr l))
      (else (cons (car l)
                  (rember3 s (cdr l)))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;一个list中的一个删除&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define multirember
  (lambda (a lat)
    (cond
      ((null? lat) (quote ()))
      (else
       (cond
         ((eq? (car lat) a)
          (multirember a (cdr lat)))
         (else (cons (car lat)
                     (multirember a (cdr lat)))))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;一个list中的全部删除&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;

(define rember*
  (lambda (a l)
    (cond
      ((null? l) (quote ()))
      ((atom? (car l))
       (cond 
         ((eq? (car l) a)
          (rember* a (cdr l)))
         (else (cons (car l)
                     (rember* a (cdr l))))))
     (else (cons (rember* a (car l))
           (rember* a (cdr l)))))))


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4 1中的rember升级
加入谓词表达式的参数&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define rember-f
  (lambda (test? a l)
    (cond 
      ((null? l) (quote ()))
      (else
       (cond 
         ((test? (car l) a) (cdr l));;I think here needs atom2function
         (else (cons (car l)
                     (rember-f test? a 
                               (cdr l)))))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;2中的multirember升级&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define multirember-f
  (lambda (test?)
    (lambda (a lat)
      (cond 
        ((null? lat) (quote ()))
        ((test? a (car lat))
         ((multirember-f test?) a
                               (cdr lat)))
        (else (cons (car lat)
                    ((multirember test?)  a 
                                          (cdr lat))))))))

(define multirember-eq? (multirember-f &#39;eq?))

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;5中的multirember-f进一步升级&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;加入了可以处理的col,作为一个后处理小程序&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;

(define multiremberco
  (lambda (a lat col)
    (cond 
      ((null? lat)
       (col (quote ()) (quote ())))
      ((eq? (car lat) a)
       (multiremberco a 
                      (cdr lat)
                      (lambda (newlat seen) 
                        (col newlat (cons (car lat) seen)))))
      (else
       (multiremberco a 
                      (cdr lat)
                      (lambda (newlat seen)
                        (col (cons (car lat) newlat)
                             seen)))))))

(define a-friend
  (lambda (x y)
    (null? y)))
;(multiremberco &#39;tuna &#39;(sfds tuna fsd jif) a-friend)
;#f
;&amp;gt; (multiremberco &#39;tuna &#39;(sfds tuna1 fsd jif) a-friend)
;#t
;;how can  you get another value in the col
(define new-friend
  (lambda (newlat seen)
    (a-friend newlat
         (cons (quote tuna) seen))))

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;额外话题-insertleft-insertright-eventonly比较上面的rember理解col&#34;&gt;额外话题 insertleft insertright eventonly比较上面的rember,理解col&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define multiinsertLR
  (lambda (new oldL oldR lat)
    (cond
      ((null? lat) (quote ()))
      ((eq? (car lat) oldL)
       (cons new 
             (cons oldL
                   (multiinsertLR new oldL oldR
                                  (cdr lat)))))
      ((eq? (car lat) oldR)
       (cons oldR
             (cons new
                   (multiinsertLR new oldL oldR
                                 (cdr lat))))))))

(define multiinsertLRco
  (lambda (new oldL oldR lat col)
    (cond
      ((null? lat)
       (col (quote ()) 0 0))
      ((eq? (car lat) oldL)
       (multiinsertLRco new oldL oldR
                        (cdr lat)
                        (lambda (newlat L R)
                          (col (cons new 
                                     (cons oldL newlat))
                               (+ 1 L) R))))
      ((eq? (car lat) oldR)
       (multiinsertLRco new oldL oldR
                        (cdr lat)
                        (lambda (newlat L R)
                          (col (cons oldR
                                     (cons new newlat))
                               L (+ 1 R)))))
      (else
       (multiinsertLRco new oldL oldR 
                        (cdr lat)
                        (lambda (newlat L R)
                          (col (cons (car lat) newlat)
                               L R)))))))


(define evens-only*co
  (lambda (l col)
    (cond
      ((null? l)
       (col (quote ()) 1 0))
      ((atom? (car l))
       (cond 
         ((even? (car l))
          (evens-only*co (cdr l)
                         (lambda (newl p s)
                           (col (cons (car l) newl);if it is evens ,so cons it into the newl
                                (* (car l) p) s))))
         (else (evens-only*co (cdr l)
                              (lambda (newl p s)
                                (col newl p (+ (car l) s)))))))
       (else (evens-only*co (car l)
                            (lambda (al ap as)
                              (evens-only*co (cdr l)
                                             (lambda (dl dp ds)
                                               (col (cons al dl)
                                                    (* ap dp)
                                                    (+ as ds))))))))))
;the fourth collector :: the last-last-friend
(define the-last-last-friend
  (lambda (newl product sum)
    (cons sum 
          (cons product 
                newl))))
;&amp;gt; (evens-only*co &#39;(45389 63 45 6 4 234  6 4 23 52 43) the-last-last-friend)
;&#39;(45563 7008768 6 4 234 6 4 52)


&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;进一步升级multirember 提取公共形式&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;insert-g可以变幻出 rember
insert-r insert-l  subset等&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define rembern
  (lambda (a l)
    ((insert-g seqrem) #f a l)));;seqrem doesn&#39;t need (seqrem solve my ?.
(define seqrem
  (lambda (new old l) 
    l))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;那么insert-g到底是什么?&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define insert-g
  (lambda (seq)
    (lambda (new old l)
      (cond
        ((null? l) (quote ()))
        ((eq? (car l) old)
         (seq new old (cdr l)))
        (else (cons (car l)
                    ((insert-g seq) new old
                                    (cdr l))))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以现在我们可以定义subst&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define seqS
  (lambda (new old l)
    (cons new l)))

(define seqL
    (lambda (new old l)
     (cons new (cons old l))))

(define seqR
    (lambda (new old l)
        (cons (old (cons new l)))))

(define subst1 (insert-g seqS))
(define insertL (insert-g seqL))
(define insertR (insert-g seqR))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;经过这四个级别的抽象我们得到一般的具备公共模式的insert-g
当然该函数还可以继续抽象。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Haskell几个基本概念--学而无用--无以为用</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/16/haskellji-ge-ji-ben-gai-nian-xue-er-wu-yong-wu-yi-wei-yong/</link>
      <pubDate>Sat, 16 May 2015 21:11:50 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/16/haskellji-ge-ji-ben-gai-nian-xue-er-wu-yong-wu-yi-wei-yong/</guid>
      <description>&lt;ol&gt;
&lt;li&gt;模式匹配
= +起着一种模式匹配，=不要翻译成等于 最好翻译为如果匹配前面+ 则他的值为后面.-&amp;gt; 也起着一种类型的模式匹配。&lt;/li&gt;
&lt;li&gt;分支
|在创建函数的时候 体现着一种分支的效果。
if-else  这其实是一种控制语句，不能说Haskell放掉了控制语句，而应该是循环语句。&lt;/li&gt;
&lt;li&gt;一切都是函数。
根据monad的内置结构，函数可以组合生成类似于数学的组合函数（埋藏内部的lambda结构）&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;函数只是关系的表示可以说它是过程变换运动从泛函的角度解释&#34;&gt;函数只是关系的表示，可以说它是过程、变换、运动（从泛函的角度解释）&lt;/h3&gt;
&lt;p&gt;本来函数式变成是不考虑空间的， 而面向对象则是引入不必要的空间问题，来挂上函数，最终都是为了实现函数变换或者函数过程，或者统称为运动。
假如宇宙存在根节点，越靠近根节点的肯定越抽象，我们现在是工作在底层的具象节点下。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;面向对象属于分解，函数编程属于组合。有以为 利，通过面向对象我们将一分解为多个，数量多了，“有”，而函数编程则是将多个组合成一个，数量少了  ，“无”，无才能用，只有忽略事物内部的细节，我们才 能用它，否则陷入细节迷失方向。换句话说：数学分数考得好，不代表在实际中用数学用的好，牛    顿没有发明几何学，但是用了几何学，创造了微积分，用它们推导 出万有引力；爱因斯坦用了非几何学推导了相对论。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;简洁才能落地！&lt;/p&gt;
&lt;p&gt;###从有至无方为用，有乃分，无乃合，宇宙的起点源于无&lt;/p&gt;
&lt;p&gt;学习是一种分解能力，使用是一种组合能力，这是两种不同的能力。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;再看看老子道德经的一段：三十幅共一毂，当其无，有车之用。埏埴以为器，当其无，有器之用。凿户牖以为室，当其无，有室之用。故有之以为利，无之   以为用。
这段话意思是：三十根棍子做成的圆轱辘，只有忽视圆轱辘内部这种结构，着眼于圆轱辘外部，才会发现它原来是可以做车的轮子这一用处，两个轱辘与车    架组合成一辆车。比如门窗，只有忽视其内部如何结构的构建，才会从外部想到用它在房间组合中。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;树形结构抽象细节&#34;&gt;树形结构抽象细节&lt;/h3&gt;
&lt;p&gt;我们之所以使用树形结构，用一个根节点代表其聚合群体，用组长代表所有组员，用名字代表人的全部，等等这些组合抽象的办法就是让我们大脑去除大量   对象内部的细节，用一个符号代替它们，这样我们才能基于这个树的根节点再组合成新的树形结构。&lt;/p&gt;
&lt;h2 id=&#34;范畴理论-交际的互联网&#34;&gt;范畴理论-交际的互联网&lt;/h2&gt;
&lt;p&gt;范畴理论(Category)总是鼓励我们从对象内部细节中转移开来，在范畴理论中 一个对象是一个抽象模糊的实体，你所有需要知道的只是它如何和其他对象交互(关系)，它是怎么使用箭头和其他对象连接的，这就是为什么互联网搜索引擎 Google Baidu等能够通过分析链入和链出的链接来排名网站一样。&lt;/p&gt;
&lt;h2 id=&#34;无以为用--组合思想&#34;&gt;无以为用&amp;ndash;组合思想&lt;/h2&gt;
&lt;p&gt;归根到底，还是“无以为用”这个范畴的组合本质很多人都没有搞清楚。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;只有忘记对象的细节才能用好它。两个原因总结一下：
&lt;ul&gt;
&lt;li&gt;首先，首先人脑短时记忆有限，如果大量对象内部细节占据大脑，而我们需要从对象外部组合它们，    这些细节是干扰。&lt;/li&gt;
&lt;li&gt;其次，范畴也认为组合对象只要将对象看成模糊实体，注重它们之间关系。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;忘记学习对象的细节才能用好它，无以为用，事物的制造者都不一定能用好它，除非事先有目标制造它。
因此，学并不能致用，数理化学得好不一定用得好，博士给老板打工，老板赚大头。因为他把你的学问用处发挥了。自己学自己用因为智力限制也不可能。&lt;/li&gt;
&lt;li&gt;中国教育的典型
在学生阶段,中国学生数理化很好，但是毕业后诺贝尔奖获得者几乎没有，世界自然科学领军人物很少，那些高考状元 学神都哪儿去了？学得好不      一定用得好，中国教育制度是以学习能力评价学生，各种考试充斥大量 知识细节，让学生耗费18年于这些可能以后无用的细节中，最终他们已经没有智力空间来思考如何使用这些大量的知识细节了。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;面向对象的分解能力是强，但是组合能力很弱！
实际上从函数运算的角度，不存在单纯的“值”，1应该是=&amp;amp; gt;1，或者说，所谓的常量值也是函数，只是每次不管输入什么都输出同样的结果。这样世界就只有运算，值是没必&amp;gt;要的，更没有状态。但这是神的视角，而一 旦人开始思考时，由于不具备神的无限的能力，只能在每个瞬间试图去把握世界，就看到了值和状态以及状态呈现时的context/stage/&amp;gt;舞台。但人希 望能像神一样去理解世界，就只好从这每个瞬间呈现的一切中去寻找变与不变的东西，当他们历尽艰辛找到“不变”的“变换”时就迫不及待地将之命名为定律。&lt;/p&gt;
&lt;p&gt;关于上述思想，计算机邀请Haskell带领领略（Haskell可以学习，但是需要投入很多时间，坚持&amp;hellip;）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.zhihu.com/question/20193745&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;综合性帖子&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.jdon.com/47271&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;这边也有一些课程介绍&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;dev.stephendiehl.com/hask/&#34;&gt; What I Wish I Knew When Learning Haskell 2.2 ( Stephen Diehl )&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://acm.wustl.edu/functional/haskell.php&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;How to learn haskell&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://learnyouahaskell.com/chapters&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;相当棒的趣味指南&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;从现实世界走入计算机经过计算机思考再从计算机走出并融入现实世界这就是-函数式思维httpwwwjdoncom45608&#34;&gt;从现实世界走入计算机，经过计算机思考，再从计算机走出并融入现实世界，这就是&lt;a href=&#34;http://www.jdon.com/45608&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 函数式思维&lt;/a&gt;。&lt;/h3&gt;
&lt;p&gt;函数的context引入了时间的关系。&lt;a href=&#34;http://www.jdon.com/45608&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; 我们思考逻辑的时候，定义已经是确定的了。也正因为是确定的，才可以逻辑思考&lt;/a&gt;。
函数不存在状态，所以计算机加入了一个特殊的东西：时钟。值++时间=状态++，在可以忽视时序问题时，可以直接有值=状态。忽视时序问题，就相当于我们平时说的异步。若果单单使用锁，只是一种耗费资源手段。而我们看到无论是唤醒线程，还是延时读取，都是依赖时钟
##+ 小结：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/desk.jpg&#34; alt=&#34;桌子&#34;&gt;
一张桌子为案例，分解思维的人看到后首先想到这张桌子由什么构成，长宽高和材质，这些都是桌子的内部细节；而组合思维的人看到后，环顾四周，看看其处于什么环境，如果放在教室中，他判断这是一张课桌，如果放在食堂，他判断这是一张饭桌。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;从这个例子可以看出组合是从行为（运动、变化、时间）角度看待 世界的，“课桌”、“饭桌”中的“课”和“饭”在这里是动词，意为“上课用”、“吃饭用”的意思，“用”是动词，同一个桌子出现在不同的环境中发挥不同的 作用。而分解思维只研究空间，只研究桌子的空间结构是什么，甚至不研究为什么是四条腿，为什么每条腿长度相同，分解思维根本不考虑这些，不用考虑任何桌子 之外的世界，在分解思维中没有万有引力、没有地面的水平、没有书房和餐厅，只有空间，分解只考虑空间的组成结构。看来分解和组合是相互依存的，分解时研究 的是空间，组合时研究的是行为，把桌子放进餐厅的意义是期待使用它吃饭这样一种运动[组合运动？]。 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;范畴英文是Category，也是++分类++的意思，打个比喻，Google能根据哪些网站引用你的网站这个外部信息进行PageRank评分，从而对你的网站权重进行排序，这个道理和我们评价一个人有些类似，看一个不认识的人怎么样，那就看看他交往的什么朋友，什么环境，近墨者黑，人以群分，物以类聚，这些都是从事物所在的分类类别中判断其价值，而不是从事物内部细节。（评判个人的价值标准跟不同的人在一起，意味着你的价值不一样.）&lt;/p&gt;
&lt;h3 id=&#34;monad-隐藏lambda&#34;&gt;monad 隐藏lambda&lt;/h3&gt;
&lt;p&gt;Monad是一种结构，这种结构能够将一个值放入一个可计算的上下文中。因为Lambda是一个和上下文环境有关的表达式，所以，这里对Monad的上下文理解就比较容易。
monad是从范畴论引入， 范畴其实就是一个集合，只不过对这个集合有一些约束定义，如果 熟悉业务建模的人可能对这种思维方式不陌生，经常我们会对抽象的事物进行定义，数学上基本就是用集合概念，实际上从罗素悖论拯救了数学开始，数学离不开集合，对于一个国家社会，个人与社会也是不同的概念，社会是一个++集合++概念，从++集合角度++考虑问题和从__个人元素角度__考虑问题是两种截然不同的思路，如果你平时注 重这种区别，你可能会有两种人生观。祝你脑洞大开。&lt;/p&gt;
&lt;h3 id=&#34;函数式替代sql&#34;&gt;函数式替代sql？&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://www.jdon.com/44842&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;函数的逻辑性&lt;/a&gt;与关系数据库的是一致的，而逻辑在不同语言之间是自然贯穿的，也就是说若果所有都用函数来表达的，可以使sql消失，那么由于sql引发的问题自然就消失。
数据库 = 一个集合,这就是面向集合，mongodb就是这样的思想&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>language limits the world of you</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/16/language-limits-the-world-of-you/</link>
      <pubDate>Sat, 16 May 2015 16:17:39 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/16/language-limits-the-world-of-you/</guid>
      <description>&lt;ol&gt;
&lt;li&gt;语言可以削尖我们的思维[进行思维锐化：思维锐化工具有哪些？ 鱼骨图找因果]。&lt;/li&gt;
&lt;li&gt;语言也会限制我们的世界。&lt;/li&gt;
&lt;li&gt;好的语言一定会影响你的思维方式,haskell,scheme,lisp&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;Language shapes the way we think, and determines what we can think about.
Benjamin Lee Whorf&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;The limits of my language mean the limits of my world.
Ludwig Wittgenstein&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;A language that doesn’t affect the way you think about programming, is not worth knowing.
Alan Perlis&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;##Who uses Haskell?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AT&amp;amp;T : automate form processing&lt;/li&gt;
&lt;li&gt;Bank of America Merril Lynch  : data transformation and loading&lt;/li&gt;
&lt;li&gt;Bump :   Haskell-based server&lt;/li&gt;
&lt;li&gt;Facebook :   manipulating PHP code base&lt;/li&gt;
&lt;li&gt;Google :   internal IT infrastructure&lt;/li&gt;
&lt;li&gt;MITRE :   cryptographic protocol analysis&lt;/li&gt;
&lt;li&gt;NVIDIA :    in-house tools&lt;/li&gt;
&lt;li&gt;Qualcomm, Inc  :   generate Lua bindings&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;types&#34;&gt;Types&lt;/h2&gt;
&lt;p&gt;Every function in haskell has a Type signature.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;foo :: Int -&amp;gt; String
	    
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I don&amp;rsquo;t know what foo means,but I know what it does!&lt;/p&gt;
&lt;p&gt;Haskell引进了很多模块化思想，比如module,import导包的，下面的这些书都可以在
&lt;a href=&#34;http://vdisk.weibo.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;新浪微盘&lt;/a&gt;找到:
###书籍&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Book1: Books for Learning Haskell&lt;/li&gt;
&lt;li&gt;Book2: Learn You a Haskell for Great Good! (&lt;em&gt;Important&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;Book3: Real World Haskell(&lt;em&gt;Important&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;Book4: Beginning Haskell&lt;/li&gt;
&lt;li&gt;Book5: Thinking Functionally with Haskell&lt;/li&gt;
&lt;li&gt;Book6: Parallel and Concurrent Programming in Haskell&lt;/li&gt;
&lt;li&gt;Book7: Programming in Haskell&lt;/li&gt;
&lt;li&gt;Book8: Haskell: The Craft of Functional Programming (&lt;em&gt;Important&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;Book9: The Haskell School of Music&lt;/li&gt;
&lt;li&gt;Book10:Developing Web Applications with Haskell and Yesod&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;##Functional:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Haskell, Lisp, ML, Scheme, Erlang
Focuses on the high-level &lt;em&gt;&amp;ldquo;what&amp;rdquo;&lt;/em&gt;(Math thinking)
##Imperative:&lt;/li&gt;
&lt;li&gt;C++, Java, Python, Pascal
Focuses on the low-level &lt;em&gt;&amp;ldquo;how&amp;rdquo;&lt;/em&gt;(Computer Thinking)
&lt;a href=&#34;http://shuklan.com/haskell/lec01.html#/0/30&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Haskell Learning Center&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>Haskell笔记</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/16/haskellbi-ji/</link>
      <pubDate>Sat, 16 May 2015 14:30:22 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/16/haskellbi-ji/</guid>
      <description>&lt;p&gt;语言的表现力，简洁性，有效性。&lt;/p&gt;
&lt;p&gt;2001年，出生于荷兰的计算机大师、图灵奖获得者__EdsgerW.Dijkstra__给德州大学预算委员会写信，力劝不要将计算机入门课程改为Java。不幸的是，学校最终还是用Java课程替换了Haskell。Haskell真的不行了？国内有些人的&lt;a href=&#34;http://www.vaikan.com/why-haskell-is-worth-learning/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;评论&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Haskell:函数式编程语言&lt;/li&gt;
&lt;li&gt;Java  : 命令编程语言
尽管Haskell不完美，但仍然比Java好几个数量级，Java就是一个大杂烩(它是通过大范围的广告和销售员夸张的宣传才达到它的商业接受)。&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;如果别人问你Haskell能够做什么？
一个能够编程的编程语言，高级函数编程语言&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果别人问你Haskell和scheme有什么区别？
比scheme更强调类型理论，但是相对scheme由于对于type theory的过度追求
反而更加难于编程&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;如果别人问你haskell-如何实现冒泡法--直接排序--快速排序&#34;&gt;如果别人问你Haskell 如何实现冒泡法  直接排序  快速排序？&lt;/h3&gt;
&lt;h4 id=&#34;冒泡排序&#34;&gt;冒泡排序&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;
sort1 [x] = [x]
sort1 (x:x1:xs)  {-选取了一个x1temp 值  x当做首数，x1:temp-}
    | x&amp;gt;x1 = x1:sort1 (x:xs)
    | otherwise = x:sort1 (x1:xs)
mpsort [] = []
mpsort x = let tmp = sort1 x in
           mpsort (init tmp) ++ [(last tmp)] 
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;直接排序&#34;&gt;直接排序&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;import Data.List
selectsort::[Int] -&amp;gt; [Int]
selectsort [] = []
selectsort [x] = [x]
selectsort xs = minimum xs : selectsort ( delete ( minimum xs )  xs) 

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;快速排序1&#34;&gt;快速排序1&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;
quicksort :: (Ord a) =&amp;gt; [a] -&amp;gt; [a]   
quicksort [] = []   
quicksort (x:xs) =   
  let smallerSorted = quicksort [a | a &amp;lt;- xs, a &amp;lt;= x]  
      biggerSorted = quicksort [a | a &amp;lt;- xs, a &amp;gt; x]   
  in smallerSorted ++ [x] ++ biggerSorted
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;快速排序2&#34;&gt;快速排序2&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-haskell&#34;&gt;quicksort :: (Ord a) =&amp;gt; [a] -&amp;gt; [a]     
quicksort [] = []     
quicksort (x:xs) =      
    let smallerSorted = quicksort (filter (&amp;lt;=x) xs) 
        biggerSorted = quicksort (filter (&amp;gt;x) xs)    
    in  smallerSorted ++ [x] ++ biggerSorted
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果别人问你递归是如何实现的&#34;&gt;如果别人问你递归是如何实现的？&lt;/h3&gt;
&lt;h3 id=&#34;如果别人问你如何构造fibonaaci数&#34;&gt;如果别人问你如何构造Fibonaaci数？&lt;/h3&gt;
&lt;h3 id=&#34;如果别人问你----是什么意思&#34;&gt;如果别人问你::  =&amp;gt; -&amp;gt;是什么意思？&lt;/h3&gt;
&lt;p&gt;(==) :: Eq a =&amp;gt; a -&amp;gt; a -&amp;gt; Bool
可以这样阅读：  相当函数的两个相同的类型值作为参数并返回一个bool值，而这两个参数的类型同在Eq类之中(即类型约束）
eq这一类型 提供了判断相等性的接口，凡是可以比较相等性的类型嗯必属于Eq类
（=&amp;gt;左边的部分叫做类型约束）
a表示人意的类型 &amp;mdash;&amp;mdash;&amp;mdash;泛形 &amp;mdash;多态函数挂钩。。。。&lt;/p&gt;
&lt;p&gt;::  读作他的类型为   （类似 !! 从list去除 第几个元素   &amp;lt;- 属于  &lt;code&gt;elem&lt;/code&gt;是什么的元素   &lt;code&gt;mod&lt;/code&gt; 可以和什么除。。&lt;/p&gt;
&lt;h3 id=&#34;如果有人问你如何用haskell编写函数&#34;&gt;如果有人问你如何用haskell编写函数？&lt;/h3&gt;
&lt;p&gt;他和scheme有很大的不同，scheme用的是(define)
而haskell用的是模式匹配，比如下面的求最大值的程序&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;maximum&#39; :: (Ord a) =&amp;gt; [a] -&amp;gt; a   
maximum&#39; [] = error &amp;quot;maximum of empty list&amp;quot;   
maximum&#39; [x] = x   
maximum&#39; (x:xs)    
    | x &amp;gt; maxTail = x   
    | otherwise = maxTail   
    where maxTail = maximum&#39; xs
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果别人叫你简化上面的maximum程序&#34;&gt;如果别人叫你简化上面的maximum程序&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;maximum&#39; :: (Ord a) =&amp;gt; [a] -&amp;gt; a   
maximum&#39; [] = error &amp;quot;maximum of empty list&amp;quot;   
maximum&#39; [x] = x   
maximum&#39; (x:xs) = max x (maximum&#39; xs) 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果别人问你haskell到底长成啥子样子&#34;&gt;如果别人问你Haskell到底长成啥子样子？&lt;/h3&gt;
&lt;p&gt;你会告诉他他涨起来真的是一节一节的，一段一段的，有棱有角&lt;/p&gt;
&lt;h3 id=&#34;如果有人问你replicate-3-5是如何实现的&#34;&gt;如果有人问你replicate 3 5是如何实现的？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;replicate&#39; :: (Num i, Ord i) =&amp;gt; i -&amp;gt; a -&amp;gt; [a]   
replicate&#39; n x   
| n &amp;lt;= 0    = []   
| otherwise = x:replicate&#39; (n-1) x
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果有人问你take是如何实现的呢-drop&#34;&gt;如果有人问你take是如何实现的呢？ drop?&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;take&#39; :: (Num i, Ord i) =&amp;gt; i -&amp;gt; [a] -&amp;gt; [a]   
take&#39; n _   
| n &amp;lt;= 0   = []   
take&#39; _ []     = []   
take&#39; n (x:xs) = x : take&#39; (n-1) xs
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果有人问你_-下划线表示什么意思&#34;&gt;如果有人问你_ 下划线表示什么意思？&lt;/h3&gt;
&lt;p&gt;_ 代表任意东西&lt;/p&gt;
&lt;h3 id=&#34;如果有人问你reverse如何实现&#34;&gt;如果有人问你reverse如何实现？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;reverse&#39; :: [a] -&amp;gt; [a]   
reverse&#39; [] = []   
reverse&#39; (x:xs) = reverse&#39; xs ++ [x]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果有人问你repeat如何实现&#34;&gt;如果有人问你repeat如何实现？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;repeat&#39; :: a -&amp;gt; [a]   
repeat&#39; x = x:repeat&#39; x
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果有人做了一个tuple-想要用zip产生更多tuples&#34;&gt;如果有人做了一个tuple ，想要用zip产生更多tuples？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;zip&#39; :: [a] -&amp;gt; [b] -&amp;gt; [(a,b)]   
zip&#39; _ [] = []   
zip&#39; [] _ = []   
zip&#39; (x:xs) (y:ys) = (x,y):zip&#39; xs ys
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果有人问你mod的类似函数--elem的实现&#34;&gt;如果有人问你mod的类似函数  elem的实现？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;elem&#39; :: (Eq a) =&amp;gt; a -&amp;gt; [a] -&amp;gt; Bool   
elem&#39; a [] = False   
elem&#39; a (x:xs)   
| a == x    = True   
| otherwise = a `elem&#39;` xs
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;如果有人问你typeclass有哪里类&#34;&gt;如果有人问你typeclass有哪里类？&lt;/h3&gt;
&lt;p&gt;利用 type 自己查去&lt;/p&gt;
&lt;h3 id=&#34;如果有人问你haskell有没有类似scheme的lambda函数&#34;&gt;如果有人问你Haskell有没有类似scheme的lambda函数？&lt;/h3&gt;
&lt;p&gt;告诉他有，而且更加直接，虽然刚开始书写起来不方便&lt;/p&gt;
&lt;p&gt;scheme版的lambda:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    (lambda (x y)
       (+ x y))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Haskell版的lambda:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    (\y -&amp;gt; y + 3）
    其中\后面跟着参数  -&amp;gt;后面跟着函数体
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;18如果有人问haskell有没有存在高阶函数&#34;&gt;18.如果有人问haskell有没有存在高阶函数？&lt;/h3&gt;
&lt;p&gt;有 。 map ,filter&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;map (\y-&amp;gt; y+3) [3,5,6]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;19如果有人问你flip有什么含义&#34;&gt;19.如果有人问你flip有什么含义？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;let f x  y = x / y
Prelude&amp;gt; map (f 2) [1,2,3]
[2.0,1.0,0.6666666666666666]
Prelude&amp;gt; map (flip f 2) [1,2,3]
[0.5,1.0,1.5]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;20-如何有人问-如何运行-2048&#34;&gt;20. 如何有人问 如何运行 2048&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;$ runhaskell putchar_test.hs 
use runhaskell to run the *.hs programme
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;21-如果有人问haskell实现递归的自然表达式&#34;&gt;21. 如果有人问haskell实现递归的自然表达式？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quicksort (x:xs) =
elem&#39; a (x:xs) 

zip&#39; (x:xs) (y:ys) = (x,y):zip&#39; xs ys
reverse&#39; (x:xs) = reverse&#39; xs ++ [x]

take&#39; n (x:xs) = x : take&#39; (n-1) xs
maximum&#39; (x:xs) = max x (maximum&#39; xs)
maximum&#39; (x:xs)   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;你可以看见每一个形式都有函数名,函数使用方式,函数的参数表 &lt;br&gt;
这是一种__模式__,因为Haskell使用函数的时候，先写出函数，然后空格 写出变量 紧接着其他可选变量
所以你也函数匹配模式 也应该是这样来写
基于这种思想，你重新回过头看函数定义，你会发现还真的是这样额？！
从函数的定义知道他的用法，这就是Haskell与众不同的一点。&lt;/p&gt;
&lt;h3 id=&#34;22-如果有人问如何写出阶乘形式&#34;&gt;22. 如果有人问如何写出阶乘形式？&lt;/h3&gt;
&lt;p&gt;告诉他用函数，告诉他用函数匹配，告诉他用递归。。。。。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;factorial :: (Integral a) =&amp;gt; a -&amp;gt; a   
factorial 0 = 1   
factorial n = n * factorial (n - 1) 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;23-如果别人问你haskell如何新建一中类型&#34;&gt;23. 如果别人问你Haskell如何新建一中类型？&lt;/h3&gt;
&lt;p&gt;暂时不太懂
但是我知道 Haskell使用 data来定义类别
julia使用type来定义&lt;/p&gt;
&lt;h3 id=&#34;24-如果别人问你monads-是什么玩意&#34;&gt;24. 如果别人问你monads 是什么玩意？&lt;/h3&gt;
&lt;p&gt;其实这个是更加深层次的运用Haskell,在scheme也有. 比如IO monad,可以想象为一种抽象数据类型。&lt;/p&gt;
&lt;h3 id=&#34;25-如果别人问你如何学习haskell&#34;&gt;25. 如果别人问你如何学习haskell？&lt;/h3&gt;
&lt;p&gt;告诉他有一篇文章叫做 如此有趣的学习Haskell
Haskell趣學指南   &lt;a href=&#34;http://learnyouahaskell-zh-tw.csie.org/zh-cn/chapters.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://learnyouahaskell-zh-tw.csie.org/zh-cn/chapters.html&lt;/a&gt;
还不错 ，这个教程&lt;/p&gt;
&lt;p&gt;学习Haskell ，要是你能够对于空格特别敏感，会对你有所好处，因为很多地方都是用空格分开
而不是（）  [] 之类的。空格有实际意义，分开不同的字段&lt;/p&gt;
&lt;h3 id=&#34;26-如果别人问你--有什么意义&#34;&gt;26. 如果别人问你 | 有什么意义？&lt;/h3&gt;
&lt;p&gt;分类说明&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bmiTell :: (RealFloat a) =&amp;gt; a -&amp;gt; a -&amp;gt; String   
bmiTell weight height   
    | weight / height ^ 2 &amp;lt;= 18.5 = &amp;quot;You&#39;re underweight, you emo, you!&amp;quot;   
    | weight / height ^ 2 &amp;lt;= 25.0 = &amp;quot;You&#39;re supposedly normal. Pffft, I bet you&#39;re ugly!&amp;quot;   
    | weight / height ^ 2 &amp;lt;= 30.0 = &amp;quot;You&#39;re fat! Lose some weight, fatty!&amp;quot;   
    | otherwise                   = &amp;quot;You&#39;re a whale, congratulations!&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;每一个函数定义的时候，在Haskell看来只是其中的一种模式，一个模式下可以有很多的分类，如果他找不到模式
就说找不到，所以定义的时候，尽可能的完善定义。
比如下面的lucky函数 和sayMe 函数
lucky函数:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lucky :: (Integral a) =&amp;gt; a -&amp;gt; String   
lucky 7 = &amp;quot;LUCKY NUMBER SEVEN!&amp;quot;   
lucky x = &amp;quot;Sorry, you&#39;re out of luck, pal!&amp;quot; 

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sayme函数:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sayMe :: (Integral a) =&amp;gt; a -&amp;gt; String   
sayMe 1 = &amp;quot;One!&amp;quot;   
sayMe 2 = &amp;quot;Two!&amp;quot;   
sayMe 3 = &amp;quot;Three!&amp;quot;   
sayMe 4 = &amp;quot;Four!&amp;quot;   
sayMe 5 = &amp;quot;Five!&amp;quot;   
sayMe x = &amp;quot;Not between 1 and 5&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;27-如果别人叫你简化bmitell函数&#34;&gt;27. 如果别人叫你简化bmiTell函数&lt;/h3&gt;
&lt;p&gt;使用where&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bmiTell :: (RealFloat a) =&amp;gt; a -&amp;gt; a -&amp;gt; String   
bmiTell weight height   
    | bmi &amp;lt;= 18.5 = &amp;quot;You&#39;re underweight, you emo, you!&amp;quot;   
    | bmi &amp;lt;= 25.0 = &amp;quot;You&#39;re supposedly normal. Pffft, I bet you&#39;re ugly!&amp;quot;   
    | bmi &amp;lt;= 30.0 = &amp;quot;You&#39;re fat! Lose some weight, fatty!&amp;quot;   
    | otherwise   = &amp;quot;You&#39;re a whale, congratulations!&amp;quot;   
    where bmi = weight / height ^ 2
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;28-如果别人问你-where可以跟多少个变量-&#34;&gt;28. 如果别人问你 where可以跟多少个变量 ？&lt;/h3&gt;
&lt;p&gt;跟他说 很多个。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bmiTell :: (RealFloat a) =&amp;gt; a -&amp;gt; a -&amp;gt; String   
bmiTell weight height   
    | bmi &amp;lt;= skinny = &amp;quot;You&#39;re underweight, you emo, you!&amp;quot;   
    | bmi &amp;lt;= normal = &amp;quot;You&#39;re supposedly normal. Pffft, I bet you&#39;re ugly!&amp;quot;   
    | bmi &amp;lt;= fat    = &amp;quot;You&#39;re fat! Lose some weight, fatty!&amp;quot;   
    | otherwise     = &amp;quot;You&#39;re a whale, congratulations!&amp;quot;   
    where bmi = weight / height ^ 2   
          skinny = 18.5   
          normal = 25.0   
          fat = 30.0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;函数在 where 绑定中定义的名字只对本函数可见，因此我们不必担心它会污染其他函数的命名空间。注意，其中的名字
都是一列垂直排开，如果不这样规范，Haskell 就搞不清楚它们在哪个地方了&lt;/p&gt;
&lt;h3 id=&#34;29-如果有人问你-where当中可以使用模式匹配吗&#34;&gt;29. 如果有人问你 where当中可以使用模式匹配吗？&lt;/h3&gt;
&lt;p&gt;可以。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;where bmi = weight / height ^ 2   
(skinny, normal, fat) = (18.5, 25.0, 30.0) 

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;30-如果别人叫你写一个show类型的函数&#34;&gt;30. 如果别人叫你写一个show类型的函数？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;tell :: (Show a) =&amp;gt; [a] -&amp;gt; String   
tell [] = &amp;quot;The list is empty&amp;quot;   
tell (x:[]) = &amp;quot;The list has one element: &amp;quot; ++ show x   
tell (x:y:[]) = &amp;quot;The list has two elements: &amp;quot; ++ show x ++ &amp;quot; and &amp;quot; ++ show y   
tell (x:y:_) = &amp;quot;This list is long. The first two elements are: &amp;quot; ++ show x ++ &amp;quot; and &amp;quot; ++ show y  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个函数顾及了空 List，单元素 List，双元素 List 以及较长的 List，所以这个函数很安全。(x:[]) 与 (x:y:[]) 也可以写作 [x] 和 [x,y] (有了语法糖，我们不必多加括号)。不过 (x:y:_)这样的模式就不行了，因为它匹配的 List 长度不固定。&lt;/p&gt;
&lt;h3 id=&#34;31-如果别人问你int-和integer的区别&#34;&gt;31. 如果别人问你Int 和Integer的区别？&lt;/h3&gt;
&lt;p&gt;Int 有上下线  Integer没有&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Prelude&amp;gt; minBound :: Int
-9223372036854775808
Prelude&amp;gt; min
min       minBound  minimum
Prelude&amp;gt; minBound  :: Integer 

&amp;lt;interactive&amp;gt;:247:1:
    No instance for (Bounded Integer) arising from a use of `minBound&#39;

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;32-如果别人问你char-and-char-的区别&#34;&gt;32. 如果别人问你char and [char] 的区别？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Prelude&amp;gt; :t &#39;a&#39;
&#39;a&#39; :: Char
Prelude&amp;gt; :t &amp;quot;a&amp;quot;
&amp;quot;a&amp;quot; :: [Char]
Prelude&amp;gt; :t &amp;quot;dfasdf&amp;quot;
&amp;quot;dfasdf&amp;quot; :: [Char]
Prelude&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;33-如果别人问你变量有类型那么函数是不是也有类型&#34;&gt;33. 如果别人问你变量有类型，那么函数是不是也有类型？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;removeNonUppercase :: [Char] -&amp;gt; [Char]   
removeNonUppercase st = [ c | c &amp;lt;- st, c `elem` [&#39;A&#39;..&#39;Z&#39;]]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;removeNonUppercase 的类型为 [Char]-&amp;gt;[Char]，从它的参数和回传值的类型上可以看出，
它将一个字串映射为另一个字串。[Char] 与 String 是等价的，但使用 String 会更清晰：
removeNonUppercase :: String -&amp;gt; String。编译器会自动检测出它的类型，我们还是标明了
它的类型声明。要是多个参数的函数该怎样？如下便是一个将三个整数相加的简单函数
参数之间由 -&amp;gt; 分隔，而与回传值之间并无特殊差异&lt;/p&gt;
&lt;h3 id=&#34;34-如果别人问你有没有比较好用的编程工具&#34;&gt;34. 如果别人问你有没有比较好用的编程工具？&lt;/h3&gt;
&lt;p&gt;告诉他Haskell！&lt;/p&gt;
&lt;p&gt;该如何学习？
告诉他安装 ghci,并且在软件中输入 :brower  就能观察到很多的类型
并且支持tab键。
:brower 会列出内置函数的 类型，以及他的基本使用方法&lt;/p&gt;
&lt;h3 id=&#34;35-如果别人问你高阶函数是如何定义&#34;&gt;35. 如果别人问你高阶函数是如何定义？&lt;/h3&gt;
&lt;p&gt;高阶函数&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;map f lst --将lst按照函数f映射得到一个新的数列
map :: (a-&amp;gt;b) -&amp;gt; [a] -&amp;gt;
map f [] = []
map f (x:xs) = f x : map f xs

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;36-如果别人问你如何使用-brower-提供的函数类型&#34;&gt;36. 如果别人问你如何使用 :brower 提供的函数类型？&lt;/h3&gt;
&lt;p&gt;比如：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;36.1
Prelude&amp;gt; :t product 
product :: Num a =&amp;gt; [a] -&amp;gt; a
Prelude&amp;gt; product [3,5,2]
30
36.2
readFile :: FilePath -&amp;gt; IO String

Prelude&amp;gt; readFile &amp;quot;/tmp/a.txt&amp;quot;
&amp;quot;fdsf&amp;quot;
Prelude&amp;gt; let  d=readFile &amp;quot;/tmp/a.txt&amp;quot;
Prelude&amp;gt; d
&amp;quot;fdsf&amp;quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;37--如果别人问你如何切断一个数组在某个位置&#34;&gt;37.  如果别人问你如何切断一个数组在某个位置？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;splitAt :: Int -&amp;gt; [a] -&amp;gt; ([a], [a])
Prelude&amp;gt; splitAt 3 [3,5,6,2,3,6,3]
([3,5,6],[2,3,6,3])

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;38--如果别人问你为什么你这样使用subtract&#34;&gt;38.  如果别人问你为什么你这样使用subtract?&lt;/h3&gt;
&lt;p&gt;告诉他，我是看着定义来使用的。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;subtract :: Num a =&amp;gt; a -&amp;gt; a -&amp;gt; a
Prelude&amp;gt; subtract 20 3
-17
Prelude&amp;gt; subtract [30,3] [3,3]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;39--如果别人问你-zip相关的函数&#34;&gt;39.  如果别人问你 zip相关的函数？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;    Prelude&amp;gt; unzip [(3,4)]
    ([3],[4])
    Prelude&amp;gt; unzip [(3,4),(3,7)]
    ([3,3],[4,7])
    Prelude&amp;gt; unzip [(3,4),(3,7),(7,4)]
    ([3,3,7],[4,7,4])
    Prelude&amp;gt; unzip [(3,4),(3,7),(7,4),(8,9)]
    ([3,3,7,8],[4,7,4,9])
    Prelude&amp;gt; unzip [((3,4),(3,7)),((7,4),(8,9))]
    ([(3,4),(7,4)],[(3,7),(8,9)])

    unzip3 :: [(a, b, c)] -&amp;gt; ([a], [b], [c])

    Prelude&amp;gt; unzip3 [(3,6,3)]
    ([3],[6],[3])
    Prelude&amp;gt; unzip3 [(3,6,3),(3,5,9)]
    ([3,3],[6,5],[3,9])
    Prelude&amp;gt; unzip3 [(3,6,3),(3,5,9),(8,9,0)]
    ([3,3,8],[6,5,9],[3,9,0])
    Prelude&amp;gt; unzip3 [(3,6,3,5),(3,5,9,3),(8,9,0,6)]

    &amp;lt;interactive&amp;gt;:172:9:
        Couldn&#39;t match expected type `(a0, b0, c0)&#39;
                    with actual type `(t0, t1, t2, t3)&#39;

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;40-如果别人问你un相关的函数&#34;&gt;40. 如果别人问你un相关的函数？&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Prelude&amp;gt; unlines [&amp;quot;ds&amp;quot;,&amp;quot;dfsf&amp;quot;]
&amp;quot;ds\ndfsf\n&amp;quot;
until :: (a -&amp;gt; Bool) -&amp;gt; (a -&amp;gt; a) -&amp;gt; a -&amp;gt; a
unwords :: [String] -&amp;gt; String
Prelude&amp;gt; unwords [&amp;quot;dsf&amp;quot;,&amp;quot;fdsf&amp;quot;]
&amp;quot;dsf fdsf&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;41-如果比人问你如何使用-sin等三角函数&#34;&gt;41. 如果比人问你如何使用 sin等三角函数？&lt;/h3&gt;
&lt;p&gt;转换为弧度制&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Prelude&amp;gt; sin (45/180*pi)
0.7071067811865475
Prelude&amp;gt; sin (45*pi/180)
0.7071067811865475

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;42-如果别人问你haskell针对字符的函数&#34;&gt;42. 如果别人问你Haskell针对字符的函数？&lt;/h3&gt;
&lt;p&gt;Haskell中预定义的针对字符的函数有:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   isAscii, isLatin1, isControl, isPrint, isSpace, isUpper, isLower,
   isAlpha, isDigit, isOctDigit, isHexDigit, isAlphaNum,
   digitToInt, intToDigit,
   toUpper, toLower,
   ord, chr,等
   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ord将字母转换为数字, chr反之.&lt;/p&gt;
&lt;h3 id=&#34;43-如果别人问你构造数组的几种方式&#34;&gt;43. 如果别人问你构造数组的几种方式？&lt;/h3&gt;
&lt;p&gt;数列是通过[]来进行描述的&lt;/p&gt;
&lt;h4 id=&#34;431-数组构造&#34;&gt;43.1 数组构造&lt;/h4&gt;
&lt;p&gt;数列是用[]和(:)构造的, []是一个空的数列, x:xs的含义是元素x附加到数列xs的前面组成一个更长的数列.
比如, 1:[] 等于[1], 2:3:1:[]等于[2,3,1], 运算符(:)是从右向左运算的. 所有的数列都可以看作是从[]开始,
将各元素用(:)附到上面形成的. 在实际编程中有一些简记法可以快速地构造数列.&lt;/p&gt;
&lt;h4 id=&#34;432-列举法&#34;&gt;43.2 列举法&lt;/h4&gt;
&lt;p&gt;将数列的元素一一列举, 比如: [1,2,3], [&amp;lsquo;A&amp;rsquo;,&amp;lsquo;B&amp;rsquo;,&amp;rsquo;d&#39;], [[1,2], [4,5,6]]等等,
数列的类型用&amp;quot;[元素类型]&amp;ldquo;来表示, 这几个例子的类型依次为: [Int], [Char], [[Int]].&lt;/p&gt;
&lt;h4 id=&#34;433-范围法&#34;&gt;43.3 范围法&lt;/h4&gt;
&lt;p&gt;适用于构造等差数列, 比如: [1..5]等于[1,2,3,4,5], [&amp;lsquo;a&amp;rsquo;..&amp;rsquo;d&#39;]等于[&amp;lsquo;a&amp;rsquo;,&amp;lsquo;b&amp;rsquo;,&amp;lsquo;c&amp;rsquo;,&amp;rsquo;d&#39;]等于&amp;quot;abcd&amp;quot;因为type String=[Char].
默认的等差为1, 也可以给出前两个元素指定等差, 比如: [2,4..8]等于[2,4,6,8], [2,4..7]等于[2,4,6], [2.5,4..9.5]等于
[2.5,4.0,5.5,7.0,8.5,10.0].&lt;/p&gt;
&lt;h3 id=&#34;433-描述法&#34;&gt;43.3 描述法&lt;/h3&gt;
&lt;p&gt;描述法给出数列中元素取值的范围以及所满足的条件, 与数学中集合的描述法是一样的. 例如:
[3*x+2| x&amp;lt;-[3,6,9]] &amp;ndash;记号&amp;rdquo;&amp;lt;-&amp;ldquo;表示属于,x依次取3,6,9,代入3*x+2,得到数列[11,20,29]
[x*x| x&amp;lt;-[1..9], x `rem` 3==1] &amp;ndash;给出x的范围,还限定x除3余1
[(x,y)|x&amp;lt;-[1,2,3],y&amp;lt;-[x..3]] &amp;ndash;等于 [(1,1),(1,2),(1,3),(2,2),(2,3),(3,3)]&lt;/p&gt;
&lt;h3 id=&#34;44-如果别人跟你说haskell可以write-poet&#34;&gt;44. 如果别人跟你说Haskell可以write poet?&lt;/h3&gt;
&lt;p&gt;第一次语文  数学   计算机的结合&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Prelude&amp;gt;  let nouns = [&amp;quot;he&amp;quot;,&amp;quot;she&amp;quot;,&amp;quot;I&amp;quot;]
Prelude&amp;gt; let adjectives=[&amp;quot;lazy&amp;quot;,&amp;quot;handsome&amp;quot;,&amp;quot;something&amp;quot;]
Prelude&amp;gt; [adjective ++ &amp;quot; &amp;quot; ++ noun | adjective &amp;lt;-adjectives ,noun&amp;lt;-nouns]
[&amp;quot;lazy he&amp;quot;,&amp;quot;lazy she&amp;quot;,&amp;quot;lazy I&amp;quot;,&amp;quot;handsome he&amp;quot;,&amp;quot;handsome she&amp;quot;,&amp;quot;handsome I&amp;quot;,&amp;quot;something he&amp;quot;,&amp;quot;something she&amp;quot;,&amp;quot;something I&amp;quot;]

*Main&amp;gt; let nouns = [&amp;quot;he&amp;quot;,&amp;quot;she&amp;quot;,&amp;quot;I&amp;quot;]
*Main&amp;gt; let adjectives=[&amp;quot;lazy&amp;quot;,&amp;quot;handsome&amp;quot;,&amp;quot;something&amp;quot;]
*Main&amp;gt; [adjective ++ &amp;quot; &amp;quot; ++ noun | adjective &amp;lt;-adjectives ,noun&amp;lt;-nouns]
[&amp;quot;lazy he&amp;quot;,&amp;quot;lazy she&amp;quot;,&amp;quot;lazy I&amp;quot;,&amp;quot;handsome he&amp;quot;,&amp;quot;handsome she&amp;quot;,&amp;quot;handsome I&amp;quot;,&amp;quot;something he&amp;quot;,&amp;quot;something she&amp;quot;,&amp;quot;something I&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;###45. 如果别人跟你说Haskell可以跟几何并轨？
第一次和几何的触碰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Prelude&amp;gt;  let triangels=[(a,b,c)|c&amp;lt;-[1..10],b&amp;lt;-[1..c],a&amp;lt;-[1..b],c^2==a^2+b^2,a+b+c==24]
Prelude&amp;gt; triangels 
[(6,8,10)]

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;46-如果别人问你haskell的cabal是什么&#34;&gt;46. 如果别人问你Haskell的cabal是什么？&lt;/h3&gt;
&lt;p&gt;类似于ubuntu的apt-get&lt;br&gt;
scilab  的atoms
python的 easy_install  或者pip
redhat 的yum&lt;/p&gt;
&lt;h3 id=&#34;47-如果别人问你有几个基本的typeclass&#34;&gt;47. 如果别人问你有几个基本的TypeClass?&lt;/h3&gt;
&lt;p&gt;类型类是haskell中站在较高位置的语言认识。几种基本的类型类包括Eq,Ord,Show,Read,Enum等。&lt;/p&gt;
&lt;h4 id=&#34;471-eq&#34;&gt;47.1 Eq&lt;/h4&gt;
&lt;p&gt;包含可判断相等性的类型。提供实现的函数是 == 和 /=。所以，
只要一个函数有Eq类的类型限制，那么它就必定在定义中用到了 == 和 /=&lt;/p&gt;
&lt;h4 id=&#34;472-ord&#34;&gt;47.2 Ord&lt;/h4&gt;
&lt;p&gt;包含可比较大小的类型。除了函数以外，我们目前所谈到的所有类型都属于 Ord 类。Ord 包中包含了
&amp;lt;, &amp;gt;, &amp;lt;=, &amp;gt;= 之类用于比较大小的函数。compare 函数取两个
Ord 类中的相同类型的值作参数，回传比较的结果。这个结果是如下三种类型之一：GT, LT, EQ。&lt;/p&gt;
&lt;h4 id=&#34;473-show&#34;&gt;47.3 Show&lt;/h4&gt;
&lt;p&gt;的成员为可用字串表示的类型。目前为止，除函数以外的所有类型都是 Show 的成员。
操作 Show Typeclass，最常用的函数表示 show。它可以取任一Show的成员类型并将其转为字串&lt;/p&gt;
&lt;h4 id=&#34;474-read&#34;&gt;47.4 Read&lt;/h4&gt;
&lt;p&gt;是与 Show 相反的 Typeclass。read 函数可以将一个字串转为 Read 的某成员类型。&lt;/p&gt;
&lt;h4 id=&#34;475-enum&#34;&gt;47.5 Enum&lt;/h4&gt;
&lt;p&gt;的成员都是连续的类型 &amp;ndash; 也就是可枚举。Enum 类存在的主要好处就在于我们可以在 Range 中用到它的成员类型：
每个值都有后继子 (successer) 和前置子 (predecesor)，分别可以通过 succ 函数和 pred 函数得到。
该 Typeclass 包含的类型有：(), Bool, Char, Ordering, Int, Integer, Float 和 Double。&lt;/p&gt;
&lt;h4 id=&#34;476-bounded&#34;&gt;47.6 Bounded&lt;/h4&gt;
&lt;p&gt;的成员都有一个上限和下限。&lt;/p&gt;
&lt;h4 id=&#34;477-num&#34;&gt;47.7 Num&lt;/h4&gt;
&lt;p&gt;Num 是表示数字的 Typeclass，它的成员类型都具有数字的特征。检查一个数字的类型：&lt;/p&gt;
&lt;h4 id=&#34;478-integral&#34;&gt;47.8 Integral&lt;/h4&gt;
&lt;p&gt;同样是表示数字的 Typeclass。Num 包含所有的数字：实数和整数。而 Integral 仅包含整数，其中的成员类型有 Int 和 Integer。&lt;/p&gt;
&lt;h4 id=&#34;479-floating&#34;&gt;47.9 Floating&lt;/h4&gt;
&lt;p&gt;仅包含浮点类型：Float 和 Double。
可以用一张图来表示：
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/classes.gif&#34; alt=&#34;类图&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;48-我想用haskell产生一个三角形&#34;&gt;48. 我想用Haskell产生一个三角形&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;let triangels=[(a,b,c)|c&amp;lt;-[1..10],b&amp;lt;-[1..10],a&amp;lt;-[1..10]]
let righttriangels=[(a,b,c)|c&amp;lt;-[1..10],b&amp;lt;-[1..c],a&amp;lt;-[1..b],a^2+b^2==c^2]
let righttriangelsc=[(a,b,c)|c&amp;lt;-[1..10],b&amp;lt;-[1..c],a&amp;lt;-[1..b],a^2+b^2==c^2,a+b+c==24]

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;49-如果别人问你如何表示数学的集合&#34;&gt;49. 如果别人问你如何表示数学的集合？&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Prelude&amp;gt; [x*2|x &amp;lt;- [1..10]]
[2,4,6,8,10,12,14,16,18,20]
Prelude&amp;gt; [x*2|x&amp;lt;- [1..10],x*2 &amp;gt;=12 ]
[12,14,16,18,20]
Prelude&amp;gt; [x | x &amp;lt;- [50..100], x `mod` 7 ==3]
[52,59,66,73,80,87,94]

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;50-如果别人问你-代表什么东西&#34;&gt;50. 如果别人问你!! 代表什么东西？&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;[3, 5,6] !!2
*Main&amp;gt; [3, 5,6] !!2
6
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;51-几个常用的数组提取函数&#34;&gt;51. 几个常用的数组提取函数？&lt;/h4&gt;
&lt;p&gt;并且是从0开始的
常用几个list函数&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;*Main&amp;gt; head [5,6,4]
5
*Main&amp;gt; last [5,6,4]
4
*Main&amp;gt; tail [5,6,4]
[6,4]
*Main&amp;gt; init [5,6,6,43,6]
[5,6,6,43]


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;length  null  reverse  take等函数  具体说一下take&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;*Main&amp;gt; take 4 [5,6,7,4,3,8]
[5,6,7,4]
*Main&amp;gt; take 3 [5,6,7,4,3,8]
[5,6,7]
*Main&amp;gt; take 2 [5,6,7,4,3,8]
[5,6]
*Main&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;同理类似的drop&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>语言抽象</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/14/yu-yan-chou-xiang/</link>
      <pubDate>Thu, 14 May 2015 10:21:48 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/14/yu-yan-chou-xiang/</guid>
      <description>&lt;p&gt;我们每天都在做的事情
1.打开电脑，找到我们要做的事情，保存我们做完的事情，提交,我们可能挨训，也可能加班
2.我们可能去打球，我们可能跟朋友、亲人聊天
3.我们可能在周末的时候，跟女朋友、家人去看电影，去郊游
4.我们可能去参加一些团体活动……&lt;/p&gt;
&lt;p&gt;我们把我们要在电脑、生活上做的事情可以抽象化，虽然我们不知不觉的做着这些事情，
但是这是第一步叫做事件抽象（过程抽象）。随着发展，我们可以进行逻辑抽象，并最终达到&lt;a href=&#34;http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-25.html#%25_chap_4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;语言抽象&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;我们会发现我们所使用的计算机语言包含着主要的东西是
1. 变量
2. 函数
3. 调用&lt;/p&gt;
&lt;p&gt;可以参看&lt;a href=&#34;http://developer.51cto.com/art/201208/352423_2.htm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;王垠的计算器&lt;/a&gt;,里面第三节中提到Lambda Calculus是什么
1. 变量: x
2. 函数: (lambda (x) e)
3. 调用: (e1 e2)&lt;/p&gt;
&lt;p&gt;这是任何一门语言不可缺少的逻辑语言抽象部件，就好像数学家很早就认识到序列求和中的&lt;a href=&#34;http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-12.html#%25_sec_1.3.1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;抽象模式&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;语言本身其实就是一个&lt;a href=&#34;http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-25.html#%25_chap_4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;求值器&lt;/a&gt;
&amp;gt; The evaluator, which determines the meaning of expressions in a programming language, is just another program.
所以事实上，可以几乎把任何程序看作是某个语言的求值器，它本身不过就是另一个程序而已。&lt;/p&gt;
&lt;p&gt;而为了更好地操作这些语言的元素，进行大型的系统模块化设计，我们还需要引进&lt;a href=&#34;http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-19.html#%25_chap_3&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;两种模式&lt;/a&gt;
1.对象实现(以不变的世界坐标系来说，其实对象是不断变化的，比如位置；此时坐标系是全局的)
2.流实现(以变化固体的角度来说，其实他是不变的；此时坐标系是局部的)&lt;/p&gt;
&lt;p&gt;关于scheme的部分以后再补上。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>尾递归</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/13/wei-di-gui/</link>
      <pubDate>Wed, 13 May 2015 20:56:12 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/13/wei-di-gui/</guid>
      <description>&lt;p&gt;尾递归的好处就是快速计算，尾递归实际上是在递归计算的过程中，
（印象中递归过程[表示语法形式-调用自己]和递归计算过程[表正线性方式 和非线性方式]是不一样的）, 加入了迭代的思想，不断的修改了product和counter的值，
不需要树形展开。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (fact n)
  (cond
    ((= n 1) 1)
    (else (* n (fact (- n 1))))))

(define (fact1 n)
  (define (fact-iter product counter)
    (cond
      ((= counter 1) product)
      (else (fact-iter (* product counter) (- counter 1)))))
  (fact-iter 1 n))
;;;Solve 4!
(fact 4)
(fact1 4)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;;;; 求幂&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (expr b n)
  (if (= n 0)
     1
     (* b (expt b (- n 1)))))

;;;iter form
(define (expr1 b n)
  (define (expr-iter b counter product)
    (if (= counter 0)
       product
       (expr-iter b (- counter 1) (* b product))))
  (expr-iter b  n 1))

(expr 4 5)
(expr1 4 5)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;===&amp;gt;另外还有一种更快速的方法
;; b^n =(b^(n/2))^2, n is even
;; b^n =(b*b^(n-1)) , n is odd&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (fast-iter b n)
 (cond 
  ((= n 0) 1)
  ((even? n) (square (fast)))
  (else (* b (fast-iter b (- n 1))))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;====&amp;gt;并最终得到尾递归的一般形式
结合&lt;a href=&#34;jueqingsizhe66.github.io/2015/05/13/qiu-ding-ji-fen/&#34;&gt;求定积分&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;===&amp;gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (sum term a  next b)
    (define (sum-iter a result)
     (if &amp;lt;???&amp;gt;
       &amp;lt;???&amp;gt; 
       (iter &amp;lt;???&amp;gt; &amp;lt;???&amp;gt;)))
    (sum-iter &amp;lt;???&amp;gt; &amp;lt;???&amp;gt;)
)
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>求定积分</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/13/qiu-ding-ji-fen/</link>
      <pubDate>Wed, 13 May 2015 19:27:40 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/13/qiu-ding-ji-fen/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/maths/dingjifen.jpg&#34; alt=&#34;定积分&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/maths/dingjifen3.jpg&#34; alt=&#34;定积分的数值计算&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/maths/dingjifen2.jpg&#34; alt=&#34;定积分的图形示意&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
 (define (cube  x) (* x  x x))
 ;;;累加
(define (sum-integer a b)
  (if (&amp;gt; a b)
     0
     (+ a (sum-integer (+ a 1) b))))

(sum-integer 1 10)
;;;立方累加
(define (sum-cube a b)
  (if (&amp;gt; a b)
     0
     (+ (cube a) (sum-cube (+ a 1)  b))))
(sum-cube 1 3)
;;; 求Pi 值 分数累加
(define (sum-pi a b)
  (if (&amp;gt; a b)
     0
     (+ (/ 1.0 (* a (+ a 2))) (sum-pi (+ a 4) b))))
(sum-pi 1 9)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;观察上面的积分过程
##最终提取出公共的形式 Sum&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;; (define (&amp;lt;name&amp;gt; a b)
;;  (if (&amp;gt; a b)
;;  0
;;  (+ (&amp;lt;term&amp;gt; a) (&amp;lt;name&amp;gt; (&amp;lt;next&amp;gt;a) b))))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;于是我们可以得到&#34;&gt;于是我们可以得到&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
(define (sum term a next b)
  (if (&amp;gt;  a b)
     0
     (+ (term a) (sum term (next a)  next b))))

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;and-apply-the-sum--to-get-the-sum-integer2-sum-cube2-sum-pi2&#34;&gt;And Apply the sum  to get the sum-integer2 sum-cube2 sum-pi2&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (sum-integer2 a b) (sum (lambda (x) x) ((lambda (x) (+ x 1)) a) (lambda (x) (+ x 1)) b)) ;;;--&amp;gt;There is some problems

;&amp;gt; (sum-integer2 1 10)
;54  ------------------------&amp;gt;Why
;&amp;gt; (sum-integer 1 10)
;55

(define (identity x) x)
(define (inc x) (+ x 1))
(define (sum-integer3 a b) (sum identity a inc b))
(sum-integer3 1 3)
(define (sum-cube2 a b) (sum cube a inc b))
(sum-cube2 1 3)
(define (sum-pi2 a b) 
  (define (pi-term x)
    (/ 1.0 (* x (+ x 2))))
  (define (pi-next x)
    (+ x 4))
  (sum pi-term a pi-next b))
(sum-pi2 1 9)
(* 8 (sum-pi2 1 1000))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也就是我们现在可以计算积分了！
我们的问题是求解下面的定积分：
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/maths/integral.png&#34; alt=&#34;定积分&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;;;;; So now we can do the integrate computing

;;Because integrate will have the same function but different next function
;;;a-b 之间关于f函数的定积分的求法
(define (integral f a b dx)
  (define (add-dx x) (+ x dx))
  (define (update-a a dx) (+ a (/ dx 2.0)))
  (* (sum f (update-a a dx) add-dx b) dx))
(integral cube 0 1 0.01)
(integral cube 0 1 0.001)
(integral cube 0 1 0.0001)
(/ 1 4.0)
(/ (* 1 (cube 1)) 4.0)


;result:
;0.24998750000000042
;0.249999875000001
;0.24999999874993412
;0.25
;0.25

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为了更精确的求解积分，我们使用更为精妙的辛普森积分
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/maths/xinpusen1.jpg&#34; alt=&#34;辛普森的抛物线积分方法&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/maths/xinpusen2.jpg&#34; alt=&#34;辛普森的数学公式&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/maths/xinpusen3.jpg&#34; alt=&#34;最终简化&#34;&gt;
###包含奇数的两倍 和偶数的四倍，两边不加倍&lt;/p&gt;
&lt;ol start=&#34;0&#34;&gt;
&lt;li&gt;h = (b-a)/n&lt;/li&gt;
&lt;li&gt;yk= f(a+kh) &amp;mdash;&amp;gt; next&lt;/li&gt;
&lt;li&gt;(even? k)  (odd? k)&lt;/li&gt;
&lt;li&gt;y0 =a  yn= b&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;a. 设计的过程遇到的问题是 参数的问题 需要设置k？
b. 中间过程的问题，如何划分三种情况
b.1  k为0和n的情况
b.2  k为奇数的情况
b.3  k为偶数的情况&lt;/p&gt;
&lt;p&gt;最终, 利用Fact的思想 进行求积分&lt;/p&gt;
&lt;p&gt;;;; 下面是一个较为混乱的设计，且没有考虑使用sum&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (simpson-integral f a b n)
(let ((h (/ (- b a) n))
      (k 0))
(define inc (+ a (* k h)))
(define inc2 (* 2 f(inc)))
(define inc4 (* 4 f(inc)))
  (cond
    ((= k 0) (f a))
    ((= k n) (f b))
    ((even? k) (+ (* 2 f((+ a (* k h))))  
)))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;补充，好思想:保证最后一个为偶数&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (round-to-next-even x)
 (+ x (remainder x 2))
)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;于是有了下面较好的版本，思考，之前的Sum其实是已经提供了inc递增的a
以及范围，我们主要的目的就是写好term即可！而
term其实就是涉及到你需要思考的三种情况
之前你之所以回想不清楚，因为你没有斩断念头，term只接受一个参数，
这个参数其实就是你一直想的k，所以simpson-term的一个参数就是k，利用它
开始做文章即可&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (simpson-integral f a b n)
    (define (round-to-next-even x)  (+ x (remainder x 2)))
    (define fixed-n (round-to-next-even n))
    (define h (/ (- b a) fixed-n))
    (define (simpson-term k) 
      (define y (f (+ a (* k h))))
      (cond 
          ((or (= k 0) (= k fixed-n))
            (* 1 y))
          ((even? k) (* 2 y))
          (else (* 4 y))))
    (* (/ h 3) (sum simpson-term 0 inc fixed-n))
 ))

;(simpson-integral cube 0 1 10)
;1/4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外还有几种变体，只不过总体思路都在上面类似。&lt;/p&gt;
&lt;p&gt;a1:breaking the problem into four parts: (f y0), (f yn) and two sums,one over even k and another over odd k&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (another-simpson-integral f a b n) 
   (define h (/ (- b a) n))  
   (define (add-2h x) (+ x (* 2 h))) 
   (* (/ h 3.0) (+ (f a)  
                   (* 4.0 (sum f (+ a h) add-2h (- b h)))  
                   (* 2.0 (sum f (add-2h a) add-2h (- b h)))  
                   (f (+ a (* h n)))))) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;a2:Here&amp;rsquo;s a version that sums over pairs of terms (2 y_k + 4 y_k+1). No conditionals or special cases are needed anywhere, but there&amp;rsquo;s an extra term [f(b) - f(a)] to be added to the final count.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; (define (simpson f a b n) 
   (define h (/ (- b a) n)) 
    
   (define (y k) 
     (f (+ a (* k h)))) 
    
   (define (ypair k) 
     (+ (* 2 (y k)) 
        (* 4 (y (+ k 1))))) 
    
   (define (add-2 k) 
     (+ k 2)) 
    
   (* (/ h 3) (+ (sum ypair 0 add-2 (- n 1)) 
                 (- (f b) (f a))))) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然也可以写成下面的格式：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt; (define (sim-integral f a b n) 
     (define h (/ (- a b) n)) 
     (define (y k) (f (+ a (* k h)))) 
     (define (coeff k) (if (is-even? k) 2 4)) 
     (define (part-term k) (* (coeff k) (y k))) 
     (define part-value (sum part-term 1 inc (- n 1))) 
     (* (/ h 3) (+ (y 0) (y n) part-value))) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;##下面是我重新写的一遍，包含一些计算问题的修正&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;加入了n的修正&lt;/li&gt;
&lt;li&gt;重新认识了simpson算法的，当然还有些问题没有理解，比如f(b)-f(a),
在simpson-anthother-integrate中&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;新的源码如下:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;
;;; (let &amp;lt;var&amp;gt; &amp;lt;bindings&amp;gt; &amp;lt;body&amp;gt;)

(define (cube x) (* x  x  x))
(define (sum-integer a b)
  (if (&amp;gt; a b)
     0
     (+ a (sum-integer (+ a 1) b))))
(sum-integer 1 10)

(define (sum-cube a b)
  (if (&amp;gt; a b)
     0
     (+ (cube a) (sum-cube (+ a 1) b))))
(sum-cube  1 3)

(define (sum-pi a b)
  (if (&amp;gt; a b)
     0 
     (+ (/ 1.0 (* a (+ a 2))) (sum-pi (+ a 4) b))))
(sum-pi 1 10)
(sum-pi 1 100)

(define (sum term a next b)
  (if (&amp;gt; a b)
     0
     (+ (term a) (sum term  (next a) next b))))

(define (sum-integer2 a b)
  (define (identity x) x)
  (define (inc x) (+ x 1))
  (sum identity a inc b))
(sum-integer2 1 10)

(define (sum-cube2  a b)
  (define (cube x) (* x x x))
  (define (inc x) (+ x 1))
  (sum cube a inc b))
(sum-cube2 1 3)

(define (sum-pi2 a b)
  (define (pi-term x) (/ 1.0 (* x (+ x 2))))
  (define (pi-next x) (+ x 4))
  (sum pi-term a pi-next b))
(sum-pi2 1 10)

(define (integral f a b dx)
  (define const_a (+ a (/ dx 2.0)))
  (define (add_dx x) (+ x dx))
  (* (sum f const_a add_dx b) dx))

(integral cube 0 1 0.001)

(define (simpson-integral f a b n)
  (define (round-to-next-even x) (+ x (remainder x 2)))
  (define fixed-n (round-to-next-even n))
  (define (inc x) (+ x 1))
  (define h (/ (- b a) fixed-n))
  (define (simpson-term k)
    (define y (f (+ a (* h k))))
    (cond 
      ((or (= k 0) (= k fixed-n))
       (*  1  y))
      ((even? k)
       (* 2  y))
      (else (* 4 y))))
 ; (* (/ h 3) (sum simpson-term 0 inc b))) ;;; 0的意思表示从k=0开始,不能写成b，如果写成b表示你没有理解，因为0 fixed-n都代表的是K
  ;;这是次数的说法，而不是代表着a-b之间的求值范围，而是指求职的次数！
 (* (/ h 3) (sum simpson-term 0 inc fixed-n)))
(simpson-integral cube 0 1 10)
(simpson-integral cube 0 1 11)


;;一种变体 思路同上
;; 比较有趣的地方是分为四个节点出
;; 1  f(a)  ----》 y0
;; 2  f(a+h) 奇数的开始地方   add-2h方式累加都是奇数 同时终点是b-h  为什么？因为b在下面被暂用--》把它看待是一个奇数累加的过程 y1 y3 y5
;; 3  f(a+2h) 偶数的开始地方 add-2h方式累加都是偶数 同时终点是b-h--》把它看待是一个偶数累加的过程 y2 y4 y6..
;; 4  f(b)    最后一部分  yn
(define (simpson-another-integral f  a b n)
  (define h (/ (- b a) n))
  (define (add-2h x) (+  x (* 2.0 h)))  ;;; 
  (* (/ h 3.0) (+ (f a)
                          (* 4.0 (sum f (+ a h) add-2h (- b h)))  ;;; (+a h)表示起始点  (- b h) 表示的是终点
                          (* 2.0 (sum f (add-2h a) add-2h (- b h))) ;; 注意这边的(add2h a)表示的是起始点
                          (f (+ a (* h n))))))  ;; 也可以是(f b) 

;&amp;gt; (simpson-another-integral cube 0 1 11)
;0.1782892789654623
;&amp;gt; (simpson-another-integral cube 0 1 12)
;0.2499999999999999&#39;

(define (simpson-another-integral-improve f  a b n)
  (define (round-to-next-even x) (+ x (remainder x 2)))
  (define fixed-n  (round-to-next-even n))
  (define h (/ (- b a) fixed-n))
  (define (add-2h x) (+  x (* 2.0 h)))  ;;; 
  (* (/ h 3.0) (+ (f a)
                          (* 4.0 (sum f (+ a h) add-2h (- b h)))  ;;; (+a h)表示起始点  (- b h) 表示的是终点
                          (* 2.0 (sum f (add-2h a) add-2h (- b h))) ;; 注意这边的(add2h a)表示的是起始点
                          (f (+ a (* h fixed-n)))))) ;;; (f b)的效果是一样  但是不正确！ 现在
  
  (simpson-another-integral cube 0 1 11)
   (simpson-another-integral cube 0 1 12)
    (simpson-another-integral cube 0 1 111);;; 如果是奇数的话，现在解决的办法就是多增加一些计算！
   ;;;;;过程没错！！！ 不知道哪边多加了！
   
    
 (define (simpson-pair-integral f a b n)
   (define (round-to-next-even x) (+ x (remainder x 2)))
   (define fixed-n  (round-to-next-even n))
   (define h (/ (- b a) fixed-n))
   (define (y k) ( f  (+ a (* k h))))
   (define (ypair k)
     (+ (* 2 (y k))
          (* 4 (y (+ k 1)))))
   (define (add-2 k)
     (+ k 2))
   (* (/ h 3) (+ (sum ypair 0 add-2 (- fixed-n 1))  
                (- (f b) (f a)))))  ;;; 为什么是减号  你可以看到这边的思想是抽出中间的偶数对的数据（奇数加上偶数 理当是加起来的)
                                          ;;;因为最后一个  为什么要计算 [f(b) - f(a)] 
 (simpson-pair-integral cube 1 3 1)
 (simpson-pair-integral cube 1 3 2)
 
 ;;;sim-integral 提高版  加入了 round-to-next-even使得计算准确，先前的sim-integral有问题
 (define (sim-integral f a b n)
   (define (round-to-next-even x) (+ x (remainder x 2))) ;;;得加上这个 才可以算准！！
   (define fixed-n  (round-to-next-even n))
   (define h (/ (- b a) fixed-n))
   (define (y k) (f (+ a (* k h))))
   (define (coeff k) (if (even? k) 2 4))
   (define (part-term k) (* (coeff k) (y k)))
   (define (inc x) (+ x 1))
   (define part-value (sum part-term 1 inc (- fixed-n 1)))
   (* (/ h 3) (+ (y 0) (y n) part-value)))
 (sim-integral cube 1 3 10)  ;;; 有问题 已解决
 (sim-integral cube 1 3 11) ;;; 有问题  已解决
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>找出函数的不动点--Navier-Stokes方程</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/12/zhao-chu-han-shu-de-bu-dong-dian-navier-stokesfang-cheng/</link>
      <pubDate>Tue, 12 May 2015 03:13:50 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/12/zhao-chu-han-shu-de-bu-dong-dian-navier-stokesfang-cheng/</guid>
      <description>&lt;p&gt;##Beautiful code!&lt;/p&gt;
&lt;p&gt;数x为函数的f的不动点（f可以代表N-S方程），如果满足f(x)=x,则称x
为函数f的不动点。
性质 f(x),f(f(x)),f(f(f(x)))&amp;hellip;., change the x&amp;rsquo;s value if f(x)=x,then
you found!&lt;/p&gt;
&lt;h2 id=&#34;source-code&#34;&gt;Source code&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define tolerance 0.000001)
(define (fixed-point f first-guess)
  (define (close-enough? v1 v2)
    (&amp;lt; (abs (-  v1 v2)) tolerance))
  (define (try guess)
    (let ((next (f guess)))
      (if (close-enough? guess next)
         next
         (try next))))
  (try first-guess))

;;;solve cos(x)=x
(fixed-point cos 1.0)


;;(cos 0.7390855263619245)
;;0.7390848683867142
;;(abs (-  (cos 0.7390855263619245) 0.7390855263619245))
;;6.579752103164083e-07


;;;solve y=siny+cosy   x=f(x) ====&amp;gt; Navier Stokes equation
(fixed-point (lambda (y) (+ (sin y) (cos y))) 1.0)

;;It is what we want!!!
;;;(abs (- ((lambda (y) (+ (sin y) (cos y))) 1.2587277968014188) 1.2587277968014188)) 
;;6.26112570678572e-07


;;;;One method to calculate the square value
;;because x^2 = y  so x = y/x (x =f (x) next we  will use the fixed-point thinking) we should continue change the x&#39;s value!
(define (sqrt-iter guess x)
  (if (good-enough? guess x)
     guess
     (sqrt-iter (improve guess x)
               x)))

(define (square x)
  (* x x))
;;;good-enough? is similar to close-enough？
(define (good-enough? x y)
  (&amp;lt; (abs (- (square x) y)) 0.00001))

;;x^2=y   x=y/x   x+x=y/x+x  x=(y/x+x)/2
(define (improve guess x)
  (average guess (/ x guess)))

(define (mysqrt x)
  (sqrt-iter 1.0 x))


;;(mysqrt 4)
;;2.0000000929222947

;;;Use fixed-point thinking 

(define (mysqrt_death_fixed x)
  (fixed-point (lambda (y) (/ x y))
              1.0))

;;(mysqrt_death_fixed 4)
;;;wrong !!!  can not convenge!!!! why?

;;because   y2= x/y1  y3=x/y2=x/(x/y1)=y1 ====&amp;gt;death recycle===&amp;gt; so we use average

(define (mysqrt_fixed x)
  (fixed-point (lambda (y) (average y (/  x y)))
              1.0))

(mysqrt_fixed 4)

;;;ok fine
;;2.000000000000002====&amp;gt;这也叫做平均阻尼定义！常用于数值计算当中
;;在不动点的搜寻中，作为帮助收敛的手段！！！！
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>折半查找有条件</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/12/zhe-ban-chao-zhao-you-tiao-jian/</link>
      <pubDate>Tue, 12 May 2015 02:46:03 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/12/zhe-ban-chao-zhao-you-tiao-jian/</guid>
      <description>&lt;p&gt;You want to solve F(x)=0,
if f(a)&amp;lt;0&amp;lt;f(b), so the value must be inside the [a,b].&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;#lang racket
(define (close-enough? x  y)
  (&amp;lt; (abs (-  x y)) 0.00001))

(define (average a b)
  (/ (+  a b) 2.0))
(define (search f neg-point pos-point)
   (let ((midpoint (average neg-point pos-point)))
     (if (close-enough? neg-point pos-point)
        midpoint
        (let ((test-value (f midpoint)))
          (cond ((positive? test-value)
                 (search f neg-point midpoint))
               ((negative? test-value) 
                (search f midpoint pos-point))
               (else midpoint))))))

;;必须判断一下，如果同号则无法使用折半查找
(define (half-interval-method f a b)
  (let ((a-value (f a))
          (b-value (f b)))
     (cond ((and (negative? a-value) (positive? b-value))
            (search f a b))
          ((and (negative? b-value) (positive? a-value))
           (search f  a b))
          (else
           (error &amp;quot;values are not of opposite sign&amp;quot; a b)))))

(half-interval-method (lambda (x) (- (* x x x) (* 2 x) 3))
                       1.0
                       2.0)
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>So beautiful code</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/12/so-beautiful-code/</link>
      <pubDate>Tue, 12 May 2015 02:29:11 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/12/so-beautiful-code/</guid>
      <description>&lt;p&gt;So beautiful&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (f x y)
(define (f-helper a b)
  (+ (* (square a))
      (* y b)
      (* a b)))
  (f-helper (+ 1 (* x y))
            (- 1 y)))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;====&amp;gt; f(x,y)=x(1+xy)^2 + y(1-y)+(1+xy)(1-y)
==&amp;gt;  a= 1+xy
b= (1-y)
f(x,y)=xa^2+yb+ab&lt;/p&gt;
&lt;p&gt;====&amp;gt;Continue&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (f x y)
  ((lambda (a b)
       (+ (* x (square a))
          (* y b)
          (* a b)))
    (+ 1 (* x y))
    (- 1 y)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;====&amp;gt;Use let to define the local variables&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (f x y)
  (let ((a (+ 1 (* x y)))
         (b (- 1 y)))
       (+ (* x (square a))
          (* y b)
          (* a b))))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;let is just the coat of the ((lambda (a b))&lt;/p&gt;
&lt;p&gt;Of course we can use define&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-scheme&#34;&gt;(define (f x y)
   (define a (+ 1 (* x y)))
   (define b (- 1 y))
 (+ (* x (square a))
    (* y b)
    (* a b)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;SICP_P42&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>压缩文件IO流的使用和简单封装（0213）</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/</link>
      <pubDate>Mon, 11 May 2015 14:58:47 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/</guid>
      <description>&lt;p&gt;分为三个部分：
第一部分 ，先是试用了zipinputstream的用法
第二部分， 是进一步试用了压缩流zipoutputStream和加密的方法
第三部分 ， 则是对上述过程封装为一个OOZip类&lt;/p&gt;
&lt;p&gt;功能简述：  分为普通的压缩和加密的压缩，对应的解压缩 。普通的压缩：文件和文件夹都可以。 加密的压缩：文件和文件夹都可以，当加密的时候，则生成的zip文件里面的文件打开时乱码，必须用对应的unzipCrypto方法进行解压才有效。当然不会像winzip会提醒你输入密码，可以让你打开，只不过打开的是乱码。&lt;/p&gt;
&lt;p&gt;1： 先从com.rupeng.gtk4j挖出了zipInputStream的用法，用于解压缩，测试只能针对zip文件。
于是就有了初始版本的解压缩流：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.Closeable;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.io.StringWriter;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;

/**
* @author    叶昭良
* @time      2015年2月12日下午1:19:18
* @version   TestZipInputStream V1.0
*/
public class TestZipInputStream
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                //unZipShared(&amp;quot;e:\\test\\test.zip&amp;quot;);
                //unZipShared(&amp;quot;e:\\test\\test1.zip&amp;quot;);
                //rar暂时无法解压出来，但是zip文件是可以的
                unZipShared(&amp;quot;e:\\test\\test1.zip&amp;quot;,&amp;quot;e:\\testOutput&amp;quot;);
        }
        
        /**
         *   解压缩 zip文件，只能限制为rar
         * @param zipName        待解压的zip文件
         * @param outputfolder   解压zip文件到outputFoler文件夹下
         */
        public static void unZipShared(String zipName,String outputfolder)
        {
                File gtkDir = new File(outputfolder);// *.dll放的文件夹
                if (!gtkDir.exists())
                {
                        gtkDir.mkdirs();
                }
                InputStream inStream = null;
                try
                {
                        inStream = new  FileInputStream(zipName);
                } catch (FileNotFoundException e1)
                {
                        // TODO Auto-generated catch block
                        e1.printStackTrace();
                }
                //InputStream inStream = Utils.class.getResourceAsStream(&amp;quot;/gtkshare.zip&amp;quot;);
                if (inStream == null)
                {
                        throw new UnsatisfiedLinkError(&amp;quot;没找到&amp;quot;+zipName);
                }
                try
                {                        
                        unZip(inStream, gtkDir.toString());
                        System.out.println(gtkDir.toString());
                } catch (IOException e)
                {
                        System.err.println(&amp;quot;解压缩gtkshare.zip失败&amp;quot; + toFullString(e));
                }
        }

        /**
         * 把streamToZip这个zip文件流解压到硬盘的destDir文件夹，支持多级目录
         * @param streamToZip
         * @param destDir
         * @throws IOException
         */
        public static void unZip(InputStream streamToZip,String destDir)throws IOException
        {  
                ZipInputStream zipStream = new ZipInputStream(streamToZip);
                try
                {
                        ZipEntry zipEntry = null;
                        //通过zipEntry方式支持多级目录
                        while((zipEntry=zipStream.getNextEntry())!=null)
                        {
        if(zipEntry.isDirectory())
        {
                File dir = new File(destDir,zipEntry.getName());
                if(!dir.exists())
                {
                        dir.mkdirs();
                }
        }
        else
        {
                FileOutputStream fileOutStream = new FileOutputStream(new File(destDir,zipEntry.getName()));
                try
                {
                        copy(zipStream, fileOutStream);
                }
                finally
                {
                        close(fileOutStream);
                }
        }
}
                }
                finally
                {
                        close(zipStream);
                }
                
    }
        /**
         *     从zip文件包中拷贝文件
         * @param inStream       zipEntry的某个文件
         * @param outStream      输出的某个文件流
         * @throws IOException
         */
        static void copy(InputStream inStream, OutputStream outStream)
                        throws IOException
        {
                byte[] buffer = new byte[512 * 1024];// 0.5MB 的缓冲区
                int len;
                while ((len = inStream.read(buffer)) &amp;gt;= 0)
                {
                        outStream.write(buffer, 0, len);
                }
        }
        /**
         *    摘自rupeng.gtk4j   不明白具体的作用    非主要问题
         * @param throwable
         * @return
         */
        static String toFullString(Throwable throwable)
        {
                StringWriter sw = null;
                PrintWriter pw = null;
                try
                {
                        sw = new StringWriter();
                        pw = new PrintWriter(sw);
                        throwable.printStackTrace(pw);
                        return sw.toString();
                } finally
                {
                        close(sw);
                        close(pw);
                }
        }
        /**
         *     让文件流安静的关闭
         * @param closeable   关闭接口
         */
        static void close(Closeable closeable)
        {
                if (closeable != null)
                {
                        try
                        {
                                closeable.close();
                        } catch (IOException e)
                        {

                        }
                }
        }


}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2：后来想着有解压缩，必然也是有着压缩，于是就摆了一下，参考了一篇百度知道文章
2.1 首先加入了zip的方法
2.2 改进了zip方法的文件压缩流的写入过程，利用buffersize
2.3 常使用了文章中的加密过程，添加了加密压缩和加密解压缩的过程
2.4 想着实用命令流来进一步实现 压缩和解压缩的调用，后来弃用，改用封装一个OOZip类来实现&lt;/p&gt;
&lt;p&gt;于是就有了下面的升级版的压缩和解压缩的程序：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.Closeable;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.io.StringWriter;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.util.Random;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;
import java.util.zip.ZipOutputStream;

import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.interfaces.PBEKey;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.PBEParameterSpec;
import javax.crypto.spec.SecretKeySpec;


/**
* @author    叶昭良
* @time      2015年2月12日下午5:22:31
* @version   TestZipInputStreamUpdate V1.0  增加了压缩 
*                              V2.0   ZipShared加入了 zosTemp.close(); 修复了 压缩的bug，删掉则无法压缩
*                              V3.0   升级了ZipShared 使用了copy函数。
*                              V4.0   增加了加密压缩 和解加密压缩
*/
public class TestZipInputStreamUpdate
{

        
        /**
         * @param args
         */
        private static final String ALGORITHM = &amp;quot;PBEWithMD5AndDES&amp;quot;;
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                TestZipInputStreamUpdate tisu = new TestZipInputStreamUpdate();
                //不需要再次加入zip文件后缀了
                //tisu.ZipShared(&amp;quot;e://test1222bak&amp;quot;,&amp;quot;e://test1222&amp;quot;);
                
                tisu.ZipSharedCrypto(&amp;quot;e://test1222bak&amp;quot;, &amp;quot;e://test1222passwdByZhao.zip&amp;quot;, &amp;quot;123456&amp;quot;);
                tisu.unzipCrypto(&amp;quot;e://test1222passwdByZhao.zip&amp;quot;,&amp;quot;c://laoliang&amp;quot;,&amp;quot;123456&amp;quot;);
        //        tisu.unzipCrypto(&amp;quot;e://test1222passwdByZhao.zip&amp;quot;,&amp;quot;c://laoliang&amp;quot;,&amp;quot;1234565&amp;quot;);
                
                /*
                 *  你正在进入e:\test1222bak文件夹
                        你正在进入e:\test1222bak\test1222文件夹
                        你正在压缩a1.zip
                        你正在压缩test123.txt
                        你正在压缩test124.txt
                        
                        通过这个实验总结了：所有操作系统内部的文件都是文件，无论是普通的文件
                        还是文件夹文件，还是管道文件，还是索引文件，还是设备文件，本质上都是
                        文件，只不过是在文件的头上面增加了一些特殊的标记，比如说你需要在文件夹
                        的路径增加一个\路径标志 反斜杠的道理是一样的。
                 */
                
                /*  这是一个命令流的使用方式：：
                 *         if(args.length==2){ 
            String name = args[1]; 
            Zip zip = new Zip(); 

            if(args[0].equals(&amp;quot;-zip&amp;quot;)) 
            {
                    zipname = args[2];
                    zip.doZip(name); 
            }
                
            else if(args[0].equals(&amp;quot;-unzip&amp;quot;)) 
            {
                    outputfolder = args[2];
                     zip.unZip(name);          
            }     
        } 
        else{ 
            System.out.println(&amp;quot;Usage:&amp;quot;); 
            System.out.println(&amp;quot;压缩:java Zip -zip directoryName  zipname&amp;quot;); 
            System.out.println(&amp;quot;解压:java Zip -unzip fileName.zip outputfolder&amp;quot;); 
            throw new Exception(&amp;quot;Arguments error!&amp;quot;); 
        } 
                 */
        }
        public void ZipShared(String fileinput,String zos)
        {
                try
                {
                        //加入&amp;quot;zip&amp;quot;后缀！
                        ZipOutputStream zosTemp = new ZipOutputStream(new FileOutputStream(zos+&amp;quot;zip&amp;quot;));
                        File fApple = new File(fileinput);
                        ZipShared(fApple,zosTemp,&amp;quot;&amp;quot;);
                        try
                        {
                                /// 为什么加入这个就可以？？？？
                                //  不加入这有异常？？？？why   Tell me 
                                zosTemp.close();
                        } catch (IOException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                } catch (FileNotFoundException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                
        }
        public  void ZipShared(File fileinput,ZipOutputStream zos,String base)
        {
                //ZipOutputStream zos = new ZipOutputStream(new FileOutputStream(outputZipName));
                
                //File fileinput = new File(outputZipName);
if(fileinput.isDirectory())
{
        System.out.println(&amp;quot;你正在进入&amp;quot;+fileinput+&amp;quot;文件夹&amp;quot;);
        File[] fBanana = fileinput.listFiles();
        try
        {
                //传进一个文件夹标志
                zos.putNextEntry(new ZipEntry(base+&amp;quot;/&amp;quot;));
                //让base加上一个/
                base = base.length()==0?&amp;quot;&amp;quot;:base+&amp;quot;/&amp;quot;;
                for(int i = 0; i &amp;lt; fBanana.length; i++)
                {
                        ZipShared(fBanana[i],zos,base+fBanana[i].getName());
                }
        } catch (IOException e)
        {
                // TODO Auto-generated catch block
                System.out.println(&amp;quot;压缩文件夹失败&amp;quot;+e.getMessage());
        }
        
}else
{
        try
        {
                zos.putNextEntry(new ZipEntry(base));
                FileInputStream fis = new FileInputStream(fileinput);
                //改进写入的方式
                /*int b;
                while((b = fis.read())!= -1)
                {
                        zos.write(b); 
                        //效率很定不高  每一个字符  进行一次缓冲
                        //zos.flush();
                }*/
                copy(fis,zos); //利用汝鹏版的copy函数
                System.out.println(&amp;quot;你正在压缩&amp;quot;+fileinput.getName());
                //fis.close();
                
                //zos.close();
        } catch (IOException e)
        {
                // TODO Auto-generated catch block
                System.out.println(&amp;quot;压缩文件失败&amp;quot;+e.getMessage());
        } 
        //为什么加入则错误
        /*finally
        {
                try
                {
                        zos.close();
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;打开流错误！&amp;quot;);
                }
        }*/
                }
        }
        public  void ZipSharedCrypto(String fileinput,String zosFile,String pwd)
        {
                
                try
                {        File f1 = new File(fileinput);
                //采用和ZipShared一样的FileOutputStream
                        ZipOutputStream zos  = null;
                        zos = new ZipOutputStream(new FileOutputStream(zosFile));
                        ZipSharedCrypto(f1,zos,&amp;quot;&amp;quot;, pwd);
                        try
                        {
                                zos.close();
                        } catch (IOException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                } catch (FileNotFoundException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                System.out.println(&amp;quot;成了&amp;quot;);
        }
        public  void ZipSharedCrypto(File fileinput,ZipOutputStream zos,String base,String pwd)
        {
if(fileinput.isDirectory())
{
        System.out.println(&amp;quot;你正在进入&amp;quot;+fileinput+&amp;quot;文件夹&amp;quot;);
File[] fApples = fileinput.listFiles();
//因为ZipEntry的isDirectory()方法中，目录以&amp;quot;/&amp;quot;结尾
try
{        
        zos.putNextEntry(new ZipEntry(base+&amp;quot;/&amp;quot;));
        base = base.length()==0?&amp;quot;&amp;quot;:(base+&amp;quot;/&amp;quot;);
        //一种比较新型的方式循环读写东西。
        for(File ftemp:fApples)
        {
                ZipSharedCrypto(ftemp,zos,base+ftemp.getName(),pwd);
        }
}catch(IOException e)
{
        System.out.println(&amp;quot;文件夹加密压缩失败&amp;quot;);
        }
}else
{        
        
        try
        {
                zos.putNextEntry(new ZipEntry(base));
                FileInputStream fis = new FileInputStream(fileinput);
                System.out.println(&amp;quot;你正在开始加密压缩&amp;quot;+fileinput+&amp;quot;文件&amp;quot;);
        PBEKeySpec keySpec = new PBEKeySpec(pwd.toCharArray());
        SecretKeyFactory keyFactory = null;
        try
        {
                keyFactory = SecretKeyFactory.getInstance(ALGORITHM);
        } catch (NoSuchAlgorithmException e)
        {
                // TODO Auto-generated catch block
                e.printStackTrace();
        }
        SecretKey passwordKey = keyFactory.generateSecret(keySpec);
        //生成一个炸弹 进行加密
        byte[] bomb =  new byte[8];
        Random rnd = new Random();
        rnd.nextBytes(bomb);
        int iterations = 100;
        PBEParameterSpec parameterSpec = new PBEParameterSpec(bomb, iterations);
        Cipher cipher = null;
        try
        {
                cipher = Cipher.getInstance(ALGORITHM);
        } catch (NoSuchAlgorithmException
                        | NoSuchPaddingException e)
        {
                // TODO Auto-generated catch block
                e.printStackTrace();
        }
        cipher.init(Cipher.ENCRYPT_MODE, passwordKey,parameterSpec);
        //往输出流 添加炸弹
        zos.write(bomb);
        
        //添加加密的主文件内容  1KB缓存区
        byte[] inputBuffer = new byte[1024];
        int bytesRead = 0;
        //如果没有读到信息则为-1
        while((bytesRead = fis.read(inputBuffer))!= -1)
        {
                //每个缓冲区 进行加密写入
                byte[] output = cipher.update(inputBuffer);
                if(output != null)
                {
                        zos.write(output);
                }
        }
        
        //加密结束语
        byte[] outputFinal =null;
        try
        {
                outputFinal = cipher.doFinal();
        } catch (IllegalBlockSizeException | BadPaddingException e)
        {
                // TODO Auto-generated catch block
                e.printStackTrace();
        }
        if(outputFinal != null)
        {
                zos.write(outputFinal);
        }
        
/*        fis.close();
        zos.flush();
        zos.close();*/
        
        
}catch(InvalidKeySpecException | InvalidKeyException | InvalidAlgorithmParameterException | IOException e)
{
        System.out.println(&amp;quot;加密失败&amp;quot;);
        }
}
        }
        /**
         *   解压缩 zip文件，只能限制为rar
         * @param zipName        待解压的zip文件
         * @param outputfolder   解压zip文件到outputFoler文件夹下
         */
        public static void unZipShared(String zipName,String outputfolder)
        {
                File gtkDir = new File(outputfolder);// *.dll放的文件夹
                //指定的目录不存在  则创建之
                if (!gtkDir.exists())
                {
                        gtkDir.mkdirs();
                }
                InputStream inStream = null;
                try
                {
                        inStream = new  FileInputStream(zipName);
                } catch (FileNotFoundException e1)
                {
                        // TODO Auto-generated catch block
                        e1.printStackTrace();
                }
                //InputStream inStream = Utils.class.getResourceAsStream(&amp;quot;/gtkshare.zip&amp;quot;);
                if (inStream == null)
                {
                        throw new UnsatisfiedLinkError(&amp;quot;没找到&amp;quot;+zipName);
                }
                try
                {                        
                        unZip(inStream, gtkDir.toString());
                        System.out.println(gtkDir.toString());
                } catch (IOException e)
                {
                        System.err.println(&amp;quot;解压缩gtkshare.zip失败&amp;quot; + toFullString(e));
                }
        }

        /**
         * 把streamToZip这个zip文件流解压到硬盘的destDir文件夹，支持多级目录
         * @param streamToZip
         * @param destDir
         * @throws IOException
         */
        public static void unZip(InputStream streamToZip,String destDir)throws IOException
        {  
                ZipInputStream zipStream = new ZipInputStream(streamToZip);
                try
                {
                        ZipEntry zipEntry = null;
                        //通过zipEntry方式支持多级目录
        while((zipEntry=zipStream.getNextEntry())!=null)
        {
                if(zipEntry.isDirectory())
                {
                        System.out.println(&amp;quot;你正在创建文件夹文件 比较特殊&amp;quot;);
                        File dir = new File(destDir,zipEntry.getName());
                        //如果指定的目录不存在 则创建之
                        if(!dir.exists())
                        {
                                dir.mkdirs();
                        }
                }
                else
                {
                        FileOutputStream fileOutStream = new FileOutputStream(new File(destDir,zipEntry.getName()));
                        try
                        {
                                copy(zipStream, fileOutStream);
                        }
                        finally
                        {
                                close(fileOutStream);
                        }
                        System.out.println(&amp;quot;你正在解压缩压缩&amp;quot;+zipEntry.getName());
                }
        }
}
finally
{
        close(zipStream);
}
                
    }
        /**
         *     从zip文件包中拷贝文件 ，按照0.5MB的缓冲写入文件(默认方式）
         * @param inStream       zipEntry的某个文件
         * @param outStream      输出的某个文件流
         * @throws IOException
         */
        static void copy(InputStream inStream, OutputStream outStream)
                        throws IOException
        {
                byte[] buffer = new byte[512 * 1024];// 0.5MB 的缓冲区
                int len;
                while ((len = inStream.read(buffer)) &amp;gt;= 0)
                {
                        outStream.write(buffer, 0, len);
                }
        }
        /**
         *    摘自rupeng.gtk4j   不明白具体的作用    非主要问题
         * @param throwable
         * @return
         */
        static String toFullString(Throwable throwable)
        {
                StringWriter sw = null;
                PrintWriter pw = null;
                try
                {
                        sw = new StringWriter();
                        pw = new PrintWriter(sw);
                        throwable.printStackTrace(pw);
                        return sw.toString();
                } finally
                {
                        close(sw);
                        close(pw);
                }
        }
        /**
         *     让文件流安静的关闭
         * @param closeable   关闭接口
         */
        static void close(Closeable closeable)
        {
                if (closeable != null)
                {
                        try
                        {
                                closeable.close();
                        } catch (IOException e)
                        {

                        }
                }
        }
        
        // 加密解压缩

/**
         * 功能描述：将压缩文件解压到指定的文件目录下
         * @param zipFileName      压缩文件名称(带路径)
         * @param outputDirectory  指定解压目录
         * @return
         * @throws Exception
         */
        public  void unzipCrypto(String zipFileName, String outputDirectory, String pwd)
        {
                ZipInputStream inputStream;
                try
                {
                        inputStream = new ZipInputStream(new FileInputStream(zipFileName));
                        unzipCrypto(inputStream, outputDirectory, pwd);
                } catch (Exception e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                
        }


        public  void unzipCrypto(ZipInputStream inputStream, String outputDirectory, String pwd) throws Exception
        {
                ZipEntry zipEntry = null;
                FileOutputStream outputStream = null;
                try{
                        while ((zipEntry = inputStream.getNextEntry()) != null) 
                        {
if (zipEntry.isDirectory())
{
        System.out.println(&amp;quot;你正在进入&amp;quot;+zipEntry.getName()+&amp;quot;文件夹&amp;quot;);
        String name = zipEntry.getName();
        name = name.substring(0, name.length() - 1);
        File file = new File(outputDirectory + File.separator + name);
        file.mkdir();
} 
else 
{
        File file = new File(outputDirectory + File.separator + zipEntry.getName());
        file.createNewFile();
        outputStream = new FileOutputStream(file);
        System.out.println(&amp;quot;你正在解压缩&amp;quot;+file.getName()+&amp;quot;文件&amp;quot;);
        PBEKeySpec keySpec = new PBEKeySpec(pwd.toCharArray());
    SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);
    SecretKey passwordKey = keyFactory.generateSecret(keySpec);
    byte[] salt = new byte[8];
    inputStream.read(salt);
    int iterations = 100;
    PBEParameterSpec parameterSpec = new PBEParameterSpec(salt, iterations);
    Cipher cipher = Cipher.getInstance(ALGORITHM);
    cipher.init(Cipher.DECRYPT_MODE, passwordKey, parameterSpec);
    byte[] input = new byte[1024];
    int bytesRead;
    while ((bytesRead = inputStream.read(input)) != -1) 
    {
            byte[] output = cipher.update(input, 0, bytesRead);
            if (output != null)
            {
                    outputStream.write(output);
            }
    }
    byte[] output = cipher.doFinal();
    if (output != null)
    {
            outputStream.write(output);
    }
/*                                    outputStream.flush();
                                    outputStream.close();*/
        
}
                        }
                        //inputStream.close();
                }
                catch(IOException ex)
                {
                        throw new Exception(&amp;quot;解压读取文件失败&amp;quot;);
                }
                catch(Exception ex)
                {
                        throw new Exception(&amp;quot;解压文件密码不正确&amp;quot;);
                }
/*                finally
                {
                        inputStream.close();
                        outputStream.flush();
                    outputStream.close();
                }*/
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3：进一步 实现先前的想法，封装一个OOZip类，
基本思想：
1：抽取常用变量，比如bufferSize 缓冲区大小     buf缓冲区； 本想着加入压缩和解压缩的流变量，后来删掉了
2：定义构造函数， 设置缓冲区大小
3：复制之前的方法，并利用buffersize和buf改写copy函数和 文件的复制的函数
4：进行简单地压缩和解压缩文件夹      加密压缩和解加密压缩文件夹   的测试。 并找到了压缩单个文件的bug
5：bug修复&lt;/p&gt;
&lt;p&gt;完整代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.Closeable;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.io.StringWriter;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.util.Random;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;
import java.util.zip.ZipOutputStream;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.PBEParameterSpec;

/**
* @author    叶昭良
* @time      2015年2月12日下午9:51:11
* @version   OOZip    用于压缩和解压缩
*                   V1.0  增加了压缩 
*                   V2.0   ZipShared加入了 zosTemp.close(); 修复了 压缩的bug
*                   V3.0   改进了构造函数 利用具有缓冲区的压缩
*                   V4.0   升级了ZipShared 使用了copy函数。
*                   V5.0   增加了加密压缩 和解加密压缩
*                   V6.0   改用了面向对象方式修改了一番
*                   V7.0   加入了一些压缩和解压缩完成的的console标记
*                   V8.0   修复了单个文件无法加密的bug   new ZipEntry(base) 改为
*                    new ZipEntry(base+fileinput.getName())，未添入到zipentry的缘故
*                    而若是文件夹遍历的时候则是有加入文件名的标记！所以在单个文件的时候也需要加入文件名的
*                    标记
*                   V9.0   若有中文问题，可以进一步采用import org.apache.tools.zip.* 的zip包！ 更好的支持中文
*                          具体参看http://blog.csdn.net/liu149339750/article/details/7887701  
*                                 http://szhnet.iteye.com/blog/199059 ，这个链接当中提供了ant版本 
*                          当然此版本，不需要org.apache.tool.zip包也不需要ant包  附录了ant版本的代码，的确看起来
*                          是简单的。
*/
public class OOZip
{

/**
*  这几个私有变量的控制，主要体现在针对具体的文件的复制过程中
*/
        private int bufSize ; //压缩和解压缩会用到。 一次从压缩文件zip读取多少文件信息
                                                                 //或者一次写入多少文件信息到压缩流
        private byte[] buf;   //写入或者写出压缩流的字节数组
        private int readBytes = 0;  //实际写入或者写出文件流的大小。
        private static final String ALGORITHM = &amp;quot;PBEWithMD5AndDES&amp;quot;;
        
        //构造函数的定义
   public OOZip(){ 
           // 1025*512  //设置输入输出流的缓冲区的大小 ，统一设置
        this(1024*512); 
    } 

    public OOZip(int bufSize){ 
        this.bufSize = bufSize; 
        this.buf = new byte[this.bufSize]; 
    } 
        
        //常用的类中 内部函数
        
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                OOZip oz = new OOZip();
                //单个文件加密和非加密测试暂时失败
                oz.ZipShared(&amp;quot;e://student.txt&amp;quot;, &amp;quot;e://laoliang&amp;quot;); 
                //oz.ZipSharedCrypto(&amp;quot;e://student.txt&amp;quot;, &amp;quot;e://laoliang&amp;quot;,&amp;quot;1234&amp;quot;);
                //输入文件夹路径则加密和非加密测试通过
                //oz.ZipShared(&amp;quot;e://test1222bak&amp;quot;, &amp;quot;e://laoliang&amp;quot;);  //已测试通过
                //oz.ZipSharedCrypto(&amp;quot;e://test1222bak&amp;quot;, &amp;quot;e://laoliang&amp;quot;, &amp;quot;123456&amp;quot;);
                
                //解压缩，不用输入.zip后缀，只需要输入文件名
                //oz.unzipCrypto(&amp;quot;e://laoliang&amp;quot;, &amp;quot;c://laozi&amp;quot;,&amp;quot;123456&amp;quot;);
                //测试成功
        }

        /**
         *     压缩名字为fileinput变量内容的文件夹
         * @param fileinput   文件夹名字
         * @param zos         zip文件夹名字
         */
        public void ZipShared(String fileinput,String zos)
        {
                try
                {
                        //加入&amp;quot;zip&amp;quot;后缀！
                        ZipOutputStream zosTemp = new ZipOutputStream(new FileOutputStream(zos+&amp;quot;.zip&amp;quot;));
                        File fApple = new File(fileinput);
                        ZipShared(fApple,zosTemp,&amp;quot;&amp;quot;);
                        try
                        {
                                /// 为什么加入这个就可以？？？？
                                //  不加入这有异常？？？？why   Tell me 
                                zosTemp.close();
                        } catch (IOException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                } catch (FileNotFoundException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                System.out.println(&amp;quot;success to create&amp;quot;+zos+&amp;quot;.zip&amp;quot;);
        }
        /**
         *     压缩文件夹的中间函数
         * @param fileinput    输入函数的文件对象
         * @param zos          压缩输出流对象
         * @param base         一般是&amp;quot;&amp;quot; 表示子目录的作用，在递归目录的时候会用到，在文件夹递归中，涉及到改变；
         */
        public  void ZipShared(File fileinput,ZipOutputStream zos,String base)
        {
if(fileinput.isDirectory())
{
        System.out.println(&amp;quot;你正在进入&amp;quot;+fileinput+&amp;quot;文件夹&amp;quot;);
        File[] fBanana = fileinput.listFiles();
        try
        {
                //传进一个文件夹标志
                zos.putNextEntry(new ZipEntry(base+&amp;quot;/&amp;quot;));
                //让base加上一个/
                base = base.length()==0?&amp;quot;&amp;quot;:base+&amp;quot;/&amp;quot;;
                for(int i = 0; i &amp;lt; fBanana.length; i++)
                {
                        ZipShared(fBanana[i],zos,base+fBanana[i].getName());
                }
        } catch (IOException e)
        {
                System.out.println(&amp;quot;压缩文件夹失败&amp;quot;+e.getMessage());
        }
        
}else
{
        try
        {
                zos.putNextEntry(new ZipEntry(base+fileinput.getName()));
                FileInputStream fis = new FileInputStream(fileinput);
                //改进写入的方式
                /*int b;
                while((b = fis.read())!= -1)
                {
                        zos.write(b); 
                        //效率很定不高  每一个字符  进行一次缓冲
                        //zos.flush();
                }*/
                copy(fis,zos); //利用汝鹏版的copy函数
                System.out.println(&amp;quot;你正在压缩&amp;quot;+fileinput.getName());
        } catch (IOException e)
        {
                System.out.println(&amp;quot;压缩文件失败&amp;quot;+e.getMessage());
        } 
}
        }
        /**
         *     加密压缩文件夹
         * @param fileinput    文件夹字符串
         * @param zosFile      压缩字符串名字
         * @param pwd          加密的密码
         */
        public  void ZipSharedCrypto(String fileinput,String zosFile,String pwd)
        {
                
                try
                {        
                        File f1 = new File(fileinput);
                        //采用和ZipShared一样的FileOutputStream
                        ZipOutputStream zos  = null;
                        zos = new ZipOutputStream(new FileOutputStream(zosFile+&amp;quot;.zip&amp;quot;));
                        ZipSharedCrypto(f1,zos,&amp;quot;&amp;quot;, pwd);
                        try
                        {
                                zos.close();
                        } catch (IOException e)
                        {
                                e.printStackTrace();
                        }
                } catch (FileNotFoundException e)
                {
                        System.out.println(&amp;quot;未找到文件&amp;quot;+e.getMessage());
                }
                System.out.println(&amp;quot;success to create crypto &amp;quot;+zosFile+&amp;quot;.zip&amp;quot;);
        }
        /**
         *          加密压缩文件夹     
         * @param fileinput     压缩文件夹的File对象
         * @param zos           zip压缩输出流ZipOutputStream
         * @param base          一般是&amp;quot;&amp;quot;
         * @param pwd           压缩的密码
         */
        public  void ZipSharedCrypto(File fileinput,ZipOutputStream zos,String base,String pwd)
        {
if(fileinput.isDirectory())
{
        System.out.println(&amp;quot;你正在进入&amp;quot;+fileinput+&amp;quot;文件夹&amp;quot;);
        File[] fApples = fileinput.listFiles();
        //因为ZipEntry的isDirectory()方法中，目录以&amp;quot;/&amp;quot;结尾
        try
        {        
                zos.putNextEntry(new ZipEntry(base+&amp;quot;/&amp;quot;));
                base = base.length()==0?&amp;quot;&amp;quot;:(base+&amp;quot;/&amp;quot;);
                //一种比较新型的方式循环读写东西。
                for(File ftemp:fApples)
                {
                        ZipSharedCrypto(ftemp,zos,base+ftemp.getName(),pwd);
                }
        }catch(IOException e)
        {
                System.out.println(&amp;quot;文件夹加密压缩失败&amp;quot;);
        }
}else
{        
        
        try
        {
                zos.putNextEntry(new ZipEntry(base));
                FileInputStream fis = new FileInputStream(fileinput);
                System.out.println(&amp;quot;你正在开始加密压缩&amp;quot;+fileinput+&amp;quot;文件&amp;quot;);
                //加密过程的开始
                PBEKeySpec keySpec = new PBEKeySpec(pwd.toCharArray());
                SecretKeyFactory keyFactory = null;
                try
                {
                        keyFactory = SecretKeyFactory.getInstance(ALGORITHM);
                } catch (NoSuchAlgorithmException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                SecretKey passwordKey = keyFactory.generateSecret(keySpec);
                //生成一个炸弹 进行加密
                byte[] bomb =  new byte[8];
                Random rnd = new Random();
                rnd.nextBytes(bomb);
                int iterations = 100;
                PBEParameterSpec parameterSpec = new PBEParameterSpec(bomb, iterations);
                Cipher cipher = null;
                try
                {
                        cipher = Cipher.getInstance(ALGORITHM);
                } catch (NoSuchAlgorithmException
                                | NoSuchPaddingException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                cipher.init(Cipher.ENCRYPT_MODE, passwordKey,parameterSpec);
                //往输出流 添加炸弹
                zos.write(bomb);
                
                //添加加密的主文件内容  1KB缓存区
                //byte[] inputBuffer = new byte[1024];
                //int bytesRead = 0;
                //如果没有读到信息则为-1
                
                //改用 readBytes  buf在类头定义的私有变量，进行统一的buffer缓存区大小的控制
                while((this.readBytes = fis.read(this.buf))!= -1)
                {
                        //每个缓冲区 进行加密写入
                        byte[] output = cipher.update(this.buf);
                        if(output != null)
                        {
                                zos.write(output);
                        }
                }
                
                //加密结束语-------------加密结束
                byte[] outputFinal =null;
                try
                {
                        outputFinal = cipher.doFinal();
                } catch (IllegalBlockSizeException | BadPaddingException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                if(outputFinal != null)
                {
                        zos.write(outputFinal);
                }        
        }catch(InvalidKeySpecException | InvalidKeyException | InvalidAlgorithmParameterException | IOException e)
        {
                System.out.println(&amp;quot;加密失败&amp;quot;);
        }
}
        }
        /**
         *   解压缩 zip文件，只能限制为zip ,rar无法进行，利用如鹏版的
         * @param zipName        待解压的zip文件
         * @param outputfolder   解压zip文件到outputFoler文件夹下
         */
        public void unzip(String zipName,String outputfolder)
        {
                File gtkDir = new File(outputfolder);// *.dll放的文件夹
                //指定的目录不存在  则创建之
                if (!gtkDir.exists())
                {
                        gtkDir.mkdirs();
                }
                InputStream inStream = null;
                try
                {
                        //不用输入.zip后缀，只需要输入文件名
                        inStream = new  FileInputStream(zipName+&amp;quot;.zip&amp;quot;);
                } catch (FileNotFoundException e1)
                {
                        // TODO Auto-generated catch block
                        e1.printStackTrace();
                }
                //InputStream inStream = Utils.class.getResourceAsStream(&amp;quot;/gtkshare.zip&amp;quot;);
                if (inStream == null)
                {
                        throw new UnsatisfiedLinkError(&amp;quot;没找到&amp;quot;+zipName);
                }
                try
                {                        
                        unzip(inStream, gtkDir.toString());
                        //System.out.println(gtkDir.toString());
                        System.out.println(&amp;quot;成功解压缩&amp;quot;+zipName+&amp;quot;.zip&amp;quot;+&amp;quot;文件 到&amp;quot;+outputfolder+&amp;quot;文件夹下&amp;quot;);
                } catch (IOException e)
                {
                        System.err.println(&amp;quot;解压缩&amp;quot;+zipName+&amp;quot;.zip失败&amp;quot; + toFullString(e));
                }
        }

        /**
         * 把streamToZip这个zip文件流解压到硬盘的destDir文件夹，支持多级目录
         * @param streamToZip
         * @param destDir
         * @throws IOException
         */
        public  void unzip(InputStream streamToZip,String destDir)throws IOException
        {  
                ZipInputStream zipStream = new ZipInputStream(streamToZip);
try
{
        ZipEntry zipEntry = null;
        //通过zipEntry方式支持多级目录
while((zipEntry=zipStream.getNextEntry())!=null)
{
        if(zipEntry.isDirectory())
        {
                System.out.println(&amp;quot;你正在创建文件夹文件 比较特殊&amp;quot;);
                File dir = new File(destDir,zipEntry.getName());
                //如果指定的目录不存在 则创建之
                if(!dir.exists())
                {
                        dir.mkdirs();
                }
        }
        else
        {
                FileOutputStream fileOutStream = new FileOutputStream(new File(destDir,zipEntry.getName()));
                try
                {
                        copy(zipStream, fileOutStream);
                }
                finally
                {
                        close(fileOutStream);
                }
                System.out.println(&amp;quot;你正在解压缩压缩&amp;quot;+zipEntry.getName());
        }
}
                }
                finally
                {
                        close(zipStream);
                }
                
    }
        /**
         *     从zip文件包中拷贝文件 ，按照0.5MB的缓冲写入文件(默认方式）
         * @param inStream       zipEntry的某个文件
         * @param outStream      输出的某个文件流
         * @throws IOException
         */
        public void copy(InputStream inStream, OutputStream outStream)
                        throws IOException
        {
                //byte[] buffer = new byte[512 * 1024];// 0.5MB 的缓冲区
                //int len;
                while ((this.readBytes = inStream.read(this.buf)) &amp;gt;= 0)
                {
                        outStream.write(this.buf, 0, this.readBytes);
                }
        }
        /**
         *    摘自rupeng.gtk4j   不明白具体的作用    非主要问题
         * @param throwable
         * @return
         */
        public String toFullString(Throwable throwable)
        {
                StringWriter sw = null;
                PrintWriter pw = null;
                try
                {
                        sw = new StringWriter();
                        pw = new PrintWriter(sw);
                        throwable.printStackTrace(pw);
                        return sw.toString();
                } finally
                {
                        close(sw);
                        close(pw);
                }
        }
        /**
         *     让文件流安静的关闭
         * @param closeable   关闭接口
         */
        public void close(Closeable closeable)
        {
                if (closeable != null)
                {
                        try
                        {
                                closeable.close();
                        } catch (IOException e)
                        {

                        }
                }
        }
        
        // 加密解压缩

/**
         * 功能描述：将压缩文件解压到指定的文件目录下
         * @param zipFileName      压缩文件名称(带路径)
         * @param outputDirectory  指定解压目录
         * @return
         * @throws Exception
         */
        public  void unzipCrypto(String zipFileName, String outputDirectory, String pwd)
        {
                ZipInputStream inputStream;
                File outputDir;
                try
                {
                        //不用输入.zip后缀，只需要输入文件名
                        inputStream = new ZipInputStream(new FileInputStream(zipFileName+&amp;quot;.zip&amp;quot;));
                        outputDir = new File(outputDirectory);
                        unzipCrypto(inputStream, outputDir, pwd);
                } catch (Exception e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                System.out.println(&amp;quot;成功解压缩&amp;quot;+zipFileName+&amp;quot;.zip&amp;quot;+&amp;quot;文件 到&amp;quot;+outputDirectory+&amp;quot;文件夹下&amp;quot;);
                
        }


        public void unzipCrypto(ZipInputStream inputStream, File outputDir, String pwd) throws Exception
        {
                ZipEntry zipEntry = null;
                FileOutputStream outputStream = null;
                try{
while ((zipEntry = inputStream.getNextEntry()) != null) 
{
        //如果是文件夹  则遍历
        if (zipEntry.isDirectory())
        {
                System.out.println(&amp;quot;你正在进入&amp;quot;+zipEntry.getName()+&amp;quot;文件夹&amp;quot;);
                String name = zipEntry.getName();
                name = name.substring(0, name.length() - 1);
                File file = new File(outputDir + File.separator + name);
                file.mkdir();
        } 
        //对单个普通文件进行处理
        else 
        {
                File file = new File(outputDir + File.separator + zipEntry.getName());
                file.createNewFile();
                outputStream = new FileOutputStream(file);
                System.out.println(&amp;quot;你正在解压缩&amp;quot;+file.getName()+&amp;quot;文件&amp;quot;);
                //解压加密过程的开始
                PBEKeySpec keySpec = new PBEKeySpec(pwd.toCharArray());
            SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);
            SecretKey passwordKey = keyFactory.generateSecret(keySpec);
            //准备排除加密的炸弹头
            byte[] apple = new byte[8];
            //在zip输入流添加read
            inputStream.read(apple);
            int iterations = 100;
            PBEParameterSpec parameterSpec = new PBEParameterSpec(apple, iterations);
            Cipher cipher = Cipher.getInstance(ALGORITHM);
            cipher.init(Cipher.DECRYPT_MODE, passwordKey, parameterSpec);
            //byte[] input = new byte[1024];
            //int bytesRead;
            //利用全局的私有变量this.buf  this.readBytes ,已在类开头定义，统一控制
            while ((this.readBytes = inputStream.read(this.buf)) != -1) 
            {
                    byte[] output = cipher.update(this.buf, 0, this.readBytes);
                    if (output != null)
                    {
                            outputStream.write(output);
                    }
            }
            byte[] output = cipher.doFinal();
            if (output != null)
            {
                    outputStream.write(output);
            }
                
        }
}
                }
                catch(IOException ex)
                {
                        throw new Exception(&amp;quot;解压读取文件失败&amp;quot;);
                }
                catch(Exception ex)
                {
                        throw new Exception(&amp;quot;解压文件密码不正确&amp;quot;);
                }
        }

}
/*
*  附录ant版本的压缩实现http://szhnet.iteye.com/blog/199059
*  可以加入某些文件和删除某些文件
*  package net.szh.zip;

import java.io.File;

import org.apache.tools.ant.Project;
import org.apache.tools.ant.taskdefs.Zip;
import org.apache.tools.ant.types.FileSet;

public class ZipCompressorByAnt {

        private File zipFile;

        public ZipCompressorByAnt(String pathName) {
                zipFile = new File(pathName);
        }
        
        public void compress(String srcPathName) {
                File srcdir = new File(srcPathName);
                if (!srcdir.exists())
                        throw new RuntimeException(srcPathName + &amp;quot;不存在！&amp;quot;);
                
                Project prj = new Project();
                Zip zip = new Zip();
                zip.setProject(prj);
                zip.setDestFile(zipFile);
                FileSet fileSet = new FileSet();
                fileSet.setProject(prj);
                fileSet.setDir(srcdir);
                //fileSet.setIncludes(&amp;quot;**//*.java&amp;quot;); 包括哪些文件或文件夹 eg:zip.setIncludes(&amp;quot;*.java&amp;quot;);
                //fileSet.setExcludes(...); 排除哪些文件或文件夹
                zip.addFileset(fileSet);
                
                zip.execute();
        }
}

ant版本的使用：
package net.szh.zip;

public class TestZip {
        public static void main(String[] args) {                
                ZipCompressorByAnt zca = new ZipCompressorByAnt(&amp;quot;E:\\szhzipant.zip&amp;quot;);
                zca.compress(&amp;quot;E:\\test&amp;quot;);
        }
}
*  
*/
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>反射机制内省正则</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/fan-she-ji-zhi-nei-sheng-zheng-ze/</link>
      <pubDate>Mon, 11 May 2015 14:58:46 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/fan-she-ji-zhi-nei-sheng-zheng-ze/</guid>
      <description>&lt;p&gt;2：反射机制
不行，则逆着来.
类（Class）
三种方式&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//Test class
                //*************************************************************
                //第一种方式获得类
                System.out.println(&amp;quot;//*************************************************************&amp;quot;);
                Class clazz1 = Person.class;
                //第二种方式获得类
                System.out.println(&amp;quot;第一种方式获得类&amp;quot;+clazz1.getName());
                Person personClass = new Person();
                Class clazz2 = personClass.getClass();
                System.out.println(&amp;quot;第二种方式获得类&amp;quot;+clazz1.getName());
                //第三种方式获得类
                try
                {
                        Class clazz3 = Class.forName(&amp;quot;com.reflect.test.Person&amp;quot;);
                        System.out.println(&amp;quot;第三种方式获得类&amp;quot;+clazz1.getName());
                        System.out.println(&amp;quot;三种类方式都是同一个类！因为类只加载一次&amp;quot;+(clazz2==clazz1)+(clazz2==clazz3));
                        System.out.println(&amp;quot;包的名字&amp;quot;+clazz3.getPackage().getName());
                        System.out.println(&amp;quot;简单类名字（不带包）&amp;quot;+clazz3.getSimpleName());

                        System.out
                                        .println(&amp;quot;------------------------------通过Class对象获得类的构造函数---------------------&amp;quot;);
                        Constructor[] constructors = clazz3.getConstructors();
                        for (Constructor constructor : constructors) {
                                System.out.println(constructor);
                        }

                        System.out.println(&amp;quot;------------------通过Class对象获得类的字段----------------&amp;quot;);
                        Field[] fields = clazz3.getDeclaredFields();
                        for (Field field : fields) {
                                System.out.println(field);
                        }

                        System.out.println(&amp;quot;--------通过Class对象获得类的方法----------&amp;quot;);

                        Method[] methods = clazz3.getMethods();// 返回所有的public 方法,包括父类声明的public方法
                        for (Method method : methods) {
                                System.out.println(method);
                        }

                } catch (ClassNotFoundException e1)
                {
                        // TODO Auto-generated catch block
                        e1.printStackTrace();
                }
```java
最主要的是Class.forName();

字段

设置字段的属性，并使用创建的对象调用方法.
```java
//*************************************************************
                //TestField  测试字段开始
                //*************************************************************
                System.out.println(&amp;quot;//*************************************************************&amp;quot;);
                try
                {
                        /**
                         *  打印出所有字段
                         *  
                         *  字段类的一个特点设置
                         */
                        Field[] fields = clazz.getDeclaredFields();
                        for(Field temp : fields)
                        {
                                System.out.println(temp);
                        }
                        Person personLiMing = (Person) clazz.newInstance();
                        /**
                         * 测试添加一个名字的字段
                         */
                        //Field nameField = clazz.getField(&amp;quot;Name&amp;quot;); //会报异常
                        //Field nameField = clazz.getDeclaredField(&amp;quot;name&amp;quot;); //注意区分大小写
                        Field nameField = clazz.getDeclaredField(&amp;quot;Name&amp;quot;);
                        //一定得设置？
                        nameField.setAccessible(true);
                        nameField.set(personLiMing,&amp;quot;李明&amp;quot;);
                        
                        Object o = nameField.get(personLiMing);
                        System.out.println(o);
                        personLiMing.sayHi();
                } catch (InstantiationException | IllegalAccessException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;创建新的实例异常&amp;quot;);
                }catch( NoSuchFieldException | SecurityException e)
                {
                        System.out.println(&amp;quot;没有那个字段&amp;quot;);
                }
```java

构造函数

主要作用：产生对象

```java
/**
                 *  分为两个部分测试构造函数 
                 *  1：  有参的 ，注意有参的时候String.class int.class
                 *  2：  无参的
                 */
                //TestConstructor
                /**
                 * 打印所有的类的构造函数
                 */
                try
                {
                        Constructor con1 = clazzConstructor.getDeclaredConstructor();
                        
                        Object o = con1.newInstance();
                        
                        Person personWanghao = (Person)o;
                        personWanghao.sayHi();
                        
                        System.out.println(&amp;quot;------------------------&amp;quot;);
                        
                        Constructor&amp;lt;Person&amp;gt; con2 = clazzConstructor.getDeclaredConstructor(String.class,int.class);
                        Object o2 = con2.newInstance(&amp;quot;汪峰&amp;quot;,22);
                        //很浅显的道理  只有构造函数可以新建对象！！上面的代码正是
                        //体现如此！        
                        Person personWangfeng = (Person)o2;
                        personWangfeng.sayHi();
                        
                } catch (NoSuchMethodException | SecurityException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;获取构造函数异常&amp;quot;);
                }catch (InstantiationException | IllegalAccessException
                                | IllegalArgumentException | InvocationTargetException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;通过构造函数创建实例异常&amp;quot;);
                }
               
```java

方法

Invoke函数，调用对象的方法

```java
//*************************************************************
                //TestMethod
                /**
                 *  开始测试 所有Person类的普通方法
                 *  
                 *  方法类的一个特点，方法对应具体的参数！类似于构造函数
                 *  都需要考虑重载的问题
                 */
                System.out.println(&amp;quot;//*************************************************************&amp;quot;);
                System.out.println(&amp;quot;开始测试 所有Person类的普通方法---------&amp;quot;);
                Method[] methods = clazzMethod.getDeclaredMethods();
                
                for(Method temp: methods)
                {
                        System.out.println(temp);
                }
                
                //测试Person的sayHi方法
                try
                {
                        Method sayHi = clazzMethod.getDeclaredMethod(&amp;quot;sayHi&amp;quot;);
                        //Method singSong = clazz.getDeclaredMethod(&amp;quot;singSong&amp;quot;);
                        
                        Object o = clazzMethod.newInstance();
                        
                        Person personPig = (Person)o;
                        personPig.sayHi();
                        System.out.println(&amp;quot;通过普通方法1 进行Invoke1！！！&amp;quot;);

                        sayHi.invoke(o);
                        System.out.println(&amp;quot;通过普通方法1 进行Invoke2！！！&amp;quot;);
                        //反射的感觉有点像，逆着来的感觉
                        //通过方法调用对象！！并执行某个动作！
                        //而不是通过对象调用方法执行某个动作
                        sayHi.invoke(personPig);

                        Class returnType = sayHi.getReturnType();
                        System.out.println(&amp;quot;Person类 sayHi的返回值类型&amp;quot;+returnType);
                        
                        int modifies = sayHi.getModifiers();
                        //private 的值为0   public的值为1
                        System.out.println(&amp;quot;是private?:&amp;quot;+Modifier.isPrivate(modifies));
                        System.out.println(modifies);
                        
                        /**
                         *  必须隐藏 ！否则下面的无法执行！ 有对应的参数  需要设置上 参数才可以
                         *  否则找不到 singSong() 无参的函数
                         */
                /*        Method singSong = clazzMethod.getDeclaredMethod(&amp;quot;singSong&amp;quot;);
                        System.out.println(singSong);*/
                        
                        Method singSong2 = clazzMethod.getDeclaredMethod(&amp;quot;singSong&amp;quot;, String.class);
                        Person personDandan = new Person(&amp;quot;淡淡&amp;quot;,22);
                        singSong2.invoke(personDandan, &amp;quot;好汉歌&amp;quot;);
                        System.out.println(singSong2.getReturnType());
                        
                        //System.out.println(&amp;quot;Person类singSong的返回值类型&amp;quot;+clazz.getDeclaredMethod(&amp;quot;singSong&amp;quot;).getReturnType());
                } catch (NoSuchMethodException | SecurityException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;没有对应的方法&amp;quot;+e.getMessage());
                }catch (InstantiationException | IllegalAccessException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;获取实例异常&amp;quot;+e.getMessage());
                }catch (IllegalArgumentException | InvocationTargetException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;Invoke异常&amp;quot;+e.getMessage());
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一个餐厅的菜单实例：&lt;/p&gt;
&lt;p&gt;通过一个food接口，创建多样菜单，并且易于拓展性。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Food.properties:
Apple=com.reflect.test.food.Apple
Banana=com.reflect.test.food.Banana
HongShaoRou=com.reflect.test.food.HongShaoRou
QingJiaoRouSi=com.reflect.test.food.QingJiaoRouSi
SuanTaiChaoRou=com.reflect.test.food.SuanTaiChaoRou
TangCuLiYu=com.reflect.test.food.TangCuLiYu
XiaoChaoRou=com.reflect.test.food.XiaoChaoRou
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Food接口：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.reflect.test.food;

public interface Food {

        String getFoodName();

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;依次创建各个食物：（类似方法）
红烧肉：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.reflect.test.food;

public class HongShaoRou implements Food {

        public static final String foodName = &amp;quot;红烧肉&amp;quot;;

        @Override
        public String getFoodName() {
        return foodName;
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;青椒肉丝：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.reflect.test.food;

public class QingJiaoRouSi implements Food {

        public static final String foodName = &amp;quot;青椒肉丝&amp;quot;;

        @Override
        public String getFoodName() {
                return foodName;
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;。。。。
餐厅类的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 情景 : 有一家餐厅,时常更换菜品 , 客人进店时向客人展示所有的菜品,
* 要求开发一个扩充性好的程序,就是更换菜品时只需要做一些简单的配置就可以
* 
* 反射基本上 自己自学 看的    视频没怎么听

*/
package com.reflect.test;

import java.util.ArrayList;


/**
*  通过下面的餐厅类  很方便的通过Food接口 
*  添加更多的新菜！ 只要你有新定义一个  食物.java 然后在
*  food.properties添加一个键值对即可
*/



/**
* @author    叶昭良
* @time      2015年3月3日下午4:44:15
* @version   com.reflect.testRestaurant V1.0
*/
import com.reflect.test.food.*;

import java.util.*;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;


public class Restaurant 
{

        /**
         * @param args
         */
        //没有想到用list表来接数据（一定要有集合的概念）
        private List&amp;lt;Food&amp;gt;  foods = new ArrayList&amp;lt;Food&amp;gt;();
        
        //定义一个init函数 用于在构造函数内部 调用，并初始化菜单！准备开张 开店铺
        public Restaurant()
        {
        }
        public void init()
        {
                try
                {
                        InputStream is = Restaurant.class.getResourceAsStream(&amp;quot;food.properties&amp;quot;);
                        Properties prop = new Properties();
                        /**
                         *  要知道 food.properties 的key-value的写法
                         *  Prop对象就是一个map对象
                         *  先前只写上一个值是错误的！ 必须写上
                         *  Apple=com.reflect.test.food.Apple
                         */
                        //必须加在src底下
                        //prop.load(new FileInputStream(&amp;quot;food.properties&amp;quot;));
                        try
                        {
                                prop.load(is);
                        } catch (IOException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                        Collection  coll1 = prop.values();
                        for(Object foodClassName:coll1)
                        {
                                Class temp;
                        
                                temp = Class.forName((String)(foodClassName));
                                
                                Food food = (Food)temp.newInstance();
                                foods.add(food);
                        }
                }catch (ClassNotFoundException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;未找到对应的类&amp;quot;);
                }catch (InstantiationException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;产生实例的异常&amp;quot;);
                } catch (IllegalAccessException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                
        }
        public void showFoods()
        {
                for(Food temp:foods)
                {
                        //Food接口创建的一个唯一接口方法
                        System.out.println(temp.getFoodName());
                }
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                //开了一家店
                Restaurant res = new Restaurant();
                System.out.println(&amp;quot;欢饮各位宾客的到来-- 鞭炮响起&amp;quot;);
                System.out.println(&amp;quot;******************************&amp;quot;);
                res.showFoods();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3：内省&lt;/p&gt;
&lt;p&gt;在满足javaBean规范的类中，在不清楚字段的前提下，通过getter &amp;amp;setter获得所有的字段，一般和反射联合使用。&lt;/p&gt;
&lt;p&gt;Javabean 其实就是满足规范，具体规范是有&lt;/p&gt;
&lt;p&gt;私有变量
Getter andsetter方法
至少有一个无参构造函数&lt;/p&gt;
&lt;p&gt;然后可以通过 类 Introspector 来获取某个对象的 BeanInfo 信息，然后通过 BeanInfo 来获取属性的描述器（ PropertyDescriptor ），通过这个属性描述器就可以获取某个属性对应的 getter/setter 方法，然后我们就可以通过反射机制来调用这些方法。javabean的实例对象称之为值对象（ValueObject）,因为这些bean中通常只有一些信息字段和存储方法，没有功能性方法。
分为两种情况，只是设置或者得到某个具体的字段&lt;/p&gt;
&lt;p&gt;两外一种是获得所有的字段。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.introspect.test;

import java.beans.BeanInfo;
import java.beans.IntrospectionException;
import java.beans.Introspector;
import java.beans.PropertyDescriptor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

/**
* @author    叶昭良
* @time      2015年3月3日下午6:34:08
* @version   com.introspect.testTestStudentIntrospect V1.0
*/
public class TestStudentIntrospect
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Student wangxiuyan = new Student();//new Student(&amp;quot;001&amp;quot;,&amp;quot;王秀艳&amp;quot;,30);
                String fieldName=&amp;quot;Age&amp;quot;;
                //通过javabeans--&amp;gt;具体某个属性---&amp;gt; 通过反射获取方法！ --&amp;gt;再调用方法
                getProperty(wangxiuyan, fieldName);
                setProperty(wangxiuyan, fieldName);
                getProperties(wangxiuyan, fieldName);
        
        }
        private static void getProperties(Student stu,String fieldName)
        {
                try
                {
                        BeanInfo  beanInfo = Introspector.getBeanInfo(stu.getClass());
                        PropertyDescriptor[] pro = beanInfo.getPropertyDescriptors();
                        for(PropertyDescriptor temp : pro)
                        {
                                if(temp.getName().equals(fieldName))
                                {
                                        Method methodx = temp.getReadMethod();

                                        System.out.println(methodx.invoke(stu)); 
                                        
                                }
                        }
                } catch (IntrospectionException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }catch (IllegalAccessException | IllegalArgumentException
                                | InvocationTargetException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                
        }
        
        private static void getProperty(Student stu,String fieldName)
        {
                try
                {
                        PropertyDescriptor pro = new PropertyDescriptor(fieldName, Student.class);
                        Method methodx = pro.getReadMethod(); //
                        Object ojx = methodx.invoke(stu);
                        System.out.println(ojx);
                } catch (IntrospectionException  e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;属性描述获取失败&amp;quot;);
                }catch(IllegalAccessException | IllegalArgumentException | InvocationTargetException e)
                {
                        System.out.println(&amp;quot;invoke调用失败！&amp;quot;);
                }
                
        }
        private static void setProperty(Student stu,String fieldName)
        {
                try
                {
                        PropertyDescriptor pro = new PropertyDescriptor(fieldName, Student.class);
                        Method methodx = pro.getWriteMethod(); //
                        methodx.invoke(stu,8);
                        System.out.println(stu.getAge());
                } catch (IntrospectionException  e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;属性描述获取失败&amp;quot;);
                }catch(IllegalAccessException | IllegalArgumentException | InvocationTargetException e)
                {
                        System.out.println(&amp;quot;invoke调用失败！&amp;quot;);
                }        
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ORM的实现在：http://www.rupeng.com/forum/thread-44526-1-1.html&lt;/p&gt;
&lt;p&gt;4：正则表达式&lt;/p&gt;
&lt;p&gt;字符串内置函数：&lt;/p&gt;
&lt;p&gt;String的split、replace、replaceAll函数。&lt;/p&gt;
&lt;p&gt;在正则表达式中$表示在另一个字符串中获取正则表达式字符串匹配的小组号，$1表示第一个。。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;          \1 表示在同一个匹配正则表达式获得第一个匹配项(\2则表示在同一个匹配正则表达式获得第二个引用的匹配项)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//字符串测试
System.out.println(&amp;quot;fdasfsd&amp;quot;.indexOf(&#39;d&#39;));

        System.out.println(&amp;quot;fdasfsd&amp;quot;.lastIndexOf(&#39;d&#39;));

        String[] temp =&amp;quot;sdfddfdsgsdfddg&amp;quot;.split(&amp;quot;([a-z])\\1+&amp;quot;);
        for(String p : temp)
        {
        System.out.println(p);
        }

        System.out.println(&amp;quot;sdfddfdsgsdfddg&amp;quot;.replaceAll(&amp;quot;([a-z])\\1+&amp;quot;,&amp;quot;*&amp;quot;));

        System.out.println(&amp;quot;sdfddfdsgsdfddg&amp;quot;.replaceAll(&amp;quot;([a-z])\\1+&amp;quot;,&amp;quot;$1&amp;quot;));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Pattern&amp;amp;Matcher组合&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//工作中的  正则获取方式
                System.out.println(&amp;quot;2020&amp;quot;.matches(&amp;quot;\\d{3,10}&amp;quot;));
                
                String pat = &amp;quot;Welcome to china to have a pinny lunch ! Start the lesson&amp;quot;;
                Pattern p = Pattern.compile(&amp;quot;\\b[a-z]{5}\\b&amp;quot;);
                Matcher m = p.matcher(pat);
                while(m.find())
                {
                        System.out.println(m.group());
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;常见的存储结构：&lt;/p&gt;
&lt;p&gt;|&amp;mdash;&amp;ndash;顺序存储结构 特点是借助于数据元素的相对存储位置来表示数据元素之间的逻辑结构；
|&amp;mdash;&amp;ndash;链式存储结构 特点是借助于指示数据元素地址的指针表示数据元素之间的逻辑结构。
|&amp;mdash;&amp;ndash;散列存储结构 顺序+算列。
|&amp;mdash;&amp;ndash;索引存储结构 顺序+索引。&lt;/p&gt;
&lt;p&gt;常见的逻辑结构：
对数据及其关系的抽象逻辑描述，对立与计算机，与机器实现无关。
根据定义的关系不同，数据的逻辑结构分为四种：
|&amp;mdash;&amp;ndash;集合结构。数据元素之间未定义任何关的松散集合。
|&amp;mdash;&amp;ndash;线性结构。数据元素之间定义了次序关系的集合（全序集合），描述的是1对1关系。
|&amp;mdash;&amp;ndash;树形结构。数据元素之间定义了层次关系的集合（偏序集合），描述的是1对多关系。
|&amp;mdash;&amp;ndash;图状结构。数据元素之间定义了网状关系的集合，描述的是多对多关系。&lt;/p&gt;
&lt;p&gt;数据结构，就是相互之间存在一种或多种特定关系的数据元素的集合。可以简单表示为：数据结构 = 数据 + 关系。同一数据元素集合，所定一的关系不同，构成不同的数据结构。 数据结构包括逻辑结构和存储结构两个方面&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>简易的代码运行模拟窗口</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/jian-yi-de-dai-ma-yun-xing-mo-ni-chuang-kou/</link>
      <pubDate>Mon, 11 May 2015 14:58:46 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/jian-yi-de-dai-ma-yun-xing-mo-ni-chuang-kou/</guid>
      <description>&lt;p&gt;有时候，可能需要做一个动态的代码演示的窗口，当然用ppt也可以做，用其他的相关软件也可以做。然而自己写代码也是可以的。相信大家在听杨老师讲解treeview的时候，老杨秀的代码分析小程序，凭着印象，自己也琢磨着写了这一个简易的代码运行模拟窗口。代码涉及到的主要是treeview和textview以及按钮事件控制，另外加上cairo的画图处理，当然也可以直接利用GtkImage载入图片（可能需要隐藏控件，达到箭头下移的目的）
这边的缺点是，暂时不知道怎么销毁掉Cairo之前绘制的图形，其他还有很多缺点.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.Cairo;
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author    叶昭良
* @time      2015年2月3日上午10:24:23
* @version   TestTeacher V1.0   一个简易的代码运行模拟窗口，未加入代码的高亮，采用图片控制
*                               主要采用textview  treeview    cairo三个技术关键点
*/
public class TestTeacher
{

        /**
         * @param args
         */
        //部分类变量的定义
        static int window;
        static int gridHouse;

        static int liststore;
        static int listiter;
        static int treeViewApple;
        static int imagePosition = 0;
        static int rowPosition = 0;
        //static int dan ;
        static int start = 0;
        static int circlePointx = 200;
        static int circlePointy = 45;
        
        static int circleRectangex = 200;
        static int circleRectangey = 0;
        
        static int EndCirclex = 0;
        static int EndCircley = 0;
        static String note = &amp;quot;指针下移&amp;quot;;
        static int labelResult;
        
        //static String loveWords;
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                //GTK初始化
                GTK.gtk_init();
                //窗口对象标识的创建
                window= GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                //显示窗口
                GTK.gtk_widget_show(window);
                //安静关闭窗口
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                GTK.gtk_main_quit();
                        }
                }, null);
                
                //设置网格布局
                gridHouse = GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                //添加网格布局到window中
                GTK.gtk_container_add(window, gridHouse);
                
                //定义一些常用的控件
                
                //创建一个treeview 用于显示用户信息
                createSingleTreeView(gridHouse,start);
                //创建一个笑脸
                createDrawLaughFace(window,gridHouse,start,circlePointx,circlePointy);
                
                start = 3;
                //创建一个标签
                createLabel(&amp;quot;源代码------&amp;gt;&amp;quot;,gridHouse,start);
                start = 4;
                //创建一个源码的textview窗口，不可编辑
                createSingleTextView(window,gridHouse,start);
                createRectangleFace(window,gridHouse,3,circlePointx,circlePointy);

                start = 4;
                //创建一个按钮
                int textViewOutput = GTK.gtk_text_view_new();
                createNextButton(gridHouse,textViewOutput,start);
                
                start =3;
                //创建一个标签
                labelResult = GTK.gtk_label_new(&amp;quot;输出结果：&amp;quot;);
                GTK.gtk_widget_show(labelResult);
                GTK.gtk_grid_attach(gridHouse, labelResult,7, start, 1, 1);
                start = 4;

                //创建一个输出界面，用于显示源码输出地结果
                createOutputTextView(window,gridHouse,start,textViewOutput);
                //启动循环
                GTK.gtk_main();
        }
        /**
         * 
         * @param labelName  标签显示的字符串
         * @param gridHouse  网格对象标识
         * @param start      标签在网格对象标识的起始位置
         * @purpose          创建一个标签对象表示，并显示在窗口中
         */
        public static void createLabel(String labelName,int gridHouse,int start)
        {
                int labelTitle = GTK.gtk_label_new(labelName);
                GTK.gtk_widget_show(labelTitle);
                GTK.gtk_grid_attach(gridHouse, labelTitle, 0, start, 1, 1);

        }
        /**
         * 
         * @param scrolledBar    滚动条对象标识
         * @param textview        textview的对象标识
         * @param gridHouse       网格对象的对象标识
         * @param start          textview在网格对象布局的起始位置
         * @purpose              创建textView的滚动条
         */
        public static void createTextviewScrollBar(int scrolledBar,int textview,int gridHouse,int start)
        {
                scrolledBar = GTK.gtk_scrolled_window_new();
                GTK.gtk_widget_show(scrolledBar);
                GTK.gtk_grid_attach(gridHouse, scrolledBar, 0, start, 2, 2);
                GTK.gtk_widget_set_size_request(scrolledBar, 400, 400);
                GTK.gtk_container_add(scrolledBar,textview);
        }
        /**
         * 
         * @param scrolledBar     滚动条对象标识
         * @param textview        textview的对象标识
         * @param gridHouse       网格对象的对象标识
         * @param start          textview在网格对象布局的起始位置
         * @purpose               创建带滚动条的treeview对象标识,用于输出信息
         */
        public static void createTreeviewScrollBar(int scrolledBar,int textview,int gridHouse,int start)
        {
                scrolledBar = GTK.gtk_scrolled_window_new();
                GTK.gtk_widget_show(scrolledBar);
                GTK.gtk_grid_attach(gridHouse, scrolledBar, 0, start, 2, 3);
                GTK.gtk_widget_set_size_request(scrolledBar, 200, 200);
                GTK.gtk_container_add(scrolledBar,textview);
        }
        /**
         * 
         * @param scrolledBar    滚动条对象标识
         * @param textview       textview的对象标识
         * @param gridHouse      网格对象的对象标识
         * @param start          textview在网格对象布局的起始位置
         * @purpose              创建带滚动条的treeview对象标识，用于显示信息
         */
        public static void createTreeviewOutputScrollBar(int scrolledBar,int textview,int gridHouse,int start)
        {
                scrolledBar = GTK.gtk_scrolled_window_new();
                GTK.gtk_widget_show(scrolledBar);
                GTK.gtk_grid_attach(gridHouse, scrolledBar,8, start, 2, 3);
                GTK.gtk_widget_set_size_request(scrolledBar, 200, 200);
                GTK.gtk_container_add(scrolledBar,textview);
        }
        /**
         * 
         * @param window     窗口对象标识
         * @param gridHouse  网格布局对象标识
         * @param start       textview对象在网格布局对象中的起始位置
         * @purpose          创建一个textview的源代码窗口对象
         */
        public static void createSingleTextView(int window, int gridHouse, int start)
        {

                final int tvGirl = GTK.gtk_text_view_new();
                GTK.gtk_text_view_set_wrap_mode(tvGirl, GTK.GTK_WRAP_WORD);
                int scrollBar = 0 ;
                //添加控件
                GTK.gtk_text_view_set_editable(tvGirl, false);
                createTextviewScrollBar(scrollBar,tvGirl,gridHouse,start);
                //GTK.gtk_grid_attach(gridHouse, tvGirl, 0, start+1, 1, 1);

                //显示控件

                GTK.gtk_widget_show(tvGirl);

                String loveWords = &amp;quot;if(!GTK.gtk_tree_model_get_iter_first(liststore.listiter))&amp;quot;
                                + &amp;quot;\n{\n\tSystem.out.println(\&amp;quot;100块钱都不给，真坏！\&amp;quot;);\n}\nelse\n{\n\tdo&amp;quot;
                                + &amp;quot;\n\t{\n\t\tSystem.out.println(\&amp;quot;我在do循环里面\&amp;quot;);\n\t}while(GTK.gtk_tree_model_iter_next(liststore, iter));&amp;quot;
                                + &amp;quot;\n}\nGTK.gtk_text_iter_free(iter);&amp;quot;;
                //读取文本框里面的内容 ，只适用小量的文本，一般用迭代器
                //方法1   先从TextView获取int TextBuffer 
                    //    然后再从TextBuffer获取text
                final int textbuffer= GTK.gtk_text_view_get_buffer(tvGirl);

                
                //可以直接通过缓冲区编号  设置信息
                GTK.gtk_text_buffer_set_text(textbuffer, loveWords);
                
                
        }
        /**
         * 
         * @param window     窗口对象标识（可省略）
         * @param gridHouse  网格对象标识
         * @param start      网格对象的起始位置标识
         * @param tvGirl     treeview对象标识
         * @purpose          创建一个TextView对象标识，加入滚动条，并显示。
         */
        public static void createOutputTextView(int window, int gridHouse, int start,int tvGirl)
        {

                //tvGirl = GTK.gtk_text_view_new();
                GTK.gtk_text_view_set_wrap_mode(tvGirl, GTK.GTK_WRAP_WORD);
                int scrollBar = 0 ;
                //添加控件
                GTK.gtk_text_view_set_editable(tvGirl, false);
                createTreeviewOutputScrollBar(scrollBar,tvGirl,gridHouse,start);
                //GTK.gtk_grid_attach(gridHouse, tvGirl, 0, start+1, 1, 1);

                //显示控件

                GTK.gtk_widget_show(tvGirl);

                String loveWords = &amp;quot;&amp;quot;;
                //读取文本框里面的内容 ，只适用小量的文本，一般用迭代器
                //方法1   先从TextView获取int TextBuffer 
                    //    然后再从TextBuffer获取text
                final int textbuffer= GTK.gtk_text_view_get_buffer(tvGirl);

                
                //可以直接通过缓冲区编号  设置信息
                GTK.gtk_text_buffer_set_text(textbuffer, loveWords);
                
                
        }
        /**
         * 
         * @param gridHouse  网格对象标识
         * @param start      网格对象的起始位置标识
         * @purpose          创建一个TreeView对象标识，写入字段，添加记录，加入滚动条，并显示。
         */
        public static void createSingleTreeView(int gridHouse,int start)
        {
                //3  treeview   是一个界面，相当于是一个淘宝前台， V  V的作用
                                treeViewApple = GTK.gtk_tree_view_new();
                                //4 建立字段  比较费劲
                                //4.1创建字段
                                int columnID = GTK.gtk_tree_view_column_new_with_attributes(&amp;quot;ID&amp;quot;, GTK.gtk_cell_renderer_text_new(), 0);
                                //4.2添加字段
                                GTK.gtk_tree_view_append_column(treeViewApple, columnID);
                                //4.3创建字段
                                int columnName = GTK.gtk_tree_view_column_new_with_attributes(&amp;quot;Names&amp;quot;,GTK.gtk_cell_renderer_text_new(),1);
                                //4.4添加字段
                                GTK.gtk_tree_view_append_column(treeViewApple,columnName);
                                //4.5创建字段
                                int  columnAge = GTK.gtk_tree_view_column_new_with_attributes(&amp;quot;Ages&amp;quot;,GTK.gtk_cell_renderer_text_new(),2);
                                GTK.gtk_tree_view_append_column(treeViewApple,columnAge);
                                
                                //创建控件
                                //1  list_store  是一个数据结构库，相当于一个仓库  M model的作用
                                liststore = GTK.gtk_list_store_new(3); //3代表三个字段：ID  Names   Age
                        //        GTK.gtk_list_store_append(list_store, iter);
                                //2  list_iter,list_iter是一个内部的数据迭代的控制过程，不需要显示 C的作用，控制
                                listiter = GTK.gtk_tree_iter_new();

                                //5  第五步 把 iter和listStore联系起来
                                          //GTK.gtk_text_buffer_get_end_iter 类似于treeview的buffer和iter联系起来
                                           // 以后就可以通过GTK.gtk_text_buffer_insert默认是一个一个iter的执行。
                                GTK.gtk_list_store_append(liststore, listiter); //指针开始指到第一个位置
                                // 6 逐个iter添加数据到liststore当中:每个iter的意思，就是逐行或者逐个记录。
                                GTK.gtk_list_store_set_value(liststore, listiter, 0, &amp;quot;001&amp;quot;);
                                GTK.gtk_list_store_set_value(liststore, listiter, 1, &amp;quot;YinMuHuaDao&amp;quot;);
                                GTK.gtk_list_store_set_value(liststore, listiter, 2, &amp;quot;35&amp;quot;);
                                GTK.gtk_list_store_append(liststore, listiter); //如果不加入，指针不下移，只会覆盖掉前面的数据
                                GTK.gtk_list_store_set_value(liststore, listiter, 0, &amp;quot;002&amp;quot;);
                                GTK.gtk_list_store_set_value(liststore, listiter, 1, &amp;quot;Taiyanghua&amp;quot;);
                                GTK.gtk_list_store_set_value(liststore, listiter, 2, &amp;quot;29&amp;quot;);
                                GTK.gtk_list_store_append(liststore, listiter);
                                GTK.gtk_list_store_set_value(liststore, listiter, 0 ,&amp;quot;003&amp;quot;);
                                GTK.gtk_list_store_set_value(liststore, listiter, 1 ,&amp;quot;Xiaojun&amp;quot;);
                                GTK.gtk_list_store_set_value(liststore, listiter, 2 ,&amp;quot;10&amp;quot;);
                                // 之所以添加9次是因为  3个字段*3条记录 == 9
                                
                                //7  使用完iter之后一定要记得 关掉它
                                GTK.gtk_tree_iter_free(listiter);
                                
                                //8 关键的一步，把数字显示出来
                                GTK.gtk_tree_view_set_model(treeViewApple, liststore);

                                //并同时把它显示出来，前台必须显示
                                GTK.gtk_widget_show(treeViewApple);
                                
                                //添加到滚动条中
                                int scrolledbar2 = 0;
                                createTreeviewScrollBar(scrolledbar2,treeViewApple,gridHouse,start);
                                
                                //设置部分参数
                                int column =GTK.gtk_tree_view_get_column(treeViewApple, 1);
                                GTK.gtk_tree_view_column_set_sort_column_id(column, 1);
                                GTK.gtk_tree_view_column_set_resizable(column, true);
                                GTK.gtk_tree_view_column_set_reorderable(column, true);
        }
        
        /**
         * 
         * @param window          窗口的对象标识
         * @param gridHouse       网格布局的对象标识
         * @param start           对象所在的网格布局起始位置
         * @param circlePointx    画笔的x轴位置
         * @param circlePointy    画笔的y轴位置
         * @purpose               绘制一个笑脸
         */
        public static void createDrawLaughFace(int window,int gridHouse,int start,final int circlePointx,final int circlePointy) 
        {
                //创建画图板 或者叫画布
                int dan  = GTK.gtk_drawing_area_new();
                
                //创建源
                //添加控件
                start = 0;
                GTK.gtk_grid_attach(gridHouse, dan, 1, start, 1, 1);
                //显示画布
                GTK.gtk_widget_show(dan);
                

                
                //设置画布的大小
                GTK.gtk_widget_set_size_request(dan, 300, 300);
                
                
                //开始绘制  利用事件draw 来不断的绘制
                
                GTK.g_signal_connect(dan, &amp;quot;draw&amp;quot;,new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //eventDate才是画布源
                                //设置画笔的颜色
                                //Cairo.cairo_destroy(eventData);
                                Cairo.cairo_set_source_rgb(eventData, 1, 0, 0);
                                //设置画笔的大小
                                Cairo.cairo_set_line_width(eventData, 3);                        
                                Cairo.cairo_move_to(eventData, circlePointx-20, circlePointy);
                                Cairo.cairo_line_to(eventData, circlePointx-70, circlePointy);
                                Cairo.cairo_line_to(eventData, circlePointx-60, circlePointy-5);
                                Cairo.cairo_move_to(eventData, circlePointx-70, circlePointy);
                                Cairo.cairo_line_to(eventData, circlePointx-60, circlePointy+5);
                                Cairo.cairo_stroke(eventData);
                                
                                //画一个圆
                                Cairo.cairo_arc(eventData, circlePointx, circlePointy, 10, 0, 2*3.1415926);
                                //画一个圆弧
                                //Cairo.cairo_arc(eventData, 200, 200, 70,1.5*3.1415925, 2*3.1415926);
                                //显示画笔
                                Cairo.cairo_stroke(eventData); //Cairo.cairo_fill(eventData)不同的效果
                                
                                
                                //画一个圆弧  有下面实验知道是从x轴沿顺时针开始画图

                                //嘴巴的绘制
                                double Pi = 3.1415926;
                                Cairo.cairo_arc(eventData, circlePointx, circlePointy, 5, 0.25*Pi, 0.75*Pi);
                                Cairo.cairo_fill(eventData);
                                
                                //绘制两只眼睛
                                Cairo.cairo_arc(eventData, circlePointx-5, circlePointy-5, 3, 0, 2*Pi);
                                Cairo.cairo_arc(eventData, circlePointx+5, circlePointy-5, 3, 0, 2*Pi);
                                Cairo.cairo_fill(eventData);
                                
                                

                                //画文字
                                Cairo.cairo_move_to(eventData, circlePointx+10, circlePointy+5);
                                Cairo.cairo_set_source_rgb(eventData, 0.4, 0.3, 0.2);
                                Cairo.cairo_set_font_size(eventData, 16);
                                //选择文字类型
                                Cairo.cairo_select_font_face(eventData, &amp;quot;宋体&amp;quot;, Cairo.CAIRO_FONT_SLANT_ITALIC, Cairo.CAIRO_FONT_WEIGHT_BOLD);
                                Cairo.cairo_show_text(eventData,note);
                                //Cairo.cairo_stroke(eventData);  //不需要这句话也可以
                                
                        }
                }, null);
                
                
        }
        /**
         * 
         * @param window          窗口的对象标识
         * @param gridHouse       网格布局的对象标识
         * @param start           矩形对象所在的网格布局起始位置
         * @param circlePointx    画笔的x轴位置
         * @param circlePointy    画笔的y轴位置
         * @purpose               绘制一个矩形图像
         */
        public static void createRectangleFace(int window,int gridHouse,int start,final int circlePointx,final int circlePointy) 
        {
                //创建画图板 或者叫画布
                int dan  = GTK.gtk_drawing_area_new();
                
                //创建源
                //添加控件
                start = 4;
                GTK.gtk_grid_attach(gridHouse, dan, 0, start, 1, 1);
                //显示画布
                GTK.gtk_widget_show(dan);
                

                
                //设置画布的大小
                GTK.gtk_widget_set_size_request(dan, 300, 300);
                
                
                //开始绘制  利用事件draw 来不断的绘制
                
                GTK.g_signal_connect(dan, &amp;quot;draw&amp;quot;,new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //eventDate才是画布源
                                //设置画笔的颜色
                                //Cairo.cairo_destroy(eventData);
                                Cairo.cairo_set_source_rgb(eventData, 0, 1, 0);
                                //设置画笔的大小
                                Cairo.cairo_set_line_width(eventData, 3);                        
                                //Cairo.cairo_move_to(eventData, circlePointx-20, circlePointy);

                                
                                //画一个矩形
                                Cairo.cairo_rectangle(eventData, circleRectangex-150, circleRectangey+120, 250, 20);
                                Cairo.cairo_stroke(eventData);
                                //画文字
                                Cairo.cairo_move_to(eventData, circleRectangex+10, circleRectangey+100);
                                Cairo.cairo_set_source_rgb(eventData, 0, 0, 1);
                                Cairo.cairo_set_font_size(eventData, 18);
                                //选择文字类型
                                Cairo.cairo_select_font_face(eventData, &amp;quot;宋体&amp;quot;, Cairo.CAIRO_FONT_SLANT_NORMAL, Cairo.CAIRO_FONT_WEIGHT_BOLD);
                                Cairo.cairo_show_text(eventData,&amp;quot;循环第&amp;quot;+Integer.toString(rowPosition)+&amp;quot;次&amp;quot;);//
                                //Cairo.cairo_stroke(eventData);  //不需要这句话也可以
                                
                        }
                }, null);
                
                
        }
        /**
         * 
         * @param window          窗口的对象标识
         * @param gridHouse       网格布局的对象标识
         * @param start           矩形对象所在的网格布局起始位置
         * @param circlePointx    画笔的x轴位置
         * @param circlePointy    画笔的y轴位置
         * @purpose               绘制一个圆圈图像 + 终止表示！
         */
        public static void createCircleFace(int window,int gridHouse,int start,final int circlePointx,final int circlePointy) 
        {
                //创建画图板 或者叫画布
                int dan  = GTK.gtk_drawing_area_new();
                
                //创建源
                //添加控件
                start = 4;
                GTK.gtk_grid_attach(gridHouse, dan, 0, start, 1, 1);
                //显示画布
                GTK.gtk_widget_show(dan);
                

                
                //设置画布的大小
                GTK.gtk_widget_set_size_request(dan, 300, 300);
                
                
                //开始绘制  利用事件draw 来不断的绘制
                
                GTK.g_signal_connect(dan, &amp;quot;draw&amp;quot;,new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //eventDate才是画布源
                                //设置画笔的颜色
                                //Cairo.cairo_destroy(eventData);
                                Cairo.cairo_set_source_rgb(eventData, 1, 0, 1);
                                //设置画笔的大小
                                Cairo.cairo_set_line_width(eventData, 3);                        
                                //Cairo.cairo_move_to(eventData, circlePointx-20, circlePointy);

                                
                                //画一个矩形
                                Cairo.cairo_arc(eventData, EndCirclex+150, EndCircley+200, 100, 0, 6.28);
                                Cairo.cairo_stroke(eventData);
                                //画文字
                                Cairo.cairo_move_to(eventData, EndCirclex+50, EndCircley+200);
                                Cairo.cairo_set_source_rgb(eventData, 1, 0, 1);
                                Cairo.cairo_set_font_size(eventData, 18);
                                //选择文字类型
                                Cairo.cairo_select_font_face(eventData, &amp;quot;宋体&amp;quot;, Cairo.CAIRO_FONT_SLANT_NORMAL, Cairo.CAIRO_FONT_WEIGHT_BOLD);
                                Cairo.cairo_show_text(eventData,&amp;quot;循环第&amp;quot;+Integer.toString(rowPosition+1)+&amp;quot;次,程序终止退出！&amp;quot;);//
                                //Cairo.cairo_stroke(eventData);  //不需要这句话也可以
                                
                        }
                }, null);
                
                
        }
        /**
         * 
         * @param gridHouse         网格布局对象标识
         * @param textViewOutput    textview的对象标识
         * @param start             textview对象在网格布局的起始位置
         * @purpose                 创建一个下一步button，并添加事件监听
         */
        public static void createNextButton(int gridHouse,int textViewOutput,int start)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;下一步&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 6, start, 1, 1);
                insertNextEvent(btnApple,textViewOutput);
        }
        /**
         * 
         * @param btnSin            button下一步的对象标识
         * @param textViewOutput    textview的对象标识
         * @purpose                 建立button下一步的事件监听
         */
        public static void insertNextEvent(final int btnSin,final int textViewOutput)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                if(rowPosition &amp;lt; getNumberOfListstore(liststore))
                                {
                                        circlePointy = circlePointy+20;
                                        //创建笑脸
                                        createDrawLaughFace(window,gridHouse,start,circlePointx,circlePointy);
                                        //创建矩形框
                                        createRectangleFace(window,gridHouse,start+1,circleRectangex,circleRectangey);
                                        printRecord(liststore);
                                        InsertStringToTextViewFunction(textViewOutput,&amp;quot;我在do循环里面  \n&amp;quot;);
                                        rowPosition =  rowPosition +1;
                                }
                                else 
                                {
                                        
                                        //note = &amp;quot;指针无法下移&amp;quot;;
                                        circlePointy = circlePointy+20;
                                        if(rowPosition &amp;gt; getNumberOfListstore(liststore))
                                        {
                                                createDrawLaughFace(window,gridHouse,start,circlePointx,circlePointy);
                                        }
                                        
                                        createRectangleFace(window,gridHouse,start+1,circleRectangex,circleRectangey);
                                        createCircleFace(window,gridHouse,start,EndCirclex,EndCircley);
                                        InsertStringToTextViewFunction(textViewOutput,&amp;quot;别嗯了！程序没有数据了\n&amp;quot;);
                                        showInfo(&amp;quot;没有数据了&amp;quot;,&amp;quot;指针无法下移&amp;quot;);
                                }

                        }
                }, null);
        }
        /**
         * 
         * @param liststore   liststore是treeview的原始数据
         * @return            返回liststore的记录个数
         */
        public static int getNumberOfListstore(int liststore)
        {
                int sum = 0;
                int iter = GTK.gtk_tree_iter_new();
                if(!GTK.gtk_tree_model_get_iter_first(liststore, iter))
                {
                        return sum;
                }
                do
                {
                        sum++;
                }while(GTK.gtk_tree_model_iter_next(liststore, iter));
                return sum;
        }
        /**
         * 
         * @param liststore   liststore是treeview的原始数据
         * @purpose           打印liststore的所有内容
         */
        public static void printRecord(int liststore)
        {
                //必须新建，不能利用原先的listiter,哪边需要用控制，就需要建一个控件。！！！否则报错！！不能用全局的 listiter
                int iter = GTK.gtk_tree_iter_new();
                int i  =0;
/*                if(GTK.gtk_tree_model_get_iter_first(liststore, listiter))
                {
                        do
                        {
                                String ID = GTK.gtk_tree_model_get_value(liststore, listiter, 0);
                                String Names = GTK.gtk_tree_model_get_value(liststore, listiter, 1);
                                String Ages = GTK.gtk_tree_model_get_value(liststore, listiter, 2);
                                //showInfo(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages,&amp;quot;显示员工信息&amp;quot;);
                                System.out.println(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages);
                                
                        }while(GTK.gtk_tree_model_iter_next(liststore,listiter));
                }else
                {
                        System.out.println(&amp;quot;表中无数据&amp;quot;);
                }*/
                // 减少代码的深度。
                if(!GTK.gtk_tree_model_get_iter_first(liststore, iter))
                {
                        System.out.println(&amp;quot;treeview没有数据  请添加记录&amp;quot;);
                        return;
                }
                do
                {
                        if(rowPosition == i)
                        {
                                String ID = GTK.gtk_tree_model_get_value(liststore, iter, 0);
                                String Names = GTK.gtk_tree_model_get_value(liststore, iter, 1);
                                String Ages = GTK.gtk_tree_model_get_value(liststore, iter, 2);
                                showInfo(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages,&amp;quot;显示员工信息&amp;quot;);
                                //System.out.println(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages);
                                return;
                        }
                        i++;
                        
                }while(GTK.gtk_tree_model_iter_next(liststore,iter));
                
                GTK.gtk_tree_iter_free(iter);//释放了 还是有错误。。。
        }
        /**
         * 
         * @param message    输入一个消息，显示在消息框
         * @param title      消息框的标题
         * @purpose          创建一个消息提示对话框
         */
        public static void showInfo(  String  message,String title)
        {
                int msgDlg = GTK.gtk_message_dialog_new(0, GTK.GTK_DIALOG_DESTROY_WITH_PARENT|
                                GTK.GTK_DIALOG_MODAL,GTK.GTK_MESSAGE_INFO, GTK.GTK_BUTTONS_OK,message);
                GTK.gtk_window_set_title(msgDlg, title);
                int ret = GTK.gtk_dialog_run(msgDlg);
                 
                if( ret == GTK.GTK_RESPONSE_OK)
                {
                        GTK.gtk_widget_destroy(msgDlg);
                }else
                {
                        GTK.gtk_widget_destroy(msgDlg);
                }

        }
        
        public static void createSelection(int gridHouse,int start)
        {
                
        }
        /**
         * 
         * @param textview   textview对象标识
         * @param temp       待插入textview的字符串
         * @purpose          插入一行数据岛textview当中
         */
        public static void InsertStringToTextViewFunction(int textview,String temp)
        {
                //TextIter是一个TextView的迭代器。
                int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                int textIter = GTK.gtk_text_iter_new();  //这是一个空的iter，需要用textBuffer进行赋值
                //GTK.gtk_text_iter_forward_to_end(textIter);
                GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);// 或者textview的textBuffer的末尾！
                GTK.gtk_text_buffer_insert(textBuffer, textIter, temp);
                
                //GTK.gtk_text_buffer_g
                GTK.gtk_text_iter_free(textIter);
                
        }
        
        
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码&lt;/p&gt;
&lt;p&gt;有什么意见，欢迎交流，有什么想法，欢迎交流。~-~&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/chushi.gif&#34; alt=&#34;初始时刻&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/diyici.gif&#34; alt=&#34;运行第一次&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/chengxujiesu.gif&#34; alt=&#34;程序结束&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>网络编程8-12节笔记代码March18th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/wang-luo-bian-cheng-8-12jie-bi-ji-dai-ma-march18th/</link>
      <pubDate>Mon, 11 May 2015 14:58:46 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/wang-luo-bian-cheng-8-12jie-bi-ji-dai-ma-march18th/</guid>
      <description>&lt;p&gt;复习目录
1集合框架&amp;hellip; 2
ArrayList: 2
栈的实现（先进后出）&amp;hellip; 3
队列的实现（先进先出）&amp;hellip; 5
LinkedList: 8
小结：&amp;hellip; 10
HashSet: 10
TreeSet. 14
LinkedHashSet: 22
HashMap: 23
1.位运算符&amp;hellip; 25
2.字节的截断工具：&amp;hellip; 29
3.理解重新调整大小&amp;hellip; 39
4.理解添加&amp;hellip; 41
5.理解说明：&amp;hellip; 44
6.HashMap和HashSet的区别&amp;hellip; 44
7.理解Hash算法&amp;hellip; 45
TreeMap: 45
LinkedHashMap: 45
Iterator: 45
泛型&amp;hellip; 45
Arrays: 46
Collections: 46
多重数据结构的实现：&amp;hellip; 48
ToString. 49
2：反射机制&amp;hellip; 49
类（Class）&amp;hellip; 50
字段&amp;hellip; 51
构造函数&amp;hellip; 52
方法&amp;hellip; 53
3：内省&amp;hellip; 58
4：正则表达式&amp;hellip; 61
字符串内置函数：&amp;hellip; 61
Pattern&amp;amp;Matcher组合：&amp;hellip; 62&lt;/p&gt;
&lt;p&gt;1集合框架
集合是存储对象的对象。
用于存储数据的数据结构，重要！进行源码分析。
要求：熟练掌握增删查改（针对每一种数据结构）！块增删查改等等。并掌握每一种数据结构的本质，优缺点&lt;/p&gt;
&lt;p&gt;|&amp;ndash;Collection
|&amp;mdash;List
|&amp;mdash;&amp;mdash;-ArrayList
|&amp;mdash;&amp;mdash;-LinkedList
|&amp;mdash;&amp;mdash;-HashLinkedList
|&amp;mdash;Set
|&amp;mdash;&amp;mdash;-HashSet
|&amp;mdash;&amp;mdash;-TreeSet
|&amp;ndash;Map
|&amp;mdash;&amp;mdash;-HashMap
|&amp;mdash;&amp;mdash;-TreeMap
|&amp;mdash;&amp;mdash;-LinkedHashMap
两个工具类(默认是静态类static 方法)：
|&amp;mdash;Arrays
|&amp;mdash;Collections&lt;/p&gt;
&lt;p&gt;重点：ArrayList , LinkedList, HashMap,进行HashMap的源码追踪。&lt;/p&gt;
&lt;p&gt;ArrayList:
本质：数组，元素有序，可以重复
优点：查找(或者叫做获取get方法效率极高)和遍历
缺点：增加和删除
ArrayList和LinkedList替换掉Vector,Vector在长度不足时候是百分百增长，而前面两个是50%。至于线程的独立性可以让ArrayList和LinkedList接续Serializable&lt;/p&gt;
&lt;p&gt;Vector的方法都是同步的(Synchronized),是线程安全的(thread-safe)，而ArrayList的方法不是，由于线程的同步必然要影响性能，因此,ArrayList的性能比Vector好。
当Vector或ArrayList中的元素超过它的初始大小时,Vector会将它的容量翻倍,而ArrayList只增加50%的大小，这样,ArrayList就有利于节约内存空间
栈的实现（先进后出）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;  			
/**
*  堆栈是先进后出
*/
package com.collections.test;

/**
* @author    叶昭良
* @time      2015年2月23日下午7:47:29
* @version   com.collections.testTestStack V1.0
*/
import java.util.*;
public class TestStack
{

         /**
          * @param args
          */
         private static List&amp;lt;String&amp;gt; list1 = new ArrayList&amp;lt;String&amp;gt;();
         /**
          *
          * @param apple  添加字符串到堆栈中
          */
         public void push(String apple)
         {
                   //list1.addLast(apple);
                   //list1.addOffer(apple);
                  
                   list1.add(apple);
         }
         /**
          *
          * @return  返回待删除的字符串
          */
         public String pop()
         {
                   int length = getListLength(); //笨蛋 直接用 list1.size()就可以了
                   //System.out.println(&amp;quot;长度为：&amp;quot;+length);
                   String apple = list1.get(length-1);
                   //String apple = list1.get(length-1);
                   //第一种方法
                   //return list1.removeLast() 更方便IE
                   //第二种方法
                   //return list1.pollLast();
                   list1.remove(length-1);
                   return apple;
         }
         /**
          *  得到堆栈的长度
          * @return
          */
         private static int getListLength()
         {
                   int sum =0;
                   Iterator&amp;lt;String&amp;gt; it = list1.iterator();
                   while(it.hasNext())
                   {
                            sum++;
                            it.next();
                   }
                   return sum;
         }
        
         public  void sayStatck()
         {
                   Iterator&amp;lt;String&amp;gt; it = list1.iterator();
                   while(it.hasNext())
                   {
                            System.out.println(it.next());
                   }
         }
         public static void main(String[] args)
         {
                   // TODO Auto-generated method stub
                   TestStack ts = new TestStack();
                   ts.push(&amp;quot;apple&amp;quot;);
                   ts.push(&amp;quot;banana&amp;quot;);
                   ts.push(&amp;quot;orange&amp;quot;);
                  
                  
                   ts.sayStatck();
                   String text = ts.pop();
                   ts.sayStatck();
         }

}


  
```java
队列的实现（先进先出）
  

```java
/**
*
*/
package com.collections.test;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

/**
* @author    叶昭良
* @time      2015年2月23日下午8:07:29
* @version   com.collections.testTestQueue V1.0
*/
public class TestQueue
{

         /**
          * @param args
          */
         private static List&amp;lt;String&amp;gt; list1 = new ArrayList&amp;lt;String&amp;gt;();
         /**
          *
          * @param apple  添加字符串到堆栈中
          */
         public void push(String apple)
         {
                   list1.add(apple);
         }
         /**
          *
          * @return  返回待删除的字符串
          */
         public String pop()
         {
                   //System.out.println(&amp;quot;长度为：&amp;quot;+length);
                   String apple = list1.get(0);
                   //String apple = list1.get(length-1);
                   list1.remove(0);
                   return apple;
         }

        
         public  void sayStatck()
         {
                   Iterator&amp;lt;String&amp;gt; it = list1.iterator();
                   while(it.hasNext())
                   {
                            System.out.println(it.next());
                   }
         }
         /**
          * @param args
          */
         public static void main(String[] args)
         {
                   // TODO Auto-generated method stub
                   // TODO Auto-generated method stub
                   TestQueue ts = new TestQueue();
                   ts.push(&amp;quot;apple&amp;quot;);
                   ts.push(&amp;quot;banana&amp;quot;);
                   ts.push(&amp;quot;orange&amp;quot;);
                  
                  
                   ts.sayStatck();
                   String text = ts.pop();
                   System.out.println(&amp;quot;Pop值：&amp;quot;+text);
                   ts.sayStatck();
                  
                   String text1 = ts.pop();
                   System.out.println(&amp;quot;Pop值：&amp;quot;+text1);
                   ts.sayStatck();
         }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ArrayList源码追踪部分：&lt;/p&gt;
&lt;p&gt;调查ArrayList发现了LastIndexOf的一个秒的地方，倒着过来找&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public int lastIndexOf(Object o) {
      if (o == null) {
          for (int i = size-1; i &amp;gt;= 0; i--)
              if (elementData==null)
                  return i;
      } else {
          for (int i = size-1; i &amp;gt;= 0; i--) //秒！
              if (o.equals(elementData))
                  return i;
      }
      return -1;
  }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下面的ArrayList.this.add真的是值得学习&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void add(E e) {
           checkForComodification();

           try {
               int i = cursor;
               ArrayList.this.add(i, e);
               cursor = i + 1;
               lastRet = -1;
               expectedModCount = modCount;
           } catch (IndexOutOfBoundsException ex) {
               throw new ConcurrentModificationException();
           }
       }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样的话 会直接定义到本类的add方法，而不会是别的&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt; 
public void add(int index, E element) {
     rangeCheckForAdd(index);

     ensureCapacityInternal(size + 1);  // Increments modCount!!
     System.arraycopy(elementData, index, elementData, index + 1,
                      size - index);
     elementData[index] = element;
     size++;
 }


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;LinkedList:
本质：链表，有序，可以重复
优点：增加和删除
缺点：查找（获取）&lt;/p&gt;
&lt;p&gt;ListIterator的常用方法：&lt;/p&gt;
&lt;p&gt;boolean    hasNext( )   //判断是否还要下一个元素&lt;/p&gt;
&lt;p&gt;Object      next( )   //取出下一个元素,并把指针移动到下一个元素&lt;/p&gt;
&lt;p&gt;int           nextIndex( )   //下一个元素的索引&lt;/p&gt;
&lt;p&gt;boolean    hasPrevious()   //判断是否有前一个元素&lt;/p&gt;
&lt;p&gt;Object      previous( )   //取出前一个元素,并把指针移动到前一个元素&lt;/p&gt;
&lt;p&gt;int           previousIndex( )   //前一个元素的索引&lt;/p&gt;
&lt;p&gt;void        add(Object   o)    //添加一个元素&lt;/p&gt;
&lt;p&gt;void        remove( )   //删除指针指向的当前元素&lt;/p&gt;
&lt;p&gt;void        set(Object   o)    //修改指针指向的当前元素&lt;/p&gt;
&lt;p&gt;package com.collections.test;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.util.*;

/**
* @author    叶昭良
* @time      2015年2月23日下午12:15:42
* @version   com.collections.testListTest V1.0
*/
public class ListTest
{

         /**
          * @param args
          */
         public static void main(String[] args)
         {
                   // TODO Auto-generated method stub
//               Collection c = new LinkedList();
                   /**
                    *   测试list内部有别于Collection的特有的方法
                    */
                   List&amp;lt;String&amp;gt; list1 = new ArrayList&amp;lt;String&amp;gt;();
                   list1.add(&amp;quot;abc0&amp;quot;);
                   list1.add(&amp;quot;abc1&amp;quot;);
                   list1.add(&amp;quot;abc2&amp;quot;);
                   System.out.println(list1);
                  
                   list1.add(1, &amp;quot;abchaha&amp;quot;);
                   System.out.println(list1);
                  
                   for(int i = 0 ; i &amp;lt; list1.size(); i++)
                   {
                            System.out.println(&amp;quot;list1[&amp;quot;+i+&amp;quot;]=&amp;quot;+list1.get(i));
                   }
                   for(Object o:list1)
                   {
                            System.out.println(o);
                   }
                  
                   list1.set(3, &amp;quot;fdsf&amp;quot;);
                   System.out.println(list1);
                  
                   System.out.println(&amp;quot;fdsf在list1的第&amp;quot;+list1.indexOf(&amp;quot;fdsf&amp;quot;)+&amp;quot;位&amp;quot;);
                   //最后一次abc1出现的位置
                   System.out.println(list1.lastIndexOf(&amp;quot;abc1&amp;quot;));
                   List list2 = list1.subList(1, 4);
                   System.out.println(&amp;quot;list2:&amp;quot;+list2);
                  
                   ListIterator lit = list1.listIterator();
                   while(lit.hasNext())
                   {
                            Object  o = lit.next();
                            System.out.println(&amp;quot;List:&amp;quot;+o);
                   }
         }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;小结：
1：只想遍历  就会ArrayList
2：希望不断添加   最好就是LinkedList
3：可以使用Collections.synchronizedList()获得一个线程安全的ArrayList and LinkedList&lt;/p&gt;
&lt;p&gt;HashSet:
本质：数组+链表，由entry链构成的数组，无序，不可重复。本质是HashMap
优点：添加和删除效率高
缺点：获取慢（遍历都一样）,只能遍历一遍，Set集合无法直接获取某个元素&lt;/p&gt;
&lt;p&gt;添加：1 计算hashcode
2. 根据hashcode定位到某一索引处（数组）
3. 添加值到索引处的链表（判断是否重复）&lt;/p&gt;
&lt;p&gt;所以hashset == 数组（存放hashcode）+链表（存值）（其实就是为了提高大链表的添加和遍历的速度）
HashSet的源码内部其实是HashMap&lt;/p&gt;
&lt;p&gt;1:重写hashCode and equals&lt;/p&gt;
&lt;p&gt;注意：hashCode  and equals的生成方式： 右键―&amp;gt;source&amp;mdash;&amp;gt;hashCode and equals即可自动
生成。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.collections.test;

import java.util.HashSet;
import java.util.Iterator;

/**
* @author    叶昭良
* @time      2015年2月23日下午8:35:46
* @version   com.collections.testTestHashSet V1.0
*/
public class TestHashSet
{

         /**
          * @param args
          */
         public static void main(String[] args)
         {
                   // TODO Auto-generated method stub
                   HashSet&amp;lt;String&amp;gt; hs = new HashSet&amp;lt;String&amp;gt;();
                   hs.add(&amp;quot;abc0&amp;quot;);
                   hs.add(&amp;quot;abc1&amp;quot;);
                   hs.add(&amp;quot;abc2&amp;quot;);
                   hs.add(&amp;quot;abc3&amp;quot;);
                   hs.add(&amp;quot;abc4&amp;quot;);
                   hs.add(&amp;quot;abc0&amp;quot;);
                  
                   System.out.println(hs);
                  
                   //set集合没有索引 index  所以必须用iterator
                   Iterator it = hs.iterator();
                   while(it.hasNext())
                   {
                            System.out.println(it.next());
                   }
                  
                   /**
                    * Person类的hashCode被执行
                            Person类的hashCode被执行
                            Person类的hashCode被执行
                            Person类的hashCode被执行
                            Person类的hashCode被执行
                            Person类的equals方法被执行
                    */
                   Person p1 = new Person(&amp;quot;zhao&amp;quot;,32);
                   Person p2 = new Person(&amp;quot;zhao1&amp;quot;,34);
                   Person p5 = new Person(&amp;quot;zhao1&amp;quot;,34);
                   Person p3 = new Person(&amp;quot;zhao2&amp;quot;,35);
                   Person p4 = new Person(&amp;quot;zhao3&amp;quot;,36);
                  
                   HashSet&amp;lt;Person&amp;gt; hs1 = new HashSet&amp;lt;Person&amp;gt;();
                   hs1.add(p1);
                   hs1.add(p2);
                   hs1.add(p3);
                   hs1.add(p4);
                   hs1.add(p5);
                  
                   Iterator it1 = hs1.iterator();
                   while(it1.hasNext())
                   {
                            Person p11 = (Person)it1.next();
                            //System.out.println(p11.getName()+&amp;quot;:&amp;quot;+p11.getAge());
                            System.out.println(p11);
                   }
         }

}

//自定类中加入set需要重写hashCode和equals方法   集合的不可重复性！！所以必须
//添加hashcode和equals这种比较低级的！如果是TreeSet还得考虑大小！必须是
///Comparable
class Person
{
        
         /*public int compareTo(String anotherString)
         {
                   return Name.compareTo(anotherString);
         }*/
         private int Age;
         private String Name;
        
         public Person( String name,int age)
         {
                   //super();
                   this.Age = age;
                   this.Name = name;
         }
         public int getAge()
         {
                   return this.Age;
         }
         public void setAge(int age)
         {
                   this.Age = age;
         }
         public String getName()
         {
                   return this.Name;
         }
         public void setName(String name)
         {
                   this.Name = name;
         }
         /// 右键source---》 generate equals and hashcode method
         @Override
         public int hashCode()
         {
                   System.out.println(&amp;quot;Person类的hashCode被执行&amp;quot;);
                   final int prime = 31;
                   int result = 1;
                   result = prime * result + Age;
                   result = prime * result + ((Name == null) ? 0 : Name.hashCode());
                   return result;
         }
         @Override
         public boolean equals(Object obj)
         {
                   System.out.println(&amp;quot;Person类的equals方法被执行&amp;quot;);
                   if (this == obj)
                            return true;
                   if (obj == null)
                            return false;
                   if (getClass() != obj.getClass())
                            return false;
                   Person other = (Person) obj;
                   if (Age != other.Age)
                            return false;
                   if (Name == null)
                   {
                            if (other.Name != null)
                                     return false;
                   } else if (!Name.equals(other.Name))
                            return false;
                   return true;
         }
         @Override
         public String toString()
         {
                   return &amp;quot;Person [Age=&amp;quot; + Age + &amp;quot;, Name=&amp;quot; + Name + &amp;quot;]&amp;quot;;
         }                
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;TreeSet&lt;/p&gt;
&lt;p&gt;本质：二叉树，注意查看root节点（这是二叉树结构的标志）  TreeSet关键是排序！（不是插入 和获取元素）
优点：增加和删除
缺点：获取&lt;/p&gt;
&lt;p&gt;TreeSet右节点值大于父节点    左节点值小于父节点,根据这种推断，最小的是存在于左边的最下边！ 利用递归推断。&lt;/p&gt;
&lt;p&gt;1:重写equals  and  hashcode
2:实现一个comparable接口或者一个Comparator类&lt;/p&gt;
&lt;p&gt;第一种方法：实现comparable接口&lt;/p&gt;
&lt;p&gt;只需要在Person类中增加implements comparable并重写compareTo(Object o)接口即可：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;class Person implements Comparable
{
   
    /*public int compareTo(String anotherString)
    {
       return Name.compareTo(anotherString);
    }*/
    private int Age;
    private String Name;
   
    public Person( String name,int age)
    {
       //super();
       this.Age = age;
       this.Name = name;
    }
    public int getAge()
    {
       return this.Age;
    }
    public void setAge(int age)
    {
       this.Age = age;
    }
    public String getName()
    {
       return this.Name;
    }
    public void setName(String name)
    {
       this.Name = name;
    }
    /// 右键source---》 generate equals and hashcode method
    @Override
    public int hashCode()
    {
       System.out.println(&amp;quot;Person类的hashCode被执行&amp;quot;);
       final int prime = 31;
       int result = 1;
       result = prime * result + Age;
       result = prime * result + ((Name == null) ? 0 : Name.hashCode());
       return result;
    }
    @Override
    public boolean equals(Object obj)
    {
       System.out.println(&amp;quot;Person类的equals方法被执行&amp;quot;);
       if (this == obj)
           return true;
       if (obj == null)
           return false;
       if (getClass() != obj.getClass())
           return false;
       Person other = (Person) obj;
       if (Age != other.Age)
           return false;
       if (Name == null)
       {
           if (other.Name != null)
              return false;
       } else if (!Name.equals(other.Name))
           return false;
       return true;
    }
    @Override
    public String toString()
    {
       return &amp;quot;Person [Age=&amp;quot; + Age + &amp;quot;, Name=&amp;quot; + Name + &amp;quot;]&amp;quot;;
    }
    @Override
    public int compareTo(Object o)
    {
       // TODO Auto-generated method stub
       //按照年龄进行排序
       if(this == o)
       {
           return 0;
       }
       if(this == null)
       {
           return -1;
       }
       if(!(o instanceof Person))
       {
           return -1;
       }
      
       Person p1 = (Person)o;
       //先按照年龄排序
       int temp = p1.Age - this.Age;
      
       if(temp ==0)
       {
           if(this.Name == null)
           {
              if(p1.Name == null)
              {
                  return 0;
              }else
              {
                  return -1;
              }
           }else
           {
              return this.Name.compareTo(p1.Name);
           }
       }
       return 0;
    }
      
}


//第二种方法创建一个比较类，并返回一个比较器，在TreeSet的对象定义中使用

  
class Comparators
{
    public Comparator getComparator()
    {
       return new Comparator()
       {

           // 0 表示  o1  o2相等
           // 负数 表示  o1 &amp;lt; o2
           // 整数 表示  o1 &amp;gt; o2
           @Override
           public int compare(Object o1, Object o2)
           {
              if(o1 instanceof String)
              {
                  //字符串的比较
                  return compare((String) o1,(String) o2);
              }else if(o1 instanceof Integer)
              {
                  //整数的比较
                  return compare((Integer) o1,(Integer) o2);
              }else if(o1 instanceof Boolean)
              {
                  //布尔类型的比较
                  return compare((Boolean) o1,(Boolean) o2);
              }else if(o1 instanceof Person)
              {
                  //布尔类型的比较
                  return compare((Person) o1,(Person) o2);
              }else
              {
                  System.out.println(&amp;quot;未找到合适的比较器  &amp;quot;);
                  return 1; //默认大于0
              }
           }
           //用于比较字符串
           public int compare(String o1, String o2)
           {
              //暂时备份一下 字符串
              String s1 = (String)o1;
              String s2 = (String)o2;
              //获取字符串的长度
              int len1 = s1.length();
              int len2 = s2.length();
              //获取最小值
              int n = Math.min(len1, len2);
              //转化为字符数组
              char[] v1 = s1.toCharArray();
              char[] v2 = s2.toCharArray();
             
              //设置位置参数
              int pos = 0;
             
              //从未到头  按照index下表从头到尾进行判断
              while(n-- != 0)
              {
                  char c1 = v1[pos];
                  char c2 = v2[pos];
                  if(c1 != c2)
                  {
                     return c1 - c2;
                  }
                  pos++;
              }
              return len1-len2; //相反则是反序 降序
           }
           //用于比较整数
           public int compare(Integer o1, Integer o2)
           {
              int val1 = o1.intValue();
              int val2 = o2.intValue();
              //return (val1 &amp;lt; val2 ? -1 :(val1 == val2 ? 0 : 1));
//            return (val1 &amp;gt; val2 ? 1 :(val1 == val2 ? 0 : -1));
              //升序
              //return (val2 &amp;gt; val1 ? -1 :(val1 == val2 ? 0 : 1));
              //降序
              return (val2 &amp;gt; val1 ? 1 :(val1 == val2 ? 0 : -1));
           }
           //用于比较布尔值
           public int compare(Boolean o1,Boolean o2)
           {
              return (o1.equals(o2)? 0: (o1.booleanValue()==true)?1:-1);
           }
          
           public int compare(final Person o1, final Person o2)
           {
              String Name1 = o1.getName();
              String Name2 = o2.getName();
              int Age1 = o1.getAge();
              int Age2 = o2.getAge();
              Boolean sex1 = o1.getSex();
              Boolean sex2 = o2.getSex();
              /*//第一次 线比较年龄
              return (compare(Age1,Age2)==0?
                     //第二次比较名字
                     (compare(Name1,Name2)==0?
                            //第三次比较性别
                            (compare(sex1,sex2)==0? 0 :compare(sex1,sex2)):
                                compare(Name1,Name2)):
                                   compare(Age1,Age2));*/
              //第一次  比较年龄
              return (compare(Name1,Name2)==0?
                     //第二次比较 岁数
                     (compare(Age1,Age2)==0?
                            //第三次比较岁数
                            (compare(sex1,sex2)==0?0:compare(sex1,sex2)):
                                compare(Age1,Age2)):
                                   compare(Name1,Name2));
                    
           }
       };
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;并在TreeSet定义对象时候，采用如下方式：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//TreeSet&amp;lt;Person&amp;gt; ts2 = new TreeSet&amp;lt;Person&amp;gt;(); //找到解决办法了
     TreeSet&amp;lt;Person&amp;gt; ts2 = new TreeSet&amp;lt;Person&amp;gt;(new Comparators().getComparator());

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;比较之前的&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;TreeSet&amp;lt;Person1&amp;gt; ts1 = new TreeSet&amp;lt;Person1&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外此种方法也运用在Arrays.Sort当中：其中pdian 是一个person的数组&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Person[] pdian = new Person[]
            {
                new Person(&amp;quot;yezhao&amp;quot;,34,Boolean.TRUE),
                new Person(&amp;quot;xinran&amp;quot;,10,Boolean.FALSE),
                new Person(&amp;quot;zhaoliang&amp;quot;,33,Boolean.TRUE),
                new Person(&amp;quot;zhaidc&amp;quot;,30,Boolean.FALSE),
                new Person(&amp;quot;zhaidc&amp;quot;,31,Boolean.FALSE),
            };
Arrays.sort(pdian, new Comparators().getComparator());

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外的可以通过匿名类来实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Arrays.sort(pdian, new Comparator&amp;lt;Object&amp;gt;()
     {
         // 0 表示  o1  o2相等
         // 负数 表示  o1 &amp;lt; o2
         // 整数 表示  o1 &amp;gt; o2
         @Override
         public int compare(Object o1, Object o2)
         {
            if(o1 instanceof String)
            {
                //字符串的比较
                return compare((String) o1,(String) o2);
            }else if(o1 instanceof Integer)
            {
                //整数的比较
                return compare((Integer) o1,(Integer) o2);
            }else if(o1 instanceof Boolean)
            {
                //布尔类型的比较
                return compare((Boolean) o1,(Boolean) o2);
            }else if(o1 instanceof PersonMan)
            {
                //布尔类型的比较
                return compare((PersonMan) o1,(PersonMan) o2);
            }else
            {
                System.out.println(&amp;quot;未找到合适的比较器  &amp;quot;);
                return 1; //默认大于0
            }
         }
         //用于比较字符串
         public int compare(String o1, String o2)
         {
            //暂时备份一下 字符串
            String s1 = (String)o1;
            String s2 = (String)o2;
            //获取字符串的长度
            int len1 = s1.length();
            int len2 = s2.length();
            //获取最小值
            int n = Math.min(len1, len2);
            //转化为字符数组
            char[] v1 = s1.toCharArray();
            char[] v2 = s2.toCharArray();
           
            //设置位置参数
            int pos = 0;
           
            //从未到头  按照index下表从头到尾进行判断
            while(n-- != 0)
            {
                char c1 = v1[pos];
                char c2 = v2[pos];
                if(c1 != c2)
                {
                   return c1 - c2;
                }
                pos++;
            }
            return len1-len2; //相反则是反序 降序
         }
         //用于比较整数
         public int compare(Integer o1, Integer o2)
         {
            int val1 = o1.intValue();
            int val2 = o2.intValue();
            //return (val1 &amp;lt; val2 ? -1 :(val1 == val2 ? 0 : 1));
//                       return (val1 &amp;gt; val2 ? 1 :(val1 == val2 ? 0 : -1));
            //升序
            //return (val2 &amp;gt; val1 ? -1 :(val1 == val2 ? 0 : 1));
            //降序
            return (val2 &amp;gt; val1 ? -1 :(val1 == val2 ? 0 : 1));
         }
         //用于比较布尔值
         public int compare(Boolean o1,Boolean o2)
         {
            return (o1.equals(o2)? 0: (o1.booleanValue()==true)?1:-1);
         }
        
         public int compare(final PersonMan o1, final PersonMan o2)
         {
            String Name1 = o1.getName();
            String Name2 = o2.getName();
            int Age1 = o1.getAge();
            int Age2 = o2.getAge();
            Boolean sex1 = o1.getSex();
            Boolean sex2 = o2.getSex();
            /*//第一次 线比较年龄
            return (compare(Age1,Age2)==0?
                   //第二次比较名字
                   (compare(Name1,Name2)==0?
                          //第三次比较性别
                          (compare(sex1,sex2)==0? 0 :compare(sex1,sex2)):
                              compare(Name1,Name2)):
                                 compare(Age1,Age2));*/
            //第一次  比较年龄
            return (compare(Name1,Name2)==0?
                   //第二次比较 岁数
                   (compare(Age1,Age2)==0?
                          //第三次比较岁数
                          (compare(sex1,sex2)==0?0:compare(sex1,sex2)):
                              compare(Age1,Age2)):
                                 compare(Name1,Name2));
                  
         }
     });


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;LinkedHashSet:
本质：链表+ 有序
优点：增加和删除
缺点：查找（获取）
Linkedlist也是有序但是可重复
LinkedHashSet 不可重复！
hashSet的高效率，但是无须！
LinkedHashSet可以当做HashSet来使用&lt;/p&gt;
&lt;p&gt;Map集合基本操作：&lt;/p&gt;
&lt;p&gt;l   添加&lt;/p&gt;
&lt;p&gt;V         put(K key, V value)  //把一个键值对存入map集合中&lt;/p&gt;
&lt;p&gt;void    putAll(Map&amp;lt;? extends K,? extends V&amp;gt; m) //把一组键值对存入到map集合中&lt;/p&gt;
&lt;p&gt;l   删除&lt;/p&gt;
&lt;p&gt;V         remove(Object key)  //删除key为指定对象的键值对&lt;/p&gt;
&lt;p&gt;void    clear()    //情况map中的所有元素&lt;/p&gt;
&lt;p&gt;l   判断&lt;/p&gt;
&lt;p&gt;boolean     containsKey(Object key)  //判断是否包含key为指定对象的键值对&lt;/p&gt;
&lt;p&gt;boolean     containsValue(Object value) //判断是否包含value为指定对象的元素&lt;/p&gt;
&lt;p&gt;boolean     isEmpty() //判断map集合是否包含元素&lt;/p&gt;
&lt;p&gt;l   获取&lt;/p&gt;
&lt;p&gt;V                                        get(Object key) //获得指定key对应的value&lt;/p&gt;
&lt;p&gt;Set&lt;K&gt;                              keySet() //获得所有key组成的Set集合&lt;/p&gt;
&lt;p&gt;Collection&lt;V&gt;                   values()  //获得所有value组成的Set集合&lt;/p&gt;
&lt;p&gt;Set&amp;lt;Map.Entry&amp;lt;K,V&amp;raquo;     entrySet() //获得所有键值对对象组成的Set集合&lt;/p&gt;
&lt;p&gt;int                                     size()  //获得map集合的大小(存了多少元素)&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>mysql2月15日Java班作业笔记</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/mysql2yue-15ri-javaban-zuo-ye-bi-ji/</link>
      <pubDate>Mon, 11 May 2015 14:58:45 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/mysql2yue-15ri-javaban-zuo-ye-bi-ji/</guid>
      <description>&lt;p&gt;1、MYSQL官方版下载地址（不推荐初学者使用）：http://www.mysql.com/downloads/
如鹏网版绿色免安装版MYSQL（推荐初学者使用）：http://pan.baidu.com/s/1c0COfGc
2、 常用概念
一般我们说的数据库是指DBMS，数据库管理系统，比如“你用了什么数据库”，“你会用什么数据库”,”你把数据库删了”。前两个是DBMS，第三个是指的是真实的数据
库（database）：众多事物的集合
表(table)：就是一类事物的集合
列(column)：某类事物的具体的字段。也叫做字段。&lt;/p&gt;
&lt;p&gt;3.解压后运行 mysql文件夹下的mysqld.exe,启动mysql服务器
4.运行mysql
C:\mysql\bin&amp;gt;mysql-uroot –proot
复制代码&lt;/p&gt;
&lt;p&gt;5:显示当前所有的仓库&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema|
| customer           |
| mysql              |
| performance_schema|
| study              |
| t_employees        |
+--------------------+
6 rows in set (0.39sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6：创建了一个database&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create database test;
Query OK, 1 rowaffected (0.10 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7:真的有了test&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema|
| customer           |
| mysql              |
| performance_schema|
| study              |
| t_employees        |
| test               |
+--------------------+
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;8：使用test库&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; use test;
Database changed
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;9：显示表格，一个表格都没有&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show tables;
Empty set (0.04 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;10：创建表格
主键：primary key 一般一张表一个主键，且该主键一般是没有任何的物理意义或者业务意义的数字，比如身份证ID
Auto_increment:自增长的好处，是可以不必设置该列的值，自动增长（自动增长的步数一般为1，也可以更改，show variables like ‘%auto_inc%’查询如何设置。）
Engine:一把是设置为innodb，也可以有其他的比如myisam，memory等
Not null：是比较好的设计表的方式，据说可以加快表的索引速度，表示非空&lt;/p&gt;
&lt;p&gt;Default:  默认 表示默认值 一般是default value;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table apple(
    -&amp;gt; id int auto_increment primary key,
    -&amp;gt; name varchar(20) not null default &#39;&#39;)engine = innodb;
Query OK, 0 rowsaffected (0.69 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;10：的确是有了一张apple表&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show tables;
+----------------+
| Tables_in_test |
+----------------+
| apple          |
+----------------+
1 row in set (0.00sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;11：查看apple表结构&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc apple;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO  | PRI | NULL    | auto_increment |
| name  | varchar(20) | NO   |    |         |                |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.09sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;类似的查看方式1：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; explain apple;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO  | PRI | NULL    | auto_increment |
| name  | varchar(20) | NO   |    |         |                |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.00sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;类似的查看方式2：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show columns from apple;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO  | PRI | NULL    | auto_increment |
| name  | varchar(20) | NO   |    |         |                |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.00sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最本质的查看表结构的方式：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show create table apple\G;
***************************1. row ***************************
       Table: apple
Create Table: CREATETABLE `apple` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(20) NOT NULL DEFAULT &#39;&#39;,
  PRIMARY KEY (`id`)
) ENGINE=InnoDBDEFAULT CHARSET=latin1
1 row in set (0.00sec)
ERROR:
No query specified
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;13插入表数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple values (1,&#39;tab&#39;),(2,&#39;ctrl&#39;),(3,&#39;shift&#39;);
Query OK, 3 rowsaffected (0.39 sec)
Records: 3  Duplicates: 0 Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;14 查看表数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select *from apple;
+----+-------+
| id | name  |
+----+-------+
|  1 | tab  |
|  2 | ctrl |
|  3 | shift |
+----+-------+
3 rows in set (0.00sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;15 插入数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple(id,name) values(4,&#39;caps&#39;);
Query OK, 1 rowaffected (0.08 sec)
mysql&amp;gt; insert intoapple values (6,&#39;tomato&#39;);
Query OK, 1 rowaffected (0.09 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么这种方式不行呢？ 正在查&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple values (&#39;tomato&#39;);
ERROR 1136 (21S01):Column count doesn&#39;t match value count at row 1
利用mysql的最佳工具help
mysql&amp;gt; helpauto_increment;
Name:&#39;AUTO_INCREMENT&#39;
Description: ….
Examples:
CREATE TABLE animals(
     id MEDIUMINT NOT NULL AUTO_INCREMENT,
     name CHAR(30) NOT NULL,
     PRIMARY KEY (id)
);
INSERT INTO animals(name) VALUES
    (&#39;dog&#39;),(&#39;cat&#39;),(&#39;penguin&#39;),
(&#39;lax&#39;),(&#39;whale&#39;),(&#39;ostrich&#39;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以解决方法是：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple (name) values(&amp;quot;backspace&amp;quot;);
Query OK, 1 rowaffected (0.10 sec)
mysql&amp;gt; select * from apple;
+----+-----------+
| id | name      |
+----+-----------+
|  1 | tab       |
|  2 | ctrl      |
|  3 | shift     |
|  4 | caps      |
|  6 | tomato    |
|  7 | backspace |
+----+-----------+
6 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;16:无意中添加了一行没有必要的数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple (name) values(&amp;quot;luanqibazhao&amp;quot;);
Query OK, 1 row affected (0.11 sec)
mysql&amp;gt; select * from apple;
+----+--------------+
| id | name         |
+----+--------------+
|  1 | tab          |
|  2 | ctrl         |
|  3 | shift        |
|  4 | caps         |
|  6 | tomato       |
|  7 | backspace    |
|  8 | luanqibazhao |
+----+--------------+
7 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;17：删掉id=8的数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; delete * from apple where id=8 andname=&amp;quot;luanqibazhao&amp;quot;;
ERROR 1064 (42000): You have an error in your SQL syntax; check themanual that
corresponds to your MySQL server version for the right syntax to usenear &#39;* fro
m apple where id=8 and name=&amp;quot;luanqibazhao&amp;quot;&#39; at line 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么不行？
查看帮助&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; help delete;
Name: &#39;DELETE&#39;
Description:
Syntax:
DELETE is a DML statement that removes rows from a table.
Single-Table Syntax
DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM tbl_name
    [PARTITION(partition_name,...)]
    [WHERE where_condition]
    [ORDER BY ...]
[LIMIT row_count]
The DELETE statement deletes rows fromtbl_name and returns the number
of deleted rows. To check the number ofdeleted rows, call the
ROW_COUNT() function describedin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;原来是语法错误&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; delete from apple where id=8 andname=&amp;quot;luanqibazhao&amp;quot;;
Query OK, 1 row affected (0.11 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;真的删掉了！&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from apple;
+----+-----------+
| id | name      |
+----+-----------+
|  1 |tab       |
|  2 |ctrl      |
|  3 |shift     |
|  4 |caps      |
|  6 |tomato    |
|  7 |backspace |
+----+-----------+
6 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;18.有时候我们还想着更新某个id的值&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; update apple set name=caps1 from id=4;
ERROR 1064 (42000): You have an error in yourSQL syntax; check the manual that
corresponds to your MySQL server version forthe right syntax to use near &#39;from
id =4&#39; at line 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么报错呢？可以使用show errors 查看报错信息类似的show warnings;&lt;/p&gt;
&lt;p&gt;查询帮助：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; help  update
Name: &#39;UPDATE&#39;
Description:
Syntax:
Single-table syntax:
UPDATE [LOW_PRIORITY] [IGNORE]table_reference
    SETcol_name1={expr1|DEFAULT} [, col_name2={expr2|DEFAULT}] ...
   [WHERE where_condition]
   [ORDER BY ...]
   [LIMIT row_count]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;帮助中显示并没有from的后缀，于是把from改为where，然后再让caps1加上单引号。
第一个错误修正加上单引号
第二个错误修正 from改为where&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; update apple set name=&#39;caps1&#39; whereid =4;
Query OK, 1 row affected (0.16 sec)
Rows matched: 1  Changed: 1 Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;到这边为止，是全套的mysql的常用基本指令，包含建库，建表，插入表数据，删除表数据，更新表数据，查询库，查询表，查询表数据。当然可能少了清空表数据（truncate table apple）删除表（drop table apple）,删除库（drop database test）&lt;/p&gt;
&lt;p&gt;有时候我们可能修改表的结构&lt;/p&gt;
&lt;p&gt;于是我们首先查询表，并增加了一个age字段，该字段是什么数据类型？　保证数据存储，并高效。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc apple;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| name  | varchar(20) | NO   |     |         |                |
+-------+-------------+------+-----+---------+----------------+
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;小姐了如下的整形数据的设计考虑：
分为两类一类是精准数值类型，另一类为非精准型
包含整数和小数&lt;/p&gt;
&lt;p&gt;TinyInt :(-128-127  或者unsigned 是  0-256)
一般用于  Age 年龄字段（树的年龄可能过大&lt;/p&gt;
&lt;p&gt;SmallInt：具体的数值范围可以用help smallint查到
一般用于技能值
ids
mediumint  一般用于   Auto_increment
Row number 行数是够的！！
行数一般也是1600行  最大的暂时有做到8亿，但是数据一大会影响
到mysql的存储问题，所以一般是分库分表
int(integer) ：
一般用于  Auto_increment
比如  money  ， salary 就够了（游戏当中的钱　通常会较大）&lt;/p&gt;
&lt;p&gt;BigInt  : 一般用于科学计算
人口数 Population&lt;/p&gt;
&lt;p&gt;精准性有一类比较特殊的DECIMAL(DEC)
DECIMAL(f,g)   f表示总的位数  g表示小数点后的位数
比如   money DECIMAL(12,2)
那么存储会消耗  整数部分：（12-2）  = 9(==4个字节 规定 ) + 1/2 =5
小数部分： 2/2 = 1
总消耗： 5+1  =6 个字节&lt;/p&gt;
&lt;p&gt;非精准型：
Float(p)
Real  p表示precise
DOUBLE PRECISE&lt;/p&gt;
&lt;p&gt;于是我们选择age 字段为tinyint即可。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table apple add age tinyint not null default 0;
Query OK, 0 rows affected (0.89 sec)
Records: 0  Duplicates: 0  Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次查询表结构&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc apple;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| name  | varchar(20) | NO   |     |         |                |
| age   | tinyint(4)  | NO   |     | 0       |                |
+-------+-------------+------+-----+---------+----------------+
3 rows in set (0.05 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;查询表数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from apple;
+----+-----------+-----+
| id | name      | age |
+----+-----------+-----+
|  1 | tab       |   0 |
|  2 | ctrl      |   0 |
|  3 | shift     |   0 |
|  4 | caps1     |   0 |
|  6 | tomato    |   0 |
|  7 | backspace |   0 |
+----+-----------+-----+
6 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;有时候我们可能修改表的结构
于是我们首先查询表，并增加了一个age字段，该字段是什么数据类型，才能保证更加高效。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc apple;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| name  | varchar(20) | NO   |     |         |                |
+-------+-------------+------+-----+---------+----------------+
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;分为两类一类是精准数值类型，另一类为非精准型&lt;/p&gt;
&lt;p&gt;包含整数和小数&lt;/p&gt;
&lt;p&gt;设计考虑：&lt;/p&gt;
&lt;p&gt;TinyInt :(-128-127  或者unsigned 是   0-256)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;       一般用于  Age  年龄字段（树的年龄可能过大
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;SmallInt：（可以查询help smallint 来查看数值范围）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     一般用于技能值

      ids
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;mediumint  一般用于    Auto_increment&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;                  Row number  行数是够的！！

                行数一般也是1600行  最大的暂时有做到8亿，但是数据一大会影响

                到mysql的存储问题，所以一般是分库分表
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;int(integer) ：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;       一般用于   Auto_increment

                比如   money   salary 就够了
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;BigInt  : 一般用于科学计算&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         人口数 Population
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;精准性有一类比较特殊的DECIMAL(DEC)&lt;/p&gt;
&lt;p&gt;DECIMAL(f,g)   f表示总的位数  g表示小数点后的位数&lt;/p&gt;
&lt;p&gt;比如    money DECIMAL(12,2)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;       那么存储会消耗  整数部分：（12-2）  =  9(==4个字节 规定 ) + 1/2 =5

                       小数部分： 2/2 = 1

                           总消耗： 5+1   =6 个字节
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;非精准型：&lt;/p&gt;
&lt;p&gt;Float(p)&lt;/p&gt;
&lt;p&gt;Real  p表示precise&lt;/p&gt;
&lt;p&gt;DOUBLE PRECISE&lt;/p&gt;
&lt;p&gt;于是我们选择age 字段为tinyint即可。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table apple add age tinyint not null default 0;
Query OK, 0 rows affected (0.89 sec)
Records: 0  Duplicates: 0  Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次查询表结构&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc apple;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| name  | varchar(20) | NO   |     |         |                |
| age   | tinyint(4)  | NO   |     | 0       |                |
+-------+-------------+------+-----+---------+----------------+
3 rows in set (0.05 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;查询结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from apple;
+----+-----------+-----+
| id | name      | age |
+----+-----------+-----+
|  1 | tab       |   0 |
|  2 | ctrl      |   0 |
|  3 | shift     |   0 |
|  4 | caps1     |   0 |
|  6 | tomato    |   0 |
|  7 | backspace |   0 |
+----+-----------+-----+
6 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;char与varchar的比较
分两个部分进行比较
1:创建表时候
2:添加表数据的时候&lt;/p&gt;
&lt;p&gt;查看help帮助信息&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; help char
Name: &#39;CHAR&#39;
Description:
[NATIONAL] CHAR[(M)] [CHARACTER SET charset_name] [COLLATE
collation_name]

A fixed-length string that is always right-padded with spaces to the
specified length when stored. M represents the column length in
characters. The range of M is 0 to 255. If M is omitted, the length is
1.

*Note*: Trailing spaces are removed when CHAR values are retrieved
unless the PAD_CHAR_TO_FULL_LENGTH SQL mode is enabled.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sql_mode的pad_char_to_full_length,这是一个特别的模式，将会在下文列出，至于M is from 0 to 255是指char(256)会报错！&lt;/p&gt;
&lt;p&gt;再次查看varchar的帮助信息&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; help varchar
Name: &#39;VARCHAR&#39;
Description:
[NATIONAL] VARCHAR(M) [CHARACTER SET charset_name] [COLLATE
collation_name]

A variable-length string. M represents the maximum column length in
characters. The range of M is 0 to 65,535. The effective maximum length
of a VARCHAR is subject to the maximum row size (65,535 bytes, which is
shared among all columns) and the character set used. For example, utf8
characters can require up to three bytes per character, so a VARCHAR
column that uses the utf8 character set can be declared to be a maximum
of 21,844 characters. See
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到最大长度为 65535，
并且在utf8字符的时候（也就是national varchar)的情况下，最大阴虚21844, 也就是national varchar(21845)会报错
21844*3 =65532（计算器）（可能还剩下3个字符，摆放需要的设置符）
说明当前我的版本的mysql 5.6的utf所占用的是三个字节，据说新版本的是4个字节的&lt;/p&gt;
&lt;p&gt;新建一个测试的orange表&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table orange(
    -&amp;gt; col1 char(6) not null default &#39;&#39;,
    -&amp;gt; col2 varchar(65510));
Query OK, 0 rows affected, 1 warning (0.55 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;习惯的查询一下表的样式&lt;/p&gt;
&lt;p&gt;新增一个varchar(100)字段做测试&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt;  alter table orange add col3 varchar(100);
ERROR 1118 (42000): Row size too large. The maximum row size for the used tabl
type, not counting BLOBs, is 65535. This includes storage overhead, check the
nual. You have to change some columns to TEXT or BLOBs
mysql&amp;gt; alter table orange add col3 varchar(100);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么？再添加varchar(100）则会一直报错.Maximum(varchar)=65535 现在使用了65510 ，再加上25呢？如果改为varcahr&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table orange add col3 varchar(100);
Query OK, 0 rows affected (0.85 sec)
Records: 0  Duplicates: 0  Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table orange add col3 varchar(22);
ERROR 1118 (42000): Row size too large. The maximum row size for the us
type, not counting BLOBs, is 65535. This includes storage overhead, che
nual. You have to change some columns to TEXT or BLOBs
mysql&amp;gt; alter table orange add col3 varchar(1);
Query OK, 0 rows affected (0.69 sec)
Records: 0  Duplicates: 0  Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一直报错！！&lt;/p&gt;
&lt;p&gt;再次显示表结构&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc orange;
+-------+----------------+------+-----+---------+-------+
| Field | Type           | Null | Key | Default | Extra |
+-------+----------------+------+-----+---------+-------+
| col1  | char(6)        | NO   |     |         |       |
| col2  | varchar(65510) | YES  |     | NULL    |       |
| col3  | varchar(1)     | YES  |     | NULL    |       |
+-------+----------------+------+-----+---------+-------+
3 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么呢？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show variables like &#39;%sql_mode%&#39;;
+---------------+-------------------+
| Variable_name | Value             |
+---------------+-------------------+
| sql_mode      | STRICT_ALL_TABLES |
+---------------+-------------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当前的sql模式是严格表模式，sql_mode变量特别重要，所以我进行了测试！假设我们现在改回去默认的空模式；&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; set sql_mode=&#39;&#39;;
Query OK, 0 rows affected (0.00 sec)
复制代码
重新创建一张香蕉表banana:
mysql&amp;gt; create table banana(
    -&amp;gt; col1 char(6),
    -&amp;gt; col2 varchar(65510));
Query OK, 0 rows affected (0.32 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表结构信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc banana;
+-------+----------------+------+-----+---------+-------+
| Field | Type           | Null | Key | Default | Extra |
+-------+----------------+------+-----+---------+-------+
| col1  | char(6)        | YES  |     | NULL    |       |
| col2  | varchar(65510) | YES  |     | NULL    |       |
+-------+----------------+------+-----+---------+-------+
2 rows in set (0.01 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;发现还是会报错的：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table banana add col3 varchar(100);
ERROR 1118 (42000): Row size too large. The maximum row size for the used tabl
type, not counting BLOBs, is 65535. This includes storage overhead, check the
nual. You have to change some columns to TEXT or BLOBs
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;终于给我报错了&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table orange add col5 char(258);
ERROR 1074 (42000): Column length too big for column &#39;col5&#39; (max = 255); use BLO
B or TEXT instead

mysql&amp;gt; alter table orange add col6 char(65537);
ERROR 1074 (42000): Column length too big for column &#39;col6&#39; (max = 255); use BLO
B or TEXT instead
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;总结varchar最大量不能超过65530.。。char不能超过256.。。
上面是一些创建char和varchar表的时候可能会出现的一些情况。
接下来测试添加数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table banana modify col2 varchar(6);
Query OK, 0 rows affected (0.81 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&amp;gt; desc banana;
+-------+------------+------+-----+---------+-------+
| Field | Type       | Null | Key | Default | Extra |
+-------+------------+------+-----+---------+-------+
| col1  | char(6)    | YES  |     | NULL    |       |
| col2  | varchar(6) | YES  |     | NULL    |       |
+-------+------------+------+-----+---------+-------+
2 rows in set (0.02 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;不是特别能够显示其中的区别：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into banana values(&#39;abc&#39;,&#39;abc&#39;);
Query OK, 1 row affected (0.04 sec)

mysql&amp;gt; select * from banana;
+--------+------+
| col1   | col2 |
+--------+------+
| abc    | abc  |
+--------+------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果加入&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select concat(col1,&#39;-&#39;),concat(col2,&#39;-&#39;) from banana;
+------------------+------------------+
| concat(col1,&#39;-&#39;) | concat(col2,&#39;-&#39;) |
+------------------+------------------+
| abc   -          | abc-             |
+------------------+------------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次比较&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select length(col1),length(col2) from banana;
+--------------+--------------+
| length(col1) | length(col2) |
+--------------+--------------+
|            6 |            3 |
+--------------+--------------+
1 row in set (0.02 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可见在sql_mode=pad_char_to_full_length的情况下，char即使赋的值是abc三个字符，该类型也会填充到6个字符
而varchar则是三个字符就三个字符
而如果sql_mode = &#39;&#39; 呢？
sql_mode =&amp;lsquo;strict_all_tables&amp;rsquo;呢？&lt;/p&gt;
&lt;p&gt;如果是sql_mode= &#39;&amp;rsquo;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; set sql_mode=&#39;&#39;;
Query OK, 0 rows affected (0.00 sec)

mysql&amp;gt; select concat(col1,&#39;-&#39;),concat(col2,&#39;-&#39;) from banana;
+------------------+------------------+
| concat(col1,&#39;-&#39;) | concat(col2,&#39;-&#39;) |
+------------------+------------------+
| abc-             | abc-             |
+------------------+------------------+
1 row in set (0.00 sec)

mysql&amp;gt; select length(col1),length(col2) from banana;
+--------------+--------------+
| length(col1) | length(col2) |
+--------------+--------------+
|            3 |            3 |
+--------------+--------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果是sql_mode=strict_all_tables?&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; set sql_mode=&#39;strict_all_tables&#39;;
Query OK, 0 rows affected (0.00 sec)

mysql&amp;gt; select concat(col1,&#39;-&#39;),concat(col2,&#39;-&#39;) from banana;
+------------------+------------------+
| concat(col1,&#39;-&#39;) | concat(col2,&#39;-&#39;) |
+------------------+------------------+
| abc-             | abc-             |
+------------------+------------------+
1 row in set (0.00 sec)

mysql&amp;gt; select length(col1),length(col2) from banana;
+--------------+--------------+
| length(col1) | length(col2) |
+--------------+--------------+
|            3 |            3 |
+--------------+--------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;好了，我们可以小结
在pad_char_to_full_length的情况下，char会自动填充到定义的字符，而varchar不会
在其他的sql_mode模式下，char和varchar感觉没有太大的区别
varchar一个表的最大长度是65535
char在一个表的最大长度是255&lt;/p&gt;
&lt;p&gt;所在在存储空间允许的情况下，尽量使用char
在需要更大的文本可以用blod或者text。&lt;/p&gt;
&lt;p&gt;字符串类型，一般使用char较多。
char
varchar
smallblod,mediumblod,longblod
smalltext,mediumtext,longtext&lt;/p&gt;
&lt;p&gt;枚举类字段的创建是为了让用户只能选取某个值范围。
创建一个枚举表进行测试&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table enum_t(
    -&amp;gt; col1 enum(&#39;F&#39;,&#39;M&#39;,&#39;UN&#39;));
Query OK, 0 rows affected (0.29 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;插入数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into enum_t values(&#39;F&#39;);
Query OK, 1 row affected (0.10 sec)

mysql&amp;gt; insert into enum_t values(&#39;M&#39;);
Query OK, 1 row affected (0.06 sec)

mysql&amp;gt; insert into enum_t values(&#39;F,M&#39;);
Query OK, 1 row affected, 1 warning (0.10 sec)

mysql&amp;gt; insert into enum_t values(&#39;UN&#39;);
Query OK, 1 row affected (0.07 sec)

mysql&amp;gt; insert into enum_t values(&#39;F,M,UN&#39;);
Query OK, 1 row affected, 1 warning (0.04 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select col1,col1+0 from enum_t;
+------+--------+
| col1 | col1+0 |
+------+--------+
| F    |      1 |
| M    |      2 |
|      |      0 |
| UN   |      3 |
|      |      0 |
+------+--------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;发现第三列和第五列的col1的字段值缺失，是因为没有在枚举类中该值！然而mysql还有另外一种类型叫做set，却是可以存在不同的情况&lt;/p&gt;
&lt;p&gt;&amp;mdash;&amp;mdash;再次返回到sql_mode有问题的那部分&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc enum_t;
+-------+--------------------+------+-----+---------+-------+
| Field | Type               | Null | Key | Default | Extra |
+-------+--------------------+------+-----+---------+-------+
| col1  | enum(&#39;F&#39;,&#39;M&#39;,&#39;UN&#39;) | YES  |     | NULL    |       |
+-------+--------------------+------+-----+---------+-------+
1 row in set (0.00 sec)

mysql&amp;gt; insert into enum_t values(&#39;a&#39;);
Query OK, 1 row affected, 1 warning (0.09 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;有警告一般是和sql_mode有关，如果是strict_all_tables一般是error&lt;/p&gt;
&lt;p&gt;&amp;mdash;让我们来看一个和enum特别像的set&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table set_t(
    -&amp;gt; col1 set(&#39;F&#39;,&#39;M&#39;,&#39;UN&#39;));
Query OK, 0 rows affected (0.25 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;插入表数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into set_t values(&#39;F&#39;);
Query OK, 1 row affected (0.07 sec)

mysql&amp;gt; insert into set_t values(&#39;M&#39;);
Query OK, 1 row affected (0.08 sec)

mysql&amp;gt; insert into set_t values(&#39;F,M&#39;);
Query OK, 1 row affected (0.08 sec)

mysql&amp;gt; insert into set_t values(&#39;UN&#39;);
Query OK, 1 row affected (0.05 sec)

mysql&amp;gt; insert into set_t values(&#39;F,M,UN&#39;);
Query OK, 1 row affected (0.07 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表数据信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select col1,col1+0 from set_t;
+--------+--------+
| col1   | col1+0 |
+--------+--------+
| F      |      1 |
| M      |      2 |
| F,M    |      3 |
| UN     |      4 |
| F,M,UN |      7 |
+--------+--------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以发现F,M虽然没有定义，但是也是可以使用！！！只要不重复都可以在set中出现，并遵循下面的计算方式：
因为在set模式下，默认存储室
F  1
M  10
UN 100
所以F,M  11
F,M,UN 111&lt;/p&gt;
&lt;p&gt;引入了二进制，于是学习了mysql特殊的一种二进制类型binary,和bit类型（bit(4) 就表示最大值为1111 也就是15）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; help binary
Name: &#39;BINARY&#39;
Description:
BINARY(M)

The BINARY type is similar to the CHAR type, but stores binary byte
strings rather than nonbinary character strings. M represents the
column length in bytes.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到binary类似于char只不过是存储二进制形式&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table binary_t(
    -&amp;gt; col1 binary(4));
Query OK, 0 rows affected (0.33 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;插入数据：超过5个字节就错误了&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc binary_t;
+-------+-----------+------+-----+---------+-------+
| Field | Type      | Null | Key | Default | Extra |
+-------+-----------+------+-----+---------+-------+
| col1  | binary(4) | YES  |     | NULL    |       |
+-------+-----------+------+-----+---------+-------+
1 row in set (0.05 sec)

mysql&amp;gt; insert into binary_t values(&#39;a&#39;);
Query OK, 1 row affected (0.07 sec)

mysql&amp;gt; insert into binary_t values(&#39;abcd&#39;);
Query OK, 1 row affected (0.07 sec)

mysql&amp;gt; insert into binary_t values(&#39;abcde&#39;);
ERROR 1406 (22001): Data too long for column &#39;col1&#39; at row 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;上述的过程类似于char，但是binary和char到底体现在哪里的区别？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from binary_t;
+------+
| col1 |
+------+
| a    |
| abcd |
+------+
2 rows in set (0.00 sec)

mysql&amp;gt; select col1=&#39;a&#39; from binary_t;
+----------+
| col1=&#39;a&#39; |
+----------+
|        0 |
|        0 |
+----------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么明明有a却是无法找到？是不是跟sql_mode有关系？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show variables like &#39;%sql_mode%&#39;;
+---------------+-------------------+
| Variable_name | Value             |
+---------------+-------------------+
| sql_mode      | STRICT_ALL_TABLES |
+---------------+-------------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;重新设置为空状态（默认一般是空的状态），再次尝试：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from binary_t;
+------+
| col1 |
+------+
| a    |
| abcd |
+------+
2 rows in set (0.00 sec)

mysql&amp;gt; select col1=&#39;a&#39; from binary_t;
+----------+
| col1=&#39;a&#39; |
+----------+
|        0 |
|        0 |
+----------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到依然不行，这就是二进制的一些小区别，不是类似于char在pad_char_to_full_length(专门针对char)
这时候需要用专门的测试方法&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select col1=&#39;a\0\0\0&#39; from binary_t;
+----------------+
| col1=&#39;a\0\0\0&#39; |
+----------------+
|              1 |
|              0 |
+----------------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以了！！因为binary是为默认加上\0\0\0 ，而char在sql=&amp;lsquo;pad_char_to_full_length&amp;rsquo;会默认加上空格。这就是一个区别，慎用，一般用char即可，
也许binary可能是存储少占空间。&lt;/p&gt;
&lt;p&gt;一个特别的数据类型Bit的用法（他是一个跟计算机的最小单元bit位有关系的）
手又痒了，必须再来个bit_t不可&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table bit_t(
    -&amp;gt; ids bit(4));
Query OK, 0 rows affected (0.20 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;ndash;bit(4) y也就是说  1111  最多是，类似地int(4)  char(4) varchar(4)  binary(4)  等有着其特殊的含义&lt;br&gt;
&amp;mdash;用严格模式测试一下&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; help int
Name: &#39;INT&#39;
Description:
INT[(M)] [UNSIGNED] [ZEROFILL]

mysql&amp;gt; insert into bit_t values(1);
Query OK, 1 row affected (0.11 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select ids,ids+0,bin(ids) from bit_t;
+------+-------+----------+
| ids  | ids+0 | bin(ids) |
+------+-------+----------+
|     |     1 | 1        |
+------+-------+----------+
1 row in set (0.05 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示二进制信息一般是使用+0进行数据隐式转换，或者用bin函数；&lt;/p&gt;
&lt;p&gt;&amp;ndash;再查一下表结构&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc bit_t;
+-------+--------+------+-----+---------+-------+
| Field | Type   | Null | Key | Default | Extra |
+-------+--------+------+-----+---------+-------+
| ids   | bit(4) | YES  |     | NULL    |       |
+-------+--------+------+-----+---------+-------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次插入表数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into bit_t values(1);
Query OK, 1 row affected (0.09 sec)

mysql&amp;gt; insert into bit_t values(0);
Query OK, 1 row affected (0.09 sec)

mysql&amp;gt; insert into bit_t values(3);
Query OK, 1 row affected (0.05 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示新的表的信息&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select ids,ids+0,bin(ids) from bit_t;
+------+-------+----------+
| ids  | ids+0 | bin(ids) |
+------+-------+----------+
|     |     1 | 1        |
|     |     1 | 1        |
|      |     0 | 0        |
|     |     3 | 11       |
+------+-------+----------+
4 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当插入数据过大则报错：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into bit_t values(16);
ERROR 1406 (22001): Data too long for column &#39;ids&#39; at row 1

mysql&amp;gt; insert into bit_t values(15);
Query OK, 1 row affected (0.11 sec)
mysql&amp;gt; select ids,ids+0,bin(ids) from bit_t;
+------+-------+----------+
| ids  | ids+0 | bin(ids) |
+------+-------+----------+
|     |     1 | 1        |
|     |     1 | 1        |
|      |     0 | 0        |
|     |     3 | 11       |
|     |    15 | 1111     |
+------+-------+----------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最大的的确是4个1111 满足了我们的愿望。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select ids,ids+0,length(bin(ids)) from bit_t;
+------+-------+------------------+
| ids  | ids+0 | length(bin(ids)) |
+------+-------+------------------+
|     |     1 |                1 |
|     |     1 |                1 |
|      |     0 |                1 |
|     |     3 |                2 |
|     |    15 |                4 |
+------+-------+------------------+
5 rows in set (0.06 sec)


mysql&amp;gt; select ids,ids+0,length(ids+0),bin(ids),length(bin(ids)) from bit_t;
+------+-------+---------------+----------+------------------+
| ids  | ids+0 | length(ids+0) | bin(ids) | length(bin(ids)) |
+------+-------+---------------+----------+------------------+
|     |     1 |             1 | 1        |                1 |
|     |     1 |             1 | 1        |                1 |
|      |     0 |             1 | 0        |                1 |
|     |     3 |             1 | 11       |                2 |
|     |    15 |             2 | 1111     |                4 |
+------+-------+---------------+----------+------------------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;&amp;ndash;不一样的插入额&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into bit_t values (4),(5),(6);
Query OK, 3 rows affected (0.03 sec)
Records: 3  Duplicates: 0  Warnings: 0

----insert into bit_t  set ids =4
mysql&amp;gt; insert into bit_t set ids=7;
Query OK, 1 row affected (0.05 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次显示新的数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select ids,ids+0,length(ids+0),bin(ids),length(bin(ids)) from bit_t;
+------+-------+---------------+----------+------------------+
| ids  | ids+0 | length(ids+0) | bin(ids) | length(bin(ids)) |
+------+-------+---------------+----------+------------------+
|     |     1 |             1 | 1        |                1 |
|     |     1 |             1 | 1        |                1 |
|      |     0 |             1 | 0        |                1 |
|     |     3 |             1 | 11       |                2 |
|     |    15 |             2 | 1111     |                4 |
|     |     4 |             1 | 100      |                3 |
|     |     5 |             1 | 101      |                3 |
|     |     6 |             1 | 110      |                3 |
|     |     7 |             1 | 111      |                3 |
+------+-------+---------------+----------+------------------+
9 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;&amp;ndash;通过bin函数进行选择&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select bin(ids) from bit_t where ids=7;
+----------+
| bin(ids) |
+----------+
| 111      |
+----------+
1 row in set (0.00 sec)

mysql&amp;gt; select bin(ids) from bit_t where bin(ids)=111;
+----------+
| bin(ids) |
+----------+
| 111      |
+----------+
1 row in set (0.00 sec)



mysql&amp;gt; delete from bit_t where bin(ids)=1;
Query OK, 2 rows affected (0.09 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示最新的数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select ids,ids+0,length(ids+0),bin(ids),length(bin(ids)) from bit_t;
+------+-------+---------------+----------+------------------+
| ids  | ids+0 | length(ids+0) | bin(ids) | length(bin(ids)) |
+------+-------+---------------+----------+------------------+
|      |     0 |             1 | 0        |                1 |
|     |     3 |             1 | 11       |                2 |
|     |    15 |             2 | 1111     |                4 |
|     |     4 |             1 | 100      |                3 |
|     |     5 |             1 | 101      |                3 |
|     |     6 |             1 | 110      |                3 |
|     |     7 |             1 | 111      |                3 |
+------+-------+---------------+----------+------------------+
7 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以  一句话：bit要注意位数和 bin函数的使用！&lt;/p&gt;
&lt;p&gt;在很多情况下，我们可能接触时间这一数据类型于是考察了查询了year,time,datetime,timestamp等信息，显示其值的范围&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; help year;
Name: &#39;YEAR&#39;
Description:
Syntax:
YEAR(date)

Returns the year for date, in the range 1000 to 9999, or 0 for the
&amp;quot;zero&amp;quot; date.

mysql&amp;gt; help Timestamp
Name: &#39;TIMESTAMP&#39;
Description:
TIMESTAMP[(fsp)]

A timestamp. The range is &#39;1970-01-01 00:00:01.000000&#39; UTC to
&#39;2038-01-19 03:14:07.999999&#39; UTC. TIMESTAMP values are stored as the

mysql&amp;gt; help datetime
Name: &#39;DATETIME&#39;
Description:
DATETIME[(fsp)]

A date and time combination. The supported range is &#39;1000-01-01
00:00:00.000000&#39; to &#39;9999-12-31 23:59:59.999999&#39;. MySQL displays

mysql&amp;gt; help date
Name: &#39;DATE&#39;
Description:
DATE

A date. The supported range is &#39;1000-01-01&#39; to &#39;9999-12-31&#39;. MySQL

mysql&amp;gt; help time
Name: &#39;TIME&#39;
Description:
TIME[(fsp)]

A time. The range is &#39;-838:59:59.000000&#39; to &#39;838:59:59.000000&#39;. MySQL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;创建一张表year_t进行测试：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table year_t(
    -&amp;gt; col1 year(2),
    -&amp;gt; col2 year(4),
    -&amp;gt; col3 year(100));
Query OK, 0 rows affected, 2 warnings (0.27 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表结构信息，发现都是year(4)的大小结构&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc year_t;
+-------+---------+------+-----+---------+-------+
| Field | Type    | Null | Key | Default | Extra |
+-------+---------+------+-----+---------+-------+
| col1  | year(4) | YES  |     | NULL    |       |
| col2  | year(4) | YES  |     | NULL    |       |
| col3  | year(4) | YES  |     | NULL    |       |
+-------+---------+------+-----+---------+-------+
3 rows in set (0.06 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;插入表信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into year_t values(77,2000,2055);
Query OK, 1 row affected (0.06 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from year_t;
+------+------+------+
| col1 | col2 | col3 |
+------+------+------+
| 1977 | 2000 | 2055 |
+------+------+------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么是1977？ 而不是2077？
查询到一个结果：
year(4)  1901-2155
year(2) 1970-2069
year     1000-9999（这种解释有点不可靠）&lt;/p&gt;
&lt;p&gt;为什么再进行desc year_t 显示的多是year(4)暂时未清除。据推测，显示有问题，基本和sql_mode相关&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show variables like &#39;%sql_mode%&#39;;
+---------------+------------------------+
| Variable_name | Value                  |
+---------------+------------------------+
| sql_mode      | NO_ENGINE_SUBSTITUTION |
+---------------+------------------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;&amp;ndash;总结sql_mode的8种风格
SET sql_mode =&#39;&#39;; &amp;mdash;default style
SET sql_mode=&amp;lsquo;PAD_CHAR_TO_FULL_LENGTH&amp;rsquo;;  &amp;ndash; 会填充到一定的长度
SET sql_mode  = &amp;lsquo;STRICT_ALL_TABLES&amp;rsquo;;  &amp;ndash; 也就是当超过最大长度 会报错而不是截断
SET sql_mode = &amp;lsquo;STRICT_ALL_TABLES,ERROR_FOR_DIVISION_BY_ZERO&amp;rsquo;;
SET sql_mode = &amp;lsquo;STRICT_ALL_TABLES, NO_ZERO_DATE,NO_ZERO_IN_DATE&amp;rsquo;;
SET sql_mode = &amp;lsquo;ALLOW_INVALID_DATES&amp;rsquo;; &amp;mdash; 允许无效的日期
SET sql_mode = &amp;lsquo;STRICT_ALL_TABLES,ALLOW_INVALID_DATES&amp;rsquo;;
SET sql_mode = ‘real_as_float’;
（real_as_float 是指默认情况real(10,2)而不能使用real(10) 因为real(10,2)其实等效于double，只有设置real_as_float之后才可以使用real(10)）&lt;/p&gt;
&lt;p&gt;改成严格模式再次尝试：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; set sql_mode=&#39;strict_all_tables&#39;;
Query OK, 0 rows affected (0.06 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次显示新的模式下的表结构信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc year_t;
+-------+---------+------+-----+---------+-------+
| Field | Type    | Null | Key | Default | Extra |
+-------+---------+------+-----+---------+-------+
| col1  | year(4) | YES  |     | NULL    |       |
| col2  | year(4) | YES  |     | NULL    |       |
| col3  | year(4) | YES  |     | NULL    |       |
+-------+---------+------+-----+---------+-------+
3 rows in set (0.05 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;设置了严格模式，发现没有任何改变。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show create table year_t\G;
*************************** 1. row ***************************
       Table: year_t
Create Table: CREATE TABLE `year_t` (
  `col1` year(4) DEFAULT NULL,
  `col2` year(4) DEFAULT NULL,
  `col3` year(4) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次查看表结构，依然无法解释，于是尝试定义为year(4)的方式，新建了另一张表year_t1&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table year_t1(
    -&amp;gt; col1 year(4),
    -&amp;gt; col2 year(4),
    -&amp;gt; col3 year(4));
Query OK, 0 rows affected (0.33 sec)

mysql&amp;gt; desc year_t1;
+-------+---------+------+-----+---------+-------+
| Field | Type    | Null | Key | Default | Extra |
+-------+---------+------+-----+---------+-------+
| col1  | year(4) | YES  |     | NULL    |       |
| col2  | year(4) | YES  |     | NULL    |       |
| col3  | year(4) | YES  |     | NULL    |       |
+-------+---------+------+-----+---------+-------+
3 rows in set (0.04 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次插入表的数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into year_t1 values(77,2000,2055);
Query OK, 1 row affected (0.05 sec)

mysql&amp;gt; select * from year_t1;
+------+------+------+
| col1 | col2 | col3 |
+------+------+------+
| 1977 | 2000 | 2055 |
+------+------+------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;依然是1977 ，遇到一个暂时无法解答的问题。到底有没有year(2) year(4)的问题？ 暂时留着！&lt;/p&gt;
&lt;p&gt;下面介绍比较常见的timestamp的使用方式：
&amp;mdash;-创建一张苹果表；&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table apple(
    -&amp;gt; timeme timestamp default current_timestamp
    -&amp;gt; on update current_timestamp,
    -&amp;gt; id smallint);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;之所以是on update current_timestamp是指当表中的某行数据更新时候，顺便会把timeme的数据更新为当前系统的最新的状态（之所以是系统最新状态，可以查看 show variables like &amp;ldquo;%time_zone%&amp;quot;;将在下文给出）&lt;/p&gt;
&lt;p&gt;&amp;mdash;-显示苹果表的信息&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc apple;
+--------+-------------+------+-----+-------------------+-----------------------
------+
| Field  | Type        | Null | Key | Default           | Extra
      |
+--------+-------------+------+-----+-------------------+-----------------------
------+
| timeme | timestamp   | NO   |     | CURRENT_TIMESTAMP | on update CURRENT_TIME
STAMP |
| id     | smallint(6) | YES  |     | NULL              |
      |
+--------+-------------+------+-----+-------------------+-----------------------
------+
2 rows in set (0.01 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;插入数据信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple values(now(),200);
Query OK, 1 row affected (0.25 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from apple;
+---------------------+------+
| timeme              | id   |
+---------------------+------+
| 2015-02-14 11:54:11 |  200 |
+---------------------+------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;&amp;mdash;-显示系统变量&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show variables like &amp;quot;%time_zone%&amp;quot;;
+------------------+--------+
| Variable_name    | Value  |
+------------------+--------+
| system_time_zone |        |
| time_zone        | SYSTEM |
+------------------+--------+
2 rows in set, 1 warning (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;&amp;mdash;&amp;ndash;显示字符集&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show character set;
+----------+-----------------------------+---------------------+--------+
| Charset  | Description                 | Default collation   | Maxlen |
+----------+-----------------------------+---------------------+--------+
| big5     | Big5 Traditional Chinese    | big5_chinese_ci     |      2 |
| dec8     | DEC West European           | dec8_swedish_ci     |      1 |
| cp850    | DOS West European           | cp850_general_ci    |      1 |
| hp8      | HP West European            | hp8_english_ci      |      1 |
| koi8r    | KOI8-R Relcom Russian       | koi8r_general_ci    |      1 |
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外附录在创建表的时候需要考虑下面的信息
&amp;mdash;&amp;mdash;在创建表的时候必须主要的字段 属性    影响存储性能（比如Not NULL)和运行效果 比如zerofill;
1: AUTO_INCREMENT    用于主键 的自动编号
2: LAST_INSERT_ID()
3: UNSIGNED          无符号（一把是int数据）
4: ZEROFILL          填充 0（一把是int数据）
5: NULL/NOT NULL     一般使用非空，增强mysql的性能（一般设置为非空属性）
6: DEFAULT value     默认值
7: CHARACTER SET     字符集&lt;/p&gt;
&lt;p&gt;添加一个null行的数据（null不知道的值，类似于java的对象。） 由于on update current_timestamp所以插入当前系统的最新时间&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple values(null,100);
Query OK, 1 row affected (0.15 sec)

mysql&amp;gt; select * from apple;
+---------------------+------+
| timeme              | id   |
+---------------------+------+
| 2015-02-14 11:54:11 |  200 |
| 2015-02-14 13:06:37 |  100 |
+---------------------+------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;默认为null时候添加  now()的值
如果添加入不合适的值（再sql_mode = &#39;&amp;rsquo; 则是警告，如果是sql_mode=&amp;lsquo;strict_all_tables&amp;rsquo;则是错误提示 errors产生）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into apple value(&amp;quot;123&amp;quot;,100);
Query OK, 1 row affected, 1 warning (0.10 sec)


mysql&amp;gt; show warnings;
+---------+------+---------------------------------------------+
| Level   | Code | Message                                     |
+---------+------+---------------------------------------------+
| Warning | 1265 | Data truncated for column &#39;timeme&#39; at row 1 |
+---------+------+---------------------------------------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;&amp;ndash;当插入的值不合适时候  则用000替换！！&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from apple;
+---------------------+------+
| timeme              | id   |
+---------------------+------+
| 2015-02-14 11:54:11 |  200 |
| 2015-02-14 13:06:37 |  100 |
| 0000-00-00 00:00:00 |  100 |
+---------------------+------+
3 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;省略过程得到新的表数据如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from apple;
+---------------------+------+
| timeme              | id   |
+---------------------+------+
| 2015-02-14 11:54:11 |  200 |
| 2015-02-14 13:06:37 |  100 |
| 0000-00-00 00:00:00 |  100 |
| 2015-02-14 13:09:20 |  400 |
| 0000-00-00 00:00:00 |  500 |
+---------------------+------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;mdash;-现在我要更新 id=500的值&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; update apple set id=600 where id=500;
Query OK, 1 row affected (0.27 sec)
Rows matched: 1  Changed: 1  Warnings: 0
mysql&amp;gt; select * from apple;
+---------------------+------+
| timeme              | id   |
+---------------------+------+
| 2015-02-14 11:54:11 |  200 |
| 2015-02-14 13:06:37 |  100 |
| 0000-00-00 00:00:00 |  100 |
| 2015-02-14 13:09:20 |  400 |
| 2015-02-14 13:10:47 |  600 |  &amp;lt;-----------------timestame的值！也跟着变化！因为on update的作用
+---------------------+------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这就是timestamp和year的部分用法。&lt;/p&gt;
&lt;p&gt;常用的show命令汇总show tables;
show databases;
show current_user();
show user();
show columns from apple; &amp;mdash;&amp;gt;显示apple表结构，类似explain 和desc
show variables like &amp;lsquo;%sql_mode%&amp;rsquo;   &amp;mdash;-&amp;gt;和显式相关，是mysql比较重要的参数
show variables like &amp;lsquo;log%&amp;rsquo;              &amp;mdash;-&amp;gt;会显示日志相关信息
show variables like &amp;lsquo;max_connect%&amp;rsquo;  &amp;mdash;-&amp;gt;显式mysql供用户的最大连接数
show variables like &amp;lsquo;%innodb%&amp;rsquo;       &amp;mdash;-&amp;gt;显式innodb相关的信息
show variables like &amp;lsquo;%data%&amp;rsquo;           &amp;mdash;-&amp;gt;显式mysql 数据的存储相关信息
show variables like &amp;lsquo;%time_zone%&amp;rsquo;  &amp;mdash;&amp;ndash;&amp;gt;显式时区相关信息
show variables like &amp;lsquo;%character%&#39;;   &amp;mdash;-&amp;gt;显式字符集和编码的相关信息
一些不常用的show variables
show variables like &amp;lsquo;%query_cache%&amp;rsquo;  &amp;mdash;-&amp;gt;查询缓存，不想深入，据说是跟优化有关，DBA选手可以深入，有一个工业标准。
show variables like &amp;lsquo;%key_buffer%&amp;rsquo;   &amp;mdash;&amp;mdash;&amp;gt;也和优化相关，也有工业标准值&lt;/p&gt;
&lt;p&gt;还有一些没想起来的，以后再写。
另外还可以显示当前系统的状态的详细值
show status;
show status like &amp;lsquo;%&amp;hellip;%&amp;rsquo;  &amp;mdash;-&amp;gt;显示某个值的信息
mysql&amp;gt; show status like &amp;lsquo;%buffer%&#39;;&lt;/p&gt;
&lt;p&gt;信息值不是特别了解。。。&lt;/p&gt;
&lt;p&gt;status 显式mysql当前库的使用情况：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; status
--------------
mysql  Ver 14.14 Distrib 5.6.20, for Win32 (x86)

Connection id:          2             连接的id
Current database:       test     当前数据库
Current user:           root@localhost    当前用户
SSL:                    Not in use             是否使用加密的ssl协议
Using delimiter:        ;          使用的终止符
Server version:         5.6.20 MySQL Community Server (GPL)
Protocol version:       10
Connection:             localhost via TCP/IP
Server characterset:    latin1
Db     characterset:    latin1            数据库的字符集
Client characterset:    gbk          客户端的字符集
Conn.  characterset:    gbk        
TCP port:               3306                      开放的端口号
Uptime:                 5 hours 20 min 1 sec    登录时间

一些当前线程信息
Threads: 1  Questions: 182  Slow queries: 0  Opens: 96  Flush tables: 1
bles: 72  Queries per second avg: 0.009
--------------
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;create database ch charset = utf8;  &amp;mdash;-&amp;gt;会改变Db characterset的值
set names utf8  &amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-&amp;gt;会改变client characerset 和Conn.characternet的值！&lt;/p&gt;
&lt;p&gt;delimiter $$   则每使用一个mysql语句必须是用$$结尾  而不是;分号结尾了！&lt;/p&gt;
&lt;p&gt;补充数据类型的分类：（摘自如鹏）
文本：&lt;/p&gt;
&lt;p&gt;CHAR(&lt;em&gt;)：最多255个字节的定长字符串，它的长度必须在创建时指定
VARCHAR(&lt;/em&gt;)：最多255（65535）个字节的可变长度字符串，它的长度必须在创建时指定
TEXT：最大长度为64K字符的变长文本
TINYTEXT：最大长度为255字符的变长文本
MEDUIMTEXT：最大长度为16K字符的变长文本
LONGTEXT：最大长度为4GB字符的变长文本&lt;/p&gt;
&lt;p&gt;整数(考虑数据取值后选择尽可能小的类型)&lt;/p&gt;
&lt;p&gt;tinyint：1字节。有符号值：-128 到127；无符号值：0到255
smallint：2字节。有符号值：-32768 到32767；无符号值：0到65535
mediumint：3字节。
int：4字节
bigint：8字节&lt;/p&gt;
&lt;p&gt;小数(需要指定长度和小数点，也就是显示宽度和小数位数)：&lt;/p&gt;
&lt;p&gt;decimal：精确存储的小数，在内部用字符串存储，适合金额等要求精确的类型。别名：NUMERIC（银行，差一点都不行！）
float：4字节，单精度。会近似存储(&lt;em&gt;)，效率比decimal高。
double：8字节，双精度。会近似存储(&lt;/em&gt;)，效率比decimal高。&lt;/p&gt;
&lt;p&gt;日期时间：&lt;/p&gt;
&lt;p&gt;DATE：4字节。范围：1000-01-01——9999-12-31
TIME：3字节。范围：-838:59:59——838:59:59
DATETIME：8字节。范围：1000-01-01 00:00:00——9999-12-31 23:59:59&lt;/p&gt;
&lt;p&gt;二进制大数据：&lt;/p&gt;
&lt;p&gt;TITYBLOB：最大长度为255字节
BLOB：最大长度为64KB
MEDIUMBLOB：最大长度为16MB
LONGBLOB：最大长度为4GB&lt;/p&gt;
&lt;p&gt;select的高级使用方式：&lt;/p&gt;
&lt;p&gt;1：聚合函数
聚合函数：其实就是统计中常用的最大值（MAX），最小值(MIN)，平均值(AVG),求和（SUM），记录统计（COUNT）等函数
mysql&amp;gt; select count(*) from apple;
mysql&amp;gt; select max(id) from apple;
复制代码
按照具体情况匹配使用&lt;/p&gt;
&lt;p&gt;2： limit 限制显示的条数
一个注意点limit是mysql独有的，必须放在最后，甚至比分组（order by）还靠后
Limit 2,4 表示从第二个记录之后的四个记录，即2,3,4,5&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from apple limit 2,4;
+----+-----------+
| id | name      |
+----+-----------+
|  3 | shift     |
|  4 | caps      |
|  6 | tomato    |
|  7 | backspace |
+----+-----------+
4 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意： 可用于网页的分页！  用于order by 之后，order by 一般用于where之后
where  &amp;hellip;
order by &amp;hellip;
limit &amp;hellip;
3 排序（order by)&lt;/p&gt;
&lt;p&gt;一般是处于select语句的末尾（适用于sqlserver mysql oracle..)&lt;/p&gt;
&lt;p&gt;这时候想要复制一张表
参考此文
1.复制表结构及数据到新表&lt;/p&gt;
&lt;p&gt;CREATE TABLE 新表
SELECT * FROM 旧表&lt;/p&gt;
&lt;p&gt;2.只复制表结构到新表&lt;/p&gt;
&lt;p&gt;CREATE TABLE 新表
SELECT * FROM 旧表 WHERE 1=2
即:让WHERE条件不成立.
方法二:(低版本的mysql不支持，mysql4.0.25 不支持，mysql5已经支持了)
CREATE TABLE 新表
LIKE 旧表&lt;/p&gt;
&lt;p&gt;3.复制旧表的数据到新表(假设两个表结构一样)&lt;/p&gt;
&lt;p&gt;INSERT INTO 新表
SELECT * FROM 旧表&lt;/p&gt;
&lt;p&gt;4.复制旧表的数据到新表(假设两个表结构不一样)&lt;/p&gt;
&lt;p&gt;INSERT INTO 新表(字段1,字段2,…….)
SELECT 字段1,字段2,…… FROM 旧表&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table b1 select * from t_students;
Query OK, 18 rows affected (0.55 sec)
Records: 18  Duplicates: 0  Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;b1就是我们测试的数据表；
删除某个字段，比如名字不想显示。参考此文
知道了可以drop column  也可以change 字段信息
MySQL添加字段：&lt;/p&gt;
&lt;p&gt;alter table &lt;code&gt;user_movement_log&lt;/code&gt;&lt;br&gt;
Add column GatewayId int not null default 0 AFTER &lt;code&gt;Regionid&lt;/code&gt; (在哪个字段后面添加)&lt;/p&gt;
&lt;p&gt;删除字段：&lt;/p&gt;
&lt;p&gt;alter table &lt;code&gt;user_movement_log&lt;/code&gt; drop column Gatewayid&lt;/p&gt;
&lt;p&gt;调整字段顺序：&lt;/p&gt;
&lt;p&gt;ALTER TABLE &lt;code&gt;user_movement_log&lt;/code&gt; CHANGE &lt;code&gt;GatewayId&lt;/code&gt; &lt;code&gt;GatewayId&lt;/code&gt; int not null default 0 AFTER RegionID&lt;/p&gt;
&lt;p&gt;mysql&amp;gt; alter table b1 drop column Name;
Query OK, 0 rows affected (0.52 sec)
Records: 0  Duplicates: 0  Warnings: 0&lt;/p&gt;
&lt;p&gt;是的通过此种方式有效：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from b1;
+----+--------+-----------------+------+------+
| Id | Gender | Hobbies         | Age  | Test |
+----+--------+-----------------+------+------+
|  0 |       | 羽毛球          |   30 |   31 |
|  1 |       | 编程            |   24 |   31 |
|  2 |        | 旅游            |   27 |   30 |
|  3 |       | 足球 dota       |   25 |   31 |
|  4 |       | 打炮，摄影      |   30 |   31 |
|  6 |       | 篮球            |   34 |   31 |
|  7 |       | 音乐，编程 军事 |   30 |   31 |
|  8 |       | 摄影            |   26 |   31 |
|  9 |       | 电影            |   26 |   31 |
| 10 |       | 消消乐          |   26 |   31 |
| 11 |        | 消消乐          |   24 |   30 |
| 12 |        | 购物            | NULL |   30 |
| 13 |       | 骑行            | NULL |   31 |
| 14 |       | 学术            |   34 |   31 |
| 15 |       | 不清楚          | NULL |   31 |
| 16 |       | 散步            | NULL |   31 |
| 17 |       | NULL            | NULL |   31 |
| 18 |        | 家庭主妇        |   26 |   30 |
+----+--------+-----------------+------+------+
18 rows in set (0.00 sec)
	```
测试分组方法：升序排列（降序用desc）
  规则用 order by 字段名  asc|desc

```mysql
mysql&amp;gt; select * from b1
    -&amp;gt; order by Age asc;
+----+--------+-----------------+------+------+
| Id | Gender | Hobbies         | Age  | Test |
+----+--------+-----------------+------+------+
| 17 |       | NULL            | NULL |   31 |
| 16 |       | 散步            | NULL |   31 |
| 15 |       | 不清楚          | NULL |   31 |
| 13 |       | 骑行            | NULL |   31 |
| 12 |        | 购物            | NULL |   30 |
|  1 |       | 编程            |   24 |   31 |
| 11 |        | 消消乐          |   24 |   30 |
|  3 |       | 足球 dota       |   25 |   31 |
| 18 |        | 家庭主妇        |   26 |   30 |
| 10 |       | 消消乐          |   26 |   31 |
|  9 |       | 电影            |   26 |   31 |
|  8 |       | 摄影            |   26 |   31 |
|  2 |        | 旅游            |   27 |   30 |
|  7 |       | 音乐，编程 军事 |   30 |   31 |
|  4 |       | 打炮，摄影      |   30 |   31 |
|  0 |       | 羽毛球          |   30 |   31 |
| 14 |       | 学术            |   34 |   31 |
|  6 |       | 篮球            |   34 |   31 |
+----+--------+-----------------+------+------+
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;也可以组合排序：先按年龄的升序，再按id的降序
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from b1
    -&amp;gt; order by Age asc,Id desc;
+----+--------+-----------------+------+------+
| Id | Gender | Hobbies         | Age  | Test |
+----+--------+-----------------+------+------+
| 17 |       | NULL            | NULL |   31 |
| 16 |       | 散步            | NULL |   31 |
| 15 |       | 不清楚          | NULL |   31 |
| 13 |       | 骑行            | NULL |   31 |
| 12 |        | 购物            | NULL |   30 |
| 11 |        | 消消乐          |   24 |   30 |
|  1 |       | 编程            |   24 |   31 |
|  3 |       | 足球 dota       |   25 |   31 |
| 18 |        | 家庭主妇        |   26 |   30 |
| 10 |       | 消消乐          |   26 |   31 |
|  9 |       | 电影            |   26 |   31 |
|  8 |       | 摄影            |   26 |   31 |
|  2 |        | 旅游            |   27 |   30 |
|  7 |       | 音乐，编程 军事 |   30 |   31 |
|  4 |       | 打炮，摄影      |   30 |   31 |
|  0 |       | 羽毛球          |   30 |   31 |
| 14 |       | 学术            |   34 |   31 |
|  6 |       | 篮球            |   34 |   31 |
+----+--------+-----------------+------+------+
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;as作为辅助显示   where 则进行判断，条件显示信息&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select Hobbies as 爱好,Age as 年龄 from b1
    -&amp;gt; where Age &amp;gt;24 and Age &amp;lt;30;
+-----------+------+
| 爱好      | 年龄 |
+-----------+------+
| 旅游      |   27 |
| 足球 dota |   25 |
| 摄影      |   26 |
| 电影      |   26 |
| 消消乐    |   26 |
| 家庭主妇  |   26 |
+-----------+------+
6 rows in set (0.02 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5：like模糊匹配
正则表达式的效果，查找含有某某的字符串的信息&lt;/p&gt;
&lt;p&gt;下面信息来自如鹏：
通配符过滤使用LIKE 。
1、单字符匹配的通配符为半角下划线“_”（类似于正则表达式的.），它匹配单个出现的字符。以任意字符开头，剩余部分为“erry” ：SELECT * FROM T_Employees WHERE Name LIKE &amp;lsquo;_erry&amp;rsquo;
2、多字符匹配的通配符为半角百分号“%”，它匹配任意次数（零或多个）出现的任意字符。 “k%”匹配以“k”开头、任意长度的字符串。检索姓名中包含字母“n”的员工信息 ：SELECT * FROM T_Employees WHERE Name LIKE &amp;lsquo;%n%&amp;rsquo;
3、Like性能较差，很容易造成全表扫描，谨慎使用。后面会讲数据库优化(索引等)，项目中做搜索用全文检索。
测试：（不像 = 号必须一样 ， like是模糊匹配）(数据库全部取出来，然后一条一条扫描)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from b1 where Hobbies like &#39;%羽毛%&#39;;
+----+--------+---------+------+------+
| Id | Gender | Hobbies | Age  | Test |
+----+--------+---------+------+------+
|  0 |       | 羽毛球  |   30 |   31 |
+----+--------+---------+------+------+
1 row in set (0.14 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6.控制判断 Null
Null的精确翻译是不知道，连不知道怎么让数据库知道，所以必须用专门的函数is和is not进行判断，类似于bit的bin函数&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select Null+1;
+--------+
| Null+1 |
+--------+
|   NULL |
+--------+
1 row in set (0.04 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;不知道+1还是不知道。NUll相当于是一个对象，这个对象不知道里面的值为多少，所以无法进行=和like的比较
SQL中使用is null、is not null来进行空值判断：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from  b1 where Age is NULL;
+----+--------+---------+------+------+
| Id | Gender | Hobbies | Age  | Test |
+----+--------+---------+------+------+
| 12 |        | 购物    | NULL |   30 |
| 13 |       | 骑行    | NULL |   31 |
| 15 |       | 不清楚  | NULL |   31 |
| 16 |       | 散步    | NULL |   31 |
| 17 |       | NULL    | NULL |   31 |
+----+--------+---------+------+------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果使用=号 和like则没有任何显示&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from  b1 where Age = NULL;
Empty set (0.01 sec)

mysql&amp;gt; select * from  b1 where Age like &#39;%NULL%&#39;;
Empty set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7 分组（group by)&lt;/p&gt;
&lt;p&gt;比如有一个字段叫做部门，如果group by 部门  那么如果部门值相同的id则被分配到一个组中！！！同一组中的值可以进行再select,为了实现这个目的，一般需要了解外键的知识，多表的概念。现在进行测试：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select Age from b1 group by age;
+------+
| Age  |
+------+
| NULL |
|   24 |
|   25 |
|   26 |
|   27 |
|   30 |
|   34 |
+------+
7 rows in set (0.04 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到如果对年龄进行分组，总共有7个组
将Age相同的数据行放到一组，分组后的数据可以看作一个临时的结果集，而SELECT  Age语句则取出每组的Age字段的值，这样我们就得到上表的员工年龄段表了
注意点：如果SELECT语句有WHERE子句，则GROUP BY子句必须放到WHERE语句的之后。
通过count(Age)可以看到每个分组到底有多少个人！这是一个相当棒的查询结果&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select Age,count(Age) from b1 group by age;
+------+------------+
| Age  | count(Age) |
+------+------------+
| NULL |          0 |
|   24 |          2 |
|   25 |          1 |
|   26 |          4 |
|   27 |          1 |
|   30 |          3 |
|   34 |          2 |
+------+------------+
7 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以想想如果 是对部门进行分组，并存在salary字段，则可以avg(salary)获得某个部门的平均工资（min 最小  max最大  sum对部门工资求和！方便），因为经过分组后，select得到的结果是分组的信息，
而不是单一的信息了
1）计算每个分组中的员工平均工资&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;SELECT Age,AVG(Salary) FROM T_Employees

GROUP BY Age
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如鹏的总结：分组语句一般和聚合函数一起使用，GROUP BY子句负责将数据分成逻辑组，而聚合函数则对每一个组进行统计计算。&lt;/p&gt;
&lt;p&gt;8.联合查询&amp;ndash;之leftjoin模式&lt;/p&gt;
&lt;p&gt;多表查询，是一个比较实际的运用！，多表查询中涉及到联合查询，先建立三张表，然后添加数据，测试就会明白了
创建第一张表 T_customers ,设计了Id为主键,自动增长，Name为varchar  not null，Age为tinyint就够了&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table T_Customers(
    -&amp;gt; Id int(4) auto_increment primary key,
    -&amp;gt; Name varchar(20) not null default &#39;&#39;,
    -&amp;gt; Age tinyint default 0);
Query OK, 0 rows affected (0.31 sec)

并添加完数据：
mysql&amp;gt; INSERT INTO T_Customers(Id,Name,Age)
    -&amp;gt; VALUES(1,&#39;TOM&#39;,21);
Query OK, 1 row affected (0.12 sec)

mysql&amp;gt; INSERT INTO T_Customers(Id,Name,Age)
    -&amp;gt; VALUES(2,&#39;MIKE&#39;,24);
Query OK, 1 row affected (0.06 sec)

mysql&amp;gt; INSERT INTO T_Customers(Id,Name,Age)
    -&amp;gt; VALUES(3,&#39;JACK&#39;,30);
Query OK, 1 row affected (0.09 sec)

mysql&amp;gt; INSERT INTO T_Customers(Id,Name,Age)
    -&amp;gt; VALUES(4,&#39;TOM&#39;,25);
Query OK, 1 row affected (0.03 sec)

mysql&amp;gt; INSERT INTO T_Customers(Id,Name,Age)
    -&amp;gt; VALUES(5,&#39;LINDA&#39;,30);
Query OK, 1 row affected (0.08 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表格结构:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc T_customers;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| Id    | int(4)      | NO   | PRI | NULL    | auto_increment |
| Name  | varchar(20) | NO   |     |         |                |
| Age   | tinyint(4)  | YES  |     | 0       |                |
+-------+-------------+------+-----+---------+----------------+
3 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from T_customers;
+----+-------+------+
| Id | Name  | Age  |
+----+-------+------+
|  1 | TOM   |   21 |
|  2 | MIKE  |   24 |
|  3 | JACK  |   30 |
|  4 | TOM   |   25 |
|  5 | LINDA |   30 |
+----+-------+------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;新建第二张表：T_OrderType
设计ID和T_Customers一样，Name为订单类型名字，varchar（30）且非空&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table T_OrderType(
    -&amp;gt; Id int auto_increment primary key,
    -&amp;gt; Name varchar(30) not null default &#39;&#39;);
Query OK, 0 rows affected (0.35 sec)

mysql&amp;gt; desc T_OrderType;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| Id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| Name  | varchar(30) | NO   |     |         |                |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;并插入表数据：
不小心检错表名字了 ，进行修改&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; rename table T_OrderType to T_OrderTypes;
Query OK, 0 rows affected (0.19 sec)
复制代码

mysql&amp;gt; INSERT INTO T_OrderTypes(Id,Name)
    -&amp;gt; VALUES(1,&#39;现货订单&#39;);
Query OK, 1 row affected (0.12 sec)

mysql&amp;gt; INSERT INTO T_OrderTypes(Id,Name)
    -&amp;gt; VALUES(2,&#39;预订订单&#39;);
Query OK, 1 row affected (0.03 sec)

mysql&amp;gt; INSERT INTO T_OrderTypes(Id,Name)
    -&amp;gt; VALUES(3,&#39;预购订单&#39;);
Query OK, 1 row affected (0.09 sec)

mysql&amp;gt; INSERT INTO T_OrderTypes(Id,Name)
    -&amp;gt; VALUES(4,&#39;内部&#39;);
Query OK, 1 row affected (0.09 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示订单类型表结构信息&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc T_OrderTypes;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| Id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| Name  | varchar(30) | NO   |     |         |                |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.01 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示其中的数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from T_OrderTypes;
+----+----------+
| Id | Name     |
+----+----------+
|  1 | 现货订单 |
|  2 | 预订订单 |
|  3 | 预购订单 |
|  4 | 内部     |
+----+----------+
4 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;新建第三张 最重要的表！涉及到一个关键的新的知识点，外键的创建
设计了五个参数
ID                 订单ID  设计和其他两张表类型一致
Number       订单编号 设计为varchar（20） not null
Price             设计为 int类型
CustomerId  外键1   为T_Customers的外键
TypeId           外键2  为T_OrderTypes的外键
参考此文&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; create table T_Orders(
    -&amp;gt; Id int auto_increment primary key,
    -&amp;gt; Number varchar(20) not null default &#39;&#39;,
    -&amp;gt; Price int not null default 0,
    -&amp;gt; CustomerId int, foreign key(CustomerId) references T_customers(Id) on del
ete restrict on update cascade,
    -&amp;gt; TypeId int, foreign key(TypeId) references T_OrderTypes(Id) on delete res
trict on update cascade);
Query OK, 0 rows affected (0.46 sec)

mysql&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;显示表结构&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; desc T_Orders;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| Id         | int(11)     | NO   | PRI | NULL    | auto_increment |
| Number     | varchar(20) | NO   |     |         |                |
| Price      | int(11)     | NO   |     | 0       |                |
| CustomerId | int(11)     | YES  | MUL | NULL    |                |
| TypeId     | int(11)     | YES  | MUL | NULL    |                |
+------------+-------------+------+-----+---------+----------------+
5 rows in set (0.03 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外一种更加清晰地显示表结构：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show create table T_Orders\G;
*************************** 1. row ***************************
       Table: T_Orders
Create Table: CREATE TABLE `t_orders` (
  `Id` int(11) NOT NULL AUTO_INCREMENT,
  `Number` varchar(20) NOT NULL DEFAULT &#39;&#39;,
  `Price` int(11) NOT NULL DEFAULT &#39;0&#39;,
  `CustomerId` int(11) DEFAULT NULL,
  `TypeId` int(11) DEFAULT NULL,
  PRIMARY KEY (`Id`),
  KEY `CustomerId` (`CustomerId`),
  KEY `TypeId` (`TypeId`),
  CONSTRAINT `t_orders_ibfk_1` FOREIGN KEY (`CustomerId`) REFERENCES `t_customer
s` (`Id`) ON UPDATE CASCADE,
  CONSTRAINT `t_orders_ibfk_2` FOREIGN KEY (`TypeId`) REFERENCES `t_ordertypes`
(`Id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以见到 CONSTRAINT的标志，如多定义没有指定CONSTRAINT 外键符号时，mysql会自动创建一个，比如t_orders_ibfk_1，就是外键符号，
可以通过&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;ALTER TABLE T_Orders DROP FOREIGN KEY `t_orders_ibfk_1`来删除外键
mysql&amp;gt; alter table T_orders drop foreign key t_orders_ibfk_1;
Query OK, 0 rows affected (0.25 sec)
Records: 0  Duplicates: 0  Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次显示表结构信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show create table T_orders\G;
*************************** 1. row ***************************
       Table: T_orders
Create Table: CREATE TABLE `t_orders` (
  `Id` int(11) NOT NULL AUTO_INCREMENT,
  `Number` varchar(20) NOT NULL DEFAULT &#39;&#39;,
  `Price` int(11) NOT NULL DEFAULT &#39;0&#39;,
  `CustomerId` int(11) DEFAULT NULL,
  `TypeId` int(11) DEFAULT NULL,
  PRIMARY KEY (`Id`),
  KEY `CustomerId` (`CustomerId`),
  KEY `TypeId` (`TypeId`),
  CONSTRAINT `t_orders_ibfk_2` FOREIGN KEY (`TypeId`) REFERENCES `t_ordertypes`
(`Id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec)

ERROR:
No query specified
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;少了t_orders_ibfk_2
那么如何再次添加呢？
参考此文&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; alter table T_orders add  foreign key hello(CustomerId) references T_cust
omers(Id);
Query OK, 0 rows affected (0.74 sec)
Records: 0  Duplicates: 0  Warnings: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再次查看表结构信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; show create table T_orders\G;
*************************** 1. row ***************************
       Table: T_orders
Create Table: CREATE TABLE `t_orders` (
  `Id` int(11) NOT NULL AUTO_INCREMENT,
  `Number` varchar(20) NOT NULL DEFAULT &#39;&#39;,
  `Price` int(11) NOT NULL DEFAULT &#39;0&#39;,
  `CustomerId` int(11) DEFAULT NULL,
  `TypeId` int(11) DEFAULT NULL,
  PRIMARY KEY (`Id`),
  KEY `TypeId` (`TypeId`),
  KEY `hello` (`CustomerId`),
  CONSTRAINT `t_orders_ibfk_2` FOREIGN KEY (`TypeId`) REFERENCES `t_ordertypes`
(`Id`) ON UPDATE CASCADE,
  CONSTRAINT `t_orders_ibfk_3` FOREIGN KEY (`CustomerId`) REFERENCES `t_customer
s` (`Id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到又增加了！
插入表结构信息&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; INSERT INTO T_Orders(Id,Number,Price,CustomerId, TypeId)
    -&amp;gt; VALUES(1,&#39;K001&#39;,100,1,1);
Query OK, 1 row affected (0.06 sec)

mysql&amp;gt; INSERT INTO T_Orders(Id,Number,Price,CustomerId, TypeId)
    -&amp;gt; VALUES(2,&#39;K002&#39;,200,1,1);
Query OK, 1 row affected (0.04 sec)

mysql&amp;gt; INSERT INTO T_Orders(Id,Number,Price,CustomerId, TypeId)
    -&amp;gt; VALUES(3,&#39;T003&#39;,300,1,2);
Query OK, 1 row affected (0.08 sec)

mysql&amp;gt; INSERT INTO T_Orders(Id,Number,Price,CustomerId, TypeId)
    -&amp;gt; VALUES(4,&#39;N002&#39;,100,2,2);
Query OK, 1 row affected (0.04 sec)

mysql&amp;gt; INSERT INTO T_Orders(Id,Number,Price,CustomerId, TypeId)
    -&amp;gt; VALUES(5,&#39;N003&#39;,500,3,4);
Query OK, 1 row affected (0.04 sec)

mysql&amp;gt; INSERT INTO T_Orders(Id,Number,Price,CustomerId, TypeId)
    -&amp;gt; VALUES(6,&#39;T001&#39;,300,4,3);
Query OK, 1 row affected (0.04 sec)

mysql&amp;gt; INSERT INTO T_Orders(Id,Number,Price,CustomerId, TypeId)
    -&amp;gt; VALUES(7,&#39;T002&#39;,100,1,1);
Query OK, 1 row affected (0.05 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;于是我们可以开始进行联合查询了：
1、查询每张订单的订单号、价格、对应的客户姓名以及客户年龄&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select o.Number,o.Price,c.Name,c.Age
    -&amp;gt; From T_Orders o
    -&amp;gt; Left join T_Customers c
    -&amp;gt; On o.CustomerId=c.Id;
+--------+-------+------+------+
| Number | Price | Name | Age  |
+--------+-------+------+------+
| K001   |   100 | TOM  |   21 |
| K002   |   200 | TOM  |   21 |
| T003   |   300 | TOM  |   21 |
| T002   |   100 | TOM  |   21 |
| N002   |   100 | MIKE |   24 |
| N003   |   500 | JACK |   30 |
| T001   |   300 | TOM  |   25 |
+--------+-------+------+------+
7 rows in set (0.08 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2、添加where语句(显示价格&amp;gt;=150元的订单)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select o.Number,o.Price,o.CustomerId,c.Name,c.Age
    -&amp;gt; from t_orders o
    -&amp;gt; left join t_customers c on o.CustomerId = c.Id
    -&amp;gt; where o.price &amp;gt;=150;
+--------+-------+------------+------+------+
| Number | Price | CustomerId | Name | Age  |
+--------+-------+------------+------+------+
| K002   |   200 |          1 | TOM  |   21 |
| T003   |   300 |          1 | TOM  |   21 |
| N003   |   500 |          3 | JACK |   30 |
| T001   |   300 |          4 | TOM  |   25 |
+--------+-------+------------+------+------+
4 rows in set (0.06 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3、多表join连接查询&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select o.Number 订单号 ,o.Price 价格,c.Name 客户姓名,c.Age 客户年
    -&amp;gt; t.Name 订单类型 from t_orders o
    -&amp;gt; left join T_customers c on o.customerId=c.Id
    -&amp;gt; left join T_OrderTypes t on o.TypeId=t.Id;
+--------+------+----------+----------+----------+
| 订单号 | 价格 | 客户姓名 | 客户年龄 | 订单类型 |
+--------+------+----------+----------+----------+
| K001   |  100 | TOM      |       21 | 现货订单 |
| K002   |  200 | TOM      |       21 | 现货订单 |
| T003   |  300 | TOM      |       21 | 预订订单 |
| T002   |  100 | TOM      |       21 | 现货订单 |
| N002   |  100 | MIKE     |       24 | 预订订单 |
| N003   |  500 | JACK     |       30 | 内部     |
| T001   |  300 | TOM      |       25 | 预购订单 |
+--------+------+----------+----------+----------+
7 rows in set (0.12 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由此可见 多表查询的魅力！！！。&lt;/p&gt;
&lt;p&gt;9.外键约束&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create table T_Orders(
Id int auto_increment primary key,
Number varchar(20) not null default &#39;&#39;,
Price int not null default 0,
CustomerId int, foreign key(CustomerId) references T_customers(Id) on del
ete restrict on update cascade,
TypeId int, foreign key(TypeId) references T_OrderTypes(Id) on delete res
trict on update cascade);
on delete restrict: 也就是限制删除(当你的外键被使用是  一旦被引用则不被删除，防止产生数据紊乱）
on update cascade（当更新时候，索引也相应的进行更新）


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;待学习的知识点：  触发器，约束，子查询，引擎（存储过程），除了left join的其他join 。。。&lt;/p&gt;
&lt;p&gt;补充（来自如鹏）：1SQL语句中字符串一般用单引号。
2简单的插入数据的SQL语句：INSERT INTO T_Persons(Id,Name,Age,Gender) VALUES(5,&amp;lsquo;Jim&amp;rsquo;,20,1)
Insert语句可以省略表名后的列名，但是强烈不推荐
3.如果插入的行中有些字段的值不确定，那么Insert的时候不指定那些列即可。不“允许为空”的列在插入时不能省略
4，自动递增/自增(Auto Increment)：字段自增可以避免并发等问题，不要程序员代码控制自增。用自增字段在Insert的时候不用指定值。修改表结构的方法【设计表】&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1.MySQL的语言中没有top修饰，不过可以使用limit来操作。
    2.MySQL和SQL Server 均支持as。as可以命名一个列或者表为其他名称。
    3.Distinct可以用户排除重复，若在Distinct后面用逗号分隔了好几个列，那表示要将这些列联合起来去重复。
    4.Order by 列名 asc/desc  其中asc为默认的从小到大，desc为从大大小，实际项目中，很多表的数据显示都需要从后面到前面。
    5.聚合函数在各个数据库中均受到支持。AVG、MAX、SUM、COUNT。同一个语句中，多个聚合函数可以一起使用。
    6.聚合函数多和Group by一起使用，如果没有Group by那么聚合的就是整个表的所有指定列的数据。
    7.模糊查询不是使用= 而是使用 like结合百分号 %
    8.使用count聚合函数可以查找符合条件的某一列是否存在。
    9.原则∶当使用了分组函数Group by后，select只能是聚合函数或者Group by的列。虽然MySQL不报错，但是仍然不推荐这么使用。
    10.对于第9点，虽然select 的只能是Group by的但是聚合函数仍然可以聚合其他列。
    11.Having和Where区别，Having搭配Group by使用，是对分组后的数据进行筛选。而Where是在分组前就行筛选。
    12.当多表查询的时候，不推荐单纯的使用*
    13.对于多表查询，一定要注意使用别名。
    14.Inner  Join 就是Join。
    15.All  Some Any中Some和Any等价的。
    16.多表查询使用On来连接，多为=来连接。
    17.Join和Union区别，可以形象的记忆为 Join是横着的连接，Union是上下竖着的连接。
    18.Left Join 是一定显示左边的，没显示的使用null来补位，Right Join是右边的表一定显示，左边的表某列不存在使用Null来补位。
    19.当子查询的结果不是一个的时候，主查询又在使用&amp;gt; &amp;lt; =表达式的时候，All 所有  Any/Some的作用就发挥了。
    20.从原理上来讲，多张表联合起来的查询是∶若A,B两张表，A表的第一列依次扫描B表的每一列，提取符号条件的。类似2个嵌套的for循环那样。
    21.当子查询的结果不是1列的时候，是不能使用 &amp;gt; =&amp;lt; 这些运算符的。
    22.使用Union，Intersect，Except运算符的时候，目标列表需要有相同的数目。
    23.聚合函数一般搭配分组函数一起使用，若不分组，那么就按照where的来，如果where没有就是所有的列。
    24.在使用in的语句中，一般都是可以使用Exists，且Exits会走索性相对来说快点，但是不一定。练习的时候，2个都要写出来。
    25.当Exits Where 的时候，该SQL语句运行顺序是这样的∶先运行Exits前面的，然后将每一列带入where中进行查询匹配，如果找到了就输出这一列。反之不输出。
    26.Exits函数的返回只是true或者fanlse。
    27.like或者not like利用 %进行模糊查询。
    28.逗号连接的2个∶  from A，B   |||   order by a asc, b desc
    29.聚合函数不应该出现在Where中，如果Where要出现，那么将其单独搞成子查询的模式。
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>多线程March18th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/duo-xian-cheng-march18th/</link>
      <pubDate>Mon, 11 May 2015 14:58:45 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/duo-xian-cheng-march18th/</guid>
      <description>&lt;p&gt;4:java多线程&lt;/p&gt;
&lt;p&gt;新建状态(start)
可运行状态(runnable)
运行状态(run)
阻塞装填(sleep)
死亡状态（stop,dead）&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;threads----implements&#34;&gt;start&amp;mdash;&amp;gt;Runnable&amp;mdash;-&amp;gt; Running&amp;mdash;&amp;gt;Dead
|               |
|               |
Threads    implements&lt;/h2&gt;
&lt;h2 id=&#34;running---wait---blocked---notify----runnable&#34;&gt;Running&amp;mdash;&amp;gt;Wait&amp;mdash;&amp;gt;Blocked&amp;mdash;&amp;gt;notify&amp;mdash;-&amp;gt;Runnable&lt;/h2&gt;
&lt;h2 id=&#34;running---sleep---runnable&#34;&gt;Running&amp;mdash;&amp;gt;sleep&amp;mdash;&amp;gt;Runnable&lt;/h2&gt;
&lt;p&gt;线程和进程的区别？
一个进程占用实际的内存资源，线程依赖于进程，一个进程可以有多个线程
进程大，线程小
每一个程序运行都运行在一个进程内，而不是线程
一个进程可分为多个线程&lt;/p&gt;
&lt;p&gt;售票案例
问题： 第70张票还没售完不能售第73张的票，但是实际却是销售了？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestMultiThreads;

/**
* @author 叶昭良
* @time 2015年3月18日下午9:09:27
* @version TestMultiThreadsTestPesonThread V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestPesonThread
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub

A aa = new A();
Thread t1 = new Thread(aa);
Thread t2 = new Thread(aa);
Thread t3 = new Thread(aa);

/*        B bb = new B();
Thread t1 = new Thread(bb);
Thread t2 = new Thread(bb);
Thread t3 = new Thread(bb);*/

t1.start();
t2.start();
t3.start();
}

}

class A implements Runnable
{
private static int tickets = 0;
@Override
public void run()
{
// TODO Auto-generated method stub
while(true)
{
//synchronized(&amp;quot;aaa&amp;quot;)
{
if(tickets &amp;lt; 10)
{
System.out.println(Thread.currentThread().getName()+tickets);
tickets++;
}else
{
break;
}
}

}
}

}


class B implements Runnable
{
private static int tickets = 0;
@Override
public synchronized void run()
{
// TODO Auto-generated method stub
while(true)
{
if(tickets &amp;lt; 10)
{
System.out.println(Thread.currentThread().getName()+tickets);
tickets++;
}else
{
break;
}
}
}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;解决方案1： 采用synchronized(&amp;ldquo;aaa&amp;rdquo;) 或者 synchronized(TestPesonThread.class) 都是可以的，  相当于在一扇门中
塞入了口香糖，得拿走了才能打开！一个坑的作用&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
public void run()
{
// TODO Auto-generated method stub
while(true)
{
//synchronized(&amp;quot;aaa&amp;quot;)
synchronized(TestPesonThread.class)
{
if(tickets &amp;lt; 10)
{
System.out.println(Thread.currentThread().getName()+tickets);
tickets++;
}else
{
break;
}
}

}
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：（注意加入Thread.sleep(1000）不然都会在thread0 或者thread1 thread2中执行，因为少）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Thread-0正在售10
Thread-2正在售9
Thread-1正在售8
Thread-2正在售7
Thread-2正在售6
Thread-2正在售5
Thread-0正在售4
Thread-2正在售3
Thread-2正在售2
Thread-2正在售1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;解决方案2 ：  采用synchronized的run方法也是可以的！ 相当于锁定函数代码块，霸占着 直到用完！ 但是这个方法仅仅针对一个线程，执行完！一个对象霸占一个方法&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestMultiThreads;

/**
* @author 叶昭良
* @time 2015年3月18日下午9:09:27
* @version TestMultiThreadsTestPesonThread V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestPesonThread
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub

A aa = new A();
Thread t1 = new Thread(aa);
Thread t2 = new Thread(aa);
Thread t3 = new Thread(aa);

/*        B bb = new B();
Thread t1 = new Thread(bb);
Thread t2 = new Thread(bb);
Thread t3 = new Thread(bb);*/

t1.start();
t2.start();
t3.start();
}

}

class A implements Runnable
{
private static int tickets = 0;
@Override
public synchronized void run()
{
// TODO Auto-generated method stub
while(true)
{
//synchronized(&amp;quot;aaa&amp;quot;)
//synchronized(TestPesonThread.class)
{
if(tickets &amp;lt; 10)
{
System.out.println(Thread.currentThread().getName()+&amp;quot;正在售&amp;quot;+tickets);
tickets++;
}else
{
break;
}
}

}
}

}


class B implements Runnable
{
private static int tickets = 0;
@Override
public synchronized void run()
{
// TODO Auto-generated method stub
while(true)
{
if(tickets &amp;lt; 10)
{
System.out.println(Thread.currentThread().getName()+tickets);
tickets++;
}else
{
break;
}
}
}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Thread-0正在售10
Thread-0正在售9
Thread-0正在售8
Thread-0正在售7
Thread-0正在售6
Thread-0正在售5
Thread-0正在售4
Thread-0正在售3
Thread-0正在售2
Thread-0正在售1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由此我们可以得知：
方法的霸占解决掉乱序，但是其实仅仅只是一个线程再执行，不能达到目的；
而采用synchronized对象 比如字符串对象&amp;quot;aaa&amp;quot;,不然类的class :TestPesonThread.class 放在循环快中都能够很好的解决多线程共用一个模块，必须执行一块完毕，才能执行下一块的问题！！perfect&lt;/p&gt;
&lt;p&gt;案例2：生产和消费&lt;/p&gt;
&lt;p&gt;目的：通过线程模拟一个在生产  一个在消费，并且当量小于三的时候，必须再生产，在量&lt;/p&gt;
&lt;p&gt;wait方法的作用是使得当前调用wait方法所在部分（代码块）的线程（当前线程）停止执行，并释放当前获得的调用wait所在的代码块的锁，并在其他线程调用notify或者notifyAll方法时恢复到竞争锁状态（一旦获得锁就恢复执行）。
有点类似巫医的弹弹乐效果，你被弹了，就停止，当别人被弹了，你就可以运动了&lt;/p&gt;
&lt;p&gt;注意：
wait被调用的时候必须在拥有锁（即synchronized修饰的）的代码块中。
恢复执行后，从wait的下一条语句开始执行，因而wait方法总是应当在while循环中调用，以免出现恢复执行后继续执行的条件不满足却继续执行的情况。
notify方法通知调用了wait方法，但是尚未激活的一个线程进入线程调度队列（即进入锁竞争），注意不是立即执行。并且具体是哪一个线程不能保证。另外一点就是被唤醒的这个线程一定是在等待wait所释放的锁。
notifyAll方法则唤醒所有调用了wait方法，尚未激活的进程进入竞争队列。&lt;/p&gt;
&lt;p&gt;有一个wait框，同时有一个监工notify,负责叫醒被暂停的waiter,去继续做他的被中断的工作
synstack 类定义了synchronized的push和pop方法
producer 进行push调用（可以被中断，当达到生产线程的上限时 就中断）
customer 进行pop调用（可以被中断，当没有产品的时候  并在产品数为3的时候通知生产）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestMultiThreads;

/**
* @author 叶昭良
* @time 2015年3月18日下午9:54:48
* @version TestMultiThreadsTestProducerCustomer V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestProducerCustomer
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
SynStack ss = new SynStack();
Producer pro = new Producer(ss);
Customer custom = new Customer(ss);

//Thread tt = new Thread();
/*        pro.run();
custom.run();*/

Thread t1 = new Thread(pro);
t1.start();
Thread t2 = new Thread(custom);
t2.start();

}

}


class SynStack
{
private char[] ss = new char[6];
//private static int count = 0;
private int count = 0;
public synchronized void push(char c)
{
try
{
Thread.sleep(500);
} catch (InterruptedException e1)
{
// TODO Auto-generated catch block
e1.printStackTrace();
}
//if(count == ss.length)
while(count == ss.length)
{
try
{
System.out.println(&amp;quot;生产已达上限，再生产容易造成供需不平衡&amp;quot;);
this.wait();
} catch (InterruptedException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}
}
/*        if(count == 3)
{
this.notify(); //如果达到3的时候通知他们进行生产
}*/
if(count &amp;gt; 1)
{
System.out.println(count+&amp;quot;大家可以来消费了&amp;quot;);
this.notify(); //一有则通知大家进行消费
}


System.out.printf(&amp;quot;It generates %d product.It is %c\n&amp;quot;,count,c);
ss[count] = c;
count++;
}
//synchronized 如果不加，则报错
public synchronized char pop()
{
try
{
Thread.sleep(100);
} catch (InterruptedException e1)
{
// TODO Auto-generated catch block
e1.printStackTrace();
}
//if(count == 0)
while(count == 0)
{
//this.notify();//通知push线程进行生产
try
{
System.out.println(&amp;quot;产品已售空，请联系生产商&amp;quot;);
this.wait();
} catch (InterruptedException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}
}
if(count == 3)
{
System.out.println(&amp;quot;该督促生产了，并且可以继续销售&amp;quot;);
this.notify(); //如果达到3的时候通知他们进行生产（push）

}
//this.notify();

count--;
//必须放在count--之后 才可以调用ss[count]
System.out.printf(&amp;quot;It ate %d product.It is %c\n&amp;quot;,count,ss[count]);
return ss[count];

}
}

class Producer implements Runnable
{
private SynStack ss = null;

public Producer(SynStack ss)
{
this.ss =ss;
}
@Override
public void run()        
{
// TODO Auto-generated method stub
//        ss.push(&#39;a&#39;);
/*        try
{
Thread.sleep(1000);
} catch (InterruptedException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}*/
char ch ;
for(int i =0 ; i &amp;lt; 20 ; i++)
{
ch = (char)(&#39;a&#39;+i);
ss.push(ch);
}
}

}
class Customer implements Runnable
{
private SynStack ss = null;
public Customer(SynStack ss)
{
this.ss = ss;
}
@Override
public void run()
{

// TODO Auto-generated method stub
//        System.out.println(ss.pop());
/*        try
{
Thread.sleep(1000);
} catch (InterruptedException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}*/
for(int i = 0; i &amp;lt; 20 ; i++)
{
System.out.println(ss.pop());
}
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;It generates 0 product.It is a
It generates 1 product.It is b
2大家可以来消费了
It generates 2 product.It is c
该督促生产了，并且可以继续销售
It ate 2 product.It is c
c
2大家可以来消费了
It generates 2 product.It is d
该督促生产了，并且可以继续销售
It ate 2 product.It is d
d
It ate 1 product.It is b
b
It generates 1 product.It is e
It ate 1 product.It is e
e
It generates 1 product.It is f
2大家可以来消费了
It generates 2 product.It is g
该督促生产了，并且可以继续销售
It ate 2 product.It is g
g
2大家可以来消费了
It generates 2 product.It is h
3大家可以来消费了
It generates 3 product.It is i
It ate 3 product.It is i
i
3大家可以来消费了
It generates 3 product.It is j
4大家可以来消费了
It generates 4 product.It is k
5大家可以来消费了
It generates 5 product.It is l
生产已达上限，再生产容易造成供需不平衡
It ate 5 product.It is l
l
It ate 4 product.It is k
k
It ate 3 product.It is j
j
该督促生产了，并且可以继续销售
It ate 2 product.It is h
2大家可以来消费了
It generates 2 product.It is m
h
3大家可以来消费了
It generates 3 product.It is n
It ate 3 product.It is n
n
3大家可以来消费了
It generates 3 product.It is o
It ate 3 product.It is o
o
3大家可以来消费了
It generates 3 product.It is p
4大家可以来消费了
It generates 4 product.It is q
It ate 4 product.It is q
q
4大家可以来消费了
It generates 4 product.It is r
It ate 4 product.It is r
r
4大家可以来消费了
It generates 4 product.It is s
5大家可以来消费了
It generates 5 product.It is t
It ate 5 product.It is t
t
It ate 4 product.It is s
s
It ate 3 product.It is p
p
该督促生产了，并且可以继续销售
It ate 2 product.It is m
m
It ate 1 product.It is f
f
It ate 0 product.It is a
a


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意：至于notify放置在代码的哪个地方，有待进一步的比较。&lt;/p&gt;
&lt;p&gt;5.网络编程&lt;/p&gt;
&lt;p&gt;一个网络程序需要考虑协议，IP，端口号。&lt;/p&gt;
&lt;p&gt;协议：
用于网络传输的规则、准则。在不同的计算机传输层中（7层架构） 有不同的数据包，
不同
层封包的不同方法&lt;/p&gt;
&lt;p&gt;IP:  唯一标识互联网中的计算机
端口号：qq有自己的端口  mysql的3306端口   smtp的23端口等&lt;/p&gt;
&lt;p&gt;协议分为UDP,TCP
UDP的特点：无需等待对方确认，比如写信 有可能收不到。
TCP的特点：需要等待 对方连接，比如QQ视频聊天，打电话。三重连接&lt;/p&gt;
&lt;p&gt;UDP编程：
知识点：
DatagramSocket 是一艘轮船（传递数据包）
DatagramPacket 是一个轮船上的货物（获取数据包）&lt;/p&gt;
&lt;p&gt;ByteArrayInputStream and  DataInputStream 用于打包港口货物
ByteArrayOutputStream and  DataOutputStream 也用于打包港口货物&lt;/p&gt;
&lt;p&gt;案例1：简单实现一个UDP的传输过程，服务器开启，客户端发送数据（暂时未实现服务器的发送  客户端的接受，实现简单，dos对应的dis  dis对应的dos)
Server:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.io.ByteArrayInputStream;
import java.io.DataInputStream;
import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.SocketException;

/**
* @author 叶昭良
* @time 2015年3月19日下午1:49:36
* @version TestNetworkTestDatagramSocket V1.0
* 功能： 测试UDP
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestDatagramSocket
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
DatagramSocket ds = null;
DatagramPacket dp = null;

try
{
ds = new DatagramSocket(5566);
byte[] apple = new byte[1025];
/*for(int i =0 ; i &amp;lt; 20; i++)
{
apple = (byte) ((byte)&#39;a&#39;+i);
}*/
dp = new DatagramPacket(apple, apple.length);
while(true)
{
try
{
ds.receive(dp);
ByteArrayInputStream bais = new ByteArrayInputStream(dp.getData());
DataInputStream dis = new DataInputStream(bais);
System.out.println(dis.readLong());

} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}

}
} catch (SocketException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}

}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.*;
/**
* @author 叶昭良
* @time 2015年3月21日上午1:39:22
* @version TestNetworkTestDatagramClient V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestDatagramClient
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
DatagramSocket ds = null;
DatagramPacket dp = null;
try
{
ds = new DatagramSocket();
long m = 1000l;
ByteArrayOutputStream baos = new ByteArrayOutputStream();
DataOutputStream dos = new DataOutputStream(baos);

dos.writeLong(m);

byte[] apple = baos.toByteArray();
dp = new DatagramPacket(apple, apple.length,new
InetSocketAddress(&amp;quot;127.0.0.1&amp;quot;,5566));
ds.send(dp);
}catch(IOException e)
{

}
}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;先开启Server,再运行Client
1000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;TCP编程：
知识点：
1.通过ServerSocket产生一个运行的所需的端口号
2.利用Socket进行编程，Socket源自于unix操作系统&lt;/p&gt;
&lt;p&gt;案例1： 模拟UDP的类似程序，即服务器端等待数据 进行读取   客户端发送数据&lt;/p&gt;
&lt;p&gt;Server:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.*;
/**
* @author 叶昭良
* @time 2015年3月19日下午2:30:08
* @version TestNetworkTestServer1 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestServer1
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
try
{
ServerSocket ss = new ServerSocket(5566);
while(true)
{
Socket s1 =ss.accept();
DataInputStream dis = new DataInputStream(s1.getInputStream());
System.out.println(dis.readUTF());
dis.close();
}
} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}

}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.*;
/**
* @author 叶昭良
* @time 2015年3月19日下午2:30:23
* @version TestNetworkTestClient1 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestClient1
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
Socket s1 =null;
OutputStream os = null;
DataOutputStream dos = null;
try
{
s1 = new Socket(&amp;quot;127.0.0.1&amp;quot;,5566);
os = s1.getOutputStream();
dos = new DataOutputStream(os);
dos.writeUTF(&amp;quot;I am coming ,Sir&amp;quot;);
dos.flush();


} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}finally
{
try
{
dos.close();
os.close();
s1.close();
} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}

}

}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例2：改进案例1  是的服务器端也能够发送  客户端也能接受数据&lt;/p&gt;
&lt;p&gt;Server:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;
&amp;lt;font size=&amp;quot;3&amp;quot;&amp;gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.*;
/**
* @author 叶昭良
* @time 2015年3月19日下午2:38:37
* @version TestNetworkTestServer2 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestServer2
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
Socket s1 = null ;
DataOutputStream dos = null;
DataInputStream dis = null;
BufferedReader br = null;
try
{
ServerSocket ss = new ServerSocket(5566);
s1 = ss.accept();

dis = new DataInputStream(s1.getInputStream());
dos = new DataOutputStream(s1.getOutputStream());
br = new BufferedReader(new InputStreamReader(System.in));

while(true)
{
String apple = dis.readUTF();
System.out.println(&amp;quot;客户端：&amp;quot;+dis.readUTF());
if(apple.equals(&amp;quot;bye&amp;quot;))
{
break;
}
apple = br.readLine();
dos.writeUTF(apple);
}
} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}finally
{
try
{
dos.close();
dis.close();
s1.close();
} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}
}

}

}
&amp;lt;/font&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.*;
/**
* @author 叶昭良
* @time 2015年3月19日下午2:38:52
* @version TestNetworkTestClient2 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestClient2
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
Socket s1 = null;
OutputStream os = null;
InputStream is = null;
DataOutputStream dos = null;
DataInputStream dis = null;
BufferedReader br = null;
try
{
s1 = new Socket(&amp;quot;127.0.0.1&amp;quot;,5566);
os = s1.getOutputStream();
is = s1.getInputStream();
dos = new DataOutputStream(os);
dis = new DataInputStream(is);

dos.writeUTF(&amp;quot;Come to the world of net server&amp;quot;);
dos.flush();

br = new BufferedReader(new InputStreamReader(System.in));
while(true)
{
String str = br.readLine();
dos.writeUTF(str);
if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
break;
str = dis.readUTF();
System.out.println(&amp;quot;服务器 said that&amp;quot; + str+&amp;quot;\n&amp;quot;);
if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
break;

}
} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}
}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：可以在字符界面下进行对话
客户端：hi
hi
服务器 said thathi too,smida&lt;/p&gt;
&lt;p&gt;出现的问题是，无法独立的切换客户端和服务器，client接受信息后，一直存在于while循环中,于是使用了线程，让他们自己对话吧！！&lt;/p&gt;
&lt;p&gt;Server的实现：
一定要注意无论是Server还是Client的实现，try&amp;mdash;catch之后不能有finally关闭，否则异常，socket中止&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

/**
* @author 叶昭良
* @time 2015年3月21日下午12:43:24
* @version TestNetworkTestServer3 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
import java.io.*;
import java.net.*;
public class TestServer3 //throws Exception
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args) 
{
// TODO Auto-generated method stub
ServerSocket ss = null;
Socket s = null;
DataOutputStream dos = null;
DataInputStream dis = null;
try
{
ss = new ServerSocket(8888);
s = ss.accept();
dos = new DataOutputStream(s.getOutputStream());

dis = new DataInputStream(s.getInputStream());

new ServerRead(dis).start();
new ServerWrite(dos).start();
} catch (IOException e)
{
// TODO Auto-generated catch block
e.printStackTrace();
}

}

}


class ServerRead extends Thread
{
private DataInputStream dis = null;
public ServerRead(DataInputStream dis)
{
this.dis = dis;
}

public void run()
{
while(true)
{
try{
String str = dis.readUTF();
System.out.println(&amp;quot;客户端说:&amp;quot;+str);
if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
break;
}catch(Exception e)
{
e.printStackTrace();
}
}
}
}
class ServerWrite extends Thread
{
private DataOutputStream dos = null;
public ServerWrite(DataOutputStream dos)
{
this.dos = dos;
}

public void run()
{
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
while(true)
{
try{
String str = br.readLine();
dos.writeUTF(str);
if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
break;
}catch(Exception e)
{
e.printStackTrace();
}//加入finally 关闭  dos.close()则异常。。。于是删掉Client &amp;amp; Server的四个finally即可！！！问题解决  原因未知！！！
}
}
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.*;
/**
* @author 叶昭良
* @time 2015年3月21日下午12:47:03
* @version TestNetworkTestClient3 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestClient3
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args) throws Exception
{
// TODO Auto-generated method stub
Socket s = new Socket(&amp;quot;127.0.0.1&amp;quot;,8888);
DataOutputStream dos = new DataOutputStream(s.getOutputStream());

DataInputStream dis = new DataInputStream(s.getInputStream());

new ClientRead(dis).start();
new ClientWrite(dos).start();
}

}

class ClientRead extends Thread
{
private DataInputStream dis = null;
public ClientRead(DataInputStream dis)
{
this.dis = dis;
}

public void run()
{
while(true)
{
try{
String str = dis.readUTF();
System.out.println(&amp;quot;服务器说:&amp;quot;+str);
if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
break;
}catch(Exception e)
{
e.printStackTrace();
}
}
}
}
class ClientWrite extends Thread
{
private DataOutputStream dos = null;
public ClientWrite(DataOutputStream dos)
{
this.dos = dos;
}

public void run()
{
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
while(true)
{
try{
String str = br.readLine();
dos.writeUTF(str);
if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
break;
}catch(Exception e)
{
e.printStackTrace();
}
}
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;客户端的控制台：

--------------------------------------------------------
客户端说:fs
fsdf
客户端说:heihei
吃了吗
客户端说:我吃了啊，下午去哪里玩？
----------------------------------------------------------


服务器端的控制台：
----------------------------------------------------------

fs

服务器说:fsdf

heihei
服务器说:吃了吗
我吃了啊，下午去哪里玩？
服务器说:不然咱们去闯红灯吧

----------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;问题：这里面的线程切换，没有生产和消费的明显，还需要进一步理解线程的切换，为什么就能够从Server的读线程，然后写入信息给client就可以切换到Client的读线程？
仅仅加入了extends thread?&lt;/p&gt;
&lt;p&gt;案例4： 在原先的基础上 加入了窗体，并进一步抽象到TCPClient  &amp;amp; TCPServer两个类下，通过TCPClient.launch  TCPServer.launch进行启动
美化效果操作：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Font font = new Font(&amp;quot;Dialog&amp;quot;, Font.PLAIN, 12); //一下是改变默认的组建上显示的字体，这样更加美观一些
UIManager.put(&amp;quot;MenuBar.font&amp;quot;, font);
UIManager.put(&amp;quot;MenuItem.font&amp;quot;, font);
UIManager.put(&amp;quot;Menu.font&amp;quot;, font);
UIManager.put(&amp;quot;PopupMenu.font&amp;quot;, font);
UIManager.put(&amp;quot;ToolBar.font&amp;quot;, font);
UIManager.put(&amp;quot;ToolTip.font&amp;quot;, font);
UIManager.put(&amp;quot;TabbedPane.font&amp;quot;, font);
UIManager.put(&amp;quot;Label.font&amp;quot;, font);
UIManager.put(&amp;quot;List.font&amp;quot;, font);
UIManager.put(&amp;quot;ComboBox.font&amp;quot;, font);
UIManager.put(&amp;quot;Button.font&amp;quot;, font);
UIManager.put(&amp;quot;Table.font&amp;quot;, font);
UIManager.put(&amp;quot;TableHeader.font&amp;quot;, font);
UIManager.put(&amp;quot;Tree.font&amp;quot;, font);
UIManager.put(&amp;quot;TextField.font&amp;quot;, font);
UIManager.put(&amp;quot;TextArea.font&amp;quot;, font);
UIManager.put(&amp;quot;TitledBorder.font&amp;quot;, font);
UIManager.put(&amp;quot;OptionPane.font&amp;quot;, font);
UIManager.put(&amp;quot;RadioButton.font&amp;quot;, font);
UIManager.put(&amp;quot;CheckBox.font&amp;quot;, font);
UIManager.put(&amp;quot;ToggleButton.font&amp;quot;, font);
UIManager.put(&amp;quot;Dialog.font&amp;quot;, font);
UIManager.put(&amp;quot;Panel.font&amp;quot;, font);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Server的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;


//some error swing : controler
import javax.swing.*;

import java.awt.*;
import java.awt.event.*;
/**
* @author 叶昭良
* @time 2015年3月19日下午3:20:34
* @version TestNetworkTestServer4 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestServer4
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
Font font = new Font(&amp;quot;Dialog&amp;quot;, Font.PLAIN, 12); //一下是改变默认的组建上显示的字体，这样更加美观一些
UIManager.put(&amp;quot;MenuBar.font&amp;quot;, font);
UIManager.put(&amp;quot;MenuItem.font&amp;quot;, font);
UIManager.put(&amp;quot;Menu.font&amp;quot;, font);
UIManager.put(&amp;quot;PopupMenu.font&amp;quot;, font);
UIManager.put(&amp;quot;ToolBar.font&amp;quot;, font);
UIManager.put(&amp;quot;ToolTip.font&amp;quot;, font);
UIManager.put(&amp;quot;TabbedPane.font&amp;quot;, font);
UIManager.put(&amp;quot;Label.font&amp;quot;, font);
UIManager.put(&amp;quot;List.font&amp;quot;, font);
UIManager.put(&amp;quot;ComboBox.font&amp;quot;, font);
UIManager.put(&amp;quot;Button.font&amp;quot;, font);
UIManager.put(&amp;quot;Table.font&amp;quot;, font);
UIManager.put(&amp;quot;TableHeader.font&amp;quot;, font);
UIManager.put(&amp;quot;Tree.font&amp;quot;, font);
UIManager.put(&amp;quot;TextField.font&amp;quot;, font);
UIManager.put(&amp;quot;TextArea.font&amp;quot;, font);
UIManager.put(&amp;quot;TitledBorder.font&amp;quot;, font);
UIManager.put(&amp;quot;OptionPane.font&amp;quot;, font);
UIManager.put(&amp;quot;RadioButton.font&amp;quot;, font);
UIManager.put(&amp;quot;CheckBox.font&amp;quot;, font);
UIManager.put(&amp;quot;ToggleButton.font&amp;quot;, font);
UIManager.put(&amp;quot;Dialog.font&amp;quot;, font);
UIManager.put(&amp;quot;Panel.font&amp;quot;, font);
new TCPServer().launch();
}

}


class TCPServer
{
// class variables
// class variables
// connect
private ServerSocket ss = null;
private Socket s = null;
// data flow
private DataOutputStream dos = null;
private DataInputStream dis = null;
// UI
private Frame f = null;
private TextArea ta = null;
private TextField tf = null;
private Button bn = null;


public void launch()
{
createUI();
connect();
new ServerRead().start();
new ServerWrite().start();
}
// construct member
/*
public TCPServer()
{

}
*/
public void createUI()
{
Frame f = new Frame(&amp;quot;服务器&amp;quot;);
ta = new TextArea();
tf = new TextField();
Panel p = new Panel(new BorderLayout());
bn = new Button(&amp;quot;发送&amp;quot;);
p.add(tf,BorderLayout.CENTER);
p.add(bn,BorderLayout.EAST);

f.add(ta,BorderLayout.CENTER);
f.add(p,BorderLayout.SOUTH);

f.setSize(400,200);
f.setVisible(true);
//f.setVisable(true);
f.addWindowListener(new WindowAdapter()
{
public void windowClosing(WindowEvent e)
{
System.exit(0);
}
});
}
public void connect()
{
try{
ss = new ServerSocket(5599);
s = ss.accept();
dis = new DataInputStream(s.getInputStream());
dos = new DataOutputStream(s.getOutputStream());
}catch(Exception e)
{
System.exit(0);
}
}
public void close()
{
try{
dis.close();
dos.close();
ss.close();
s.close();
}catch(Exception e)
{
System.exit(0);
}
}

class ServerRead extends Thread
{
public void run()
{
while(true)
{
try{
String str = dis.readUTF();
// System.out.println(&amp;quot;对方说:&amp;quot;+str);
ta.append(&amp;quot;客户端说：&amp;quot;+str+&amp;quot;\n&amp;quot;);
if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
{
close();
System.exit(0);
}
}catch(Exception e)
{
JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
return;
// e.printStackTrace();
}
}
}
}
class ServerWrite extends Thread
{
public void run()
{
tf.addActionListener(new TCPServerListener());
bn.addActionListener(new TCPServerListener());
}
}
class TCPServerListener implements ActionListener
{
@Override
public void actionPerformed(ActionEvent e)
{
try{
String str = tf.getText();
tf.setText(&amp;quot;&amp;quot;);
ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
dos.writeUTF(str);
if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
{
close();
System.exit(0);
}
}catch(Exception e1)
{
// e.printStackTrace();
System.exit(0);
} 
}
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.net.*;
import java.io.*;

// some error swing : controler
import javax.swing.*;

import java.awt.*;
import java.awt.event.*;
/**
* @author 叶昭良
* @time 2015年3月19日下午3:22:27
* @version TestNetworkTestClient4 V1.0
* 功能： 
步骤：
* 注意：
* 掌握：
思考：
* 回顾：
*/
public class TestClient4
{

/**
* @param args 
* 原因：
* 解决：
* 功能：
* 思考： 
* 步骤：
*/
public static void main(String[] args)
{
// TODO Auto-generated method stub
Font font = new Font(&amp;quot;Dialog&amp;quot;, Font.PLAIN, 12); //一下是改变默认的组建上显示的字体，这样更加美观一些
UIManager.put(&amp;quot;MenuBar.font&amp;quot;, font);
UIManager.put(&amp;quot;MenuItem.font&amp;quot;, font);
UIManager.put(&amp;quot;Menu.font&amp;quot;, font);
UIManager.put(&amp;quot;PopupMenu.font&amp;quot;, font);
UIManager.put(&amp;quot;ToolBar.font&amp;quot;, font);
UIManager.put(&amp;quot;ToolTip.font&amp;quot;, font);
UIManager.put(&amp;quot;TabbedPane.font&amp;quot;, font);
UIManager.put(&amp;quot;Label.font&amp;quot;, font);
UIManager.put(&amp;quot;List.font&amp;quot;, font);
UIManager.put(&amp;quot;ComboBox.font&amp;quot;, font);
UIManager.put(&amp;quot;Button.font&amp;quot;, font);
UIManager.put(&amp;quot;Table.font&amp;quot;, font);
UIManager.put(&amp;quot;TableHeader.font&amp;quot;, font);
UIManager.put(&amp;quot;Tree.font&amp;quot;, font);
UIManager.put(&amp;quot;TextField.font&amp;quot;, font);
UIManager.put(&amp;quot;TextArea.font&amp;quot;, font);
UIManager.put(&amp;quot;TitledBorder.font&amp;quot;, font);
UIManager.put(&amp;quot;OptionPane.font&amp;quot;, font);
UIManager.put(&amp;quot;RadioButton.font&amp;quot;, font);
UIManager.put(&amp;quot;CheckBox.font&amp;quot;, font);
UIManager.put(&amp;quot;ToggleButton.font&amp;quot;, font);
UIManager.put(&amp;quot;Dialog.font&amp;quot;, font);
UIManager.put(&amp;quot;Panel.font&amp;quot;, font);
new TCPClient().launch();
}

}
class TCPClient
{
// class variables
// class variables
// connect
private Socket s = null;
// data flow
private DataOutputStream dos = null;
private DataInputStream dis = null;
// UI
private Frame f = null;
private TextArea ta = null;
private TextField tf = null;
private Button bn = null;


public void launch()
{
createUI();
connect();
new ClientRead().start();
new ClientWrite().start();
}
// construct member
/*
public TCPClient()
{

}
*/
public void createUI()
{
Frame f = new Frame(&amp;quot;客户端&amp;quot;);
ta = new TextArea();
tf = new TextField();
Panel p = new Panel(new BorderLayout());
bn = new Button(&amp;quot;发送&amp;quot;);
p.add(tf,BorderLayout.CENTER);
p.add(bn,BorderLayout.EAST);

f.add(ta,BorderLayout.CENTER);
f.add(p,BorderLayout.SOUTH);

f.setSize(400,200);
f.setVisible(true);
//f.setVisable(true);
f.addWindowListener(new WindowAdapter()
{
public void windowClosing(WindowEvent e)
{
System.exit(0);
}
});
}
public void connect()
{
try{
s = new Socket(&amp;quot;127.0.0.1&amp;quot;,5599);
dis = new DataInputStream(s.getInputStream());
dos = new DataOutputStream(s.getOutputStream());
}catch(Exception e)
{
System.exit(0);
}
}
public void close()
{
try{
dis.close();
dos.close();
s.close();
}catch(Exception e)
{
System.exit(0);
}
}

class ClientRead extends Thread
{
public void run()
{
while(true)
{
try{
String str = dis.readUTF();
// System.out.println(&amp;quot;对方说:&amp;quot;+str);
ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
{
close();
System.exit(0);
}
}catch(Exception e)
{
JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
return;
// e.printStackTrace();
}
}
}
}
class ClientWrite extends Thread
{
public void run()
{
tf.addActionListener(new TCPClientListener());
bn.addActionListener(new TCPClientListener());
}
}
class TCPClientListener implements ActionListener
{
@Override
public void actionPerformed(ActionEvent e)
{
try{
String str = tf.getText();
tf.setText(&amp;quot;&amp;quot;);
ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
dos.writeUTF(str);
if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
{
close();
System.exit(0);
}
}catch(Exception e1)
{
// e.printStackTrace();
System.exit(0);
} 
}
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9C%8D%E5%8A%A1%E7%AB%AF.png&#34; alt=&#34;服务器端和客户端的对话窗口&#34;&gt;&lt;/p&gt;
&lt;p&gt;##重写TCPServer1 &amp;amp; TCPClient1 并加入了  String ip = s.getInetAddress().getHostAddress();
并且调整了编写风格，把所有类使用的变量都放在类中，并把socket创建和连接  接受和发送都放在构造函数中。类似于OOGTK的编写风格http://www.rupeng.com/forum/forum.php?mod=viewthread&amp;amp;tid=44377。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

/**
* @author    叶昭良
* @time      2015年3月22日下午3:49:11
* @version   TestNetworkRewriteTestServer1 V1.0
* 功能： 
                步骤：
                1: Server绑定端口
                2：接受
                3：循环接收
* 注意：  socket的主要作用就是   getOutputStream  和getInputStream来确定
*       表明socket交流的方向
* 掌握：
                思考：
* 回顾：
*/
import java.io.*;
import java.net.*;
public class RewriteTestServer1
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        ServerSocket ss = null;
        Socket s = null;
        DataInputStream dis = null;
        public RewriteTestServer1()
        {
                try
                {
                        ss = new ServerSocket(5566);
                        s = ss.accept();
                        String ip = s.getInetAddress().getHostAddress();
                        dis = new DataInputStream(s.getInputStream());
                        System.out.println(&amp;quot;客户端&amp;quot;+ip+&amp;quot; said: &amp;quot;+dis.readUTF());
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }finally
                {
                        try
                        {
                                dis.close();
                                s.close();
                        }catch(IOException e)
                        {
                                
                        }                
                }
                
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                new RewriteTestServer1();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;TCPClient1:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

/**
* @author    叶昭良
* @time      2015年3月22日下午3:54:39
* @version   TestNetworkRewriteTestClient1 V1.0
* 功能： 
                步骤：  
                1: Socket的建立
                2： 发送数据
                3：。。
* 注意：
* 掌握：
                思考：
* 回顾：
*/
import java.io.*;
import java.net.*;
public class RewriteTestClient1
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        Socket s = null;
        DataOutputStream dos = null;
        public RewriteTestClient1()
        {
                try
                {
                        s = new Socket(&amp;quot;127.0.0.1&amp;quot;,5566);
                        dos = new DataOutputStream(s.getOutputStream());
                        dos.writeUTF(&amp;quot;Hello&amp;quot;);
                        dos.flush();
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                new RewriteTestClient1();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;重写了TestServer2
功能：   在第一版本服务器的基础上  修正了客户端的只发送 不接受&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;    以及服务器端的只接受不发送
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;    并用BufferedReader获取System.in的内容输送到客户端
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当客户端 也就是ss.accept之后，服务器来了一声“欢迎，ohni sang 光临”
紧接着客户端做了动作，接收到了服务器来的欢迎词，然后开始写入 一些话提交给服务器
反复执行这个过程&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

/**
* @author    叶昭良
* @time      2015年3月22日下午4:08:24
* @version   TestNetworkRewriteTestServer2 V1.0
* 功能： 
*              在第一版本服务器的基础上  修正了客户端的只发送 不接受
*         以及服务器端的只接受不发送
*         并用BufferedReader获取System.in的内容输送到客户端
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾： 回顾了第一版本的ServerSocket   ss.accept()  以及DataInputStream(s.getInputStream());
*/
import java.io.*;
import java.net.*;
public class RewriteTestServer2
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        ServerSocket ss = null;
        Socket s = null;
        DataInputStream dis = null;
        DataOutputStream dos = null;
        BufferedReader br = null;
        String wordsFromClient  =null;
        String wordsFromServer  =null;
        public RewriteTestServer2()
        {
                createConnection();
                String ip = s.getInetAddress().getHostAddress();

                while(true)
                {
                        try
                        {
                                
                                wordsFromClient = dis.readUTF();
                                System.out.println(&amp;quot;客户端IP:&amp;quot;+ip+&amp;quot; said:&amp;quot;+wordsFromClient);
                                if(wordsFromClient.equalsIgnoreCase(&amp;quot;bye*&amp;quot;))
                                {
                                        break;
                                }
                                System.out.println(&amp;quot;服务器，请您输入你想对客户端说什么：&amp;quot;);
                                wordsFromServer = br.readLine();
                                dos.writeUTF(wordsFromServer);
                        } catch (IOException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }finally
                        {
                                try
                                {
                                        dos.close();
                                        dis.close();
                                        s.close();
                                } catch (IOException e)
                                {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                }
                        }
                        
                }
        }
        /**
         * 功能： 创建一个读的连接，用于读取客户端的socket数据
         *       创建一个写的连接，通过BufferedReader进行缓冲读取System.in的数据
         *       并通过DataOutputStream发送出去
         *       思考：        
         *       步骤：
         */
        private void createConnection()
        {
                try
                {
                        ss = new ServerSocket(5566);
                        s =  ss.accept();
                        dis = new DataInputStream(s.getInputStream());
                        dos = new DataOutputStream(s.getOutputStream());
                        //增加了下面两句
                        dos.writeUTF(&amp;quot;您好！我是服务器想要聊些什么:&amp;quot;);
                        dos.flush();
                        br = new BufferedReader(new InputStreamReader(System.in));
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;创建连接问题&amp;quot;);
                }
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                new RewriteTestServer2();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;RewriteTestClient2:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;
import java.io.*;
import java.net.*;
/**
* @author    叶昭良
* @time      2015年3月19日下午2:38:52
* @version   TestNetworkTestClient2 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class TestClient2
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Socket s1 = null;
                OutputStream os = null;
                InputStream is = null;
                DataOutputStream dos = null;
                DataInputStream dis = null;
                BufferedReader br = null;
                try
                {
                        s1 = new Socket(&amp;quot;127.0.0.1&amp;quot;,5566);
                        os = s1.getOutputStream();
                        is = s1.getInputStream();
                        dos = new DataOutputStream(os);
                        dis = new DataInputStream(is);
                        
                        dos.writeUTF(&amp;quot;Come to the world of net server&amp;quot;);
                        dos.flush();
                        
                        br = new BufferedReader(new InputStreamReader(System.in));
                        while(true)
                        {
                                String str = br.readLine();
                                dos.writeUTF(str);
                                if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                    break;
                str = dis.readUTF();
                System.out.println(&amp;quot;服务器 said that&amp;quot; + str+&amp;quot;\n&amp;quot;);
                                if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                    break;

                        }
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;我遇到了一个问题：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;java.net.SocketException: socket closed
        at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(SocketInputStream.java:150)
        at java.net.SocketInputStream.read(SocketInputStream.java:121)
        at java.net.SocketInputStream.read(SocketInputStream.java:203)
        at java.io.DataInputStream.readUnsignedShort(DataInputStream.java:337)
        at java.io.DataInputStream.readUTF(DataInputStream.java:589)
        at java.io.DataInputStream.readUTF(DataInputStream.java:564)
        at TestNetwork.RewriteTestClient2.&amp;lt;init&amp;gt;(RewriteTestClient2.java:52)
        at TestNetwork.RewriteTestClient2.main(RewriteTestClient2.java:100)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;于是我删掉了两个finally解决了问题，但是我不明白为什么？&lt;/p&gt;
&lt;p&gt;重写了RewriteTestServer3 &amp;amp; RewriteTestClient3 ：
出现的问题： 在客户端连接上后，客户端发送数据可以到服务器端，接着切换到服务器端，但是服务器的输入出现了问题，无论你输入一个字还是n个字都无法切换回客户端了
主要不同点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;    1: 把读和写的过程 从while中脱离出来 变成线程的形式(采用了implements形式出现而不是 extends threads)
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt; 即读线程和写线程
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2：把BufferedReader放入到写出线程中 ，因为只有在那边读取控制台的输入字符
3:   把线程的开启部分放在了构造函数中  而不是  main函数中。
步骤：
测试了： 把implements Runnable 该回到extends threads结果一样&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;       把线程的定义和开启放在main函数，并让dos dis变为static变量，也不能解决问题，依旧是卡在服务器中，无法切回到客户端
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一个有趣的问题：（是不是跟synchronized有关系，没关系，加进去也没什么效果）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;class ServerReWrite21 extends Thread
{
        private DataOutputStream dos = null;
        private BufferedReader br = null;
        private String wordsFromServer = null;
        public ServerReWrite21(DataOutputStream dos)
        {
                this.dos = dos;
        }
        
        @Override
        public void run()
        {
                //System.out.println(&amp;quot;dos=&amp;quot;+dos);  如果在ServerReWrite21中加入了这句话，则运行客户端之后 直接跳到这边  为什么？？？？？？？
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;有问题的RewriteTestServer3&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

/**
* @author    叶昭良
* @time      2015年3月22日下午4:49:25
* @version   TestNetworkRewriteTestServer3 V1.0
* 功能：  
*         1: 把读和写的过程 从while中脱离出来 变成线程的形式
*      即读线程和写线程
*  2：把BufferedReader放入到写出线程中 ，因为只有在那边读取控制台的输入字符
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
import java.io.*;
import java.net.*;
public class RewriteTestServer31
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        ServerSocket ss = null;
        Socket s = null;
         DataInputStream dis = null;
         DataOutputStream dos = null;
         
        public RewriteTestServer31()
        {
                createConnection();
                ServerReRead21 sr= new ServerReRead21(dis);
                ServerReWrite21 sw = new ServerReWrite21(dos);
                sr.start();
                sw.start();
        }
        
        /**
         * 功能： 创建一个读的连接，用于读取客户端的socket数据
         *       创建一个写的连接，通过BufferedReader进行缓冲读取System.in的数据
         *       并通过DataOutputStream发送出去
         *       思考：        
         *       步骤：
         */
        private void createConnection()
        {
                try
                {
                        ss = new ServerSocket(5566);
                        s =  ss.accept();
                        dis = new DataInputStream(s.getInputStream());
                        dos = new DataOutputStream(s.getOutputStream());
                        //增加了下面两句
                        dos.writeUTF(&amp;quot;您好！我是服务器想要聊些什么:&amp;quot;);
                        dos.flush();
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;创建连接问题&amp;quot;);
                }
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                new RewriteTestServer31();
        }

}

class ServerReRead21 extends Thread
{
        private DataInputStream dis = null;
        private String wordsFromClient = null;
        public ServerReRead21(DataInputStream dis)
        {
                this.dis = dis;
        }
        @Override
        public void run()
        {
                // TODO Auto-generated method stub
                try
                {
                        wordsFromClient = dis.readUTF();
                        System.out.println(&amp;quot;客户端对你说：&amp;quot;+wordsFromClient);  
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                } 
        }
        
}

class ServerReWrite21 extends Thread
{
        private DataOutputStream dos = null;
        private BufferedReader br = null;
        private String wordsFromServer = null;
        public ServerReWrite21(DataOutputStream dos)
        {
                this.dos = dos;
        }
        
        @Override
        public void run()
        {
                //System.out.println(&amp;quot;dos=&amp;quot;+dos);
                // TODO Auto-generated method stub
                br = new BufferedReader(new InputStreamReader(System.in));
                while(true)
                {
                        try
                        {
                                wordsFromServer = br.readLine();
                                dos.writeUTF(wordsFromServer);
                                //要不要break????? if(bye){break}
                        }catch(IOException e)
                        {
                                
                        }
                }
        }
        
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;有问题的RewriteTestClient31:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.ServerSocket;
import java.net.Socket;

/**
* @author    叶昭良
* @time      2015年3月22日下午5:12:56
* @version   TestNetworkRewriteTestClient3 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestClient31
{

        Socket s = null;
        DataInputStream dis = null;
    DataOutputStream dos = null;
        
        public RewriteTestClient31()
        {
                createConnection();
                ClientReRead31 sr = new ClientReRead31(dis);
                ClientReWrite31 sw = new ClientReWrite31(dos);
                sr.start();
                sw.start();        
        }
        
        /**
         * 功能： 创建一个读的连接，用于读取客户端的socket数据
         *       创建一个写的连接，通过BufferedReader进行缓冲读取System.in的数据
         *       并通过DataOutputStream发送出去
         *       思考：        
         *       步骤：
         */
        private void createConnection()
        {
                try
                {
                        s= new Socket(&amp;quot;127.0.0.1&amp;quot;,5566);
                        dis = new DataInputStream(s.getInputStream());
                        dos = new DataOutputStream(s.getOutputStream());
                        //增加了下面两句
                        
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;创建连接问题&amp;quot;);
                }
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                new RewriteTestClient31();

        }

}
//主要更换地方 wordsFromServer  和服务器的不同地方
class ClientReRead31 extends Thread
{
        private DataInputStream dis = null;
        private String wordsFromServer  = null;
        public ClientReRead31(DataInputStream dis)
        {
                this.dis = dis;
        }
        @Override
        public void run()
        {
                // TODO Auto-generated method stub
                try
                {
                        wordsFromServer = dis.readUTF();
                        System.out.println(&amp;quot;服务器端对你说：&amp;quot;+wordsFromServer);  
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                } 
        }
        
}
//主要更换地方 wordsFromClient  和服务器的不同地方
class ClientReWrite31 extends Thread
{
        private DataOutputStream dos = null;
        private BufferedReader br = null;
        private String  wordsFromClient= null;
        public ClientReWrite31(DataOutputStream dos)
        {
                this.dos = dos;
        }
        @Override
        public void run()
        {
                // TODO Auto-generated method stub
                br = new BufferedReader(new InputStreamReader(System.in));
                while(true)
                {
                        try
                        {
                                wordsFromClient = br.readLine();
                                dos.writeUTF(wordsFromClient);
                                //要不要break????? if(bye){break}
                        }catch(IOException e)
                        {
                                
                        }
                }
        }
        
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果我把所有的变量定义在main当中则是没有问题的（在implements Runnable)&lt;/p&gt;
&lt;p&gt;没问题的版本
RewriteTestServer3extends&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.ServerSocket;
import java.net.Socket;

/**
* @author    叶昭良
* @time      2015年3月22日下午5:57:16
* @version   TestNetworkRewriteTestServer3extends V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestServer3extends
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                // TODO Auto-generated method stub
        ServerSocket ss = null;
        Socket s = null;
        DataOutputStream dos  = null;
        DataInputStream dis = null;
                try
                {
                        ss = new ServerSocket(8888);
                        s = ss.accept();
                        dos = new DataOutputStream(s.getOutputStream());

                        dis  = new DataInputStream(s.getInputStream());
                       

                new Thread(new ServerReadImp(dis)).start();
                new Thread(new ServerWriteImp(dos)).start();
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }

        }

}
class ServerReadImp implements Runnable
{
    private DataInputStream dis = null;
    public ServerReadImp(DataInputStream dis)
    {
        this.dis = dis;
    }

    public void run()
    {
        while(true)
        {
           try{
                String str = dis.readUTF();
                System.out.println(&amp;quot;客户端说:&amp;quot;+str);
                if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                    break;
           }catch(Exception e)
           {
               e.printStackTrace();
           }
        }
    }
}
class ServerWriteImp implements Runnable
{
    private DataOutputStream dos = null;
    public ServerWriteImp(DataOutputStream dos)
    {
        this.dos = dos;
    }

    public void run()
    {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        while(true)
        {
           try{
                String str = br.readLine();
                dos.writeUTF(str);
                if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                    break;
           }catch(Exception e)
           {
               e.printStackTrace();
           }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;问题较少的RewriteTestClient3extends&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.InputStreamReader;
import java.net.Socket;

/**
* @author    叶昭良
* @time      2015年3月22日下午5:57:44
* @version   TestNetworkRewriteTestClient3extends V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestClient3extends 
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */

        public static void main(String[] args) throws Exception
        {
                // TODO Auto-generated method stub
        Socket s = new Socket(&amp;quot;127.0.0.1&amp;quot;,8888);
        DataOutputStream dos = new DataOutputStream(s.getOutputStream());

        DataInputStream dis = new DataInputStream(s.getInputStream());

        new Thread(new ClientReadImp(dis)).start();
        new Thread(new ClientWriteImp(dos)).start();

        }

}
class ClientReadImp implements Runnable
{
    private DataInputStream dis = null;
    public ClientReadImp(DataInputStream dis)
    {
        this.dis = dis;
    }

    public void run()
    {
        while(true)
        {
           try{
                String str = dis.readUTF();
                System.out.println(&amp;quot;服务器说:&amp;quot;+str);
                if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                    break;
           }catch(Exception e)
           {
               e.printStackTrace();
           }
        }
    }
}
class ClientWriteImp implements Runnable
{
    private DataOutputStream dos = null;
    public ClientWriteImp(DataOutputStream dos)
    {
        this.dos = dos;
    }

    public void run()
    {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        while(true)
        {
           try{
                String str = br.readLine();
                dos.writeUTF(str);
                if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                    break;
           }catch(Exception e)
           {
               e.printStackTrace();
           }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以看到的确是和变量放在哪里有着很大的关系，但是暂时不知道怎么解释？
还有网络编程，当服务器发送过后，是如何切换控制权的？（服务器的run处于while循环中，如何切换，有notify?(在生产和消费当中有wait and notify进行通知）&lt;/p&gt;
&lt;p&gt;另外前两个版本（RewriteTCPServer1 RewriteTCPServer2)我进行重新改写则是没有问题，第三个版本(RewriteTCPServer3)加入了线程则是有问题,
所以程序线程+程序变量肯定有一个存在问题，具体不清楚&lt;/p&gt;
&lt;p&gt;通过学习第十五节的网络编程，了解到while(true){ss.accept() ;  new线程的作用} 之前TCPServer3和RewriteServer3并没有多线程的效果，得在
服务器当中添加如下代码：增加一个while(true) 让服务器一直在等待连接（不然再ctrl+F11 并没有新的客户端连接服务器）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void createConnection()
        {
                try
                {
                        ss = new ServerSocket(5566);
                        while(true)
                        {
                                s =  ss.accept();
                                ServerReRead2 sr = new ServerReRead2(dis);
                                ServerReWrite2 sw = new ServerReWrite2(dos);
                                Thread t1 = new Thread(sr);
                                Thread t2 = new Thread(sw);
                                t1.start();
                                t2.start();
                                dis = new DataInputStream(s.getInputStream());
                                dos = new DataOutputStream(s.getOutputStream());
                                //增加了下面两句
                                dos.writeUTF(&amp;quot;您好！我是服务器想要聊些什么:&amp;quot;);
                                dos.flush();
                        }
                                

                }catch(IOException e)
                {
                        System.out.println(&amp;quot;创建连接问题&amp;quot;);
                }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;有了这个意识之后，我发现之前的所谓的多线程的UI版本的TCPServer4 &amp;amp;  TCPClient4也是lier,根本没有实现。
具体是： 一个服务器端对应一个客户端，虽然你写着extends thread，也start了，但是在ss.accept
那边根本就没有循环的接收，暂时进行修改未通过，这是另一个问题。&lt;/p&gt;
&lt;p&gt;有进步了。改进了TCPServer4
1：客户端可以新建多个（但是这个多个还是有问题)&amp;mdash;&amp;gt;具体分析socket的while循环放的有问题（有待进一步测试）&lt;/p&gt;
&lt;p&gt;问题1：服务器无法发送出去数据
问题2：客户端不切换 还好可以，一切换之后发送一条就卡死了&lt;/p&gt;
&lt;p&gt;有问题的
RewriteServer4:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

/**
* @author    叶昭良
* @time      2015年3月22日下午10:08:18
* @version   TestNetworkRewriteTestServer4 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.*;
import java.net.*;

import javax.swing.JOptionPane;


public class RewriteTestServer4
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                new TCPServer1().launch();
        }

}


class TCPServer1
{
        // class variables
        // class variables
        // connect
         private ServerSocket ss = null;
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private Frame f = null;
         private TextArea ta = null;
         private TextField tf = null;
         private Button  bn = null;

       
         public void launch()
         {
             createUI();
             connect();

         }
        // construct member
        /*
        public TCPServer()
        {

        }
        */
        public void createUI()
        {
            Frame f = new Frame(&amp;quot;服务器&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
/*            tf.addActionListener(new TCPServerListener());
            bn.addActionListener(new TCPServerListener());*/
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        public void connect()
        {
                
            try
            {
                    ss = new ServerSocket(5599);
                    while(true)
                    {
                            //阻塞这边 等待客户端的连接
                        s = ss.accept();
                        dis = new DataInputStream(s.getInputStream());
                        dos = new DataOutputStream(s.getOutputStream());
                        dos.writeUTF(&amp;quot;欢迎你的到来&amp;quot;+s.getInetAddress().getHostAddress());
                        new UserReadThread().start();
                        new UserWriteThread().start();
                        System.out.println(Thread.currentThread().getName()+&amp;quot;已开启&amp;quot;);
                    }
                
            }catch(Exception e)
            {
                    System.out.println(&amp;quot;服务器端异常&amp;quot;);
               // System.exit(0);
            }
        }
        public void close()
        {
            try{
                ss.close();
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
        
        class UserReadThread extends Thread
        {
                @Override
                public void run()
                {
                        while(true)
                {
                   try{
                        String str = dis.readUTF();
              //          System.out.println(&amp;quot;对方说:&amp;quot;+str);
                        ta.append(&amp;quot;客户端说：&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e)
                   {
                       JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
                       return;
                   //    e.printStackTrace();
                   }
                }
                }
        }
        class UserWriteThread extends Thread
        {
                @Override
                public void run()
                {
                tf.addActionListener(new TCPServerListener());
                bn.addActionListener(new TCPServerListener());
                }
        }
        class TCPServerListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                           String str = tf.getText();
                       if(!str.isEmpty())
                       {
                               tf.setText(&amp;quot;&amp;quot;);
                                ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                dos.writeUTF(str);
                                if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                {
                                    close();
                                    System.exit(0);
                                }
                       }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;RewriteTestClient4:
/**&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;解释：
*/
package TestNetwork;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.Socket;&lt;/p&gt;
&lt;p&gt;import javax.swing.JOptionPane;&lt;/p&gt;
&lt;p&gt;import TestNetwork.TCPClient.TCPClientListener;&lt;/p&gt;
&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;@author    叶昭良&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@time      2015年3月22日下午10:08:37&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@version   TestNetworkRewriteTestClient4 V1.0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;功能：
步骤：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;掌握：
思考：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;回顾：
*/
public class RewriteTestClient4
{&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  /**
   * @param args 
   * 原因：
   * 解决：
   * 功能：
   *       思考：        
   *       步骤：
   */
  public static void main(String[] args)
  {
          // TODO Auto-generated method stub
           new TCPClient1().launch();
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;class TCPClient1
{
// class variables
// class variables
// connect
private Socket s = null;
// data flow
private DataOutputStream dos = null;
private DataInputStream dis = null;
// UI
private Frame f = null;
private TextArea ta = null;
private TextField tf = null;
private Button  bn = null;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;     public void launch()
     {
         createUI();
         connect();
       //  new ClientRead().start();
        // new ClientWrite().start();
     }
    // construct member
    /*
    public TCPClient()
    {

    }
    */
    public void createUI()
    {
        Frame f = new Frame(&amp;quot;客户端&amp;quot;);
        ta = new TextArea();
        tf = new TextField();
        Panel p = new Panel(new BorderLayout());
        bn = new Button(&amp;quot;发送&amp;quot;);
        p.add(tf,BorderLayout.CENTER);
        p.add(bn,BorderLayout.EAST);

        f.add(ta,BorderLayout.CENTER);
        f.add(p,BorderLayout.SOUTH);

        f.setSize(400,200);
        f.setVisible(true);
        //f.setVisable(true);
            tf.addActionListener(new TCPClientListener());
            bn.addActionListener(new TCPClientListener());
        f.addWindowListener(new WindowAdapter()
                {
                    public void windowClosing(WindowEvent e)
                    {
                        System.exit(0);
                    }
                });
    }
    public void connect()
    {
        try{
            s = new Socket(&amp;quot;127.0.0.2&amp;quot;,5599);
            dis = new DataInputStream(s.getInputStream());
            dos = new DataOutputStream(s.getOutputStream());
                try{
                        //少了这个while不行！则不能循环接收
                        while(true)
                        {
                                      String str = dis.readUTF();
                                   //System.out.println(&amp;quot;对方说:&amp;quot;+str);
                                   ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                   if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                   {
                                       close();
                                       System.exit(0);
                                   }
                        }
                           
                  }catch(Exception e)
                  {
                      JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
                      return;
                  }
               
        }catch(Exception e)
        {
                System.out.println(&amp;quot;客户端异常&amp;quot;);
            //System.exit(0);
        }
    }
    public void close()
    {
        try{
            dis.close();
            dos.close();
            s.close();
        }catch(Exception e)
        {
            System.exit(0);
        }
    }


    class TCPClientListener implements ActionListener
    {
        @Override
        public void actionPerformed(ActionEvent e)
        {
               try{
                    String str = tf.getText();
                    tf.setText(&amp;quot;&amp;quot;);
                    ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                    dos.writeUTF(str);
                    if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                    {
                        close();
                        System.exit(0);
                    }
               }catch(Exception e1)
               {
                  // e.printStackTrace();
                  System.exit(0);
               } 
        }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;结果：
![有问题的Server和Client图](/images/java/结果.png)


1： 改用在main方法中定义循环的socket等待试试，即
     ServerSocket ss = new ServerSocket(5599);
        
            while(true)
            {
                    new TCPServer1(ss.accept()).launch();
            }
复制代码
去掉ServerRead那边的一种Connection函数中的循环的socket.accept:

```java
public void connect()
        {
                
            try
            {
                    //while(true)
                    //{
                            //阻塞这边 等待客户端的连接
                        dis = new DataInputStream(s.getInputStream());
                        dos = new DataOutputStream(s.getOutputStream());
                        dos.writeUTF(&amp;quot;欢迎你的到来&amp;quot;+s.getInetAddress().getHostAddress());
                        new UserReadThread().start();
                        new UserWriteThread().start();
                        System.out.println(Thread.currentThread().getName()+&amp;quot;已开启&amp;quot;);
                    //}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2: 使用静态代码段的方法，只创建一个UI界面，不再把createUI放在launch当中，否则 只有在连接上客户端会创建客户端的同时也创建了服务器
服务器一直在增加，这不是我们所想的，只要一个服务器，于是采用static方法&lt;/p&gt;
&lt;p&gt;至少在这边已经开始注意一个问题： 到底Client的read &amp;amp; write要不要加入线程？ 这边是没有，仅仅是服务器的read &amp;amp; write加入了线程？&lt;/p&gt;
&lt;p&gt;具体的RewreiteTestServer4:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

/**
* @author    叶昭良
* @time      2015年3月22日下午10:08:18
* @version   TestNetworkRewriteTestServer4 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.*;
import java.net.*;

import javax.swing.JOptionPane;


public class RewriteTestServer4
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args) throws Exception
        {
                // TODO Auto-generated method stub
            ServerSocket ss = new ServerSocket(5599);
        
            while(true)
            {
                    new TCPServer1(ss.accept()).launch();
            }
            
        }

}


class TCPServer1
{
        // class variables
        // class variables
        // connect
         
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private static Frame f = null;
         private static TextArea ta = null;
         private static TextField tf = null;
         private static Button  bn = null;
         static
         {
                 createUI();
         }
         public  TCPServer1(Socket s)
         {
                 this.s = s;
         }
       
         public void launch()
         {

             connect();

         }
        // construct member
        /*
        public TCPServer()
        {

        }
        */
        public static void createUI()
        {
            Frame f = new Frame(&amp;quot;服务器&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
/*            tf.addActionListener(new TCPServerListener());
            bn.addActionListener(new TCPServerListener());*/
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        public void connect()
        {
                
            try
            {
                    //while(true)
                    //{
                            //阻塞这边 等待客户端的连接
                        dis = new DataInputStream(s.getInputStream());
                        dos = new DataOutputStream(s.getOutputStream());
                        dos.writeUTF(&amp;quot;欢迎你的到来&amp;quot;+s.getInetAddress().getHostAddress());
                        new UserReadThread().start();
                        new UserWriteThread().start();
                        System.out.println(Thread.currentThread().getName()+&amp;quot;已开启&amp;quot;);
                    //}
                
            }catch(Exception e)
            {
                    System.out.println(&amp;quot;服务器端异常&amp;quot;);
               // System.exit(0);
            }
        }
        public void close()
        {
            try{
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
        
        class UserReadThread extends Thread
        {
                @Override
                public void run()
                {
                        while(true)
                {
                   try{
                        String str = dis.readUTF();
              //          System.out.println(&amp;quot;对方说:&amp;quot;+str);
                        ta.append(&amp;quot;客户端说：&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e)
                   {
                       JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
                       return;
                   //    e.printStackTrace();
                   }
                }
                }
        }
        class UserWriteThread extends Thread
        {
                @Override
                public void run()
                {
                tf.addActionListener(new TCPServerListener());
                bn.addActionListener(new TCPServerListener());
                }
        }
        class TCPServerListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                           String str = tf.getText();
                       if(!str.isEmpty())
                       {
                               tf.setText(&amp;quot;&amp;quot;);
                                ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                dos.writeUTF(str);
                                if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                {
                                    close();
                                    System.exit(0);
                                }
                       }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;RewriteClient4:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.Socket;

import javax.swing.JOptionPane;

import TestNetwork.TCPClient.TCPClientListener;

/**
* @author    叶昭良
* @time      2015年3月22日下午10:08:37
* @version   TestNetworkRewriteTestClient4 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestClient4
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                 new TCPClient1().launch();
        }

}

class TCPClient1
{
        // class variables
        // class variables
        // connect
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private Frame f = null;
         private TextArea ta = null;
         private TextField tf = null;
         private Button  bn = null;

       
         public void launch()
         {
             createUI();
             connect();
           //  new ClientRead().start();
            // new ClientWrite().start();
         }
        // construct member
        /*
        public TCPClient()
        {

        }
        */
        public void createUI()
        {
            Frame f = new Frame(&amp;quot;客户端&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
                tf.addActionListener(new TCPClientListener());
                bn.addActionListener(new TCPClientListener());
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        public void connect()
        {
            try{
                s = new Socket(&amp;quot;127.0.0.1&amp;quot;,5599);
                dis = new DataInputStream(s.getInputStream());
                dos = new DataOutputStream(s.getOutputStream());
                    try{
                            //少了这个while不行！则不能循环接收
                            while(true)
                            {
                                          String str = dis.readUTF();
                                       //System.out.println(&amp;quot;对方说:&amp;quot;+str);
                                       ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                       if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                       {
                                           close();
                                           System.exit(0);
                                       }
                            }
                               
                      }catch(Exception e)
                      {
                          JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
                          return;
                      }
                   
            }catch(Exception e)
            {
                    System.out.println(&amp;quot;客户端异常&amp;quot;);
                //System.exit(0);
            }
        }
        public void close()
        {
            try{
                dis.close();
                dos.close();
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }


        class TCPClientListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                        String str = tf.getText();
                        tf.setText(&amp;quot;&amp;quot;);
                        ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;p&gt;通过分析发现，的确是需要把socket.accept放在main中，而不是connection中！ 为什么？ 也许是connection会跳出？ 具体的不太清楚，如果有人知道求证明之。。。。&lt;/p&gt;
&lt;p&gt;另外还存在一个问题，为什么服务器发出的数据只是放在第一个连接的地方？ 这是不是跟Client没有线程有关系，如果我也建个clientRead &amp;amp; clientWrite线程？
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E5%88%87%E6%8D%A2%E4%B8%8D%E6%88%90%E9%97%AE%E9%A2%98.png&#34; alt=&#34;现在的切换和传递都不成问题&#34;&gt;&lt;/p&gt;
&lt;p&gt;1：增加了两个ClientRead &amp;amp; ClientWrite两个线程，尝试看一下是否可以群发，
2： 并把socket的创建 提到main当中&lt;/p&gt;
&lt;p&gt;Client的重写：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.Socket;

import javax.swing.JOptionPane;



/**
* @author    叶昭良
* @time      2015年3月22日下午10:08:37
* @version   TestNetworkRewriteTestClient4 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestClient4
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Socket s  = null;
                 try
                {
                        s = new Socket(&amp;quot;127.0.0.1&amp;quot;,5599);
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                 new TCPClient1(s).launch();
        }

}

class TCPClient1
{
        // class variables
        // class variables
        // connect
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private Frame f = null;
         private TextArea ta = null;
         private TextField tf = null;
         private Button  bn = null;
         public TCPClient1(Socket s)
         {
                 this.s = s;
         }
       
         public void launch()
         {
             createUI();
             connect();
             new ClientRead(dis).start();
             new ClientWrite(dos).start();
         }
        // construct member
        /*
        public TCPClient()
        {

        }
        */
        public void createUI()
        {
            Frame f = new Frame(&amp;quot;客户端&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
                tf.addActionListener(new TCPClientListener());
                bn.addActionListener(new TCPClientListener());
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        public void connect()
        {
            try{
                
                dis = new DataInputStream(s.getInputStream());
                dos = new DataOutputStream(s.getOutputStream());
                   
            }catch(Exception e)
            {
                    System.out.println(&amp;quot;客户端异常&amp;quot;);
                //System.exit(0);
            }
        }
        public void close()
        {
            try{
                dis.close();
                dos.close();
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
        class ClientRead extends Thread
        {
            private DataInputStream dis = null;
            public ClientRead(DataInputStream dis)
            {
                this.dis = dis;
            }

            public void run()
            {
                while(true)
                {
                   try{
                        String str = dis.readUTF();
                        ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                        System.out.println(&amp;quot;服务器说:&amp;quot;+str);
                        if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                            break;
                   }catch(Exception e)
                   {
                              JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
                              return;
                   }
                }
            }
        }
        class ClientWrite extends Thread
        {
            private DataOutputStream dos = null;
            public ClientWrite(DataOutputStream dos)
            {
                this.dos = dos;
            }

            public void run()
            {
                BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
                while(true)
                {
                   try{
                        String str = br.readLine();
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;byebye&amp;quot;))
                            break;
                   }catch(Exception e)
                   {
                       e.printStackTrace();
                   }
                }
            }
        }

        class TCPClientListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                        String str = tf.getText();
                        tf.setText(&amp;quot;&amp;quot;);
                        ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：
结果分析发现，并没有丝毫的改进。what a pity.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/yiranmeiyou.png&#34; alt=&#34;结果还是跟上例的client没有线程一样&#34;&gt;&lt;/p&gt;
&lt;p&gt;参考此文进行修改：&lt;/p&gt;
&lt;p&gt;1：加入了三个主要集合&lt;br&gt;
用户   user_list
线程集
消息集
2：服务器端的主要修正：
1.在线程类的构造函数都添加 了start() 开启线程
2.删掉了ServerWrite &amp;amp;ServerRead线程  都整合到ThreadServer类中
3.增加了一个PrintOutThread用于向客户端发送消息
3：客户端的主要修正：
新建了一个readLineThread() 读取服务器数据，并传递客户端数据
删除了ClientReader  &amp;amp; ClientWriter  &amp;amp; launch等函数&lt;/p&gt;
&lt;p&gt;基本能够实现转发的功能，但是
存在的问题：开启多个则计算机变得特别卡&lt;/p&gt;
&lt;p&gt;RewriteServer5的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.*;





/**
* @author    叶昭良
* @time      2015年3月23日上午12:41:10
* @version   TestNetworkRewriteTestServer5 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestServer5
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args) throws Exception
        {
                // TODO Auto-generated method stub
            ServerSocket ss = new ServerSocket(5599);
        while(true)
        {
                new TCPServer2(ss.accept());
        }
            
        }

}
class TCPServer2
{
        // class variables
        // class variables
        // connect
         
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private static Frame f = null;
         private static TextArea ta = null;
         private static TextField tf = null;
         private static Button  bn = null;
         
         private static boolean isPrint = false;//是否输出消息标志
         private static List user_list = new ArrayList();//登陆用户集合
         private static List&amp;lt;ServerThread&amp;gt; thread_list = new ArrayList&amp;lt;ServerThread&amp;gt;();//服务器已启用的线程集合
         private static LinkedList&amp;lt;String&amp;gt; message_list = new LinkedList&amp;lt;String&amp;gt;();//存放消息队列
      
         static
         {
                 createUI();
         }
         public  TCPServer2(Socket s) throws Exception
         {
                 this.s = s;
                 new PrintOutThread();//创建向客户端发送消息线程
             new ServerThread(this.s);  
             //本以为可以让其线程安全的，没想到没什么效果 反而更卡
/*             Collections.synchronizedList(user_list);
             Collections.synchronizedList(thread_list);
             Collections.synchronizedList(message_list);*/
            // launch();
                 
         }
       
        // construct member
        /*
        public TCPServer()
        {

        }
        */
        public static void createUI()
        {
            Frame f = new Frame(&amp;quot;服务器&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
/*            tf.addActionListener(new TCPServerListener());
            bn.addActionListener(new TCPServerListener());*/
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        

        public void close()
        {
            try{
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
     
        class TCPServerListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                           String str = tf.getText();
                       if(!str.isEmpty())
                       {
                               tf.setText(&amp;quot;&amp;quot;);
                                ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                dos.writeUTF(str);
                                if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                {
                                    close();
                                    System.exit(0);
                                }
                       }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
        
        /**
         * 服务器线程类
         */
        class ServerThread extends Thread{
                private Socket client;
                private String name = null;
                public ServerThread(Socket s) throws Exception
                {
                        this.client = s;
                        dis = new DataInputStream(client.getInputStream());
                dos = new DataOutputStream(client.getOutputStream());
                dos.writeUTF(&amp;quot;成功连上服务器&amp;quot;+client.getInetAddress().getHostAddress());
                dos.writeUTF(Thread.currentThread().getName()+&amp;quot;已开启&amp;quot;+&amp;quot;请输入你的姓名&amp;quot;);
                this.start();
                tf.addActionListener(new TCPServerListener());
                bn.addActionListener(new TCPServerListener());
                }
                @Override
                public void run()
                {
                        try
                        {
                                int flag = 0 ;
                                String line = dis.readUTF();
                                while(!&amp;quot;bye&amp;quot;.equals(line))
                                {
                                        //查看在线用户列表
                        if (&amp;quot;showuser&amp;quot;.equals(line)) {
                            dos.writeUTF(this.listOnlineUsers());
                            line = dis.readUTF();
                        }
                        //第一次进入，保存名字

                        if(flag++ ==0){
                            name = line;
                            user_list.add(name);
                            thread_list.add(this);
                            System.out.println(&amp;quot;this=&amp;quot;+this);
                            dos.writeUTF(name +&amp;quot;你好,可以开始聊天了...&amp;quot;);
                            this.pushMessage(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt;进入聊天室...+\n&amp;quot;);
                            ta.append(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt;进入聊天室...\n&amp;quot;);
                        }else{
                                ta.append(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt; say : &amp;quot; + line+&amp;quot;\n&amp;quot;);
                                this.pushMessage(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt; say : &amp;quot; + line+&amp;quot;\n&amp;quot;);
                        }
                        line = dis.readUTF();
                                }
                        }catch(IOException e)
                        {
                                
                        }
                }
                
                 //放入消息队列末尾，准备发送给客户端
            private void pushMessage(String msg){
                message_list.addLast(msg);
                isPrint =true;
            }
              
            //向客户端发送一条消息(在PrintOutThread 有使用 于是变成了public修饰)
            public void sendMessage(String msg) throws Exception{
                dos.writeUTF(msg);
                dos.flush();
            }
              
            //统计在线用户列表  需要在showuser中使用  改为public
            private String listOnlineUsers() {
                String s =&amp;quot;--- 在线用户列表 ---\015\012&amp;quot;;
                for (int i =0; i &amp;lt; user_list.size(); i++) {
                    s +=&amp;quot;[&amp;quot; + user_list.get(i) +&amp;quot;]\015\012&amp;quot;;
                }
                s +=&amp;quot;--------------------&amp;quot;;
                return s;
            }
        }
        /**
         * 监听是否有输出消息请求线程类,向客户端发送消息
         */
        class PrintOutThread extends Thread
        {
            public PrintOutThread()
            {
                start();
            }
              
            @Override
            public void run() 
            {
                while(true){
                    if(isPrint){//将缓存在队列中的消息按顺序发送到各客户端，并从队列中清除。
                        String message = message_list.getFirst();
                        for (ServerThread thread : thread_list) 
                        {
                            try
                                                        {
                                                                thread.sendMessage(message);
                                                        } catch (Exception e)
                                                        {
                                                                // TODO Auto-generated catch block
                                                                e.printStackTrace();
                                                        }
                        }
                        message_list.removeFirst();
                        isPrint = message_list.size() &amp;gt;0 ?true :false;
                    }
                }
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;RewriteClient5的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.Socket;

import javax.swing.JOptionPane;

import TestNetwork.TCPClient1.ClientRead;
import TestNetwork.TCPClient1.ClientWrite;
import TestNetwork.TCPClient1.TCPClientListener;

/**
* @author    叶昭良
* @time      2015年3月23日上午1:57:54
* @version   TestNetworkRewriteTestClient5 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestClient5
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args) throws Exception
        {
                // TODO Auto-generated method stub
                Socket s  = null;
                s = new Socket(&amp;quot;127.0.0.1&amp;quot;,5599);

                 new TCPClient5(s);
        }

}
class TCPClient5
{
        // class variables
        // class variables
        // connect
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private Frame f = null;
         private TextArea ta = null;
         private TextField tf = null;
         private Button  bn = null;
         
         /**
          * 与服务器连接，并输入发送消息
          */
         public TCPClient5(Socket s) throws Exception
         {
                 this.s = s;
                 dis = new DataInputStream(s.getInputStream());
             dos = new DataOutputStream(s.getOutputStream());
             createUI();
             //new ClientRead(dis);
             //new ClientWrite(dos);
             new readLineThread();

         }
         /**
          * 用于监听服务器端向客户端发送消息线程类
          */
  
        public void createUI()
        {
            Frame f = new Frame(&amp;quot;客户端&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
                tf.addActionListener(new TCPClientListener());
                bn.addActionListener(new TCPClientListener());
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }

        public void close()
        {
            try{
                dis.close();
                dos.close();
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
        /**
         * 用于监听服务器端向客户端发送消息线程类
         */
        class readLineThread extends Thread
        {
              
            private BufferedReader buff = null;;
            public readLineThread(){
                    start();
                
            }
              
            @Override
            public void run() {
                try {
                    while(true){
                        String result = dis.readUTF();
                        if(&amp;quot;byeClient&amp;quot;.equals(result)){//客户端申请退出，服务端返回确认退出
                            break;
                        }else{//输出服务端发送消息
                                //ta.append(result);
                            System.out.println(result);
                           // dos.writeUTF(result);
                            ta.append(&amp;quot;服务器传递说:&amp;quot;+result+&amp;quot;\n&amp;quot;);
                            if(result.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                            {
                                close();
                                System.exit(0);
                            }
                        }
                    }
                }catch (Exception e) {
                }
            }
        }
        
        class TCPClientListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                        String str = tf.getText();
                        tf.setText(&amp;quot;&amp;quot;);
                        ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果： 还有一问题待解决，运行多个界面，程序占用内存过大！！！！！！ 如何解决？？&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/jiben.png&#34; alt=&#34;服务器转发客户端实现局部聊天&#34;&gt;&lt;/p&gt;
&lt;p&gt;还有一个问题：服务器说的话只能发给一个人。&lt;/p&gt;
&lt;p&gt;解决办法：
修改TCPServerListener的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private ServerThread st = null;
                public TCPServerListener(ServerThread s)
                {
                        st =s ;
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;并在actionPerformed中增加 st.pushMessage();&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;                   try{
                           String str = tf.getText();
                       if(!str.isEmpty())
                       {
                                       tf.setText(&amp;quot;&amp;quot;);
                                ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                dos.writeUTF(str);
                                if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                {
                                    close();
                                    System.exit(0);
                                }
                                //ta.append(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt; say : &amp;quot; + line+&amp;quot;\n&amp;quot;);
                                st.pushMessage(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                       }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然在ServerThread服务器线程类中，增加&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private ServerThread st = null; // 受到启发的作用！！ Client=s

this.st = this;
的确这样修改完有效果，能够群发了，但是就是有些哥们的客户端发的是两条重复信息，有些却是一条。


重要修改，能够保证服务器发的信息不至于发太多给某一个客户端：
                           String str = tf.getText();
                       if(!str.isEmpty())
                       {
                                       tf.setText(&amp;quot;&amp;quot;);
                                ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                //dos.writeUTF(str);  //如果不注释掉 其中有一个用户会得到两条重复信息，都把他放在message_list中进行转发，而不是特例的一个利用dos.writeUTF(str)
                                if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                {
                                    close();
                                    System.exit(0);
                                }
                               
                                st.pushMessage(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                       }



&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;基于此我们的Server端如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.*;





/**
* @author    叶昭良
* @time      2015年3月23日上午12:41:10
* @version   TestNetworkRewriteTestServer5 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestServer5
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args) throws Exception
        {
                // TODO Auto-generated method stub
            ServerSocket ss = new ServerSocket(5599);
        while(true)
        {
                new TCPServer2(ss.accept());
        }
            
        }

}
class TCPServer2
{
        // class variables
        // class variables
        // connect
         
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private static Frame f = null;
         private static TextArea ta = null;
         private static TextField tf = null;
         private static Button  bn = null;
         
         private static boolean isPrint = false;//是否输出消息标志
         private static List user_list = new ArrayList();//登陆用户集合
         private static List&amp;lt;ServerThread&amp;gt; thread_list = new ArrayList&amp;lt;ServerThread&amp;gt;();//服务器已启用的线程集合
         private static LinkedList&amp;lt;String&amp;gt; message_list = new LinkedList&amp;lt;String&amp;gt;();//存放消息队列
      
         static
         {
                 createUI();
         }
         public  TCPServer2(Socket s) throws Exception
         {
                 this.s = s;
                 new PrintOutThread();//创建向客户端发送消息线程
             new ServerThread(this.s);  
             //本以为可以让其线程安全的，没想到没什么效果 反而更卡
/*             Collections.synchronizedList(user_list);
             Collections.synchronizedList(thread_list);
             Collections.synchronizedList(message_list);*/
            // launch();
                 
         }
       
        // construct member
        /*
        public TCPServer()
        {

        }
        */
        public static void createUI()
        {
            Frame f = new Frame(&amp;quot;服务器&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
/*            tf.addActionListener(new TCPServerListener());
            bn.addActionListener(new TCPServerListener());*/
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        

        public void close()
        {
            try{
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
     
        class TCPServerListener implements ActionListener
        {
                private ServerThread st = null;
                public TCPServerListener(ServerThread s)
                {
                        st =s ;
                }
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                           String str = tf.getText();
                       if(!str.isEmpty())
                       {
                                       tf.setText(&amp;quot;&amp;quot;);
                                ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                //dos.writeUTF(str);
                                if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                {
                                    close();
                                    System.exit(0);
                                }
                               
                                st.pushMessage(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                       }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
        
        /**
         * 服务器线程类
         */
        class ServerThread extends Thread{
                private Socket client;
                private String name = null;
                private ServerThread st = null; // 受到启发的作用！！ Client=s
                public ServerThread(Socket s) throws Exception
                {
                        this.client = s;
                        this.st = this;
                        dis = new DataInputStream(client.getInputStream());
                dos = new DataOutputStream(client.getOutputStream());
                dos.writeUTF(&amp;quot;成功连上服务器&amp;quot;+client.getInetAddress().getHostAddress());
                dos.writeUTF(Thread.currentThread().getName()+&amp;quot;已开启&amp;quot;+&amp;quot;请输入你的姓名&amp;quot;);
                this.start();
                //tf的监听器
                tf.addActionListener(new TCPServerListener(this.st));
                bn.addActionListener(new TCPServerListener(this.st));
                }
                @Override
                public void run()
                {
                        try
                        {
                                int flag = 0 ;
                                String line = dis.readUTF();
                                while(!&amp;quot;bye&amp;quot;.equals(line))
                                {
                                        //查看在线用户列表
                        if (&amp;quot;showuser&amp;quot;.equals(line)) {
                            dos.writeUTF(this.listOnlineUsers());
                            line = dis.readUTF();
                        }
                        //第一次进入，保存名字

                        if(flag++ ==0){
                            name = line;
                            user_list.add(name);
                            thread_list.add(this);
                            System.out.println(&amp;quot;this=&amp;quot;+this);
                            dos.writeUTF(name +&amp;quot;你好,可以开始聊天了...&amp;quot;);
                            //
                            this.pushMessage(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt;进入聊天室...+\n&amp;quot;);
                            //现在在服务器的大厅中
                            ta.append(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt;进入聊天室...\n&amp;quot;);
                        }else{
                                 //现在在服务器的大厅中
                                ta.append(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt; say : &amp;quot; + line+&amp;quot;\n&amp;quot;);
                                this.pushMessage(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt; say : &amp;quot; + line+&amp;quot;\n&amp;quot;);
                        }
                        line = dis.readUTF();
                                }
                        }catch(IOException e)
                        {
                                
                        }
                }
                 //放入消息队列末尾，准备发送给客户端
            public void pushMessage(String msg){
                message_list.addLast(msg);
                isPrint =true;
            }
              
            //向客户端发送一条消息(在PrintOutThread 有使用 于是变成了public修饰)
            public void sendMessage(String msg) throws Exception{
                dos.writeUTF(msg);
                dos.flush();
            }
              
            //统计在线用户列表  需要在showuser中使用  改为public
            private String listOnlineUsers() {
                String s =&amp;quot;--- 在线用户列表 ---&amp;quot;;
                for (int i =0; i &amp;lt; user_list.size(); i++) {
                    s +=&amp;quot;[&amp;quot; + user_list.get(i) +&amp;quot;]&amp;quot;;
                }
                s +=&amp;quot;--------------------&amp;quot;;
                return s;
            }

        }
              
        /**
         * 监听是否有输出消息请求线程类,向客户端发送消息
         */
        class PrintOutThread extends Thread
        {
            public PrintOutThread()
            {
                start();
            }
              
            @Override
            public void run() 
            {
                while(true){
                    if(isPrint){//将缓存在队列中的消息按顺序发送到各客户端，并从队列中清除。
                        String message = message_list.getFirst();
                        for (ServerThread thread : thread_list) 
                        {
                            try
                                                        {
                                    //this.
                                    thread.sendMessage(message);
                                                        } catch (Exception e)
                                                        {
                                                                // TODO Auto-generated catch block
                                                                e.printStackTrace();
                                                        }
                        }
                        message_list.removeFirst();
                        isPrint = message_list.size() &amp;gt;0 ?true :false;
                    }
                }
            }
        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client端如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package TestNetwork;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.Socket;

import javax.swing.JOptionPane;

import TestNetwork.TCPClient1.ClientRead;
import TestNetwork.TCPClient1.ClientWrite;
import TestNetwork.TCPClient1.TCPClientListener;

/**
* @author    叶昭良
* @time      2015年3月23日上午1:57:54
* @version   TestNetworkRewriteTestClient5 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestClient5
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args) throws Exception
        {
                // TODO Auto-generated method stub
                Socket s  = null;
                s = new Socket(&amp;quot;127.0.0.1&amp;quot;,5599);

                 new TCPClient5(s);
        }

}
class TCPClient5
{
        // class variables
        // class variables
        // connect
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private Frame f = null;
         private TextArea ta = null;
         private TextField tf = null;
         private Button  bn = null;
         
         /**
          * 与服务器连接，并输入发送消息
          */
         public TCPClient5(Socket s) throws Exception
         {
                 this.s = s;
                 dis = new DataInputStream(s.getInputStream());
             dos = new DataOutputStream(s.getOutputStream());
             createUI();
             //new ClientRead(dis);
             //new ClientWrite(dos);
             new readLineThread();

         }
         /**
          * 用于监听服务器端向客户端发送消息线程类
          */
  
        public void createUI()
        {
            Frame f = new Frame(&amp;quot;客户端&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
                tf.addActionListener(new TCPClientListener());
                bn.addActionListener(new TCPClientListener());
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }

        public void close()
        {
            try{
                dis.close();
                dos.close();
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
        /**
         * 用于监听服务器端向客户端发送消息线程类
         */
        class readLineThread extends Thread
        {
              
            private BufferedReader buff = null;;
            public readLineThread(){
                    start();
                
            }
              
            @Override
            public void run() {
                try {
                    while(true){
                        String result = dis.readUTF();
                        if(&amp;quot;byeClient&amp;quot;.equals(result)){//客户端申请退出，服务端返回确认退出
                            break;
                        }else{//输出服务端发送消息
                                //ta.append(result);
                            System.out.println(result);
                           // dos.writeUTF(result);
                            ta.append(&amp;quot;服务器传递说:&amp;quot;+result+&amp;quot;\n&amp;quot;);
                            if(result.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                            {
                                close();
                                System.exit(0);
                            }
                        }
                    }
                }catch (Exception e) {
                }
            }
        }
        
        class TCPClientListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                        String str = tf.getText();
                        tf.setText(&amp;quot;&amp;quot;);
                        ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;p&gt;1：之前的线程卡的问题，还没有解决，运行起来仍然感觉占用大量内存！！
2：为什么 第一个进入聊天系统的杨中科，会打印出三次呢？ 当然后面的消息正常，当然三次的意思是聊天系统进入了三个人，都教授和Rocket. 所以肯定是那部分有问题待解决&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E6%9C%8D%E5%8A%A1%E5%99%A82.png&#34; alt=&#34;在这边有一个小问题，出现了三行打印&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E5%9F%BA%E6%9C%AC%E6%BB%A1%E8%B6%B3%E9%A2%98%E6%84%8F.png&#34; alt=&#34;群发效果OK,服务器也没问题了&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/linjiqin/archive/2013/05/30/3108188.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.cnblogs.com/linjiqin/archive/2013/05/30/3108188.html&lt;/a&gt;  欣赏了这篇佳作&lt;/p&gt;
&lt;p&gt;基于上次的问题，打开的时候经常会出现多个打印的情况，
尝试如下修改：
“登录用户集合”和“服务器已启用线程集合”的list，如果变化不频繁，读多写少，使用CopyOnWriteArrayList。
“存放消息队列”用Queue接口比List接口更方便（每次直接POP，没消息时候还可以让广播线程自己阻塞在上面），具体的用ArrayBlockingQueue或者LinkedBlockingQueue都可以。http://my.oschina.net/leejun2005/blog/104955
对应的message_list.addLast(msg)  变成了message_list.put(msg)              message_list.take()来取代 message_list.getFirst() &amp;amp; message_list.removeFirst()
效果就是居然没问题。居然也不卡了&lt;/p&gt;
&lt;p&gt;Server端的修正版本：（Client端不需要修正）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;
/**
* 解释：
*/
package TestNetwork;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.*;
import java.util.concurrent.CopyOnWriteArrayList;
import java.util.concurrent.LinkedBlockingQueue;





/**
* @author    叶昭良
* @time      2015年3月23日上午12:41:10
* @version   TestNetworkRewriteTestServer5 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class RewriteTestServer5
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args) throws Exception
        {
                // TODO Auto-generated method stub
            ServerSocket ss = new ServerSocket(5599);
        while(true)
        {
                new TCPServer2(ss.accept());
        }
            
        }

}
class TCPServer2
{
        // class variables
        // class variables
        // connect
         
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private static Frame f = null;
         private static TextArea ta = null;
         private static TextField tf = null;
         private static Button  bn = null;
         
         private static boolean isPrint = false;//是否输出消息标志
         private static List user_list = new CopyOnWriteArrayList();//登陆用户集合
         private static List&amp;lt;ServerThread&amp;gt; thread_list = new CopyOnWriteArrayList&amp;lt;ServerThread&amp;gt;();//服务器已启用的线程集合
         private static LinkedBlockingQueue&amp;lt;String&amp;gt; message_list = new LinkedBlockingQueue&amp;lt;String&amp;gt;();//存放消息队列
        // private static List&amp;lt;String&amp;gt; message_list = new LinkedList&amp;lt;String&amp;gt;();//存放消息队列
      
         static
         {
                 createUI();
         }
         public  TCPServer2(Socket s) throws Exception
         {
                 this.s = s;
                 new PrintOutThread();//创建向客户端发送消息线程
             new ServerThread(this.s);  
             //本以为可以让其线程安全的，没想到没什么效果 反而更卡
/*             Collections.synchronizedList(user_list);
             Collections.synchronizedList(thread_list);
             Collections.synchronizedList(message_list);*/
            // launch();
                 
         }
       
        // construct member
        /*
        public TCPServer()
        {

        }
        */
        public static void createUI()
        {
            Frame f = new Frame(&amp;quot;服务器&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
/*            tf.addActionListener(new TCPServerListener());
            bn.addActionListener(new TCPServerListener());*/
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        

        public void close()
        {
            try{
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
     
        class TCPServerListener implements ActionListener
        {
                private ServerThread st = null;
                public TCPServerListener(ServerThread s)
                {
                        st =s ;
                }
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                           String str = tf.getText();
                       if(!str.isEmpty())
                       {
                                       tf.setText(&amp;quot;&amp;quot;);
                                ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                                //dos.writeUTF(str);
                                if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                                {
                                    close();
                                    System.exit(0);
                                }
                               
                                st.pushMessage(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                       }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
        
        /**
         * 服务器线程类
         */
        class ServerThread extends Thread{
                private Socket client;
                private String name = null;
                private ServerThread st = null; // 受到启发的作用！！ Client=s
                public ServerThread(Socket s) throws Exception
                {
                        this.client = s;
                        this.st = this;
                        dis = new DataInputStream(client.getInputStream());
                dos = new DataOutputStream(client.getOutputStream());
                dos.writeUTF(&amp;quot;成功连上服务器&amp;quot;+client.getInetAddress().getHostAddress());
                dos.writeUTF(Thread.currentThread().getName()+&amp;quot;已开启&amp;quot;+&amp;quot;请输入你的姓名&amp;quot;);
                this.start();
                //tf的监听器
                tf.addActionListener(new TCPServerListener(this.st));
                bn.addActionListener(new TCPServerListener(this.st));
                }
                @Override
                public void run()
                {
                        try
                        {
                                int flag = 0 ;
                                String line = dis.readUTF();
                                while(!&amp;quot;bye&amp;quot;.equals(line))
                                {
                                        //查看在线用户列表
                        if (&amp;quot;showuser&amp;quot;.equals(line)) {
                            dos.writeUTF(this.listOnlineUsers());
                            line = dis.readUTF();
                        }
                        //第一次进入，保存名字

                        if(flag++ ==0){
                            name = line;
                            user_list.add(name);
                            thread_list.add(this);
                            System.out.println(&amp;quot;this=&amp;quot;+this);
                            this.pushMessage(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt;进入聊天室...+\n&amp;quot;);
                            dos.writeUTF(name +&amp;quot;你好,可以开始聊天了...&amp;quot;);
                            //
                            
                            //现在在服务器的大厅中
                            ta.append(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt;进入聊天室...\n&amp;quot;);
                        }else{
                                 //现在在服务器的大厅中
                                ta.append(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt; say : &amp;quot; + line+&amp;quot;\n&amp;quot;);
                                this.pushMessage(&amp;quot;Client&amp;lt;&amp;quot; + name +&amp;quot;&amp;gt; say : &amp;quot; + line+&amp;quot;\n&amp;quot;);
                        }
                        line = dis.readUTF();
                                }
                        }catch(IOException e)
                        {
                                
                        }
                }
                 //放入消息队列末尾，准备发送给客户端
            public void pushMessage(String msg){
                    //msssage_list.
                //message_list.addLast(msg); //针对于LinkedList
                    try
                                {
                                        message_list.put(msg);
                                } catch (InterruptedException e)
                                {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                }
                isPrint =true;
            }
              
            //向客户端发送一条消息(在PrintOutThread 有使用 于是变成了public修饰)
            public void sendMessage(String msg) throws Exception{
                dos.writeUTF(msg);
                dos.flush();
            }
              
            //统计在线用户列表  需要在showuser中使用  改为public
            private String listOnlineUsers() {
                String s =&amp;quot;--- 在线用户列表 ---&amp;quot;;
                for (int i =0; i &amp;lt; user_list.size(); i++) {
                    s +=&amp;quot;[&amp;quot; + user_list.get(i) +&amp;quot;]&amp;quot;;
                }
                s +=&amp;quot;--------------------&amp;quot;;
                return s;
            }

        }
              
        /**
         * 监听是否有输出消息请求线程类,向客户端发送消息
         */
        class PrintOutThread extends Thread
        {
            public PrintOutThread()
            {
                start();
            }
              
            @Override
            public void run() 
            {
                while(true){
                    if(isPrint){//将缓存在队列中的消息按顺序发送到各客户端，并从队列中清除。
                        String message = null;
                                                try
                                                {
                                                        message = message_list.take();
                                                } catch (InterruptedException e1)
                                                {
                                                        // TODO Auto-generated catch block
                                                        e1.printStackTrace();
                                                }
                        //message = message_list.getFirst();
                        for (ServerThread thread : thread_list) 
                        {
                            try
                                                        {
                                    //this.
                                    thread.sendMessage(message);
                                                        } catch (Exception e)
                                                        {
                                                                // TODO Auto-generated catch block
                                                                e.printStackTrace();
                                                        }
                        }
                       // message_list.removeFirst();
                        //isPrint = false;
                        //这句话很重要！！！不能随便修改
                        isPrint = message_list.size()&amp;gt;0 ?true :false;
                    }
                }
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E6%9C%8D%E5%8A%A1%E5%99%A83.png&#34; alt=&#34;有问题的版本（但是基本满足题意）&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E5%B1%85%E7%84%B6%E4%B8%8D%E5%8D%A1%E4%BA%86.png&#34; alt=&#34;不卡版本，且解决了登陆时候的多条打印问题&#34;&gt;&lt;/p&gt;
&lt;p&gt;1 动机是为了熟悉网络编程，于是重写了之前写过的代码。从TCPServer 1 2 3三个进行重新的改写
2 发现TCPServer3有问题？&lt;br&gt;
在客户端连接上后，客户端发送数据可以到服务器端，接着切换到服务器端，但是服务器的输入出现了问题，
无论你输入一个字还是n个字都无法切换回客户端了&lt;/p&gt;
&lt;p&gt;3 于是基于这个问题开始进行修改
主要包含一个主要
版本1     Server有一对读写线程类   Client有一对读写线程类
版本2     Server有一对读写线程类   Client没有一对读写线程类
版本3    Server有一个ServerThread线程类    Client有一个readLineThread线程类&lt;/p&gt;
&lt;p&gt;真的是从原先的四个类，到最后抛弃了原先的四个类，重写了另外的几个类&lt;/p&gt;
&lt;p&gt;RewriteServer1.java
RewriteServer2.java
RewriteServer3.java
RewriteServer4.java
RewriteServer5.java
最后的一个版本是RewriteServer5&lt;/p&gt;
&lt;p&gt;4 版本3  引入了新的数据结构 CopyWriteArrayList和LinkedBlockingQueue 线程阻塞类&lt;/p&gt;
&lt;p&gt;5: 注意了
5.1 线程的使用(从thread到Runnable)，线程开启放置的位置，最后发现使用了多线程服务器客户端
5.2 静态代码段static的使用
5.3 ServerThread的静态变量的使用，配合上构造函数
5.4 数据结构的使用&lt;/p&gt;
&lt;p&gt;猛然发现一个特点：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;  GTK.g_timeout_add(100, new IGSourceFunc()
                {
                        
                        @Override
                        public boolean execute(Object userdata)
                        {
                                // TODO Auto-generated method stub
                                int len = otv.getText().length();
                                char ch = love.charAt(len);
                                otv.insertTextAtEnd(Character.toString(ch));
                                if(otv.getText().length() == love.length()-1)
                                {
                                        //om.close();
                                        try
                                        (
                                                        OOMusic om = new OOMusic(&amp;quot;我如此爱你.mp3&amp;quot;,true);
                                        )
                                        {
                                                        om.playRepeat();
                                        }
                                
                                        return true;
                                }else if(otv.getText().length() == love.length())
                                {
                                        return false;
                                }
                                else
                                { 
                                        //System.out.println(&amp;quot;2&amp;quot;);
                                        return true;
                                }

                        }
                }, null);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;vgOpen.addActivateListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                youOpenfile(ootv);
                                
                        }
                });
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//添加按钮事件
                GTK.g_signal_connect(btnShow, &amp;quot;clicked&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                String text = GTK.gtk_text_buffer_get_text(textbuffer);
                                GTK.gtk_label_set_text(label, text);
                        }
                }, null);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4：
前三个都是针对gtk的
awt的事件关闭监听，&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;f = new JFrame(&amp;quot;客户端&amp;quot;);
f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然在JFrame可以采用：
f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
复制代码
他们共同的特点是都采用匿名类，当做时间的响应函数或者回调函数，于是当前的网络编程的button和  textfield也是采用匿名类来实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;class TCPClientListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                        String str = tf.getText();
                        tf.setText(&amp;quot;&amp;quot;);
                        ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;添加监听：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;
         tf.addActionListener(new TCPClientListener());
                bn.addActionListener(new TCPClientListener());
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意匿名类的监听函数的匿名类对象实现回调&lt;/p&gt;
&lt;p&gt;学习了匿名类的事件回调函数。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>测试外部DTD约束的有效性</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/ce-shi-wai-bu-dtdyue-shu-de-you-xiao-xing/</link>
      <pubDate>Mon, 11 May 2015 14:58:45 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/ce-shi-wai-bu-dtdyue-shu-de-you-xiao-xing/</guid>
      <description>&lt;p&gt;问题来源：
我本想着查查网上有没有什么方法可以用来验证dtd，于是就搜到这篇，然后开始练习。遇到的问题还真不少，java IO有些忘了，就重新查（这是一点收获） 但是现在遇到的最大的问题是 db.parse()一直提示person.xml不存在，我已经在多个地方都存放着person.xml, 也知道fileInputStream读取的相对路径应该是java项目的跟路径，甚至我把文件名的全路径都给写上，但是报的错误就是  person.xml not  found&lt;/p&gt;
&lt;p&gt;问题的产生项目文件：（我把所有的文件都放在TestDTD的包下面）
person.xml   :第一个测试dtd的xml文件
worker.xml   ：第二个测试dtd的xml文件
person.dtd   ：dtd的约束文件
ValidateDTD.java   :用于验证person.xml  和work.xml 是否正确的收到person.dtd的约束&lt;/p&gt;
&lt;p&gt;所有源文件：
person.dtd:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!ELEMENT person (name,sex,birthday)*&amp;gt;
&amp;lt;!ELEMENT name (#PCDATA)&amp;gt;
&amp;lt;!ELEMENT sex (#PCDATA)&amp;gt;
&amp;lt;!ELEMENT birthday (#PCDATA)&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码
person.xml:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE person SYSTEM &amp;quot;person.dtd&amp;quot;&amp;gt;        
&amp;lt;person&amp;gt;
        &amp;lt;name&amp;gt;Tom&amp;lt;/name&amp;gt;
        &amp;lt;sex&amp;gt;male&amp;lt;/sex&amp;gt;
        &amp;lt;birthday&amp;gt;1990-01-07&amp;lt;/birthday&amp;gt;
&amp;lt;/person&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码
worker.xml:(多了一条job字段，但是是不需要的)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE person SYSTEM &amp;quot;person.dtd&amp;quot;&amp;gt;        
&amp;lt;person&amp;gt;
        &amp;lt;name&amp;gt;Tom&amp;lt;/name&amp;gt;
        &amp;lt;sex&amp;gt;male&amp;lt;/sex&amp;gt;
        &amp;lt;birthday&amp;gt;1990-01-07&amp;lt;/birthday&amp;gt;
        &amp;lt;job&amp;gt;Painting&amp;lt;/job&amp;gt;
&amp;lt;/person&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码&lt;/p&gt;
&lt;p&gt;ValidateDTD.java:（已修正的ValidateDTD程序）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package TestDTD;

import java.io.File;
import java.io.IOException;
import java.net.URL;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.xml.sax.SAXException;

/**
* @author 叶昭良
* @time 2015年4月26日上午3:48:53
* @version TestDTDValidataDTD V1.0 功能： 步骤1： 步骤2： 注意： 掌握： 思考1： 思考2： 回顾：
*/
public class ValidataDTD
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                // 最好是事先打印当前的路径实在哪里
                System.out.println(new File(&amp;quot;.&amp;quot;).getAbsolutePath());

                System.out.println(new File(&amp;quot;.&amp;quot;).getName());
                System.out.println(new File(&amp;quot;.&amp;quot;).getPath());
                System.out.println(&amp;quot;开始测试person.xml&amp;quot;);
                testPerson1();
                System.out.println(&amp;quot;开始测试worker.xml&amp;quot;);
                testWorker();
        }

        // 利用工厂类DocumentBuilderFactory来判断DTD书写的正确性
        public static void testPerson1()
        {
                try
                {
                        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
                        dbf.setValidating(true);
                        // 利用dbf建立一个documentBuilder对象

                        DocumentBuilder db = dbf.newDocumentBuilder();
                        // 错误1
                        // db.parse(new FileInputStream(new File(&amp;quot;.&amp;quot;).getAbsoluteFile()+
                        // &amp;quot;//TestDTD//person.xml&amp;quot;));
                        // 错误2
                        // InputStream is = ValidataDTD.class.getClassLoader()
                        // .getResourceAsStream(&amp;quot;person.xml&amp;quot;);
                        /**
                         * 最常用读取properties文件的方法 InputStream in =
                         * getClass().getResourceAsStream
                         * (&amp;quot;资源Name&amp;quot;);这种方式要求properties文件和当前类在同一文件夹下面。如果在不同的包中，必须使用：
                         * InputStream ins = this.getClass().getResourceAsStream(
                         * &amp;quot;/cn/zhao/properties/testPropertiesPath2.properties&amp;quot;);
                         */

                        // 错误3
                        // db.parse(new FileInputStream(&amp;quot;./src/TestDTD/person.xml&amp;quot;));
                        // 错误4
                        // db.parse(new FileInputStream(
                        // &amp;quot;C:\\Users\\708\\git\\Day2015-4-14\\src\\TestDTD\\person.xml&amp;quot;));
                        // db.parse(new FileInputStream(new File(&amp;quot;E://person.xml&amp;quot;)));
                        URL fileURLPerson = ResourceAccessSecond.class.getClassLoader().getResource(
                                        &amp;quot;TestDTD/person.xml&amp;quot;);

                        db.parse(new File(fileURLPerson.getFile()));
                } catch (ParserConfigurationException e)
                {
                        System.out.println(&amp;quot;DocumentBuilder 建立失败&amp;quot;);
                } catch (IOException e)
                {
                        System.out.println(&amp;quot;person.xml文件不存在&amp;quot;);
                } catch (SAXException e)
                { // TODO Auto-generated catch block
                        e.printStackTrace();
                }

        }

        // 利用工厂类DocumentBuilderFactory来判断DTD书写的正确性
        public static void testWorker()
        {
                try
                {
                        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
                        dbf.setValidating(true);
                        // 利用dbf建立一个documentBuilder对象

                        DocumentBuilder db = dbf.newDocumentBuilder();

                        URL fileURLPerson = ResourceAccessSecond.class.getClassLoader().getResource(
                                        &amp;quot;TestDTD/worker.xml&amp;quot;);

                        db.parse(new File(fileURLPerson.getFile()));
                } catch (ParserConfigurationException e)
                {
                        System.out.println(&amp;quot;DocumentBuilder 建立失败&amp;quot;);
                } catch (IOException e)
                {
                        System.out.println(&amp;quot;person.xml文件不存在&amp;quot;);
                } catch (SAXException e)
                { // TODO Auto-generated catch block
                        e.printStackTrace();
                }

        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码&lt;/p&gt;
&lt;p&gt;1： 查阅了 dtd的语法规范，也注意到了空格要把元素和圆括号分开写，检查基本上没有拼写错误，但是还是报了person.xml的
2： 查阅了FileInputStream的用法， 有三种参数  String，Files ,另外一种比较少用，也就是既可以直接使用文件名字符串，也可以使用
new File(文件名字符串) 又或者第三种。 未找到解决办法
补充：    之前我们一直训练的是在项目中读取的是properties（然后利用prop.load(in)的方法）,而在非项目文件中读取的是全路径问题（比如e:/person.xml)，第一次想到如果我们用FileInputStream是否读取java项目中的文件。&lt;/p&gt;
&lt;p&gt;补充2：  myeclipse并不会报警我在使用外部约束DTD的不存在的元素，自己又不知道xml解析器是否真的晓得dtd的文件的存在，于是就想着自己               测试一下
3：于是求教 Professor Du   ，给了我两个读取项目文件的视频
视频1： 用  当前类 ValidateDTD.class.getResource()方法
&lt;a href=&#34;http://v.polyv.net/uc/video/iframeview?vid=e46d36780492b6d4ec8ed55f4fb04583_e&amp;amp;playerwidth=100&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://v.polyv.net/uc/video/iframeview?vid=e46d36780492b6d4ec8ed55f4fb04583_e&amp;playerwidth=100&lt;/a&gt;
注意： bin目录表示类加载根目录（要知道我在说什么，打开window-&amp;gt; show view&amp;ndash;&amp;gt;navigator&lt;br&gt;
你会发现navigator现实的bin文件夹和  src文件夹基本上是对应的，只不过是把java文件，都变成了
class文件，其他文件保持原样，这也就是bin根目录的所在地和他的文档结构）   在使用 此方法必须加上斜杠开头
视频2 ： 用 当前类 ValidateDTD.class.classLoader().getResource()方法
&lt;a href=&#34;http://v.polyv.net/uc/video/iframeview?vid=e46d367804795fd7b389ade7541a9db7_e&amp;amp;playerwidth=100&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://v.polyv.net/uc/video/iframeview?vid=e46d367804795fd7b389ade7541a9db7_e&amp;playerwidth=100&lt;/a&gt;
注意： 与上面方法不同的是，在加载bin目录的时候，不需要使用斜杠  直接写上包名或者文件名（按照文件结构，
把bin目录当做根目录即可）&lt;/p&gt;
&lt;p&gt;视频一的测试源文件：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package TestDTD;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.net.URL;

/*
* 打开navigator试图，才能知道我在讲什么 window--&amp;gt;show view---&amp;gt;navigator
* 可以看到bin和src基本上是java文件变成了class其他一一对应
* 也就是一个java文件一经编译， 变成class文件都会到bin文件（规律1）
* 另外的bin文件也叫做类加载根目录（下面可以进行测试）
* 其他的比如xml dtd  txt等文件 则是直接会在bin根目录下显示
* 
* 
* 所以我们的问题是：
*          如何动态加载项目的根目录下的文件（也就是我把文件放在TestDTD下，如果
*          TestDTD包的路径一直改变（体现动态）我如何能够加载得上？
*          
*          反着来思考
*        1： 我需要FileReader或者FileInputStream 等
*        2： 也许我还需要用BufferedReader  或者BufferedInputStream来缓冲加载文件
*        3： 我需要使用FileReader还需要一个File对象
*        4： 我需要File对象  我就同时需要知道资源的全路径
*        5： 资源全路径的问题，就是如何加载bin根目录的问题！ 也就是我已经知道java编译器是如何解析相对路径
*        6： 于是我只要按照上述思路让类加载器去加载文件即可！
*        
*        注意：/ 表示的bin根目录  所以你需要在包的资源文件的开头是斜杠/
*/

public class ResourceAccess {
        public static void main(String[] args) throws Exception {
                System.out.println(ResourceAccess.class.getResource(&amp;quot;&amp;quot;));
                URL fileUrl = ResourceAccess.class.getResource(&amp;quot;/TestDTD/person.dtd&amp;quot;);
                System.out.println(fileUrl.getFile());

                // FileReader fr = new FileReader(new File(fileUrl));
                FileReader fr = new FileReader(new File(fileUrl.getFile()));
                BufferedReader br = new BufferedReader(fr);
                String line = br.readLine();
                System.out.println(&amp;quot;Read by BufferedReader(FileReader(File....)))&amp;quot;);
                System.out.println(line);
                System.out.println(&amp;quot;YEs it works!&amp;quot;);
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;视频二的测试源文件：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package TestDTD;

import java.net.URL;

/**
* @author 叶昭良
* @time 2015年4月26日下午1:25:32
* @version TestDTDResourceAccessSecond V1.0 功能： 步骤1： 步骤2： 注意： 掌握： 思考1： 思考2： 回顾：
*          第一种加载项目根目录资源的方式 类.class.getResource(FileName);
*/
public class ResourceAccessSecond
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                // 通过类加载器 classloader加载项目资源
                // 首先classloader指定的项目的路径是什么？做一个测试
                /*
                 * URL fileURL =
                 * ResourceAccessSecond.class.getClassLoader().getResource(&amp;quot;&amp;quot;); //
                 * 默认是bin目录 // fd System.out.println(fileURL);
                 */
                // 加了斜杠反而不行！！！原來classloader类不同于class的方法！
                // 1 他不需要使用斜杠
                // 2 他多了一个功能 getResources()
                URL fileURLPerson = ResourceAccessSecond.class.getClassLoader().getResource(
                                &amp;quot;TestDTD/person.dtd&amp;quot;);
                System.out.println(fileURLPerson);

        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;经过这样一倒腾：
就可以使用下面方法&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;URL fileURLPerson = ResourceAccessSecond.class.getClassLoader().getResource(
&amp;quot;TestDTD/worker.xml&amp;quot;);

db.parse(new File(fileURLPerson.getFile()));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;测试结果：
开始测试person.xml
开始测试worker.xml
Warning: validation was turned on but an org.xml.sax.ErrorHandler was not
set, which is probably not what is desired. Parser will use a default
ErrorHandler to print the first 10 errors. Please call
the &amp;lsquo;setErrorHandler&amp;rsquo; method to fix this.
Error: URI=file:/C:/Users/708/git/Day2015-4-14/bin/TestDTD/worker.xml Line=7: 必须声明元素类型 &amp;ldquo;job&amp;rdquo;。
Error: URI=file:/C:/Users/708/git/Day2015-4-14/bin/TestDTD/worker.xml Line=8: 元素类型为 &amp;ldquo;person&amp;rdquo; 的内容必须匹配 &amp;ldquo;(name,sex,birthday)*&amp;rdquo;
复制代码
可以发现worker加了job字段，的确是检测出来了。&lt;/p&gt;
&lt;p&gt;问题总算解决了：
主要问题还是FileInputStream并没有读入文件的问题。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>递归的简单阐述</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/di-gui-de-jian-dan-chan-shu/</link>
      <pubDate>Mon, 11 May 2015 14:58:45 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/di-gui-de-jian-dan-chan-shu/</guid>
      <description>&lt;p&gt;递归和迭代的区别：
递归需要调用自己
迭代不断修正自己的返回值&lt;/p&gt;
&lt;p&gt;递归伪代码：
(define factoral
(lambda (x)
(if (&amp;lt;=  x 1)    //1.必须有一个输出口
1                  //出口值
(* x (factoral (- x 1)))&lt;/p&gt;
&lt;p&gt;所以递归就看两个部分：1 输出口（递归终止条件）  2：循环表达式，并且一定要减减 或者++ 直到能够达到递归终止条件&lt;/p&gt;
&lt;p&gt;进一步通过java比较递归和尾递归的执行过程：
尾递归代码：
/**
*&lt;br&gt;
* @param n          计算5！ 则n =5
* @param product    一般是设置为1  比如 计算5! factail1(5,1)
* @return           返回递归结果
*/
public static long facttail1(int n, int product)
{
if(n&amp;lt;0)
{
return 0;
}
if(1 == n)
{
return product;
}
else
{
return  facttail1(n-1, product*n);
}
}&lt;/p&gt;
&lt;p&gt;普通递归代码：
/**
*
* @param n   5! 则 n = 5
* @return    返回阶乘的计算结果
*/
public static long facttail1(int n)
{
long a = 0;// 用于调试，可注释
if(n==1)
{
a = 1;// 用于调试，可注释
return 1;
}
a =n*facttail1(n-1);  // 用于调试，可注释
return n*facttail1(n-1);
}&lt;/p&gt;
&lt;p&gt;无递归的阶乘：
/**
*
* @param n   计算 5！ 则n=5
* @return
*/
public static int fact2(int n)
{
if(n &amp;lt; 0)
{
throw new IllegalArgumentException();
}
int result = 1;
for(int i = 1; i &amp;lt;= n; i++)
{
result = result*i;
}
return result;
}&lt;/p&gt;
&lt;p&gt;主程序：
public static void main(String[] args)
{
// TODO 自动生成的方法存根
long Apple =facttail(5,1);
System.out.println(&amp;ldquo;Apple get by 尾递归：&amp;quot;+Apple);
long Banana =facttail1(5);
System.out.println(&amp;ldquo;Banana get by 递归：&amp;quot;+Banana);
}&lt;/p&gt;
&lt;p&gt;通过调试可以看到，尾递归的执行过程为:
看下图   尾递归的调试过程
而普通的递归方式为：
看下图   [size=14.4444446563721px]普通的递归运行方式&lt;/p&gt;
&lt;p&gt;通过上述调试发现，尾递归的确是比较快的。&lt;/p&gt;
&lt;p&gt;另外不知道java中的大的数值范围该如何表示，比如 [size=14.4444446563721px]facttail(32,1); 就运行不出来结果？ long无法解决问题。估计java不适合进行大型的数值运算
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E5%B0%BE%E9%80%92%E5%BD%92.png&#34; alt=&#34;尾递归的调试过程&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E6%99%AE%E9%80%9A%E7%9A%84%E9%80%92%E5%BD%92.png&#34; alt=&#34;普通的递归运行方式&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用BigInteger类型的改造版本：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.math.BigInteger;

/**
* @author 叶昭良
*
*/        
public class TestRecursive
{

        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
             BigInteger Apple =fact(100l,BigInteger.valueOf(1));
            System.out.println(&amp;quot;Apple get by 尾递归：&amp;quot;+Apple);
            BigInteger Banana =facttail(100l);
           System.out.println(&amp;quot;Banana get by  递归：&amp;quot;+Banana);
        }
        // 尾递归方式
        /**
         * 
         * @param n        待计算的阶乘  比如5！ 则n=5
         * @param product  中间变量
         * @return         一个BigInteger对象,包含阶乘的计算结果
         */
        public static BigInteger fact(long n, BigInteger product)
        {
                if(n&amp;lt;0)
                {
                      return BigInteger.valueOf(0);
                }
                else if(n==1)
                     return product;
                else
                     return fact(n-1,product.multiply(BigInteger.valueOf(n)));
        }
        //递归方式
        /**
         * 
         * @param n   待计算的阶乘  比如5！ 则n=5
         * @return    一个BigInteger对象,包含阶乘的计算结果
         */
        public static BigInteger facttail(long n)
        {
          if(n==1)
                {
                     return BigInteger.valueOf(1);
                }else
                {
                     //a =n*facttail1(n-1);
                    return facttail(n-1).multiply(BigInteger.valueOf(n));
                }

        }        

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行结果：&lt;/p&gt;
&lt;p&gt;Apple get by 尾递归：93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000
Banana get by  递归：93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000&lt;/p&gt;
&lt;p&gt;真的是可以要有多大就有多大。
java 在eclipse使用ctrl+o 调用multiply发现他需要传递一个BigInteger对象。
[c#版本 BigInteger:][https://msdn.microsoft.com/zh-cn/library/system.numerics.biginteger.aspx]&lt;/p&gt;
&lt;p&gt;补充杨老师串讲的内容，补上参数说明，并归结为方法，进行独立测试&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.util.Arrays;


/**
* @author 叶昭良
*
*/
public abstract class TestChuangjian2
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                //第一部分 递归
                // case1讲故事
                tellStory(1);
                System.out.println(fact(5));
                System.out.println(fact2(5));
                System.out.println(fact3(5,1));
                System.out.println(&amp;quot;fibnacii1 :&amp;quot;+fib1(5));
                System.out.println(fib2(5));
                System.out.println(fib3(5));
        }
        //第一部分  递归
        //case 1*讲故事
        /**
         * 
         * @param i  讲故事的次数
         */
        public static void tellStory(int i)
        {
                System.out.println(&amp;quot;从前有座山，山里有座庙，。。。。&amp;quot;);
                if(i &amp;lt; 3)
                {
                        tellStory(++i);
                }
                System.out.println(&amp;quot;完了&amp;quot;);
        }
        //case2  阶乘
        /**
         * 
         * @param n  计算 5！ 则n=5
         * @return  返回阶乘的计算结果
         */
        public static int fact(int n)
        {
                if(n &amp;lt; 0)
                {
                        throw new IllegalArgumentException();
                }
                if( 1 == n)
                {
                        return 1;
                }else
                {
                        return n*fact(n-1);
                }
        }
        
        // case3  无递归的阶乘
        /**
         * 
         * @param n   计算 5！ 则n=5
         * @return
         */
        public static int fact2(int n)
        {
                if(n &amp;lt; 0)
                {
                        throw new IllegalArgumentException();
                }
                int result = 1;
                for(int i = 1; i &amp;lt;= n; i++)
                {
                        result = result*i;
                }
                return result;
        }
        // case 4  尾递归方式
        /**
         * 
         * @param n      计算 5！ 则n=5
         * @param result  存储阶乘的计算结果，并作为中间变量
         * @return       返回阶乘计算结果
         */
        public static int fact3(int n, int result)
        {
                if(n &amp;lt;= 0)
                {
                        throw new IllegalArgumentException(&amp;quot;胡算的阶乘数&amp;lt;=0&amp;quot;);
                }
                if(1== n)
                {
                        return result;
                }else
                {
                        return fact3(n-1,result*n);
                }
        }
        
        //case 5 Fibnacci1
        /**
         * 
         * @param n  fibnacci的个数n
         * @return   fibnacci数
         */
        public static int fib1(int n)
        {
                if(n &amp;lt; 0)
                {
                        throw new IllegalArgumentException(&amp;quot;n不可以小于0&amp;quot;);
                }
                if(1 == n || 2 == n)
                {
                        return 1;
                }
                else
                {
                        return fib1(n-1)+fib1(n-2);
                }
        }
        /**
         * 
         * @param n  fibnacci的计算数
         * @return   fibanacci数
         */
        public static int fib2(int n)
        {
                int[] nums = new int[n+1];
                nums[0] = 1;
                nums[1] = 1;
                System.out.println(Arrays.toString(nums));
                for(int i = 2; i &amp;lt; n ; i++)
                {
                        nums[i] = nums[i-1]+ nums[i-2];
                        System.out.println(Arrays.toString(nums));
                }
                return nums[n-1];
        }
        /**
         * 
         * @param n   fibnacci的计算数
         * @return    fibanacci数
         */
        public static int fib3(int n)
        {
                int apple = 1;
                int banana = 1;
                int temp = 1;
                for (int i = 2 ; i &amp;lt; n; i++)
                {
                        temp = apple + banana;
                        banana = apple;
                    apple = temp;
                }
                return temp;
        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E8%AE%B2%E6%95%85%E4%BA%8B%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.png&#34; alt=&#34;讲故事的顺序 先执行完红的 再反过来执行黄色的线&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E6%9D%A8%E8%80%81%E5%B8%88%E6%89%8B%E7%BB%98%E9%80%92%E5%BD%92%E5%9B%BE%E7%9A%84%E7%BC%BA%E9%99%B7%E5%8F%8D%E5%A4%8D%E8%AE%A1%E7%AE%97%E5%8D%A0%E7%94%A8%E7%A9%BA%E9%97%B4.png&#34; alt=&#34;普通递归的缺陷：重复计算 空间占用 （于是尾递归 和一些其他的非递归方法的引入）&#34;&gt;&lt;/p&gt;
&lt;p&gt;一个反例：栈溢出 stackOverFlowError
一般要求的StackSize是1MB&lt;/p&gt;
&lt;p&gt;反例：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;        /**
         * 
         * @param i  讲故事的次数
         */
        public static void tellStory(int i)
        {
                System.out.println(&amp;quot;从前有座山，山里有座庙.....&amp;quot;);
                {
                        tellStory(++i);  // i+1
                }        
                System.out.println(&amp;quot;Time Over in &amp;quot;+i);
                
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行完之后会报错，问题原因是栈溢出，达到栈的最大容量限制。
结论：在递归中必须设置终止条件，这样才不至于引起栈溢出。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>JQuery1-9April4th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/jquery1-9april4th/</link>
      <pubDate>Mon, 11 May 2015 14:58:44 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/jquery1-9april4th/</guid>
      <description>&lt;p&gt;1: jquery的加载顺序&lt;/p&gt;
&lt;p&gt;IE中会有不同点
结论：jquery中使用$(function(){})即可！其他知道即可&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;
    &amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

      //javascript
      //第四个加载
      //在IE中居然无法加载！！！
      //需要等待页面完全加载完毕才会触发
      onload=function()
      {
        //console的作用就是在浏览器的控制台 打印出结果
        console.log(&#39;javascript\&#39;s onload&#39;);
        alert(&#39;javascript window.onload js ok 4&#39;);
      };
      //window object change into jQuery object
      //第五个加载
      $(window).load(function(){
        console.log(&#39;window onload&#39;);
        alert(&#39;$(window).load No 5&#39;);
      });

//第二个加载
      $(function()
        {
          console.log(&#39;dom ready=&#39;+$(&#39;#span&#39;).html());
          alert(&#39;$(function(){}niming hanshu! 2&#39;);
        });


      //Dom object change into Jquery Object
      // 很是奇怪 第一个加载
      //可以多次触发
      $(document).ready(function(){
        console.log(&#39;document ready&#39;)
        alert(&#39;$(document).ready Ok 1&#39;);
      });

      // THe most common  and most convininet
      //jQuery(function(){})
           //第三个加载  跟第二个一样的  按照前后顺序进行布置
      jQuery(function()
       {
        console.log(&#39;dom ready=&#39;+$(&#39;#span&#39;).html());
        alert(&#39; jQuery(function(){}niming hanshu 3!&#39;)
       });

       function init()
       {
         console.log(&#39;body init&#39;);
       }

    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;
  &amp;lt;Body onload=&amp;quot;init()&amp;quot;&amp;gt;
    
    &amp;lt;Span id=&amp;quot;span&amp;quot;&amp;gt; Rupeng!&amp;lt;/Span&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2：Map 和each函数的使用
map：用于修改
each：用于遍历&lt;/p&gt;
&lt;p&gt;map:  value index
each:  key  value&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      
       var arr=[1,2,4,5,6];
       $.map(arr,function()
             {
               alert(&#39;element&#39;+arguments[1]+&#39;==&#39;+arguments[0]);
             });
        //namely  ,we can write below
        $.map(arr,function(ele,index)
              {
                alert(&#39;element&#39;+index+&#39;==&#39;+ele);
              });

        //return a  new array ==2*old_array
              var newArray=$.map(arr,function(ele,index)
               {
                 return ele*2;
               })

        //$.map is similar to lisp&#39;s (map ...) 
        // so we can get the two properties of array with $.map function

        //print new array
        alert(newArray);   


        var newArray2=$.map(arr,function(ele,index){
          return index&amp;gt;2?ele*2:ele;
        })

        alert(newArray2);


    &amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      var dic={&amp;quot;name&amp;quot;:&amp;quot;xiaoming&amp;quot;,&amp;quot;age&amp;quot;:3,&amp;quot;gender&amp;quot;:&amp;quot;1&amp;quot;};
      //each 主要用于遍历    map主要用于修改
      $.each(dic,function(key,value)
             {
               alert(key+&#39;==&#39;+value);
             })
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3:jquery和jsDom的互转&lt;/p&gt;
&lt;p&gt;1：jsDom -&amp;gt; jquery       把jsDom对象放在$()括号中即可
2： jquery -&amp;gt; jsDom
两种方法
a:  $().get(0)
b: $()[0]&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Test the transformation between jQuery and Dom &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; &amp;gt;
    
    
      $(function(){

  /*
        document.getElementById(&#39;btn&#39;).onclick=function()
        {
          var dvObj=document.getElementById(&#39;dv&#39;);
          //方法1  Dom
          //dvObj.style.backgroundColor=&#39;black&#39;; 
         
          //方法2 jQuery 方法
           //Dom object change into jQuery
//          var dvObjJquery=$(dvObj);
//          dvObjJquery.css(&#39;backgroundColor&#39;,&#39;yellow&#39;);

          // 把jquery对象转回到Dom对象
          var dvObjJquery=$(dvObj);
          //1  转回去dom的方法1
//          var dvObjAgain=dvObjJquery[0]; 
          //2  转回去dom的方法2
          var dvObjAgain=dvObjJquery.get(0); 
           dvObjAgain.style.backgroundColor=&#39;black&#39;; 

        

        }
   */       

        //1  省略了  等号
        //2  省略了   Dom长长的函数名调用
        //2  取而代之的是简易的jQuery语法  利用链式法则
        $(&#39;#btn&#39;).click(function()
                        {
                          $(&#39;#dv&#39;).css(&#39;backgroundColor&#39;,&#39;purple&#39;);
                        });
      })
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btn&amp;quot; value=&amp;quot;changeColor&amp;quot;/&amp;gt;
    &amp;lt;Div id=&amp;quot;dv&amp;quot; style=&amp;quot;width:300px; height:200px; background-color:green&amp;quot;&amp;gt;
      hello
      &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4多重选择器
注意：中间不能有空格  否则没有反应 这是需要注意的
text() 类似于jsDom的innerText()
html()类似于 innerHtml()&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
//      alert(&#39;hello&#39;)
      $(function()
        {
          $(&#39;#btn&#39;).click(function(){
//            alert(&#39;hello&#39;);
//            $(&#39;#cls&#39;).text(&#39;This is  a  layer&#39;);  // class selector


            //$(&#39;div#cls&#39;).css(&#39;backgroundColor&#39;,&#39;yellow&#39;);  // label with Id selector
//            $(&#39;div #cls&#39;).css(&#39;backgroundColor&#39;,&#39;yellow&#39;); //中间不能有空格  否则没有反应 这是需要注意的
//   同样的标签加上lei也不是不能加上空格


            $(&#39;div#cls&#39;).text(&#39;InnerText方式添加&#39;);
            $(&#39;div#cls&#39;).html(&#39;&amp;lt;H1&amp;gt;InnerHTML方式添加&amp;lt;/H1&amp;gt;&#39;);

            //标签选择器的隐式编程   隐式循环！ 这是一个jQuery的一个好处 implicit cycle
            $(&#39;p&#39;).text(&#39;Set all the p the value&#39;);
    
          });
        });
    &amp;lt;/script&amp;gt;

    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
       #cls
       {
         width:300px;
         height:200px;
         background-color:green;
       }
    &amp;lt;/style&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;input type=&amp;quot;button&amp;quot; id=&amp;quot;btn&amp;quot; value=&amp;quot;change&amp;quot;/&amp;gt;
    &amp;lt;div id=&amp;quot;cls&amp;quot;&amp;gt;

    &amp;lt;/div&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
    &amp;lt;p class=&amp;quot;name&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5： 选择器  过滤器的使用
:first   first()
:last   last()
:eq()
:lt()
:gt()&lt;/p&gt;
&lt;p&gt;注意：可不敢再把siblings()漏掉了！&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;  test  the start mark&amp;lt;/title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        //注意是tr  行
        $(&#39;#tb tr:first&#39;).css(&#39;backgroundColor&#39;,&#39;green&#39;).css(&#39;fontSize&#39;,&#39;50px&#39;);
        $(&#39;#tb tr:last&#39;).css(&#39;color&#39;,&#39;black&#39;);
        // 0-3之间  0 1 2 3
        $(&#39;#tb tr:gt(0):lt(3)&#39;).css(&#39;fontSize&#39;,&#39;25px&#39;);
        $(&#39;#tb tr:odd&#39;).css(&#39;backgroundColor&#39;,&#39;yellow&#39;);

        $(&#39;#tb tr&#39;).click(function(){
          //可不敢再犯这种错误了！ ！ siblings()  加上括号
          $(this).css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;gray&#39;);
        })
      })
    &amp;lt;/script&amp;gt;

    
   &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      .cls
      {
        background-color:black;
      }
      td
      {
        border:1px solid red;
      }
    &amp;lt;/style&amp;gt;
  &amp;lt;/head&amp;gt;

  &amp;lt;body&amp;gt;
    &amp;lt;table id=&amp;quot;tb&amp;quot; style=&amp;quot;width:2\450px;height:20px;text-align:center; font-size:14px ;border:1px solid black;cursor:pointer&amp;quot;&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;Name&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Mark&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;Chairman Mao&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;89&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;Chairman Hu&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;79&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;Chairman Deng&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;99&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;Chairman Xi&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;98&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;Chairman jiang&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;76&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;

    &amp;lt;/table&amp;gt;
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6：相对容器 和绝对容器&lt;/p&gt;
&lt;p&gt;$(&amp;lsquo;p div&amp;rsquo;)  绝对容器  p的后代
$(&amp;lsquo;div&amp;rsquo;,&amp;lsquo;p&amp;rsquo;)  相对容器   所有在p标签中的 div
参考点不一样&lt;/p&gt;
&lt;p&gt;注意
//$(&amp;lsquo;this&amp;rsquo;).siblings.css(&amp;lsquo;backgroundColor&amp;rsquo;,&#39;&#39;);//可不敢再犯这个错误
//this不需要加上单引号
//为什么无法直接行t添加上 颜色？ 因为真正在表面显示的是td
//$(this).siblings().css(&amp;lsquo;backgroundColor&amp;rsquo;,&#39;&#39;);&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;
&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;  test  the start mark&amp;lt;/title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){

        //绝对定位
        // $(&#39;div p&#39;)表示div下的p元素
        //相对定位
        //相对div元素的p标签
        //$(&#39;p&#39;,&#39;div&#39;) 表示在div层中的p元素

        $(&#39;#tb tr&#39;).click(function(){
          //$(&#39;this&#39;).siblings.css(&#39;backgroundColor&#39;,&#39;&#39;);//可不敢再犯这个错误
          //this不需要加上单引号
          //为什么无法直接行t添加上 颜色？ 因为真正在表面显示的是td
          //$(this).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;);

          $(&#39;td&#39;,$(this).siblings()).css(&#39;backgroundColor&#39;,&#39;&#39;);
          $(&#39;td:even&#39;,$(this)).css(&#39;backgroundColor&#39;,&#39;red&#39;);
          $(&#39;td:odd&#39;,$(this)).css(&#39;backgroundColor&#39;,&#39;yellow&#39;);
        });

        //学习了.hover(,) 函数的使用方式
        //来的时候是第一个参数
        //去的时候是第二个参数
        $(&#39;tr&#39;).hover(function(){
          $(this).find(&#39;td&#39;).addClass(&#39;hover&#39;);
        },function(){
          $(this).find(&#39;td&#39;).removeClass(&#39;hover&#39;);
        });


        //l列的追踪
        $(&#39;td&#39;).hover(function(){
          var $index=$(this).index();
          $(this).addClass(&#39;hover&#39;);
          $(&#39;td:nth-child(&#39;+($index+1)+&#39;)&#39;).addClass(&#39;hover&#39;);
        },function(){
          $(&#39;#tb tr&#39;).children().removeClass(&#39;hover&#39;);
        });
        alert(&#39;Total rows:&#39;+$(&#39;#tb tr&#39;).length);


      })
    &amp;lt;/script&amp;gt;

    
   &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
     .hover
     {
       color:#fff;
       background-color:gray;
     }
      .cls
      {
        background-color:black;
      }
      td
      {
        border:1px solid red;
      }
    &amp;lt;/style&amp;gt;
  &amp;lt;/head&amp;gt;

  &amp;lt;body&amp;gt;
    &amp;lt;table id=&amp;quot;tb&amp;quot; style=&amp;quot;width:2\450px;height:20px;text-align:center; font-size:14px ;border:1px solid black;cursor:pointer&amp;quot;&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;First&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Second&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Third&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fourth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fifth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Sixth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Seventh&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;eighth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;nineth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;tenth&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;First&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Second&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Third&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fourth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fifth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Sixth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Seventh&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;eighth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;nineth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;tenth&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;First&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Second&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Third&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fourth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fifth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Sixth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Seventh&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;eighth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;nineth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;tenth&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;First&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Second&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Third&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fourth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Fifth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Sixth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;Seventh&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;eighth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;nineth&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;tenth&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;

    &amp;lt;/table&amp;gt;
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一个有趣的分页&lt;/p&gt;
&lt;p&gt;奇巧淫技&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;!DOCTYPE html PUBLIC &amp;quot;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;quot; &amp;quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&amp;quot;&amp;gt;

&amp;lt;html xmlns=&amp;quot;http://www.w3.org/1999/xhtml&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
   .page
   {
       margin:5px;
   }
   .hover
   {
       background-color:#00f;
       color:#fff;
       cursor:hand;
   }
    &amp;lt;/style&amp;gt;

     &amp;lt;script src=&amp;quot;jquery-2.1.3.js&amp;quot; type=&amp;quot;text/javascript&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
     &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

         $(document).ready(function () {
           //实际的效果是在先前的表格中进行隐藏和显示的小伎俩！ 奇巧淫技
           //get the rows
             var $rows = $(&#39;table tbody tr&#39;).length;
          // get the show lines  页面行数
             var $pagesize = 2;
          //总页数
             var $pagecount = Math.ceil($rows / $pagesize);
          //创建一个层
             var $div = $(&#39;&amp;lt;div id=&amp;quot;pages&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&#39;);
          //在层中加入page
             for (var i = 0; i &amp;lt; $pagecount; i++) {
               //把创建的东西加入到层中
                 $(&#39;&amp;lt;span class=&amp;quot;page&amp;quot;&amp;gt;&#39; + (i + 1) + &#39;&amp;lt;/span&amp;gt;&#39;).appendTo($div);
             }
             $div.appendTo(&#39;table&#39;);

             //appendd the hover
             //设置页面的数字的悬浮效果
             $(&#39;.page&#39;).hover(function () {
                 $(this).addClass(&#39;hover&#39;);
             }, function () {
                 $(this).removeClass(&#39;hover&#39;);
             });

             //增加了页面行的点击隐藏的事件
             $(&#39;table tbody tr&#39;).click(function(){
               $(this).hide();

             })
             //隐藏所有行
             $(&#39;table tbody tr&#39;).hide();
             //获得所有的tr行对象
             var tr = $(&#39;table tbody tr&#39;);
             for (var i = 0; i &amp;lt; $pagecount - 1; i++) {
                 $(tr[i]).show();
             }

             //设置页面的点击事件 效果
             $(&#39;span&#39;).click(function () {
                 $(&#39;table tbody tr&#39;).hide();
                 for (i = ($(this).text() - 1) * $pagesize; i &amp;lt;= $(this).text() * $pagesize - 1; i++) {
                     $(tr[i]).show();
                 }
             })
         });
     &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;table border=&amp;quot;1&amp;quot; width=&amp;quot;200px&amp;quot;&amp;gt;
&amp;lt;thead&amp;gt;
&amp;lt;tr&amp;gt;
&amp;lt;th&amp;gt;ID&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Name&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Mark&amp;lt;/th&amp;gt;
&amp;lt;/tr&amp;gt;
&amp;lt;/thead&amp;gt;
&amp;lt;tbody&amp;gt;
&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;100&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Steven&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;100&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;101&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Mike&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;70&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;102&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Robot&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;80&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;103&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Perry&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;100&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;104&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Lion&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;90&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;105&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Andy&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;85&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;/tbody&amp;gt;

&amp;lt;/table&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一个小练习： 东西部篮球队&lt;/p&gt;
&lt;p&gt;注意：
//可不敢再犯这个错误   1  逗号写成了句话   2： siblings后直接街上css的参数
//$(this).css(&amp;lsquo;backgroundColor&amp;rsquo;.&amp;lsquo;red&amp;rsquo;).siblings()&amp;lsquo;backgroundColor&amp;rsquo;,&#39;&#39;);&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;      //由此错误可得到一个结论
      // jQuery分成两个部分一个是获得Dom对象  紧接着是设置CSS样式！
      // 也就是js其实就是把这两个部分按照链条一样一对一对的串起来了
      //一个Dom一个Css  然后再一个Dom 一个CSS
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;ol li&#39;).mouseover(function(){
          //可不敢再犯这个错误   1  逗号写成了句话   2： siblings后直接街上css的参数
          //$(this).css(&#39;backgroundColor&#39;.&#39;red&#39;).siblings()&#39;backgroundColor&#39;,&#39;&#39;);

          //由此错误可得到一个结论
          // jQuery分成两个部分一个是获得Dom对象  紧接着是设置CSS样式！
          // 也就是js其实就是把这两个部分按照链条一样一对一对的串起来了
          //一个Dom一个Css  然后再一个Dom 一个CSS
          $(this).css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;);
        });
        $(&#39;ol li&#39;).click(function()
           {

             //第一种写法
//             $(this).prevAll().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
//             $(this).nextAll().css(&#39;backgroundColor&#39;,&#39;yellow&#39;);

             //第二种写法
             //end的作用就是从前面所有 又跳回到$(this)的作用！！关键点是end() 这样才可以帮助我们就你行链式编程
             $(this).prevAll().css(&#39;backgroundColor&#39;,&#39;blue&#39;).end().nextAll().css(&#39;backgroundColor&#39;,&#39;yellow&#39;);
           })
      });
    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Ol id=&amp;quot;east&amp;quot;&amp;gt;
      &amp;lt;Li&amp;gt;亚特兰大 老鹰&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;芝加哥 公牛&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;波士顿 凯尔特人&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;夏洛特 黄蜂&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;克利夫兰 骑士&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;布鲁克林 篮网&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;迈阿密 热火&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;底特律 活塞&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;纽约 尼克斯&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;奥兰多 魔术&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;印第安纳 步行者&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;费城 76人&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;华盛顿 奇才&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;密尔沃基 雄鹿&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;多伦多 猛龙&amp;lt;/Li&amp;gt;
    &amp;lt;/Ol&amp;gt;
    &amp;lt;Ol id=&amp;quot;west&amp;quot;&amp;gt;
      &amp;lt;Li&amp;gt;金州 勇士&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;丹佛 掘金&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;达拉斯 小牛&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;洛杉矶 快船&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;明尼苏达 森林狼&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;休斯顿 火箭&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;洛杉矶 湖人&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;奥克兰陈马成 雷霆&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;孟菲斯 灰熊&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;菲尼克斯 太阳&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;波特兰 开拓者&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;新奥尔良 鹈鹕&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;萨克拉门托 国王&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;犹他 爵士&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;圣安东尼奥 马刺&amp;lt;/Li&amp;gt;
    &amp;lt;/Ol&amp;gt;
    &amp;lt;Ul id=&amp;quot;other&amp;quot;&amp;gt;
      &amp;lt;Li&amp;gt;步行者&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;山猫&amp;lt;/Li&amp;gt;
    &amp;lt;/Ul&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7：过滤器的练习&lt;/p&gt;
&lt;p&gt;注意：
even和odd选择器     index从0开始。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;  test  the start mark&amp;lt;/title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;#btnFirst&#39;).click(function(){
          $(&#39;div:first&#39;).css(&#39;backgroundColor&#39;,&#39;green&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
        });
        $(&#39;#btnFirst2&#39;).click(function(){
          $(&#39;div&#39;).first().css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
        });
        $(&#39;#Last&#39;).click(function(){
          $(&#39;div:last&#39;).css(&#39;backgroundColor&#39;,&#39;purple&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
        });
        $(&#39;#Last2&#39;).click(function(){
          $(&#39;div&#39;).last().css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
        });

        $(&#39;#eq2&#39;).click(function(){
          $(&#39;div:eq(2)&#39;).css(&#39;backgroundColor&#39;,&#39;black&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
        });
        $(&#39;#lt2&#39;).click(function(){
          //范围性内容 不能用siblings
          //$(&#39;div:lt(2)&#39;).css(&#39;backgroundColor&#39;,&#39;black&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
          $(&#39;div:lt(2)&#39;).css(&#39;backgroundColor&#39;,&#39;black&#39;);
        });
        $(&#39;#gt2&#39;).click(function(){
        // $(&#39;div:gt(2)&#39;).css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
          $(&#39;div:gt(2)&#39;).css(&#39;backgroundColor&#39;,&#39;red&#39;);
        });
        //下标从0开始  index 所以表面上even是第一个元素 
        $(&#39;#even2&#39;).click(function(){
         // $(&#39;div:even&#39;).css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
          $(&#39;div:even&#39;).css(&#39;backgroundColor&#39;,&#39;red&#39;);
        });
        $(&#39;#odd2&#39;).click(function(){
          //$(&#39;div:odd&#39;).css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;blue&#39;);
          $(&#39;div:odd&#39;).css(&#39;backgroundColor&#39;,&#39;red&#39;);
        });
        // 当然也是可以组合起来  $(&#39;div:gt(3):lt(2)&#39;)
        // $(&#39;div:not(.cls)&#39;)
        $(&#39;#olivenot&#39;).click(function(){
          //必须加上. 句话才是有效的
          $(&#39;div:not(.cls)&#39;).css(&#39;backgroundColor&#39;,&#39;yellow&#39;);
        });
      $(&#39;#header1&#39;).click(function(){
        $(&#39;h1,h2,h3,h4,h5,h6&#39;).css(&#39;backgroundColor&#39;,&#39;gray&#39;);
      });
      $(&#39;#header2&#39;).click(function(){
        $(&#39;:header&#39;).css(&#39;backgroundColor&#39;,&#39;yellow&#39;);
      });



      });
    &amp;lt;/script&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      div
      {
        width:150px;
        height:30px;
        margin-bottom:10px;
        background-color:blue;
      }
      td
      {
        border:1px solid red;
      }
      .cls
      {
           background-color:olive;
      }
    &amp;lt;/style&amp;gt;
  &amp;lt;/head&amp;gt;


  &amp;lt;body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnFirst&amp;quot; value=&amp;quot;divColorToGreenFirst&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnFirst2&amp;quot; value=&amp;quot;divColorToGreenFirst2&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;Last&amp;quot; value=&amp;quot;divColorToGreenLast&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;Last2&amp;quot; value=&amp;quot;divColorToGreenLast2&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;gt2&amp;quot; value=&amp;quot;divColorToGreenGreater2&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;eq2&amp;quot; value=&amp;quot;divColorToGreenEqual2&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;lt2&amp;quot; value=&amp;quot;divColorToGreenLess2&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;even2&amp;quot; value=&amp;quot;divColorToGreenEven&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;odd2&amp;quot; value=&amp;quot;divColorToGreenOdd&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;olivenot&amp;quot; value=&amp;quot;not olive&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;header1&amp;quot; value=&amp;quot;header1&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;header2&amp;quot; value=&amp;quot;header2&amp;quot;/&amp;gt;
    &amp;lt;Div&amp;gt;&amp;lt;/Div&amp;gt;
    &amp;lt;Div&amp;gt;&amp;lt;/Div&amp;gt;
    &amp;lt;Div class=&amp;quot;cls&amp;quot;&amp;gt;&amp;lt;/Div&amp;gt;
    &amp;lt;Div&amp;gt;&amp;lt;/Div&amp;gt;
    &amp;lt;Div&amp;gt;&amp;lt;/Div&amp;gt;

    &amp;lt;H1&amp;gt;Header 1&amp;lt;/H1&amp;gt;
    &amp;lt;H2&amp;gt;Header 2&amp;lt;/H2&amp;gt;
    &amp;lt;H3&amp;gt;Header 3&amp;lt;/H3&amp;gt;
    &amp;lt;H4&amp;gt;Header 4&amp;lt;/H4&amp;gt;
    &amp;lt;H5&amp;gt;Header 5&amp;lt;/H5&amp;gt;
    &amp;lt;H6&amp;gt;Header 6&amp;lt;/H6&amp;gt;
      
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一个有趣的slideup and down 小案例：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;!DOCTYPE html PUBLIC &amp;quot;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;quot; &amp;quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&amp;quot;&amp;gt;

&amp;lt;html xmlns=&amp;quot;http://www.w3.org/1999/xhtml&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
    &amp;lt;/style&amp;gt;
     &amp;lt;script src=&amp;quot;jquery-2.1.3.js&amp;quot; type=&amp;quot;text/javascript&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
     &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
         $(document).ready(function () {
             $(&#39;#message1&#39;).css({ &#39;backgroundColor&#39;: &#39;#f00&#39;, &#39;text-align&#39;: &#39;center&#39;,&#39;width&#39;:&#39;200px&#39; }).hide();
             $(&amp;quot;#message2&amp;quot;).css({ &#39;backgroundColor&#39;: &#39;gray&#39;, &#39;text-align&#39;: &#39;center&#39;,&#39;width&#39;: &#39;200px&#39; }).click(function () {
                 $(this).slideUp();
                 $(&amp;quot;#message1&amp;quot;).slideDown();
             });
         });
     &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;p id=&amp;quot;message1&amp;quot;&amp;gt;Welome to My Blog&amp;lt;/p&amp;gt;

&amp;lt;p id=&amp;quot;message2&amp;quot;&amp;gt;Welcome to My Facebook&amp;lt;/p&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;8： 评分和addClass&lt;/p&gt;
&lt;p&gt;.end()断链的使用，之所以要断链也是因为返回来的是集合，而不是原先的对象
注意：
//测试开关灯
//隐含着规律是：jquery获得的都是集合的元素
//做判断一定得是 $(function(){})里面中&lt;/p&gt;
&lt;p&gt;五角星是直接输入，而不是通过图片&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;  test  the start mark&amp;lt;/title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

      // 测试评分
      $(function(){
        $(&#39;#tb td&#39;).mouseover(function(){
            //$(this).prevall().css(&#39;backgroundcolor&#39;,&#39;red&#39;);
            $(this).text(&#39;○&#39;).prevall().text(&#39;○&#39;).end().nextall().text(&#39;☆&#39;);
        });
        $(&#39;#tb td&#39;).mouseout(function()
        {
          $(&#39;#tb td&#39;).text(&#39;☆&#39;);
        });
      });
    &amp;lt;/script&amp;gt;

    
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      //测试开关灯
      //隐含着规律是：jquery获得的都是集合的元素
    //做判断一定得是 $(function(){})里面中
    $(function(){
      if($(&#39;#btn&#39;).length&amp;gt;0)
        {
          alert(&#39;存在id=#tb的标签&#39;);
        }else
        {
          alert(&#39;不存在id=#tb的标签&#39;);
        }
        $(&#39;#btnopen&#39;).click(function(){
          $(&#39;body&#39;).addclass(&#39;cls&#39;);
        });
        $(&#39;#btnclose&#39;).click(function(){
          $(&#39;body&#39;).removeclass(&#39;cls&#39;);
        });
        $(&#39;#btncloseopen&#39;).click(function(){
          if($(&#39;body&#39;).hasclass(&#39;cls&#39;))
            {
                $(&#39;body&#39;).removeclass(&#39;cls&#39;);
            }else
            {
                $(&#39;body&#39;).addclass(&#39;cls&#39;);

            }
        });
        $(&#39;#btncloseopen2&#39;).click(function(){
            $(&#39;body&#39;).toggleclass(&#39;cls&#39;);
        });

    });


    &amp;lt;/script&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      .cls
      {
        background-color:black;
      }
      td
      {
        border:1px solid red;
      }
    &amp;lt;/style&amp;gt;
  &amp;lt;/head&amp;gt;

  &amp;lt;body&amp;gt;
    &amp;lt;table id=&amp;quot;tb&amp;quot; style=&amp;quot;width:250px;height:20px;text-align:center; font-size:20px ;border:1px solid black;cursor:pointer&amp;quot;&amp;gt;
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;☆&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;☆&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;☆&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;☆&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;☆&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
    &amp;lt;/table&amp;gt;
    &amp;lt;input type=&#39;button&#39; name=&amp;quot;hello&amp;quot; value=&amp;quot;hello&amp;quot; id=&amp;quot;btn&amp;quot;/&amp;gt;
    &amp;lt;input type=&#39;button&#39; name=&amp;quot;open&amp;quot; value=&amp;quot;turn on the light&amp;quot; id=&amp;quot;btnopen&amp;quot;/&amp;gt;
    &amp;lt;input type=&#39;button&#39; name=&amp;quot;close&amp;quot; value=&amp;quot;turn off the light&amp;quot; id=&amp;quot;btnclose&amp;quot;/&amp;gt;
    &amp;lt;input type=&#39;button&#39; name=&amp;quot;openclose&amp;quot; value=&amp;quot;turn off|on the light&amp;quot; id=&amp;quot;btncloseopen&amp;quot;/&amp;gt;
    &amp;lt;input type=&#39;button&#39; name=&amp;quot;openclose2&amp;quot; value=&amp;quot;turn off|on the light2&amp;quot; id=&amp;quot;btncloseopen2&amp;quot;/&amp;gt;
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;两个综合实验：&lt;/p&gt;
&lt;p&gt;case1: 数组 练习join()
append()
sort()
splice()
hover()悬停事件
concat()&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;  test  the start mark&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;

    &amp;lt;!--1 touppercase--&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      .hover
      {
          background-color:red;
          font-size:24px;
      }
    &amp;lt;/style&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        //核心：touppercase
        // Good!  Let the array become beautiful
        var namePostion=$(&#39;#names&#39;); 
        var Member=[&#39;basket&#39;,&#39;foot&#39;,&#39;tennis&#39;,&#39;running&#39;,&#39;pingpong&#39;,&#39;net&#39;];
        // map() 迭代数组中每个元素  并为每个元素分别调用一次回调函数
        Member =$.map(Member,function(value,index){
          return(index+1+&#39;.&#39;+value.toUpperCase());
        });
        $.each(Member,function(index,value){
          namePostion.append($(&#39;&amp;lt;Li class=&amp;quot;sport&amp;quot;&amp;gt;&#39;+value+&#39;&amp;lt;/Li&amp;gt;&#39;));
        });

        //使用了悬停事件
        $(&#39;.sport&#39;).hover(function(){
           //   alert(&#39;ok&#39;);
              $(this).addClass(&#39;hover&#39;);
        },function(){
              $(this).removeClass(&#39;hover&#39;);
           //   alert(&#39;byel&#39;);
        });

      })
    &amp;lt;/script&amp;gt;
    &amp;lt;!--2 grep--&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      #All
      {
        background-color:green;

      }
      #Part
      {
        background-color:gray;
      }
    &amp;lt;/style&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        var Member=[&#39;basket&#39;,&#39;foot&#39;,&#39;tennis&#39;,&#39;running&#39;,&#39;pingpong&#39;,&#39;net&#39;];
        //一定要注意在p和#All不要加入空格
        // join通过&amp;lt;br&amp;gt;来划分数组中的元素
        $(&#39;p#All&#39;).append(Member.join(&#39;&amp;lt;br/&amp;gt;&#39;));
        //grep() 分析数组的所有元素，把不想要的元素过滤掉。
        Member = $.grep(Member,function(value){
          return value.length &amp;gt; 6;
        });
        $(&#39;p#Part&#39;).append(Member.join(&#39;&amp;lt;br/&amp;gt;&#39;));
      });


    &amp;lt;/script&amp;gt;

    &amp;lt;!--3 join sort--&amp;gt;

    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      
      .All
      {
        background-color:red;
      }
      .Part
      {
        background-color:gray;
      }
      .AllNumber
      {
        background-color:blue;
      }
      .PartNumber
      {
        background-color:lime;
      }
    &amp;lt;/style&amp;gt;



    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        var Member=[&#39;basket&#39;,&#39;foot&#39;,&#39;tennis&#39;,&#39;running&#39;,&#39;pingpong&#39;,&#39;net&#39;];
        //重复的一个练习
        $(&#39;p.All&#39;).append(Member.join(&#39;&amp;lt;Br&amp;gt;&#39;));
        $(&#39;p.Part&#39;).append(Member.sort().join(&#39;&amp;lt;/Br&amp;gt;&#39;));

        var Number1 = [12,43,2,34,6,34];
        $(&#39;p.AllNumber&#39;).append(Number1.join(&#39;&amp;lt;Br/&amp;gt;&#39;));

        // a b 两个值 进行比较  大的那个放在后排
        Number1 =  Number1.sort(function(a,b){
          return a-b;
        });
        $(&#39;p.partNumber&#39;).append(Number1.join(&#39;&amp;lt;Br/&amp;gt;&#39;));
        
      });

    &amp;lt;/script&amp;gt;

    &amp;lt;!--4 splice--&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
     
      .Part1
      {
        background-color:lime;
      }

      .Remain
      {
        background-color:red;
      }
    &amp;lt;/style&amp;gt;



    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

      $(function(){
        var Member=[&#39;basket&#39;,&#39;foot&#39;,&#39;tennis&#39;,&#39;running&#39;,&#39;pingpong&#39;,&#39;net&#39;];
        //第一个参数为索引开始   第二个参数为删除的个数     splice作用返回前两个成员到Filter数组
        var Filter=Member.splice(0,2);
        $(&#39;p.Part1&#39;).append(Filter.join(&#39;&amp;lt;Br/&amp;gt;&#39;));
        $(&#39;p.Remain&#39;).append(Member.join(&#39;&amp;lt;Br/&amp;gt;&#39;));
      })

    &amp;lt;/script&amp;gt;

    &amp;lt;!--5  concat --&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
    
      .First
      {
        background-color:lime;
      }
      .Last
      {
        background-color:gray;
      }
      .Whole
      {
        background-color:red;
      }
    &amp;lt;/style&amp;gt;



    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        var first=[&#39;basket&#39;,&#39;foot&#39;,&#39;tennis&#39;];
        var last=[&#39;running&#39;,&#39;pingpong&#39;,&#39;net&#39;];
        $(&#39;p.First&#39;).append(first.join(&#39;&amp;lt;Br/&amp;gt;&#39;));
        $(&#39;p.Last&#39;).append(last.join(&#39;&amp;lt;Br/&amp;gt;&#39;));
        var whole=first.concat(last);
        $(&#39;p.Whole&#39;).append(whole.join(&#39;&amp;lt;Br/&amp;gt;&#39;));
      });

    &amp;lt;/script&amp;gt;


    &amp;lt;!--6  Json sort--&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      .All1
      {
        background-color:green;
      }

    
    &amp;lt;/style&amp;gt;



    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        var students=[{Name:&#39;Qianqian&#39;,Role:&#39;Administrator&#39;,Age:&#39;45&#39;},
          {Name:&#39;Lilei&#39;,Role:&#39;Programmer&#39;,Age:&#39;15&#39;},
          {Name:&#39;Dongyuliang&#39;,Role:&#39;Seller&#39;,Age:&#39;25&#39;},
          {Name:&#39;LiFeng&#39;,Role:&#39;manager&#39;,Age:&#39;25&#39;},
          {Name:&#39;zhaoli&#39;,Role:&#39;Architector&#39;,Age:&#39;35&#39;}
        ];

        //有点类似 Java中的treeset的作用  需要设置一个比较器
        students=students.sort(function(studnetA,studentB){
          if(studnetA.name&amp;gt;studentB.name){
            return 1;
          }else if(studnetA.name &amp;lt; studentB.name)
          {
            return -1;
          }else
          {
            return 0;
          }
        });
        $.each(students,function(index,value){
          $(&#39;p.All1&#39;).append(&#39;&amp;lt;Tr&amp;gt;&amp;lt;Td&amp;gt;&amp;gt;&#39;+value.Name+&#39;&amp;lt;/Td&amp;gt;&amp;lt;Td&amp;gt;&#39;+value.Role+&#39;&amp;lt;/Td&amp;gt;&amp;lt;Td&amp;gt;&#39;+value.Age+&#39;&amp;lt;/Td&amp;gt;&amp;lt;/Tr&amp;gt;&#39;);
        });
      });

    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;p id=&amp;quot;names&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;

    &amp;lt;hr/&amp;gt;
    &amp;lt;H3&amp;gt; Member Name&amp;lt;/H3&amp;gt;
    &amp;lt;P id=&amp;quot;All&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;H3&amp;gt; Part Name&amp;lt;/H3&amp;gt;
    &amp;lt;P id=&amp;quot;Part&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;Hr/&amp;gt;

    &amp;lt;H3&amp;gt;Not sort string array&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;All&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;H3&amp;gt; sort string array&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;Part&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;H3&amp;gt;Not sort number&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;AllNumber&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;H3&amp;gt; sort number&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;PartNumber&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;

    &amp;lt;Hr/&amp;gt;
    &amp;lt;H3&amp;gt;get the  Filer array&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;Part1&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;H3&amp;gt;get the remain array&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;Remain&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;

    &amp;lt;Hr/&amp;gt;
    &amp;lt;H3&amp;gt;Get the First part&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;First&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;H3&amp;gt;Get the Last part&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;Last&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
    &amp;lt;H3&amp;gt;Get the Whole part&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;Whole&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;


    &amp;lt;Hr&amp;gt;
    &amp;lt;H3&amp;gt;Member Info&amp;lt;/H3&amp;gt;
    &amp;lt;P class=&amp;quot;All1&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;


  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case2: 事件触发&lt;/p&gt;
&lt;p&gt;bind()
unbind()
trigger()
多类的设置 class=&amp;quot;  &amp;quot;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;  test  the common jQuery event &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;


    &amp;lt;!--1  trigger   bind  unbind--&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      .Red
      {
          color:red;
      }
      .Green
      {
        color:green;
      }
      .unbind
      {
        color:lime
      }
      .buttons
      {
        width:150px;
        height:20px;
        margin:5px;
        border:2px solid;
        float:left;
        font-weight:bold;
        background-color:gray;
      }
      .Down
      {
        color:green;
      }
      .Up
      {
        color:red;
      }
      .Over
      {
        color:lime;
      }
      .Mouses
      {
        width:150px;
        height:20px;
        margin:5px;
        border:2px solid;
        float:left;
        font-weight:bold;
        background-color:gray;
      }

    &amp;lt;/style&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      //可不敢再犯这个错误
      //$(&#39;.button&#39;).bind(&#39;click&#39;,function(){
    $(function(){
       $(&#39;.buttons&#39;).bind(&#39;click&#39;,function(){
        alert(&#39;You have clicked &#39;+$(this).text()); //innerText()
        // trigger without click !!!  automated;
      //可不敢再犯这个错误
        //$(.Green).trigger(&#39;click&#39;);
       // $(&#39;.Green&#39;).trigger(&#39;click&#39;);

       // unbindf test
        $(&#39;.Unbind&#39;).bind(&#39;click&#39;,function(){
          alert(&#39;You have clicked the&#39;+$(this).text()+&#39;&amp;lt;Br/&amp;gt;After that the button will unbind the click event!&#39;);
          $(&#39;.Unbind&#39;).unbind(&#39;click&#39;);

        })
      });
       
      //mouse event
      $(&#39;.Mouses&#39;).bind(&#39;mousedown&#39;,function(){
          alert(&#39;your mouse have been pressed down&#39;+$(this).text());
      });

      $(&#39;.Mouses&#39;).bind(&#39;mouseup&#39;,function(){
          alert(&#39;your mouse have been pressed up&#39;+$(this).text());
      });

      $(&#39;.Mouses&#39;).bind(&#39;mouseover&#39;,function(){
          alert(&#39;your mouse have been pressed over&#39;+$(this).text());
      });


      //focus test
      $(&#39;#btn&#39;).focus(function(){
        alert(&#39;ol&#39;);
        $(&#39;#btn&#39;).html(&#39;&amp;lt;Font color=&amp;quot;red&amp;quot;&amp;gt;&amp;lt;Strong&amp;gt;Focus&amp;lt;/Strong&amp;gt;&amp;lt;/Font&amp;gt;&#39;);
      });
      $(&#39;#btn&#39;).blur(function(){
        alert(&#39;fuck&#39;);
        $(&#39;#btn&#39;).html(&#39;&amp;lt;Font color=&amp;quot;gray&amp;quot;&amp;gt;&amp;lt;Italic&amp;gt;Focus&amp;lt;/Italic&amp;gt;&amp;lt;/Font&amp;gt;&#39;);
      });

       
    });
    &amp;lt;/script&amp;gt;



  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;H3&amp;gt;Test bind and trigger&amp;lt;/H3&amp;gt;
    &amp;lt;!--Multiple classes !!!　Take Note--&amp;gt;
    &amp;lt;Span class=&amp;quot;Red buttons&amp;quot;&amp;gt;Red&amp;lt;/Span&amp;gt;
    &amp;lt;Span class=&amp;quot;Green buttons&amp;quot;&amp;gt;Green&amp;lt;/Span&amp;gt;
    &amp;lt;Span class=&amp;quot;Unbind buttons&amp;quot;&amp;gt;Unbind it&amp;lt;/Span&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;hr/&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;H3&amp;gt;Test bind and trigger&amp;lt;/H3&amp;gt;
    &amp;lt;!--Multiple classes !!!　Take Note--&amp;gt;
    &amp;lt;Span class=&amp;quot;Mouses Down&amp;quot;&amp;gt;Mouse Down&amp;lt;/Span&amp;gt;
    &amp;lt;Span class=&amp;quot;Mouses Up&amp;quot;&amp;gt;Mouse Up&amp;lt;/Span&amp;gt;
    &amp;lt;Span class=&amp;quot;Mouses Over&amp;quot;&amp;gt;Mouse over&amp;lt;/Span&amp;gt;

    &amp;lt;Br/&amp;gt;
    &amp;lt;hr/&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;H3&amp;gt;Test focus and blur&amp;lt;/H3&amp;gt;
    &amp;lt;!--     Input cannot  html  --&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot; name=&amp;quot;mouse&amp;quot; id=&amp;quot;btn&amp;quot; values=&amp;quot;focus&amp;quot;/&amp;gt;

    &amp;lt;/Div&amp;gt;
    


  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>jQuery10-18节笔记代码April5th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/jquery10-18jie-bi-ji-dai-ma-april5th/</link>
      <pubDate>Mon, 11 May 2015 14:58:44 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/jquery10-18jie-bi-ji-dai-ma-april5th/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.rupeng.com/forum/thread-45422-1-1.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.rupeng.com/forum/thread-45422-1-1.html&lt;/a&gt; jquery1-9
1：移除元素
$(&amp;lsquo;div&amp;rsquo;).empty()  清空层中的元素
$(&amp;lsquo;div&amp;rsquo;).remove(&#39;.cls&#39;)   清空层中运用cls样式的元素
$(&amp;lsquo;div&amp;rsquo;).remove()  自我删除
2: select 下拉框的练习
单选移到另一个框
全选移到另一个框
option:selected表示已选中的元素
:selected表示所有选中的下列框元素，前提是select设置了 multiple=&amp;ldquo;multiple&amp;rdquo;&lt;/p&gt;
&lt;p&gt;案例1：（单选和全选）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;#btnLeft&#39;).click(function(){
          $(&#39;#sel2 option:selected&#39;).appendTo(&#39;#sel1&#39;);
          //$(&#39;#sel1 option:selected&#39;).appendTo($(&#39;#sel2&#39;));
        });
        $(&#39;#btnRight&#39;).click(function(){
          $(&#39;#sel1 option:selected&#39;).appendTo(&#39;#sel2&#39;);
        });

        $(&#39;#btnAllRight&#39;).click(function(){
          $(&#39;#sel1 option&#39;).appendTo(&#39;#sel2&#39;);
        });

        $(&#39;#btnAllLeft&#39;).click(function(){
          $(&#39;#sel2 option&#39;).appendTo(&#39;#sel1&#39;);
        });

      })
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;


  &amp;lt;Body&amp;gt;
    &amp;lt;Select id=&amp;quot;sel1&amp;quot; multiple=&amp;quot;multiple&amp;quot; style=&amp;quot;float:left; width:400px;height:100px;&amp;quot;&amp;gt;
      &amp;lt;!--Multipel can show all the contains in the selector--&amp;gt;
      &amp;lt;Option &amp;gt; delete&amp;lt;/Option&amp;gt;
      &amp;lt;Option &amp;gt; create&amp;lt;/Option&amp;gt;
      &amp;lt;Option &amp;gt; check&amp;lt;/Option&amp;gt;
      &amp;lt;Option &amp;gt; update&amp;lt;/Option&amp;gt;
      &amp;lt;Option &amp;gt; select&amp;lt;/Option&amp;gt;
    &amp;lt;/Select&amp;gt;
    &amp;lt;!--In the div, the width:50px  then inside the div
    is 50px width,so it change the line!
    And because the float:left ,so it will try to align
    along the left--&amp;gt;
    &amp;lt;Div style=&amp;quot;float:left;width:50px&amp;quot;&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnLeft&amp;quot; value=&amp;quot;&amp;lt;&amp;quot; style=&amp;quot;width:50px&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnRight&amp;quot; value=&amp;quot;&amp;gt;&amp;quot; &amp;quot;width:50px&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnAllLeft&amp;quot; value=&amp;quot;&amp;lt;&amp;lt;&amp;quot; &amp;quot;width:50px&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnAllRight&amp;quot; value=&amp;quot;&amp;gt;&amp;gt;&amp;quot; &amp;quot;width:50px&amp;quot;/&amp;gt;

    &amp;lt;/Div&amp;gt;
    &amp;lt;Button type=&amp;quot;button&amp;quot; id=&amp;quot;btnLeft1&amp;quot; value=&amp;quot;To the left&amp;quot;&amp;gt;&amp;quot;To the left&amp;quot;&amp;lt;/Button&amp;gt;
    &amp;lt;Button type=&amp;quot;button&amp;quot; id=&amp;quot;btnRight1&amp;quot; value=&amp;quot;To the right&amp;quot;/&amp;gt;&amp;quot;To the right&amp;quot;&amp;lt;/Button&amp;gt;
    &amp;lt;Button type=&amp;quot;button&amp;quot; id=&amp;quot;btnAllLeft1&amp;quot; value=&amp;quot;All To the left&amp;quot;/&amp;gt;&amp;quot;All To the left&amp;quot;&amp;lt;/Button&amp;gt;
    &amp;lt;Button type=&amp;quot;button&amp;quot; id=&amp;quot;btnAllRight1&amp;quot; value=&amp;quot;All To the left&amp;quot;/&amp;gt;&amp;quot;All To the left&amp;quot;&amp;lt;/Button&amp;gt;
    &amp;lt;!--Because of the float:left,so selector will focuse to
        take occupy of the left position--&amp;gt;
    &amp;lt;Select id=&amp;quot;sel2&amp;quot; multiple=&amp;quot;multiple&amp;quot; style=&amp;quot;float:left; width:400px;height:100px;&amp;quot;&amp;gt;
      &amp;lt;!--&amp;lt;Select id=&amp;quot;sel2&amp;quot; multiple=&amp;quot;multiple&amp;quot;&amp;gt;--&amp;gt;
    &amp;lt;/Select&amp;gt;


  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例2：计算器&lt;/p&gt;
&lt;p&gt;使用switch &amp;hellip;case 判断选中的计算器操作符
注意：输入参数的有效性的判断。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test Calculator with the basic operator&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;#equal&#39;).click(function(){
          var leftvalue=$(&#39;#one&#39;).val();
          var rightvalue=$(&#39;#two&#39;).val();
          if(leftvalue==&#39;&#39;)
          {
            console.log(&#39;The empty of the one!;&#39;);
            return;
          }
          if(rightvalue==&#39;&#39;)
          {
            console.log(&#39;The empty of the two!;&#39;);
            return;
          }
          var result=0.0;
          //alert($(&#39;#operator :selected&#39;).val());
          //alert(typeof($(&#39;#operator :selected&#39;).val()));
          switch($(&#39;#operator :selected&#39;).val())
          {
            case &#39;+&#39;:
              result=parseFloat(leftvalue)+parseFloat(rightvalue);
              break;
              case &#39;-&#39;:
result=parseFloat(leftvalue)-parseFloat(rightvalue);
              break;
             case &#39;*&#39;:
result=parseFloat(leftvalue)*parseFloat(rightvalue);
              break;
             case &#39;/&#39;:
result=parseFloat(leftvalue)/parseFloat(rightvalue);
              break;

              default:
                break;
          }
          $(&#39;#result&#39;).val(result);
        })
      })
    &amp;lt;/script&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;one&amp;quot;/&amp;gt;
    &amp;lt;Select id=&amp;quot;operator&amp;quot; style=&amp;quot; width:40px;height:30px;&amp;quot;&amp;gt;
      &amp;lt;Option&amp;gt;+&amp;lt;/Option&amp;gt;
      &amp;lt;Option&amp;gt;-&amp;lt;/Option&amp;gt;
      &amp;lt;Option&amp;gt;*&amp;lt;/Option&amp;gt;
      &amp;lt;Option&amp;gt;/&amp;lt;/Option&amp;gt;
    &amp;lt;/Select&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;two&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;equal&amp;quot;value=&amp;quot;=&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;result&amp;quot;/&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4: checkbox的练习&lt;/p&gt;
&lt;p&gt;:disabled 属性的练习&lt;/p&gt;
&lt;p&gt;案例1： 软件安装时需要提醒用户阅读协议，一般是5s，然后才可以点击同意。&lt;/p&gt;
&lt;p&gt;注意：计时器setInterval和清除计时器clearInterval() .  回顾： setTimeout 和 clearTimeout&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test Time machine &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        var i =5;
        var timeMeter=setInterval(function(){
          if(i&amp;gt;0)
          {
            i--;
            $(&#39;#span1&#39;).text(&#39;Please read the agreement carefully(&#39;+i+&#39;s)&#39;);
          }else
          {
            //forget clear The time meter
            clearInterval(timeMeter);
            $(&#39;#span1&#39;).text(&#39;Agree&#39;);
            $(&#39;#chk&#39;).attr(&#39;disabled&#39;,false);
          }
        },1000);
      })
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;checkbox&amp;quot; id=&amp;quot;chk&amp;quot; disabled=&amp;quot;disabled&amp;quot;&amp;gt;&amp;lt;Span id=&amp;quot;span1&amp;quot;&amp;gt;Please read the agreement carefully(5s)&amp;lt;/Span&amp;gt;
  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;

            $(&#39;#span1&#39;).text(&#39;Agree&#39;);
            $(&#39;#chk&#39;).attr(&#39;disabled&#39;,false);
          }
        },1000);
      })
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;checkbox&amp;quot; id=&amp;quot;chk&amp;quot; disabled=&amp;quot;disabled&amp;quot;&amp;gt;&amp;lt;Span id=&amp;quot;span1&amp;quot;&amp;gt;Please read the agreement carefully(5s)&amp;lt;/Span&amp;gt;
  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5:事件冒泡&lt;/p&gt;
&lt;p&gt;取消事件冒泡的方法
arguments[0].stopPropagation 或者
function(e){e.stopPropagation();}&lt;/p&gt;
&lt;p&gt;附加上图片的脱离文档流操作和一次事件&lt;/p&gt;
&lt;p&gt;但是one在jquery-1.8.3.min.js 能够试验通过 ，在2.1.3.js新版本则不行。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;#btn&#39;).click({&#39;name&#39;:&#39;xiaomin&#39;},function(e){
          alert(e.data.name) ;
        });
        $(&#39;#dv&#39;).click(function(){
          alert($(this).attr(&#39;id&#39;));
        });

        $(&#39;#ps&#39;).click(function(){
          alert($(this).attr(&#39;id&#39;));
        });
        $(&#39;#sp1&#39;).click(function(){
          alert($(this).attr(&#39;id&#39;));
          //如果加上这句话，事件就不会冒泡了
          //可不敢露了一个s
          //$(argument[0]).stopPropagation();//取消底层的事件冒泡
          arguments[0].stopPropagation();//取消底层的事件冒泡
          //方法2  function(e){e.stoppropagation();}
        });


        //Test Image
        $(document).mouseover(function(e){
          //1 脱离文档流
          //2 给定坐标
          $(&#39;img&#39;).css(&#39;position&#39;,&#39;absolute&#39;).css({&amp;quot;left&amp;quot;:e.pageX,&amp;quot;top&amp;quot;:e.pageY});
        });

        //一次事件
        $(&#39;#btnOnce&#39;).one(function(){
          alert(&#39;烟花总是灿烂，但是只开一次&#39;);
        });
      });
    &amp;lt;/script&amp;gt;

    &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;getData&amp;quot; id=&amp;quot;btn&amp;quot;/&amp;gt;
    &amp;lt;Div id=&amp;quot;dv&amp;quot; style=&amp;quot;width:300px; height:200px; border:1px solid red;&amp;quot;&amp;gt;
      &amp;lt;P id=&amp;quot;ps&amp;quot; &amp;gt;
        &amp;lt;Span id=&amp;quot;sp1&amp;quot; style=&amp;quot;width:200px; height:100px; border:1px solid yellow&amp;quot;&amp;gt; This is zone of span&amp;lt;/Span&amp;gt;
      &amp;lt;/P&amp;gt;
    &amp;lt;/Div&amp;gt;

    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnOnce&amp;quot; value=&amp;quot;onceEvent&amp;quot;/&amp;gt;
    
    &amp;lt;Img src=&amp;quot;2.png&amp;quot;/&amp;gt;
  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7: replaceAll  and replaceWith&lt;/p&gt;
&lt;p&gt;repalceAll  把左边的标签替换包含右边文本的标签&lt;/p&gt;
&lt;p&gt;replaceWith 把右边的标签替换左边文本的标签&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    $(&#39;#btn&#39;).click({&#39;name&#39;:&#39;xiaomin&#39;},function(e){
      alert(e.data.name) ;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7.1  标签包裹&lt;/p&gt;
&lt;p&gt;1 wrap   每个p标签各自被一个 font包裹
2 wrapAll  所有p标签被一个font 包裹
3 wrapInner 每个P标签内部都有意个font标签&lt;/p&gt;
&lt;p&gt;7.2 百度搜索框&lt;/p&gt;
&lt;p&gt;focus   blur&lt;/p&gt;
&lt;p&gt;以及removeClass的操作&lt;/p&gt;
&lt;p&gt;7.3 RadioButton 的选择 :checked&lt;/p&gt;
&lt;p&gt;通过attr(&amp;lsquo;checked&amp;rsquo;,true);进行设置&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;
    &amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        //with all label
        $(&#39;#btn1&#39;).click(function(){
          $(&#39;br&#39;).replaceWith(&#39;&amp;lt;Hr/&amp;gt;&#39;)
        });

        //replaceAll with not all labels
        $(&#39;#btn2&#39;).click(function(){
          $(&#39;&amp;lt;br/&amp;gt;&#39;).replaceAll(&#39;hr&#39;);
        });

        $(&#39;#btn3&#39;).click(function(){
          //1wrap   每个p标签各自被一个 font包裹
          //2wrapAll  所有p标签被一个font 包裹
          //3wrapInner 每个P标签内部都有意个font标签
          //$(&#39;div p&#39;).wrap(&#39;&amp;lt;Font color=&amp;quot;red&amp;quot; size=&amp;quot;8&amp;quot; &amp;gt;&amp;lt;/Font&amp;gt;&#39;);
          //$(&#39;div p&#39;).wrapAll(&#39;&amp;lt;Font color=&amp;quot;red&amp;quot; size=&amp;quot;8&amp;quot; &amp;gt;&amp;lt;/Font&amp;gt;&#39;);
          $(&#39;div p&#39;).wrapInner(&#39;&amp;lt;Font color=&amp;quot;red&amp;quot; size=&amp;quot;8&amp;quot; &amp;gt;&amp;lt;/Font&amp;gt;&#39;);
        });

        //你可以通过浏览器的探测功能，观察每一个过程html代码结构的
        //变化
        //下面代码适应所有的html文件！！！
        //只有body里面有东西都是可以的
        // 回顾： 聚焦控件联系    其实还包括focus and blur的联系
        /// 另外这些知识点统归为jQuery的时间编程
        /*
        $(&#39;body *&#39;).mouseover(function(){
          $(this).addClass(&#39;cls&#39;);
        }).mouseout(function(){
          $(this).removeClass(&#39;cls&#39;);
        });
        */


        //focus and blur
        //回顾了 事件编程 包括click  mouseover  mouseout hover悬停事件等

        // 百度搜索框的jquery实现
        //var contents=$(this).val();
        $(&#39;#baidu001&#39;).focus(function(){

          if($(this).val() ==&#39;Please input some value&#39;)
          {
            // 作用是如果当前的值为这个，那我就证明需要我输入什么
            //于是我就removeClass 然后开始写上值
            $(this).val(&#39;&#39;).removeClass(&#39;baidu&#39;);
          }
        }).blur(function(){
          if($(this).val().length==0)
          {
            //如果用户没有填写任何东西，就主动给他附上值
            $(this).val(&#39;Please input some value&#39;).addClass(&#39;baidu&#39;);
          }
        });

        $(&#39;#btnRadio&#39;).click(function(){
//          $(&#39;:radio[value=1]&#39;).attr(&#39;checked&#39;,true);
//          $(&#39;input[value=1]&#39;).attr(&#39;checked&#39;,true);
//          $(&#39;input[type=radio][value=1]&#39;).attr(&#39;checked&#39;,true);
            //$(&#39;:radio&#39;).val([&#39;1&#39;,&#39;2&#39;,&#39;6&#39;]);  必须一一对应才会被选中？
            //$(&#39;:radio&#39;).val([&#39;1&#39;,&#39;2&#39;,&#39;3&#39;]);
          $(&#39;:radio&#39;).val([&#39;4&#39;,&#39;2&#39;,&#39;3&#39;]);// 哪个不对应上 则不选择哪个

          //也就是radiobutton是按照alue值来进行区分的


        })

      });
    &amp;lt;/script&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      .cls
      {
        background-color:red;
      }
      .baidu
      {
        background-color:gray;
      }
      div
      {
        width:300px;
        height:200px;
        background-color:green;
      }
    &amp;lt;/style&amp;gt;

  &amp;lt;/Head&amp;gt;
  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btn1&amp;quot; value=&amp;quot;with&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btn2&amp;quot; value=&amp;quot;All&amp;quot;/&amp;gt;

    &amp;lt;P&amp;gt;Good morning 1&amp;lt;/P&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;P&amp;gt;Good morning 2&amp;lt;/P&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;P&amp;gt;Good morning 3&amp;lt;/P&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;P&amp;gt;Good morning 4&amp;lt;/P&amp;gt;
    &amp;lt;Br/&amp;gt;

    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btn3&amp;quot; value=&amp;quot;packet with one font&amp;quot;/&amp;gt;
    &amp;lt;Div id=&amp;quot;dv&amp;quot;&amp;gt;
      &amp;lt;P&amp;gt; Good Afternoon&amp;lt;/P&amp;gt;
      &amp;lt;P&amp;gt; Good Afternoon&amp;lt;/P&amp;gt;
      &amp;lt;P&amp;gt; Good Afternoon&amp;lt;/P&amp;gt;
      &amp;lt;P&amp;gt; Good Afternoon&amp;lt;/P&amp;gt;
      &amp;lt;P&amp;gt; Good Afternoon&amp;lt;/P&amp;gt;
    &amp;lt;/Div&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;baidu001&amp;quot; class=&amp;quot;baidu&amp;quot; value=&amp;quot;Please input some value&amp;quot;&amp;gt;

    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnRadio&amp;quot; value=&amp;quot;selectTheRadio&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;radio&amp;quot; name=&amp;quot;1&amp;quot; value=&amp;quot;1&amp;quot;&amp;gt; Man
    &amp;lt;Input type=&amp;quot;radio&amp;quot; name=&amp;quot;2&amp;quot; value=&amp;quot;2&amp;quot;&amp;gt; Woman
    &amp;lt;Input type=&amp;quot;radio&amp;quot; name=&amp;quot;3&amp;quot; value=&amp;quot;3&amp;quot;&amp;gt; Secret
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;8:checkbox事件bind&lt;/p&gt;
&lt;p&gt;属性选择器&lt;/p&gt;
&lt;p&gt;attr 和prop的区别和联系：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;attr: function( elem, name, value, pass ) { 
var ret, hooks, notxml, 
nType = elem.nodeType; 
// don&#39;t get/set attributes on text, comment and attribute nodes 
if ( !elem || nType === 3 || nType === 8 || nType === 2 ) { 
return; 
} 
if ( pass &amp;amp;&amp;amp; jQuery.isFunction( jQuery.fn[ name ] ) ) { 
return jQuery( elem )[ name ]( value ); 
} 
// Fallback to prop when attributes are not supported 
if ( typeof elem.getAttribute === &amp;quot;undefined&amp;quot; ) { 
return jQuery.prop( elem, name, value ); 
} 
notxml = nType !== 1 || !jQuery.isXMLDoc( elem ); 
// All attributes are lowercase 
// Grab necessary hook if one is defined 
if ( notxml ) { 
name = name.toLowerCase(); 
hooks = jQuery.attrHooks[ name ] || ( rboolean.test( name ) ? boolHook : nodeHook ); 
} 
if ( value !== undefined ) { 
if ( value === null ) { 
jQuery.removeAttr( elem, name ); 
return; 
} else if ( hooks &amp;amp;&amp;amp; &amp;quot;set&amp;quot; in hooks &amp;amp;&amp;amp; notxml &amp;amp;&amp;amp; (ret = hooks.set( elem, value, name )) !== undefined ) { 
return ret; 
} else { 
elem.setAttribute( name, value + &amp;quot;&amp;quot; ); 
return value; 
} 
} else if ( hooks &amp;amp;&amp;amp; &amp;quot;get&amp;quot; in hooks &amp;amp;&amp;amp; notxml &amp;amp;&amp;amp; (ret = hooks.get( elem, name )) !== null ) { 
return ret; 
} else { 
ret = elem.getAttribute( name ); 
// Non-existent attributes return null, we normalize to undefined 
return ret === null ? 
undefined : 
ret; 
} 
}

prop:

```javascript
prop: function( elem, name, value ) { 
var ret, hooks, notxml, 
nType = elem.nodeType; 
// don&#39;t get/set properties on text, comment and attribute nodes 
if ( !elem || nType === 3 || nType === 8 || nType === 2 ) { 
return; 
} 
notxml = nType !== 1 || !jQuery.isXMLDoc( elem ); 
if ( notxml ) { 
// Fix name and attach hooks 
name = jQuery.propFix[ name ] || name; 
hooks = jQuery.propHooks[ name ]; 
} 
if ( value !== undefined ) { 
if ( hooks &amp;amp;&amp;amp; &amp;quot;set&amp;quot; in hooks &amp;amp;&amp;amp; (ret = hooks.set( elem, value, name )) !== undefined ) { 
return ret; 
} else { 
return ( elem[ name ] = value ); 
} 
} else { 
if ( hooks &amp;amp;&amp;amp; &amp;quot;get&amp;quot; in hooks &amp;amp;&amp;amp; (ret = hooks.get( elem, name )) !== null ) { 
return ret; 
} else { 
return elem[ name ]; 
} 
} 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;attr方法里面，最关键的两行代码，elem.setAttribute( name, value + “” )和ret = elem.getAttribute( name )，很明显的看出来，使用的DOM的API setAttribute和getAttribute方法操作的属性元素节点。而prop方法里面，最关键的两行代码，return ( elem[ name ] = value )和return elem[ name ]，你可以理解成这样document.getElementById(el)[name] = value，这是转化成JS对象的一个属性。(Perfect的确这样，有两种方法一种是[] 另外一种是get(0))&lt;/p&gt;
&lt;p&gt;分别做了文本框和checkbox的测试：
1：在遇到要获取或设置checked,selected,readonly和disabled等属性时，用prop方法显然更好
2：需要true or false的时候 最好使用 prop ，因为他返回的是true or false
3：其他情况再考虑attr, checkbox返回的是checked&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head lang=&amp;quot;en&amp;quot;&amp;gt;
    &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;
    &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;

        .cls
        {
            width: 300px;
            height: 200px;
            background-color: red;
        }
    &amp;lt;/style&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

$(function(){

    $(&#39;#btn&#39;).click(function(){

        //$(&#39;div&#39;).empty();//清空层中的元素
        //$(&#39;div&#39;).remove();//层没了,自杀


        $(&#39;div&#39;).remove(&#39;.cls&#39;);//移除应用了cls样式的层;
    });
    var el=$(&#39;#atr1&#39;);
    console.log(&#39;attr :&#39;+el.attr(&#39;style&#39;)); //undefined 
    console.log(&#39;prop() :&#39;+el.prop(&#39;style&#39;)); //CSSStyleDeclaration对象 
    console.log(&#39;prop() :&#39;+document.getElementById(&#39;atr1&#39;).style); //CSSStyleDeclaration对象 
    //attr 定义 只能attr(&#39;&#39;)去掉用  attr是一种jQuery的对象操作
    //prop 定义 只能prop(&#39;&#39;)去掉用  prop是一种JSDom的对象操作
  el.attr(&#39;abc&#39;,&#39;111&#39;);
console.log(&#39;attr el:abc--------&#39;+el.attr(&#39;abc&#39;));
console.log(&#39;prop el:abc--------&#39;+el.prop(&#39;abc&#39;));
     el.prop(&#39;def&#39;,&#39;2222&#39;);
console.log(&#39;attr el:def--------&#39;+el.attr(&#39;def&#39;));
console.log(&#39;prop el:def--------&#39;+el.prop(&#39;def&#39;));

// prop显示的checked之类的是  true or false 而不是attr的undefined or checked
var ek=$(&#39;#chk1&#39;);
console.log(&#39;attr el:checked--------&#39;+el.attr(&#39;checked&#39;));
console.log(&#39;prop el:checked--------&#39;+el.prop(&#39;checked&#39;));
console.log(&#39;attr el:disabled--------&#39;+el.attr(&#39;disabled&#39;));
console.log(&#39;prop() 的方法叫合理些&#39;);
console.log(&#39;prop el:disabled--------&#39;+el.prop(&#39;disabled&#39;));



});
    &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;删除元素&amp;quot; id=&amp;quot;btn&amp;quot;/&amp;gt;
&amp;lt;div class=&amp;quot;cls&amp;quot;&amp;gt;

    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;文本框&amp;quot; id=&amp;quot;atr1&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;ceshi&amp;quot; id=&amp;quot;chk1&amp;quot; checked=&amp;quot;checked&amp;quot;/&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;checkbox的测试案例：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; &amp;lt;/Title&amp;gt;
    &amp;lt;Meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; &amp;gt;
      $(function(){
        $(&#39;#btnAll&#39;).click(function(){
          //可以但是不好用
          //$(&#39;#dv :checkbox&#39;).attr(&#39;checked&#39;,&#39;checked&#39;);
          //$(&#39;#dv :checkbox&#39;).attr(&#39;checked&#39;,true);
          //$(&#39;div :checkbox&#39;).attr(&#39;checked&#39;,true);
          $(&#39;div :checkbox&#39;).prop(&#39;checked&#39;,true);

        });
      $(&#39;#btnNot&#39;).click(function(){
        //1
          //$(&#39;#dv :checkbox&#39;).removeAttr(&#39;checked&#39;);
        //2
          //$(&#39;#dv :checkbox&#39;).attr(&#39;checked&#39;,false);
          //$(&#39;div :checkbox&#39;).attr(&#39;checked&#39;,false);
          $(&#39;div :checkbox&#39;).prop(&#39;checked&#39;,false);
        });
      $(&#39;#btnInverse&#39;).click(function(){
        //$(&#39;#dv :checkbox&#39;).each(function(){
        $(&#39;div :checkbox&#39;).each(function(){
          //错误1
          //$(this).setAttribute(&#39;checked&#39;,!$(this)[&#39;checked&#39;]);
          //不行
          //$(this).setAttribute(&#39;checked&#39;,!$(this).attr(&#39;checked&#39;));
          //思路对了！！但是就是不行！！是不是跟编码有关系
          //$(this).attr(&#39;checked&#39;,!$(this).attr(&#39;checked&#39;));
          $(this).prop(&#39;checked&#39;,!$(this).prop(&#39;checked&#39;));
        });
      });

      });
    &amp;lt;/script&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      /*
      div
      {
        margin:5px;
        background-color:green;
      }
      */
    &amp;lt;/style&amp;gt;
  &amp;lt;/Head&amp;gt;


  &amp;lt;Body&amp;gt;
    &amp;lt;Div id=&amp;quot;btnDv&amp;quot;&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; value=&amp;quot;allSelected&amp;quot; id=&amp;quot;btnAll&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; value=&amp;quot;allNotSelected&amp;quot; id=&amp;quot;btnNot&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; value=&amp;quot;allSelectedInverse&amp;quot; id=&amp;quot;btnInverse&amp;quot;/&amp;gt;
    &amp;lt;/Div&amp;gt;

    &amp;lt;Div id=&amp;quot;dv&amp;quot;&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;1&amp;quot; id=&amp;quot;btnEat&amp;quot;/&amp;gt;eating
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot;  name=&amp;quot;name&amp;quot; value=&amp;quot;2&amp;quot; id=&amp;quot;btnSleep&amp;quot;/&amp;gt;sleeping
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot;  name=&amp;quot;name&amp;quot; value=&amp;quot;3&amp;quot; id=&amp;quot;btnPlay&amp;quot;/&amp;gt;playing
    &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最终通过prop解决了属性问题。attr在2.1.3.js是有问题的&lt;/p&gt;
&lt;p&gt;另外2.1.3.js还存在toggle的点击切换问题，在1.8.3测试中未发现问题，类似先前的one点击事件&lt;/p&gt;
&lt;p&gt;TestBind.html: 用于测试toggle&lt;/p&gt;
&lt;p&gt;但是在2.1.3无法切换，在1.8.3可以&lt;/p&gt;
&lt;p&gt;本想通过下述代码 实现toggle，却发现无法返回到first当中&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;    $(&#39;#btn&#39;).click()
     {
       alert(&#39;first&#39;);
       $(this).unbind().bind(&#39;click&#39;,function(){
         alert(&#39;second&#39;);
         $(this).unbind().bind(&#39;click&#39;,function(){
           alert(&#39;third&#39;);
      
         });
       });
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;9: 文本输入框的测试&lt;/p&gt;
&lt;p&gt;1:如果文本框没有输入文本，那么鼠标离开变成红色&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;input[type=text]&#39;).blur(function(){
          if($(this).val().length==0)
          {
            $(this).css(&#39;backgroundColor&#39;,&#39;red&#39;);
          }else
          {
            $(this).css(&#39;backgroundColor&#39;,&#39;&#39;);
          }
        });
      });
    &amp;lt;/script&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      div
      {
        width:100px;
        float:left;
      }
      input
      {
        width:100px;
        margin:10px;
      }
    &amp;lt;/style&amp;gt;

  &amp;lt;/Head&amp;gt;
  &amp;lt;Body&amp;gt;
      
  &amp;lt;Div id=&amp;quot;dv&amp;quot; &amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot;/&amp;gt;
  &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;10:获取鼠标的点击&lt;/p&gt;
&lt;p&gt;左键：1
中键：2
右键：3
e.which 返回其值&lt;/p&gt;
&lt;p&gt;注意：js中使用 backgroundColor:pink     css中使用background-color:pink;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){

        $(&#39;#countMouse&#39;).click(function(e){
          //获得鼠标敲击的值
          //左键 1
          //中键 2
          //右键 3
          alert(e.which);
        });
    });
    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;

    &amp;lt;!--可不敢再犯这种backgroundColor:pink的错误--&amp;gt;
&amp;lt;Div id=&amp;quot;countMouse&amp;quot; style=&amp;quot;width:300px;height:200px;background-color:pink&amp;quot;&amp;gt;
    &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;11&#34;&gt;
&lt;li&gt;隐藏和显示&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1:  标签显示和隐藏
show
hide
toggle  在2.1.3中不行&lt;/p&gt;
&lt;p&gt;2:slide 幻灯片
slideDown
slideUp
slideToggle&lt;/p&gt;
&lt;p&gt;3: Fade 渐进
FadeIn
FadeOut
FadeToggle&lt;/p&gt;
&lt;p&gt;1000 代表1000ms&lt;br&gt;
一般分为三等 slow  normal   fast  ，默认是normal&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;#btnShow&#39;).click(function(){
         // $(&#39;div&#39;).show(1000);
         //slide 分为三个 
         $(&#39;div&#39;).slideDown(1000);
         //$(&#39;div&#39;).fadeIn(1000);
        });
        $(&#39;#btnHide&#39;).click(function(){
         // $(&#39;div&#39;).hide(1000);
          //在1.8.3.min效果一样

          $(&#39;div&#39;).slideUp(1000);

         //Fade in out toggle 都可以实现
         //$(&#39;div&#39;).fadeOut(1000);
        });
        $(&#39;#btnToggle&#39;).click(function(){
          $(&#39;div&#39;).slideToggle(1000);
          //$(&#39;div&#39;).fadeToggle(1000);
        });

      });
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;
  &amp;lt;Body&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnShow&amp;quot; value=&amp;quot;show&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnHide&amp;quot; value=&amp;quot;hide&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnToggle&amp;quot; value=&amp;quot;toggle&amp;quot;/&amp;gt;
      &amp;lt;Div id=&amp;quot;dv&amp;quot; style=&amp;quot;width:400px;height:400px;background-color:pink&amp;quot;&amp;gt;
      &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;12.NBA东西部篮球队&lt;/p&gt;
&lt;p&gt;a.通过unbind().bind()来绑定已经解绑的标签事件
b.attr 包含很多属性 比如style（主要是一些背景颜色  border   width heigth 等）&lt;/p&gt;
&lt;p&gt;功能是：
a.鼠标经过时候变沉红色 其他的为白色背景
b.鼠标点击后则把该只球队剔除，并放在退赛球队中&lt;/p&gt;
&lt;p&gt;bug:
东部球队在剔除后，分配到outEast中，mouseover的鼠标移动事件无法实现，然而西部却是可以。。。。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;#east li&#39;).mouseover(function(){
          $(this).css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;);
          //alert($(this).style);
        }).click(function()
           {
             //$(this).removeAttr(&#39;style&#39;).unbind().appendTo(&#39;#outerEast&#39;);
             //$(this).attr(&#39;backgroundColor&#39;,&#39;blue&#39;).appendTo(&#39;#outerEast&#39;);
             //$(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).unbind().appendTo(&#39;#outerEast&#39;);
             //$(this).attr(&#39;backgroundColor&#39;,&#39;blue&#39;).unbind().appendTo(&#39;#outerEast&#39;);
             //可不敢犯这个错误，如果不加end()的断链操作，会把所有的siblings()元素
             //提交到下边哐当中！
             //$(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;).end().unbind().appendTo(&#39;#outerEast&#39;);
             //在appendTo的事件发生之后（发展的角度来看）
             //但是发现不行，于是留下一个疑问

             //现在明白了既然unbind就得需要用bind()来解决
             //$(this).unbind().appendTo(&#39;#outerEast&#39;).attr(&#39;onmouseover&#39;,&#39;&#39;).mouseover(function(){
             $(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;).end().unbind().appendTo(&#39;#outerEast&#39;).bind(&#39;mouseover&#39;,function(){
               //错误阿！！！居然把所有的其他都给功能禁用了！
             //$(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;).unbind().end().appendTo(&#39;#outerEast&#39;).bind(&#39;mouseover&#39;,function(){
               $(this).css(&#39;backgroundcolor&#39;,&#39;blue&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;);
             });
           });
        $(&#39;#west li&#39;).mouseover(function(){
          $(this).css(&#39;backgroundColor&#39;,&#39;red&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;);
        }).click(function()
           {
             //可不敢再犯这个错误
             //attr不止一个属性，不仅仅是style
             //而css只是设置界面属性
             //$(this).removeAttr(&#39;style&#39;).unbind().appendTo(&#39;#outeWest&#39;);

             //可行阿！！！试验了一个小时   bind之后再到之后的地方unbind即可
             //$(this).unbind().appendTo(&#39;#outerWest&#39;).bind(&#39;mouseover&#39;,function(){
             //好处是直接显示蓝色
             $(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;).end().unbind().appendTo(&#39;#outerWest&#39;).bind(&#39;mouseover&#39;,function(){
              $(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).siblings().css(&#39;backgroundColor&#39;,&#39;&#39;);
             });
             //$(this).attr(&#39;backgroundColor&#39;,&#39;blue&#39;).unbind().appendTo(&#39;#outerWest&#39;);
             //attr只会保存着第一个backgroundcolor的值！
           });

           //增加一个功能，可以返回到原先的竞争队列中
           // 先清空一下试试
         //$(&#39;#outerEast li&#39;).click(function(){

         /*
         $(&#39;#outerEast li&#39;).attr(&#39;onclick&#39;,&#39;&#39;).click(function(){
           $(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).bind(&#39;click&#39;,function(){
            $(this).css(&#39;backgroundColor&#39;,&#39;red&#39;).appendTo($(&#39;#east&#39;));
           });
         });

         $(&#39;#outerEast li&#39;).attr(&#39;onclick&#39;,&#39;&#39;).click(function(){
           $(this).css(&#39;backgroundColor&#39;,&#39;blue&#39;).bind(&#39;click&#39;,function(){
            $(this).css(&#39;backgroundColor&#39;,&#39;red&#39;).appendTo($(&#39;#east&#39;));
           });
         });
         */

//如果onclick事件原先有值，要先清空，再用click( 
//为什么？
      });
    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;H2&amp;gt;The basketball team&amp;lt;/H2&amp;gt;
    &amp;lt;Ol id=&amp;quot;east&amp;quot;&amp;gt;
      &amp;lt;H3&amp;gt;The East Basketbal Teams&amp;lt;/H3&amp;gt;
      &amp;lt;Li&amp;gt;亚特兰大 老鹰&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;芝加哥 公牛&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;波士顿 凯尔特人&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;夏洛特 黄蜂&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;克利夫兰 骑士&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;布鲁克林 篮网&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;迈阿密 热火&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;底特律 活塞&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;纽约 尼克斯&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;奥兰多 魔术&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;印第安纳 步行者&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;费城 76人&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;华盛顿 奇才&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;密尔沃基 雄鹿&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;多伦多 猛龙&amp;lt;/Li&amp;gt;
    &amp;lt;/Ol&amp;gt;
    &amp;lt;Ol id=&amp;quot;west&amp;quot;&amp;gt;
      &amp;lt;H3&amp;gt;The West Basketbal Teams&amp;lt;/H3&amp;gt;
      &amp;lt;Li&amp;gt;金州 勇士&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;丹佛 掘金&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;达拉斯 小牛&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;洛杉矶 快船&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;明尼苏达 森林狼&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;休斯顿 火箭&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;洛杉矶 湖人&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;奥克兰陈马成 雷霆&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;孟菲斯 灰熊&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;菲尼克斯 太阳&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;波特兰 开拓者&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;新奥尔良 鹈鹕&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;萨克拉门托 国王&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;犹他 爵士&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;圣安东尼奥 马刺&amp;lt;/Li&amp;gt;
    &amp;lt;/Ol&amp;gt;
    &amp;lt;Ul id=&amp;quot;other&amp;quot;&amp;gt;
      &amp;lt;Li&amp;gt;步行者&amp;lt;/Li&amp;gt;
      &amp;lt;Li&amp;gt;山猫&amp;lt;/Li&amp;gt;
    &amp;lt;/Ul&amp;gt;

    &amp;lt;H2&amp;gt;The basketball team which have been out of the game.&amp;lt;/H2&amp;gt;

    &amp;lt;Hr color=&amp;quot;red&amp;quot;/&amp;gt;
    &amp;lt;H3&amp;gt;The team of the west&amp;lt;/H3&amp;gt;
    &amp;lt;Ol id=&amp;quot;outerWest&amp;quot;&amp;gt;

    &amp;lt;/Ol&amp;gt;

    &amp;lt;Hr color=&amp;quot;red&amp;quot;/&amp;gt;
    &amp;lt;H3&amp;gt;The team of the east&amp;lt;/H3&amp;gt;
    &amp;lt;Ol id=&amp;quot;outerEast&amp;quot;&amp;gt;

    &amp;lt;/Ol&amp;gt;

  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;12:逐帧变化Animate&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    //animate的作用其实就是动态的改变效果
    // 比如从某个点 移动某个点
    //     慢慢的拉伸长度  高度  模仿人的动作，并可以通过设置
    //     ms数 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;会飞的鸟：
功能： 1 先让他从(0,0)移动到 （200，50）  1s移动时间
2 再让其从(200,50)   移动到(700,150)  2s移动时间(可以使用+= 注意了)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        //animate的作用其实就是动态的改变效果
        // 比如从某个点 移动某个点
        //     慢慢的拉伸长度  高度  模仿人的动作，并可以通过设置
        //     ms数 
        $(&#39;#btn1&#39;).click(function(){
          //按照 默认的正常速度 延长高度到300px
          $(&#39;#box&#39;).animate({height:&amp;quot;300px&amp;quot;});
        });
        $(&#39;#fly&#39;).click(function(){
          //1000ms 从(0 0)  运行到200 50 的位置 时间1s
          //可不敢犯这个错误
          //$(&#39;#bird&#39;).animate(&#39;{&amp;quot;left&amp;quot;:&amp;quot;200px&amp;quot;,&amp;quot;top&amp;quot;:&amp;quot;500px&amp;quot;}&#39;,1000);
          $(&#39;#bird&#39;).animate({&amp;quot;left&amp;quot;:&amp;quot;200px&amp;quot;,&amp;quot;top&amp;quot;:&amp;quot;50px&amp;quot;},1000);
          // 加一个变小飞退的效果
          $(&#39;#bird&#39;).animate({&amp;quot;left&amp;quot;:&amp;quot;+=500px&amp;quot;,&amp;quot;top&amp;quot;:&amp;quot;+=100px&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;40px&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;30px&amp;quot;},2000);
        })
      })
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;


  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btn1&amp;quot; value=&amp;quot;animate&amp;quot;/&amp;gt;
    &amp;lt;Div id=&amp;quot;box&amp;quot; style=&amp;quot;width:300px;height:200px ;background-color:red&amp;quot;&amp;gt; 
    &amp;lt;/Div&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; value=&amp;quot;let me fly&amp;quot; id=&amp;quot;fly&amp;quot;&amp;gt;
    &amp;lt;Img src=&amp;quot;2.png&amp;quot; style=&amp;quot;position:absolute;&amp;quot; id=&amp;quot;bird&amp;quot;/&amp;gt;
  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;13: Cookie&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    //突然明白  cookie只不过是一堆hashmap  临时存储在浏览器当中哦 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;定义：&lt;/p&gt;
&lt;p&gt;$.cookie(&amp;lsquo;uName&amp;rsquo;, $(&#39;#YourName&#39;).val());&lt;/p&gt;
&lt;p&gt;使用：&lt;/p&gt;
&lt;p&gt;$.cookie(&amp;lsquo;uName&amp;rsquo;)&lt;/p&gt;
&lt;p&gt;作用：&lt;/p&gt;
&lt;p&gt;当刷新页面仍然会保存uName的值！&lt;/p&gt;
&lt;p&gt;需要加载jquery.cookie.js 插件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;!--$.cookie有效必须加载 jquery.cookie.js--&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery.cookie.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
        $(&#39;#btn&#39;).click(function(){
            $.cookie(&#39;uName&#39;, $(&#39;#YourName&#39;).val());
            alert(&#39;I browser have record your name&#39;);
        });
        //突然明白  cookie只不过是一堆hashmap  临时存储在浏览器当中哦 
        if($.cookie(&#39;uName&#39;))
        {
            $(&#39;span&#39;).text(&#39;welcome  Mr/Mrs &#39;+$.cookie(&#39;uName&#39;)+&#39; coming back&#39;);
        }else
        {
          $(&#39;span&#39;).text(&#39;welcome you !Little Bird . &#39;)
        }
      });

    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
      &amp;lt;Input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot; id=&amp;quot;YourName&amp;quot;/&amp;gt;
      &amp;lt;INput type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;record&amp;quot; id=&amp;quot;btn&amp;quot;/&amp;gt;
      &amp;lt;Span&amp;gt;&amp;lt;/Span&amp;gt;
  &amp;lt;/Body&amp;gt;


&amp;lt;/Html&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;14:jqZoom局部放大器&lt;/p&gt;
&lt;p&gt;注意点1：jqZoom在2.1.3测试失败！  但在1.8.3.min.js测试通过&lt;/p&gt;
&lt;p&gt;注意点2: 要 &lt;br&gt;
连接上css否则效果不好：&lt;LINK rel=stylesheet  type=text/css href=&#34;jquery.jqzoom.css&#34; /&gt;&lt;/p&gt;
&lt;p&gt;注意点3： jqzoom()失效写的&lt;/p&gt;
&lt;p&gt;注意点4： 大图片是放在一个&lt;A class=MYCLASS href=&#34;大图片&#34;&gt; &lt;img src=&#34;小图片&#34;/&gt;&lt;/A&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-1.8.3.min.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery.jqzoom-core.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;!-- 可不敢犯这个错误
    &amp;lt;script type=&amp;quot;text/css&amp;quot; src=&amp;quot;jquery.jqzoom.css&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    --&amp;gt;
    &amp;lt;LINK rel=stylesheet  type=text/css href=&amp;quot;jquery.jqzoom.css&amp;quot; /&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      $(function(){
      //$(document).ready(function(){
      //可不敢写错函数 z不可以大写
        //$(&#39;.MYCLASS&#39;).jqZoom();
        $(&#39;.MYCLASS&#39;).jqzoom();
            /*
          {
                zoomType: &#39;standard&#39;,
                lens:true,
                zoomWidth: 300,
                zoomHeight:450,
                xOffset:90,
                yOffset:30,
                preloadImages: true,
                alwaysOn:false
          });
              */
      });
    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;!--可不敢把 &amp;lt;/A&amp;gt;放在 IMg标签外了--&amp;gt;
    &amp;lt;A class=MYCLASS  title=MYTITLE href=&amp;quot;triumph_big1.jpg&amp;quot;&amp;gt;
      &amp;lt;Img title=&amp;quot;IMAGE TITLE&amp;quot; src=&amp;quot;triumph_small1.jpg&amp;quot;&amp;gt;
&amp;lt;/A&amp;gt;
  &amp;lt;/Body&amp;gt;


&amp;lt;/Html&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;15 qq微博案例&lt;/p&gt;
&lt;p&gt;模拟微博140个字的提交案例&lt;/p&gt;
&lt;p&gt;1： html部分
加载weibo.css
加载weibo.js
加载logo
加载textarea文本框
加载附件区
加载按钮
2： css部分
no-repeat 不进行平铺&lt;/p&gt;
&lt;p&gt;3： js部分&lt;/p&gt;
&lt;p&gt;3.1需要着重掌握 拓展的写法
3.2通过脱离文档流  来加在朋友列表和表情列表
3.3 学习广播的 追踪显示部分图片的功能 配合 background   background-position
以及坐标进行设置  当然背景框是有大小限制的 no-repeat不平铺  利用css进
如果超出多少个字  则变红色警告&lt;/p&gt;
&lt;p&gt;3.4 有三个地方 Please write down the topic  为什么？  1: 为了添加Topic 点击事件需要 2：在朋友列表和表情列表
第二个是因为当没有只有#Please write..# 则使用val()进行替换&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    但是当textarea原先有内容时候，如果直接使用val（新内容）则会覆盖原先的旧内容 ，所以需要进行判断
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3.5 selectRange的作用就是选择掉从第一个字符到最后一个字符，但是我的测试结果变成了选择
3.6 朋友列表，表情列表 都是通过建立一个新的层来设置
注意添加完close 标签后，在添加 朋友列表的时候需要在style属性中添加clear:both来清除 float:right的属性
3.7  表情层中 显示的文件夹路径得设置正确
注意 1： userFaces[key]在 表情上面的title
2： 小手功能
//     3： 点击功能  单机事件  鼠标mouseover的事件 会显示文字信息&lt;/p&gt;
&lt;p&gt;weibo.html:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test select and option &amp;lt;/Title&amp;gt;
    &amp;lt;Link rel=stylesheet href=&amp;quot;weibo.css&amp;quot; type=&amp;quot;text/css&amp;quot;&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;jquery-2.1.3.js&amp;quot; &amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;weibo.js&amp;quot;&amp;gt;
    &amp;lt;/script&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;

    &amp;lt;Img id=&amp;quot;logo&amp;quot; src=&amp;quot;weiboPic/b3_100901.png&amp;quot; alt=&amp;quot;log&amp;quot;/&amp;gt;
    &amp;lt;!--让评论居中--&amp;gt;
    &amp;lt;Center&amp;gt;
      &amp;lt;Div id=&amp;quot;Weibo&amp;quot;&amp;gt;
        &amp;lt;Div id=&amp;quot;WL&amp;quot;&amp;gt;
          &amp;lt;Div id=&amp;quot;Talking&amp;quot;&amp;gt;
            &amp;lt;H2&amp;gt;&amp;lt;A&amp;gt;Weibo Title: communication&amp;lt;/A&amp;gt;&amp;lt;/H2&amp;gt;
            &amp;lt;Textarea id=&amp;quot;Msg&amp;quot;&amp;gt;&amp;lt;/Textarea&amp;gt;
            &amp;lt;Div id=&amp;quot;Attach&amp;quot;&amp;gt;
              &amp;lt;A href=&amp;quot;javascript:void();&amp;quot; class=&amp;quot;NewTopic&amp;quot;&amp;gt;Topic&amp;lt;/A&amp;gt;
              &amp;lt;A href=&amp;quot;javascript:void();&amp;quot; class=&amp;quot;Friend&amp;quot;&amp;gt;Friends&amp;lt;/A&amp;gt;
              &amp;lt;A href=&amp;quot;javascript:void();&amp;quot; class=&amp;quot;Face&amp;quot;&amp;gt;Face&amp;lt;/A&amp;gt;
              &amp;lt;A href=&amp;quot;javascript:void();&amp;quot; class=&amp;quot;Pic&amp;quot;&amp;gt;Picture&amp;lt;/A&amp;gt;
              &amp;lt;A href=&amp;quot;javascript:void();&amp;quot; class=&amp;quot;Video&amp;quot;&amp;gt;Video&amp;lt;/A&amp;gt;
            &amp;lt;/Div&amp;gt;
            &amp;lt;Div id=&amp;quot;Send&amp;quot;&amp;gt;
              &amp;lt;Input type=&amp;quot;button&amp;quot; class=&amp;quot;sendBtn&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
              &amp;lt;Span class=&amp;quot;CountTxt&amp;quot;&amp;gt;You can still write&amp;lt;Em&amp;gt;140&amp;lt;/Em&amp;gt;words&amp;lt;/Span&amp;gt;
            &amp;lt;/Div&amp;gt;

        &amp;lt;/Div&amp;gt;
        &amp;lt;!--
        &amp;lt;Div id=&amp;quot;WR&amp;quot;&amp;gt;

        &amp;lt;/Div&amp;gt;
        --&amp;gt;
      &amp;lt;/Div&amp;gt; 
    &amp;lt;/Center&amp;gt;
  &amp;lt;/Body&amp;gt;

&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;weibo.css:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-css&#34;&gt;        body
        {
            margin: 0px;
            background: url(&#39;weiboPic/wrapBg.jpg&#39;) no-repeat #EBF1F1;
        }
        #logo
        {
            margin: 30px 0 0 300px;
        }
        #Weibo
        {
            width: 800px;
            height: 200px;
            border: 1px solid #000;
        }
        /* WL: weiboLeft*/
        #WL
        {
            width: 590px;
            height: 100%;
            background: #fff;
            float: left;
        }
        /* WR: weiboLeft */
        #WR
        {
            background: #CCEBF4;
            width: 210px;
            height: 100%;
            float: right;
        }

        #Talking
        {
            text-align: left;
            margin: 0 0 0 25px;
        }
        /*增加文本框的大小*/
        #Msg
        {
            width: 540px;
            height: 80px;
            overflow: hidden;
            font-family: Tahoma, Arial;
            font-size: 14px;
            border: 1px solid gray;
        }
        #Talking H2
        {
            text-align: left;
            padding: 0px;
            margin: 0px;
            font: normal normal normal 18px/29px &#39;MicroSoft YaHei&#39; , SimHei;
        }
        #Attach
        {
            width: 540px;
        }
        #Attach a
        {
            color: #000;
            text-decoration: none;
            font-size: 14px;
        }
        .NewTopic, .Friend, .Face, .Pic, .Video
        {
            background-position: -170px -33px;
            display: inline-block;
            height: 16px;
            padding-left: 18px;
        }
        .CountTxt
        {
            color: #999;
            float: right;
            line-height: 33px;
            margin: 0 15px 0 0;
        }
        .CountTxt em
        {
            font-family: Georgia, Tahoma, Arial;
            font-size: 26px;
            position: relative;
            top: -5px;
            vertical-align: middle;
        }
        .sendBtn
        {
            float: right;
            margin: 0 20px 0 0;
            padding: 0px;
            background: url(weiboPic/bg1.png) -117px -165px no-repeat;
            line-height: 33px;
            margin-left: 14px;
            height: 30px;
            width: 112px;
            border: 0px;
            cursor: pointer;
        }
        #btnCloFri
        {
            cursor: pointer;
        }
        
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;weibo.js:
//1。扩展jQuery
//需要着重掌握 拓展的写法
//通过脱离文档流  来加在朋友列表和表情列表
//学习广播的 追踪显示部分图片的功能 配合 background   background-position
//   以及坐标进行设置  当然背景框是有大小限制的 no-repeat不平铺  利用css进行
//   切换
//如果超出多少个字  则变红色警告&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;        $.fn.selectRange = function (start, end) 
        {
          //please write down the topic 高亮显示
          //转化为 js对象
            var curObj = $(this).get(0);
            if (!curObj)
              return;
            else if (curObj.setSelectionRange) 
            {
                curObj.focus(); curObj.setSelectionRange(start, end);
            } /* WebKit */
            else if (curObj.createTextRange) 
            {
                var range = curObj.createTextRange();
                range.collapse(true);
                range.moveEnd(&#39;character&#39;, end);
                range.moveStart(&#39;character&#39;, start);
                range.select();
            } /* IE */
            else if (curObj.selectionStart) 
            {
                curObj.selectionStart = start;
                curObj.selectionEnd = end;
            }
        };
        //====上面的代码是扩展的

    $(function()
    {

        //按钮高亮显示
        $(&#39;#Send .sendBtn&#39;).mouseover(function(){
          $(this).css(&#39;backgroundPosition&#39;,&#39;0 -195px&#39;);
        }).mouseout(function(){
            $(this).css(&#39;backgroundPosition&#39;,&#39;-117px -165px&#39;);
//-117px -165px
        });
        //计算文本框还能输入多少个字
        $(&#39;#Msg&#39;).change(function(){
            //还能输入多少个字
           var len= 140- $(this).val().length;
           if(len&amp;gt;=0){
                $(&#39;#Send .CountTxt&#39;).html(&#39;You can still write down&amp;lt;em&amp;gt;&#39;+len+&#39;&amp;lt;/em&amp;gt;words&#39;);
            }else{
              //设置 变成高亮的红色
                $(&#39;#Send .CountTxt&#39;).html(&#39;Already exceed &amp;lt;em&amp;gt;&amp;lt;font color=&amp;quot;red&amp;quot;&amp;gt;&#39;+Math.abs(len)+&#39;&amp;lt;/font&amp;gt;&amp;lt;/em&amp;gt;words&#39;);
            }

        });
        setInterval(function(){
            $(&#39;#Msg&#39;).change();
        },500);


     //显示话题
        ////有三个地方 Please write down the topic  为什么？  1: 为了添加Topic 点击事件需要 2：在朋友列表和表情列表
        //为什么？
        $(&#39;#Attach .NewTopic&#39;).click(function(){

            if($(&#39;#Msg&#39;).val().length==0){
              //selectRange的作用就是去除掉 从第一个字符到最后一个字符
              //已方便我们输入话题
                $(&#39;#Msg&#39;).val(&#39;#Please write down the topic#&#39;).selectRange(1,28);
            }
        });
//显示朋友
        $(&#39;#Attach .Friend&#39;).click(function(){
            var friendsList = [&#39;Foleide&#39;, &#39;Risse&#39;, &#39;LiLei&#39;,&#39;HanMeiMei&#39;,&#39;Tom&#39;,&#39;Turkkey&#39;,&#39;John&#39;];
            if($(&#39;#dvF&#39;).length&amp;gt;0){
                $(&#39;#dvF&#39;).remove();
            }
            //增加了一个 朋友层 用于选择！！
            var dvFriends=$(&#39;&amp;lt;div id=&amp;quot;dvF&amp;quot; style=&amp;quot;width:100px;border:1px solid blue;background-color:white;position: absolute;&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&#39;).appendTo($(&#39;body&#39;));
            //设置完层的脱离文档流 后，设置他的偏移
            var dvX=$(this).offset().left+&#39;px&#39;;//层距离左侧的像素 注意 height() 有圆括号包裹
            var dvY=$(this).offset().top+$(this).height()+&#39;px&#39;;
            //设置他的上和左的坐标
            dvFriends.css({&amp;quot;left&amp;quot;:dvX,&amp;quot;top&amp;quot;:dvY});
            //添加一个关闭按钮
            //float:right 向右浮动
            $(&#39;&amp;lt;span style=&amp;quot;background-color: gray;cursor: pointer; float: right;&amp;quot;&amp;gt;Close&amp;lt;/span&amp;gt;&#39;).click(function(){
                $(this).parent().remove();
            }).appendTo(dvFriends);

            //显示朋友列表
            //clear:both 清除掉 span所具有的float效果！！
            //    规律： 如果同一级的元素有浮动的，就需要用clear:both来清除
            //否则 ulobj会跟close处在同一行当中
            //list-style-type:square
           var ulObj= $(&#39;&amp;lt;Ul style=&amp;quot;clear: both; list-style-type: square; margin: 0;padding: 0;&amp;quot;&amp;gt;&amp;lt;/Ul&amp;gt;&#39;).appendTo(dvFriends);
            for(var i=0;i&amp;lt;friendsList.length;i++){
              //设置移到的鼠标为手型
               $(&#39;&amp;lt;Li style=&amp;quot;margin-bottom: 5px; cursor: pointer;&amp;quot;&amp;gt;@&#39;+friendsList[i]+&#39;&amp;lt;/Li&amp;gt;&#39;).mouseover(function(){
                 //鼠标进入时候的高亮显示
                   $(this).css(&#39;backgroundColor&#39;,&#39;yellow&#39;);

                   //鼠标离开又得恢复过来
               }).mouseout(function(){
                   $(this).css(&#39;backgroundColor&#39;,&#39;&#39;);
               }).click(function(){
                 //不太明白这边的写法 ok
                 //如果用户没有输入任何内容 则替换掉原先的内容
                   if($(&#39;#Msg&#39;).val()==&#39;##&#39;){
                       $(&#39;#Msg&#39;).val($(this).text());
                   }else{
                     //如果用户已经输入了，则必须保证用户的数据不被覆盖
                       $(&#39;#Msg&#39;).val($(&#39;#Msg&#39;).val()+$(this).text());
                   }


               }).appendTo(ulObj);
            }
        });

        //显示表情
        var userFaces = { &#39;0.gif&#39;: &#39;微笑&#39;, &#39;1.gif&#39;: &#39;撇嘴&#39;, &#39;2.gif&#39;: &#39;色&#39;, &#39;3.gif&#39;: &#39;发呆&#39;, &#39;4.gif&#39;: &#39;得意&#39;, &#39;5.gif&#39;: &#39;流泪&#39;, &#39;6.gif&#39;: &#39;害羞&#39;, &#39;7.gif&#39;: &#39;闭嘴&#39;, &#39;8.gif&#39;: &#39;睡&#39;, &#39;9.gif&#39;: &#39;大哭&#39;, &#39;10.gif&#39;: &#39;尴尬&#39;, &#39;11.gif&#39;: &#39;发怒&#39;, &#39;12.gif&#39;: &#39;调皮&#39;, &#39;13.gif&#39;: &#39;呲牙&#39;, &#39;14.gif&#39;: &#39;惊讶&#39;, &#39;15.gif&#39;: &#39;难过&#39;, &#39;16.gif&#39;: &#39;酷&#39;, &#39;17.gif&#39;: &#39;冷汗&#39;, &#39;18.gif&#39;: &#39;抓狂&#39;, &#39;19.gif&#39;: &#39;吐&#39;, &#39;20.gif&#39;: &#39;偷笑&#39;, &#39;21.gif&#39;: &#39;可爱&#39;, &#39;22.gif&#39;: &#39;白眼&#39;, &#39;23.gif&#39;: &#39;傲慢&#39;, &#39;24.gif&#39;: &#39;饥饿&#39;, &#39;25.gif&#39;: &#39;困&#39;, &#39;26.gif&#39;: &#39;惊恐&#39;, &#39;27.gif&#39;: &#39;流汗&#39;, &#39;28.gif&#39;: &#39;憨笑&#39;, &#39;29.gif&#39;: &#39;大兵&#39;, &#39;30.gif&#39;: &#39;奋斗&#39;, &#39;31.gif&#39;: &#39;咒骂&#39;, &#39;32.gif&#39;: &#39;疑问&#39;, &#39;33.gif&#39;: &#39;嘘&#39;, &#39;34.gif&#39;: &#39;晕&#39;, &#39;35.gif&#39;: &#39;折磨&#39;, &#39;36.gif&#39;: &#39;衰&#39;, &#39;37.gif&#39;: &#39;骷髅&#39;, &#39;38.gif&#39;: &#39;敲打&#39;, &#39;39.gif&#39;: &#39;再见&#39;, &#39;40.gif&#39;: &#39;擦汗&#39;, &#39;41.gif&#39;: &#39;抠鼻&#39;, &#39;42.gif&#39;: &#39;鼓掌&#39;, &#39;43.gif&#39;: &#39;糗大了&#39;, &#39;44.gif&#39;: &#39;坏笑&#39;, &#39;45.gif&#39;: &#39;左哼哼&#39;, &#39;46.gif&#39;: &#39;右哼哼&#39;, &#39;47.gif&#39;: &#39;哈欠&#39;, &#39;48.gif&#39;: &#39;鄙视&#39;, &#39;49.gif&#39;: &#39;委屈&#39;, &#39;50.gif&#39;: &#39;快哭了&#39;, &#39;51.gif&#39;: &#39;阴险&#39;, &#39;52.gif&#39;: &#39;亲亲&#39;, &#39;53.gif&#39;: &#39;吓&#39;, &#39;54.gif&#39;: &#39;可怜&#39;, &#39;55.gif&#39;: &#39;菜刀&#39;, &#39;56.gif&#39;: &#39;西瓜&#39;, &#39;57.gif&#39;: &#39;啤酒&#39;, &#39;58.gif&#39;: &#39;篮球 &#39;, &#39;59.gif&#39;: &#39;乒乓&#39;, &#39;60.gif&#39;: &#39;咖啡&#39;, &#39;61.gif&#39;: &#39;饭&#39;, &#39;62.gif&#39;: &#39;猪头&#39;, &#39;63.gif&#39;: &#39;玫瑰&#39;, &#39;64.gif&#39;: &#39;凋谢&#39;, &#39;65.gif&#39;: &#39;示爱&#39;, &#39;66.gif&#39;: &#39;爱心&#39;, &#39;67.gif&#39;: &#39;心碎&#39;, &#39;68.gif&#39;: &#39;蛋糕&#39;, &#39;69.gif&#39;: &#39;闪电&#39;, &#39;70.gif&#39;: &#39;炸弹&#39;, &#39;71.gif&#39;: &#39;刀&#39;, &#39;72.gif&#39;: &#39;足球&#39;, &#39;73.gif&#39;: &#39;瓢虫&#39;, &#39;74.gif&#39;: &#39;便便&#39;, &#39;75.gif&#39;: &#39;月亮&#39;, &#39;76.gif&#39;: &#39;太阳&#39;, &#39;77.gif&#39;: &#39;礼物&#39;, &#39;78.gif&#39;: &#39;拥抱&#39;, &#39;79.gif&#39;: &#39;强&#39;, &#39;80.gif&#39;: &#39;弱&#39;, &#39;81.gif&#39;: &#39;握手&#39;, &#39;82.gif&#39;: &#39;胜利&#39;, &#39;83.gif&#39;: &#39;抱拳&#39;, &#39;84.gif&#39;: &#39;勾引&#39;, &#39;85.gif&#39;: &#39;拳头&#39;, &#39;86.gif&#39;: &#39;差劲&#39;, &#39;87.gif&#39;: &#39;爱你&#39;, &#39;88.gif&#39;: &#39;NO&#39;, &#39;89.gif&#39;: &#39;OK&#39;, &#39;90.gif&#39;: &#39;爱情&#39;, &#39;91.gif&#39;: &#39;飞吻&#39;, &#39;92.gif&#39;: &#39;跳跳&#39;, &#39;93.gif&#39;: &#39;发抖&#39;, &#39;94.gif&#39;: &#39;怄火&#39;, &#39;95.gif&#39;: &#39;转圈&#39;, &#39;96.gif&#39;: &#39;磕头&#39;, &#39;97.gif&#39;: &#39;回头&#39;, &#39;98.gif&#39;: &#39;跳绳&#39;, &#39;99.gif&#39;: &#39;挥手&#39;, &#39;100.gif&#39;: &#39;激动&#39;, &#39;101.gif&#39;: &#39;街舞&#39;, &#39;102.gif&#39;: &#39;献吻&#39;, &#39;103.gif&#39;: &#39;左太极&#39;, &#39;104.gif&#39;: &#39;右太极&#39;, &#39;105.gif&#39;: &#39;淡定&#39;, &#39;106.gif&#39;: &#39;晕&#39;, &#39;107.gif&#39;: &#39;不满&#39;, &#39;108.gif&#39;: &#39;睡觉&#39;, &#39;109.gif&#39;: &#39;小调皮&#39;, &#39;110.gif&#39;: &#39;咒骂&#39;, &#39;111.gif&#39;: &#39;发怒&#39;, &#39;112.gif&#39;: &#39;偷笑&#39;, &#39;113.gif&#39;: &#39;微笑&#39;, &#39;114.gif&#39;: &#39;震惊&#39;, &#39;115.gif&#39;: &#39;囧&#39; };
        $(&#39;#Attach .Face&#39;).click(function(){

            if($(&#39;#dvfaceImg&#39;).length&amp;gt;0){
                $(&#39;#dvfaceImg&#39;).remove();
            }
           var dvFace= $(&#39;&amp;lt;div id=&amp;quot;dvfaceImg&amp;quot; style=&amp;quot;width:370px;border:1px solid blue;background-color: white;position: absolute;&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&#39;).appendTo($(&#39;body&#39;));
           //和朋友列表相同的操作过程！！！
            var dvXX=$(this).offset().left-100+&#39;px&#39;;
            var dvYY=$(this).offset().top+$(this).height()+&#39;px&#39;;
            //最终设置他的坐标
            dvFace.css({&amp;quot;left&amp;quot;:dvXX,&amp;quot;top&amp;quot;:dvYY});
            //显示 表情  关闭
            $(&#39;&amp;lt;Span style=&amp;quot;float: left;&amp;quot;&amp;gt;Expression&amp;lt;/Span&amp;gt;&#39;).appendTo(dvFace);
            $(&#39;&amp;lt;Span style=&amp;quot;float: right;cursor: pointer; background-color: gray;&amp;quot;&amp;gt;close&amp;lt;/Span&amp;gt;&#39;).click(function(){

                $(this).parent().remove();//删除层
            }).appendTo(dvFace);

            //显示表情
           var dvfaceimage= $(&#39;&amp;lt;div style=&amp;quot;clear: both;&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&#39;).appendTo(dvFace);
            for(var key in userFaces){
              //显示的文件夹路径得设置正确
              //注意 1： userFaces[key]在 表情上面的title
              //     2： 小手功能
              //     3： 点击功能  单机事件
                $(&#39;&amp;lt;Img src=&amp;quot;weiboPic/faces/&#39;+key+&#39;&amp;quot; title=&amp;quot;&#39;+userFaces[key]+&#39;&amp;quot; /&amp;gt;&#39;).mouseover(function(){
                    $(this).css(&#39;cursor&#39;,&#39;pointer&#39;);

                }).click(function(){
                  //不清楚 这边为什么这样写  同样的 在friend也是如此
                    //if($(&#39;#Msg&#39;).val()==&#39;#Please write down the topic#&#39;){
                    if($(&#39;#Msg&#39;).val()==&#39;##&#39;){
                        $(&#39;#Msg&#39;).val( &#39;[&#39;+$(this).attr(&#39;title&#39;)+&#39;]&#39;);
                    }else{
                        $(&#39;#Msg&#39;).val($(&#39;#Msg&#39;).val()+&#39;[&#39;+$(this).attr(&#39;title&#39;)+&#39;]&#39;);
                    }


                }).appendTo(dvfaceimage);
            }
        });

    });

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>JSDOM14-19节笔记代码April1th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/jsdom14-19jie-bi-ji-dai-ma-april1th/</link>
      <pubDate>Mon, 11 May 2015 14:58:44 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/jsdom14-19jie-bi-ji-dai-ma-april1th/</guid>
      <description>&lt;p&gt;续先前的JSDOM1-15:http://www.rupeng.com/forum/thread-45297-1-1.html&lt;/p&gt;
&lt;p&gt;21:图片移动，脱离文档流的案例&lt;/p&gt;
&lt;p&gt;脱离文档流： 对象.style.position=&amp;lsquo;absolute&amp;rsquo;;
新建了一个图片控件，并让其在页面中随鼠标移动。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
&amp;lt;Head&amp;gt;
&amp;lt;Title&amp;gt; Let bird fly&amp;lt;/Title&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

onload=function()
{
/*
document.onmousemove=function()
{
var imObj = document.getElementById(&#39;im&#39;);
//脱离文档流

imObj.style.position=&#39;absolute&#39;;
imObj.style.left=window.event.clientX+&#39;px&#39;;
imObj.style.top=window.event.clientY+&#39;px&#39;;
};
*/
document.getElementById(&#39;ak&#39;).onmouseover=function()
{
if(!document.getElementById(&#39;im1&#39;))
{
var imgObj=document.createElement(&#39;img&#39;);
imgObj=&#39;im1&#39;;
imgObj.src=&#39;bird.png&#39;;
//脱离文档流
imgObj.style.position=&#39;absolute&#39;;
imgObj.style.left=this.offsetLeft+&#39;px&#39;;
imgObj.style.top=this.offsetTop+this.offsetHeight+&#39;px&#39;;
}
};
};
&amp;lt;/script&amp;gt;

&amp;lt;/Head&amp;gt;

&amp;lt;Body&amp;gt;
&amp;lt;img id=&amp;quot;im&amp;quot; src=&amp;quot;bird.png&amp;quot;/&amp;gt;

&amp;lt;A id=&amp;quot;ak&amp;quot; href=&amp;quot;http://www.baidu.com&amp;quot;&amp;gt;百度&amp;lt;/A&amp;gt;
&amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;22： 四个案例&lt;/p&gt;
&lt;p&gt;案例1：一个列表框进行动态属性的赋值 并获取点击对象的值
注意：setAttribute and gettAttribute的用法
循环添加所有表格的点击事件
案例2：产生一个登陆界面
注意：innerText和innerHTML的配合使用 ，设置控件的内容
为了增加用户的体验感觉checkbox一般设置对象.style.cursor=pointer
createElement 和appendChild的配合使用
案例3: 小图变大图
注意：JSON数据库的创建
循环的显示小图片
图片的onmouseover and onmouseout事件的响应
层的style.display=none;的意思是不显示该层
案例4:   搜索框
注意：onfocus  and onblur(鼠标焦点离开的事件）
一般会使用设置为gray，文本框为&amp;rsquo;请输入搜索内容&#39;; 使用的时候设置为black，并且文本框为空。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; When click the button ,then generate the div&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      // 学会添加层
      //数据库 包含照片信息  其中左边的key是小照片，右边是大照片信息
       var datasPic = {
        &amp;quot;mv/1-1.jpg&amp;quot;: [&amp;quot;mv/1.jpg&amp;quot;, &amp;quot;小丽&amp;quot;, &amp;quot;163cm&amp;quot;],
        &amp;quot;mv/2-1.jpg&amp;quot;: [&amp;quot;mv/2.jpg&amp;quot;, &amp;quot;小红&amp;quot;, &amp;quot;165cm&amp;quot;],
        &amp;quot;mv/3-1.jpg&amp;quot;: [&amp;quot;mv/3.jpg&amp;quot;, &amp;quot;小花&amp;quot;, &amp;quot;150cm&amp;quot;]
        };


        //案例1：一个列表框进行动态属性的赋值 并获取点击对象的值
      onload=function()
      {
        //点击列表 产生分数来！！
        var tds=document.getElementById(&#39;nameRank&#39;).getElementsByTagName(&#39;td&#39;);
        for(var i=0;i&amp;lt;tds.length;i++)
        {
          tds[i].setAttribute(&#39;score&#39;,(i+1)*20);
          tds[i].onclick=function()
          {
            alert(this.getAttribute(&#39;score&#39;));
          };
        }

        //案例2：产生一个登陆界面
        document.getElementById(&#39;generate&#39;).onclick=function()
        {
          //创建一个层
          var dvObj=document.createElement(&#39;div&#39;);
          dvObj.id=&#39;dv&#39;;
          dvObj.style.width=&#39;300px&#39;;
          dvObj.style.height=&#39;200px&#39;;
          dvObj.style.marginBottom=&#39;200px&#39;;
          dvObj.style.border=&#39;1px solid yellow&#39;;
          document.body.appendChild(dvObj);

          //c创建两个P标签
          var P1= document.createElement(&#39;p&#39;);
          //本想着添加标签来着
          P1.innerText=&#39;用户名:&#39;;
          var name=document.createElement(&#39;input&#39;);
          name.type=&#39;text&#39;;
          P1.appendChild(name);

          //第二个标签
          var P2 = document.createElement(&#39;p&#39;);
          //妙用innerHTML保持对齐！
          P2.innerHTML=&#39;密 码:&#39;;
          var pwd=document.createElement(&#39;input&#39;);
          pwd.type=&#39;password&#39;;
          P2.appendChild(pwd);

          //复选框

          var chk = document.createElement(&#39;input&#39;);
          chk.type = &#39;checkbox&#39;;
          chk.id = &#39;chkPwd&#39;;
          var labelChk = document.createElement(&#39;label&#39;);
          labelChk.innerText = &#39;记住我的登录状态&#39;;
          labelChk.setAttribute(&#39;for&#39;, chk.id); //设置属性
          labelChk.style.cursor = &#39;pointer&#39;;//设置鼠标的样式 编程手的样式
          var pObj3 = document.createElement(&#39;p&#39;);
          pObj3.appendChild(chk);
          pObj3.appendChild(labelChk);

          //登陆和取消按钮
          var btnLogin = document.createElement(&#39;input&#39;);
          btnLogin.type = &#39;submit&#39;;
          btnLogin.value = &#39;登录&#39;;
          btnLogin.marginRight=&#39;10px&#39;
          var btnEsc = document.createElement(&#39;input&#39;);
          btnEsc.type = &#39;button&#39;;
          btnEsc.value = &#39;取消&#39;;
          var pObj4 = document.createElement(&#39;p&#39;);
          pObj4.appendChild(btnLogin);
          pObj4.appendChild(btnEsc);



          //添加控件
          dvObj.appendChild(P1);
          dvObj.appendChild(P2);
          dvObj.appendChild(pObj3);
          dvObj.appendChild(pObj4);

        }


      //案例3: 小图变大图
      //0 先有了json数据库
      //1 也可以先加载小图

      //2
        var dvSObj=document.getElementById(&#39;dvSmall&#39;);
        //先把小图给显示出来
        for(var key in datasPic)
          {
            var imObj=document.createElement(&#39;img&#39;);
            imObj.src=key;
            imObj.setAttribute(&#39;userKey&#39;,key);
            imObj.style.marginRight=&#39;10px&#39;;//目的是添加右间距/
            dvSObj.appendChild(imObj);
            //添加小图的鼠标的到来事件
            imObj.onmouseover=function()
            {
              var arrs=datasPic[this.getAttribute(&#39;userKey&#39;)];
              document.getElementById(&#39;dvBig&#39;).style.display=&#39;block&#39;;
              document.getElementById(&#39;imBig&#39;).src=arrs[0];
              document.getElementById(&#39;spName&#39;).innerText=arrs[1];
              document.getElementById(&#39;spHeight&#39;).innerText=arrs[2];
            };
            //添加小图的鼠标的 离开事件
            imObj.onmouseout=function()
            {
              document.getElementById(&#39;dvBig&#39;).style.display=&#39;none&#39;;
            };
          }

          //案例4:   搜索框
          //获得焦点的事件
          document.getElementById(&#39;searchValue&#39;).onfocus=function()
          {
            if(this.style.color==&#39;gray&#39;&amp;amp;&amp;amp; this.value==&#39;请输入搜索词&#39;)
              {
                this.style.color=&#39;black&#39;;
                this.value=&#39;&#39;;
                
              }
          }
          //失去焦点的事件
          document.getElementById(&#39;searchValue&#39;).onblur=function()
          {
            if(this.value==&#39;&#39;)
              {
                this.style.color=&#39;gray&#39;;
                this.value=&#39;请搜索搜索关键词&#39;;
              }
          }

      };

    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Table border=&amp;quot;1&amp;quot; id=&amp;quot;nameRank&amp;quot;&amp;gt;
      &amp;lt;Tr&amp;gt;
        &amp;lt;Td&amp;gt;第一名&amp;lt;/Td&amp;gt;
        &amp;lt;Td&amp;gt;第二名&amp;lt;/Td&amp;gt;
        &amp;lt;Td&amp;gt;第三名&amp;lt;/Td&amp;gt;
        &amp;lt;Td&amp;gt;第四名&amp;lt;/Td&amp;gt;
        &amp;lt;Td&amp;gt;第五名&amp;lt;/Td&amp;gt;
      &amp;lt;/Tr&amp;gt;
      &amp;lt;/Table&amp;gt;

      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;generate&amp;quot; value=&amp;quot;登陆栏&amp;quot;/&amp;gt;

      &amp;lt;Div id=&amp;quot;dvSmall&amp;quot;&amp;gt;

      &amp;lt;/Div&amp;gt;

      &amp;lt;!--display:none 表示不显示 也就是刚开始不会显示div层--&amp;gt;
      &amp;lt;Div id=&amp;quot;dvBig&amp;quot; style=&amp;quot;background-Color:orange; border:1px solid yellow; width:200px;display:none;&amp;quot;&amp;gt;
          大头像:&amp;lt;br/&amp;gt;
          &amp;lt;Img id=&amp;quot;imBig&amp;quot; src=&amp;quot;#&amp;quot; alt=&amp;quot;如果没有图片 You will see me&amp;quot;/&amp;gt;
          姓名:&amp;lt;Span id=&amp;quot;spName&amp;quot;&amp;gt;&amp;lt;/Span&amp;gt;&amp;lt;br/&amp;gt;
          升高:&amp;lt;Span id=&amp;quot;spHeight&amp;quot;&amp;gt;&amp;lt;/Span&amp;gt;&amp;lt;br/&amp;gt;

      &amp;lt;/Div&amp;gt;

      &amp;lt;Div id=&amp;quot;search&amp;quot;&amp;gt;
        &amp;lt;Input type=&#39;text&#39; value=&amp;quot;请输入搜索词&amp;quot; id=&amp;quot;searchValue&amp;quot; style=&amp;quot;color:gray&amp;quot;/&amp;gt;
        &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;23 表格的提交的两种触发方式&lt;/p&gt;
&lt;p&gt;submit按钮的click()
form的submit()
区别：
调用submit按钮的点击事件click();
这种情况下 如果onsubmit被赋值了，比如
//处理click的提交事件  type=subomit的click()事件会触发 onsubmit监听器
if(document.getElementById(&amp;lsquo;searchValue&amp;rsquo;).value==&amp;lsquo;Please input the search value&amp;rsquo;)
{
document.getElementById(&amp;lsquo;fm&amp;rsquo;).onsubmit=function()
{
return false;
};
复制代码&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        那么submit按钮 失去作用，即使再输入内容 也没用！！
        document.getElementById(&#39;sm&#39;).click(); 也就是click()的调用需要经过onsubmit的匿名函数过程。
        submit()不会触发 onsubmit的匿名函数，即使文本框没有内容也直接提交。
        直接达到高层的表单form，进行提交，
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Test onclick() and onsubmit() &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        document.getElementById(&#39;searchValue&#39;).onfocus=function()
        {
           if(this.style.color==&#39;gray&#39;&amp;amp;&amp;amp;this.value==&#39;Please input the search value&#39;) 
             {
               this.value=&#39;&#39;;
               this.style.color=&#39;black&#39;;
             }
        }
        document.getElementById(&#39;searchValue&#39;).onblur=function()
        {
            if(this.value==&#39;&#39;)
              {
                this.value=&#39;Please input the search value&#39;;
                this.style.color=&#39;gray&#39;;
              }
        }

        //处理click的提交事件  type=subomit的click()事件会触发 onsubmit监听器
        if(document.getElementById(&#39;searchValue&#39;).value==&#39;Please input the search value&#39;)
          {
            document.getElementById(&#39;fm&#39;).onsubmit=function()
            {
              return false;
            };
          }
          document.getElementById(&#39;dv&#39;).onclick=function()
          {
            //点击层的 时候调用submit的点击事件
            //这种情况下 即使再输入内容 也没用！！
        //    document.getElementById(&#39;sm&#39;).click();
            //submit不会触发 onsubmit的匿名函数
            //直接达到高层的表单form，进行提交，
            document.getElementById(&#39;fm&#39;).submit();
          }
          document.getElementById(&#39;sm&#39;).onclick=function()
          {
            //this.click();
            document.getElementById(&#39;sm&#39;).click();
          }

      }
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;
    
  &amp;lt;Body&amp;gt;
    &amp;lt;Form action=&amp;quot;http://www.baidu.com&amp;quot; method=&amp;quot;get&amp;quot; id=&amp;quot;fm&amp;quot;&amp;gt;
      &amp;lt;Input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;Please input the search value&amp;quot; id=&amp;quot;searchValue&amp;quot; style=&amp;quot;width:300px;height:20px;color:gray;
      border:1px solid red&amp;quot;/&amp;gt; 
      &amp;lt;Input type=&amp;quot;submit&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;baidu&amp;quot; id=&amp;quot;sm&amp;quot;/&amp;gt;
      &amp;lt;Div id=&amp;quot;dv&amp;quot; style=&amp;quot;width:300px;height:200px;background-color:green;&amp;quot;&amp;gt;
        &amp;lt;/Div&amp;gt;
      &amp;lt;/Form&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;24：正则表达式&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   如果有了// 单句注释符，那么new RegExp(&#39;&#39;)就可以不用了
   注意1： test函数类似于java的match函数
               exec函数类似于java的matches函数。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;三个功能： 1：找到六位数字
2：确认文本框的内容是否为邮箱，若是为红色
3：替换操作，支持链式替换 *.replace().replace&amp;hellip;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Test Regex Expression &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      var testString=&#39;12345&#39;;

      //1 网页字节数较多 不推荐
      var reg= new RegExp(&#39;\\d{5}&#39;);
      alert(reg.test(testString)); 
      //2 网页字节数较少 推荐  增加体验性

      var reg=/\d{5}/; //  //类似.Net的 @（）可以直接使用正则表达式 而不需要考虑具体的语言
      alert(reg.test(testString));

      
    &amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

      //获得所有匹配的内容
      var msg=&#39;昌平:102206,平和:363708,中国电信:10000&#39;;
      var reg=/\d{6}/g;
      var result;
      while(result=reg.exec(msg))
        {
          alert(result);
        }
    &amp;lt;/script&amp;gt;



    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        document.getElementById(&#39;email&#39;).onblur=function()
        {
          // di第一个错误  A-Z 写成了a-z
          // 第二个错误  var reg =  写成了 var=reg=
          var reg=/^[\d\w_.-]+@[\d\w]+([.][a-zA-Z]+){1,2}$/;
          //var reg=/^[0-9a-zA-Z_.-]+@[0-9a-zA-Z]+([.][a-zA-Z]+){1,2}$/;
          if(reg.test(this.value))
            {
              this.style.backgroundColor=&#39;red&#39;;
              alert(&#39;邮箱&#39;);
            }
        }
      }
    &amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      
      var msg = &#39;   去掉左右空格    &#39;;
      //注意// 不需要用 单引号括起来
      msg = msg.replace(/^\s+/,&#39;&#39;).replace(/\s+$/,&#39;&#39;);
      alert(&#39;===&#39;+msg+&#39;===&#39;);
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
      &amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;email&amp;quot; name=&amp;quot;&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;25:测试键盘的keyCode&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  注意如果不放在onload中调用控件没有效果，为undefined
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test Tab Shift &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      //window.event.keyCode=

      //如果不放在onload中是没有效果
      onload=function()
      {
        var texts=document.getElementsByName(&#39;name&#39;);
        for(var i=0;i&amp;lt;texts.length;i++)
        {
          texts[i].onkeydown=function()
          {
            //alert(window.event.keyCode);
            //让enete键具备 tab的工呢过
            if(window.event.keyCode==13)
              {
                //IE可以实现
                window.event.keyCode=9;
                //google如何实现
              }
          };
        }
      };
      
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;26:测试密码的强弱&lt;/p&gt;
&lt;p&gt;密码强弱等级协定：
1：初始的密码等级为0
2：当只出现数字或者只出现字母或者只出现特殊字符则密码等级加1
3： 如果数字、字母、特殊字符 三者有两种出现 则再加上1&lt;br&gt;
4： 如果都出现  在原先基础上再加1
5： 如果位数小于6 － 1  所有最少应该是0&lt;/p&gt;
&lt;p&gt;第一：获取文本框的内容&lt;/p&gt;
&lt;p&gt;第二：进行函数的级别验证
第三：设置表格的背景颜色&lt;/p&gt;
&lt;p&gt;注意1   if(msg.match(/[^\d\w]/)) //既不是数字也不是字母
注意2  在进行 新的级别的设置时候需要循环把表格背景颜色设置为white&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;for(var i=0;i&amp;lt;tds.length;i++)
             {
               tds[i].style.backgroundColor=&#39;white&#39;;
             }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体实验如下:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Test the strong week and medium of the password &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

      /*
         1：初始的密码等级为0
         2：当只出现数字或者只出现字母或者只出现特殊字符则密码等级加1
         3： 如果数字、字母、特殊字符 三者有两种出现 则再加上1   
         4： 如果都出现  在原先基础上再加1 
         5： 如果位数小于6 － 1  所有最少应该是0
      */

     function getPasswordLevel(msg)
     {
       var level=0;
       if(msg.match(/\d/))
         {
           level++; //如果匹配数字则加上1
         }
        if(msg.match(/\w/))
          {
            level++; //如果也找到字母
          }
        if(msg.match(/[^\d\w]/)) //既不是数字也不是字母
           {
            level++;
           }
        if(msg.length&amp;lt;=6)
          {
            level--;
          }
          return level;
     }

     onload=function()
     {
       document.getElementById(&#39;password&#39;).onkeyup=function()
       {
         var tds=document.getElementById(&#39;tr1&#39;).getElementsByTagName(&#39;td&#39;);
         if(this.value.length&amp;gt;0) //value的值的长度
           {
             for(var i=0;i&amp;lt;tds.length;i++)
             {
               tds[i].style.backgroundColor=&#39;white&#39;;
             }
              var r =getPasswordLevel(this.value); 
              if(r &amp;lt;=1)
                {
                  tds[0].style.backgroundColor=&#39;red&#39;;
                }
              else if(r ==2)
                {
                  tds[0].style.backgroundColor=&#39;yellow&#39;;
                  tds[1].style.backgroundColor=&#39;yellow&#39;;
                }
              else if(r ==3)
                {
                  tds[0].style.backgroundColor=&#39;blue&#39;;
                  tds[1].style.backgroundColor=&#39;blue&#39;;
                  tds[2].style.backgroundColor=&#39;blue&#39;;
                }

           }
       }
     }
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;
  &amp;lt;Body&amp;gt;

    &amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;password&amp;quot; value=&amp;quot;&amp;quot; name=&amp;quot;&amp;quot;&amp;gt;
    &amp;lt;Table id=&amp;quot;tb&amp;quot;&amp;gt;
      &amp;lt;Tr id=&amp;quot;tr1&amp;quot;&amp;gt;
        &amp;lt;Td&amp;gt;弱&amp;lt;/Td&amp;gt;
        &amp;lt;Td&amp;gt;中&amp;lt;/Td&amp;gt;
        &amp;lt;Td&amp;gt;强&amp;lt;/Td&amp;gt;
      &amp;lt;/Tr&amp;gt;
      &amp;lt;/Table&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;27:百度搜索&lt;/p&gt;
&lt;p&gt;功能1： 输入一个字可以出现智能提示板（暂时是指调用JSON的数据  而不是数据库的内容）
功能2：可以获取智能提示板的内容，并鼠标扫过的时候出现红色 离开为白色  点击则把该对象内容附到搜索框中&lt;/p&gt;
&lt;p&gt;注意点: 能力校验（暂时不太清楚 userAgent)&lt;/p&gt;
&lt;p&gt;具体实现如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test Search by Baidu &amp;lt;/Title&amp;gt;
  &amp;lt;/Head&amp;gt;
  &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
    #main
    {
      width:250px;
      height:200px;
      margin-left:200px;
      margin-top:300px;
      background-color:green;
    }
  &amp;lt;/style&amp;gt;

  &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    onload=function()
    {
      var keyWords = {
          &amp;quot;小明&amp;quot;: [&amp;quot;小明是谁&amp;quot;, &amp;quot;小明很机智&amp;quot;, &amp;quot;小明滚出去&amp;quot;],
          &amp;quot;地主&amp;quot;: [&amp;quot;斗地主&amp;quot;, &amp;quot;地主还有没有&amp;quot;, &amp;quot;地主就是土豪&amp;quot;],
          &amp;quot;挖&amp;quot;: [&amp;quot;挖掘机&amp;quot;, &amp;quot;挖掘机技术那加强&amp;quot;, &amp;quot;挖土豆&amp;quot;],
          &amp;quot;我&amp;quot;: [&amp;quot;我爱北京&amp;quot;, &amp;quot;我爱北京天安门&amp;quot;, &amp;quot;我是苍&amp;quot;],
          &amp;quot;苍&amp;quot;:[&amp;quot;苍天大地&amp;quot;,&amp;quot;苍老师是大家的&amp;quot;,&amp;quot;苍天有井独自空&amp;quot;],
          &amp;quot;平&amp;quot;:[&amp;quot;平凡的世界&amp;quot;,&amp;quot;平白无故&amp;quot;,&amp;quot;平常&amp;quot;]
      };

      function funShow()
      {
        //如果在数据库中存在的话  则创建一个层
        if(keyWords[this.value])
          {
            //create the div
            if(document.getElementById(&#39;dv&#39;))
              {
                //不是 直接&#39;dv&#39;
                document.body.removeChild(document.getElementById(&#39;dv&#39;));
              }
            //开始创建
              var divObj=document.createElement(&#39;div&#39;);
              divObj.id=&#39;dv&#39;;
              divObj.width=&#39;300px&#39;;
              //不要少了  脱离文档流，才可以重新设置坐标
              divObj.style.position=&#39;absolute&#39;;
              divObj.style.border=&#39;1px solid purple&#39;;
              divObj.style.left=this.offsetLeft+&#39;px&#39;;
              //divObj.style.left=tihs.offsetLeft+&#39;px&#39;;
              divObj.style.top=this.offsetHeight+this.offsetTop+&#39;px&#39;;
              document.body.appendChild(divObj);

              for(var i=0; i&amp;lt; keyWords[this.value].length;i++)
              {
                var pObj=document.createElement(&#39;p&#39;);
                pObj.innerHTML=keyWords[this.value][i];
                pObj.style.margin=&#39;5px&#39;;
                divObj.appendChild(pObj);
                pObj.onmouseover=function()
                {
                  this.style.backgroundColor=&#39;red&#39;;
                  this.style.cursor=&#39;pointer&#39;;
                }
                pObj.onmouseout=function()
                {
                  this.style.backgroundColor=&#39;&#39;;
                };
                //增加了点击的事件
                pObj.onclick=function()
                {
                  //alert(this.value);
                  document.getElementById(&#39;searchValue&#39;).value=this.innerText;
                }
              }
          }
        }
            //firefox下检测状态改变只能用oninput,且需要用addEventListener来注册事件。
            if (/msie/i.test(navigator.userAgent))    //ie浏览器
            {
                document.getElementById(&#39;searchValue&#39;).onpropertychange = funShow;
            }
            else {//非ie浏览器，比如Firefox
                document.getElementById(&#39;searchValue&#39;).addEventListener(&amp;quot;input&amp;quot;, funShow, false);
            }


    }
  &amp;lt;/script&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Div id=&amp;quot;main&amp;quot; &amp;gt;
      &amp;lt;Input type=&amp;quot;text&amp;quot; name=&amp;quot;&amp;quot; id=&amp;quot;searchValue&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;&amp;quot; id=&amp;quot;tijiao&amp;quot; value=&amp;quot;Baidu It&amp;quot;/&amp;gt;
    &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;28：JS常用习惯&lt;/p&gt;
&lt;p&gt;多用js内部的函数
少用全局变量
利用数据结构来定义对象
尽可能使用switch代替else-if语句
减少字节数，增加用户体验&lt;/p&gt;
&lt;p&gt;29：FireFox(FF)和IE的一些不同点&lt;/p&gt;
&lt;p&gt;IE:innerText    FF:textContent
IE:srcElement(事件源）   FF：target
IE:attachEvent   FF:addEventListener   来绑定事件
&lt;a href=&#34;http://www.360doc.com/content/09/0319/12/16915_2855107.shtml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.360doc.com/content/09/0319/12/16915_2855107.shtml&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;JQuery是一个好东西，主要目的是为了统一不同浏览器使用DOM的不同点，屏蔽了不友好的功能！ 这也是下阶段的学习目标。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>JSDOM7-13节笔记代码March31th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/jsdom7-13jie-bi-ji-dai-ma-march31th/</link>
      <pubDate>Mon, 11 May 2015 14:58:44 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/jsdom7-13jie-bi-ji-dai-ma-march31th/</guid>
      <description>&lt;p&gt;连接到前文JavaScript 7-11节笔记代码&lt;/p&gt;
&lt;p&gt;8: 注册和调用的不同：
注册
Onclick=function(){}; //匿名函数的注册行为
Onclick=ff;
调用
Onclick=ff();&lt;/p&gt;
&lt;p&gt;9:计时器
setInterval反复性计时器（随着一定时间之后 再跳出来）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;Var setId=setInterval(function()
{
Alert(‘你名函数’);
}，1000);
clearInterval(setId);
setTimeout一次性计时器：
Var setID= setTimeOut(function()
{
Alert(‘这是一次性计时器’);
},1000);
clearTimeOut(setId);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;计时器小案例1：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;onload=function()
{
        var i = 10;
        setIntervar(function()
            {
               i--;
               var btnObj=document.getElementById(&#39;btn&#39;);//获得btn对象
               btnObj.value=i;//设置该对象的value值即可！
            },1000);

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;经这么一写：&lt;/p&gt;
&lt;p&gt;规律：所有的标签都可以有id-value对 或者name-value对象 或者class-value对
完全可以通过document对象获得所有的标签元素的id，name,class进行对应标签内容的设置&lt;/p&gt;
&lt;p&gt;计时器小案例2：
//跑马灯效果&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;setIntervale(function()
    {
        var tt=document.title;
        document.title = tt.substring(1)+tt.substr(0,1); //1-尾部  + 0-1的字符
},1000 );
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;10 页面加载事件（3个）
前面接触最多的就是onload ,另外还有onunload,onbeforeload
Onload:页面加载后触发
Onunload 页面退出后触发
Onbeforeunload: 页面关闭之前触发（发表帖子 和   你确定退出？）&lt;/p&gt;
&lt;p&gt;11 刷新后，返回的页面
回顾window.location.href(‘www.baidu.com’); 类似于window.navigaete(‘’)&lt;/p&gt;
&lt;p&gt;12 Document.write的两个作用
动态的创建控件(但是只能在页面加载时候动态创建  ) 但是有一个缺点：在IE中会删掉之前的控件标签，在源代码浏览时候，发现原先的标签都没有了
镶嵌广告&lt;/p&gt;
&lt;p&gt;1.打开 news.baidu.com/newscode&lt;br&gt;
输入关键字获得新闻的代码
2.复制代码
代码包含两个部分：
样式部分：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-css&#34;&gt;&amp;lt;style type=text/css&amp;gt; div{font-size:12px;font-family:arial}.baidu{font-size:14px;line-height:24px;font-family:arial} a,a:link{color:#0000cc;}
.baidu span{color:#6f6f6f;font-size:12px} a.more{color:#008000;}a.blk{color:#000;font-weight:bold;}&amp;lt;/style&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Js脚本部分：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;script language=&amp;quot;JavaScript&amp;quot; type=&amp;quot;text/JavaScript&amp;quot; src=&amp;quot;http://news.baidu.com/ns?word=title%3A%E9%A3%8E%E5%8A%9B%E5%8F%91%E7%94%B5&amp;amp;tn=newsfcu&amp;amp;from=news&amp;amp;cl=2&amp;amp;rn=5&amp;amp;ct=0&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;说明src其实就是document.write的实现！！但是为什么？原理暂时不知道&lt;/p&gt;
&lt;p&gt;查询src里面内容的方式：
1：notepad
2：open-?黏贴进 src的地址
3： 就可以在记事本看到src所代表的新闻内容，他其实就是document.write()的内容！为了保证百度更新新闻的时候他也能更新新闻，所以采用这种document.write()来实现&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        //第一个功能动态加载控件标签  但是在IE中会使其他的控件消失
        //d当然这边加载 会把原先的页面的控件给隐藏掉！！
//        document.write(&#39;&amp;lt;Font color=&amp;quot;red&amp;quot; size=&amp;quot;6&amp;quot;&amp;gt;Today is &amp;lt;/font&amp;gt;&#39;);
//       document.write(&#39;&amp;lt;Input type=&amp;quot;button&amp;quot; value=&amp;quot;click me&amp;quot;\&amp;gt;&#39;);

      }
      &amp;lt;/script&amp;gt;
&amp;lt;style type=text/css&amp;gt; div{font-size:12px;font-family:arial}.baidu{font-size:14px;line-height:24px;font-family:arial} a,a:link{color:#0000cc;}
.baidu span{color:#6f6f6f;font-size:12px} a.more{color:#008000;}a.blk{color:#000;font-weight:bold;}&amp;lt;/style&amp;gt;

  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;

&amp;lt;script language=&amp;quot;JavaScript&amp;quot; type=&amp;quot;text/JavaScript&amp;quot; src=&amp;quot;http://news.baidu.com/ns?word=title%3A%E9%A3%8E%E5%8A%9B%E5%8F%91%E7%94%B5&amp;amp;tn=newsfcu&amp;amp;from=news&amp;amp;cl=2&amp;amp;rn=5&amp;amp;ct=0&amp;quot;&amp;gt;
&amp;lt;/script&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;13 获得页面元素的三种方法
Document.getElementById(‘btn’)&amp;mdash;-&amp;gt;最常用的方式
Document.getElementByName(‘fds’) &amp;mdash;-&amp;gt;name=”fds”
Document.getElementByTagName(‘Input’)&amp;mdash;-&amp;gt;标签名&lt;/p&gt;
&lt;p&gt;14获取坐标点
顶级对象window包含一个比较重要的对象event可以由此获得当前对象、页面、屏幕&lt;/p&gt;
&lt;p&gt;1：当前对象作为参考点 &amp;ndash;&amp;gt;offsetX|Y
2：当前页面作为参考点 &amp;mdash;&amp;gt;clientX|Y
3：：当前屏幕作为参考点&amp;ndash;&amp;gt;screenX|Y&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;hellow&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
//      alert(document.getElementById(&#39;btn&#39;).titleLabel.text)
     // alert(window.event.button);
      alert(screen.width+&#39;,&#39;+screen.height);
      onload=function()
      {
        document.getElementById(&#39;ak&#39;).onclick=function()
        {
          alert(new Date().toLocaleTimeString());
          window.event.returnValue=false;//IE Opera  google支持  火狐不支持
        }
        document.getElementById(&#39;dv&#39;).onmousemove=function()
        {
          //鲁棒性最好的参数
          if(arguments.length!=0)
            {
              //火狐 google  IE不行
              document.getElementById(&#39;ipClient&#39;).value=arguments[0].clientX+&#39;,&#39;+arguments[0].clientY;
            }else
            {

              document.getElementById(&#39;ipClient&#39;).value=event.clientX+&#39;,&#39;+event.clientY;
            }
          //也可以另外一种鲁棒性的优化
          //能力检测方式！ 
          if(window.event)//判断如果存在则是IE不存在则是火狐  window.event是IE下的重要的属性
            {

              document.getElementById(&#39;ipClient2&#39;).value=event.clientX+&#39;,&#39;+event.clientY;
            }else
            {
              document.getElementById(&#39;ipClient2&#39;).value=arguments[0].clientX+&#39;,&#39;+arguments[0].clientY;
            }
          //火弧+google可以通过  IE不行
          

          //下面代码google和IE支持
          //相对于页面的左上角
            document.title=event.clientX+&#39;,&#39;+event.clientY;
          //相对于屏幕的左上角
            document.getElementById(&#39;btn&#39;).value=event.screenX+&#39;,&#39;+event.screenY;            
            document.getElementById(&#39;ip1&#39;).value=event.screenX+&#39;,&#39;+event.screenY;            
          //相对于当前对象的左上角（this)对象

            document.getElementById(&#39;ip&#39;).value=event.offsetX+&#39;,&#39;+event.offsetY;            
        }
  
      }
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;
  

  &amp;lt;Body&amp;gt;
      &amp;lt;Div id=&amp;quot;dv&amp;quot; color=&amp;quot;red&amp;quot;&amp;gt;
      &amp;lt;button type=&amp;quot;button&amp;quot; id=&amp;quot;btn&amp;quot; class=&amp;quot;button&amp;quot;&amp;gt;
          屏幕值
      &amp;lt;/button&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;ipClient&amp;quot; value=&amp;quot;页面左上角偏移&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;ipClient2&amp;quot; value=&amp;quot;页面左上角偏移&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;ip&amp;quot; value=&amp;quot;对象的左上角偏移&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;ip1&amp;quot; value=&amp;quot;屏幕的偏移坐标&amp;quot;/&amp;gt;
        hello
      &amp;lt;/Div&amp;gt;
      &amp;lt;Div&amp;gt;
        &amp;lt;A id=&amp;quot;ak&amp;quot; href=&amp;quot;www.baidu.com&amp;quot;&amp;gt;百度&amp;lt;/A&amp;gt;
        &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;15：剪切板clipboard&lt;/p&gt;
&lt;p&gt;当在网页复制的时候或者ctrl+C的时候，会激活body的oncopy函数。
当在网页黏贴的时候或者ctrl+V的时候，会激活body的onpaste函数。
由此可以模拟页面的进制复制和黏贴的案例，具体如代码所示：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test copy  clipdata&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&#39;text/javascript&#39;&amp;gt;
      // 一复制则激活oncopy函数
/*
      onload=function()
      {
        document.body.oncopy=function()
        {
          alert(&#39;不让复制&#39;);
          return false;
        };
        document.getElementById(&#39;txt&#39;).onpaste=function()
        {
          alert(&#39;不能黏贴&#39;);
          return false
        };

      };
*/
      onload=function()
      {
        document.body.oncopy=function()
        {
          setTimeout(function()
                      {
                        //IE支持！！  opera 火狐不支持
//出现此错误是因为 window.clipboardData 为 IE 专有，其他浏览器均没有此对象。
                        if(window.clipboardData)
                          {
                            var dataFromClip=clipboardData.getData(&#39;text&#39;)+&#39;你这个拷贝党&#39;;
                              alert(dataFromClip);
                              clipboardData.setData(&#39;text&#39;,  dataFromClip);
                          }else
                            {
                              alert(&#39;Opera不知道如何做了  Opera        无操作剪贴板的对象。&#39;);
                             // window.location=dataFromClip;
                              alert(&#39;&amp;lt;Strong&amp;gt;复制&amp;lt;/Strong&amp;gt;成功！&#39;)
                              return false;
                            }

                      },10);
       };

       };
      document.onclick=function()
      {

        document.write(&#39;hello&#39;);
      }


    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;txt&amp;quot; value=&amp;quot;&amp;quot; /&amp;gt;
    good weather!
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;16：this和事件源srcElement
this只记录当前对象的id
alert(window.event.srcElement.id) 只记录最初加载完body第一次点击的id；&lt;/p&gt;
&lt;p&gt;而srcElement其实是可以和事件冒泡的规律相结合的。
事件冒泡是指内层事件的触发，会由内至外的触发外层事件。
为了只是显示最内层的事件，可以用srcElement.id,比如：&lt;/p&gt;
&lt;p&gt;注意点：
如果text/javscript 则 不会去检查 fucntion的错误！如果写成text/javascript
则客户端浏览器会去检查 js的语法。
一般规律：
一定要注意 style里面用的是 background-color  而 在js中用的是  backgroundColor 两者是不同的写法
并且这个是一个基本的规律！ js中去除了破折号  然后大写后一个单词首字母。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;事件冒泡程序&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      // 如果text/javscript 则 不会去检查 fucntion的错误！如果写成text/javascript
      //则客户端浏览器会去检查 js的语法！
      onload=function()
      {
         document.getElementById(&#39;div1&#39;).onclick=function()
        {
        //  alert(this.id);
        alert(window.event.srcElement.id);
        };
        document.getElementById(&#39;p1&#39;).onclick=function()
        {
          alert(this.id);
        };
        document.getElementById(&#39;str1&#39;).onclick=function()
        {
          alert(this.id);
          //opera IE可以！
          window.event.cancelBubble=true;
          // 火狐e.stopPropagation();
        };
      };
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;!--一定要注意 style里面用的是 background-color  而 在js中用的是  backgroundColor 两者是不同的写法
    并且这个是一个基本的规律！ js中去除了破折号  然后大写后一个单词首字母--&amp;gt;
    &amp;lt;Div id=&amp;quot;div1&amp;quot; style=&amp;quot;width:300px;height:200px;background-color:red;cursor:pointer;&amp;quot;&amp;gt;
      &amp;lt;!--&amp;lt;Div id=&amp;quot;div1&amp;quot; style=&amp;quot;width:300px;height:200px;backgroundColor=red;cursor:pointer;&amp;quot;&amp;gt; 一定要注意不要写成=号形式 style里面写成json形式--&amp;gt;
        
        &amp;lt;!--&amp;lt;P id= &amp;quot;p1&amp;quot; style=&amp;quot;width:100px;height:100px;background-color:blue;cursor:pointer;&amp;quot;&amp;gt;这是第二层文字 --&amp;gt;
          &amp;lt;P id= &amp;quot;p1&amp;quot; style=&amp;quot;width:100px;height:100px;background-color:blue;cursor:pointer;&amp;quot;&amp;gt;
        &amp;lt;Strong id=&amp;quot;str1&amp;quot;&amp;gt;这是第三层文字&amp;lt;/Strong&amp;gt; 
      &amp;lt;/P&amp;gt;
    &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;17：innerText和innerhtml&lt;/p&gt;
&lt;p&gt;注意1：innerhtml 不要写成innerHtml 否则是undefined
注意2：  var btnObjAgree=document.getElementsByName(&amp;lsquo;agree&amp;rsquo;);
var timeControl=document.getElementById(&amp;lsquo;time&amp;rsquo;);
正因为Id没有s 所以他必然是唯一的， 而name TagName都是可以重复 所以他的Element是复数的
案例1：四个按钮 分别显示 设置innerText 设置innerhtml  获取innerText 获取innerhtml
注意：
//1   在添加文本时候 Text模式是直接添加无效果  而html是有效果
//2   在获取文本时候  Text模式是直接获得文本   而html是包含着标签信息
另外//在firefox不行!!firefox and  Ie is a pair of enemy
//In Firefox , You should use the statement below
// dvObj.contentText=&#39;&#39;&lt;/p&gt;
&lt;p&gt;具体如下所示：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;

  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;Test  InnerText And InnerHtml IN fireFox and IE ! &amp;lt;/Title&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      div
      {
        width:300px;
        height:200px;
        background-color:green;
        // 在style中使用 json形式的数据结构
        // 在js中使用  =形式的数据结构
      }
      &amp;lt;/style&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        var dvObj=document.getElementById(&#39;dv&#39;);
        document.getElementById(&#39;btn1&#39;).onclick=function()
        {
          //显示原始的内容  不带上效果
          //Ie  google可以
          dvObj.innerText=&#39;&amp;lt;A href=&amp;quot;http://www.163.com&amp;quot;&amp;gt;网易&amp;lt;/A&amp;gt;&#39;;
          //在firefox不行!!firefox and  Ie is a pair of enemy
          //In Firefox , You should use the statement below
          // dvObj.contentText=&#39;&#39;
        }

        //1   在添加文本时候 Text模式是直接添加无效果  而html是有效果 
        //2   在获取文本时候  Text模式是直接获得文本   而html是包含着标签信息
        document.getElementById(&#39;btn2&#39;).onclick=function()
        {
          //直接添加上效果
          //document.getElementById(&#39;dv&#39;).innerHtml=&#39;&amp;lt;A href=&amp;quot;www.163.com&amp;quot;&amp;gt;网易&amp;lt;/A&amp;gt;&#39;;
          //注意大小写 否则不能显示出 结果
          document.getElementById(&#39;dv&#39;).innerhtml=&#39;&amp;lt;A href=&amp;quot;http://www.163.com&amp;quot;&amp;gt;网易&amp;lt;/A&amp;gt;&#39;;
        }
        document.getElementById(&#39;btn3&#39;).onclick=function()
        {
          alert(dvObj.innerText);
        }
        document.getElementById(&#39;btn4&#39;).onclick=function()
        {
          alert(dvObj.innerhtml);
          //alert(dvObj.innerHtml);
        }


      };
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;input type=&amp;quot;button&amp;quot; value=&amp;quot;innerText insert&amp;quot; id=&amp;quot;btn1&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;button&amp;quot; value=&amp;quot;innerHtml insert&amp;quot; id=&amp;quot;btn2&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;button&amp;quot; value=&amp;quot;innerText get&amp;quot; id=&amp;quot;btn3&amp;quot;/&amp;gt;
    &amp;lt;input type=&amp;quot;button&amp;quot; value=&amp;quot;innerHtml get&amp;quot; id=&amp;quot;btn4&amp;quot;/&amp;gt;
    &amp;lt;Div id=&amp;quot;dv&amp;quot;&amp;gt;
    &amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例2：   innerText和计时器联合的一个小程序
功能需求： 起先按钮是灰色，显示“请仔细阅读协议(5)”  并随时间递减，
当回归到0时，则按钮变成可选状态，并其值设置为“同意”。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;          实现如下：
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Three small practices&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

        onload=function()
        {
          var btnObjs=document.getElementsByName(&amp;quot;name&amp;quot;);
          for(var i =0; i&amp;lt; btnObjs.length;i++)
          {
            //你再点击之前得把所有的其他颜色都给他恢复成默认
            //这点很重要 ！！ 否则你会发现之前点过的按钮依然是红色的！没有
            //恢复回默认的状态
            btnObjs.onclick=function()
            //对这个网页的逻辑不是特别清楚！ 应该是点击之后才触发的事件
            //而不是你想着我让他点的时候  他就触发！！必须有一个介质！
            //这个介质说大点叫做计算机，说小点叫做onclick
            {
             for(var j=0; j&amp;lt; btnObjs.length;j++)
              {
                btnObjs[j].style.backgroundColor=&#39;&#39;;
              }

                this.style.backgroundColor=&#39;red&#39;;
            }

          }

          var sec=5;
          //不要少了一个s   间接说明 name可以有多个
          //var btnObjAgree=document.getElementsByName(&#39;agree&#39;);
          // 返回的是一个name数组！！！一定得注意 单写上btnobjagree.value不起作用
          var btnObjAgree=document.getElementsByName(&#39;agree&#39;);

          //不要多了一个s   间接说明Id只能有一个
          //var btnObjAgree=document.getElementById(&#39;btn&#39;);
          var setId= setInterval(function()
                     {
                        if(sec&amp;gt; 0)
                          {
                            sec--;
                            btnObjAgree[0].value=&#39;请仔细阅读下列协议(&#39;+sec+&#39;)&#39;;

                          }else
                          {
                            btnObjAgree[0].value=&#39;同意&#39;;
                            btnObjAgree[0].disabled=false;
                            clearInterval(setId);
                          }

                      },1000);

                      setInterval(function(){
                            var timeControl=document.getElementById(&#39;time&#39;);
                            //timeControl.innerText=new Date().toLocalTimeString();//别写错了Locale而不是Local
                            timeControl.innerText=new Date().toLocaleTimeString();

                      },1000);
          };
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;小明&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btn&amp;quot; name=&amp;quot;agree&amp;quot; value=&amp;quot;请仔细阅读下列协议(5)&amp;quot; disabled=&amp;quot;disabled&amp;quot;/&amp;gt;

    &amp;lt;P id=&amp;quot;time&amp;quot;&amp;gt;&amp;lt;/P&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例3：通过一个JSON数据结构，解析到一个表格中，其中表格分为两列，第一列是网址名字(innerText)，第二列是网址的连接（innerhtml）&lt;/p&gt;
&lt;p&gt;注意 ：
1:再进行能力测试的时候，typeof不能写成typeOf
2:  //如果不加入下面一行代码则无法显示！！！甚至调试不出来
document.body.appendChild(tableObj);
3: JSON数据结构使用逗号进行分隔，不同于在&lt;style type=&#34;text/css&#34;&gt; 中使用分号进行分隔；&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Create JSon database and insert them into the table with innerText and Innerhtml&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;


      onload=function()
      {
        document.getElementById(&#39;create&#39;).onclick=function()
        {
        /*
        var dic={&amp;quot;如鹏&amp;quot;:&amp;quot;http://www.rupeng.com&amp;quot;; 
                &amp;quot;百度&amp;quot;:&amp;quot;http://www.baidu.com&amp;quot;;
                &amp;quot;网易&amp;quot;:&amp;quot;http://www.163.com&amp;quot;;
                &amp;quot;搜狗&amp;quot;:&amp;quot;http://www.sougou.com&amp;quot;;
                &amp;quot;新浪&amp;quot;:&amp;quot;http://www.sina.com.cn&amp;quot;;
                &amp;quot;github&amp;quot;:&amp;quot;http://www.github.com&amp;quot;;
        };
        */

       //用逗号隔开  而不是分号
      var dic={&amp;quot;如鹏&amp;quot;:&amp;quot;http://www.rupeng.com&amp;quot;, 
                &amp;quot;百度&amp;quot;:&amp;quot;http://www.baidu.com&amp;quot;,
                &amp;quot;网易&amp;quot;:&amp;quot;http://www.163.com&amp;quot;,
                &amp;quot;搜狗&amp;quot;:&amp;quot;http://www.sougou.com&amp;quot;,
                &amp;quot;新浪&amp;quot;:&amp;quot;http://www.sina.com.cn&amp;quot;,
                &amp;quot;github&amp;quot;:&amp;quot;http://www.github.com&amp;quot;
        };

        var tableObj = document.createElement(&#39;table&#39;);
        tableObj.border=&#39;1 &#39;;
        //tableObj.border=&#39;1 dashed red&#39;;
        for(var key in dic)
          {
            //create line or record
            var trObj=document.createElement(&#39;tr&#39;);
            ///create column
            var tdObj1=document.createElement(&#39;td&#39;);

            // for the safety between firefox and Ie,so talent test
            //if(typeOf(tdObj1.innerText)==&#39;string&#39;)    typeOf应改为typeof
            if(typeof(tdObj1.innerText)==&#39;string&#39;)
            {
              tdObj1.innerText=key;
            }else
            {
              td1.textContent=key;
            }
            var tdObj2=document.createElement(&#39;td&#39;);
            tdObj2.innerhtml=&#39;&amp;lt;A href=+&#39;+dic[key]+&#39;&amp;gt;&#39;+key+&#39;&amp;lt;/A&amp;gt;&#39;;

            //add tdObj1 and tdObj2 to the line or record
            trObj.appendChild(tdObj1);
            trObj.appendChild(tdObj2);
            //add the trObj to the table
            tableObj.appendChild(trObj);


          }
          //如果不加入下面一行代码则无法显示！！！甚至调试不出来
          document.body.appendChild(tableObj);
        }     
      }
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; value=&amp;quot;create list&amp;quot; id=&amp;quot;create&amp;quot;/&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;18：createElement 动态创建标签（无刷新评论的案例，即直接添加评论内容到页面的表格中）
在之前我们知道只在页面加载的时候可以用document.write()来动态加载控件，那么如何在页面使用的过程中动态加载呢？
具体方法是利用 createElement(&amp;ldquo;标签名&amp;rdquo;) ，最终 会返回一个标签的对象。&lt;/p&gt;
&lt;p&gt;案例1：  创建一个层  并在层中添加按钮   插入按钮  和删除所有按钮
注意1： 给层中加一个id的作用是为了可以供document对象进行调用
注意2：firstChild and lastChild是层的属性  区分于   removeChild()  appendChild()  insertBefore()等方法&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;
&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;  Create Element dynamic &amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        document.getElementById(&#39;btn&#39;).onclick=function()
        {
          var divObj=document.createElement(&#39;div&#39;);

          divObj.style.width=&#39;400px&#39;;
          divObj.id=&#39;dv&#39;; //用于解决在层中添加标签的方式
          divObj.style.height=&#39;200px&#39;;
          divObj.style.backgroundColor=&#39;red&#39;;
          divObj.style.border=&#39;1px solid yellow&#39;;

          document.body.appendChild(divObj);
          
        }
        var count=0;
        document.getElementById(&#39;btnadd&#39;).onclick=function()
        {
          var inputObj=document.createElement(&#39;input&#39;);
          inputObj.type=&#39;button&#39;;
          inputObj.value=&#39;xiaoMing&#39;+count;
          count++;
          // divObj.appendChild(inputObj);//不起作用
          //解决办法  给divObj加一个Id
          document.getElementById(&#39;dv&#39;).appendChild(inputObj);

        }

        document.getElementById(&#39;btnInsert&#39;).onclick=function()
        {
          var inputInObj=document.createElement(&#39;input&#39;);
         inputInObj.type=&#39;button&#39;;
         inputInObj.value=&#39;xiaoming&#39;+count;
         count++;
         var objDivD= document.getElementById(&#39;dv&#39;);
         objDivD.insertBefore(inputInObj,objDivD.firstChild); //必须先找到层中的第一个元素！ 然后插入新的元速
          
        }

        document.getElementById(&#39;btnDelete&#39;).onclick=function()
        {
         var objDivD= document.getElementById(&#39;dv&#39;);
         //firstChild 是层的第一个元素的属性
         //lastChild 是层的最后一个元素的属性

         while(objDivD.firstChild)
           {
             objDivD.removeChild(objDivD.firstChild);
           }
         
        }
      }
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btn&amp;quot; value=&amp;quot;创建&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnadd&amp;quot; value=&amp;quot;层中创建&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnInsert&amp;quot; value=&amp;quot;层中插入&amp;quot;/&amp;gt;
      &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;btnDelete&amp;quot; value=&amp;quot;删除层中所有元素&amp;quot;/&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例2： 提供一个评论的界面，包含昵称：
以及评论内容框和一个input的提交框
最终把结果展示到页面的下面表格控件中&lt;/p&gt;
&lt;p&gt;注意：
1: 在提交之后 ，进行name 和评论区域是否为空的判断
若评论内容为空，则把屏幕焦点移到评论区域，不进行提交
若名称区域为空，则把屏幕焦点移到名称区域，不进行提交&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   2：若没有问题，提交之后得清空name和评论区域的内容
   3：进行能力测试
        火狐和IE是两个不友好的朋友。
        typeof(tdObj1.innerText)==&#39;string&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Test comment submited without refresh 1&amp;lt;/Title&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      #submitArea
      {
        width:300px;
        height:300px;
        background-color:blue;
      }
      #showArea
      {
        //这边使用分号进行隔开！！ 在js中定义json数据格式 一般用逗号隔开！！
        width:400px;
        height:500;
        background-color:green;
      }
      textarea
      {
        width:200px;
        height:200px;

      }
      table
      {
        border:1px dashed yellow;
        background-color:red;
      }
      td
      {
        border:1px solid black;
      }
    &amp;lt;/style&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        document.getElementById(&#39;tijiao&#39;).onclick=function()
        {
        //获取昵称
          var names=document.getElementById(&#39;nicheng&#39;).value;
        //获取评论内容
          var content=document.getElementById(&#39;pinglun&#39;).value;
        //保存信息到一个table中
          var tableObj=document.getElementById(&#39;tb1&#39;);

          //创建一行记录
          var trObj=document.createElement(&#39;tr&#39;);
          //创建一列
          var tdObj1=document.createElement(&#39;td&#39;);
          var tdObj2=document.createElement(&#39;td&#39;);

          //设置值
/*
          tdObj1.value=names;
          tdObj2.value=content;
*/
          //忘记了使用innerText and innerhtml
          
          if(typeof(tdObj1.innerText)==&#39;string&#39;)
          {
            tdObj1.innerText=names;
          }else
          {
            tdObj1.textContent=names;
          }
          if(typeof(tdObj2.innerText)==&#39;string&#39;)
          {
            tdObj2.innerText=content;
          }else
          {
            tdObj2.textContent=content;
          }
                  //添加列到记录中
          trObj.appendChild(tdObj1);
          trObj.appendChild(tdObj2);

          tableObj.appendChild(trObj);

          names.value=&amp;quot;&amp;quot;;
          content.value=&amp;quot;&amp;quot;;

          document.getElementById(&#39;nicheng&#39;).value=&amp;quot;&amp;quot;;
          document.getElementById(&#39;nicheng&#39;).focus();
          document.getElementById(&#39;pinglun&#39;).value=&amp;quot;&amp;quot;;
                    

        }
      }
         
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Div id=&amp;quot;submitArea&amp;quot;&amp;gt;
      &amp;lt;Label&amp;gt;昵称:&amp;lt;/Label&amp;gt;&amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;nicheng&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
      &amp;lt;Textarea id=&amp;quot;pinglun&amp;quot; rows=&amp;quot;15&amp;quot; cols=&amp;quot;10&amp;quot;&amp;gt; &amp;lt;/Textarea&amp;gt;
      &amp;lt;br/&amp;gt;
      &amp;lt;input type=&amp;quot;submit&amp;quot; id=&amp;quot;tijiao&amp;quot; value=&amp;quot;提交&amp;quot;/&amp;gt;
    &amp;lt;/Div&amp;gt;

    &amp;lt;Div id=&amp;quot;showArea&amp;quot;&amp;gt;
      &amp;lt;Table id=&amp;quot;tb1&amp;quot;&amp;gt;
        
      &amp;lt;/Table&amp;gt;
    &amp;lt;/Div&amp;gt;

  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例延展
案例3： 上面并没有进行名称区域和评论区域为空的判断
另外的，也可以使用table.insertRow(-1)  并利用返回来的行对象创建列insertCell(-1)来创建
一个好处是不需要像createElement，在结尾需要进行appendChild添加节点的错做。
注意点：列的值设置需要用innerText或者innerhtml进行设置（style部分保持一样）&lt;/p&gt;
&lt;p&gt;具体如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; Test comment submited without refresh 2&amp;lt;/Title&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
      #submitArea
      {
        width:300px;
        height:300px;
        background-color:blue;
      }
      #showArea
      {
        //这边使用分号进行隔开！！ 在js中定义json数据格式 一般用逗号隔开！！
        width:400px;
        height:500;
        background-color:green;
      }
      textarea
      {
        width:200px;
        height:200px;

      }
      table
      {
        border:1px dashed yellow;
        background-color:red;
      }
      td
      {
        border:1px solid black;
      }
    &amp;lt;/style&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        document.getElementById(&#39;tijiao&#39;).onclick=function()
        {
        //获取昵称
          var names=document.getElementById(&#39;nicheng&#39;).value;
        //获取评论内容


        //增加一个输入参数值的有效性 判断！
             if(names==&amp;quot;&amp;quot;)
              {
               // alert(names+typeof(names));
                alert(&#39;请输入昵称内容&#39;);
                document.getElementById(&#39;nicheng&#39;).focus();
                return ;
              }else
              {
                var content=document.getElementById(&#39;pinglun&#39;).value;

                //alert(content+typeof(content));
                  if(content==&amp;quot;&amp;quot;)
                  {
                    alert(&#39;请输入评论内容&#39;);
                    document.getElementById(&#39;pinglun&#39;).focus();
                    return false;
                  }


              }


        //保存信息到一个table中
          var tableObj=document.getElementById(&#39;tb1&#39;);

          //不需要CreateElement之后还需要 appendChild的操作
          //创建一行记录
          var trObj=tableObj.insertRow(-1);
          //创建一列
          var tdObj1=trObj.insertCell(-1);
          var tdObj2=trObj.insertCell(-1);

          //设置值
/*
          tdObj1.value=names;
          tdObj2.value=content;
*/
          //忘记了使用innerText and innerhtml
          
          if(typeof(tdObj1.innerText)==&#39;string&#39;)
          {
             tdObj1.innerText=names;
          }else
          {
             tdObj1.textContent=names;
          }
          if(typeof(tdObj2.innerText)==&#39;string&#39;)
          {
            tdObj2.innerText=content;
          }else
          {
            
            tdObj2.textContent=content;
          }
                  //添加列到记录中
          //names.value=&amp;quot;&amp;quot;;
          //content.value=&amp;quot;&amp;quot;;

          document.getElementById(&#39;nicheng&#39;).value=&amp;quot;&amp;quot;;
          document.getElementById(&#39;nicheng&#39;).focus();
          document.getElementById(&#39;pinglun&#39;).value=&amp;quot;&amp;quot;;
                    

        }
      }
         
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Div id=&amp;quot;submitArea&amp;quot;&amp;gt;
      &amp;lt;Label&amp;gt;昵称:&amp;lt;/Label&amp;gt;&amp;lt;Input type=&amp;quot;text&amp;quot; id=&amp;quot;nicheng&amp;quot; value=&amp;quot;&amp;quot;/&amp;gt;
      &amp;lt;Textarea id=&amp;quot;pinglun&amp;quot; rows=&amp;quot;15&amp;quot; cols=&amp;quot;10&amp;quot;&amp;gt; &amp;lt;/Textarea&amp;gt;
      &amp;lt;br/&amp;gt;
      &amp;lt;input type=&amp;quot;submit&amp;quot; id=&amp;quot;tijiao&amp;quot; value=&amp;quot;提交&amp;quot;/&amp;gt;
    &amp;lt;/Div&amp;gt;

    &amp;lt;Div id=&amp;quot;showArea&amp;quot;&amp;gt;
      &amp;lt;Table id=&amp;quot;tb1&amp;quot;&amp;gt;
        
      &amp;lt;/Table&amp;gt;
    &amp;lt;/Div&amp;gt;

  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;19：一个综合的小案例：
功能： 1点击按钮，则奇数行为红色，偶数行蓝色
2鼠标移动时候，对应的对象变红色，其他的默认颜色：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt; change the table&#39;s even and odd line&#39;s color&amp;lt;/Title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      onload=function()
      {
        //获得点击的按钮
        document.getElementById(&#39;changeColor&#39;).onclick=function()
        {
          //如何获得表格的长度？？？
          var tds=document.getElementById(&#39;tb1&#39;).getElementsByTagName(&#39;td&#39;);
          for(var i=0;i&amp;lt;tds.length;i++)
          {
            //当为奇数的时候  其实也可以用css解决方式
            if(i%2==0)
              {
                tds.style.backgroundColor=&#39;red&#39;;
              }else
              {
                tds.style.backgroundColor=&#39;blue&#39;;
              }
          }
        };

        //进行鼠标移动变色的事件
          var tds1=document.getElementById(&#39;tb1&#39;).getElementsByTagName(&#39;td&#39;);
          for(var j=0;j&amp;lt;tds1.length;j++)
          {
            tds1[j].onmousemove=function()
            {
              for(var k=0; k&amp;lt;tds1.length;k++)
              {
                  tds1[k].style.backgroundColor=&#39;&#39;;  
              }  
              this.style.backgroundColor=&#39;red&#39;;
            }
          }
      };
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; id=&amp;quot;changeColor&amp;quot; value=&amp;quot;change color of the table&amp;quot;/&amp;gt;

    &amp;lt;Table id=&amp;quot;tb1&amp;quot;&amp;gt;
      &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;第一行&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;第二行&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;第三行&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;第四行&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;第五行&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
      &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;第六行&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
    &amp;lt;/Table&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;小结： 学会了添加事件，认识了事件冒泡过程，理解了document.write的两个作用（document.writeln暂时不管 实际上只有&lt;br&gt;才是真正的网页换行）
并对innerText和innerHtml进行区分，结合createElement可以动态的创建标签，弥补了document.write的不足之处（只在网页加载的时候创建），
再次利用JSon数据结构来动态显示数据，我们会发现所有的html代码中犹如一颗颗树，可以利用三种调用标签的方式来调用所有的元素，可是我们
总是需要写那么长的代码，可以简化？有。&lt;/p&gt;
&lt;p&gt;20：最后通过一个较典型的案例来结尾：
功能1: 把JSON数据结构进行table侠士
功能2：设置复选框的全选
功能3：设置title的走马灯效果&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Title&amp;gt;
        Tree! Tree ! Everywhere fills with trees.
    &amp;lt;/Title&amp;gt;


    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      var de = document.documentElement;
      alert(de.tagName);

      var head=document.getElementsByTagName(&amp;quot;Head&amp;quot;);
      var body=document.getElementsByTagName(&amp;quot;Body&amp;quot;);

      alert(head);
     // alert(head.firstChild.nodeName);
      alert(body);

      var imgObj=document.getElementsByTagName(&amp;quot;img&amp;quot;);
      var imgObj1=document.getElementsByTagName(&amp;quot;34&amp;quot;);
      alert(imgObj.alt);
      alert(imgObj1.alt);

      //用于把JSON的数据结构 生成一个列表
      function createTable()
      {
        var div=document.getElementById(&amp;quot;news&amp;quot;);
        var table=document.createElement(&amp;quot;table&amp;quot;);
        table.border=1;
        //创建一个JSON数据结构，用于存储网络地址d
        var newsBlog={&amp;quot;如鹏网站&amp;quot;:&amp;quot;http://www.rupeng.com&amp;quot;,
          &amp;quot;网易博客&amp;quot;:&amp;quot;http://www.163.com&amp;quot;,
          &amp;quot;sina网站&amp;quot;:&amp;quot;http://www.sina.com&amp;quot;};//可以进行无限的添加
        for(var name in newsBlog)
          {
            //创建行列结构
            var tr = document.createElement(&amp;quot;tr&amp;quot;); //创建一个tr对象
            var td1 = document.createElement(&amp;quot;td&amp;quot;); //创建一个第一列td1
            var td2 = document.createElement(&amp;quot;td&amp;quot;); //创建一个第一列td1

            //设置行列属性
            td1.innerText=name;
            td2.innerhtml=&amp;quot;&amp;lt;a href=&amp;quot;+newsBlog[name]+&amp;quot;&amp;gt;&amp;quot;+newsBlog[name]+&amp;quot;&amp;lt;/A&amp;gt;&amp;quot;;

            //添加节点
            tr.appendChild(td1);
            tr.appendChild(td2);
            //添加行到表中
            table.appendChild(tr);

          }
          //div层添加table节点
          div.appendChild(table);
          table.style.listStyle=&amp;quot;none&amp;quot;;
          table.style.color=&amp;quot;blue&amp;quot;;
      }

      //设置全选
      function setCheckedAll()
      {
        //获取所有name=&amp;quot;setall&amp;quot;的标签   注意多一个s
        var allBtns= document.getElementsByName(&amp;quot;setall&amp;quot;);
        //var allBtns= document.getElementByName(&amp;quot;setall&amp;quot;);
        //获取id=”all&amp;quot;的标签节点
        var setOpenBtn = document.getElementById(&amp;quot;all&amp;quot;);
        for(var i = 0; i &amp;lt; allBtns.length; i++)
        {
          allBtns.checked = setOpenBtn.checked;
          allBtns.onclick = function()
          {
            var b = true;
            //为什么要进行一个循环
            //因为  再进行单选时候 得清楚所有之前的checkbox的状态！
            for(var i = 0 ; i&amp;lt; allBtns.length; i++)
            {
              if(!allBtns.checked)
                {
                  b = false;
                  break;
                }
                setOpenBtn.checked = b;
            }
          }
        }

      }

      //设置标签title的走马灯效果
      function scroll()
      {
        var title=document.title;
        var first=title.charAt(0);
        var last =title.substring(1,title.length);
        document.title=last+first;
      }
      setInterval(&amp;quot;scroll()&amp;quot;,500);

      /*
      鼠标事件
      onclick
      ondbclick
      onkeydown
      onkeyup
      onkeypress
      onmousedown
      onmousemove
      onmouseout
      onmouseover
      onmouseup
       
       
      */

    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;

  &amp;lt;Body&amp;gt;
    &amp;lt;Div value=&amp;quot;全选区&amp;quot;&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;setall&amp;quot; /&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;setall&amp;quot; /&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;setall&amp;quot; /&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;setall&amp;quot; /&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;setall&amp;quot; /&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;setall&amp;quot; /&amp;gt;
      &amp;lt;Input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;&amp;quot; id=&amp;quot;all&amp;quot;/&amp;gt;
    &amp;lt;/Div&amp;gt;
    &amp;lt;Div id =&amp;quot;news&amp;quot;&amp;gt;

    &amp;lt;/Div&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; value=&amp;quot;生成列表&amp;quot;/&amp;gt;
    &amp;lt;H1&amp;gt;Tree ! Everything can become trees.&amp;lt;/H1&amp;gt;
    &amp;lt;P&amp;gt;Html代码层层嵌套像一颗颗&amp;lt;Em&amp;gt;树&amp;lt;/Em&amp;gt;一样。&amp;lt;/P&amp;gt;
    &amp;lt;Div&amp;gt;一层一层的数&amp;lt;Img id=&amp;quot;34&amp;quot; src=&amp;quot;&amp;quot; alt=&amp;quot;如果没有图片会显示我&amp;quot;/&amp;gt;&amp;lt;/Div&amp;gt;
  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;上面为止是到第JSDom15的内容。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>March15th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/march15th/</link>
      <pubDate>Mon, 11 May 2015 14:58:44 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/march15th/</guid>
      <description>&lt;p&gt;一、练习总结
1.利用jq插入节点有4个一致性很强的： append，prepend，after，before。其中append和prepend都是对于子节点的添加。after和befor是对于兄弟节点的添加。
2.ChildNode和Childen是不同的，因为ChildNode会把空格远算进去。那么Each遍历的是啥？
3.对于“：”不要乱用。要明确到底有哪些!
4.对于 ：什么的，都是起到一个修饰作用。
5. :even 是选择偶数  :odd是选择奇数  :eq(index)   :gt(index)   :lt(index)   关于gt理解是greate than 是大于，less than是小于。:not
6.Jq的索引是从0开始的。
7.子节点的事件会传递给父节点!？这个叫做事件冒泡.不懂。
8.对于冒号修饰符的使用，可以重复多个配合一起使用：比如。$(&amp;ldquo;table:first  tr:even&amp;rdquo;).css(&amp;ldquo;background&amp;rdquo;, &amp;ldquo;#ffaacc&amp;rdquo;);
9.change是在文本域丢失焦点的时候才会触发的。
10.关于 $(&amp;ldquo;ul li&amp;rdquo;) 和 $(&amp;ldquo;ul&amp;gt;li&amp;rdquo;)是不同的，前者的空格表示的是后台元素，而大于号表示的子代元素。后代元素是包括了子代孙元素的。而子代元素只有子代。
11.空格不要乱打!空格表示的是后代，不要忽略这个问题了。&lt;/p&gt;
&lt;p&gt;一、前端知识
1.Javascript刷新页面的几种方法：
1）  history.go(0)
2）  location.reload()
3)     location=location
4)     location.assign(location)
5)     document.execCommand(&amp;lsquo;Refresh&amp;rsquo;)
6)     window.navigate(location)
7）  location.replace(location)
8） document.URL=location.href
说明一下，jQuery没有发现刷新页面的方法。
2.remove() detach()都有移除的作用，且他们返回值都是这个被移除的对象。如果重新将这个添加上去，remove绑定的事件会消失，而detach的不会消失。
3.empty() 是清空所有的后台节点。
4.warp()是包裹的：ex $(&amp;quot;#city&amp;quot;).wrap(&amp;quot;&lt;strong&gt;&lt;/strong&gt;&amp;quot;);
5.clone()是克隆的意思，如果添加了true表示克隆事件，如果不加true只克隆外形不克隆事件。
6.repalceWith()，replaceAll()2个repalce方法是替换，需要注意的，一旦替换，之前的元素会消失。
7.关于val()和text()区别。对于input这种单标签而言，val()就是他们的值，对于&lt;li&gt;或者&lt;p&gt;这种双标签而言就是用text()。
注意了input的文本框的值是value。
8.对于focus和blur都是在刚触发事件的某一个时候触发的事件。
9.next()，pre()，siblings()，三个都是获取同辈元素。next是之后的，pre是之前的，sibling()是获取所有的同辈元素。
10.(selector).each(function(){     &amp;hellip;.       });
11.$(selector).children(&amp;quot;.bb&amp;quot;)这个就是选出selector子节点中符合要求：类名为bb的所有节点。
12.window.onload 是在Dom加载完毕且关联元素加载完毕后才执行。而$(document).ready()是在DOM加载完毕后就执行，效率更高。
13.window.onload只执行一次，$(document).ready()执行多次。
14.JQ的事件比起JS来说，少了on这个2个前缀。
15.这2个状态不能记忆混淆了  :hiden :visible  一个是隐藏，一个是可见。 hide()   visible()
16.链式编程为同一个元素添加不同状态的方法可以分开写，也可以使用bind来把绑定不停形态下的方法，当然还有更简单的方法&lt;br&gt;
$(&amp;quot;#panel .head&amp;quot;).mouseover(function () { }).mouseleave(function () { });&lt;br&gt;
17.(&amp;ldquo;selector&amp;rdquo;).toggle(fun1,fun2,fun3,&amp;hellip;);用于模拟在这个selector上的鼠标单击事件。表示的是这个对于这个selecor依次点击 会触发事件f1,f2,f3&amp;hellip;触发完毕后会从头开始轮询。
18.return false 比 event.stopPropagation() 和 event.preventDefault()更好用。可以代替这2个。
19.事件冒泡是因为从小到大，都有某一个相同的事件被触发，会从里到外依次触发。
20.事件捕获和事件冒泡是一个相反的过程，捕获是从外到内，冒泡是从内到外。
一、JQ学习
1.$(selector).bind(funName1,func1).bind(funName2,func2)&amp;hellip; 这种写法不方便，JQ提供了一套简写的机制：$(selector).fucName1(func1).funName2(func2)
2.可以为一个selector绑定多个事件。
3.对于状态判定可以使用  $(selector).is(&amp;quot;:visible&amp;quot;)   注意了：visible 是可见的。
4.在this的写方法，又犯了一个经典错误：   $(this) 才是正确的。但是 $(&amp;ldquo;this&amp;rdquo;)就是错误的。this的理解应该是触发这个事件的对象。
5.JQ有2个合成事件，一个是hover一个是toggle，其中hover是鼠标的enter和leave，其写法为  $(selector).hover(enter,leave)
还有一个是toggle(fun1,fun2&amp;hellip;)这个是模拟鼠标点击事件。
6.当某一个对象要解绑某个事件的时候，可以使用：  $(selector).unbind(funcName) 或者 $(selector).unbind() ，前者解绑某一个方法，后者解绑所有的方法。
7.one(funcName,func) 用在触发一次的事件上。
8.JQ中的动画有hide()和show()，要实现动画效果，括号中需要给毫秒为单位的值，就可以实现动画效果了。
9.fadeIn()和fadeOut()可以改变不透明度。括号中同样可以给出参数，fadeIn是慢慢显示，fadeOut是慢慢消失。
10.slideUp()，slideDown()分别是改变所选的宽度。
11.   :checked 被选中和  checked=&amp;ldquo;checked&amp;quot;是有区别的。个人理解：被选中不一定会有checked=&amp;ldquo;checked&amp;rdquo; 但是一定可以通过状态 :checked 来获取。
12.总结 ：对于要获取处于某个状态的元素，可以使用  :状态   来获取。
13.对于使用多个属性来取值，可以使用  $(&amp;ldquo;selector[id=123][name=lcf]&amp;quot;)
14.JQ中支持在Childen(&amp;quot;:checked&amp;rdquo;)来选取子元素中被选取了的元素。
15.JQ中，只有要括号，就可以在括号里面写筛选条件。
16.对于利用Jq添加上去的东西，可以为其添加一个id获取class，方便进行处理。
17.JQ中移除替换都会删除以前的元素。
18.$(selector).toggle 用于切换状态，当前显示就变成隐藏，当前隐藏就是变成显示。
19.$(selector).toggleClass(&amp;ldquo;className&amp;rdquo;)如果当前选择的有这个类就删除，没有就添加。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    1.思考：要想实现Jquery这样的“链式编程”那么每个方法的返回值就应该是调用者本身，即return  this.
    2.导入Jqeruy的时候，特别注意了，要有2个script，第一个script是利用src导入jquery的文件，不要在里面写jquery代码。第二个写script才开始写jquery代码。
    3.Jqeruy中是可以有多个 $(document).ready(function(){.....});
    4.如果某个函数在页面加载完了就执行了，考虑这个函数是不是没有放在括号里面的function(){写在这里};
    5.Jqeruy中的事件和JS中不一样：
            onClikc ---click
    6.Jquery中事件的函数是写在里面的，比如规范写法如下：
             $(&amp;quot;#bj&amp;quot;).click(function () {
            alert(&amp;quot;HH&amp;quot;);
        });
       这个时候如果写成这样：
        $(&amp;quot;#bj&amp;quot;).click(alert(&amp;quot;HH&amp;quot;));
        表示的意思就不一样了，这个就是说函数执行到这个地方就开始执行。而且没有绑定函数。
    7.如果子元素为当前的this，那么next是父元素的下一个，而不是子元素的!？
    8.再次强调，this是Dom对象，在Jquery使用的时候，要转换为Jquery对象$(this)
    9.对于某个属性赋值或者获取值使用的是  attr(&amp;quot;name&amp;quot;,&amp;quot;lcf&amp;quot;)  或者 var myName=attr(&amp;quot;name&amp;quot;)
    10.判断2个字符串相等使用的是==，且支持三目运算符。
    11.JS中变量的类型：boolean 字符串  数值类型。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;四、练习总结二
1.Jquery中属性可以通过[ name=bb]  来匹配，也可以通过  .attr(&amp;ldquo;bb&amp;rdquo;) 来获取，同时 .attr(&amp;ldquo;bb&amp;rdquo;,&amp;ldquo;love&amp;rdquo;)来赋值;。
2.操作文本节点可以通过文本节点的父节点来操作。比如&lt;p id=&#34;mm&#34;&gt;我爱你&lt;/p&gt;。通过id为mm获取到p然后text()就可以了。
3.在html中标签就是元素，元素就是标签，完全可以这么理解。
4.对于属性的操作可以使用attr来，如果要取值使用    $(&amp;quot;#bb&amp;rdquo;).attr(&amp;ldquo;value&amp;rdquo;) 可以获取id为bb的value值。如果要赋值  $(&amp;quot;#bb&amp;quot;).attr(&amp;ldquo;value&amp;rdquo;,&amp;ldquo;我爱你&amp;rdquo;);
5.对于value更有更简单的操作就是 val()。上面的等价于  $(&amp;quot;#bb&amp;quot;).val(&amp;ldquo;123&amp;rdquo;)这个赋值                 $(&amp;quot;#bb&amp;quot;).val();这个取值。
6.append是在被选定节点的内部添加上XXX，prepend是在某个元素前（仍然在内部）添加子节点。
7.after和append添加方式和6的append和prepend相同，但是这2个添加的是兄弟节点。
8.关于6和7，如果我们要添加一个东西就直接写就是了，比如：   $(&amp;quot;#bj&amp;quot;).after(&amp;quot;&lt;li&gt;成都&lt;/li&gt;&amp;quot;); 这种形式。&lt;/p&gt;
&lt;p&gt;1.对于JS来说，在Web中，最重要的应用之一就是DOM。
2.Dom是针对HTML和XML操作的一个API。
3.Dom将一个文档表示为一颗家族树（父，兄，子 节点）
4.几个常用的API。
getElementById 只能用document来使用，通过id查找一个节点。
getElementsByTagName  返回的是一个数组，通过指定的标签名去寻找，不必作用于整个文档。
hasChildNodes 调用的节点是否含有子节点。
5.Dom中的节点有文本节点（Text），属性节点（Attribute），元素节点（Element）。
6.以上3类节点中，都有如下属性：
nodeName：只读，标识的是给定节点的名字，该节点为只读属性。对于文本节点返回的是 #text 的字符串。
noteType：只读，返回值为int，标识节点的类型。元素节点 1，属性节点 2，文本节点 3。（从小到大的记忆顺序）
nodeValue: 可读，可写。返回当前节点的值，属性节点返回属性的值，文本节点返回文本的值，元素节点啥都没有。
7.Dom中常用方法：
replaceChild()：返回值是一个指向新的或者旧的节点。（？）作用是吧一个父元素中的子节点替换为另外一个子节点。
ex:        var reference = element.replaceChild(newChild,oldChild);
getAttribute(): 返回的是指定元素的给凌属性的值。
ex:        var attributeValue = element.getAttribute(attributeName);
setAttribute(key,value)：为指定的元素添加某个属性，如果此属性已经存在就刷新，如果不存在就添加。
ex:      var para = document.createElement(“p”);           para.setAttribute(“id”,”fineprint”);
createElement(eleName):通过指定的标签名字来创建一个元素节点。这个新创建的节点没实际添加到某个节点上。
ex:        var oP = document.createElement(&amp;ldquo;p&amp;rdquo;);
createTextNode()：创建一个包含指定文本的文本节点。返回值为一个指向新建文本节点的指针。
ex: var oText=document.createTextNode(&amp;ldquo;HEllo world&amp;rdquo;);
appendChild()：为指定的元素添加一个节点到最后一个节点后。
insertBefore()：在指定的节点前面添加。
ex:        var reference = element.insertBefore(newNode,targetNode);
注：Dom没有提供insertAfter()方法：就是在插入节点的下一个节点之前添加，就是在指定节点的前面添加。
removeChild()：在指定节点中的子节点删除一个节点。
注：一定要是父节点去调用然后括号里面是自己点。
ex： var message = document.getElementById(“fineprint”);
var container = message.parentNode;
container.removeChild(message);
8.Dom中常用属性
ChildNodes：返回的是指定父节点的所有子节点。
注：文本节点和属性节点，肯定不含有子节点了，如果调用这个属性，会返回空数组。
firstChild:返回的是指定元素的第一个子节点。
ex:node.ChileNodes[0]和firstChild 是相同的。
lastChild:和first想法，最后一个。
nextSibling：指定节点的下一个子节点。
previousSibling:指定节点的上一个子节点。
parentNode：返回的是指定节点的父节点。
二、JavaScript练习总结
1.window.onload=function(){&amp;hellip;}表示的是在页面加载完成后便开始运行。
2.node.insertBefor(new node,null)。这样调用就可以在指定的前面添加了!
3.如果网页乱码，可以在&lt;head&gt;&lt;/head&gt;之间加上：  &lt;meta http-equiv=&#34;content-type&#34; content=&#34;text/html; charset=utf-8&#34;/&gt;
4.特别说明：insertBefor这个方法。3个参数：  paraentNode.insertBefor(newNode,childNodeInParaNode);
就是说哪个Node来调用insertBefore方法就是在那个Node的子节点中插入，其中第一个参数是要插入的节点，第二个参数是自己点中要在哪个指定的子元素前面。
注：第二个节点可是是null，就表示在最后添加，同AppendChild。特别注意了。
5.getElementByTagName(&amp;ldquo;标签&amp;rdquo;)，这个里面输入的是HTML的标签。
6.对于元素节点的nodeName，其返回值永远是大小的标签。
7.忘记nodeValue吧，使用value就够了，前面的需要区分下。
8.value这个属性可读可写。
9.对于使用firstChild和lastChild不是我们所见的第一个。这个特别注意了。
10.通常来说firstNode和lastNode获取的是文本节点。
11.对于文本节点，如果要设置他的值，需要使用nodeValue而不是value。比如说firstChild和lastChild获取的都是属于文本节点。
12.为某一个节点添加 可以使用innderHtml也可以使用 创建一个TextNode然后添加到某个节点上去。
13.对于replaceChild，parentNode.replaceChild(newChild，childInParane).这个方法的作用是父节点调用替换某个子节点，第一个节点一般都是新的节点，第二个节点
14.几个不加括号的地方:
window.onload=function myFunc(){&amp;hellip;}
15.在JS中，方法带了括号表示运行。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1.Jquery是对JavaScript进行封装后的库，其主旨是“写的少，做的多”
    2.在Jquery中Jquery是一个顶级对象，所有的方法都在这个对象下，且 $ 是这个方法的别名。
    3.Dom对象和Jqeruy对象是不同的，只有Jquery对象才能调用Jquery的方法，Dom对象不可以。
    4.Jquery的对象在形式上用 $开头比如   var   $node=$(&amp;quot;button&amp;quot;);
    5.Jqeruy对象转Dom对象一般通过下标来获取，比如   var  firstNode=$node[0];或者  var  secodNode=$node.get[0];
    6.Dom对象转Jquery对象  就是在Dom对象前面加上$就行了，比如说:   var  $node =$(document.getElementById(&amp;quot;ok&amp;quot;));
    7.this永远是Dom对象而$(this)
    8.Jqery的选择器：
            id选择器  #id         ${&amp;quot;#idName&amp;quot;}
            class选择器  .class        ${&amp;quot;.className&amp;quot;}
            所有元素选择器  ${elementName}    ${&amp;quot;p&amp;quot;}
    8.选择器是Jquery的基础，以下为基本的选择器 #为id选择器  .为类选择器  $(&amp;quot;div&amp;quot;) 是所有的名为div的选择器， $(&amp;quot;*&amp;quot;)是选择的所有。
    9.层次选择器:        
            $(&amp;quot;body   div&amp;quot;)：选取的是body里面的div，包括子元素中的子元素。
            $(&amp;quot;body &amp;gt; div&amp;quot;)： 选取的是body子元素中的div        特别注意：这个选取的才是子元素,而且子元素中所有的。
            $(&amp;quot;.one + div&amp;quot;)：选取的是class为one的兄弟节点中下一个div。
            $(&amp;quot;.one ~ div&amp;quot;)： 选取的是class为one后面的所有的div   推荐写法                  $(&amp;quot;.one&amp;quot;).next(&amp;quot;div&amp;quot;)  
            注：对于第一个 选取的是body下面的所有div就是依次遍历所有的div。而第二是选取的body下面的第一层子元素的div。
    10.基本过滤器中有3个很重要：
            $(&amp;quot;div:first&amp;quot;)：div中第一个节点。
            $(&amp;quot;div:last&amp;quot;)：div中最后一个节点。
            $(&amp;quot;:focus&amp;quot;)：当前正在focus的。
            $(&amp;quot;:animate&amp;quot;):当前正在运行的。
    11.几个内容过滤器：
            $(&amp;quot;div:contains(txt)&amp;quot;)：div下内容包含txt的所有，不仅仅是第一个。
            $(&amp;quot;div:empty&amp;quot;):div下内容为empty的
    12.属性过滤器
            $(div[tille=bb]):选取div下有属性名为title，值为bb的元素。
            $(div[title]):选取含有title属性的元素。
            $(div[title]*=bb):选取div下属性值title中带有bb的元素。
            $(div[title]^=bb):选取div下属性为title以bb开头的元素。
            $(div[title]$=bb):选取div下title属性以bb结尾的元素。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;多个时间段的笔记，未整理，周末抽空整理!
一、复习DOM
1.对于JS来说，在Web中，最重要的应用之一就是DOM。
2.Dom是针对HTML和XML操作的一个API。
3.Dom将一个文档表示为一颗家族树（父，兄，子 节点）
4.几个常用的API。
getElementById 只能用document来使用，通过id查找一个节点。
getElementsByTagName  返回的是一个数组，通过指定的标签名去寻找，不必作用于整个文档。
hasChildNodes 调用的节点是否含有子节点。
5.Dom中的节点有文本节点（Text），属性节点（Attribute），元素节点（Element）。
6.以上3类节点中，都有如下属性：
nodeName：只读，标识的是给定节点的名字，该节点为只读属性。对于文本节点返回的是 #text 的字符串。
noteType：只读，返回值为int，标识节点的类型。元素节点 1，属性节点 2，文本节点 3。（从小到大的记忆顺序）
nodeValue: 可读，可写。返回当前节点的值，属性节点返回属性的值，文本节点返回文本的值，元素节点啥都没有。
7.Dom中常用方法：
replaceChild()：返回值是一个指向新的或者旧的节点。（？）作用是吧一个父元素中的子节点替换为另外一个子节点。
ex:        var reference = element.replaceChild(newChild,oldChild);
getAttribute(): 返回的是指定元素的给凌属性的值。
ex:        var attributeValue = element.getAttribute(attributeName);
setAttribute(key,value)：为指定的元素添加某个属性，如果此属性已经存在就刷新，如果不存在就添加。
ex:      var para = document.createElement(“p”);           para.setAttribute(“id”,”fineprint”);
createElement(eleName):通过指定的标签名字来创建一个元素节点。这个新创建的节点没实际添加到某个节点上。
ex:        var oP = document.createElement(&amp;ldquo;p&amp;rdquo;);
createTextNode()：创建一个包含指定文本的文本节点。返回值为一个指向新建文本节点的指针。
ex: var oText=document.createTextNode(&amp;ldquo;HEllo world&amp;rdquo;);
appendChild()：为指定的元素添加一个节点到最后一个节点后。
insertBefore()：在指定的节点前面添加。
ex:        var reference = element.insertBefore(newNode,targetNode);
注：Dom没有提供insertAfter()方法：就是在插入节点的下一个节点之前添加，就是在指定节点的前面添加。
removeChild()：在指定节点中的子节点删除一个节点。
注：一定要是父节点去调用然后括号里面是自己点。
ex： var message = document.getElementById(“fineprint”);
var container = message.parentNode;
container.removeChild(message);
8.Dom中常用属性
ChildNodes：返回的是指定父节点的所有子节点。
注：文本节点和属性节点，肯定不含有子节点了，如果调用这个属性，会返回空数组。
firstChild:返回的是指定元素的第一个子节点。
ex:node.ChileNodes[0]和firstChild 是相同的。
lastChild:和first想法，最后一个。
nextSibling：指定节点的下一个子节点。
previousSibling:指定节点的上一个子节点。
parentNode：返回的是指定节点的父节点。
二、JavaScript练习总结
1.window.onload=function(){&amp;hellip;}表示的是在页面加载完成后便开始运行。
2.node.insertBefor(new node,null)。这样调用就可以在指定的前面添加了!
3.如果网页乱码，可以在&lt;head&gt;&lt;/head&gt;之间加上：  &lt;meta http-equiv=&#34;content-type&#34; content=&#34;text/html; charset=utf-8&#34;/&gt;
4.特别说明：insertBefor这个方法。3个参数：  paraentNode.insertBefor(newNode,childNodeInParaNode);
就是说哪个Node来调用insertBefore方法就是在那个Node的子节点中插入，其中第一个参数是要插入的节点，第二个参数是自己点中要在哪个指定的子元素前面。
注：第二个节点可是是null，就表示在最后添加，同AppendChild。特别注意了。
5.getElementByTagName(&amp;ldquo;标签&amp;rdquo;)，这个里面输入的是HTML的标签。
6.对于元素节点的nodeName，其返回值永远是大小的标签。
7.忘记nodeValue吧，使用value就够了，前面的需要区分下。
8.value这个属性可读可写。
9.对于使用firstChild和lastChild不是我们所见的第一个。这个特别注意了。
10.通常来说firstNode和lastNode获取的是文本节点。
11.对于文本节点，如果要设置他的值，需要使用nodeValue而不是value。比如说firstChild和lastChild获取的都是属于文本节点。
12.为某一个节点添加 可以使用innderHtml也可以使用 创建一个TextNode然后添加到某个节点上去。
13.对于replaceChild，parentNode.replaceChild(newChild，childInParane).这个方法的作用是父节点调用替换某个子节点，第一个节点一般都是新的节点，第二个节点
14.几个不加括号的地方:
window.onload=function myFunc(){&amp;hellip;}
15.在JS中，方法带了括号表示运行。
一、JS基础细节
1.JS如果写在内部，通常推荐写在head的title下面。
2.window.onload=function(){&amp;hellip;}是在整个文档DOM树加载完毕后触发的函数。
3.获取元素而言，最常用的3个方式 byId，byTagName，byName。前两者最常用。
4.通常来说，找节点，常用的方法是 firstChild或者lastChild和byTagName3个方法，其他的方法比如ChildNodes不常用。
5.（重点）对于一个方法，后面没有加括号的方法，被调用是只可能是情况允许了，被触发了。一个方法一旦加了括号表示的就是马上调用这个方法。
6.对于for循环为每一个节点赋值的情况，这样的东西没有反应解释：
for(i=0;i&amp;lt;nodes.length;i++){
nodes[i].onclick=function(){
alert(nodes[i].nodeValue);    //改成  alert(this.nodeValue);
}
}
结合第5点来理解，先是赋值然后才是应用。对于这个方法alert()而言，中间的过程是OK的，但是到了最后i在不停的增加，知道i等于了length。alert的成了这个不存在的最大的value了，就错了。
先是指向，然后点击了才会触发。
7.整个项目的window.onload只能有一个。Jquery没有这个限制。
8.每一个节点都有3个属性，nodeName,nodeType,nodeValue。
9.说明： 对于 &lt;li name=&#34;myName&#34; id=&#34;nameId&#34;&gt;BB&lt;/li&gt; 这一句代码中就包括了3个节点：文本节点BB 元素节点&lt;li&gt; 属性节点 id和name.
10.获取节点的方式有3种，byId，byTagName，byName。对于子节点有3种方式firstChildNode，lastChildNode，byTagName
11.对于以下代码：
&lt;ul id=&#34;city&#34;&gt;                                                                                                                                                                     &lt;ul id=&#34;city2&#34;&gt;&lt;li&gt;北京&lt;/li&gt;&lt;/ul&gt;
&lt;li&gt;北京&lt;/li&gt;
&lt;/ul&gt;
第一种的firstChild获取到的是一个文本节点，而且这个文本节点是空的。第二获取到的就是元素节点就是li这个节点。所以对于HTML来说换行与否还是很有必要的。
12.（重要。）文本节点一定是元素节点的子节点。
13.对于文本节点的赋值使用nodeValue。nodeType，元素为1，属性为2，文本节点为3.
14.value通常对于属性节点而言，他的值。而nodeValue对于文本节点的值。
15.常用的JS事件，onclick、onchange
一、复习JS
1.对于HTML 的DOM而言，最上面的Document文档节点，最上层节点。Text文本节点，Element元素节点，Attribute属性节点。
2.文本节点一定是元素的子节点。
3.再次理解：对于匿名函数，如果要马上执行，是需要在后面写上一个括号的。对于非匿名函数，比如说对于一个button的onclick=&amp;ldquo;Run&amp;quot;和onclick=&amp;ldquo;Run()&amp;ldquo;意思是不同的，前者是说在onclick这个事件触发后，将要执行的动作指向Run这个方法。后者是说在onclick事件触发后运行Run这个方法。
4.css在前，javascript在后，尽量不阻塞！因为浏览器解析是从上到下依次加载的，一旦遇到script标签，就会停止加载后面的，先对JavaScript脚本文件进行加载和运行。
5.return false 可以阻断JS代码的运行，return也是可以的。（？区别？）
6.关于事件冒泡不懂。。。
7.关于createTextNode()然后Xnode.append进去和Xnode.innerHtml=&amp;ldquo;XX&amp;rdquo; 是不是不懂的。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Jar包打包成可安装的EXE文件</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/jarbao-da-bao-cheng-ke-an-zhuang-de-exewen-jian/</link>
      <pubDate>Mon, 11 May 2015 14:58:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/jarbao-da-bao-cheng-ke-an-zhuang-de-exewen-jian/</guid>
      <description>&lt;p&gt;学习java的人都知道，java执行class文件是需要在jvm的环境下。但是你写完一个软件难道非得叫人安装一个JRE嘛？！是的，必须。但是这样别人用起来会不爽，于是我们就事先把java的JRE给嵌入到我们的EXE安装包，这样不是很ok！ 于是就调研了一番，最后选择eclipse+exe4j+innosetup这三个软件配合使用
附加的word文件分成三个部分进行，
第一部分   eclipse生成可运行的jar包
第二部分 Exe4j产生exe程序&lt;br&gt;
第三部分   InnoSetup封装 jre到exe的运行环境下
exe4j是非破解版，在Word中提供了注册码，主要作用是生成exe文件（运行在有JRE的环境下），由于太大并未上传，提供连接exe4j下载 。 InnoSetup.exe是一个打包程序，编程setup.exe安装版（安装之后，没有JRE也可以运行。）
主要关键点：
exe4j 的 GUI和console两种情况的生成&lt;br&gt;
填写JRE最小版本，最大版本可以不用填。删掉InnoSetup默认的Java_home信息，导入正确的JRE文件夹（切勿小心）。 其他的都是傻瓜式安装&lt;/p&gt;
&lt;p&gt;Jar包打包成可安装的EXE文件.docx
559.84 KB, 下载次数: 0
jar变exe的详细步骤&lt;/p&gt;
&lt;p&gt;innosetup-5.5.5.rar
1.83 MB, 下载次数: 0
innosetup打包程序&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;在word 文档里面，使用的jre不是jdk自带的，而是另外下载，当时不知道为什么直接拷贝到项目文件夹不行,报找不到jvm的错误。今天下午帅锅锅一折腾，才发现下载的jre和jdk自带的jre有些不同，jdk的jre目录的bin目录多了一个server文件夹，而同时还有一个client 文件夹（非java自带的jre只有一个client文件夹），所以其实java自带的jre文件夹有两个jvm（听赵帅说是：为了设计完程序后以用户角度体验程序效果，我表示不解） ，而也正因为这两个jvm的原因导致了程序不知道使用哪个jvm运行了，于是有了下面的方法。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以，基于这番调查，提出另一种方法&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;拷贝jdk底下的jre到项目文件夹下，然后删掉bin目录下的server（删掉多余的jvm) ,然后按照word中的过程照样有效（不需要额外再去下载jre)
测试，有效。&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>JavaScript 7-11节笔记代码March28th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/javascript-7-11jie-bi-ji-dai-ma-march28th/</link>
      <pubDate>Mon, 11 May 2015 14:58:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/javascript-7-11jie-bi-ji-dai-ma-march28th/</guid>
      <description>&lt;p&gt;function串讲笔记&lt;/p&gt;
&lt;p&gt;1：function是什么？
JS的function类似于java和.Net的方法&lt;/p&gt;
&lt;p&gt;2：对比JS版本和Java版本的两个变量的求和，得出三个不同点。
JS版本：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;function sum(num1,num2)
{
    var ret = num1+num2;
    return ret;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Java版本：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;public int sum(int num1,int num2)
{
   int ret= num1+num2;
  return ret;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;相同点：
函数名字
参数列表
变量声明
返回值
不同点：
JS的函数声明没有修饰符
JS的函数声明没有返回值
JS的函数声明的参数列表没有变量类型&lt;/p&gt;
&lt;p&gt;由这三个不同点我们可以提出三个问题
为什么没有修饰符？
为什么没有返回值类型？
为什么参数列表没有变量类型？&lt;/p&gt;
&lt;p&gt;3：JS为什么没有修饰符？
Js不是面向对象的语言，虽然有对象但不是真正的对象。&lt;/p&gt;
&lt;p&gt;Js的对象是模拟出来的，没有封装的概念，所以不需要使用修饰符（修饰符只是针对于对象）&lt;/p&gt;
&lt;p&gt;4：JS为什么没有返回值类型和参数列表变量类型？
这两个问题是一样的道理，都是弱类型的原因
5：由参数列表引入一个arguments对象，what is it?
在开始了解arguments对象之前，必须说明函数的四种定义方式，如下所示：
5.1最一般的函数定义方法：
有function
有函数名称sum
有参数列表 num1,num2
可有可无的return语句&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;function sum(num1,num2)
{
    var ret = num1+num2;
    return ret
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5.2最常见的匿名类函数调用方法：
有function
没有函数名称
有变量泪飚 num1,num2
可有可无的return语句
通过一个var sum函数类型变量获得该类型，并使得sum变量具有可调用的属性。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;var sum = function(num1,num2)
{
    var ret = num1+num2;
    return ret
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;规律：页面中的js代码执行之前，浏览器会先扫描全部的js代码，遇到一个函数声明，就把此函数的声明加到全局域，从上到下扫描，若函数名称一样，后声明的函数会覆盖掉前面。
5.3较特殊的匿名类函数的声明和使用：
两个括号()()
第一个括号是匿名类函数的声明
第二个括号是匿名类的函数实参&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;(function(num1,num2)
{
   var ret=num1+num2;
   return ret;
})(3,2);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;特点：只会执行一次。&lt;/p&gt;
&lt;p&gt;5.4较少用的Function类产生函数对象&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;var sum = new Function();形式
var sum = Function(&amp;quot;n1&amp;quot;,&amp;quot;n2&amp;quot;,&amp;quot;alert(n1+n2); var a=3;var b=4;alert(a+b);&amp;quot;)

sum(3,3);//和其他函数声明的调用一样。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这也是为什么匿名函数可以赋值给一个变量的原因，因为Function类可以产生对象，对象可以赋值给一个变量（对象只是一个引用）。
特点：效率低效。&lt;/p&gt;
&lt;p&gt;上面的五种函数声明方式都涉及到参数列表，而JS使用arguments可以获得任意长度的参数列表。
比如：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var sum = function()
{
    var ret=0;
   for(var i=0;i&amp;lt;arguments.length;i++)
  {
    ret = ret+arguments[i];  
   }
    return ret;
}

sum(1,2);
sum(1,5,68,98);
sum(4,45,7,8,3,23,7,9);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;而正因为arguments的作用导致了js不能重载。&lt;/p&gt;
&lt;p&gt;6：JS为什么不能重载？
存在arguments对象，导致参数列表可以任意长度。
弱类型决定了参数列表的变量不需要类型修饰。&lt;/p&gt;
&lt;p&gt;7：函数调用的两种方式？
标签的事件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;&amp;lt;button id =”btn” onclick=”alert(4);var  a =3; var b=4; alert(a+b);”)
复制代码

Dom的window.onload=function(){}方式，通过document的方法获得标签地址
Window.onload=function()
{
Window.document.getElementById(“btn”).onclick=function()
{
    Show();
}
}
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>JavaScript1-6节笔记代码March26th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/javascript1-6jie-bi-ji-dai-ma-march26th/</link>
      <pubDate>Mon, 11 May 2015 14:58:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/javascript1-6jie-bi-ji-dai-ma-march26th/</guid>
      <description>&lt;p&gt;js 常见 Events
属性        当以下情况发生时，出现此事件     &lt;br&gt;
onabort        图像加载被中断        元素失去焦点     &lt;br&gt;
onchange        用户改变域的内容
onclick        鼠标点击某个对象
ondblclick        鼠标双击某个对象     &lt;br&gt;
onerror        当加载文档或图像时发生某个错误     &lt;br&gt;
onfocus        元素获得焦点     &lt;br&gt;
onkeydown        某个键盘的键被按下     &lt;br&gt;
onkeypress        某个键盘的键被按下或按住     &lt;br&gt;
onkeyup        某个键盘的键被松开     &lt;br&gt;
onload        某个页面或图像被完成加载     &lt;br&gt;
onmousedown        某个鼠标按键被按下     &lt;br&gt;
onmousemove        鼠标被移动     &lt;br&gt;
onmouseout        鼠标从某元素移开     &lt;br&gt;
onmouseover        鼠标被移到某元素之上     &lt;br&gt;
onmouseup        某个鼠标按键被松开     &lt;br&gt;
onreset        重置按钮被点击     &lt;br&gt;
onresize        窗口或框架被调整尺寸     &lt;br&gt;
onselect        文本被选定     &lt;br&gt;
onsubmit        提交按钮被点击     &lt;br&gt;
onunload        用户退出页面&lt;br&gt;
一、复习DOM
1.对于JS来说，在Web中，最重要的应用之一就是DOM。
2.Dom是针对HTML和XML操作的一个API。
3.Dom将一个文档表示为一颗家族树（父，兄，子 节点）
4.几个常用的API。
getElementById 只能用document来使用，通过id查找一个节点。
getElementsByTagName  返回的是一个数组，通过指定的标签名去寻找，不必作用于整个文档。
hasChildNodes 调用的节点是否含有子节点。
5.Dom中的节点有文本节点（Text），属性节点（Attribute），元素节点（Element）。
6.以上3类节点中，都有如下属性：
nodeName：只读，标识的是给定节点的名字，该节点为只读属性。对于文本节点返回的是 #text 的字符串。
noteType：只读，返回值为int，标识节点的类型。元素节点 1，属性节点 2，文本节点 3。（从小到大的记忆顺序）
nodeValue: 可读，可写。返回当前节点的值，属性节点返回属性的值，文本节点返回文本的值，元素节点啥都没有。
7.Dom中常用方法：
replaceChild()：返回值是一个指向新的或者旧的节点。（？）作用是吧一个父元素中的子节点替换为另外一个子节点。
ex:        var reference = element.replaceChild(newChild,oldChild);
getAttribute(): 返回的是指定元素的给凌属性的值。
ex:        var attributeValue = element.getAttribute(attributeName);
setAttribute(key,value)：为指定的元素添加某个属性，如果此属性已经存在就刷新，如果不存在就添加。
ex:      var para = document.createElement(“p”);           para.setAttribute(“id”,”fineprint”);
createElement(eleName):通过指定的标签名字来创建一个元素节点。这个新创建的节点没实际添加到某个节点上。
ex:        var oP = document.createElement(&amp;ldquo;p&amp;rdquo;);
createTextNode()：创建一个包含指定文本的文本节点。返回值为一个指向新建文本节点的指针。
ex: var oText=document.createTextNode(&amp;ldquo;HEllo world&amp;rdquo;);
appendChild()：为指定的元素添加一个节点到最后一个节点后。
insertBefore()：在指定的节点前面添加。
ex:        var reference = element.insertBefore(newNode,targetNode);
注：Dom没有提供insertAfter()方法：就是在插入节点的下一个节点之前添加，就是在指定节点的前面添加。
removeChild()：在指定节点中的子节点删除一个节点。
注：一定要是父节点去调用然后括号里面是自己点。
ex： var message = document.getElementById(“fineprint”);
var container = message.parentNode;
container.removeChild(message);
8.Dom中常用属性
ChildNodes：返回的是指定父节点的所有子节点。
注：文本节点和属性节点，肯定不含有子节点了，如果调用这个属性，会返回空数组。
firstChild:返回的是指定元素的第一个子节点。
ex:node.ChileNodes[0]和firstChild 是相同的。
lastChild:和first想法，最后一个。
nextSibling：指定节点的下一个子节点。
previousSibling:指定节点的上一个子节点。
parentNode：返回的是指定节点的父节点。
二、JavaScript练习总结
1.window.onload=function(){&amp;hellip;}表示的是在页面加载完成后便开始运行。
2.node.insertBefor(new node,null)。这样调用就可以在指定的前面添加了!
3.如果网页乱码，可以在&lt;head&gt;&lt;/head&gt;之间加上：  &lt;meta http-equiv=&#34;content-type&#34; content=&#34;text/html; charset=utf-8&#34;/&gt;
4.特别说明：insertBefor这个方法。3个参数：  paraentNode.insertBefor(newNode,childNodeInParaNode);
就是说哪个Node来调用insertBefore方法就是在那个Node的子节点中插入，其中第一个参数是要插入的节点，第二个参数是自己点中要在哪个指定的子元素前面。
注：第二个节点可是是null，就表示在最后添加，同AppendChild。特别注意了。
5.getElementByTagName(&amp;ldquo;标签&amp;rdquo;)，这个里面输入的是HTML的标签。
6.对于元素节点的nodeName，其返回值永远是大小的标签。
7.忘记nodeValue吧，使用value就够了，前面的需要区分下。
8.value这个属性可读可写。
9.对于使用firstChild和lastChild不是我们所见的第一个。这个特别注意了。
10.通常来说firstNode和lastNode获取的是文本节点。
11.对于文本节点，如果要设置他的值，需要使用nodeValue而不是value。比如说firstChild和lastChild获取的都是属于文本节点。
12.为某一个节点添加 可以使用innderHtml也可以使用 创建一个TextNode然后添加到某个节点上去。
13.对于replaceChild，parentNode.replaceChild(newChild，childInParane).这个方法的作用是父节点调用替换某个子节点，第一个节点一般都是新的节点，第二个节点
14.几个不加括号的地方:
window.onload=function myFunc(){&amp;hellip;}
15.在JS中，方法带了括号表示运行。
16.
三、问题
2.innerHtml和innerText的区别？
3.window.onload=function(){} 在一个页面只能写一次。
4.关于parenNode和parentElement区别？&lt;/p&gt;
&lt;p&gt;2.innerHtml和innerText的区别？
从字面意义来讲 innerHtml操作标签内的html代码 , 而innerText操作标签内的文本 , 当标签内只有文本时这两个方法是一样的 , 区别就在标签内还要子标签时,写代码测试就知道了&lt;/p&gt;
&lt;p&gt;3.window.onload=function(){} 在一个页面只能写一次。
这个是&amp;quot;重量级&amp;quot;的加载完成事件 , 只能注册一次,jQuery的ready()就很方便&lt;/p&gt;
&lt;p&gt;4.关于parenNode和parentElement区别？
parentNode 是Node类的属性 , 而parentElement是Element类的属性 , 很多情况下可以通用,只是属于两个不同的体系,使用时尝试着看看效果就好&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;
&amp;lt;Html&amp;gt;
&amp;lt;Head&amp;gt;

&amp;lt;!--script 一定要小写--&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
//javascript内部注释使用//表示单行注释  /**/表示快注释
//javascript大小写敏感
//javascript可以用var表示所有数值类型，代替int,String,boolean等
//按F5刷新，进行调试
//变量和数组的定义
//变量定义


var name=&#39;字符串&#39;;
var age=39;

//数组定义
//一定要数组用  [] 进行定义，元素之间用逗号隔开   []吃过亏
//map数组用{} 定义 键值对之间用逗号隔开
var apples=[&#39;ap1&#39;,&#39;ap2&#39;];
var arr={&amp;quot;name&amp;quot;:&#39;张三&#39;,&#39;age&#39;:45};

//打印alert
alert(name);
alert(age);
for(var i=0;i&amp;lt;apples.length;i++)
{
    alert(apples[i]);
}

for(var key in arr)
{
    alert(key+&#39;===&#39;+arr[key]);
}

//数值类型的转换
var n = &#39;fsf&#39;;
if(isNaN(n))
  {
    alert(&#39;不能使用&#39;);
  }else
    {
      alert(&#39;可以使用&#39;);
    }
var num=&#39;100&#39;
var n = Number(num);
alert(n);

alert(parseFloat(&#39;100.3&#39;));//转小数
alert(parseInt(&#39;100&#39;))//转整数

//函数定义  及参数获取
// 在浏览器的源码窗口中 ，加入 断点，进行断点调试,单步调试(F8 快捷键 在Opera中）

function sum()
{
  var apple=0;
  //循环语句的使用
  //内置变量arguments的调用
  for(var i=0;i&amp;lt;arguments.length;i++)
  {
    apple+=arguments[i];
  }
  //不加入return 没有返回值 则sumofmoney=undefined
  return apple;
}

var sumOfMoney=sum(1,3,4,5,6,2);
alert(&#39;1+2+3+4+5+6+2==&#39;+sumOfMoney);


//注意转义字符
alert(&amp;quot;D:\\Program Files \\ok\\fd&amp;quot;);
alert(&#39;D:\\Program Files \\ok\\fd&#39;);


//匿名方法是需要着重学习的
//1
var ff = function()
{
  alert(&#39;go home!&#39;);
}
ff();

//一个易错点
//btn.onclick=function(){} onclick后面不能家少年宫()
//2
(function(n1,n2)
{
   alert(n1+n2);
}
)(1,2);
//3
onload=function()
{
  document.getElementById(&#39;btn&#39;).onClick=function()
  {
    alert(&amp;quot;You are clicking  the button&amp;quot;)
  }
};



//字符串的常用方法
alert(&#39;I am from the God&#39;.length);
alert(&#39;I am from the God&#39;.charAt(3));
alert(&#39;I am from the God&#39;.charAt(9));
alert(&#39;I am from the God&#39;.substring(3,9));
alert(&#39;I am from the God&#39;.indexOf(&#39;t&#39;));
var  names = &#39;I am from the God&#39;.split(&#39; &#39;);
for(var name in names)
  {
    alert(name+&#39;=&#39;+names[name]);
  }
for(var i=0;i&amp;lt;names.length;i++)
{
  alert(names[i]);
}

//杨老师练习1
alert(&#39;杨1&#39;);
window.onload=function()
{
  var buttons=document.getElementsByName(&#39;button1&#39;);
  for(var i=0;  i &amp;lt; buttons.length;i++)
  {
    //alert(buttons[i]   onclick不能写成onClick  大小写敏感
    buttons[i].onclick=function()
    {
        alert(i);
    };
  }
}
//杨老师练习2
alert(&#39;杨2&#39;);
function aa()
{
  alert(&#39;aaa&#39;);
  return function(){alert(&#39;bbb&#39;);};
}
alert(aa);
alert(aa());
// alert(aa());打印是aaa,和function(){alert(&amp;quot;bbb&amp;quot;);}以为执行函数方法题内容,返回的是一个匿名函数,返回的是函数体字符串. 
alert(aa()());
//alert(aa()());打印的是aaa,bbb,undefined ,先执行aa()，函数体内容aaa，返回字符串function(){alert(&amp;quot;bbb&amp;quot;);}，再执行function(){alert(&amp;quot;bbb&amp;quot;);}()，
//这时该方法名是：function(){alert(&amp;quot;bbb&amp;quot;);}，先打印bbb，在打印undefined，因为该方法名未定义， 
//杨老师练习3
alert(&#39;杨3&#39;);
//每隔1s重复的执行  烦人，注释掉
//setInterval(aa,1000);
//setInterval(aa(),1000);
//杨老师练习4
alert(&#39;杨4&#39;);
//setInterval(alert(&#39;a&#39;),1000); //每隔1s显示a
//setInterval(function(){alert(&amp;quot;a&amp;quot;);},1000);  //返回一个函数 因为未被执行，这个函数没有任何东西
//杨老师练习5
alert(&#39;杨5&#39;);
var s1=&amp;quot;aaa&amp;quot;;
var s2=new String(&amp;quot;aaa&amp;quot;);
alert(s1 instanceof Object); //false
alert(s2 instanceof Object);//true
alert(s1 instanceof String);//false
alert(s2 instanceof String);// true
alert(typeof(s1));  //string
alert(typeof(s2)); //object
//杨老师练习6
alert(&#39;杨6&#39;);
var x=1;
var y=0;
var z=0;
function add(n)
{
  n=n+1;
  return n;
}
y=add(x);
//js只会用最新的函数定义
function add(n)
{
  n=n+3;
  return n;
}

z=add(x);
alert(&#39;y=&#39;+y+&#39;z=&#39;+z);//y-4  z=4  只用最新的
//杨老师练习7
alert(&#39;杨7&#39;);
var add1=function(n)
{
   n = n+1;
   return n;
}
y=add1(x);
add1 =function(n)
{
  n= n +3;
  return n;
}
z= add1(x);
alert(&#39;y=&#39;+y+&#39; z=&#39;+z);
//杨老师练习8
alert(&#39;杨8&#39;);
var s1=&amp;quot;aaa&amp;quot;; // --------------------&amp;gt;是String类型 非对象
var s2= new String(&#39;aaa&#39;);
alert(s1 instanceof Object);
alert(s2 instanceof Object);
alert(s1 instanceof String);
alert(s2 instanceof String);
alert(typeof(s1));
alert(typeof(s2));


//杨老师练习9
alert(&#39;杨9&#39;);
alert(&#39;易错点： btn.onclick=function(){}  onclick后面别跟()&#39;)

&amp;lt;/script&amp;gt;

&amp;lt;/Head&amp;gt;

&amp;lt;Body&amp;gt;
  &amp;lt;Div&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;button1&amp;quot; value=&amp;quot;按钮1&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;button1&amp;quot; value=&amp;quot;按钮2&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;button1&amp;quot; value=&amp;quot;按钮3&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;button1&amp;quot; value=&amp;quot;按钮4&amp;quot;/&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;button1&amp;quot; value=&amp;quot;按钮5&amp;quot;/&amp;gt;
  &amp;lt;/Div&amp;gt;
  &amp;lt;Div&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;click&amp;quot; id=&amp;quot;btn&amp;quot;/&amp;gt;
  &amp;lt;/Div&amp;gt;
  &amp;lt;Div&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;Br/&amp;gt;
    &amp;lt;A href=&amp;quot;javascript:alert(new Date().toLocaleTimeString());&amp;quot;&amp;gt;显示时间&amp;lt;/A&amp;gt;
    &amp;lt;/Br&amp;gt;
    &amp;lt;A href=&amp;quot;javascript:void(0);&amp;quot;&amp;gt;显示时间&amp;lt;/A&amp;gt;
    &amp;lt;/Br&amp;gt;
    &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;显示时间&amp;quot;,onclick=&amp;quot;alert(new Date().toLocaleTimeString());&amp;quot;/&amp;gt;
  &amp;lt;Div&amp;gt;
&amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;为什么jquery.js有那么多的&lt;br&gt;
name : function(){}, 的写法？ 他们是什么意思？&lt;/p&gt;
&lt;p&gt;JQuery.js中出现如下的书写方式：&lt;/p&gt;
&lt;p&gt;success：function(data){}
类似于function success(data){}
不过是面向对象的写法，把这个方法当成一个prototype对象&lt;/p&gt;
&lt;p&gt;引入JSON对象
JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式，易于阅读和编写，同时也易于机器解析和生成。{a:&amp;ldquo;a&amp;rdquo;}这就是一
个JSON数据。 JSON数据是用键值对的形式存储的。冒号（:）前面的是键，冒号后面的是值。JSON,的每一个值之间可以用分号（;）隔
开。大的类可以用{}大括号包围他其中的值，集合可以用[]中括号，包围值
&amp;ldquo;名称/值&amp;quot;对的集合 不同语言中，它被理解为对象(object)，记录(record)，结构(struct)，字典(dictionary)，哈希表(hash table)，键列表(keyed list)等
值的有序列表 多数语言中被理解为数组(array)&lt;/p&gt;
&lt;p&gt;使用：
JSON以一种特定的字符串形式来表示 JavaScript 对象。如果将具有这样一种形式的字符串赋给任意一个 JavaScript 变量，那么该变&lt;/p&gt;
&lt;p&gt;量会变成一个对象引用.
比如：
您可以使用以下JSON形式来表示User对象：
{&amp;ldquo;UserID&amp;rdquo;:11, &amp;ldquo;Name&amp;rdquo;:&amp;ldquo;tht&amp;rdquo;, &amp;ldquo;Email&amp;rdquo;:&amp;ldquo;18039010◎qq.com&amp;rdquo;};
然后如果把这一字符串赋予一个JavaScript变量，那么就可以直接使用对象的任一属性了。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
        var User={&amp;quot;UserId&amp;quot;:11,&amp;quot;Name&amp;quot;:&amp;quot;Ye Zhaoliang&amp;quot;,&amp;quot;Email&amp;quot;:&amp;quot;977962857@qq.com&amp;quot;};
        alert(User.Name);

        //利用JSon对象方式  定义两个User对象
        var User1={&amp;quot;UserId&amp;quot;:12,&amp;quot;Name&amp;quot;:{&amp;quot;FirstName&amp;quot;:&amp;quot;Ye&amp;quot;,&amp;quot;LastName&amp;quot;:&amp;quot;Zhaoliang&amp;quot;},&amp;quot;Email&amp;quot;:&amp;quot;977962857@qq.com&amp;quot;};
        var User2={&amp;quot;UserId&amp;quot;:13,&amp;quot;Name&amp;quot;:{&amp;quot;FirstName&amp;quot;:&amp;quot;Ye&amp;quot;,&amp;quot;LastName&amp;quot;:&amp;quot;Wangliang&amp;quot;},&amp;quot;Email&amp;quot;:&amp;quot;977962859@qq.com&amp;quot;};
        alert(User1.Name.LastName+&amp;quot; love you!&amp;quot;);

        //用数组存储一个用户列表
        var Users=[User1,User2];
        alert(Users.length);
        for(var i=0;i&amp;lt;Users.length;i++)
        {
          alert(Users[i].UserId+&amp;quot; &amp;quot;+Users[i].Name.LastName);
        }
    &amp;lt;/script&amp;gt;
  &amp;lt;/Head&amp;gt;
  &amp;lt;Body&amp;gt;

  &amp;lt;/Body&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由此引出面向对象的JavaScript编程。&lt;/p&gt;
&lt;p&gt;![./image/java/object.gif][JSON对象的格式描述，用逗号分隔开多个对象，一个对象用{}组合，每个对象的属性用:分隔，冒号前面表示属性 &amp;hellip;]&lt;/p&gt;
&lt;p&gt;![./image/java/array.gif][用[]表达多个数组元素，元素之间不分类型，用逗号分隔元素]&lt;/p&gt;
&lt;p&gt;1: JS中单引号和双引号有什么区别？为什么在字符串中用单引号括起来，而不是双引号？
一方面因为Html代码的属性值一般是使用双引号。
JSON的数据格式一般是使用双引号的。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;       再进行字符串拼接的一般原则是： 单引号的内部可包含双引号（如若包含则加转义字符），双引号的内部可包含单引号（如若包含则加转义字符）
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所以字符串如果用单引号修饰就可以内部引用Html的属性。
比如&lt;/p&gt;
&lt;Div class=&#34;global-notify&#34; id=&#34;global-message&#34;&gt;
var str=&#39;&lt;Div class=&#34;global-notify&#34; id=&#34;global-message&#34;&gt;&#39;
复制代码
更多的是考虑到前端，会使用HTML的属性值，而Html的属性值都是用双引号包裹，所以如果再用单引号括起来不需要进行转义。
另外可能就是大家习惯。
&lt;p&gt;2：Javascript也有事件编程&lt;/p&gt;
&lt;p&gt;button中的onclick=&amp;ldquo;js代码&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&amp;lt;input type=“button” onclick=“ js代码&amp;rdquo; /&amp;gt;
复制代码&lt;/p&gt;
&lt;p&gt;href超链接的特殊的调用事件的方法：&lt;/p&gt;
&lt;p&gt;&lt;a href=“javascript:js代码”&gt;热点文字&lt;/a&gt;
复制代码&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;      只有超链接的href中的JavaScript中才需要加“javascript:”，因为它不是事件，而是把”javascript:”看成像“http:”、“ftp:”、“thunder://”、“ed2k://”、“mailto:”一样的网络协议，交             由js解析引擎处理。只有href中，这是一个特例。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3：数据类型
基本数据类型：
Boolean
Number   &amp;mdash;-&amp;gt;小数和整数
&amp;mdash;-parseInt(&#39;&#39;)
&amp;mdash;-parseFloat(&#39;&#39;)
String
Null  &amp;mdash;-&amp;gt;
Undefined &amp;mdash;&amp;gt;未定义(未初始化)
var ul ;    &amp;mdash;&amp;gt;ul is undefined
typeof(ul) &amp;mdash;-&amp;gt;undefined
typeof(null)&amp;mdash;-&amp;gt;null&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  == 非严格等于
  ===严格等于
     null==undefined -----&amp;gt;true
     null===undefined-----&amp;gt;false
      为什么？
      ===先判断类型是否一致，再判断值
       null对象是有着特殊意义的值，此时变量的值是&amp;quot;已知状态&amp;quot;(这和mysql的null不太一样，mysql直接就是不知道，那肯定就是无法判断）
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;引用数据类型：
Object &amp;mdash;-&amp;gt;函数
&amp;mdash;-&amp;gt; new Date()
&amp;mdash;-&amp;gt; 数组    var apple=[&amp;lsquo;shanxi&amp;rsquo;,&amp;lsquo;yantai&amp;rsquo;];
&amp;mdash;-&amp;gt;null&lt;/p&gt;
&lt;p&gt;方法：
instanceof &amp;mdash;&amp;ndash;&amp;gt;属于某种类型？
typeof(object) &amp;mdash;&amp;mdash;-&amp;gt;是什么类型的？&lt;/p&gt;
&lt;p&gt;4：javascript中没有方法重载&lt;/p&gt;
&lt;p&gt;所以在运行时候会事先确定好函数，一般是最靠近调用函数的函数定义
function f1()
{
alert(&amp;lsquo;ell&amp;rsquo;);
}
function f1(name)
{
alert(name);
}
// f1();  得到undefined  ，直接选择最新的当做 f1的函数
//这点和java很不一样
f1(&amp;lsquo;fd&amp;rsquo;); //得到fd
复制代码&lt;/p&gt;
&lt;p&gt;5：String  Boolean  Number 等可以拓展其方法，使用类的静态属性prototype进行设置
比如：
String.prototype.IseMaile = function ()
复制代码&lt;/p&gt;
&lt;p&gt;6：js文件引入javascript的好处是?      1:多文档共享  js
2:减少网络流量&lt;/p&gt;
&lt;p&gt;使用方法 ： &amp;lt;Link src=&amp;quot;*.js&amp;quot; type=&amp;ldquo;text/javascript&amp;rdquo;&lt;/p&gt;
&lt;p&gt;存在疑问：Dom  and Bom的区别？&lt;/p&gt;
&lt;p&gt;Broser object model (BOM)
Document object model(Dom)
Bom模型有window对象  ，而Dom没有。&lt;/p&gt;
&lt;p&gt;Bom对象结构：&lt;/p&gt;
&lt;p&gt;Window  &amp;mdash; document  &amp;mdash;&amp;mdash;authors
&amp;mdash;&amp;mdash;forms
&amp;mdash;&amp;mdash;images
&amp;mdash;&amp;mdash;-links
&amp;mdash;&amp;mdash;-location &amp;hellip;
&amp;mdash;- frames
&amp;mdash;- history
&amp;mdash;- location
&amp;mdash;- navigator
&amp;mdash;- screen
根节点是：window
window对象是Bom模型的核心，包含6个对象，document,frames,history,location,navigator,screen对象&lt;/p&gt;
&lt;p&gt;Dom对象结构：&lt;/p&gt;
&lt;p&gt;document  &amp;mdash;&amp;mdash;authors
&amp;mdash;&amp;mdash;forms
&amp;mdash;&amp;mdash;images
&amp;mdash;&amp;mdash;-links
&amp;mdash;&amp;mdash;-location&amp;hellip;&lt;/p&gt;
&lt;p&gt;根节点是:document&lt;/p&gt;
&lt;p&gt;联系：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;document.write(&#39;test&#39;);
window.document.write(&#39;test&#39;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;![./images/java/dom.png][某个dom的树状节点层次图（可以进行实例化]&lt;/p&gt;
&lt;p&gt;14.this事件
事件中的this。除了可以使用event.srcElement&lt;/p&gt;
&lt;p&gt;在事件响应函数中，this表示发生事件的控件。&lt;/p&gt;
&lt;p&gt;只有在事件响应函数才能使用this获得发生事件&lt;/p&gt;
&lt;p&gt;的控件，在事件响应函数调用的函数中不能使用&lt;/p&gt;
&lt;p&gt;（这里的this表示window对象），如果要使用则&lt;/p&gt;
&lt;p&gt;要将this传递给函数或者使用event.srcElement&lt;/p&gt;
&lt;p&gt;。(*)this和event.srcElement的语义是不一样&lt;/p&gt;
&lt;p&gt;的，this就是表示当前监听事件的这个对象，&lt;/p&gt;
&lt;p&gt;event.srcElement是引发事件的对象：事件冒泡&lt;/p&gt;
&lt;p&gt;。&lt;/p&gt;
&lt;p&gt;14.动态创建元素
Element(元素)
document.write只能在页面加载过程中才能动态&lt;/p&gt;
&lt;p&gt;创建。
可以调用document的createElement方法来创建&lt;/p&gt;
&lt;p&gt;具有指定标签的DOM对象，然后通过调用某个元素&lt;/p&gt;
&lt;p&gt;的appendChild();方法将新创建元素添加到相应&lt;/p&gt;
&lt;p&gt;的元素下。//父元素对象.removeChild(子元素&lt;/p&gt;
&lt;p&gt;对象);删除元素。
createElement(‘element’);创建一个节点
appendChild(node); 追加一个节点
removeChild(node);移除一个节点
replaceChild(new,old);替换一个节点
insertBefore(new,参照);把节点加到前面（插&lt;/p&gt;
&lt;p&gt;到某个节点前面）
方法：
属性：
firstChild
lastChild&lt;/p&gt;
&lt;p&gt;15.getElementsByTagName() 方法可返回带有指&lt;/p&gt;
&lt;p&gt;定标签名的对象的集合。
16.IE中body的事件范围
IE中如果在body上添加onclick、onmousemove等&lt;/p&gt;
&lt;p&gt;事件响应，那么如果页面没有满，则 “body 中&lt;/p&gt;
&lt;p&gt;最后一个元素以下（横向不限制）” 的部分是无&lt;/p&gt;
&lt;p&gt;法响应事件的，必须使用代码在document上监听&lt;/p&gt;
&lt;p&gt;那些事件，比如document.onmousemove =&lt;/p&gt;
&lt;p&gt;MovePic
document.body.onmousedown=function(){}
document.onmousedown=function(){}
注意加文档定义与不加文档定义的也不一样。
如果为整个文档注册事件可以使用：&lt;/p&gt;
&lt;p&gt;document.onxxxx事件。
17.onmouseover事件会在鼠标指针移动到指定的&lt;/p&gt;
&lt;p&gt;对象上时触发事件发生
element.setAttribute()        把指定属性设置或更&lt;/p&gt;
&lt;p&gt;改为指定值。
18. dvObj.style.width=&amp;lsquo;300px&amp;rsquo;;
dvObj.style.height=&amp;lsquo;200px&amp;rsquo;;
dvObj.style.border=&amp;lsquo;1px solid red&amp;rsquo;;
加&#39;&amp;lsquo;的是因为给变量赋值必须是一个正确的类型&lt;/p&gt;
&lt;p&gt;。数字就是数字字符串就是字符串
19.&lt;p&gt; 标签定义段落。
border:1px solid green; 边框：1像素，实心&lt;/p&gt;
&lt;p&gt;，绿色
20.form对象
document.getElementById(‘btn1’).click()&lt;/p&gt;
&lt;p&gt;。搜索引擎的，智能提示，点击后相当于点击了&lt;/p&gt;
&lt;p&gt;“搜索”按钮。
常用：click(),focus(),blur();//相当于通过&lt;/p&gt;
&lt;p&gt;程序来触发元素的单击、获得焦点以及失去焦点&lt;/p&gt;
&lt;p&gt;的事件。
form对象是表单的Dom对象。
方法：submit()提交表单，但是不会触发&lt;/p&gt;
&lt;p&gt;onsubmit事件。
实现autopost，也就是焦点离开控件以后页面立&lt;/p&gt;
&lt;p&gt;即提交，而不是只有提交submit按钮以后才提交&lt;/p&gt;
&lt;p&gt;，当光标离开的时候触发onblur事件，在onblur&lt;/p&gt;
&lt;p&gt;中调用form的submit方法。
在点击submit后form的onsubmit事件被触发，在&lt;/p&gt;
&lt;p&gt;onsubmit中可以进行数据校验，如果数据有问题&lt;/p&gt;
&lt;p&gt;，返回false即可取消提交&lt;/p&gt;
&lt;p&gt;21.不同浏览器的差异&lt;/p&gt;
&lt;form&gt; 标签用于为用户输入创建 HTML 表单。
&lt;p&gt;表单能够包含 input 元素，比如文本字段、复选&lt;/p&gt;
&lt;p&gt;框、单选框、提交按钮等等。表单还可以包含&lt;/p&gt;
&lt;p&gt;menus、textarea、fieldset、legend 和&lt;/p&gt;
&lt;p&gt;label 元素。表单用于向服务器传输数据。
onsubmit 事件会在表单中的确认按钮(Submit)被点击时发生。
submit() 提交表单。 是form中的一个方法
onsubmit 在提交表单之前调用。是一个事件&lt;/p&gt;
&lt;p&gt;1: js的for循环的var i = 0的再认识
经过var定义的是一个全局变量&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;        //一个重要错误   var i =0 其实就是定义了一个全局变量i = 0
        //所有的js都可以调用
        for(var i=0;i&amp;lt;Users.length;i++)
        {
          alert(Users[i].UserId+&amp;quot; &amp;quot;+Users[i].Name.LastName);
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也就是for之后alert(i)的值是 Users.length&lt;/p&gt;
&lt;p&gt;所以可以在for之前直接定义 var i = 0;即可&lt;/p&gt;
&lt;p&gt;2：以二进制读取，10进制输出&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;        alert(parseInt(&#39;100&#39;,8));//以8进制
        alert(parseInt(&#39;100&#39;,2));// 以2进制读取，并10进制显示
        alert(parseInt(&#39;100&#39;,10));// 以10进制 默认方式
        alert(parseInt(&#39;100&#39;,16));// 以16进制

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3： onload在页面加载完后在加载的部分js&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;        //很重要  onload  只在页面加载完控件才执行，所以确保id有效！！
        //否则可能报错
        onload=function()
        {
          document.getElementById(&#39;btn&#39;).onclick=function()
          {
            alert(&#39;hello&#39;);
          };
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4：Html的事件在学习&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;      &amp;lt;Input type=&amp;quot;button&amp;quot; name=&amp;quot;time&amp;quot; value=&amp;quot;show current time&amp;quot; onclick=&amp;quot;alert(new Date().toLocaleTimeString());&amp;quot;/&amp;gt;
      &amp;lt;!--会跳转到最前面   #z只是一个页面最前面的一个锚--&amp;gt;
      &amp;lt;A href=&amp;quot;#&amp;quot; onclick=&amp;quot;alert(new Date().toLocaleTimeString());&amp;quot;&amp;gt;百度&amp;lt;/A&amp;gt;
      &amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;
&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;
&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;
&amp;lt;!--直接在当前位置打印出时间： javascript: 类似于http://  ftp://--&amp;gt;
&amp;lt;A href=&amp;quot;javascript:alert(new Date().toLocaleTimeString());&amp;quot;&amp;gt;网易&amp;lt;/A&amp;gt;
&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;
&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;
&amp;lt;A href=&amp;quot;javascript:void(0);&amp;quot; onclick=&amp;quot;alert(new Date().toLocaleTimeString());&amp;quot;&amp;gt;新浪&amp;lt;/A&amp;gt;
&amp;lt;A href&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>javascript闭包训练</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/javascriptbi-bao-xun-lian/</link>
      <pubDate>Mon, 11 May 2015 14:58:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/javascriptbi-bao-xun-lian/</guid>
      <description>&lt;p&gt;javascript  闭包训练&lt;/p&gt;
&lt;p&gt;闭包其实就是保存着内部定义函数的一张表，该表保存着函数头、函数变量（变量当前状态的值）、函数实现。&lt;/p&gt;
&lt;p&gt;利用  一个outFun 和一个innerFun进行实验《Learning jQuery 4th edition》&lt;/p&gt;
&lt;p&gt;case 1:  闭包传递，内部函数可以被传递到外头&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;      $(function(){
        //函数被封在一个闭包中 可以像数据一样传来传去
        var globalInner;
        function outFun()
        {

          console.log(&#39;Inside the outFun&#39;);
          function innerFun()
          {
            console.log(&#39;inside the innerFun of the OutFun&#39;);
          }
          globalInner=innerFun;
          console.log(&#39;innerFun():&#39;);
          innerFun();
          console.log(&#39;return Begin&#39;)
          return innerFun;
        }

        console.log(&#39;outFun:&#39;)
        outFun();
        console.log(&#39;globalInner:&#39;);
        globalInner();
        console.log(&#39;Test outFun return&#39;);
        outFun()();

      }) ;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码
测试结果：&lt;/p&gt;
&lt;p&gt;outFun:
TestCloser.html:12 Inside the outFun
TestCloser.html:18 innerFun():
TestCloser.html:15 inside the innerFun of the OutFun
TestCloser.html:20 return Begin
TestCloser.html:26 globalInner:
TestCloser.html:15 inside the innerFun of the OutFun
TestCloser.html:28 Test outFun return
TestCloser.html:12 Inside the outFun
TestCloser.html:18 innerFun():
TestCloser.html:15 inside the innerFun of the OutFun
TestCloser.html:20 return Begin
TestCloser.html:15 inside the innerFun of the OutFun
复制代码&lt;/p&gt;
&lt;p&gt;case 2:  内部变量 和外部变量的区别&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;      $(function(){
        console.log(&#39;测试InnerFunPig的局部变量&#39;);
        //局部变量是存在的
        //alert(&#39;hhell&#39;);
        function outFunPig()
        {

          function innerFunPig()
          {
            //局部变量 重新赋值
            var innerVar=1;
            console.log(&#39;innerVar:&#39;+innerVar);
            innerVar++;

          }
          return innerFunPig;
        }

        var out1= outFunPig();
        out1();
        out1();
        var out2= outFunPig();
        out2();
        out2();

        console.log(&#39;测试outFunCat的全局变量&#39;);
        //测试全局变量
        var globalVar=1;
        function outFunCat()
        {

          function innerFunCat()
          {
            //局部变量 重新赋值
            console.log(&#39;innerVar:&#39;+ globalVar);
            globalVar++;

          }
          return innerFunCat;
        }

        var out3= outFunCat();
        out3();
        out3();
        var out4= outFunCat();
        out4();
        out4();

        console.log(&#39;测试outFunDog的内部变量&#39;);
        //测试半全局变量
        function outFunDog()
        {

          //半全局变量
          var semiGlobalVar=1;
          function innerFunDog()
          {
            //局部变量 重新赋值
            console.log(&#39;innerVar:&#39;+ semiGlobalVar );
             semiGlobalVar++;

          }
          return innerFunDog;
        }

        var out5= outFunDog();
        out5();
        out5();
        var out6= outFunDog();
        out6();
        out6();



      });
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;测试结果2：
测试InnerFunPig的局部变量
4TestCloser.html:44 innerVar:1
TestCloser.html:58 测试outFunCat的全局变量
TestCloser.html:67 innerVar:1
TestCloser.html:67 innerVar:2
TestCloser.html:67 innerVar:3
TestCloser.html:67 innerVar:4
TestCloser.html:81 测试outFunDog的内部变量
TestCloser.html:91 innerVar:1
TestCloser.html:91 innerVar:2
TestCloser.html:91 innerVar:1
TestCloser.html:91 innerVar:2
复制代码&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Java班 1月24日</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/javaban-1yue-24ri/</link>
      <pubDate>Mon, 11 May 2015 14:58:43 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/javaban-1yue-24ri/</guid>
      <description>&lt;p&gt;第一题：合并图片&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import java.io.*;
public class TestCopyTwoFilesToOne implements AutoCloseable
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                File inputFileApple = new File(&amp;quot;e://a.jpg&amp;quot;);
                File inputFileBanana = new File(&amp;quot;e://b.jpg&amp;quot;);
                File inputFileOrange = new File(&amp;quot;e://c.jpg&amp;quot;);
                String temp = null;
                try
                (
                        //字节流
                        InputStream  fisApple= new FileInputStream(inputFileApple);
                        InputStream  fisBanana= new FileInputStream(inputFileBanana);
                        OutputStream  fosOrange= new FileOutputStream(inputFileOrange);
                        // 缓冲流（已通过字符流转换）
                        BufferedReader brApple =  new BufferedReader(new InputStreamReader(fisApple));
                        BufferedReader brBanana =  new BufferedReader(new InputStreamReader(fisBanana));
                        BufferedWriter brOrange =  new BufferedWriter(new OutputStreamWriter(fosOrange));
                )
                {
                        while((temp = brApple.readLine()) != null)
                        {        
                                brOrange.write(temp); // 写入第一个文件
                                brOrange.newLine();
                        }
                        while((temp = brBanana.readLine()) != null)
                        {        
                                brOrange.write(temp);//写入第二个文件信息
                                brOrange.newLine();
                        }
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;文件读取或者写入错误&amp;quot;);
                }
        }

        @Override
        public void close() throws Exception
        {
                // TODO 自动生成的方法存根
                
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第一题合并图片第二种方法&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import java.io.*;

import org.apache.commons.io.FileUtils;
public class TestCopyTwoFilesToOne2
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                try
                {
                        // FileUtils暂时无法实现追加！
                        //FileUtils.copyFile(new File(&amp;quot;e:/a.jpg&amp;quot;), new File(&amp;quot;e://c.jpg&amp;quot;));
                        //FileUtils.copyFile(new File(&amp;quot;e:/b.jpg&amp;quot;), new File(&amp;quot;e://c.jpg&amp;quot;), true);
                        // 对于大文件可能有问题
                        //利用FileUtils的readFileToString方法读取a.jpg文件的数据，并保存在content中
                        String content = FileUtils.readFileToString(new File(&amp;quot;e:/a.jpg&amp;quot;));

                        // 利用FileUtils的writeStringToFIle方法，借用content中间变量写入a.jpg文件信息到c.jpg
                        // 也可以利用FileUtils的copyFile方法，直接复制到c.jpg.
                        FileUtils.writeStringToFile(new File(&amp;quot;e://c.jpg&amp;quot;), content);
                        // //利用FileUtils的readFileToString方法读取b.jpg文件的数据，并保存在content中
                        content = FileUtils.readFileToString(new File(&amp;quot;e:/b.jpg&amp;quot;));
                        FileUtils.writeStringToFile(new File(&amp;quot;e://c.jpg&amp;quot;), content,true);
                } catch (IOException e)
                {
                        // TODO 自动生成的 catch 块
                        System.out.println(&amp;quot;写入文件错误！&amp;quot;);
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第二题：把文件夹下所有的txt  文件变为doc文件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.File;

/**
* @author 叶昭良
*
*/
public class RenameDirectoryFiles
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                String roots = &amp;quot;e:&amp;quot;;         //盘符
                String Testfile =&amp;quot;TestFile&amp;quot;; //文件夹
                String targetDir = roots+File.separator+Testfile;
                reNameUnderDirectory(new File(targetDir),&amp;quot;.java&amp;quot;,&amp;quot;.txt&amp;quot;); //调用自定义方法
        }
        
        public static void reNameUnderDirectory(File dir,String from, String to)
        {
                if(null == dir)
                {
                        return; //为空则直接退出
                }
                if(dir.isDirectory())                // 通过路径读入,给定一个路径
                { 
                       //抵用File的listFiles方法获取文件夹下的所有File对象
                        File[] fileArray = dir.listFiles(); 
                        String banana = null;
                        if(null == fileArray)          // 判断是否为空
                        {
                                System.out.println(&amp;quot;文件夹内文件为空  找个别的文件夹吧！&amp;quot;);
                                return;
                        }
                        for(int i = 0 ; i&amp;lt; fileArray.length; i++)  // 遍历所有文件
                        {
                                if(fileArray[i].isFile())             // 判断是否是文件
                                {
                                        banana = fileArray[i].getName(); //获取文件对象的文件名
                                        if(banana.endsWith(from))        // 只是对以java文件结尾的进行修改
                                        {
                                                String newFilename= fileArray[i].getParent()+File.separator
                                                        +banana.replaceAll(from+&amp;quot;[        DISCUZ_CODE_1        ]quot;;, to); //只替换最后一个from表征的字符串
                                                fileArray[i].renameTo(new File(newFilename)); // 利用renameTo方法 修改文件夹的名字
                                        }
                                }else
                                {
                                        reNameUnderDirectory(fileArray[i],from,to); //递归调用该方法 实现遍历文件夹
                                }
                        }
                }else
                {
                        System.out.println(&amp;quot;不是文件夹&amp;quot;);
                }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第三题：后缀修改（Directory walker):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import java.io.*;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Iterator;
import java.util.List;

import org.apache.commons.io.DirectoryWalker;
public class TestCommonIODirectoryWalkRename extends DirectoryWalker
{

        /**
         * @param args
         */
        public TestCommonIODirectoryWalkRename() 
        {
                     super();
    }
        public List reName(File startDirectory) 
        {
                List results = new ArrayList();
                try
                {
                        walk(startDirectory,results        );
                } catch (IOException e)
                {
                        // TODO 自动生成的 catch 块
                        e.printStackTrace();
                }
                return results;
        }
        
        protected boolean handleDirectory(File directory,int depth,Collection results)
        {
                //save.svn directories and then skip 不会删除.svn文件夹下的任何信息
                if(&amp;quot;fasf&amp;quot;.equals(directory.getName())) // 如果你想要保存某个文件夹
                                                        //就添加elseif即可！！当然文件架构还在
                {
                        directory.delete();
                        return false;
                }else
                {
                        return true;
                }
        }
        
        protected void handleFile(File file,int depth, Collection results)
        {
                String banana = file.getName();
                String newFilename= file.getParent()+File.separator+banana.replaceAll(&amp;quot;.txt&amp;quot;+&amp;quot;$&amp;quot;, &amp;quot;.doc&amp;quot;);
                file.renameTo(new File(newFilename));
                results.add(file);
        }
        // 使用Directory Walker来遍历一个目录并进行相应操作步骤如下
        // 1:创建一个继承DirectoryWalker的类，并在构造函数调用super()
        // 2:定义一个业务入口方法，比如clean，这个方法调用walk方法
        // 3:重写handleDiretory方法  提供相应的业务逻辑
        // 4:重写handleFile方法，提供相应处理逻辑
        
        // 其中最为关键的是walk方法，该方法制定入口路径，
        // 并提供一个用于接受处理结构的参数。
        // 在walk方法的内部：针对目录对象调用handleDirectory
        //                       文件对象调用handleFile
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                TestCommonIODirectoryWalkRename dw = new TestCommonIODirectoryWalkRename() ;
                List l1 = dw.reName(new File(&amp;quot;e://codes&amp;quot;));
                Iterator it = l1.iterator();
                while(it.hasNext())
                {
                        System.out.println(it.next());
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第四题：读取文本文件，并统计数字字符的个数查阅了ASCII表信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import java.io.*;
public class getDigtiNumberCount
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                // TODO 自动生成的方法存根

                String  temp = null;
                String roots = &amp;quot;e:&amp;quot;;
                String filename = &amp;quot;student.txt&amp;quot;;
                String filenameWithPathname=roots+File.separator+filename;
                int len = 0;
                try  // try_with_resources方法，不需要关闭需要closed的资源。
                (
                        BufferedReader br = new BufferedReader(new FileReader(filenameWithPathname));                           
                )
                {
                        int  i = 0;
                        int count = 0;
                        while((temp = br.readLine()) != null)
                        {
                                System.out.println(&amp;quot;打印一行&amp;quot;);
                                System.out.println(temp);
                                for(int  j = 0 ;  j  &amp;lt; temp.length(); j++)
                                {//进行数字字符的区间范围判断 
                                        if(temp.charAt(j) &amp;gt;= 48 &amp;amp;&amp;amp; temp.charAt(j) &amp;lt;= 57)
                                        {
                                                count++;
                                        }
                                }
                                i++;
                        }
                        System.out.println(filenameWithPathname+&amp;quot;文件总

共有：&amp;quot;+count+&amp;quot;个数字&amp;quot;);
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;文件打开失败&amp;quot;）;
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;![ASCII码表数字字符的数值][/images/java/ASCII表.gif]&lt;/p&gt;
&lt;p&gt;第四题： 读取文本文件的信息，输入某个人的名字，并输出对应某个人的成绩
文本文件：（保存为 student.txt)
张三 80
李四 90
王五 95
赵四 80
李丹江 64&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import java.io.*;
import java.util.*;
public class GetMessageofNameFromFile
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                String  temp = null;
                int len = 0;
                try
                (
                        BufferedReader br = new BufferedReader(new FileReader(&amp;quot;e:/student.txt&amp;quot;));                
                )
                {
                        while((temp = br.readLine()) != null)
                        {
                                len++;
                        }
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;读取文件失败&amp;quot;);
                }
                String[] names = new String[len];
                //String[] banana = null;
                double[] chengji = new double[len] ;
                try
                (
                        BufferedReader br = new BufferedReader(new FileReader(&amp;quot;e:/student.txt&amp;quot;));        
                )
                {
                        int  i = 0;
                        while((temp = br.readLine()) != null)
                        {
                                //System.out.println(temp);
                                String[] banana = temp.split(&amp;quot; &amp;quot;);
                                //System.out.println(banana[0]+&amp;quot;:&amp;quot;+banana[1]);
                                // 读取文件的name信息
                                names[i] = banana[0];
                                //chengji[i]  = Double.parseDouble(banana[1].trim());
                                //读取文件的成绩信息
                                chengji[i]  = Double.parseDouble(banana[1]);
                                i++;
                        }
                }catch(IOException e)
                {
                        System.out.println(&amp;quot;读取文件失败&amp;quot;);
                }
                
                Scanner  sc = new Scanner(System.in);
        
                while(true)
                {        
                        System.out.println(&amp;quot;请输入你要查询的名字&amp;quot;);
                        String name = sc.nextLine();
                        //如果不输入姓名，直接回车则显示全部姓名！
                        if(name.isEmpty())
                        {
                                System.out.println(&amp;quot;输入为空显示全部&amp;quot;);
                                for(int i = 0; i &amp;lt; names.length ; i++)
                                {
                                        System.out.println(names[i]+&amp;quot;的成绩是:&amp;quot;+chengji[i]);        
                                }
                        }else
                        {
                                for(int i = 0; i &amp;lt; names.length ; i++)
                                {
                                        if(name.equalsIgnoreCase(names[i])) //不区分大小写
                                        {
                                                System.out.println(name+&amp;quot;的成绩是:&amp;quot;+chengji[i]);
                                        }
                                }
                        }
                }

        }

}
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>css7-14节笔记代码March25th</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/css7-14jie-bi-ji-dai-ma-march25th/</link>
      <pubDate>Mon, 11 May 2015 14:58:42 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/css7-14jie-bi-ji-dai-ma-march25th/</guid>
      <description>&lt;Link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&#34;&gt;
    &lt;Link type=&#34;javascript&#34; rel=&#34;stylesheet&#34; href=&#34;&#34;&gt;
    &lt;!--
     Link 控件
       rel属性  ：目标文档与当前文档的关系
       type属性 ： 文档类型
    --&gt;
      &lt;!--设background:url(b.jpg);置背景颜色 和文字字体--&gt;
    &lt;!--定义样式--&gt;
    &lt;!--
    学习的网站 ！
http://www.w3school.com.cn/css/index.asp(用到的时候记得查红色关键字即可)
找颜色：http://www.114la.com/other/rgb.htm
       背景控件的修饰
           注意background相关信息即可！
                  background-color
                  background-image
                  background-position
&lt;pre&gt;&lt;code&gt;    文本控件的修饰
        一般注意text相关信息
               text-align
               text-width
               text-shadow等
               text-indent:2em     1em =当前文本的一个字符的像素大小 （一个公式）
                        如果font-size=24px(默认是14px)  也就是此时1em=24px
                        这就是em的用法！！注意了！！
                text-decoration:underline
                                none
                                overline
                                line-through
                                blink
    字体控件的修饰
         一般注意font开头
              font-ize
              font-family:&amp;quot;微软雅黑&amp;quot;
              font-style:italic   对应htmlde &amp;lt;I&amp;gt;标签控件
              font-weigth:
                       100-900
                        border
                        lighter
              font-variant:small-cap

    链接控件（A标签）的修饰（伪类选择器）
          四种状态   :link      
                     :visited
                     :hover
                         a:hover{text-decoration:underline; color:red}
                     :active
                  提示 1：a:hover 必须被置于 a:link 和 a:visited 之后，才是有效的。
            提示 2：a:active 必须被置于 a:hover 之后，才是有效的。

    列表控件的修饰
         list-style-image:url{img/a.gif}
         list-style-type:square
         list-style:none

    表格控件的修饰
        表格作用：数据的格式化
        table{border-space: width:50px}
        tr{}
        td{}

    框模型（盒子模型）：

   Opera 浏览器先使用 ctrl+u 再使用ctrl+alt+i  打开computed的窗口，观察盒子模型（注意使用浏览器的开发者功能）
    IE用F12
       Margin是什么？
        元素的最外层，光晕部分 
               Margin-top
               margin: 1px 2px 3px 4px
       Border是什么?
         元素的中间层 夹在margin和padding之间
              border:1px solid #3333

       Padding 是什么？
          元素的内层，包裹着元素
               Padding-top:
               padding: 1px 2px 3px 4px

    轮廓
       元素的border和margin之间！起着一种强调的作用！！ 起着元素突出作用！(元素其实就是控件）
      outline:red  2px dash;
      input:focus{border:green 1px solid}  当点击文本框！！！则显示为绿色！这是很好的技能！！！！
                                           一定要多写几遍！！！！不错！！

所以其实在一个元素的外部有四重的包裹由内至外：  padding-&amp;gt; border--&amp;gt;outline--&amp;gt;margin  注意你所设置的位置
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;综上所述： 所以在标签中一般有Id属性  ，也可能有Class属性
一般规律1是：（必须掌握）
Style的内嵌入的修饰  &amp;gt;   Id选择器&amp;gt;  Class选择器 &amp;gt; 标签选择器
公式2：  selectors{属性名：属性值}   对应HTML的 标签&amp;lt;属性名=属性值&amp;gt;       CSS是用selectors来说标签， CSS使用冒号，HTML使用等号
CSS+HTML使用得好在乎经验和功夫，非一天两天。&lt;/p&gt;
&lt;p&gt;CSS基本选择器：
标签选择器
id选择器   #id_name
class选择器    .classname
CSS拓展选择器：
派生选择器  h1 a{}   指的是只要h1里面包含着a标签既满足该条件
子元素选择器（直接）  h1&amp;gt;a{}  这个a必须是在h1的下一层  不能是下下层（这边的分层是指谁包裹谁的意思）
属性选择器   a[href]{color:red}
组合选择器   h1,h2,h3,h4{color:blue}（注意提取共性）
伪选择器  主要针对于连接标签   （可用于控制界面的效果）
：linked       ：visited      :hover         :actived       :focus(获得焦点的时候）&lt;/p&gt;
&lt;p&gt;两种外联式方式：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-css&#34;&gt;&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; type=&amp;quot;text/css&amp;quot; href=&amp;quot;*.css&amp;quot;/&amp;gt;    常用               
@import url(&amp;quot;*.css&amp;quot;);  必须写到&amp;lt;style&amp;gt;&amp;lt;/style&amp;gt;标签中
第一种是界面直接加载全部，第二种是在页面加载完毕，然后在加载css文件，也就是刚开始没有样式，了解即可。

    --&amp;gt;

&amp;lt;Style type=&amp;quot;text/css&amp;quot;&amp;gt;
      body{font-family:&amp;quot;微软雅黑&amp;quot;}
      .box{width:600px; margin:0 auto; padding-top:100px;background-color:black}
      .box 
      H1{text-align:center text-shadow:2px 5px 5px 
      rgba(0,0,2,1);color:white; }
      .box 
      p{background:#2c2c29;border-radius:10px;border:1px solid #222220;
      line-height:38px;margin-right:5px;float:left;width=600px;}
      .box 
      span{float:left;display:block;text-align:right;background:#373733
      ;width:70px;height:40px;color:#ffffff;border-right:1px solid #222220;}
      .input_box{width:167px;padding-left:10px;height:38px;border:0px;background:
      #2c2c29;float:left;color:#ffffff}
      .input_btn{width:500px;height:40px;margin-top:15px;line-height:40px;
      background:#009900;border:1px solid #0099900;border-radius:10px;
      cursor:pointer;}
      .input_btn:hover{background:#00CD00}

    &amp;lt;/Style&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;1.DOM（文档对象模型）是HTML和XML的应用程序&lt;/p&gt;
&lt;p&gt;接口（API)所谓文档对象模型，其实就是对网页&lt;/p&gt;
&lt;p&gt;HTML中的各种元素的一种内部的表示，例如HTML&lt;/p&gt;
&lt;p&gt;中的头、段落、列表、风格、ID等，所有的元素&lt;/p&gt;
&lt;p&gt;都能通过DOM来访问
document （计算机）文档
DOM就是Html页面的模型，将每个标签都做为一个&lt;/p&gt;
&lt;p&gt;对象，JavaScript通过调用DOM中的属性、方法&lt;/p&gt;
&lt;p&gt;就可以对网页中的文本框、层等元素进行编程控&lt;/p&gt;
&lt;p&gt;制。&lt;/p&gt;
&lt;p&gt;2.所有变量，方法，元素等都属于window对象。&lt;/p&gt;
&lt;p&gt;都可以用window调用页面中定义的变量和方法都&lt;/p&gt;
&lt;p&gt;是window的&lt;/p&gt;
&lt;p&gt;3.CSS+JavaScript+DOM=DHtml&lt;/p&gt;
&lt;p&gt;4.onload 事件会在页面或图像加载完成后立即发&lt;/p&gt;
&lt;p&gt;生
5.window对象的方法
window.alert(‘大家好！’);//弹出警告对话&lt;/p&gt;
&lt;p&gt;框
window.confirm(‘确定要删除吗？’);//确定&lt;/p&gt;
&lt;p&gt;、取消对话框，返回true或false;
window.navigate(url);//将网页重新导航到&lt;/p&gt;
&lt;p&gt;url,支持IE、Opera11.6。并不推荐,有些浏览器&lt;/p&gt;
&lt;p&gt;不行,
建议使用window.location.href=‘url’;//支&lt;/p&gt;
&lt;p&gt;持大多数浏览器
6.计时器
1&amp;gt;var steId=setTimeout(function(){
alert(&amp;lsquo;这是一次性的&amp;rsquo;)
},1000);
clearTimeout(setId);//清除计时器
2&amp;gt;var setId=setInterval(function(){
alert(&amp;lsquo;神州行，我看行&amp;rsquo;);
},1000);&lt;/p&gt;
&lt;p&gt;//clearInterval(setId);//清除计时器
7.onload（页面加载后触发
onunload（页面卸载后触发）
onbeforeunload（页面卸载前触发）&lt;/p&gt;
&lt;p&gt;8.window.location对象：
window.location.href=‘’;//重新导航到新页&lt;/p&gt;
&lt;p&gt;面,可以取值，也可以赋值。
window.location.reload();//刷新当前页
对象的事件，所有元素的事件都可以通过event属&lt;/p&gt;
&lt;p&gt;性取到相关信息。//兼容IEwindow.event是IE下&lt;/p&gt;
&lt;p&gt;非常重要的属性，用来获得发生事件时的信息，&lt;/p&gt;
&lt;p&gt;事件不局限于window、Chrome，不兼容FF（用&lt;/p&gt;
&lt;p&gt;event参数）。
window.event.altKey属性，bool类型，表示事&lt;/p&gt;
&lt;p&gt;件发生时是否按下了alt键。类似的还有&lt;/p&gt;
&lt;p&gt;ctrlKey,shiftKey。
clientX、clientY 发生事件时鼠标在客户区的&lt;/p&gt;
&lt;p&gt;坐标；(页面左上角)不支持火狐
screenX、screenY 发生事件时鼠标在屏幕上的&lt;/p&gt;
&lt;p&gt;坐标；（相对于屏幕）
offsetX、offsetY 发生事件时鼠标相对于事件&lt;/p&gt;
&lt;p&gt;源（比如点击按钮时触发onclick）的坐标。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;onload=function(){

    document.getElementById

(&#39;dv&#39;).onmousedown=function(){

      if(window.event.altKey){
            alert(&#39;按下了alt键&#39;);

       }else if(window.event.shiftKey){
            alert(&#39;按下了shift键&#39;);

       }else if(window.event.ctrlKey){
            alert(&#39;按下了ctrl键&#39;);

        }else{
            alert(&#39;只是按下了鼠标了&#39;);
        }
        alert(window.event.button);

    };
};
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;9.赋值和粘贴的控制&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
   &amp;lt;/script&amp;gt;

    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;

        onload=function(){
         
document.body.oncopy=function(){

                setTimeout(function(){
                  var tt= 
clipboardData.getData(&#39;text&#39;)+&#39;文本出自哪

里&#39;;                    

clipboardData.setData(&#39;text&#39;,tt);
                },100);

            };
        };

    &amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;10.tag(标签)
11.获取元素的三种方式
getElementById(), （非常常用），根据元素的&lt;/p&gt;
&lt;p&gt;Id获得对象，网页中id不能重复。也可以直接通&lt;/p&gt;
&lt;p&gt;过元素的id来引用元素，但是有有效范围、
getElementsByName()，根据元素的name获得对&lt;/p&gt;
&lt;p&gt;象，由于页面中元素的name可以重复，比如多个&lt;/p&gt;
&lt;p&gt;RadioButton的name一样，因此&lt;/p&gt;
&lt;p&gt;getElementsByName返回值是对象数组。
getElementsByTagName()，获得指定标签名称的&lt;/p&gt;
&lt;p&gt;元素数组，比如getElementsByTagName(“input&lt;/p&gt;
&lt;p&gt;”)可以获得所有的&lt;input&gt;标签。*表示所有标签
12.三个练习题，必须熟练
1&amp;gt;每隔一秒获得当前时间
onload=function(){&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        setInterval(function(){

            document.getElementById
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(&amp;lsquo;p1&amp;rsquo;).innerText=new Date&lt;/p&gt;
&lt;p&gt;().toLocaleTimeString();&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        },1000);
    };
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;13.事件冒泡&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>email邮件发送&#43;OOGTK(0217)</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/emailyou-jian-fa-song-plus-oogtk-0217/</link>
      <pubDate>Mon, 11 May 2015 14:58:42 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/emailyou-jian-fa-song-plus-oogtk-0217/</guid>
      <description>&lt;p&gt;参考阅读：
[commons.email的邮件使用：][http://commons.apache.org/proper/commons-email/userguide.html]
[我的gtk的封装源代码： ][http://www.rupeng.com/forum/thread-44377-1-1.html]&lt;/p&gt;
&lt;p&gt;今早起来想着是不是该去对IO流做个总结，于是打开了Apache 的CommonsIO页面，看了一遍，本想写的，后来看到了一个Commons email包！于是页浏览了一下userGuide and JavaDoc,发现不是特别难，于是就按照user guide 做了几个实验！ 刚开始前期遇到了一个比较重要的问题&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package TestEmail;

/*import java.net.Authenticator;

import org.apache.commons.mail.DefaultAuthenticator;
import org.apache.commons.mail.Email;
import org.apache.commons.mail.SimpleEmail;*/
import org.apache.commons.mail.*;

/**
* @author    叶昭良
* @time      2015年2月17日上午11:10:04
* @version   TestEmailEmailText V1.0
*/
public class EmailText
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Email email = new SimpleEmail();
                email.setHostName(&amp;quot;smtp.163.com&amp;quot;);
                email.setSmtpPort(25);
                email.setSubject(&amp;quot;欢迎你&amp;quot;);
                email.setAuthenticator(new DefaultAuthenticator(&amp;quot;zhaoturkkey@163.com&amp;quot;, &amp;quot;密码&amp;quot;));
                email.setSSLOnConnect(true);
                try
                {
                        email.setFrom(&amp;quot;zhaoturkkey@163.com&amp;quot;,&amp;quot;Ye zhaoliang&amp;quot;);
                        email.setMsg(&amp;quot;This is a test mail ... :-)&amp;quot;);
                        email.addTo(&amp;quot;977962857@qq.com&amp;quot;,&amp;quot;Mr Ye&amp;quot;);
                        email.send();
                } catch (EmailException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                email.setSubject(&amp;quot;TestMail&amp;quot;);

        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;email.setAuthenticator(new DefaultAuthenticator(&amp;ldquo;&lt;a href=&#34;mailto:zhaoturkkey@163.com&#34;&gt;zhaoturkkey@163.com&lt;/a&gt;&amp;rdquo;, &amp;ldquo;密码&amp;rdquo;)); 他是来自javaee的javax.email包（通过ctrl+鼠标点击，一路插查过去就知道了）！！一直报错！于是下载了javaee版本的eclipse并抽取处 javax.email包！已添加在附件中！只要加载到项目中就可以使用。&lt;/p&gt;
&lt;p&gt;紧接着参考了带附件的邮件发送，也编写了相关程序，跟text差不多，只不过是采用了EmailAttachment 和MultiPartEmail 替换掉text版本的SimpleEmail类，就可以增加附件了，下面是我最后版本的源码，需要有OOGTK和com.rupeng.gtk4j.jar这两个类库即可       文本发送邮件是挺快的
带附件的邮件发送相对较慢些&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
*   邮件发送器
*/
package TestEmail;

import java.io.File;

import org.apache.commons.mail.DefaultAuthenticator;
import org.apache.commons.mail.Email;
import org.apache.commons.mail.EmailAttachment;
import org.apache.commons.mail.EmailException;
import org.apache.commons.mail.MultiPartEmail;
import org.apache.commons.mail.SimpleEmail;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;


/**
* @author    叶昭良
* @time      2015年2月17日下午2:27:35
* @version   TestEmailMyEmailSend V1.0
*/
import GTKEncapsulate.*;
public class MyEmailSend
{

        /**
         * @param args
         */
        //控件的声明
        private static OOWindow ow = null;
        private static OOButton ob = null;
        private static OOButton obApple = null;
        private static OOButton obAttach = null;
        private static OOTextView otv  = null;
        private static OOGrid og = null;
        
        private static OOLabel olPort = null;
        private static OOLabel olMessage = null;
        private static OOLabel olFrom = null;
        private static OOLabel olTo = null;
        private static OOLabel olServer = null;
        private static OOLabel olPassword = null;
        private static OOLabel olSubject = null;
        private static OOLabel olFromName = null;
        private static OOLabel olToName = null;
        private static OOLabel olAttachName = null;
        private static OOLabel olAttachDescription = null;
        private static OOLabel olAttachSetName = null;
        
        private static OOEntry oePort = null;
        private static OOEntry oeFrom = null;
        private static OOEntry oeTo   = null;
        private static OOEntry oeServer = null;
        private static OOPassword opPassword = null;
        private static OOEntry oeSubject = null;
        private static OOEntry oeFromName = null;
        private static OOEntry oeToName = null;
        private static OOEntry oeAttachDescription = null;
        private static OOEntry oeAttachSetName = null;
        
        private static String[] filenames = null;
        
        //构造函数  初始化界面
        public MyEmailSend()
        {
                ow = new OOWindow();
                ow.setTitle(&amp;quot;邮件发送器&amp;quot;);
                ow.setExitAfterDestroy(true);
                
                olServer = new OOLabel(&amp;quot;发送端服务器:&amp;quot;);
                olPort = new OOLabel(&amp;quot;服务器端口：&amp;quot;);
                olMessage = new OOLabel(&amp;quot;待发送信息：&amp;quot;);
                olFrom = new OOLabel(&amp;quot;发送方邮箱（163.com）：&amp;quot;);
                olTo = new OOLabel(&amp;quot;接收方邮箱:&amp;quot;);
                olPassword = new OOLabel(&amp;quot;发送方密码：&amp;quot;);
                olSubject = new OOLabel(&amp;quot;邮件主题：&amp;quot;);
                olFromName = new OOLabel(&amp;quot;你的名字：&amp;quot;);
                olToName = new OOLabel(&amp;quot;对方的名字：&amp;quot;);
                olAttachName = new OOLabel(&amp;quot;&amp;quot;);
                olAttachDescription = new OOLabel(&amp;quot;添加附件描述:&amp;quot;);
                olAttachSetName = new OOLabel(&amp;quot;设置附件名字:&amp;quot;);
                
                //文本框创建
                oePort = new OOEntry();
                oePort.setText(&amp;quot;25&amp;quot;);
                oeFrom = new OOEntry();
                oeFrom.setText(&amp;quot;zhaoturkkey@163.com&amp;quot;);
                oeTo = new OOEntry();
                oeTo.setText(&amp;quot;977962857@qq.com&amp;quot;);
                oeServer = new OOEntry();
                oeServer.setText(&amp;quot;smtp.163.com&amp;quot;);
                opPassword = new OOPassword();
                oeSubject = new OOEntry();
                oeFromName = new OOEntry();
                oeFromName.setText(&amp;quot;叶昭良&amp;quot;);
                oeToName = new OOEntry();
                oeToName.setText(&amp;quot;肖欣然&amp;quot;);
                oeAttachDescription = new OOEntry();
                oeAttachSetName = new OOEntry();
                
                obAttach = new OOButton(&amp;quot;添加附件&amp;quot;);
                ob = new OOButton(&amp;quot;仅文本发送&amp;quot;);
                obApple = new OOButton(&amp;quot;带附件发送&amp;quot;);
                otv = new OOTextView();
                otv.setText(&amp;quot;尊敬的&amp;quot;+oeToName.getText()+&amp;quot;:\n&amp;quot;);
                OOScrollBar osb = new OOScrollBar();
                osb.setWidgetSize(200, 200);
                osb.addView(otv);
                og = new OOGrid();
                
                //显示控件
                ow.show();
                ob.show();
                obApple.show();
                otv.show();
                osb.show();
                obAttach.show();
                
                olMessage.show();
                olPort.show();
                olPassword.show();
                olServer.show();
                olFrom.show();
                olTo.show();
                olSubject.show();
                olFromName.show();
                olToName.show();
                //olAttachName.show();
                
                oeFrom.show();
                oeTo.show();
                oeServer.show();
                oePort.show();
                oeSubject.show();
                opPassword.show();
                oeFromName.show();
                oeToName.show();
                
                og.show();
                //添加控件
                ow.add(og);
                og.add(olServer, 0,0);
                og.add(oeServer, 0, 1);
                
                og.add(olPort,0,2);
                og.add(oePort,0,3);
                
                og.add(olFrom,1,0);
                og.add(oeFrom,1,1);
        
                og.add(olPassword,1,2);
                og.add(opPassword,1,3);
                
                og.add(olTo,2,0);
                og.add(oeTo,2,1);
                og.add(olToName,2,2);
                og.add(oeToName,2,3);
                
                og.add(olSubject,3,0);
                og.add(oeSubject,3,1);
                og.add(olFromName,3,2);
                og.add(oeFromName,3,3);
                
                og.add(olMessage,4,0);
                og.add(osb,5,0,4,2);
                
                og.add(obAttach,7,0);
                og.add(olAttachName,7,1);
                
                og.add(olAttachDescription,8,0);
                og.add(oeAttachDescription,8,1);
                og.add(olAttachSetName,8,2);
                og.add(oeAttachSetName,8,3);
                
                og.add(ob, 9, 0);
                og.add(obApple,9,1);
                //文本监听
                ob.addClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                Email email = new SimpleEmail();
                                email.setHostName(oeServer.getText());
                                email.setSmtpPort(Integer.parseInt(oePort.getText()));
                                email.setSubject(oeSubject.getText());
//                                email.setAuthenticator(new DefaultAuthenticator(&amp;quot;zhaoturkkey@163.com&amp;quot;, &amp;quot;457866zhao&amp;quot;));
                                email.setAuthenticator(new DefaultAuthenticator(oeFrom.getText(), opPassword.getText()));
                                email.setSSLOnConnect(true);
                                if(opPassword.getText().equalsIgnoreCase(&amp;quot;&amp;quot;)) 
                                {
                                        OOMessageDialog om = new OOMessageDialog(&amp;quot;错误&amp;quot;);
                                        om.showError(&amp;quot;密码框不能为空！&amp;quot;, &amp;quot;赶紧去填写&amp;quot;);
                                        return;
                                }
                                //测试
/*                                System.out.println(oeServer.getText());
                                System.out.println(Integer.parseInt(oePort.getText()));
                                System.out.println(oeFrom.getText());
                                System.out.println(opPassword.getText());
                                System.out.println(oeSubject.getText());
                                System.out.println(otv.getText());*/
                                try
                                {
                                        email.setFrom(oeFrom.getText(),oeFromName.getText());
                                        email.setMsg(otv.getText());
                                        email.addTo(oeTo.getText(),oeToName.getText());
                                        email.send();
                                } catch (EmailException e)
                                {
                                        // TODO Auto-generated catch block
                                        System.out.println(&amp;quot;发送邮件异常&amp;quot;+e.getMessage());
                                }
                        
                        }
                });
                //文本附件监听
                obApple.addClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                 // Create the attachment
                                
                                if(opPassword.getText().equalsIgnoreCase(&amp;quot;&amp;quot;)) 
                                {
                                        OOMessageDialog om = new OOMessageDialog(&amp;quot;错误&amp;quot;);
                                        om.showError(&amp;quot;密码框不能为空！&amp;quot;, &amp;quot;赶紧去填写&amp;quot;);
                                        return;
                                }
                                  EmailAttachment attachment = new EmailAttachment();
                                  //attachment.setPath(&amp;quot;hunsha.jpg&amp;quot;);
                                  //attachment.setPath(&amp;quot;E:\\a1.zip&amp;quot;);
                                  //attachment.setPath(&amp;quot;E:\\1.jpg&amp;quot;);
                                  if(oeAttachSetName.getText().equalsIgnoreCase(&amp;quot;&amp;quot;))
                                  {
                                         OOMessageDialog om = new OOMessageDialog(&amp;quot;错误&amp;quot;);
                                        om.showError(&amp;quot;你还没有添加附件呢！&amp;quot;, &amp;quot;赶紧去添加&amp;quot;);
                                        return;
                                  }
                                  attachment.setPath(filenames[0]);
                                  
                                  attachment.setDisposition(EmailAttachment.ATTACHMENT);
                                  attachment.setDescription(oeAttachDescription.getText());
                                  attachment.setName(oeAttachSetName.getText());
                                 
                                  // Create the email message
                                  MultiPartEmail email = new MultiPartEmail();
                                  email.setHostName(oeServer.getText());
                                  email.setSmtpPort(Integer.parseInt(oePort.getText()));
                                  email.setAuthenticator(new DefaultAuthenticator(oeFrom.getText(), opPassword.getText()));
                                  email.setSSLOnConnect(true);
                                  try
                                  {
                                          email.addTo(oeTo.getText(), oeToName.getText());
                                          email.setFrom(oeFrom.getText(), oeFromName.getText());
                                          email.setSubject(oeSubject.getText());
                                          email.setMsg(otv.getText());
                        
                                          // add the attachment
                                          email.attach(attachment);
                        
                                          // send the email
                                         
                                          email.send();
                                  }catch(EmailException e)
                                  {
                                          System.out.println(&amp;quot;邮件发送失败 &amp;quot;+e.getMessage());
                                  }
                        }
                });
                
                obAttach.addClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                OOFileChooser ofApple =new OOFileChooser();
                                ofApple.setMultipleSelect();
                                ofApple.createFilter();
                                ofApple.nameFilter(&amp;quot;任意文件&amp;quot;);
                                ofApple.editFilter(&amp;quot;*.txt&amp;quot;);
                                ofApple.editFilter(&amp;quot;*.java&amp;quot;);
                                ofApple.editFilter(&amp;quot;*.rar&amp;quot;);
                                ofApple.editFilter(&amp;quot;*.zip&amp;quot;);
                                ofApple.editFilter(&amp;quot;*.doc&amp;quot;);
                                //把filter的操作放入打开对话框中
                                ofApple.finishFilter();
                                //String[] filenames = ofApple.processOpen();
                                filenames = ofApple.processOpen();
                                
                                olAttachName.setText(&amp;quot;你选择的文件是&amp;quot;+filenames[0].toString());
                                olAttachName.show();
                                olAttachSetName.show();
                                olAttachDescription.show();
                                oeAttachSetName.show();
                                oeAttachDescription.show();
                                //oeAttachSetName.setText(filenames);
                                int index = filenames[0].lastIndexOf(File.separator);
                                oeAttachSetName.setText(filenames[0].substring(index+1));
                                oeAttachDescription.setText(&amp;quot;这个文件是关于***&amp;quot;);
                        }
                });
                
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                MyEmailSend mes = new MyEmailSend();
                
                GTK.gtk_main();
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;小软件运行的效果:
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/email.png&#34; alt=&#34;EmialText的测试&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/chuangjiang.png&#34; alt=&#34;EmailAttachment附件的测试&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/file.png&#34; alt=&#34;文件选择框添加附件&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>hashmap本质March18</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/hashmapben-zhi-march18/</link>
      <pubDate>Mon, 11 May 2015 14:58:42 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/hashmapben-zhi-march18/</guid>
      <description>&lt;p&gt;HashMap:
Hashmap本质：
&amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt;&amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt;&amp;mdash;-&amp;gt;&amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt;&amp;mdash;-&amp;gt;&amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt; &amp;mdash;-&amp;gt;&amp;mdash;-&amp;gt;
|            |                |             |
|            |                 |             |
|            |                 |
|            |
|
|
|
优点：因为内部结构为哈希表,所以添加删除查询等操作都很快
缺点：HashMap不能直接遍历keySet() , values() , entrySet()三个方法作为遍历方法
由于Map 把key 和 value 封装到了Entry对象中,所以并不会对key和value直接操作,所以key和value可以为null
HashMap已经替换掉HashTable（只不过还有一个参与分子Properties还在大量使用）
|&amp;ndash;set
|&amp;mdash;keySet
|&amp;mdash;entrySet
|&amp;ndash;Collection&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.collections.test;

/**
* @author    叶昭良
* @time      2015年2月25日上午1:38:30
* @version   com.collections.testTestHashMap V1.0
*/
import java.util.*;
public class TestHashMap
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Map map = new HashMap();
                map.put(&amp;quot;1&amp;quot;, &amp;quot;zhangsan&amp;quot;);
                map.put(&amp;quot;2&amp;quot;, &amp;quot;lisi&amp;quot;);
                map.put(&amp;quot;3&amp;quot;, &amp;quot;cbd&amp;quot;);
                
                System.out.println(map.get(&amp;quot;1&amp;quot;));
                
                Set keySet = map.keySet();
                
                Iterator it = keySet.iterator();
                while(it.hasNext())
                {
                        Object o = it.next();
                        System.out.println(map.get(o)+&amp;quot;:&amp;quot;+o);
                }
                
                System.out.println(&amp;quot;The Second method to get Value---&amp;quot;);
                Collection value = map.values();
                Iterator it1 =value.iterator();
                while(it1.hasNext())
                {
                        System.out.println(it1.next());
                }
                
                map.remove(&amp;quot;1&amp;quot;);
                System.out.println(&amp;quot;The Third Method to get value----&amp;quot;);
                Set keyset1 = map.entrySet();
                Iterator itp = keyset1.iterator();
                while(itp.hasNext())
                {
                        Map.Entry o  = (Map.Entry)itp.next();
                        System.out.println(o+&amp;quot;，其中 键位：&amp;quot;+o.getKey()+&amp;quot;,值为：&amp;quot;+o.getValue());
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;HashMap源码追踪：&lt;/p&gt;
&lt;p&gt;HashMap源码调研的基础知识:
1.位运算符&lt;/p&gt;
&lt;p&gt;用于容量的翻倍，以及限定在某一范围内：&lt;/p&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;不考虑符号 ，空位都以0补齐 0补最高位 （&amp;raquo;  &amp;raquo;&amp;gt;正数无差别，负数有差别）
&amp;amp;   与运算&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.collections.test;

import java.util.HashMap;
import java.util.HashSet;



/**
* @author    叶昭良
* @time      2015年2月25日上午11:06:09
* @version   com.collections.testDeepHashMap V1.0
*/
public class DeepHashMap
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
/**
*  Long类型的equals的实现
*     public boolean equals(Object obj) {
        if (obj instanceof Long) {
            return value == ((Long)obj).longValue();
        }
        return false;
    }
*/
                System.out.println(new Long(1).equals(new Integer(1)));
                System.out.println(new Long(1).intValue()==new Integer(1).intValue());
                System.out.println(new Long(1).longValue()==new Integer(1).intValue());
                System.out.println(new Long(1).longValue());
                System.out.println(new Integer(1).intValue());
                System.out.println(new Long(100).hashCode());
                System.out.println(new Integer(100).hashCode());
//                System.out.println(new Integer(100).hashCode(100));
                HashMap&amp;lt;Integer,String&amp;gt; hm = new HashMap&amp;lt;Integer,String&amp;gt;();
                System.out.println(hm.hashCode());
//                HashSet&amp;lt;String&amp;gt; hs ;
                System.out.println( (1 &amp;lt;&amp;lt; 30)/1024/1024/1024); //1G
                System.out.println(8&amp;gt;&amp;gt;&amp;gt;2); //+++
                System.out.printf(&amp;quot;%o -- %x  --- %X\n ----\n&amp;quot;,-14,-14,-14);
                System.out.println(-14&amp;gt;&amp;gt;&amp;gt;2);
                System.out.println(Integer.toBinaryString(-14));
                System.out.println(-14&amp;gt;&amp;gt;2);
                //把一个字符串变为 奇数
                //  &amp;gt;&amp;gt;&amp;gt;
                System.out.println(Integer.parseInt(&amp;quot;00111111111111111111111111111100&amp;quot;,2));
                //  &amp;gt;&amp;gt;
                //Integer.parseInt(&amp;quot;-010101010&amp;quot;,2) 可以带符号
                System.out.println(Integer.toBinaryString(14));
                //~取反运算 仅仅针对 整数
                System.out.println(~14);
                System.out.println(Integer.toBinaryString(~14));
                //如何解析带符号位的
                System.out.println(&amp;quot;2的3次方 的错误答案&amp;quot;+(2^3)); // ^在java当中是异或操作
                System.out.println(&amp;quot;2的3次方 的正确答案&amp;quot;+Math.pow(2, 3)); 
                //System.out.println(11111111111111111111111111110010);
                /*
                 * 封存在一个函数内部
                 * System.out.println(&amp;quot;通过异或的方式进行验证&amp;quot;);
                System.out.println(Long.parseLong(&amp;quot;11111111111111111111111111111111&amp;quot;,2)^(Long.parseLong(&amp;quot;11111111111111111111111111110010&amp;quot;,2)));
                // 1101  8+4+1 = 13
                System.out.println((Long.parseLong(&amp;quot;11111111111111111111111111111111&amp;quot;,2)^(Long.parseLong(&amp;quot;11111111111111111111111111110010&amp;quot;,2)))+1);
                System.out.println(-((Long.parseLong(&amp;quot;11111111111111111111111111111111&amp;quot;,2)^(Long.parseLong(&amp;quot;11111111111111111111111111110010&amp;quot;,2)))+1));
                */
                System.out.println(&amp;quot;通过自定义的获取负数的方法:&amp;quot;+parseNegativeInteger(&amp;quot;11111111111111111111111111110010&amp;quot;));
                //负数的补码的计算是取反加1（然后在最后的数上加上负数）   正数的补码是直接计算
                System.out.println(Integer.parseInt(&amp;quot;100&amp;quot;,2)); //把100这个二进制数按照2进制方式解析
                
                //String.
                System.out.println(100);
                System.out.println(&amp;quot;开始从高到低进行打印&amp;quot;);
                //格式化输出 只有 %d  %o  %x  二进制得用toBinaryString
                for(byte b1 :longToByte8(100)) 
                {
                        System.out.printf(&amp;quot;%d:&amp;quot;,b1);
                }
                //我现在是取反
                
                // returns the number of one-bits 
                System.out.println(Integer.toBinaryString(170));
            System.out.println(&amp;quot;Number of one bits = &amp;quot; + Integer.bitCount(170));
            
            // 牛逼算法！ 让n最终为 某一个范围内的两端值
            System.out.println(15|15&amp;gt;&amp;gt;&amp;gt;1);
            int n = 170; //使得 n都是
            /**
             * 或的运算就是保持最大值（与的运算是为了保持原样（当和0xff))
             *  13 :00000000 00000000 00000000  00001101
             *   6  00000000 00000000 00000000  00000110  
             * 15:  00000000 00000000 00000000  00001111
             *   一直保持15   当时最大值 则保持一样了
             */
        n |= n &amp;gt;&amp;gt;&amp;gt; 1;
        n |= n &amp;gt;&amp;gt;&amp;gt; 2;
        n |= n &amp;gt;&amp;gt;&amp;gt; 4;
        n |= n &amp;gt;&amp;gt;&amp;gt; 8;
        n |= n &amp;gt;&amp;gt;&amp;gt; 16; // 2^16
        System.out.println(&amp;quot;Pow(2,16):&amp;quot;+Math.pow(2, 16));
        System.out.println(n);
        System.out.println(170&amp;gt;&amp;gt;&amp;gt;8);
        
        int tb=0;
        //由此可见 If的赋值是会影响到else的！！！
        //并且是有先后顺序的，这是在看hashmap的时候学到的
        if((tb=4) ==3)
        {
                System.out.println(&amp;quot;In the if&amp;quot;+tb);
        }else 
        {
                System.out.println(&amp;quot;In the else&amp;quot;+tb);
        }
        
        }
        /**
         * 计算机内部负数是用补码表示的，正数的原码与补码相同 (也就是所有数都以补码存在)
         * 你不要用这种连写的方式，改成：
         *   5  0101    3: 0011
         *       
         *        1:  0101 ^ 0011 =  0110
         *        2:  0110 ^ 0011 =  0101  == 5
         *        3:  0110 ^ 0101 =  0011  == 3  
         *                                      真心妙的操作
                i = i^j;
                j = i^j;
                i = i^j; 
                这样就可进行两个数的交换
         * @param sum
         * @return
         */
        public static long parseNegativeInteger(String number)
        {
                return -((Long.parseLong(&amp;quot;11111111111111111111111111111111&amp;quot;,2)^(Long.parseLong(number,2)))+1);
        }
    public static byte[] longToByte8(long sum) {
        byte[] arr = new byte[8];
        //一个字节有8 位   long是8个字节的
        arr[0] = (byte) (sum &amp;gt;&amp;gt; 56); //先提取最高位
        arr[1] = (byte) (sum &amp;gt;&amp;gt; 48); //第二高位
        arr[2] = (byte) (sum &amp;gt;&amp;gt; 40); //第三高位
        arr[3] = (byte) (sum &amp;gt;&amp;gt; 32);
        arr[4] = (byte) (sum &amp;gt;&amp;gt; 24);
        arr[5] = (byte) (sum &amp;gt;&amp;gt; 16);
        arr[6] = (byte) (sum &amp;gt;&amp;gt; 8);
        arr[7] = (byte) (sum &amp;amp; 0xff); //不超过258 15*16+16 =256
        return arr;
    }


}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由此得知HashMap的翻倍原理：
newCap = oldCap &amp;laquo; 1&lt;/p&gt;
&lt;p&gt;2.字节的截断工具：
&amp;amp;的截断作用&lt;/p&gt;
&lt;p&gt;//0xff 其实就是一个字节，也就是最低的一个直接
//通过&amp;amp;来截断最低的一个直接
(byte) (c &amp;amp; 0xff);  来获得c的最低的一个直接（一般用于结尾   ^&lt;/p&gt;
&lt;p&gt;p = tab[index = (n - 1) &amp;amp; hash]
ByteUtils字节工具：（一谈到工具，一般是静态方法）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* http://www.cnblogs.com/fangfan/p/4086662.html
*/
package com.collections.test;

import java.util.Arrays;

/**
* @author    叶昭良
* @time      2015年2月25日下午11:56:33
* @version   com.collections.testByteUtils V1.0
*/
public class ByteUtils
{

        /**
         * @param args
         */
          /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将4个byte数字组成的数组合并为一个float数.
     * &amp;amp;是位与，&amp;amp;一般用于取一个字节（八位）的位数
     * &amp;lt;/pre&amp;gt;
     * 
     * @param arr
     * @return
     */
    public static float byte4ToFloat(byte[] arr) {
        if (arr == null || arr.length != 4) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且是4位!&amp;quot;);
        }
        int i = byte4ToInt(arr);
        return Float.intBitsToFloat(i);
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将一个float数字转换为4个byte数字组成的数组.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param f
     * @return
     */
    public static byte[] floatToByte4(float f) {
        int i = Float.floatToIntBits(f);
        return intToByte4(i);
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将八个byte数字组成的数组转换为一个double数字.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param arr
     * @return
     */
    public static double byte8ToDouble(byte[] arr) {
        if (arr == null || arr.length != 8) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且是8位!&amp;quot;);
        }
        long l = byte8ToLong(arr);
        return Double.longBitsToDouble(l);
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将一个double数字转换为8个byte数字组成的数组.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param i
     * @return
     */
    public static byte[] doubleToByte8(double i) {
        long j = Double.doubleToLongBits(i);
        return longToByte8(j);
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将一个char字符转换为两个byte数字转换为的数组.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param c
     * @return
     */
    public static byte[] charToByte2(char c) {
        byte[] arr = new byte[2];
        arr[0] = (byte) (c &amp;gt;&amp;gt; 8);
        //0xff 其实就是一个字节，也就是最低的一个直接
        //通过&amp;amp;来截断最低的一个直接
        arr[1] = (byte) (c &amp;amp; 0xff);
        return arr;
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将2个byte数字组成的数组转换为一个char字符.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param arr
     * @return
     */
    public static char byte2ToChar(byte[] arr) {
        if (arr == null || arr.length != 2) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且是2位!&amp;quot;);
        }
        return (char) (((char) (arr[0] &amp;lt;&amp;lt; 8)) | ((char) arr[1]));
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将一个16位的short转换为长度为2的8位byte数组.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param s
     * @return
     */
    public static byte[] shortToByte2(Short s) {
        byte[] arr = new byte[2];
        arr[0] = (byte) (s &amp;gt;&amp;gt; 8);
        arr[1] = (byte) (s &amp;amp; 0xff);
        return arr;
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 长度为2的8位byte数组转换为一个16位short数字.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param arr
     * @return
     */
    public static short byte2ToShort(byte[] arr) {
        if (arr != null &amp;amp;&amp;amp; arr.length != 2) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且是2位!&amp;quot;);
        }
        return (short) (((short) arr[0] &amp;lt;&amp;lt; 8) | ((short) arr[1] &amp;amp; 0xff));
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将short转换为长度为16的byte数组.
     * 实际上每个8位byte只存储了一个0或1的数字
     * 比较浪费.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param s
     * @return
     */
    public static byte[] shortToByte16(short s) {
        byte[] arr = new byte[16];
        for (int i = 15; i &amp;gt;= 0; i--) {
            arr[i] = (byte) (s &amp;amp; 1);
            s &amp;gt;&amp;gt;= 1;
        }
        return arr;
    }

    public static short byte16ToShort(byte[] arr) {
        if (arr == null || arr.length != 16) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且长度为16!&amp;quot;);
        }
        short sum = 0;
        for (int i = 0; i &amp;lt; 16; ++i) {
            sum |= (arr[i] &amp;lt;&amp;lt; (15 - i));
        }
        return sum;
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将32位int转换为由四个8位byte数字.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param sum
     * @return
     */
    public static byte[] intToByte4(int sum) {
        byte[] arr = new byte[4];
        arr[0] = (byte) (sum &amp;gt;&amp;gt; 24);
        arr[1] = (byte) (sum &amp;gt;&amp;gt; 16);
        arr[2] = (byte) (sum &amp;gt;&amp;gt; 8);
        arr[3] = (byte) (sum &amp;amp; 0xff);
        return arr;
    }

    /**
     * &amp;lt;pre&amp;gt;
     * 将长度为4的8位byte数组转换为32位int.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param arr
     * @return
     */
    public static int byte4ToInt(byte[] arr) {
        if (arr == null || arr.length != 4) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且是4位!&amp;quot;);
        }
        return (int) (((arr[0] &amp;amp; 0xff) &amp;lt;&amp;lt; 24) | ((arr[1] &amp;amp; 0xff) &amp;lt;&amp;lt; 16) | ((arr[2] &amp;amp; 0xff) &amp;lt;&amp;lt; 8) | ((arr[3] &amp;amp; 0xff)));
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将长度为8的8位byte数组转换为64位long.
     * &amp;lt;/pre&amp;gt;
     * 
     * 0xff对应16进制,f代表1111,0xff刚好是8位 byte[]
     * arr,byte[i]&amp;amp;0xff刚好满足一位byte计算,不会导致数据丢失. 如果是int计算. int[] arr,arr[i]&amp;amp;0xffff
     * 
     * @param arr
     * @return
     */
    public static long byte8ToLong(byte[] arr) {
        if (arr == null || arr.length != 8) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且是8位!&amp;quot;);
        }
        return (long) (((long) (arr[0] &amp;amp; 0xff) &amp;lt;&amp;lt; 56) | ((long) (arr[1] &amp;amp; 0xff) &amp;lt;&amp;lt; 48) | ((long) (arr[2] &amp;amp; 0xff) &amp;lt;&amp;lt; 40)
                        | ((long) (arr[3] &amp;amp; 0xff) &amp;lt;&amp;lt; 32) | ((long) (arr[4] &amp;amp; 0xff) &amp;lt;&amp;lt; 24)
                        | ((long) (arr[5] &amp;amp; 0xff) &amp;lt;&amp;lt; 16) | ((long) (arr[6] &amp;amp; 0xff) &amp;lt;&amp;lt; 8) | ((long) (arr[7] &amp;amp; 0xff)));
    }

    /**
     * 将一个long数字转换为8个byte数组组成的数组.
     */
    public static byte[] longToByte8(long sum) {
        byte[] arr = new byte[8];
        arr[0] = (byte) (sum &amp;gt;&amp;gt; 56);
        arr[1] = (byte) (sum &amp;gt;&amp;gt; 48);
        arr[2] = (byte) (sum &amp;gt;&amp;gt; 40);
        arr[3] = (byte) (sum &amp;gt;&amp;gt; 32);
        arr[4] = (byte) (sum &amp;gt;&amp;gt; 24);
        arr[5] = (byte) (sum &amp;gt;&amp;gt; 16);
        arr[6] = (byte) (sum &amp;gt;&amp;gt; 8);
        arr[7] = (byte) (sum &amp;amp; 0xff);
        return arr;
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将int转换为32位byte.
     * 实际上每个8位byte只存储了一个0或1的数字
     * 比较浪费.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param num
     * @return
     */
    public static byte[] intToByte32(int num) {
        byte[] arr = new byte[32];
        for (int i = 31; i &amp;gt;= 0; i--) {
            // &amp;amp;1 也可以改为num&amp;amp;0x01,表示取最地位数字.
            arr[i] = (byte) (num &amp;amp; 1);
            // 右移一位.
            num &amp;gt;&amp;gt;= 1;
        }
        return arr;
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将长度为32的byte数组转换为一个int类型值.
     * 每一个8位byte都只存储了0或1的数字.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param arr
     * @return
     */
    public static int byte32ToInt(byte[] arr) {
        if (arr == null || arr.length != 32) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且长度是32!&amp;quot;);
        }
        int sum = 0;
        for (int i = 0; i &amp;lt; 32; ++i) {
            sum |= (arr[i] &amp;lt;&amp;lt; (31 - i));
        }
        return sum;
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将长度为64的byte数组转换为一个long类型值.
     * 每一个8位byte都只存储了0或1的数字.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param arr
     * @return
     */
    public static long byte64ToLong(byte[] arr) {
        if (arr == null || arr.length != 64) {
            throw new IllegalArgumentException(&amp;quot;byte数组必须不为空,并且长度是64!&amp;quot;);
        }
        long sum = 0L;
        for (int i = 0; i &amp;lt; 64; ++i) {
            sum |= ((long) arr[i] &amp;lt;&amp;lt; (63 - i));
        }
        return sum;
    }

    /**
     * 
     * &amp;lt;pre&amp;gt;
     * 将一个long值转换为长度为64的8位byte数组.
     * 每一个8位byte都只存储了0或1的数字.
     * &amp;lt;/pre&amp;gt;
     * 
     * @param sum
     * @return
     */
    public static byte[] longToByte64(long sum) {
        byte[] arr = new byte[64];
        for (int i = 63; i &amp;gt;= 0; i--) {
            arr[i] = (byte) (sum &amp;amp; 1);
            sum &amp;gt;&amp;gt;= 1;
        }
        return arr;
    }
    
   
    public static void showMaxValAndminVal() {
        // 127
        System.out.println(&amp;quot;Byte.Max_Value:&amp;quot;+Byte.MAX_VALUE);
        // -128
        System.out.println(&amp;quot;Byte.MIN_VALUE:&amp;quot;+Byte.MIN_VALUE);

        // 32767
        System.out.println(&amp;quot;Short.MAX_VALUE:&amp;quot;+Short.MAX_VALUE);
        // -32768
        System.out.println(&amp;quot;Short.MIN_VALUE:&amp;quot;+Short.MIN_VALUE);

        // 65535 2的16次方-1
        System.out.println(&amp;quot;(int) Character.MAX_VALUE:&amp;quot;+(int) Character.MAX_VALUE);
        // 0
        System.out.println(&amp;quot;(int) Character.MIN_VALUE:&amp;quot;+(int) Character.MIN_VALUE);

        // 2147483647
        System.out.println(&amp;quot;Integer.MAX_VALUE:&amp;quot;+Integer.MAX_VALUE);
        // -2147483648
        System.out.println(&amp;quot;Integer.MIN_VALUE:&amp;quot;+Integer.MIN_VALUE);

        // 科学计数法.
        // 3.4028235E38
        System.out.println(&amp;quot;Float.MAX_VALUE:&amp;quot;+Float.MAX_VALUE);
        // 1.4E-45
        System.out.println(&amp;quot;Float.MIN_VALUE:&amp;quot;+Float.MIN_VALUE);

        // 9223372036854775807
        System.out.println(&amp;quot;Long.MAX_VALUE:&amp;quot;+Long.MAX_VALUE);
        // -9223372036854775808
        System.out.println(&amp;quot;Long.MIN_VALUE:&amp;quot;+Long.MIN_VALUE);

        // 科学计数法.
        // 1.7976931348623157E308
        System.out.println(&amp;quot;Double.MAX_VALUE:&amp;quot;+Double.MAX_VALUE);
        // 4.9E-324
        System.out.println(&amp;quot;Double.MIN_VALUE:&amp;quot;+Double.MIN_VALUE);
    }
    
    public static void transByte() {
        char c = &#39;z&#39;;
        byte[] charToByte2Arr = ByteUtils.charToByte2(c);
       

        short s = Short.MAX_VALUE;
        // System.out.println(&amp;quot;Short.MAX_VALUE:&amp;quot; + s);
        byte[] shortToByte2Arr = ByteUtils.shortToByte2(s);
       

        byte[] shortToByte16 = ByteUtils.shortToByte16(s);
        System.out.println(Arrays.toString(shortToByte16));
        System.out.println(ByteUtils.byte16ToShort(shortToByte16));

        int i = Integer.MAX_VALUE;
        // System.out.println(&amp;quot;Integer.MAX_VALUE:&amp;quot; + i);
        byte[] intToByte4Arr = ByteUtils.intToByte4(i);
        

        byte[] intToByte32Arr = ByteUtils.intToByte32(i);
        System.out.println(Arrays.toString(intToByte32Arr));
        System.out.println(ByteUtils.byte32ToInt(intToByte32Arr));

        long j = Long.MAX_VALUE;
        // System.out.println(&amp;quot;Long.MAX_VALUE:&amp;quot; + j);
        byte[] longToByte8Arr = ByteUtils.longToByte8(j);
      

        byte[] longToByte64Arr = ByteUtils.longToByte64(j);
        System.out.println(Arrays.toString(longToByte64Arr));
        System.out.println(ByteUtils.byte64ToLong(longToByte64Arr));

        double d = 2.34;
        byte[] doubleToByte8Arr = ByteUtils.doubleToByte8(d);
       

        float f = 1.2f;
        byte[] floatToByte4Arr = ByteUtils.floatToByte4(f);
       
    }

        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
//                showMaxValAndminVal();
                transByte();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;补充^:
按位异或。比如二进制     1001 ^ 1100 = 0101
0^0=0，1^1=0 ，1^0 = 1，0^1=1
复制代码&lt;/p&gt;
&lt;p&gt;3.理解重新调整大小&lt;/p&gt;
&lt;p&gt;第一部分：理解重新调整大&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;    /**
     * Implements Map.putAll and Map constructor
     *
     * @param m the map
     * @param evict false when initially constructing this map, else
     * true (relayed to method afterNodeInsertion).
     */
    final void putMapEntries(Map&amp;lt;? extends K, ? extends V&amp;gt; m, boolean evict) {
        int s = m.size();
        if (s &amp;gt; 0) {
            if (table == null) { // pre-size
                float ft = ((float)s / loadFactor) + 1.0F;
                int t = ((ft &amp;lt; (float)MAXIMUM_CAPACITY) ?
                         (int)ft : MAXIMUM_CAPACITY);
                if (t &amp;gt; threshold)
                    threshold = tableSizeFor(t);
            }
            else if (s &amp;gt; threshold)
                resize();
            for (Map.Entry&amp;lt;? extends K, ? extends V&amp;gt; e : m.entrySet()) {
                K key = e.getKey();
                V value = e.getValue();
                putVal(hash(key), key, value, false, evict);
            }
        }
    }

    public HashMap(int initialCapacity, float loadFactor) {
        if (initialCapacity &amp;lt; 0)
            throw new IllegalArgumentException(&amp;quot;Illegal initial capacity: &amp;quot; +
                                               initialCapacity);
        if (initialCapacity &amp;gt; MAXIMUM_CAPACITY)
            initialCapacity = MAXIMUM_CAPACITY;
        if (loadFactor &amp;lt;= 0 || Float.isNaN(loadFactor))
            throw new IllegalArgumentException(&amp;quot;Illegal load factor: &amp;quot; +
                                               loadFactor);
        this.loadFactor = loadFactor;
        this.threshold = tableSizeFor(initialCapacity);
    

    /**
     * Returns a power of two size for the given target capacity.
用于理解2的阶乘大小的实现。别人一直强调的2的阶乘的扩容
     */
    static final int tableSizeFor(int cap) {
        int n = cap - 1;
        n |= n &amp;gt;&amp;gt;&amp;gt; 1; //
        n |= n &amp;gt;&amp;gt;&amp;gt; 2;
        n |= n &amp;gt;&amp;gt;&amp;gt; 4;
        n |= n &amp;gt;&amp;gt;&amp;gt; 8;
        n |= n &amp;gt;&amp;gt;&amp;gt; 16;
        return (n &amp;lt; 0) ? 1 : (n &amp;gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4.理解添加&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;   /**
     * Implements Map.putAll and Map constructor
     *
     * @param m the map
     * @param evict false when initially constructing this map, else
     * true (relayed to method afterNodeInsertion).
     */
    final void putMapEntries(Map&amp;lt;? extends K, ? extends V&amp;gt; m, boolean evict) {
        int s = m.size();
        if (s &amp;gt; 0) {
            if (table == null) { // pre-size
                float ft = ((float)s / loadFactor) + 1.0F;
                int t = ((ft &amp;lt; (float)MAXIMUM_CAPACITY) ?
                         (int)ft : MAXIMUM_CAPACITY);
                if (t &amp;gt; threshold)
                    threshold = tableSizeFor(t);
            }
            else if (s &amp;gt; threshold)
                resize();
            for (Map.Entry&amp;lt;? extends K, ? extends V&amp;gt; e : m.entrySet()) {
                K key = e.getKey();
                V value = e.getValue();
                putVal(hash(key), key, value, false, evict);
            }
        }
    }



final Node&amp;lt;K,V&amp;gt;[] resize() {
//在创建新表之前 ，先保存旧表
        Node&amp;lt;K,V&amp;gt;[] oldTab = table;
//保存旧表的长度
        int oldCap = (oldTab == null) ? 0 : oldTab.length;
//保存 上限值
        int oldThr = threshold;
        int newCap, newThr = 0;
        if (oldCap &amp;gt; 0) {
            if (oldCap &amp;gt;= MAXIMUM_CAPACITY) {
                threshold = Integer.MAX_VALUE;
                return oldTab;
            }
//加倍了！！！！！！
            else if ((newCap = oldCap &amp;lt;&amp;lt; 1) &amp;lt; MAXIMUM_CAPACITY &amp;amp;&amp;amp;
                     oldCap &amp;gt;= DEFAULT_INITIAL_CAPACITY)
                newThr = oldThr &amp;lt;&amp;lt; 1; // double threshold
        }
        else if (oldThr &amp;gt; 0) // initial capacity was placed in threshold
            newCap = oldThr;
        else {               // zero initial threshold signifies using defaults
            newCap = DEFAULT_INITIAL_CAPACITY;
            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
        }
        if (newThr == 0) {
            float ft = (float)newCap * loadFactor;
            newThr = (newCap &amp;lt; MAXIMUM_CAPACITY &amp;amp;&amp;amp; ft &amp;lt; (float)MAXIMUM_CAPACITY ?
                      (int)ft : Integer.MAX_VALUE);
        }
        threshold = newThr;
        @SuppressWarnings({&amp;quot;rawtypes&amp;quot;,&amp;quot;unchecked&amp;quot;})
//新标的长度  newTab为newCap,newCap默认为最大的Capacity  16
            Node&amp;lt;K,V&amp;gt;[] newTab = (Node&amp;lt;K,V&amp;gt;[])new Node[newCap];
        table = newTab;
        if (oldTab != null) {
            for (int j = 0; j &amp;lt; oldCap; ++j) {
                Node&amp;lt;K,V&amp;gt; e;
                if ((e = oldTab[j]) != null) {
                    oldTab[j] = null;
//分为两种情况进行扩充
                    if (e.next == null)
//e.hash 是Node类的final属性
                        newTab[e.hash &amp;amp; (newCap - 1)] = e;
                    else if (e instanceof TreeNode)
                        ((TreeNode&amp;lt;K,V&amp;gt;)e).split(this, newTab, j, oldCap);
                    else { // preserve order
                        Node&amp;lt;K,V&amp;gt; loHead = null, loTail = null;
                        Node&amp;lt;K,V&amp;gt; hiHead = null, hiTail = null;
                        Node&amp;lt;K,V&amp;gt; next;
                        do {
                            next = e.next;
// e.hash &amp;amp; oldCap 的作用是 若&amp;lt;oldCap 则范围e.hash
                            if ((e.hash &amp;amp; oldCap) == 0) {
                                if (loTail == null)
                                    loHead = e;
                                else
                                    loTail.next = e;
                                loTail = e;
                            }
                            else {
                                if (hiTail == null)
                                    hiHead = e;
                                else
                                    hiTail.next = e;
                                hiTail = e;
                            }
                        } while ((e = next) != null);
                        if (loTail != null) {
                            loTail.next = null;
                            newTab[j] = loHead;
                        }
                        if (hiTail != null) {
                            hiTail.next = null;
                            newTab[j + oldCap] = hiHead;
                        }
                    }
                }
            }
        }
        return newTab;
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5.理解说明：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
     * Initializes or doubles table size.  If null, allocates in
     * accord with initial capacity target held in field threshold.
     * Otherwise, because we are using power-of-two expansion, the
     * elements from each bin must either stay at same index, or move
     * with a power of two offset in the new table.
     *
初始化或者使表格大小加倍。如果为null，分配和初始容量目标（根据threshold字段值） 另外地，因为我们使用2的阶乘的拓展，每个块的元素应该是处于相同的指数，或者在新表中移动2的阶乘&amp;lt;/font&amp;gt; 
复制代码
&amp;lt;font size=&amp;quot;3&amp;quot;&amp;gt;没错我依然以putMapEntries作为话题的引发点。
两个参数：
    static final int MAXIMUM_CAPACITY = 1 &amp;lt;&amp;lt; 30;//1G的大小 2^30次方 

    /**
     * The load factor used when none specified in constructor.
     */
static final float DEFAULT_LOAD_FACTOR = 0.75f;

static final int DEFAULT_INITIAL_CAPACITY = 1 &amp;lt;&amp;lt; 4; // aka 16
* size：该变量保存了该 HashMap 中所包含的 
key-value 对的数量。      
* threshold：该变量包含了 HashMap 能容纳的 key-value 对的极限，它的值等于 HashMap 的容量乘以负载因子（load factor）

当 size++ &amp;gt;= threshold 时，HashMap 会自动调用 resize 方法扩充 HashMap 的容量。每扩充一次，HashMap 的容量就增大一倍

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6.HashMap和HashSet的区别
Hashset是继承list，具有iterator特性
HashMap继承自Map，不具有iterator特性
两者的共同特点是都是linked数组（数组的bucket号都是一个链表）&lt;/p&gt;
&lt;p&gt;7.理解Hash算法
&lt;font size=&#34;3&#34;&gt;其实就是hash调用自定义类的hashcode方法而已）以及contains key的过程。在HashSet或者HashMap中都有get方法，get方法中都有hash的影子，当然在containsKey中也是包含着hash()的方法，通过这个方法的调用才可以找到bucket(俗语：存储桶，用于装一条链表，可用于存储的桶的个数，也就是数组的长度，也叫做capacity容量，一般对应着一个负载因子算法，当超过最大容量乘上负载因子，就需要进行rehash的过程)&lt;/font&gt;
复制代码
TreeMap:
本质：
优点：
缺点：
LinkedHashMap:
本质：&lt;br&gt;
优点：
缺点：
Iterator:
替换掉Enumeration,先前的Enumeration类的方法名的长度较长，不方便记忆，淘汰之。
泛型
泛型的本质是参数化类型。当我们再进行泛型定义的时候可以用T  K  V  E，但是当我们在使用泛型接口的时候 必须给泛型附上一个值，就好像给方法附上实参
Java的泛型实际上从编译的角度来说仅仅是一个类型擦除
public static void doTest(List&amp;lt;?extends Parent&amp;gt; list)
//包含Parend以及所有继承自Parent的子类
public static void doTest(List&amp;lt;?super Parent&amp;gt; list)
//包含Parend以及所有Parent的父类
泛型的兼容：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   //泛型的向后兼容

   //l1 只是回去找List的方法   

   List l1 =   new ArrayList&amp;lt;String&amp;gt;();

   l1.add(&amp;quot;abc&amp;quot;);

   l1.add(3);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;泛型的不协变：
//泛型的不协变
//     List&lt;String&gt;l3 = new ArrayList&lt;Integer&gt;(); //报错&lt;/p&gt;
&lt;p&gt;Arrays:Arrays中 asList  不能使用add ，因为asList根本就没有改变数组的本质！！只不过可以使用遍历的方法常用方法：
sort                     给数组的元素排序
binarySearch     二分查找法查找元素
copyOf               数组复制
equals                  判断两个数组的元素是否相等
fill                         填充数组
hashCode            计算数组的元素的哈希值
toString                返回每个数组元素组成的字符串
asList        把数组转化为结构不可改变,但可以查询修改的集合&lt;/p&gt;
&lt;p&gt;Collections:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.collections.test;

import java.util.ArrayList;
import java.util.Collections;

/**
* 
* @author    叶昭良
* @time      2015年3月19日下午1:25:44
* @version   com.collections.testTestCollections1 V1.0
* 功能：  测试 骰子 的乱序  随机排序
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class TestCollections1
{
        public static void main(String[] args)
        {
                ArrayList&amp;lt;Integer&amp;gt; arl = new ArrayList&amp;lt;Integer&amp;gt;();
                arl.add(4);
                arl.add(9);
                arl.add(2);
                arl.add(10);
                arl.add(3);
                Collections.shuffle(arl);
                for(Integer temp:arl)
                {
                        System.out.println(temp);
                }
        }
}
```java


Sort: 只对list排序    treeset内部就有排序   hashmap根本就不需要
binarySearch  二分查找  必须是list 而且该集合必须排好序
fill   只能对list集合有效
shuffle  洗牌   打乱集合的顺序

只有排完序才能进行binarySearch

```java
Collections.sort(pileOfApple);
                for(String temp:pileOfApple)
                {
                        System.out.println(temp);
                }
                //已排好序 才可以这样做 ! 否则不可以进行二分查找  Arrays类似的用法
                System.out.println(Collections.binarySearch(pileOfApple, &amp;quot;gd&amp;quot;));&amp;lt;/font&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Collections常用方法：
sort       对List集合进行排序
binarySearch 方法,使用二分查找法查找元素,要求必须是List集合,而且必须已经排好序
fill                  方法,使用指定元素填充List集合
replaceAll      方法,使用指定元素替换所有的另一个元素,只对List有效
max   方法,返回一个集合中最大的元素
min
shuffle  洗牌,打乱集合元素的顺序
synchronizedList     返回指定集合的线程安全的包装集合
unmodifiableList     返回指定集合的不可修改的包装集合&lt;/p&gt;
&lt;p&gt;多重数据结构的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;
package com.collections.test;

import java.util.HashMap;

/**
* @author    叶昭良
* @time      2015年3月3日下午6:54:32
* @version   com.collections.testTestMapMap V1.0
*/
import java.util.*;
public class TestMapMap
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                //Map&amp;lt;String,Map&amp;lt;String,Map&amp;lt;Integer,Double&amp;gt;&amp;gt;&amp;gt; stuTotal = new HashMap&amp;lt;String,Map&amp;lt;String,Map&amp;lt;Integer,Double&amp;gt;&amp;gt;&amp;gt;();
                Map&amp;lt;String, Integer&amp;gt; innerMap = new HashMap&amp;lt;String, Integer&amp;gt;();
                innerMap.put(&amp;quot;innerKey&amp;quot;, 2014);
                Map&amp;lt;String, Map&amp;lt;String, Integer&amp;gt;&amp;gt; map = new HashMap&amp;lt;String, Map&amp;lt;String, Integer&amp;gt;&amp;gt;();
                map.put(&amp;quot;outerKey&amp;quot;, innerMap);
                 
                Map&amp;lt;String, Integer&amp;gt; targetMap = map.get(&amp;quot;outerKey&amp;quot;);
                if(targetMap == innerMap){
                    System.out.println(&amp;quot;You got the inner Map, and it is saved in targetMap!!!&amp;quot;);
                }
                
                //原来嵌套集合数据结构是可以实现的
                Map&amp;lt;String,Map&amp;lt;String,Map&amp;lt;Integer,Double&amp;gt;&amp;gt;&amp;gt; outterMap = new HashMap&amp;lt;String, Map&amp;lt;String,Map&amp;lt;Integer,Double&amp;gt;&amp;gt;&amp;gt;();
                
                //==
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ToStringString函数的append可采用链式的append本质是：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;&amp;lt;font size=&amp;quot;3&amp;quot;&amp;gt; @Override
    public StringBuilder append(boolean b) {
        super.append(b);
        return this;
    }

    @Override
    public StringBuilder append(char c) {
        super.append(c);
        return this;
    }
。。。。。&amp;lt;/font&amp;gt;
```java
&amp;lt;font size=&amp;quot;3&amp;quot;&amp;gt;String类型的toString方法，会去调用valueOf函数，关键的调研过程:
其实关键是得看println接受的对象，以前一直认为是对象们的toString方法，没错的确是他直接引起，但是其实是因为println的重载方法来限制了对象必须去重写toString方法.
因为再对应String的println重载方法中，包含着String.valueOf所以需要进一步调用String类的valueOf函数，而valueOf函数则是调用了toString方法，所以最基本的函数toString。
不同的参数类型会去加载不同的println的方法！&amp;lt;/font&amp;gt;


&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>HTML1-17节笔记代码March22nd</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/html1-17jie-bi-ji-dai-ma-march22nd/</link>
      <pubDate>Mon, 11 May 2015 14:58:42 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/html1-17jie-bi-ji-dai-ma-march22nd/</guid>
      <description>&lt;p&gt;1：HTML学习大纲：&lt;/p&gt;
&lt;!--Html 标签是一个最大的标签，包含底下的所有标签--&gt;
&lt;pre&gt;&lt;code&gt; &amp;lt;!--Head标签 主要包含  &amp;lt;Titlt   Meta  Style标签  用来充当网页的修饰部分--&amp;gt;

       &amp;lt;!--网页标题Title: 指定浏览器标题栏显示的内容 --&amp;gt;

     &amp;lt;!--Base  针对连接的全局设置--&amp;gt;
     &amp;lt;!--网页属性Meta的设置 ： 可提供有关页面的原信息--&amp;gt;

     &amp;lt;!--Link提供连接文件的css和js文件的导入--&amp;gt;
     &amp;lt;!--定义样式--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
   &lt;!--Body标签，作为网页内容的主体部分--&gt;
&lt;pre&gt;&lt;code&gt;    &amp;lt;!--Div 盒子标签 用来存标签--&amp;gt;
          &amp;lt;!--H1标签 样式标题1--&amp;gt;
          &amp;lt;!--Form  :action 指定的服务器地址处理表单--&amp;gt;
                &amp;lt;!--1：段落标签  P--&amp;gt;
                     &amp;lt;!--Span标签 一个小控件  不断行  P标签会断行--&amp;gt;
                     &amp;lt;!--Input标签，包含多种表单控件，比如radio  checkbox    password  text 等10种--&amp;gt;
         &amp;lt;!--Ul无序列表Unorder list--&amp;gt;
               &amp;lt;!--Li 列表行--&amp;gt;
         &amp;lt;!--Ol有序列表 OrderList--&amp;gt; 
               &amp;lt;!--Li 列表行--&amp;gt;
         &amp;lt;!--Dl定义列表--&amp;gt;
               &amp;lt;!--Dt列表行--&amp;gt;
     
        &amp;lt;!--3： 图像标签Img alt值不能超过1024个字符--&amp;gt;
        &amp;lt;!--4：表格标签Table--&amp;gt;
                       &amp;lt;!--Caption 表格标题--&amp;gt;
                       &amp;lt;!--Thead表头--&amp;gt;
                                &amp;lt;!--Th--&amp;gt;
                       &amp;lt;!--TBody 表内容--&amp;gt;
                                &amp;lt;!--Tr行数据--&amp;gt;
                                           &amp;lt;!--Td列标签--&amp;gt;
                       &amp;lt;!--TFoot表尾--&amp;gt;
        &amp;lt;!--5:超链接A实验--&amp;gt;
      &amp;lt;!--6:IFrame框架的测试--&amp;gt;
      &amp;lt;!-- 7: Form表单的测试--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;实验阶段：&lt;/p&gt;
&lt;!DOCTYPE html  &gt;
&lt;!--Html 标签是一个最大的标签，包含底下的所有标签--&gt;
&lt;Html&gt;
  &lt;!--Head标签 主要包含  &lt;Titlt   Meta  Style标签  用来充当网页的修饰部分--&gt;
  &lt;Head&gt;
    &lt;!--网页标题: 指定浏览器标题栏显示的内容 --&gt;
&lt;Title&gt; 电子名片自动绑定系统&lt;/Title&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--网页属性的设置 ： 可提供有关页面的原信息--&amp;gt;
&amp;lt;!--
  content属性  定义与http-equiv 或name属相相关的元信息
  http-equiv属性: 把content属性关联到HTTP头部
  name属性：把content属性关联到一个名称

--&amp;gt;
&amp;lt;!--base  针对连接的全局设置--&amp;gt;
&amp;lt;!--
 target 指定连接全局打开方式
 href  指定全局前缀比如  www.baiud.com  但是不可能要求所有连接以 www.baidu.com打开！
--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Base target=&#34;_blank&#34;&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!-- 通过name content对   对应  key-value 键值对   http-equav 针对不同的类型 类似于Input控件 的type存在10种类型--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Meta name=&#34;Generator&#34; content=&#34;vim&#34;/&gt;
    &lt;Meta name=&#34;Author&#34; content=&#34;yezhaoliang&#34;/&gt;
    &lt;Meta name=&#34;Keywords&#34; content=&#34;name picture&#34;/&gt;
    &lt;Meta name=&#34;Description&#34; content=&#34;&#34;/&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--做优化的时候可能需要用到keywords 优化搜索--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Meta http-equiv=&#34;keywords&#34; name=&#34;DNS&#34; content=&#34;直接数值模拟&#34;/&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!-- content=3 表示3s 之后刷新出  163.com网页--&amp;gt;
&amp;lt;!---  太烦了  3s 刷新  注释掉
&lt;/code&gt;&lt;/pre&gt;
&lt;Meta http-equiv=&#34;refresh&#34;  content=&#34;3;url=http://www.163.com&#34;/&gt;
    --&gt; 
&lt;Link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&#34;&gt;
    &lt;Link type=&#34;javascript&#34; rel=&#34;stylesheet&#34; href=&#34;&#34;&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--
 Link 控件
   rel属性  ：目标文档与当前文档的关系
   type属性 ： 文档类型
--&amp;gt;
  &amp;lt;!--设background:url(b.jpg);置背景颜色 和文字字体--&amp;gt;
&amp;lt;!--定义样式--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Style type=&#34;text/css&#34;&gt;
      body{font-family:&#34;微软雅黑&#34;}
      .box{width:600px; margin:0 auto; padding-top:100px;}
      .box 
      H1{text-align:center text-shadow:2px 5px 5px 
      rgba(0,0,2,1);color:white; }
      .box 
      p{background:#2c2c29;border-radius:10px;border:1px solid #222220;
      line-height:38px;margin-right:5px;float:left;width=600px;}
      .box 
      span{float:left;display:block;text-align:right;background:#373733
      ;width:70px;height:40px;color:#ffffff;border-right:1px solid #222220;}
      .input_box{width:167px;padding-left:10px;height:38px;border:0px;background:
      #2c2c29;float:left;color:#ffffff}
      .input_btn{width:500px;height:40px;margin-top:15px;line-height:40px;
      background:#009900;border:1px solid #0099900;border-radius:10px;
      cursor:pointer;}
      .input_btn:hover{background:#00CD00}

    &lt;/Style&gt;
  &lt;/Head&gt;
  &lt;!--Body标签，作为网页内容的主体部分--&gt;
  &lt;Body&gt;
    &lt;!--输入区域  start--&gt;
    &lt;!--Div 盒子标签 用来存标签--&gt;
    &lt;Div class=&#34;box&#34;&gt;
      &lt;!--H1标签 样式标题1--&gt;
&lt;H1&gt;
        电子名片自动绑定系统
      &lt;/H1&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;!--1：段落标签  P--&amp;gt;

  &amp;lt;!--
  Form  :action 指定的服务器地址处理表单
  method Form表单提交方式    默认get
           Post
  --&amp;gt;
  &amp;lt;!--&amp;lt;Form action=&amp;quot;www.163.com&amp;quot; method=&amp;quot;get&amp;quot;&amp;gt;--&amp;gt;
  &amp;lt;Form action=&amp;quot;http://www.163.com&amp;quot; method=&amp;quot;get&amp;quot;&amp;gt;
  &amp;lt;P&amp;gt;
    &amp;lt;!--Span标签 一个小控件  不断行  P标签会断行--&amp;gt;
    &amp;lt;!--Input--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;span&gt;姓名： &lt;/span&gt; &lt;input type=&#34;text&#34; class=&#34;input_box&#34;/&gt;&lt;br&gt;
&lt;span&gt;公司： &lt;/span&gt; &lt;input type=&#34;text&#34; class=&#34;input_box&#34;/&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;/P&amp;gt;
  &amp;lt;P&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;span&gt;职务： &lt;/span&gt; &lt;input type=&#34;text&#34; class=&#34;input_box&#34;/&gt;
&lt;span&gt;手机： &lt;/span&gt; &lt;input type=&#34;text&#34; class=&#34;input_box&#34;/&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;/P&amp;gt;
  &amp;lt;!--
  Input控件的type值共有10个值
    type=&amp;quot;text&amp;quot;    &amp;lt;-----文本按钮
    type=&amp;quot;submit&amp;quot;  &amp;lt;-----提交按钮
    type=&amp;quot;hidden&amp;quot;    &amp;lt;----隐藏字段  给服务器读取的，客户端不现实的，隐藏照样提交！也有name-value 对
    type=&amp;quot;radio&amp;quot;    &amp;lt;-----单选框
    type=&amp;quot;password&amp;quot; &amp;lt;-----密码框
    type=&amp;quot;checkbox&amp;quot; &amp;lt;-----复选框
    type=&amp;quot;reset&amp;quot;    &amp;lt;-----重置按钮
    type=&amp;quot;button&amp;quot;   &amp;lt;-----按钮
    type=&amp;quot;file&amp;quot;     &amp;lt;-----文件上传
    type=&amp;quot;image&amp;quot;    &amp;lt;-----图像
    type=&amp;quot;text&amp;quot;
    type=&amp;quot;text&amp;quot;
  --&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Input type=&#34;submit&#34; value=&#34;生成名片&#34; class=&#34;input_btn&#34;/&gt;
      &lt;Input type=&#34;button&#34; value=&#34;按钮&#34; class=&#34;input_btn&#34;/&gt;
      &lt;Input type=&#34;image&#34; value=&#34;图像&#34; class=&#34;input_btn&#34;/&gt;
      &lt;Input type=&#34;file&#34; value=&#34;文件上传&#34; class=&#34;input_btn&#34;/&gt;
      &lt;Input type=&#34;reset&#34; value=&#34;重置按钮&#34; class=&#34;input_btn&#34;/&gt;
      &lt;Input type=&#34;checkbox&#34; value=&#34;复选框&#34; class=&#34;input_btn&#34;/&gt;
      &lt;Input type=&#34;radio&#34; value=&#34;单选框&#34; class=&#34;input_btn&#34;/&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;!--新加入的部分，另外一种使用radio控件--&amp;gt;
  &amp;lt;!--
    注意：
        Input的  name  value  其实就是key=value的组合！！hashmap的过程！
        观察发现所有的表单控件都是基于HashMap的过程
        也就是所有的Input控件都有name value的属性，充当表单信息，这很重要
  --&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;Input type=&#34;radio&#34; name=&#34;gender&#34; value=&#34;男&#34;/&gt;男&lt;Input type=&#34;radio&#34; name=&#34;gender&#34; value=&#34;女&#34;&gt;女&lt;/br&gt;
&lt;Input type=&#34;password&#34; value=&#34;密码框&#34; class=&#34;input_btn&#34;/&gt;
&lt;Input type=&#34;hidden&#34; value=&#34;隐藏字段&#34; class=&#34;input_btn&#34;/&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;/Form&amp;gt;
&amp;lt;/Div&amp;gt;
    &amp;lt;!--2：列表实验--&amp;gt;
&amp;lt;Div&amp;gt;
  &amp;lt;!--无序列表--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Ul&gt;
        &lt;Li&gt;流体&lt;/Li&gt;
        &lt;Li&gt;结构&lt;/Li&gt;
        &lt;Li&gt;耦合&lt;/Li&gt;
      &lt;/Ul&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;!--有序列表--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Ol&gt;
        &lt;Li&gt;Ansys&lt;/Li&gt;
        &lt;Li&gt;Fluent&lt;/Li&gt;
        &lt;Li&gt;ICEM&lt;/Li&gt;
      &lt;/Ol&gt;
&lt;p&gt;&lt;A name=&#34;double1&#34;&gt;定位标记&lt;/A&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;!--定义列表--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;Dl&gt;
        &lt;Dt&gt;网格&lt;/Dt&gt;
          &lt;Dd&gt;ICEM&lt;/Dd&gt;
          &lt;Dd&gt;Gambit&lt;/Dd&gt;
          &lt;Dt&gt;求解器&lt;/Dt&gt;
          &lt;Dd&gt;Fluent&lt;/Dd&gt;
          &lt;Dd&gt;Numeca&lt;/Dd&gt;
          &lt;Dd&gt;Abaqus&lt;/Dd&gt;
      &lt;/Dl&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;/Div&amp;gt;
&amp;lt;!--3： 图像标签 alt值不能超过1024个字符--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Div&gt;
      &lt;img src=&#34;b.jpg&#34; border=&#34;3px&#34; title=&#34;书签&#34; alt=&#34;资源找不到时候，我就出现了&#34;,width=500px,height=200px/&gt;
    &lt;/Div&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--4：表格标签--&amp;gt;
&amp;lt;!-- Table属性：cellpadding 单元格内容与边框的距离
                cellspacing 单元格与相邻单元格之间的距离 
      Td常用属性：
                colspan:合并单元格
                rowspan：合并同列单元格
      每个Table可以有一个表头Thead、表尾TFoot和一个或多个标题TBody
      TBody的分行下载是一个网页优化的一个方法
--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Div&gt;
&lt;pre&gt;&lt;code&gt;  &amp;lt;Table border=2px; width=300px; cellpadding=1px; cellspacing=1px;&amp;gt;
    &amp;lt;Caption&amp;gt;关于表格的实验&amp;lt;/Caption&amp;gt;
    &amp;lt;Thead&amp;gt;
      &amp;lt;Th&amp;gt;姓名&amp;lt;/Th&amp;gt; &amp;lt;!--对表格的第一行或者第一列进行格式化 c粗体剧中显示--&amp;gt;
      &amp;lt;Th&amp;gt;年龄&amp;lt;/Th&amp;gt;
    &amp;lt;/Thead&amp;gt;

    &amp;lt;TBody&amp;gt;
      &amp;lt;Tr&amp;gt; &amp;lt;!--行标签--&amp;gt;
        &amp;lt;Td&amp;gt;张三&amp;lt;/Td&amp;gt;&amp;lt;Td&amp;gt;20&amp;lt;/Td&amp;gt;  &amp;lt;!--单元格标签--&amp;gt;
      &amp;lt;/Tr&amp;gt;
      &amp;lt;Tr&amp;gt; &amp;lt;!--行标签--&amp;gt;
        &amp;lt;Td&amp;gt;李四&amp;lt;/Td&amp;gt;&amp;lt;Td&amp;gt;30&amp;lt;/Td&amp;gt;  &amp;lt;!--单元格标签--&amp;gt;
      &amp;lt;/Tr&amp;gt;
    &amp;lt;/TBody&amp;gt;
  &amp;lt;/Table&amp;gt;
&amp;lt;/Div&amp;gt;



&amp;lt;!--5:超链接实验--&amp;gt;
&amp;lt;!--
  _blank  在一个新的网页标签打开链接
  _parent 在父级窗口中打开
  _self   在自身页面中打开链接（默认）
  _top    在整个浏览器的最顶端(前端)开始打开链接

  定位标记+超链接
  &amp;lt;A name=&amp;quot;标记名字&amp;quot;&amp;gt; 标记在某一个位置&amp;lt;/A&amp;gt;
  找到他
  &amp;lt;A href=&amp;quot;#标记名字&amp;quot;&amp;gt;返回标记位置&amp;lt;/A&amp;gt;

  注意： 1 定位标记要和超链接结合使用才有效  标记名字用#找到
         2 在网页过长才有效果 
--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Div&gt;
      &lt;P&gt;&lt;A href=&#34;http://www.163.com&#34; target=&#34;_blank&#34;&gt;网易&lt;/A&gt;&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;P&gt;..&lt;/P&gt;
          &lt;A href=&#34;#double1&#34;&gt;去寻找标记&lt;/A&gt;
    &lt;/Div&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--6:IFrame框架的测试--&amp;gt;
&amp;lt;!--
  在网页上嵌入一个框，显示另一个html,txt等文件信息
--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;Div&gt;
      &lt;IFrame src=&#34;student.txt&#34;&gt;
        如果你看到这段文字，说明您的浏览器不支持IFrame标签
        &lt;/IFrame&gt;
    &lt;/Div&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!-- 7: Form表单的测试--&amp;gt;
&amp;lt;!--
  Form是最常用的控件，主要用于采集和提交用户输入的信息
  和服务器进行交互
--&amp;gt;
&amp;lt;Div&amp;gt;
&amp;lt;!--关于Input测试已在前面提及--&amp;gt;
&amp;lt;!--Select 其实就是Combobox--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Select name=&#34;city&#34;&gt;
      &lt;Option value=&#34;1&#34;&gt;北京&lt;/Option&gt;
      &lt;Option value=&#34;2&#34;&gt;福建&lt;/Option&gt;
      &lt;Option value=&#34;3&#34;&gt;广州&lt;/Option&gt;
    &lt;/Select&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!-- 更好的办法是使用CSS的height &amp;amp; width替换掉rows cols--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Textarea rows=&#34;3&#34; cols=&#34;20&#34;&gt;&lt;/Textarea&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--Radio type 和 Label配合使用 --&amp;gt;
&amp;lt;!--Label标签做了一个字段的包装，这样用户点击字段 也可以选择！！！新的知识点啊！--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;Label for=&#34;male&#34;&gt; Male&lt;/Label&gt;
&lt;Input type=&#34;radio&#34; name=&#34;sex&#34; id=&#34;male&#34;/&gt;
&lt;Label for=&#34;female&#34;&gt; Female&lt;/Label&gt;
&lt;Input type=&#34;radio&#34; name=&#34;sex&#34; id=&#34;female&#34;/&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;/Div&amp;gt;

&amp;lt;!--这么有趣  HTML也有块级元素的说法--&amp;gt;
&amp;lt;!--
 1: 块级元素 通常以新行开始和结束
 比如   &amp;lt;H1&amp;gt;  &amp;lt;P&amp;gt; &amp;lt;Ul&amp;gt;  &amp;lt;Table&amp;gt;   &amp;lt;Tr&amp;gt;  &amp;lt;Div&amp;gt;
 2：内联元素 通常不以新行开始
 &amp;lt;Td&amp;gt; &amp;lt;B&amp;gt; &amp;lt;A&amp;gt; &amp;lt;Img&amp;gt;  &amp;lt;Span&amp;gt;
  3: Div   and   Span  主要用于文档的样式属性的区域设置
--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/Body&gt;
&lt;/Html&gt;
&lt;!--Framset 用于设置框架的大小比例--&gt;
&lt;!--Frame用于加载网页文件--&gt;
&lt;Html&gt;
  &lt;!--Framset 用于设置框架的大小比例--&gt;
  &lt;!--
    frameset常用属性：
       cols=20%,*   垂直切割画面，左右两个画面
       Rows=&#34;120,*&#34;  横向切割，上下分开
       frameborder    0 and 1. 0 表示不要边框 
       border=&#34;0&#34;  边框厚度
       bordercolor=&#39;&#34;#99&#34;
       framespace=&#34;5&#34; 框架与框架间保留的空白距离
  --&gt;
&lt;Frameset rows=&#34;20%,*&#34;&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--Frame用于加载网页文件--&amp;gt;
&amp;lt;!--
frame常用属性
src=&amp;quot;*.html&amp;quot; 每个frame框对应一个网页档案
name=&amp;quot;top&amp;quot; 设置这个窗的名称
scrolling=auto|yes|no
noresize=&amp;quot;noresize&amp;quot;   表示框框不可以拖拽！！

--&amp;gt;
&amp;lt;!--
Frameset = Noframes+frame--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;Noframes&gt;
      &lt;Div&gt;
        当你的浏览器不支持Frame时候会显示这段文字，一般很少。 
      &lt;/Div&gt;
    &lt;/Noframes&gt;
  &lt;Frame src=&#34;rupeng.html&#34;&gt;
&lt;Frameset cols = &#34;25%,75%&#34;&gt;
      &lt;Frame src=&#34;plan.html&#34;&gt;
      &lt;Frame src=&#34;student.txt&#34;&gt;
    &lt;/Frameset&gt;
  &lt;/Frameset&gt;
&lt;/Html&gt;
&lt;p&gt;Frame Name的使用&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;Html&amp;gt;
  &amp;lt;Head&amp;gt;
    &amp;lt;Meta http-equiv=&amp;quot;Content-Type&amp;quot; content=&amp;quot;text/html; charset=utf-8&amp;quot;/&amp;gt;
    &amp;lt;Title&amp;gt; 我喜欢的样式 &amp;lt;/Title&amp;gt;
  &amp;lt;/Head&amp;gt;
  &amp;lt;Frameset rows=&amp;quot;12%,*&amp;quot; frameborder=&amp;quot;1&amp;quot; border=&amp;quot;1px&amp;quot; bordercolor=&amp;quot;#FF0000&amp;quot;&amp;gt;
    &amp;lt;Frame src=&amp;quot;top.html&amp;quot; scrolling=&amp;quot;no&amp;quot; noresize=&amp;quot;noresize&amp;quot;/&amp;gt;
    &amp;lt;FrameSet cols=&amp;quot;20%,*&amp;quot;&amp;gt;
      &amp;lt;!-- name的作用是让left.html的A连接的target属性 可以选择以name名字打开！！
            这是一个全新的知识点，妙--&amp;gt;
      &amp;lt;Frame src=&amp;quot;left.html&amp;quot; name=&amp;quot;left&amp;quot;/&amp;gt;
      &amp;lt;Frame src=&amp;quot;right.html&amp;quot; name=&amp;quot;right&amp;quot;/&amp;gt;
      &amp;lt;/Frameset&amp;gt;&amp;lt;Noframes&amp;gt;&amp;lt;/Noframes&amp;gt;
&amp;lt;/Html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>2月14日Java班mysql</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-14ri-javaban-mysql/</link>
      <pubDate>Mon, 11 May 2015 14:58:41 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-14ri-javaban-mysql/</guid>
      <description>&lt;p&gt;第一部分 笔记&lt;/p&gt;
&lt;p&gt;1：关于事务在命令窗口的练习：
事务  就是一连串命令的集合，只要这部命令都执行完毕，才能更新到数据库中，否则退出！！即使有一行比如 null.length()的存在空指针，则不成功。
一旦执行失败则回滚。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; begin;
Query OK, 0 rows affected (0.00 sec)

mysql&amp;gt; update t_person set age=age+1 where Name=&#39;yezhao&#39;;
Query OK, 2 rows affected (0.35 sec)
Rows matched: 2  Changed: 2  Warnings: 0

mysql&amp;gt; select * from t_person where Name=&#39;yezhao&#39;;
+----+--------+-----+--------+
| Id | Name   | Age | Gender |
+----+--------+-----+--------+
|  1 | yezhao |  25 |      1 |
|  7 | yezhao |  26 |      1 |
+----+--------+-----+--------+
2 rows in set (0.02 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然而在navicat的显示结果是之前的信息  也就是  24  25，当在cmd窗口执行完commit之后：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; commit;
Query OK, 0 rows affected (0.11 sec)

mysql&amp;gt; select * from t_person where Name=&#39;yezhao&#39;;
+----+--------+-----+--------+
| Id | Name   | Age | Gender |
+----+--------+-----+--------+
|  1 | yezhao |  25 |      1 |
|  7 | yezhao |  26 |      1 |
+----+--------+-----+--------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;navicat也会发生相应的变化：
1        yezhao        25        1
7        yezhao        26        1&lt;/p&gt;
&lt;p&gt;java的conn.setAutoCommit(false);//相当于begin的作用
所以：只有commit之后mysql信息才会在不同的客户端同步，现在尝试在java中的使用，已在练习部分给出，&lt;/p&gt;
&lt;p&gt;2.在没有批量导入数据之前，一般是需要花费很长的时间，现在采用addbatch进行。
ps.clearParameters()的作用是清空上一次数据的值，不影响到下一次&lt;/p&gt;
&lt;p&gt;而一般数据量大的情况下，导入可能会出现问题，这样如果批量导入在事务中运行，将会更加保险，已在练习给出。
注意加入事物的时候，抛出异常时候采用conn.rollback();把executeUpdate()改成addBatch()，在最后再ps.executeBatch()&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;mysql获取最后一次插入的id号函数，在java中也可以实现。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select last_insert_id();
+------------------+
| last_insert_id() |
+------------------+
|                0 |
+------------------+
1 row in set (0.17 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;有没有发现是0 ，即使是我最新插入也是这样；调查后发现是：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; insert into t_person(Name,Age,Gender) values (&#39;悟空&#39;,30,1);
Query OK, 1 row affected (0.04 sec)

mysql&amp;gt; select last_insert_id();
+------------------+
| last_insert_id() |
+------------------+
|            11317 |
+------------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果你添加的时候，不要写上主键的值，则是可以！如果直接加上主键的值，则显示的是0！&lt;/p&gt;
&lt;p&gt;第二部分 练习
1.一个比较戳版本的JDBCUtils的版本，虽然没有错误，但是未关闭连接，且整体逻辑性不强，并多次加载驱动&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

import java.util.Properties;
import java.io.*;
import java.sql.*;
/**
* @author    叶昭良
* @time      2015年2月17日下午11:31:53
* @version   com.jdbc.testJDBCUtils V1.0
*/
public class JDBCUtils
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                
                try
                {
                        
        //查询的测试分为三个阶段    无参 的两个   有参的一个
                        //测试1   success
                        /**
                         *  mysql&amp;gt; select * from t_person;
                         *  6 rows in set (0.35 sec)
                         */
                        /*
                        Connection conn = JDBCUtils.createConnection() ;
                        ResultSet rs = JDBCUtils.executeQuery(conn, &amp;quot;select * from t_person&amp;quot;, null);
                        int i = 0;
                        while(rs.next())
                        {
                                i++;
                        }
                        System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);
                        */
                        //测试2   success
                        /**
                         *  mysql&amp;gt; select * from t_person;
                         *  6 rows in set (0.35 sec)
                         */
                        /*
                        ResultSet rs = JDBCUtils.executeQuery( &amp;quot;select * from t_person&amp;quot;, null);
                        int i = 0;
                        while(rs.next())
                        {
                                i++;
                        }
                        System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);
                        */
                        
                        //测试3    success
                        /* mysql&amp;gt; select * from t_person where name=&#39;xinran&#39;
                         * 3 rows in set (0.00 sec)
                         */
/*                        ResultSet rs = JDBCUtils.executeQuery(&amp;quot;select * from t_person where name = ?&amp;quot;, &amp;quot;xinran&amp;quot;);
                        int i = 0;
                        while(rs.next())
                        {
                                i++;
                        }
                        System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);*/
                        
        //插入阶段的测试   类似查询分为三个阶段    无参 的两个   有参的一个
                        /**
                         * 测试成功！ //1
                         */
                        /*Connection conn = JDBCUtils.createConnection() ;
                        int i = JDBCUtils.executeUpdate(conn, &amp;quot;insert into t_person(Id,Name,Age,Gender) values(8,&#39;lizi&#39;,82,1)&amp;quot;, null);

                        //System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);

            */        
                        /**
                         * 测试成功！ //2 没想到只要两行语句 则进行了一次插入
                         */
                        /*String sql = &amp;quot;insert into t_person(Id,Name,Age,Gender) values(9,&#39;孙悟空&#39;,12,1)&amp;quot;; //年龄不能过大
                        JDBCUtils.executeUpdate(sql, null);*/
                        
                        /**
                         *  测试成功！  //3  连有参的形式也是成功了
                         *  mysql&amp;gt; select * from t_person;
                        +----+---------+-----+--------+
                        | Id | Name    | Age | Gender |
                        +----+---------+-----+--------+
                        |  1 | yezhao  |  24 |      1 |
                        |  3 | xinran  |  32 |      0 |
                        |  4 | xinran  |  32 |      4 |
                        |  5 | xinran  |  32 |      4 |
                        |  6 | yezhao1 |  25 |      0 |
                        |  7 | yezhao  |  25 |      1 |
                        |  8 | lizi    |  82 |      1 |
                        |  9 | 孙悟空  |  12 |      1 |
                        | 10 | 蝴蝶    |   3 |      0 |
                        +----+---------+-----+--------+
                        9 rows in set (0.00 sec)
                         */
                        String sql = &amp;quot;insert into t_person(Id,Name,Age,Gender) values(?,?,?,?)&amp;quot;; //年龄不能过大
                        JDBCUtils.executeUpdate(sql, 11,&amp;quot;孟彩兰&amp;quot;,13,1);
                        
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
        }
        
        
        public static  Connection createConnection() throws SQLException
        {
                InputStream is = JDBCUtils.class.getClassLoader().getResourceAsStream(&amp;quot;com/jdbc/test/sql.properties&amp;quot;);
                 
                //InputStream is = JDBCUtils.class.getClassLoader().getResourceAsStream(&amp;quot;sql.properties&amp;quot;);
                Properties ps  = new Properties();
                Connection c1 = null;
                try
                {
                        ps.load(is);
                        String mysqlDriver = ps.getProperty(&amp;quot;mysqlDriver&amp;quot;);
//                        System.out.println(mysqlDriver);
                        
                        String connectDatabase = ps.getProperty(&amp;quot;connectDatabase&amp;quot;);
//                        System.out.println(connectDatabase);
                        
                        String userName = ps.getProperty(&amp;quot;userName&amp;quot;);
//                        System.out.println(userName);
                        
                        String Password = ps.getProperty(&amp;quot;Password&amp;quot;);
//                        System.out.println(Password);
                        
                        Class.forName(mysqlDriver);
                        
                        c1 = DriverManager.getConnection(connectDatabase,userName,Password);
                        System.out.println(&amp;quot;连接成功&amp;quot;);
                } catch (IOException | ClassNotFoundException | SQLException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;数据库驱动加载失败&amp;quot;+e.getMessage());
                        return null;
                }
                return c1;
        }

        public static int executeUpdate(String sql,Object... parameter) throws SQLException
        {
                Connection conn = JDBCUtils.createConnection();
                PreparedStatement ps = conn.prepareStatement(sql);
                int i = 1;
                if(parameter != null)
                {
                        for(Object pa1:parameter)
                        {
                                ps.setObject(i, pa1);
                                i++;
                        }
                }
                int rows = ps.executeUpdate();
                System.out.println(&amp;quot;有&amp;quot;+rows+&amp;quot;条记录被影响&amp;quot;);
                return rows;
        }
        
        public static int executeUpdate(Connection conn,String sql,Object... parameter) throws SQLException
        {
                PreparedStatement ps = conn.prepareStatement(sql);
                int i = 1;
                if(parameter != null)
                {
                        for(Object pa1:parameter)
                        {
                                ps.setObject(i, pa1);
                                i++;
                        }
                }
                int rows = ps.executeUpdate();
                System.out.println(&amp;quot;有&amp;quot;+rows+&amp;quot;条记录被影响&amp;quot;);
                return rows;
        }
        
        public static ResultSet executeQuery(String sql,Object... parameter) throws SQLException
        {
                Connection conn = JDBCUtils.createConnection();
                PreparedStatement ps = conn.prepareStatement(sql);
                int i =1;
                if(parameter != null)
                {
                        for(Object pa1:parameter)
                        {
                                ps.setObject(i, pa1);
                                i++;
                        }
                }
                ResultSet rs = ps.executeQuery();
                return rs;
        }
        
        public static ResultSet executeQuery(Connection conn,String sql,Object... parameter) throws SQLException
        {
                PreparedStatement ps = conn.prepareStatement(sql);
                int i =1;
                if(parameter != null)
                {
                        for(Object pa1:parameter)
                        {
                                ps.setObject(i, pa1);
                                i++;
                        }
                }
                ResultSet rs = ps.executeQuery();
                return rs;
        }
        
        static void closeQuietly(PreparedStatement ps)
        {
                if(ps!= null)
                {
                        try
                        {
                                ps.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
        
        static void closeQuietly(Connection conn)
        {
                if(conn!= null)
                {
                        try
                        {
                                conn.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
        static void closeQuietly(ResultSet rs)
        {
                if(rs!= null)
                {
                        try
                        {
                                rs.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;新一个版本的改进，主要是利用杨老师讲的 静态代码块仅仅一次加载驱动！ 并关闭有些使用的资源，ResultSet资源不关闭，由调用者去关闭&lt;/p&gt;
&lt;p&gt;2.新的版本真是比较清晰。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

import java.util.Properties;
import java.io.*;
import java.sql.*;
/**
* @author    叶昭良
* @time      2015年2月17日下午11:31:53
* @version   com.jdbc.testJDBCUtils V1.0
*                         V2.0  改变配置文件变为为final，并把sql.properties文件提到
*                                 com.jdbc目录下 com/jdbc/test/sql.properties
*                                 测试通过
*          V3.0 改变为静态代码段 加载驱动！ 并把加载配置文件
*               也放在静态代码段中！仅仅加载一次即可！而不需要
*               一直加载
*          V4.0 修正了没有close的问题！！防止一直连着。 明白了吃异常的过程
*                在类库中不知道怎么处理！直接抛出异常即可！让调用者自己去处理！
*                咱们提供方法，不提供异常的处理！打印异常不叫做处理！而叫做“吃异常”
*          V5.0  不吃异常的方式就是 throw new RuntimeException ，静态代码段
*                  无法throw checkedException检查异常
*                没想到经过这样的过程封装比我原先的好看多了！而且逻辑更加清晰
*                
*/
public class JDBCUtils
{

        /**
         * @param args
         */
        private static final String mysqlDriver;
        private static final String connectDatabase;
        private static final String userName;
        private static final String Password;
        static
        {
                InputStream is = null; 
                //InputStream is = JDBCUtils.class.getClassLoader().getResourceAsStream(&amp;quot;sql.properties&amp;quot;);
                Properties ps  = new Properties();
                Connection c1 = null;
                try
                {
                        is = JDBCUtils.class.getClassLoader().getResourceAsStream(&amp;quot;&amp;quot;
                                        + &amp;quot;com/jdbc/test/sql.properties&amp;quot;);
                        ps.load(is);
                        mysqlDriver = ps.getProperty(&amp;quot;mysqlDriver&amp;quot;);
//                        System.out.println(mysqlDriver);
                        connectDatabase = ps.getProperty(&amp;quot;connectDatabase&amp;quot;);
        //                        System.out.println(connectDatabase);
                        userName = ps.getProperty(&amp;quot;userName&amp;quot;);
        //                        System.out.println(userName);
                        Password = ps.getProperty(&amp;quot;Password&amp;quot;);
        //                        System.out.println(Password);
                        //仅仅在静态代码段中加载一次驱动即可（在运行中）
                        
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        //System.out.println(&amp;quot;配置文件加载失败&amp;quot;+e.getMessage());
                        throw new RuntimeException(&amp;quot;配置文件sql.properties加载失败&amp;quot;+e.getMessage());
                        //return null;
                }
                try
                {
                        Class.forName(mysqlDriver); //仅仅在程序运行中加载一次驱动即可！！！
                } catch (ClassNotFoundException e)
                {
                        // TODO Auto-generated catch block
//                        System.out.println(&amp;quot;驱动加载失败&amp;quot;+e.getMessage());
                        throw new RuntimeException(&amp;quot;驱动加载失败&amp;quot;+e.getMessage());
                }

        }
        
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                
                try
                {
                        
        //查询的测试分为三个阶段    无参 的两个   有参的一个
                        //测试1   success
                        /**
                         *  mysql&amp;gt; select * from t_person;
                         *  6 rows in set (0.35 sec)
                         */
                        /*
                        Connection conn = JDBCUtils.createConnection() ;
                        ResultSet rs = JDBCUtils.executeQuery(conn, &amp;quot;select * from t_person&amp;quot;, null);
                        int i = 0;
                        while(rs.next())
                        {
                                i++;
                        }
                        System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);
                        */
                        //测试2   success
                        /**
                         *  mysql&amp;gt; select * from t_person;
                         *  6 rows in set (0.35 sec)
                         */
                        /*
                        ResultSet rs = JDBCUtils.executeQuery( &amp;quot;select * from t_person&amp;quot;, null);
                        int i = 0;
                        while(rs.next())
                        {
                                i++;
                        }
                        System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);
                        */
                        
                        //测试3    success
                        /* mysql&amp;gt; select * from t_person where name=&#39;xinran&#39;
                         * 3 rows in set (0.00 sec)
                         */
/*                        ResultSet rs = JDBCUtils.executeQuery(&amp;quot;select * from t_person where name = ?&amp;quot;, &amp;quot;xinran&amp;quot;);
                        int i = 0;
                        while(rs.next())
                        {
                                i++;
                        }
                        System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);*/
                        
        //插入阶段的测试   类似查询分为三个阶段    无参 的两个   有参的一个
                        /**
                         * 测试成功！ //1
                         */
                        /*Connection conn = JDBCUtils.createConnection() ;
                        int i = JDBCUtils.executeUpdate(conn, &amp;quot;insert into t_person(Id,Name,Age,Gender) values(8,&#39;lizi&#39;,82,1)&amp;quot;, null);

                        //System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);

            */        
                        /**
                         * 测试成功！ //2 没想到只要两行语句 则进行了一次插入
                         */
                        /*String sql = &amp;quot;insert into t_person(Id,Name,Age,Gender) values(9,&#39;孙悟空&#39;,12,1)&amp;quot;; //年龄不能过大
                        JDBCUtils.executeUpdate(sql, null);*/
                        
                        /**
                         *  测试成功！  //3  连有参的形式也是成功了
                         *  mysql&amp;gt; select * from t_person;
                        +----+---------+-----+--------+
                        | Id | Name    | Age | Gender |
                        +----+---------+-----+--------+
                        |  1 | yezhao  |  24 |      1 |
                        |  3 | xinran  |  32 |      0 |
                        |  4 | xinran  |  32 |      4 |
                        |  5 | xinran  |  32 |      4 |
                        |  6 | yezhao1 |  25 |      0 |
                        |  7 | yezhao  |  25 |      1 |
                        |  8 | lizi    |  82 |      1 |
                        |  9 | 孙悟空  |  12 |      1 |
                        | 10 | 蝴蝶    |   3 |      0 |
                        +----+---------+-----+--------+
                        9 rows in set (0.00 sec)
                         */
                        String sql = &amp;quot;insert into t_person(Id,Name,Age,Gender) values(?,?,?,?)&amp;quot;; //年龄不能过大
                        JDBCUtils.executeUpdate(sql, 12,&amp;quot;孟江虎&amp;quot;,15,0);
                        
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
        }
        
        /**
         * 创建数据库的连接
         * @return   返回mysql的连接
         */
        public static  Connection createConnection() 
        {
                Connection c1  = null;
                try
                {
                        
                  c1 = DriverManager.getConnection(connectDatabase,userName,Password);
                        System.out.println(&amp;quot;连接成功&amp;quot;);
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;数据库连接创建失败&amp;quot;+e.getMessage());
                        return null;
                }
                return c1;
        }
        /**
         * 
         * @param sql        sql的update,delete,insert等修改数据库的语句
         * @param parameter  参数化的update,delete,insert等的设置 
         * @return           返回被影响的函数
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static int executeUpdate(String sql,Object... parameter) throws SQLException
        {
                Connection conn = null;
                PreparedStatement ps = null;
                int rows = 0;
                try
                {
                        conn = JDBCUtils.createConnection();
                        ps = conn.prepareStatement(sql);
                        int i = 1;
                        if(parameter != null)
                        {
                                for(Object pa1:parameter)
                                {
                                        ps.setObject(i, pa1);
                                        i++;
                                }
                        }
                        rows = ps.executeUpdate();
                }finally
                {
                        JDBCUtils.closeQuietly(ps);
                }
                System.out.println(&amp;quot;有&amp;quot;+rows+&amp;quot;条记录被影响&amp;quot;);
                return rows;
        }
        /**
         * @param conn       数据库的连接
         * @param sql        sql的update,delete,insert等修改数据库的语句
         * @param parameter  参数化的update,delete,insert等的设置 
         * @return           返回被影响的函数
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static int executeUpdate(Connection conn,String sql,Object... parameter) throws SQLException
        {
                PreparedStatement ps = null;
                int rows = 0;
                try
                {
                        ps = conn.prepareStatement(sql);
                        int i = 1;
                        if(parameter != null)
                        {
                                for(Object pa1:parameter)
                                {
                                        ps.setObject(i, pa1);
                                        i++;
                                }
                        }
                        rows = ps.executeUpdate();
                }finally
                {
                        JDBCUtils.closeQuietly(ps);
                }
                
                System.out.println(&amp;quot;有&amp;quot;+rows+&amp;quot;条记录被影响&amp;quot;);
                return rows;
        }
        /**
         * 
         * @param sql        sql的select不修改数据库的语句
         * @param parameter  参数化的查询，参数集的设置 
         * @return           返回查询的数据集
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static ResultSet executeQuery(String sql,Object... parameter) throws SQLException
        {
                Connection conn = null;
                PreparedStatement ps = null;
                try
                {
                        conn = JDBCUtils.createConnection();
                        ps = conn.prepareStatement(sql);
                        int i =1;
                        if(parameter != null)
                        {
                                for(Object pa1:parameter)
                                {
                                        ps.setObject(i, pa1);
                                        i++;
                                }
                        }
                        ResultSet rs = ps.executeQuery();
                        //因为finally是肯定会被执行的片段  即使他放在return之后
                        return rs;
                }finally
                {
                        JDBCUtils.closeQuietly(ps);
                }
                
                
        }
        /**
         * @param conn       数据库连接
         * @param sql        sql的select不修改数据库的语句
         * @param parameter  参数化的查询，参数集的设置 
         * @return           返回查询的数据集
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static ResultSet executeQuery(Connection conn,String sql,Object... parameter) throws SQLException
        {
                PreparedStatement ps = null;
                try
                {
                        ps = conn.prepareStatement(sql);
                        int i =1;
                        if(parameter != null)
                        {
                                for(Object pa1:parameter)
                                {
                                        ps.setObject(i, pa1);
                                        i++;
                                }
                        }
                        ResultSet rs = ps.executeQuery();
                        return rs;
                }finally
                {
                        JDBCUtils.closeQuietly(ps);
                }
                
        }
        /**
         *  关闭PreparedStatment连接
         * @param ps   PreparedStatment对象
         */
        static void closeQuietly(PreparedStatement ps)
        {
                if(ps!= null)
                {
                        try
                        {
                                ps.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
        /**
         *  关闭Connection连接
         * @param connn   Connection对象
         */
        static void closeQuietly(Connection conn)
        {
                if(conn!= null)
                {
                        try
                        {
                                conn.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
        /**
         *  关闭ResultSet连接
         * @param rs   ResultSet对象
         */
        static void closeQuietly(ResultSet rs)
        {
                if(rs!= null)
                {
                        try
                        {
                                rs.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;原来自己又没有理解清楚，我们实际用的较多executeUpdate和executeQuery的无conn
的形式，而带conn只是一个中间过程！ 并且无conn的会调用有conn的形式！同时这也是一个比较好的习惯！只要改一个地方就都改了！&lt;/p&gt;
&lt;p&gt;而且并且改掉代码的重复片段，一举多得，并且思路更清晰！
学习，札记。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
         * 
         * @param sql        sql的update,delete,insert等修改数据库的语句
         * @param parameter  参数化的update,delete,insert等的设置 
         * @return           返回被影响的函数
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static int executeUpdate(String sql,Object... parameter) throws SQLException
        {
                Connection conn = null;
                try
                {
                        conn = JDBCUtils.createConnection();
                        return executeUpdate(conn, sql, parameter);
                }finally
                {
                        JDBCUtils.closeQuietly(conn);
                }
        }

        /**
         * 
         * @param sql        sql的select不修改数据库的语句
         * @param parameter  参数化的查询，参数集的设置 
         * @return           返回查询的数据集
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static ResultSet executeQuery(String sql,Object... parameter) throws SQLException
        {
                Connection conn = null;
                try
                {
                        conn = JDBCUtils.createConnection();
                        return executeQuery(conn,sql, parameter);
                }finally
                {
                        JDBCUtils.closeQuietly(conn);
                }
                
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;漂亮，优雅！！！美丽&lt;/p&gt;
&lt;p&gt;3测试了一个多次插入的案例：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
                 *  测试结果： 单个连接 插入100条数据耗时3767 
                 */
/*                        long startTime = System.currentTimeMillis();
                        String sql = &amp;quot;insert into t_person(Id,Name,Age,Gender) values(?,?,?,?)&amp;quot;;
                        Connection conn = null;
                        try
                        {
                                conn = JDBCUtils.createConnection();
                                //原先有数据！并且主键不能重复 所以只好从18开始
                                for(int i = 15; i &amp;lt; 115; i++)
                                {
                                        JDBCUtils.executeUpdate(conn,sql, i,&amp;quot;SpringDay&amp;quot;,17,1);
                                }
                                System.out.println(&amp;quot;单个连接 插入100条数据耗时&amp;quot;+(System.currentTimeMillis()
                                                -startTime));

                        }catch(SQLException e)
                        {
                                System.out.println(&amp;quot;数据库连接异常&amp;quot;);
                        }finally
                        {
                                JDBCUtils.closeQuietly(conn);
                        }*/
                /**
                 * 一个连接 插入一条数据 100条后耗时7850  
                 *   可见这种方式还是相对较慢的！！！！
                 *   总结   在多次插入数据库中！最好是一次连接，不要关闭，插入完在关闭
                 */
                long startTime = System.currentTimeMillis();
                String sql = &amp;quot;insert into t_person(Id,Name,Age,Gender) values(?,?,?,?)&amp;quot;;
                try
                {
                        for(int i = 116; i &amp;lt; 216; i++)
                        {
                                JDBCUtils.executeUpdate(sql, i,&amp;quot;SpringDay&amp;quot;,17,1);
                        }
                        System.out.println(&amp;quot;一个连接 插入一条数据 100条后耗时&amp;quot;+(System.currentTimeMillis()
                                        -startTime));
                }catch(SQLException e)
                {
                        System.out.println(&amp;quot;连接失败！主键有问题&amp;quot;+e.getMessage());
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;总结 在多次插入数据库中！最好是一次连接，不要关闭，插入完在关闭&lt;/p&gt;
&lt;p&gt;再次改进！不需要把executeQuery的connection关闭&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;*                由于PreparedStatement 来自Statement
*                rs.getStatement() 表示返回一个statement，而不会关闭PreparedStatement
*                常见了一个closeAll(),这也是为什么 暂时不关闭查询连接的原因，同时不关闭
*                方便进行多次查询，反复查询

/**
         * 从resultSet中关闭所有的连接
         * @param rs
         */
        static void closeAll(ResultSet rs)
        {
                if(rs == null)
                {
                        return;
                }
                try
                {
                        JDBCUtils.closeQuietly(rs.getStatement().getConnection());
                        JDBCUtils.closeQuietly(rs.getStatement());
                        JDBCUtils.closeAll(rs);
                }catch(SQLException e)
                {
                        
                }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;并且必须修正 executeQuery的函数，把原先的JDBCUtils.closeQuietly(ps)关掉！ 否则报错！出现异常，然后就可以很happy的使用JDBCUtils了&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;  ResultSet rs = null;
                String sql = &amp;quot;select * from t_person&amp;quot;;
                try
                {
                        rs = executeQuery(sql);
                        while(rs.next())
                        {
                                String Name= rs.getString(&amp;quot;Name&amp;quot;);
                                System.out.println(Name);
                        }
                }catch(SQLException e)
                {
                        System.out.println(&amp;quot;居然报错&amp;quot;);
                }finally
                {
                        JDBCUtils.closeAll(rs);
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4午饭前版本的JDBCUtils：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

import java.util.Properties;
import java.io.*;
import java.sql.*;
/**
* @author    叶昭良
* @time      2015年2月17日下午11:31:53
* @version   com.jdbc.testJDBCUtils V1.0
*                         V2.0  改变配置文件变为为final，并把sql.properties文件提到
*                                 com.jdbc目录下 com/jdbc/test/sql.properties
*                                 测试通过
*          V3.0 改变为静态代码段 加载驱动！ 并把加载配置文件
*               也放在静态代码段中！仅仅加载一次即可！而不需要
*               一直加载
*          V4.0 修正了没有close的问题！！防止一直连着。 明白了吃异常的过程
*                在类库中不知道怎么处理！直接抛出异常即可！让调用者自己去处理！
*                咱们提供方法，不提供异常的处理！打印异常不叫做处理！而叫做“吃异常”
*          V5.0  不吃异常的方式就是 throw new RuntimeException ，静态代码段
*                  无法throw checkedException检查异常
*                没想到经过这样的过程封装比我原先的好看多了！而且逻辑更加清晰
*          V6.0 有没有理解清楚，我们实际用的较多executeUpdate和executeQuery的无conn
*               的形式，而带conn只是一个中间过程！ 并且无conn的会调用有conn的形式！
*              再次修改！ 注意观看executeUpdate的实现
*          V7.0  再次改进！不需要把executeQuery的connection关闭
*                由于PreparedStatement 来自Statement
*                rs.getStatement() 表示返回一个statement，而不会关闭PreparedStatement
*                常见了一个closeAll(),这也是为什么 暂时不关闭查询连接的原因，同时不关闭
*                方便进行多次查询，反复查询
*                
*           V8.0  cachedRowSet 是一个缓冲的mysql字符集，连接中断！把所有数据缓冲到客户端！
*                 不需要再次连接，所以关闭Connection也是可以
*                 但是这个栈内存  暂时不使用 
*                
*/
public class JDBCUtils
{

        /**
         * @param args
         */
        private static final String mysqlDriver;
        private static final String connectDatabase;
        private static final String userName;
        private static final String Password;
        static
        {
                InputStream is = null; 
                //InputStream is = JDBCUtils.class.getClassLoader().getResourceAsStream(&amp;quot;sql.properties&amp;quot;);
                Properties ps  = new Properties();
                Connection c1 = null;
                try
                {
                        //is = JDBCUtils.class.getClassLoader().getResourceAsStream(&amp;quot;&amp;quot;
                        //                + &amp;quot;com/jdbc/test/sql.properties&amp;quot;);
                        is = JDBCUtils.class.getResourceAsStream(&amp;quot;sql.properties&amp;quot;);
                        //这种情况省略宝和getClassLoader()
                        ps.load(is);
                        mysqlDriver = ps.getProperty(&amp;quot;mysqlDriver&amp;quot;);
//                        System.out.println(mysqlDriver);
                        connectDatabase = ps.getProperty(&amp;quot;connectDatabase&amp;quot;);
        //                        System.out.println(connectDatabase);
                        userName = ps.getProperty(&amp;quot;userName&amp;quot;);
        //                        System.out.println(userName);
                        Password = ps.getProperty(&amp;quot;Password&amp;quot;);
        //                        System.out.println(Password);
                        //仅仅在静态代码段中加载一次驱动即可（在运行中）
                        
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        //System.out.println(&amp;quot;配置文件加载失败&amp;quot;+e.getMessage());
                        throw new RuntimeException(&amp;quot;配置文件sql.properties加载失败&amp;quot;+e.getMessage());
                        //return null;
                }
                try
                {
                        Class.forName(mysqlDriver); //仅仅在程序运行中加载一次驱动即可！！！
                } catch (ClassNotFoundException e)
                {
                        // TODO Auto-generated catch block
//                        System.out.println(&amp;quot;驱动加载失败&amp;quot;+e.getMessage());
                        throw new RuntimeException(&amp;quot;驱动加载失败&amp;quot;+e.getMessage());
                }

        }
        
        public static void main(String[] args)
        {
                
                ResultSet rs = null;
                String sql = &amp;quot;select * from t_person&amp;quot;;
                try
                {
                        rs = executeQuery(sql);
                        while(rs.next())
                        {
                                String Name= rs.getString(&amp;quot;Name&amp;quot;);
                                System.out.println(Name);
                        }
                }catch(SQLException e)
                {
                        System.out.println(&amp;quot;居然报错&amp;quot;);
                }finally
                {
                        JDBCUtils.closeAll(rs);
                }
        
/*                try
                {
                        ResultSet rs = JDBCUtils.executeQuery( &amp;quot;select * from t_person&amp;quot;, null);
                        int i = 0;
                        while(rs.next())
                        {
                                i++;
                        }
                        System.out.println(&amp;quot;总的返回了&amp;quot;+i+&amp;quot;条记录&amp;quot;);
                }catch(SQLException e)
                {
                        System.out.println(&amp;quot;juran&amp;quot;);
                }
                */
                        
        }
        
        /**
         * 创建数据库的连接
         * @return   返回mysql的连接
         */
        public static  Connection createConnection() 
        {
                Connection c1  = null;
                try
                {
                        
                  c1 = DriverManager.getConnection(connectDatabase,userName,Password);
                        System.out.println(&amp;quot;连接成功&amp;quot;);
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        System.out.println(&amp;quot;数据库连接创建失败&amp;quot;+e.getMessage());
                        return null;
                }
                return c1;
        }
        /**
         * 
         * @param sql        sql的update,delete,insert等修改数据库的语句
         * @param parameter  参数化的update,delete,insert等的设置 
         * @return           返回被影响的函数
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static int executeUpdate(String sql,Object... parameter) throws SQLException
        {
                Connection conn = null;
                try
                {
                        conn = JDBCUtils.createConnection();
                        return executeUpdate(conn, sql, parameter);
                }finally
                {
                        JDBCUtils.closeQuietly(conn);
                }
        }
        /**
         * @param conn       数据库的连接
         * @param sql        sql的update,delete,insert等修改数据库的语句
         * @param parameter  参数化的update,delete,insert等的设置 
         * @return           返回被影响的函数
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static int executeUpdate(Connection conn,String sql,Object... parameter) throws SQLException
        {
                PreparedStatement ps = null;
                int rows = 0;
                try
                {
                        ps = conn.prepareStatement(sql);
                        int i = 1;
                        if(parameter != null)
                        {
                                for(Object pa1:parameter)
                                {
                                        ps.setObject(i, pa1);
                                        i++;
                                }
                        }
                        rows = ps.executeUpdate();
                }finally
                {
                        JDBCUtils.closeQuietly(ps);
                }
                
                System.out.println(&amp;quot;有&amp;quot;+rows+&amp;quot;条记录被影响&amp;quot;);
                return rows;
        }
        /**
         * 
         * @param sql        sql的select不修改数据库的语句
         * @param parameter  参数化的查询，参数集的设置 
         * @return           返回查询的数据集
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static ResultSet executeQuery(String sql,Object... parameter) throws SQLException
        {
                Connection conn = null;
                
                conn = JDBCUtils.createConnection();
                return executeQuery(conn,sql, parameter);
                /*finally
                {
                        JDBCUtils.closeQuietly(conn);
                }*/
                
        }
        /**
         * @param conn       数据库连接
         * @param sql        sql的select不修改数据库的语句
         * @param parameter  参数化的查询，参数集的设置 
         * @return           返回查询的数据集
         * @throws SQLException   抛出SQLException由用户自己去特殊处理
         */
        public static ResultSet executeQuery(Connection conn,String sql,Object... parameter) throws SQLException
        {
                PreparedStatement ps = null;
                ps = conn.prepareStatement(sql);
                int i =1;
                if(parameter != null)
                {
                        for(Object pa1:parameter)
                        {
                                ps.setObject(i, pa1);
                                i++;
                        }
                }
                ResultSet rs = ps.executeQuery();
                return rs;        
        }
        /**
         * 从resultSet中关闭所有的连接
         * @param rs
         */
        static void closeAll(ResultSet rs)
        {
                if(rs == null)
                {
                        return;
                }
                try
                {
                        JDBCUtils.closeQuietly(rs.getStatement().getConnection());
                        JDBCUtils.closeQuietly(rs.getStatement());
                        JDBCUtils.closeAll(rs);
                }catch(SQLException e)
                {
                        
                }
        }
        /**
         *  关闭PreparedStatment连接
         * @param ps   PreparedStatment对象
         */
        //static void closeQuietly(PreparedStatement ps)
        static void closeQuietly(Statement ps)
        {
                if(ps!= null)
                {
                        try
                        {
                                ps.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
        /**
         *  关闭Connection连接
         * @param connn   Connection对象
         */
        static void closeQuietly(Connection conn)
        {
                if(conn!= null)
                {
                        try
                        {
                                conn.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
        /**
         *  关闭ResultSet连接
         * @param rs   ResultSet对象
         */
        static void closeQuietly(ResultSet rs)
        {
                if(rs!= null)
                {
                        try
                        {
                                rs.close();
                        }catch(SQLException e)
                        {
                        
                        }
                }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;思路总结：
1：利用配置表，载入mysql和数据库信息
2：利用静态代码段载入驱动（只需要一次）
3： 编写 带connection的executeUpdate和executeQuery,并且在executeResult不要关闭任何信息，待统一关闭
4： 编写 不带Connection的executeUpdate和executeQuery,内部调用带Connction版本的而寒暑
5： 编写closeQuietly函数  和closeAll函数，在调用executeQuery,并关闭closeAll即可&lt;/p&gt;
&lt;p&gt;练习使用ctrl+O 打开方法。。（大年30 刚喝完半碗酒  继续。。。）&lt;/p&gt;
&lt;p&gt;5事务的练习1：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

/**
* @author    叶昭良
* @time      2015年2月18日下午1:43:28
* @version   com.jdbc.testtransaction1 V1.0
*/
import java.sql.*;
public class transaction1
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Connection conn = null;
                PreparedStatement ps1 = null;
                PreparedStatement ps2 = null;
                try
                {
                    conn = JDBCUtils.createConnection();
                    conn.setAutoCommit(false);
                    ps1 = conn.prepareStatement(&amp;quot;Update t_person Set Age=Age+1 where Name=&#39;yezhao&#39;&amp;quot;);
                    ps1.executeUpdate();
                    ps2 = conn.prepareStatement(&amp;quot;Update t_person Set Age=Age-1 where Name=&#39;xinran&#39;&amp;quot;);
                    ps2.executeUpdate();
                    conn.commit();
                } catch (SQLException e)
                {
                    try
                        {
                                conn.rollback();
                        } catch (SQLException e1)
                        {
                                // TODO Auto-generated catch block
                                e1.printStackTrace();
                        }
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;测试navicat 和cmd都更新了。&lt;/p&gt;
&lt;p&gt;6batch+事务的总和练习：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

/**
* @author    叶昭良
* @time      2015年2月18日下午2:31:56
* @version   com.jdbc.testtestBatchInsertAndUpdate V1.0
*/
import java.sql.*;
public class testBatchInsertAndUpdate
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                //在没有批量导入数据之前，一般是需要花费很长的时间，现在采用addbatch进行
                Connection conn = null;
                PreparedStatement ps = null;
                String sql=&amp;quot;insert into t_person(Id,Name,Age,Gender)values(?,?,?,?)&amp;quot;;
                //测试了删除操作，success!
                //String sql= &amp;quot;delete from t_person where Name=?&amp;quot;;
                long startTime = System.currentTimeMillis();
                /**
                 * 不添加批处理后，添加1000条后耗时845
                 *  不添加批处理  添加11000条后   耗时2604  ,所以我不知道批处理的好处啊！！！
                 *                           反正即使2530s左右
                 * 
                   添加批处理后                添加1000条后耗时799
                                                 添加11000条后耗时3206
                                                 添加11000条后耗时3143(每个1000提交一次）


                 */
                try
                {
                        //之前表中已有 215行
                        conn = JDBCUtils.createConnection();
                        conn.setAutoCommit(false);//相当于begin的作用
                        ps = conn.prepareStatement(sql);
                        for(int i = 316;i &amp;lt; 11316;i++)
                        {
                                //JDBCUtils.executeUpdate(conn, sql, i,&amp;quot;Autumn&amp;quot;,20,1);
                                //ps.clearParameters();
                                ps.setInt(1, i);
                                ps.setString(2,&amp;quot;Winter&amp;quot;);
                                ps.setInt(3, 21);
                                ps.setBoolean(4, true);
                                //ps.executeUpdate();
                                
                                
                                /**
                                 * if(i%1000 == 0) //每个1000次提交一次！！！这样好！
                                 * {
                                 *    ps.executeBatch();
                                 *  }
                                 *  少于1000次的最后一笔  再用一次ps.executeBatch();
                                 */
                                ps.addBatch(); //据说是装到箱子的作用
                                if(i%1000 == 0)
                                {
                                        ps.executeBatch();
                                }
                        }
                                //JDBCUtils.executeUpdate(conn, sql, i,&amp;quot;Autumn&amp;quot;,20,1);
                                //测试删除使用的
                                //JDBCUtils.executeUpdate(conn, sql, &amp;quot;Autumn&amp;quot;);
                        //}
                        ps.executeBatch(); //把箱子里面的数据 直接一次性提交mysql
                        conn.commit();
                        System.out.println(&amp;quot;添加1000条后耗时&amp;quot;+(System.currentTimeMillis()
                                        -startTime));
                }catch(SQLException e)
                {
                        try
                        {
                                conn.rollback();
                        } catch (SQLException e1)
                        {
                                // TODO Auto-generated catch block
                                e1.printStackTrace();
                        }
                }finally
                {
                        JDBCUtils.closeQuietly(conn);
                }
                
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7导入手机账簿，并进行手机号所在地的查询&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

/**
* @author    叶昭良
* @time      2015年2月18日下午3:49:22
* @version   com.jdbc.testphoneCheck V1.0
*/
import java.io.*;
import java.sql.*;
import java.util.Scanner;


public class phoneCheck
{

        /**
         * @param args
         */
/**
* ID,MobileNumber,MobileArea,MobileType,AreaCode,PostCode,0
        连接成功
        总共添加了300105条数据.耗时：64712
*/
        private static void load()
        {
                //导入csv数据，利用BufferedInputStream
          InputStream is = null;
          InputStreamReader isr = null;
          BufferedReader bis = null; //一行一行读入数据
          
          Connection conn = null;
          PreparedStatement ps = null;
                int len = 0;
                int i = 0;
                long startms = System.currentTimeMillis();
                try
                {
                        is = new FileInputStream(&amp;quot;e://phone.csv&amp;quot;);
                    isr = new InputStreamReader(is);
                        bis = new BufferedReader(isr);
                        
                        System.out.println(bis.readLine());
                        //第一行字段舍去
                        String apple=  null;
                        String[] applePiles = null;
                        //第一次测试  字符串的行读入
/*                        System.out.println(bis.readLine());
                        System.out.println(bis.readLine());*/
                        /*apple =bis.readLine();
                        //字符串的一次失误！！ 导致插入失败！！＂＂是默认存在的　必须删掉
                        apple = apple.replaceAll(&amp;quot;\&amp;quot;&amp;quot;, &amp;quot;&amp;quot;);
                        //第二次测试 字符串分隔
                        String[] splitArray = apple.split(&amp;quot;,&amp;quot;);
                        for(String apple1 :splitArray)
                        {
                                System.out.println(apple1);
                        }*/
                        conn = JDBCUtils.createConnection();
                        conn.setAutoCommit(false);
                        
                        String sql = &amp;quot;insert into phone(MobileNumber,MobileArea,MobileType,Area&amp;quot;
                                        + &amp;quot;Code,PostCode) values(?,?,?,?,?);&amp;quot;;
                        ps = conn.prepareStatement(sql);
                        /**
                         * 370中国电信
                                371中国电信
                                之后 报错 ，可能是为空的原因 
                         */
                        while((apple=bis.readLine()) != null)
                        {
                                apple = apple.replaceAll(&amp;quot;\&amp;quot;&amp;quot;, &amp;quot;&amp;quot;);
                                applePiles = apple.split(&amp;quot;,&amp;quot;);
                                
                                ps.clearParameters();
                                //ps.setInt(1, Integer.parseInt(applePiles[1].equalsIgnoreCase(&amp;quot;&amp;quot;)?&amp;quot;1111&amp;quot;:applePiles[4]));
                                //ps.setInt(1, Integer.parseInt(applePiles[1]));
                                ps.setString(1, applePiles[1]);
                                ps.setString(2, applePiles[2]);
                                //System.out.println(i+applePiles[3]+applePiles[4]);
                                ps.setString(3, applePiles[3]);
//                                ps.setInt(4, Integer.parseInt(applePiles[4]));//.equalsIgnoreCase(&amp;quot;&amp;quot;)?&amp;quot;1111&amp;quot;:applePiles[4]));
//                                ps.setInt(5, Integer.parseInt(applePiles[5]));//.equalsIgnoreCase(&amp;quot;&amp;quot;)?&amp;quot;1111&amp;quot;:applePiles[4]));
                                ps.setString(4, applePiles[4]);
                                ps.setString(5, applePiles[5]);
                                ps.addBatch();

                                i++;
                                if(i%2000==0)
                                {
                                        ps.executeBatch();
                                }
                        }
                        ps.executeBatch();
                        conn.commit();
                        long endMs = System.currentTimeMillis();
                        System.out.println(&amp;quot;总共添加了&amp;quot;+i+&amp;quot;条数据&amp;quot;+&amp;quot;.耗时：&amp;quot;+(endMs-startms));
                }catch(IOException e)
                {
                        throw new RuntimeException(&amp;quot;读取文件异常&amp;quot;);
                }catch(SQLException e)
                {
                        try
                        {
                                conn.rollback();
                        } catch (SQLException e1)
                        {
                                // TODO Auto-generated catch block
                                e1.printStackTrace();
                        } //又忘记了
                        throw new RuntimeException(&amp;quot;数据库插入异常！&amp;quot;);
                        
                }
        }
        
        public static void checkPhoneNumber(String PhoneNumber)
        {

                
                PhoneNumber = &amp;quot;%&amp;quot;+PhoneNumber+&amp;quot;%&amp;quot;;
                String sql = &amp;quot;select * from phone where MobileNumber like ?&amp;quot;;
                ResultSet rs  = null;
                try
                {
                        rs = JDBCUtils.executeQuery(sql, PhoneNumber);
                        if(!rs.next())
                        {
                                System.out.println(&amp;quot;当前版本没有&amp;quot;+PhoneNumber+&amp;quot;的信息&amp;quot;);
//                                return;
                        }
                        //rs.next();
                        System.out.println(PhoneNumber+&amp;quot;手机号来自&amp;quot;+rs.getString(&amp;quot;MobileArea&amp;quot;)+rs.getString(&amp;quot;MobileType&amp;quot;));
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        return;
                }finally
                {
                        JDBCUtils.closeAll(rs);
                }
                
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                //导入一次即可
                //load();
                while(true)
                {
                        System.out.println(&amp;quot;请输入手机号(至少7位)&amp;quot;);
                        Scanner sc = new Scanner(System.in);
                        String PhoneNumber = sc.nextLine();
                        
                        if(PhoneNumber.equalsIgnoreCase(&amp;quot;exit&amp;quot;)||PhoneNumber.equalsIgnoreCase(&amp;quot;quit&amp;quot;))
                        {
                                return;
                        }
                        PhoneNumber = PhoneNumber.substring(0,7);
                        checkPhoneNumber(PhoneNumber);
                }
                
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;JDBCUtils 第一遍重写：&lt;/p&gt;
&lt;p&gt;//再次书写的时候  注意 对于吃掉的异常的处理
//第二  在静态代码段中  加载mysql驱动
//静态代码块的两个作用：加载配置控件，加载驱动&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;                    //try....finally  可以在throw SQLException的情况下使用，最后关闭需要的连接
                    //进一步体会两个executeUpdate的区别（executeQuery也是一样）
                    //一个抛出异常 一个则负责接住 并继续关闭的相应的连接
                    //try....finally 和try...catch....finally的配合使用
                    
                    //在查询时候的编写 则是都抛出！ 不负责关闭！！ 等到查询的时候！ 统一的去关闭
                    //因为可能存在多处查询
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码
JDBCUtils 第二遍重写：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@time      2015年2月19日下午9:52:52&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                     10:20完成            28min左右
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;//第三次重写 意识到了  静态代码快不能加载 检查性的异常! 在try&amp;mdash;catch的时候
//一定得throw new RuntimeException 才不至于报错&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    //居然忘记了先重写 Connection的创建！直接close,!有点错乱的感觉！
    //应该是按照逻辑的顺序进行编写，先是创建连接！ 最后在关闭
    //只不过当时是这样想的！ 其实这些关闭会一直反复的用到，
    //就想着先把他们给写上！也是符合逻辑！因为逻辑里面他们是反复被
    //调用的小插件
    
    //同时在创建connection再疑问是否抛出异常？ 最终抛出了？
    //为什么？  因为这个异常是自己可以处理的
    //连连接都拿不到 ！那就直接返回吧！肯定程序是有问题的
    
    //至于executeUpate executeQuery的异常都交由 调用者去处理他的异常
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码
JDBCUtils 第三遍重写：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;@time      2015年2月19日下午10:21:46&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;           10:40  结束      19min
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;书写第四遍的时候  遇到一个问题 在executeUpdate的时候  是不是改在
*  try&amp;hellip;finally   的try块就应该返回了 而不是finally的后面
*  如果在后面 肯定是错误的！！！因为资源已经关闭
复制代码
JDBCUtils 第四遍重写：&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@time      2015年2月19日下午10:41:37&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                   10:55     14min
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>2月1日Java班笔记作业</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-1ri-javaban-bi-ji-zuo-ye/</link>
      <pubDate>Mon, 11 May 2015 14:58:41 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-1ri-javaban-bi-ji-zuo-ye/</guid>
      <description>&lt;p&gt;第一部分 ：笔记
FileChooserDialog&lt;/p&gt;
&lt;p&gt;1、        创建：int gtk_file_chooser_dialog_new(String title,int parentWindow, int action, String first_button_text)：action可选值GTK_FILE_CHOOSER_ACTION_*：OPEN(打开文件)、SAVE(保存文件)、SELECT_FOLDER(选择文件夹)、CREATE_FOLDER(创建文件夹)
2、gtk_file_chooser_set_select_multiple是否允许多选（一般是设置上）
gtk_file_chooser_set_current_name设置默认文件名
gtk_file_chooser_get_filename得到选择的文件名(单选)
gtk_file_chooser_get_filenames得到选择的文件名（数组，多选）
gtk_file_chooser_set_do_overwrite_confirmation选择已经存在的文件是否提示覆盖，一般是用于保存文件（在作业中有体现）
3、文件过滤器
gtk_file_filter_new：创建过滤器
gtk_file_filter_set_name设置显示的名字
gtk_file_filter_add_pattern添加过滤通配符：第二个参数格式“*.txt”，若是多个则多次执行这个函数
gtk_file_chooser_add_filter(int chooser,int filter)将过滤器添加到chooser中&lt;/p&gt;
&lt;p&gt;TreeView
Treemodal的作用是什么？
有点感觉了&lt;/p&gt;
&lt;p&gt;TreeView是基于MVC模式设计的（关键点1）； 也就是说需要有一个M，同时又一个V
把M和V联系起来的函数就叫做C，所以也可以改名为MVF。
C的作用可能是修改M的值，并实时显示在V中； 又或者通过修改V的数据，也能够实时反馈到M中；
所以猜测应该是MVC.png：&lt;/p&gt;
&lt;p&gt;所以我们应该需要拥有数据：M（也就是通过liststore创建）
如何设置M是V的Model很重要,这样就实现了交互的过程，你变我显（你是M,我是V）,你变我改（你是V,我是M）
当我们获得了数据就可以通过天猫的淘宝来卖了（这就是treeview）
我们也可以卸货和添货，这就是C了。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;    GTK.gtk  columns 数据库的字段。
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;    原来iter就是数据库的行    Columns的列
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;     又明白了一点  在所有的GTK.gtk_*_new的int对象都不是简单的整数，而是一个对象的标识，比如int column是列对象标识
&lt;/code&gt;&lt;/pre&gt;
Int  model是模型对象标识    int textview  是textview对象标识    int gridHouse是网格布局对象标识，  归根结底都得第一反应
过来这是一个对象标识，认清这些对象就可以琢磨这些方法之间的逻辑关系了。也就是说如果一个方法有某个对象标识那么肯定
就是说得事先创建这个对象或者通过反射机制获得。当然得看清是不是对象标识。通过对象标识认清逻辑关系（关键点2）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;莫名其妙的多了 tree_model的创建  ， 应该加上一步 无论是gtk_tree_model_get_iter_first  还是gtk_tree_model_iter_next
又或者是gtk_tree_model_get_value 还是gtk_tree_model_set_value都涉及到 tree_model的对象标识，必须有tree_model对象标识，
联系到第一步然后把GtkListStore设置为GtkTreeView的Model  ，也就是list_store其实就是tree_model ，因为 ListStore实现了TreeModel接口，所以有的操作以gtk_tree_model开头。一切就算说通了  关键点3&lt;/p&gt;
&lt;p&gt;关键性一步  设置数据仓库的显示。
void gtk_tree_view_set_model(int tree_view, int model)把listmodel对象设置显示到tree_view上（关键点4 显示出来）。
认清五个对象标识：
1 list_store（tree_model）对象标识  2.tree_iter对象标识   3. Tree_view对象标识  4. treeViewColumn对象标识 5.cellRender对象标识&lt;/p&gt;
&lt;p&gt;一个思路：
思路：首先创建GtkListStore，把要显示数据放到GtkListStore中，接着创建GtkTreeView，添加列配置列属性，然后把GtkListStore设置为GtkTreeView的Model，数据就可以显示出来。对数据添加、遍历等操作的时候都要使用迭代器(类似TextView中的Iter)，int gtk_tree_iter_new()创建迭代器。
一般步骤：
1：  利用treeview创建界面，并创建所需的字段，达到View的目的
2：  根据字段数目，创建liststore的数据仓库，达到Model的目的
3：  利用iter对象标识，插入、遍历、删除、增加。
具体看 作业&lt;/p&gt;
&lt;p&gt;另外treeview的行选择问题：
行选择要通过GtkSelection对象进行，int gtk_tree_view_get_selection(int tree_view)获得行选择对象
2、TreeView支持单选、多选等模式，默认是单选。void gtk_tree_selection_set_mode(int tree_selection,int type) 设置选择模式，第一个参数为GtkSelection；type可选值：GTK_SELECTION_SINGLE单选，GTK_SELECTION_MULTIPLE多选，其他不用管
3、int[] gtk_tree_view_get_selection_indices(int tree_view)获得选中行的序号，因为支持多选，所以返回数组
4、获得行选中改变信号，监听GtkSelection的&amp;quot;changed&amp;quot;信号。
5、获得双击事件，监听&amp;quot;button-press-event&amp;quot;信号，判断if(GTK.gdk_event_get_type(eventData)==GTK.GDK_2BUTTON_PRESS)得知是否是双击&lt;/p&gt;
&lt;p&gt;ToolBar
1、int gtk_toolbar_new()创建工具栏容器
2、void gtk_toolbar_insert(int toolbar, int item,int pos)将工具栏项添加到工具栏，item：后面讲的工具栏项，pos插入的位置
3、工具栏项有按钮、下拉菜单按钮、分隔栏、开关等复杂内容，这里不介绍，只介绍简单常用的GtkToolButton。
int gtk_tool_button_new(int icon_widget,String label)创建GtkToolButton。icon_widget为显示的控件id，可以在按钮上显示其他控件，一般传0；label为标题。
void gtk_tool_button_set_stock_id(int button,String stock_id); 设置按钮上显示的图片。
响应工具栏按钮点击只要连接&amp;quot;clicked&amp;quot;信号即可&lt;/p&gt;
&lt;p&gt;Calendar
1、日历Calendar
int gtk_calendar_new()
int gtk_calendar_get_year(int calendar)、int gtk_calendar_get_month(int calendar)、int gtk_calendar_get_day(int calendar)获得选择的年月日
信号：&amp;ldquo;day-selected&amp;rdquo;：选择日期发生变化；&amp;ldquo;day-selected-double-click&amp;quot;双击一个日期。
gtk_progress_bar_* 进度条
作业
gtk_switch_*  开关
作业
menu
//分三步
//1创建单一菜单
//2创建一个菜单头
//3创建总的菜单条，把许多菜单头都挂到菜单条上
具体看toolbar的作业。&lt;/p&gt;
&lt;p&gt;gtk_status_icon_* 右下角的系统图盘图标
作业&lt;/p&gt;
&lt;p&gt;第二部分 ：作业&lt;/p&gt;
&lt;p&gt;文件选择器+工具栏&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.BufferedInputStream;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;

/**
* @author    叶昭良
* @time      2015年2月1日下午5:56:29
* @version   TestFileChooser V1.0  简易记事本  打开文件 保存文件 显示照片
* @version   TestFileChooser V2.0  增加了打开对话框  并添加了对话框内部控件的事件
* @version   TestFileChooser V3.0  增加了工具栏
*/
import com.rupeng.gtk4j.*;
public class TestFileChooser2
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        static int scrolledBar;
        static int textview;
        static int  btnApple;
        static String[] selectFiles = null;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                GTK.gtk_widget_show(window);
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;打开文件&amp;quot;);
                int btnBanana = GTK.gtk_button_new_with_label(&amp;quot;保存文件&amp;quot;);
                int btnOrange = GTK.gtk_button_new_with_label(&amp;quot;显示图片文件&amp;quot;);
                int btnPeal   = GTK.gtk_button_new_with_label(&amp;quot;打开对话框&amp;quot;);
                //创建布局
                gridHouse= GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                GTK.gtk_container_add(window, gridHouse);
                
                //GTK.gtk_widget_set_size_request(window, 500, 500);
                //添加控件到合租房
                int start = 0;
                createToolbar(gridHouse,start);
                GTK.gtk_grid_attach(gridHouse, btnApple, 0, 2, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnBanana, 1, 2, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnOrange, 2, 2, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnPeal, 3, 2, 1, 1);
                createTextView(window,gridHouse,3);
                
                //显示控件
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_widget_show(btnBanana);
                GTK.gtk_widget_show(btnOrange);
                GTK.gtk_widget_show(btnPeal);
                
                //添加按钮事件
                 insertButtonEvent(btnApple);
                 insertButtonSaveEvent(btnBanana);
                 insertButtonPictureEvent(btnOrange);
                 insertButtonDialogEvent(btnPeal);
                //启动循环
                GTK.gtk_main();
        }
        public static void saveFile(int textview) 
        {
                int dlg1 = GTK.gtk_file_chooser_dialog_new(&amp;quot;保存文件&amp;quot;, 0, GTK.GTK_FILE_CHOOSER_ACTION_SAVE,&amp;quot;保存&amp;quot;);
                GTK.gtk_file_chooser_set_do_overwrite_confirmation(dlg1, true);
                //String filename = GTK.gtk_file_chooser_get_filename(dlg1);
                System.out.println(&amp;quot;已进入save&amp;quot;);
                //SaveOneFile(filename,textview);
                int ret = GTK.gtk_dialog_run(dlg1);
                if(ret == GTK.GTK_RESPONSE_CANCEL)
                {
                        GTK.gtk_widget_destroy(dlg1);
                }else 
                {
                        String filename = GTK.gtk_file_chooser_get_filename(dlg1);
                        System.out.println(filename);
                        SaveOneFile(filename,textview);
                        GTK.gtk_widget_destroy(dlg1);
                }
                
        }
        public static String[] selectFile() 
        {
                int dlg = GTK.gtk_file_chooser_dialog_new(&amp;quot;打开文件&amp;quot;, 0, GTK.GTK_FILE_CHOOSER_ACTION_OPEN,&amp;quot;打开&amp;quot;);
                GTK.gtk_file_chooser_set_select_multiple(dlg, true);
                
                //创建过滤器
                int filter = GTK.gtk_file_filter_new();
                GTK.gtk_file_filter_add_pattern(filter, &amp;quot;*.txt&amp;quot;);
                GTK.gtk_file_filter_add_pattern(filter, &amp;quot;*.java&amp;quot;);
                GTK.gtk_file_filter_set_name(filter, &amp;quot;文本文件&amp;quot;);
                GTK.gtk_file_chooser_add_filter(dlg, filter);
                int ret = GTK.gtk_dialog_run(dlg);
                String[] filenames = null;
                if(ret == GTK.GTK_RESPONSE_OK) 
                {
                        filenames = GTK.gtk_file_chooser_get_filenames(dlg);
                        for(int i = 0 ; i&amp;lt; filenames.length ; i++)
                        {
                                
                                System.out.println(&amp;quot;选中文件名&amp;quot;+i+&amp;quot;: &amp;quot;+filenames[i]);
                        }
                        GTK.gtk_widget_destroy(dlg);
                }else
                {
                        GTK.gtk_widget_destroy(dlg);
                }
                return filenames;
        }
        public static void selectFile(int gridHouse,int start) 
        {
                int dlg = GTK.gtk_file_chooser_dialog_new(&amp;quot;打开文件&amp;quot;, 0, GTK.GTK_FILE_CHOOSER_ACTION_OPEN,&amp;quot;打开&amp;quot;);
                GTK.gtk_file_chooser_set_select_multiple(dlg, true);
                
                //创建过滤器
                int filter = GTK.gtk_file_filter_new();
                GTK.gtk_file_filter_add_pattern(filter, &amp;quot;*.jpg&amp;quot;);
                GTK.gtk_file_filter_add_pattern(filter, &amp;quot;*.png&amp;quot;);
                GTK.gtk_file_filter_add_pattern(filter, &amp;quot;*.gif&amp;quot;);
                GTK.gtk_file_filter_set_name(filter, &amp;quot;图片文件&amp;quot;);
                GTK.gtk_file_chooser_add_filter(dlg, filter);
                int ret = GTK.gtk_dialog_run(dlg);
                String[] filenames = null;
                if(ret == GTK.GTK_RESPONSE_OK) 
                {
                        filenames = GTK.gtk_file_chooser_get_filenames(dlg);
                        for(int i = 0 ; i&amp;lt; filenames.length ; i++)
                        {

                                System.out.println(&amp;quot;选中文件名&amp;quot;+i+&amp;quot;: &amp;quot;+filenames[i]);
                                int temp = GTK.gtk_image_new_from_file(filenames[i]);
                                GTK.gtk_grid_attach(gridHouse, temp, i, start, 3, 1);
                                GTK.gtk_widget_show(temp);
                        }
                        GTK.gtk_widget_destroy(dlg);
                }else
                {
                        GTK.gtk_widget_destroy(dlg);
                }

        }
        
        public static void showAllFiles(String[] filenames,int textview)
        {
                for(int i = 0 ; i &amp;lt; filenames.length; i++)
                {
                        showOneFile(filenames[i],textview);
                }
        }
/*        public static void showOneFile(String filename, int textview)
        {
                try
                (
                        InputStream fis = new FileInputStream(filename);
                        
                        BufferedInputStream bis = new BufferedInputStream(fis);
                )
                {
                        int len = 0;
                        byte[] fileToFile = new byte[512*1024];
                        while((len = bis.read(fileToFile))!= -1) // -1读取完毕
                        {
                                //InsertStringToTextViewFunction(textview,fileToFile.toString());
                                InsertStringToTextViewFunction(textview,new String(fileToFile,&amp;quot;gb2312&amp;quot;));
                        }
                }
                catch(IOException e)
                {
                        System.out.println(&amp;quot;文件读入异常&amp;quot;);
                }
                
        }*/
        public static void showOneFile(String filename, int textview)
        {
                try
                (
                        InputStream is = new FileInputStream(filename);
                        InputStreamReader osr = new InputStreamReader(is);
                        BufferedReader br = new BufferedReader(osr);
                )
                {
                        
                        String  temp= filename.substring(filename.lastIndexOf(&#39;\\&#39;)+1);
                        System.out.println(temp);
                        InsertStringToTextViewFunction(textview,&amp;quot;******************\n当期文件为&amp;quot;+filename+&amp;quot;\n******************\n\n&amp;quot;+temp+&amp;quot; 文件内容如下：\n+---------------------------------------------------------------------------+\n&amp;quot;);
                        String content = null;
                        while((content = br.readLine())!=null) // -1读取完毕
                        {
                                //InsertStringToTextViewFunction(textview,fileToFile.toString());
                                InsertStringToTextViewFunction(textview,new String(content));
                        }
                        InsertStringToTextViewFunction(textview,&amp;quot;\n+---------------------------------------------------------------------------+\n******************\n文件&amp;quot;+filename+&amp;quot;读取结束\n******************\n&amp;quot;);
                }
                catch(IOException e)
                {
                        System.out.println(&amp;quot;文件读入异常&amp;quot;);
                }
                
        }
        
        public static void SaveOneFile(String filename, int textview)
        {
                try
                (
                        OutputStream os = new FileOutputStream(filename);
                        OutputStreamWriter osw = new OutputStreamWriter(os);
                        BufferedWriter bw = new BufferedWriter(osw);
                )
                {
                        
                        String  temp= filename.substring(filename.lastIndexOf(&#39;\\&#39;)+1);
                        System.out.println(temp);
                        
                        int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                        int textIter = GTK.gtk_text_iter_new();  //这是一个空的iter，需要用textBuffer进行赋值
                        GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);// 或者textview的textBuffer的末尾！
                        String tempText = GTK.gtk_text_buffer_get_text(textBuffer);
                        
                        //while(tempText != null) // -1读取完毕
                        {
                                //InsertStringToTextViewFunction(textview,fileToFile.toString());
                                bw.write(tempText);
                                bw.newLine();
                        //        GTK.gtk_text_iter_backward_char(textIter);
                        //        tempText = GTK.gtk_text_buffer_get_text(textBuffer);
                        }
                }
                catch(IOException e)
                {
                        System.out.println(&amp;quot;文件读入异常&amp;quot;);
                }
                
        }
        public static void createTextView(int window, int gridHouse,int start)
        {
                textview =  GTK.gtk_text_view_new();
                createScrolledBar(window,textview,gridHouse,start);
                //GTK.gtk_text_view_set_wrap_mode(textview,GTK.GTK_WRAP_WORD);
                GTK.gtk_text_view_set_wrap_mode(textview,GTK.GTK_WRAP_WORD_CHAR);
                GTK.gtk_widget_show(textview);
        }
        public static void createScrolledBar(int window, int textview, int gridHouse,int start)
        {
                scrolledBar = GTK.gtk_scrolled_window_new();
                GTK.gtk_widget_show(scrolledBar);
                GTK.gtk_widget_set_size_request(scrolledBar, 200, 200);
                GTK.gtk_grid_attach(gridHouse, scrolledBar, 0, start, 1, 1);
                GTK.gtk_container_add(scrolledBar, textview);
                
        }
        
        //封装了  TextView的迭代器操作。。。
        /**
         * 
         * @param textview  多行文本TextView的标识
         * @param temp      插入TextView 的字符串。
         */
        public static void InsertStringToTextViewFunction(int textview,String temp)
        {
                //TextIter是一个TextView的迭代器。
                int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                int textIter = GTK.gtk_text_iter_new();  //这是一个空的iter，需要用textBuffer进行赋值
                //GTK.gtk_text_iter_forward_to_end(textIter);
                GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);// 或者textview的textBuffer的末尾！
                GTK.gtk_text_buffer_insert(textBuffer, textIter, temp);
                
                //GTK.gtk_text_buffer_g
                GTK.gtk_text_iter_free(textIter);
                
        }
        /**
         * 
         * @param textview   TextView的多行文本的标识
         * @return           返回的字符串
         */
        public static String GetStringFromTextViewFunction(int textview)
        {
                //TextIter是一个TextView的迭代器。
                int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                int textIter = GTK.gtk_text_iter_new();  //这是一个空的iter，需要用textBuffer进行赋值
                GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);// 或者textview的textBuffer的末尾！
                String temp = GTK.gtk_text_buffer_get_text(textBuffer);
                
                String[] splitArray = temp.split(&amp;quot;\\n&amp;quot;);
                temp = splitArray[splitArray.length-1];
                System.out.println(temp);
                return temp;
                //GTK.gtk_text_buffer_g
                //GTK.gtk_text_iter_free(textIter);
                
        }
        public static boolean showInfo(  String  message,String title)
        {
                int msgDlg = GTK.gtk_message_dialog_new(0, GTK.GTK_DIALOG_DESTROY_WITH_PARENT|
                                GTK.GTK_DIALOG_MODAL,GTK.GTK_MESSAGE_INFO, GTK.GTK_BUTTONS_OK,message);
                GTK.gtk_window_set_title(msgDlg, title);
                int ret = GTK.gtk_dialog_run(msgDlg);
                GTK.gtk_widget_destroy(msgDlg);
                return ret == GTK.GTK_RESPONSE_OK;
        }
        public static void createDialog()
        {
                int dialogApple = GTK.gtk_dialog_new();
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;幽灵点击&amp;quot;);
                
                //action_are获得一个 类似box,grid的作用，可以添加容器
                int areaDialog = GTK.gtk_dialog_get_action_area(dialogApple);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_container_add(areaDialog, btnApple);
                
                GTK.g_signal_connect(btnApple, &amp;quot;clicked&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                showInfo(&amp;quot;欣然是不是很美&amp;quot;,&amp;quot;那可不&amp;quot;);
                        }
                }, null);
                
                int ret = GTK.gtk_dialog_run(dialogApple);
                if(ret == GTK.GTK_RESPONSE_OK)
                {
                        System.out.println(&amp;quot;再见&amp;quot;);
                        GTK.gtk_widget_destroy(dialogApple);
                }
                GTK.gtk_widget_destroy(dialogApple);
        }

        //     ********************事件整体处理 区域***************************
        /**
         * 
         * @param btnSin   按钮的标识
         * @param tv1      textview的标识
         */
        public static void insertButtonEvent(final int btnSin,final int tv1)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                String temp = GTK.gtk_button_get_label(btnSin);
                                InsertStringToTextViewFunction(tv1,temp);
                                //isEnter = false;
                        }
                }, null);
        }
        public static void insertButtonEvent(final int btnSin)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                GTK.gtk_widget_show(scrolledBar);
                                GTK.gtk_widget_set_size_request(scrolledBar, 400, 400);
                                String temp = GTK.gtk_button_get_label(btnSin);
                                selectFiles =  selectFile() ;
                                //isEnter = false;
                                showAllFiles(selectFiles, textview);
                        }
                }, null);
        }
        public static void insertButtonSaveEvent(final int btnSin)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                saveFile(textview);
                        }
                }, null);
        }
        public static void insertButtonPictureEvent(final int btnSin)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                GTK.gtk_widget_hide(scrolledBar);
                                selectFile(gridHouse, 2) ;
                        }
                }, null);
        }
        
        public static void insertButtonDialogEvent(final int btnSin)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                createDialog();
                        }
                }, null);
        }

        public static void createToolbar(int gridHouse,int start)
        {
                //创建工具栏容器
                int tbApple = GTK.gtk_toolbar_new();
                GTK.gtk_widget_show(tbApple);
                GTK.gtk_widget_set_size_request(tbApple, 300, 20);
                GTK.gtk_grid_attach(gridHouse, tbApple, 0, start, 1, 1);
                
          int btnNew = GTK.gtk_tool_button_new(0, &amp;quot;新建&amp;quot;);
          GTK.gtk_tool_button_set_stock_id(btnNew, GTK.GTK_STOCK_NEW);
          GTK.gtk_widget_show(btnNew);
          GTK.gtk_toolbar_insert(tbApple, btnNew, 0);
                   
          final int btnOpen = GTK.gtk_tool_button_new(0, &amp;quot;打开&amp;quot;);
          GTK.gtk_tool_button_set_stock_id(btnOpen, GTK.GTK_STOCK_OPEN);
          GTK.gtk_widget_show(btnOpen);
          GTK.gtk_toolbar_insert(tbApple, btnOpen, 1);

          GTK.g_signal_connect(btnOpen, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                System.out.println(&amp;quot;hello&amp;quot;);
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                GTK.gtk_widget_show(scrolledBar);
                                GTK.gtk_widget_set_size_request(scrolledBar, 400, 400);
                                //String temp = GTK.gtk_button_get_label(btnOpen);
                                selectFiles =  selectFile() ;
                                //isEnter = false;
                                showAllFiles(selectFiles, textview);
                        }
                }, null);

          int btnSave = GTK.gtk_tool_button_new(0, &amp;quot;保存&amp;quot;);
          GTK.gtk_tool_button_set_stock_id(btnSave, GTK.GTK_STOCK_SAVE);
          GTK.gtk_widget_show(btnSave);
          GTK.gtk_toolbar_insert(tbApple, btnSave, 2);
          GTK.g_signal_connect(btnSave, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                saveFile(textview);
                        }
                }, null);
          
          
        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;treeview 简单的增加用户，调整treeview的样式，未实现删除&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author    叶昭良
* @time      2015年2月2日下午6:02:11
* @version   TestGTKTreeView V1.0  一个基本的treeview的使用流程  + 字段创建+记录添加
* @version   TestGTKTreeView V2.0  增加了遍历处理 以及显示某行某列的信息
* @version   TestGTKTreeView V3.0  增加了”列控制“ ！！treeview 的某列可显示，可拉伸 ，可排序，可调整
*                                  列控制只是改变treeview的表现，而不会改变liststore的model的内部值
* @version   TestGTKTreeView V4.0  增加了添加记录的功能         
* @version   TestGTKTreeView V5.0  增加了getSelection 进行行操作， 并未取出数据，也并未删除数据                 
*/ 
public class TestGTKTreeView
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        static int liststore;
        static int listiter;
        static boolean columnVisible = false; //用static 变量  不要用final变量。
        static boolean columnResize = true; //用static 变量  不要用final变量。
        static boolean columnRecordable = true; // 设置可拉动
        static int entryID;
        static int entryName;
        static int entryAge;
        static int treeViewApple;
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                GTK.gtk_widget_show(window);
                GTK.gtk_window_set_title(window, &amp;quot;TreeView TestVersion&amp;quot;);
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                GTK.gtk_main_quit();
                        }
                }, null);
                int start = 0;
                //创建并添加布局
                gridHouse = GTK.gtk_grid_new();
                GTK.gtk_container_add(window, gridHouse);
                GTK.gtk_widget_show(gridHouse);
                //3  treeview   是一个界面，相当于是一个淘宝前台， V  V的作用
                treeViewApple = GTK.gtk_tree_view_new();
                //4 建立字段  比较费劲
                //4.1创建字段
                int columnID = GTK.gtk_tree_view_column_new_with_attributes(&amp;quot;ID&amp;quot;, GTK.gtk_cell_renderer_text_new(), 0);
                //4.2添加字段
                GTK.gtk_tree_view_append_column(treeViewApple, columnID);
                //4.3创建字段
                int columnName = GTK.gtk_tree_view_column_new_with_attributes(&amp;quot;Names&amp;quot;,GTK.gtk_cell_renderer_text_new(),1);
                //4.4添加字段
                GTK.gtk_tree_view_append_column(treeViewApple,columnName);
                //4.5创建字段
                int  columnAge = GTK.gtk_tree_view_column_new_with_attributes(&amp;quot;Ages&amp;quot;,GTK.gtk_cell_renderer_text_new(),2);
                GTK.gtk_tree_view_append_column(treeViewApple,columnAge);
                
                //创建控件
                //1  list_store  是一个数据结构库，相当于一个仓库  M model的作用
                liststore = GTK.gtk_list_store_new(3); //3代表三个字段：ID  Names   Age
        //        GTK.gtk_list_store_append(list_store, iter);
                //2  list_iter,list_iter是一个内部的数据迭代的控制过程，不需要显示 C的作用，控制
                listiter = GTK.gtk_tree_iter_new();

                //5  第五步 把 iter和listStore联系起来
                          //GTK.gtk_text_buffer_get_end_iter 类似于treeview的buffer和iter联系起来
                           // 以后就可以通过GTK.gtk_text_buffer_insert默认是一个一个iter的执行。
                GTK.gtk_list_store_append(liststore, listiter); //指针开始指到第一个位置
                // 6 逐个iter添加数据到liststore当中:每个iter的意思，就是逐行或者逐个记录。
                GTK.gtk_list_store_set_value(liststore, listiter, 0, &amp;quot;001&amp;quot;);
                GTK.gtk_list_store_set_value(liststore, listiter, 1, &amp;quot;YinMuHuaDao&amp;quot;);
                GTK.gtk_list_store_set_value(liststore, listiter, 2, &amp;quot;35&amp;quot;);
                GTK.gtk_list_store_append(liststore, listiter); //如果不加入，指针不下移，只会覆盖掉前面的数据
                GTK.gtk_list_store_set_value(liststore, listiter, 0, &amp;quot;002&amp;quot;);
                GTK.gtk_list_store_set_value(liststore, listiter, 1, &amp;quot;Taiyanghua&amp;quot;);
                GTK.gtk_list_store_set_value(liststore, listiter, 2, &amp;quot;29&amp;quot;);
                GTK.gtk_list_store_append(liststore, listiter);
                GTK.gtk_list_store_set_value(liststore, listiter, 0 ,&amp;quot;003&amp;quot;);
                GTK.gtk_list_store_set_value(liststore, listiter, 1 ,&amp;quot;Xiaojun&amp;quot;);
                GTK.gtk_list_store_set_value(liststore, listiter, 2 ,&amp;quot;10&amp;quot;);
                // 之所以添加9次是因为  3个字段*3条记录 == 9
                
                //7  使用完iter之后一定要记得 关掉它
                GTK.gtk_tree_iter_free(listiter);
                
                //8 关键的一步，把数字显示出来
                GTK.gtk_tree_view_set_model(treeViewApple, liststore);
                
                //并同时把它显示出来，前台必须显示
                GTK.gtk_widget_show(treeViewApple);
                //最后添加到合租房中
                //GTK.gtk_grid_attach(gridHouse, treeViewApple, 0, 1, 3, 3);
                
                
                start = 1;
                createScrolledBar(gridHouse,start,treeViewApple);
                start = 4;
                createPrintButton(gridHouse,start);
                createLabel(gridHouse, start, &amp;quot;ID&amp;quot;);
                //createEntry(entryID, gridHouse, start);
                entryID = GTK.gtk_entry_new();
                GTK.gtk_entry_set_max_length(entryID, 30);
                GTK.gtk_widget_show(entryID);
                GTK.gtk_grid_attach(gridHouse, entryID, 5, start, 1, 1);
                start = 5;
                createShowButton(gridHouse,start,1,1);
                createLabel(gridHouse, start, &amp;quot;名字&amp;quot;);
                //createEntry(entryName, gridHouse, start);
                entryName = GTK.gtk_entry_new();
                GTK.gtk_entry_set_max_length(entryName, 30);
                GTK.gtk_widget_show(entryName);
                GTK.gtk_grid_attach(gridHouse, entryName, 5, start, 1, 1);
                start = 6 ; 
                createHideColumnButton(gridHouse,treeViewApple,start,1);
                createLabel(gridHouse, start, &amp;quot;年龄&amp;quot;);
                //createEntry(entryAge, gridHouse, start);
                entryAge = GTK.gtk_entry_new();
                GTK.gtk_entry_set_max_length(entryAge, 30);
                GTK.gtk_widget_show(entryAge);
                GTK.gtk_grid_attach(gridHouse, entryAge, 5, start, 1, 1);
                start = 7 ; 
                createResizeColumnButton(gridHouse,treeViewApple,start,1);
                createInsertRecordButton(gridHouse,start);
                start = 8;
                createRecoredColumnButton(gridHouse,treeViewApple,start,1);
                start = 9;
                createSortColumnButton(gridHouse,treeViewApple,start,1);
                
                //加入行选择事件
                rowSelection();
                //3
                
                //添加控件
                
                //显示控件
                //GTK.gtk_widget_show(liststore);
                
                //启动循环
                GTK.gtk_main();
        }
        
        /**
         * 
         * @param gridHouse     网格对象布局的标识
         * @param start         网格布局的所处行数
         * @param treeview      treeview的对象标识
         */
        public static void createScrolledBar(int gridHouse,int start,int treeview)
        {
                int scrollbar = GTK.gtk_scrolled_window_new();
                GTK.gtk_container_add(scrollbar, treeview);
                GTK.gtk_widget_set_size_request(scrollbar, 200, 200);
                GTK.gtk_widget_show(scrollbar);
                GTK.gtk_grid_attach(gridHouse, scrollbar, 0, start, 3, 3);
        }
        /**
         * 
         * @param treeView       treeView对象标识
         * @param nth_columns    添加字段到第几列
         * @param column_name    字段的名字
         * @note  一般是一次创建记录
         */
        public static void createColumn(int treeView, int nth_columns, String column_name)
        {
                int temp_column = GTK.gtk_tree_view_column_new_with_attributes(column_name, GTK.gtk_cell_renderer_text_new(), nth_columns);
                GTK.gtk_tree_view_append_column(treeView, temp_column);
        }
        /**
         * 
         * @param ID      记录的ID号
         * @param Names   记录的名字
         * @param Age     记录的年龄
         * @note      需要多次创建记录
         */
        public static void createRecord(String ID, String Names, String Age,int listiter)
        {
                
                GTK.gtk_list_store_append(liststore, listiter); //指针下一继续添加的作用
                //append两个作用 1：添加 2：iter指针下移
                GTK.gtk_list_store_set_value(liststore, listiter, 0, ID);
                GTK.gtk_list_store_set_value(liststore, listiter, 1, Names);
                GTK.gtk_list_store_set_value(liststore, listiter, 2, Age);
                
        }
        
        public static void printRecord(int liststore)
        {
                //必须新建，不能利用原先的listiter,哪边需要用控制，就需要建一个控件。！！！否则报错！！不能用全局的 listiter
                int iter = GTK.gtk_tree_iter_new();
/*                if(GTK.gtk_tree_model_get_iter_first(liststore, listiter))
                {
                        do
                        {
                                String ID = GTK.gtk_tree_model_get_value(liststore, listiter, 0);
                                String Names = GTK.gtk_tree_model_get_value(liststore, listiter, 1);
                                String Ages = GTK.gtk_tree_model_get_value(liststore, listiter, 2);
                                //showInfo(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages,&amp;quot;显示员工信息&amp;quot;);
                                System.out.println(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages);
                                
                        }while(GTK.gtk_tree_model_iter_next(liststore,listiter));
                }else
                {
                        System.out.println(&amp;quot;表中无数据&amp;quot;);
                }*/
                // 减少代码的深度。
                if(!GTK.gtk_tree_model_get_iter_first(liststore, iter))
                {
                        System.out.println(&amp;quot;treeview没有数据  请添加记录&amp;quot;);
                        return;
                }
                do
                {
                        String ID = GTK.gtk_tree_model_get_value(liststore, iter, 0);
                        String Names = GTK.gtk_tree_model_get_value(liststore, iter, 1);
                        String Ages = GTK.gtk_tree_model_get_value(liststore, iter, 2);
                        //showInfo(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages,&amp;quot;显示员工信息&amp;quot;);
                        System.out.println(&amp;quot;这个员工的ID是&amp;quot;+ID+&amp;quot;,他的名字是&amp;quot;+Names+&amp;quot;,并且它的年龄是&amp;quot;+Ages);
                        
                }while(GTK.gtk_tree_model_iter_next(liststore,iter));
                
                GTK.gtk_tree_iter_free(iter);//释放了 还是有错误。。。
        }
        
        public static void showInfo(  String  message,String title)
        {
                int msgDlg = GTK.gtk_message_dialog_new(0, GTK.GTK_DIALOG_DESTROY_WITH_PARENT|
                                GTK.GTK_DIALOG_MODAL,GTK.GTK_MESSAGE_INFO, GTK.GTK_BUTTONS_OK,message);
                GTK.gtk_window_set_title(msgDlg, title);
                int ret = GTK.gtk_dialog_run(msgDlg);
                 
                if( ret == GTK.GTK_RESPONSE_OK)
                {
                        GTK.gtk_widget_destroy(msgDlg);
                }else
                {
                        GTK.gtk_widget_destroy(msgDlg);
                }

        }
        public static boolean showWarning(  String  message,String title)
        {
                int msgDlg = GTK.gtk_message_dialog_new(0, GTK.GTK_DIALOG_DESTROY_WITH_PARENT|
                                GTK.GTK_DIALOG_MODAL,GTK.GTK_MESSAGE_WARNING, GTK.GTK_BUTTONS_OK,message);
                GTK.gtk_window_set_title(msgDlg, title);
                int ret = GTK.gtk_dialog_run(msgDlg);
                GTK.gtk_widget_destroy(msgDlg);
                return ret == GTK.GTK_RESPONSE_OK;
        }
        public static void createPrintButton(int gridHouse,int start)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;遍历&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 0, start, 1, 1);
                insertButtonEvent(btnApple);
        }
        public static void createShowButton(int gridHouse,int start,int row, int column)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;获取表第&amp;quot;+row+&amp;quot;行&amp;quot;+&amp;quot;第&amp;quot;+column+&amp;quot;列&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 0, start, 1, 1);
                insertShowEvent(btnApple,row,column);
        }
        public static void createHideColumnButton(int gridHouse,int treeViewApple,int start,int nthcolumn)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;隐藏|显示第&amp;quot;+nthcolumn+&amp;quot;列&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 0, start, 1, 1);
                insertHideEvent(treeViewApple, btnApple, nthcolumn);
        }
        
        public static void createResizeColumnButton(int gridHouse,int treeViewApple,int start,int nthcolumn)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;赋予第&amp;quot;+nthcolumn+&amp;quot;列可调整大小的权限&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 0, start, 1, 1);
                insertResizeEvent(treeViewApple, btnApple, nthcolumn);
        }
        public static void createRecoredColumnButton(int gridHouse,int treeViewApple,int start,int nthcolumn)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;赋予第&amp;quot;+nthcolumn+&amp;quot;列可移动的权限&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 0, start, 1, 1);
                insertRecordableEvent(treeViewApple, btnApple, nthcolumn);
        }
        public static void createSortColumnButton(int gridHouse,int treeViewApple,int start,int nthcolumn)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;赋予第&amp;quot;+nthcolumn+&amp;quot;列可排序的权限&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 0, start, 1, 1);
                insertSortEvent(treeViewApple, btnApple, nthcolumn);
        }
        public static void createInsertRecordButton(int gridHouse,int start)
        {
                int btnApple = GTK.gtk_button_new_with_label(&amp;quot;插入数据&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_grid_attach(gridHouse, btnApple, 5, start, 1, 1);
                insertRecordEvent(btnApple);
        }
        public static void createLabel(int gridHouse, int start,String labelName)
        {
                int labelApple = GTK.gtk_label_new(labelName);
                GTK.gtk_widget_show(labelApple);
                GTK.gtk_grid_attach(gridHouse, labelApple, 4, start, 1, 1);
                
        }
        public static void createEntry(int entryApple,int gridHouse, int start)
        {
                entryApple = GTK.gtk_entry_new();
                GTK.gtk_entry_set_max_length(entryApple, 30);
                GTK.gtk_widget_show(entryApple);
                GTK.gtk_grid_attach(gridHouse, entryApple, 5, start, 1, 1);
        }
        public static void insertButtonEvent(final int btnSin)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                printRecord(liststore);
                        }
                }, null);
        }
        public static void insertShowEvent(final int btnSin,final int row, final int column)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                showColumnRow(row,column);
                        }
                }, null);
        }
        public static void insertHideEvent(final int treeViewApple,final int btnSin, final int nthcolumn)
        {
                //final boolean columnVisible = true;
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                tree_view_column_set_hide(treeViewApple,nthcolumn,columnVisible);
                                columnVisible = !columnVisible;
                        }
                }, null);
        }
        public static void insertResizeEvent(final int treeViewApple,final int btnSin, final int nthcolumn)
        {
                //final boolean columnVisible = true;
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                tree_view_column_resize(treeViewApple,nthcolumn,columnResize);
                                columnResize = !columnResize;
                        }
                }, null);
        }
        
        public static void insertRecordableEvent(final int treeViewApple,final int btnSin, final int nthcolumn)
        {
                //final boolean columnVisible = true;
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                tree_view_column_recordabel(treeViewApple,nthcolumn,columnRecordable);
                                columnRecordable = !columnRecordable;
                        }
                }, null);
        }
        public static void insertSortEvent(final int treeViewApple,final int btnSin, final int nthcolumn)
        {
                //final boolean columnVisible = true;
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                tree_view_column_sort(treeViewApple,nthcolumn,1);
                                //columnRecordable = !columnRecordable;
                        }
                }, null);
        }
        public static void insertRecordEvent(final int btnSin)
        {
                //final boolean columnVisible = true;
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                String ID = GTK.gtk_entry_get_text(entryID);
                                System.out.println(ID);
                                if(ID.equalsIgnoreCase(&amp;quot;&amp;quot;))
                                {
                                        showWarning(&amp;quot;ID为空，请重新输入&amp;quot;,&amp;quot;警告&amp;quot;);
                                        return;
                                }
                                String Name = GTK.gtk_entry_get_text(entryName);
                                if(Name.equalsIgnoreCase(&amp;quot;&amp;quot;))
                                {
                                        showWarning(&amp;quot;Name为空，请重新输入&amp;quot;,&amp;quot;警告&amp;quot;);
                                        return;
                                }
                                String Age = GTK.gtk_entry_get_text(entryAge);
                                if(Age.equalsIgnoreCase(&amp;quot;&amp;quot;))
                                {
                                        showWarning(&amp;quot;Age为空，请重新输入&amp;quot;,&amp;quot;警告&amp;quot;);
                                        return;
                                }
                                insertRecord(ID,Name, Age, treeViewApple);
                                 
                                
                        }
                }, null);
        }
        public static void insertRecord(String ID,String Name,String Age,int treeViewApple)
        {
                int iter = GTK.gtk_text_iter_new();
                if(!GTK.gtk_tree_model_get_iter_first(liststore, iter))
                {
                        createRecord( ID,  Name,  Age,iter);
                }
                else
                {
                        do
                        {
                                //System.out.println(&amp;quot;hello&amp;quot;);
                        }while(GTK.gtk_tree_model_iter_next(liststore, iter));
                        //while(GTK.gtk_tree_model_iter_next(liststore, iter)); 
                        // 记一次调bug经理，，经常把iter_next写成了 iter_first导致不断的循环
                        //出现无限循环，最后嵌入 system打印出来即可。
                        createRecord( ID,  Name,  Age,iter);
                }
                GTK.gtk_text_iter_free(iter);
                GTK.gtk_tree_view_set_model(treeViewApple, liststore);
        }
        public static void showColumnRow(int row, int column)
        {
                int i = 0;
                if(0 == getNumberOfListstore(liststore))
                {
                        System.out.println(&amp;quot;100块都不给 还想查！&amp;quot;);
                        return ;
                }
                if(row &amp;gt; getNumberOfListstore(liststore))
                {
                        System.out.println(&amp;quot;记录数没有！  请重新查询&amp;quot;);
                        return;
                }
                int iter  = GTK.gtk_tree_iter_new();
                GTK.gtk_tree_model_get_iter_first(liststore, iter);
                do
                {
                        if(i == row)
                        {
                                String temp = GTK.gtk_tree_model_get_value(liststore, iter, column);
                                System.out.println(temp);
                                showInfo(temp,&amp;quot;显示信息&amp;quot;);
                                return;
                        }
                        i++;
                }while(GTK.gtk_tree_model_iter_next(liststore, iter));
                
        }
        public static int getNumberOfListstore(int liststore)
        {
                int sum = 0;
                int iter = GTK.gtk_tree_iter_new();
                if(!GTK.gtk_tree_model_get_iter_first(liststore, iter))
                {
                        return sum;
                }
                do
                {
                        sum++;
                }while(GTK.gtk_tree_model_iter_next(liststore, iter));
                return sum;
        }
        
        public static void tree_view_column_set_hide(int treeViewApple,int nthColumn,boolean visible)
        {
                int column =GTK.gtk_tree_view_get_column(treeViewApple, nthColumn);
                GTK.gtk_tree_view_column_set_visible(column, visible);
        }
        public static void tree_view_column_resize(int treeViewApple,int nthColumn,boolean visible)
        {
                int column =GTK.gtk_tree_view_get_column(treeViewApple, nthColumn);
                GTK.gtk_tree_view_column_set_resizable(column, visible);
        }
        public static void tree_view_column_recordabel(int treeViewApple,int nthColumn,boolean visible)
        {
                int column =GTK.gtk_tree_view_get_column(treeViewApple, nthColumn);
                GTK.gtk_tree_view_column_set_reorderable(column, visible);
        }
        public static void tree_view_column_sort(int treeViewApple,int nthColumn,int sortcolumnid)
        {
                int column =GTK.gtk_tree_view_get_column(treeViewApple, nthColumn);
                GTK.gtk_tree_view_column_set_sort_column_id(column, sortcolumnid);
        }
        
        public static void rowSelection()
        {
                int selection = GTK.gtk_tree_view_get_selection(treeViewApple);
                GTK.gtk_tree_selection_set_mode(selection, GTK.GTK_SELECTION_MULTIPLE);
                GTK.g_signal_connect(treeViewApple, &amp;quot;button-press-event&amp;quot;, new IGCallBack()
                { 
                 @Override
                 public void execute(int instance, int eventData, Object object)
                 {
                  if(GTK.gdk_event_get_type(eventData)==GTK.GDK_2BUTTON_PRESS)
                  {
                   int[] indices = GTK.gtk_tree_view_get_selection_indices(treeViewApple);
                   System.out.println(indices[0]);
                  }
                 }
                }, null);
        }
        
/*        public static void deleteOneRecore()
        {
                int selection = GTK.gtk_tree_view_get_selection(treeViewApple);
                
        }*/
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case3 工具栏+进度条+menu+statusIcon+开关按钮+calendar&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author    叶昭良
* @time      2015年2月3日上午1:24:01
* @version   TestToolBar V1.0
* @version   TestToolBar V2.0  增加了一个日历控件,添加了天数变化时间和双击时间
* @version   TestToolBar V2.0  增加了进度条的创建，和按钮事件 控制进度条
* @version   TestToolBar V4.0  建议的开关按钮，未实现信号的接受。。。
* @version   TestToolBar V5.0  增加了一个菜单控件
* @version   TestToolBar V6.0  增加了一个StatusIcon的简单控件        
*/
public class TestToolBar
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        static double progress = 0.0;
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                window= GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                GTK.gtk_widget_show(window);
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                GTK.gtk_main_quit();
                        }
                }, null);
                
                //设置网格布局
                gridHouse = GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                GTK.gtk_container_add(window, gridHouse);
                
                //定义一些常用的控件
                int start = 0;
                createToolbar(gridHouse,start);
                start =1;
                createCalendar(gridHouse,start);
                start = 2;
                createProgressBar(gridHouse, start);
                start = 3;
                createSwitchOn(gridHouse, start);
                start = 4;
                createMenu(gridHouse,start);
                start = 5;
                createStatusIcon(gridHouse,start);
                //启动循环
                GTK.gtk_main();
        }
        
        public static void createToolbar(int gridHouse,int start)
        {
                //创建工具栏容器
                int tbApple = GTK.gtk_toolbar_new();
                GTK.gtk_widget_show(tbApple);
                GTK.gtk_widget_set_size_request(tbApple, 300, 20);
                GTK.gtk_grid_attach(gridHouse, tbApple, 0, start, 1, 1);
                
          int btnNew = GTK.gtk_tool_button_new(0, &amp;quot;新建&amp;quot;);
          GTK.gtk_tool_button_set_stock_id(btnNew, GTK.GTK_STOCK_NEW);
          GTK.gtk_widget_show(btnNew);
          GTK.gtk_toolbar_insert(tbApple, btnNew, 0);
                   
          int btnOpen = GTK.gtk_tool_button_new(0, &amp;quot;打开&amp;quot;);
          GTK.gtk_tool_button_set_stock_id(btnOpen, GTK.GTK_STOCK_OPEN);
          GTK.gtk_widget_show(btnOpen);
          GTK.gtk_toolbar_insert(tbApple, btnOpen, 1);
          
          int btnSave = GTK.gtk_tool_button_new(0, &amp;quot;保存&amp;quot;);
          GTK.gtk_tool_button_set_stock_id(btnSave, GTK.GTK_STOCK_SAVE);
          GTK.gtk_widget_show(btnSave);
          GTK.gtk_toolbar_insert(tbApple, btnSave, 2);
        }
        
        public static void createCalendar(int gridHouse, int start) 
        {
                final int clApple = GTK.gtk_calendar_new();
                int labelApple = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                GTK.gtk_widget_show(clApple);
                GTK.gtk_widget_show(labelApple);
                GTK.gtk_grid_attach(gridHouse, clApple, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, clApple, 1, start, 1, 1);
                GTK.gtk_widget_set_size_request(clApple, 200, 200);
                
                GTK.g_signal_connect(clApple, &amp;quot;day-selected&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                int day = GTK.gtk_calendar_get_day(clApple);
                                int month = GTK.gtk_calendar_get_month(clApple);
                                int year = GTK.gtk_calendar_get_year(clApple);
                                System.out.println(&amp;quot;用户选择了&amp;quot;+year+&amp;quot;年&amp;quot;+month+&amp;quot;月&amp;quot;+day+&amp;quot;日&amp;quot;);
                                //showInfo(&amp;quot;用户选择了&amp;quot;+year+&amp;quot;年&amp;quot;+month+&amp;quot;月&amp;quot;+day+&amp;quot;日&amp;quot;,&amp;quot;选择的日期&amp;quot;);
                        }
                }, null);
                GTK.g_signal_connect(clApple, &amp;quot;day-selected-double-click&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                int day = GTK.gtk_calendar_get_day(clApple);
                                int month = GTK.gtk_calendar_get_month(clApple);
                                int year = GTK.gtk_calendar_get_year(clApple);
                                showInfo(&amp;quot;用户选择了&amp;quot;+year+&amp;quot;年&amp;quot;+month+&amp;quot;月&amp;quot;+day+&amp;quot;日&amp;quot;,&amp;quot;选择的日期&amp;quot;);
                        }
                }, null);
        }
        public static boolean showInfo(  String  message,String title)
        {
                int msgDlg = GTK.gtk_message_dialog_new(0, GTK.GTK_DIALOG_DESTROY_WITH_PARENT|
                                GTK.GTK_DIALOG_MODAL,GTK.GTK_MESSAGE_INFO, GTK.GTK_BUTTONS_OK,message);
                GTK.gtk_window_set_title(msgDlg, title);
                int ret = GTK.gtk_dialog_run(msgDlg);
                GTK.gtk_widget_destroy(msgDlg);
                return ret == GTK.GTK_RESPONSE_OK;
        }
        
        public static void createProgressBar(int gridHouse,int start)
        {
                final int pbApple =GTK.gtk_progress_bar_new();
                int btnApple =GTK.gtk_button_new_with_label(&amp;quot;加快进度&amp;quot;);
                GTK.gtk_widget_show(btnApple);
                GTK.gtk_widget_show(pbApple);
                GTK.gtk_grid_attach(gridHouse, pbApple, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnApple, 1, start, 1, 1);
                
                GTK.gtk_progress_bar_set_fraction(pbApple, progress);
                        //GTK.gtk_progress_bar_set_pulse_step()
/*                        try
                        {
                                Thread.sleep(1000);
                        } catch (InterruptedException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }*/
                GTK.g_signal_connect(btnApple, &amp;quot;clicked&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                if(progress &amp;lt;= 1.0)
                                {
                                        progress = progress + 0.2;
                                        GTK.gtk_progress_bar_set_fraction(pbApple, progress);
                                }else
                                {
                                        System.out.println(&amp;quot;stop clicked&amp;quot;);
                                }
                                
                        }
                }, null);
                
                GTK.gtk_progress_bar_set_text(pbApple, &amp;quot;请稍后&amp;quot;);
        }
        
        public static void createSwitchOn(int gridHouse, int start)
        {
                final int switchOff = GTK.gtk_switch_new();
                final int label = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                GTK.gtk_widget_show(switchOff);
                GTK.gtk_widget_show(label);
                GTK.gtk_grid_attach(gridHouse, switchOff, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, label, 1, start, 1, 1);
                GTK.gtk_switch_set_active(switchOff, true);
                //GTK.g_signal_connect(switchOff, &amp;quot;state-set&amp;quot;, new IGCallBack()
                
                GTK.g_signal_connect(switchOff, &amp;quot;activate&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                System.out.println(&amp;quot;hello&amp;quot;);
                                        if(GTK.gtk_switch_get_active(switchOff))
                                        {
                                                //GTK.gtk_label_set_text(label, &amp;quot;你打开了&amp;quot;);
                                                System.out.println(&amp;quot;hello&amp;quot;);
                                        }
                                        else
                                        {
                                                //GTK.gtk_label_set_text(label, &amp;quot;你关闭了&amp;quot;);
                                                System.out.println(&amp;quot;fuck&amp;quot;);
                                        }
                        }
                }, null);

        }
        public static void createMenu(int gridHouse, int start)
        {
                //分三步
                //1创建单一菜单
                //2创建一个菜单头
                //3创建总的菜单条，把许多菜单头都挂到菜单条上
                //创建一个菜单
                int menu = GTK.gtk_menu_new();
                
                int file = GTK.gtk_menu_item_new_with_label(&amp;quot;_F文件&amp;quot;);
                int new1  = GTK.gtk_menu_item_new_with_label(&amp;quot;新建&amp;quot;);
                int open1 = GTK.gtk_menu_item_new_with_label(&amp;quot;打开&amp;quot;);
                int closed = GTK.gtk_menu_item_new_with_label(&amp;quot;关闭&amp;quot;);
                int import1 = GTK.gtk_menu_item_new_with_mnemonic(&amp;quot;_Import导入&amp;quot;);
                //int image = GTK.gtk_menu_tool_button_new_from_stock(GTK.GTK_STOCK_NEW);
                //fengexian 
                GTK.gtk_widget_show(menu);
                GTK.gtk_widget_show(new1);
                GTK.gtk_widget_show(open1);
                GTK.gtk_widget_show(closed);
                GTK.gtk_widget_show(file);
                GTK.gtk_widget_show(import1);
                
                GTK.gtk_menu_shell_append(menu, file);
                GTK.gtk_menu_shell_append(menu, new1);
                GTK.gtk_menu_shell_append(menu, open1);
                GTK.gtk_menu_shell_append(menu, closed);
                GTK.gtk_menu_shell_append(menu, import1);
                // 菜单条
                int menubar = GTK.gtk_menu_bar_new();
                GTK.gtk_widget_show(menubar);
                GTK.gtk_grid_attach(gridHouse, menubar, 0, start, 1, 1);
                
                //2 添加一个menu 到menu小头
                int file_item =  GTK.gtk_menu_item_new_with_label(&amp;quot;File&amp;quot;);
                GTK.gtk_widget_show(file_item);
                GTK.gtk_menu_item_set_submenu(file_item, menu);
                
                //3 添加一个 menu小头到menubar
                GTK.gtk_menu_shell_append(menubar, file_item);
//                GTK.gtk_menu_attach_to_widget(menubar, attach_widget);
                GTK.g_signal_connect(closed, &amp;quot;activate&amp;quot;,new IGCallBack(){
                                @Override
                                public void execute(int instance, int eventData, Object object)
                                {
                                        // TODO Auto-generated method stub
                                        GTK.gtk_main_quit();
                                }
                        }, null);
                }
        
        public static void createStatusIcon(int gridHouse,int start)
        {
                int status = GTK.gtk_status_icon_new();
                //GTK.gtk_widget_show(status);
                //GTK.gtk_grid_attach(gridHouse, status, 0, status, 1, 1);
                GTK.gtk_status_icon_set_from_stock(status, GTK.GTK_STOCK_CONNECT);
                GTK.gtk_status_icon_set_tooltip_text(status, &amp;quot;hello&amp;quot;); //的确是会显示在下方
                GTK.gtk_status_icon_set_visible(status, true);
                
                GTK.g_signal_connect(status, &amp;quot;popup-menu&amp;quot;, new IGCallBack() {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
/*                                int menu = GTK.gtk_menu_new();
                                
                                int file = GTK.gtk_menu_item_new_with_label(&amp;quot;_F文件&amp;quot;);
                                int new1  = GTK.gtk_menu_item_new_with_label(&amp;quot;新建&amp;quot;);
                                int open1 = GTK.gtk_menu_item_new_with_label(&amp;quot;打开&amp;quot;);
                                int closed = GTK.gtk_menu_item_new_with_label(&amp;quot;关闭&amp;quot;);
                                int import1 = GTK.gtk_menu_item_new_with_mnemonic(&amp;quot;_Import导入&amp;quot;);
                                //int image = GTK.gtk_menu_tool_button_new_from_stock(GTK.GTK_STOCK_NEW);
                                //fengexian 
                                GTK.gtk_widget_show(menu);
                                GTK.gtk_widget_show(new1);
                                GTK.gtk_widget_show(open1);
                                GTK.gtk_widget_show(closed);
                                GTK.gtk_widget_show(file);
                                GTK.gtk_widget_show(import1);
                                
                                GTK.gtk_menu_shell_append(menu, file);
                                GTK.gtk_menu_shell_append(menu, new1);
                                GTK.gtk_menu_shell_append(menu, open1);
                                GTK.gtk_menu_shell_append(menu, closed);
                                GTK.gtk_menu_shell_append(menu, import1);
                                GTK.gtk_menu_popup(menu);*/
                                showInfo(&amp;quot;hello&amp;quot;,&amp;quot;wenho&amp;quot;);
                        }
                }, null);
/*                GTK.g_signal_connect(status, &amp;quot;statusIconActivate&amp;quot;, new IGCallBack() {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                showInfo(&amp;quot;hello&amp;quot;,&amp;quot;wenho&amp;quot;);
                          
                        }},null);*/
        
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/MVC.gif&#34; alt=&#34;MVC交互图&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/jianyijishi.gif&#34; alt=&#34;简易记事本+工具栏&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/yang.gif&#34; alt=&#34;工具栏+menu+statusICON+prograssBar+switchOFF+calendar&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>2月27日Java周末班试题</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-27ri-javazhou-mo-ban-shi-ti/</link>
      <pubDate>Mon, 11 May 2015 14:58:41 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-27ri-javazhou-mo-ban-shi-ti/</guid>
      <description>&lt;p&gt;0105班Java周末班试题（JDBC 9-16）
阶段性考试（考试6个小时，讲评+重写6个小时）：
记录完成每个题所需要的时长。
第一题、SQL题
表格见图片附件
题目：编写SQL语句完成下面的功能：
条件查询：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在GRADE表中查找80-90份的学生学号和分数&lt;/li&gt;
&lt;li&gt;在GRADE 表中查找课程编号为003学生的平均分&lt;/li&gt;
&lt;li&gt;在GRADE 表中查询学习各门课程的人数&lt;/li&gt;
&lt;li&gt;查询所有姓张的学生的学号和姓名&lt;/li&gt;
&lt;li&gt;查询分数在80-90分的学生的学号、姓名、分数&lt;/li&gt;
&lt;li&gt;查询学习了’C语言’课程的学生学号、姓名和分数
第二题
不参考、不对照任何老师、同学的代码编写JDBCUtils。并记录写完需要的时间。
第三题
编写手机号码查询归属地案例。并记录写完需要的时间&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;%E7%AC%AC%E4%B8%80%E9%A2%98%E8%A1%A8%E6%A0%BC.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;考试未通过，中途出去，fail;&lt;/p&gt;
&lt;p&gt;第一题：
费时：4个小时左右
表设计阶段：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;;;;创建一个考试数据库
create database exam;  
use exam;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;错误分析：
curriculum是一个基础表！ 连接grade表！Grade表连接student_info表 ，认为student_info存在外键
经过折腾：认为student_info没有外键，而grade表存在两个外键&lt;/p&gt;
&lt;p&gt;Curriculum 表的设计：
curriculum_no 课程编号 :&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;    varchar(20)not null auto_increment primary key, 
    ;;后来思考 int改变为varchar(20)因为也许会出现非数字
corriculum_name课程名称   varchar(20) not null default ‘’
Credit学分 ： real(5,2) not null default 0.0     
    ;;;(real默认是double类型)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其间遇到无法显示汉字的情况：
1：数据库级别修改
修改数据库级别，命令如下：use edu(换成你要修改的数据库名，在这里我的数据库为edu),，然后执行命令：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;alter database exam character set utf-8;
或者
SET NAMES &#39;utf8&#39;; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2：数据表级别的修改&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;ALTER TABLE table_name DEFAULT CHARSET utf8;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3: 发现经过这两个大小修改还是不行,于是也对字段进行修改&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;alter table curriculum modify curriculum_no varchar(20) character set utf8
alter table curriculum modify curriculum_name varchar(20) character set utf8;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;但是依然不行！！说明之前插入的只好清空，再插入一遍， 然后就可以了&lt;/p&gt;
&lt;p&gt;grade表的设计：&lt;/p&gt;
&lt;p&gt;此表的设计一波三折，在添加外键的时候多次出现错误，下面先给出错误的，再列出正确的添加方式&lt;/p&gt;
&lt;p&gt;错误分析表：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;stu_no 学号：  varchar(20) not null auto_increment primary key,
  ;;后来思考 int改变为varchar(20)因为也许会出现非数字
课程编号  curriculum_no : int not null, foreign key(curriculum_no) references Curriculum


(Curriculum_no) on delete restrict on update cascade
Score 分数 :    real(5,2) not null default 0.0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;外键知识：
1.MYSQL在建外键后,会自动建一个同名的索引,引入外键的缺点是会使速度和性能下降&lt;/p&gt;
&lt;p&gt;在创建表的时候添加外键：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create table grade(
   stu_no varchar(20) not null default &#39;&#39;,
    curriculum varchar(20) not null default &#39;&#39;,constraint hello foreign key
     (curriculum) references curriculum(curriculum_no) on delete restrict
     on update cascade,
    stu_score real(5,2) not null default 0.00);

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在创建表后天添加外键：
添加一个叫hello的外键：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;alter table grade add constraint hello foreign key(stu_curriculum_no) ref
erences curriculum(curriculum_no) on delete restrict on update cascade;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;查看grade表信息：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;| grade | CREATE TABLE `grade` (
  `stu_no` varchar(20) NOT NULL,
  `stu_curriculum_no` varchar(20) NOT NULL DEFAULT &#39;&#39;,
  `stu_score` double(5,2) NOT NULL DEFAULT &#39;0.00&#39;,
  PRIMARY KEY (`stu_no`),
  KEY `hello` (`stu_curriculum_no`),
  CONSTRAINT `hello` FOREIGN KEY (`stu_curriculum_no`) REFERENCES `curriculum` (
`curriculum_no`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 |
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中Key hello (stu_curriculum_no) 就是所谓的索引，一般可以这样
查看表索引  show index from grade;
删除表索引  alter table grade drop index hello&lt;/p&gt;
&lt;p&gt;删除表中的外键：
ALTER TABLE grade DROP FOREIGN KEY fk_member;
当然一般在删除的时候需要
show create table grade 这样可以查看 CONSTRAINT后的名字  比如fk_memeber在本例中就是hello&lt;/p&gt;
&lt;p&gt;后来再次思考，grade表不可能有主键，因为学号可能多次出现在不同记录中！于是删除主键
alter table grade drop primary key;
（添加主键的方式：alter table table_test add primary key(id);）&lt;/p&gt;
&lt;p&gt;我再次新建一张表grade1目的是测试，在同一个库中的确不能存在两个相同的外键名，否则报错，
下面我用hello1则是通过。（应该是此原因）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create table grade1(
     stuno varchar(20) not null default &#39;&#39;,
    curi varchar(20) not null default &#39;&#39;,constraint hello1 foreign key
     (curi) references curriculum(curriculum_no),
     score real(5,2) not null default 0.00);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ERROR 1022 (23000): Can&amp;rsquo;t write; duplicate key in table &amp;lsquo;grade&amp;rsquo;的解决方案：外键名字改成没用过的就可以（整个数据库exam范围内）
下面再次新建一张表grade2 ,目的是测试不同表是不是可以使用字段名字相同的充当外键，当然是没问题啦！
因为在设计表的时候，曾经怕如果curi改为curriculum_no会不会报错的问题。所以就一起尝试了&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create table grade2(
     stu_no varchar(20) not null default &#39;&#39;,
    curi varchar(20) not null default &#39;&#39;,constraint hello2 foreign key
     (curi) references curriculum(curriculum_no) on delete restrict on update
    cascade,
     score real(5,2) not null default 0.00);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;现在先把grade表放在一边 ，待会设计完student_info表之后再聊grade表的事情。&lt;/p&gt;
&lt;p&gt;Student_info表的设计&lt;/p&gt;
&lt;p&gt;不合理的设计（主键同时是外键，不好）：
学号 student_no : int  not null auto_increment primary key, foreign key(student_no) references&lt;/p&gt;
&lt;p&gt;grade on grade(student_no) on delete restrict on update cascade,（后来修改为 主键！因为一个表即为&lt;/p&gt;
&lt;p&gt;主键和外键叠加不好！！ 同时让grade的stu_no 也增加一个外键  连接到student_info表）
姓名  stu_name  : varchar(20) not null default ‘’,
性别  stu_sex    : char(2)  not null default ‘男‘，
出生年月 stu_date (stu_birth): date not null default ‘1990-01-04’
家庭住址 stu_family (stu_addr): varchar(20) not null default ‘’,
备注     stu_note : varchar(30) not null default ‘’,&lt;/p&gt;
&lt;p&gt;然后再次回到grade表，添加外键，&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;alter table grade add constraint fuck foreign key(stu_no) references stud
ent_info(stu_no) ;
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint f
ails (`exam`.`#sql-167c_1`, CONSTRAINT `fuck` FOREIGN KEY (`stu_no`) REFERENCES
`student_info` (`stu_no`))

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;报错了！！！为什么？
原来在非空表的情况不能添加外键
于是： delete from grade;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;alter table grade add constraint pig foreign key(stu_no) references
    student_info(stu_no) on delete restrict on update cascade;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最终我的grade表的结构：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;| grade | CREATE TABLE `grade` (
  `stu_no` varchar(20) NOT NULL DEFAULT &#39;&#39;,
  `curriculum` varchar(20) NOT NULL DEFAULT &#39;&#39;,
  `stu_score` double(5,2) NOT NULL DEFAULT &#39;0.00&#39;,
  KEY `hello` (`curriculum`),
  KEY `pig` (`stu_no`),
  CONSTRAINT `hello` FOREIGN KEY (`curriculum`) REFERENCES `curriculum` (`curric
ulum_no`) ON UPDATE CASCADE,
  CONSTRAINT `pig` FOREIGN KEY (`stu_no`) REFERENCES `student_info` (`stu_no`) O
N UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 |
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其实经过前面n过程的之后，你会发现这几张表在你的脑海中特别清晰：
1.学生的
2.成绩的
3.课程的&lt;/p&gt;
&lt;p&gt;最终的结果是：&lt;/p&gt;
&lt;p&gt;curriculum表的设计：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create table curriculum(
    curriculum_no int not null auto_increment primary key,
    curriculum_name varchar(20) not null default &#39;&#39;,
    curriculum_credit real(5,2) not null  default 0.0);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;curriculum表的数据添加：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;insert into curriculum(curriculum_no,curriculum_name,curriculum_credit) v
alues(&#39;0002&#39;,&#39;C语言&#39;,3.0);

insert into curriculum &amp;lt;curriculum_no,curriculum_name,curriculum_credit)
values (&#39;0001&#39;,&#39;计算机基础&#39;,2.2);
insert into curriculum (curriculum_no,curriculum_name,curriculum_credit) values(&#39;0003&#39;,&#39;编译原理&#39;,2.5);
insert into curriculum (curriculum_no,curriculum_name,curriculum_credit) values(&#39;0004&#39;,&#39;错做系统&#39;,3.5);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;student_info表的设计：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create table student_info(
     stu_no varchar(20) not null default &#39;&#39; primary key,
     stu_name varchar(20) not  null default &#39;&#39;,
    stu_sex char(4) not null default &#39;男&#39;,
     stu_birth date not null default &#39;1990-01-07&#39;,
     stu_addr varchar(20) not null default &#39;&#39;,
     stu_note varchar(30));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;student_info表的数据添加：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;insert into student_info (stu_no,stu_name,stu_sex,stu_birth,stu_addr) val
ues(&#39;0001&#39;,&#39;张三&#39;,&#39;男&#39;,1989-05-17,&#39;北京&#39;);

insert into student_info (stu_no,stu_name,stu_sex,stu_birth,stu_addr,stu_
note) values(&#39;0002&#39;,&#39;李四&#39;,&#39;女&#39;,1990-06-22,&#39;内蒙古&#39;,&#39;此女子性格刁蛮&#39;);

insert into student_info(stu_no,stu_name,stu_sex,stu_birth,stu_addr) valu
es(&#39;0003&#39;,&#39;王五&#39;,&#39;男&#39;,1992-02-18,&#39;江西&#39;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;grade表的设计&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create table grade3(
    stu_no varchar(20) not null default &#39;&#39;,constraint pig34 foreign key(stu_n
o) references student_info(stu_no) on delete restrict on update cascade,
     curriculum varchar(20) not null default &#39;&#39;,constraint hellodff foreign ke
y(curriculum) references curriculum(curriculum_no) on delete restrict on update
cascade,
    stu_score real(5,2) not null default 0.00);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;grade表的数据添加（截取部分）：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;insert into grade values(&#39;0002&#39;,&#39;0001&#39;,75),(&#39;0002&#39;,&#39;0002&#39;,60),(&#39;0002&#39;,&#39;00
03&#39;,79),(&#39;0002&#39;,&#39;0004&#39;,76);
insert into grade(stu_no,curriculum,stu_score) values(&#39;0003&#39;,&#39;0002&#39;,78);
注意了：如果外键表的0003没有的话，则无法添加0003，并报错！很正常，因为外键表student_info没有！！
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;题目结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select * from grade;
+--------+------------+-----------+
| stu_no | curriculum | stu_score |
+--------+------------+-----------+
| 0001   | 0001       |     80.00 |
| 0001   | 0002       |     85.00 |
| 0001   | 0003       |     90.00 |
| 0001   | 0004       |     92.00 |
| 0002   | 0001       |     75.00 |
| 0002   | 0002       |     60.00 |
| 0002   | 0003       |     79.00 |
| 0002   | 0004       |     76.00 |
| 0003   | 0001       |     80.00 |
| 0003   | 0002       |     78.00 |
| 0003   | 0003       |     97.00 |
| 0003   | 0004       |     86.00 |
+--------+------------+-----------+
12 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;在GRADE表中查找80-90份的学生学号和分数&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select stu_no as 学好 ,stu_score as 分数 from grade where stu_score&amp;gt;80.0
and stu_score&amp;lt;90.0;
+------+-------+
| 学好 | 分数  |
+------+-------+
| 0001 | 85.00 |
| 0003 | 86.00 |
+------+-------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;在GRADE 表中查找课程编号为003学生的平均分&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select avg(stu_score) from grade where curriculum=&#39;0003&#39;;
+----------------+
| avg(stu_score) |
+----------------+
|      88.666667 |
+----------------+
1 row in set (0.04 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;在GRADE 表中查询学习各门课程的人数&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select count(*),curriculum from grade group by curriculum;
+----------+------------+
| count(*) | curriculum |
+----------+------------+
|        3 | 0001       |
|        3 | 0002       |
|        3 | 0003       |
|        3 | 0004       |
+----------+------------+
4 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;查询所有姓张的学生的学号和姓名&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select stu_no 学号,stu_name 姓名  from student_info where stu_name like &#39;
张%&#39;;
+------+------+
| 学号 | 姓名 |
+------+------+
| 0001 | 张三 |
+------+------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;查询分数在80-90分的学生的学号、姓名、分数&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select s.stu_no 学号,s.stu_name 姓名,g.curriculum 课程,g.stu_score 分数 f
rom grade g
    -&amp;gt; left join student_info s on g.stu_no=s.stu_no;
+------+------+------+-------+
| 学号 | 姓名 | 课程 | 分数  |
+------+------+------+-------+
| 0001 | 张三 | 0001 | 80.00 |
| 0001 | 张三 | 0002 | 85.00 |
| 0001 | 张三 | 0003 | 90.00 |
| 0001 | 张三 | 0004 | 92.00 |
| 0002 | 李四 | 0001 | 75.00 |
| 0002 | 李四 | 0002 | 60.00 |
| 0002 | 李四 | 0003 | 79.00 |
| 0002 | 李四 | 0004 | 76.00 |
| 0003 | 王五 | 0001 | 80.00 |
| 0003 | 王五 | 0002 | 78.00 |
| 0003 | 王五 | 0003 | 97.00 |
| 0003 | 王五 | 0004 | 86.00 |
+------+------+------+-------+
12 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;进一步求解：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select s.stu_no 学号,s.stu_name 姓名,c.curriculum_name 课程名称,g.stu_sco
re 分数 from grade g
    -&amp;gt; left join student_info s on g.stu_no=s.stu_no
    -&amp;gt; left join curriculum c on g.curriculum=c.curriculum_no;
+------+------+------------+-------+
| 学号 | 姓名 | 课程名称   | 分数  |
+------+------+------------+-------+
| 0001 | 张三 | 计算机基础 | 80.00 |
| 0001 | 张三 | C语言      | 85.00 |
| 0001 | 张三 | 编译原理   | 90.00 |
| 0001 | 张三 | 操作系统   | 92.00 |
| 0002 | 李四 | 计算机基础 | 75.00 |
| 0002 | 李四 | C语言      | 60.00 |
| 0002 | 李四 | 编译原理   | 79.00 |
| 0002 | 李四 | 操作系统   | 76.00 |
| 0003 | 王五 | 计算机基础 | 80.00 |
| 0003 | 王五 | C语言      | 78.00 |
| 0003 | 王五 | 编译原理   | 97.00 |
| 0003 | 王五 | 操作系统   | 86.00 |
+------+------+------------+-------+
12 rows in set (0.00 sec)


mysql&amp;gt; select s.stu_no 学号,s.stu_name 姓名,c.curriculum_name 课程名称,g.stu_sco
re 分数 from grade g
    -&amp;gt; left join student_info s on g.stu_no=s.stu_no
    -&amp;gt; left join curriculum c on g.curriculum=c.curriculum_no
    -&amp;gt; where g.stu_score&amp;gt;80 and g.stu_score&amp;lt;90;
+------+------+----------+-------+
| 学号 | 姓名 | 课程名称 | 分数  |
+------+------+----------+-------+
| 0001 | 张三 | C语言    | 85.00 |
| 0003 | 王五 | 操作系统 | 86.00 |
+------+------+----------+-------+
2 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;查询学习了’C语言’课程的学生学号、姓名和分数&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select s.stu_no 学号,s.stu_name 姓名,c.curriculum_name 课程名称,g.stu_sco
re 分数 from grade g
    -&amp;gt; left join curriculum c on g.curriculum=c.curriculum_no
    -&amp;gt; left join student_info s on g.stu_no=s.stu_no
    -&amp;gt; where c.curriculum_name=&#39;c语言&#39;;
+------+------+----------+-------+
| 学号 | 姓名 | 课程名称 | 分数  |
+------+------+----------+-------+
| 0001 | 张三 | C语言    | 85.00 |
| 0002 | 李四 | C语言    | 60.00 |
| 0003 | 王五 | C语言    | 78.00 |
+------+------+----------+-------+
3 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;查询学习了’C语言’课程的学生学号、姓名和分数 并排序&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;mysql&amp;gt; select s.stu_no 学号,s.stu_name 姓名,c.curriculum_name 课程名称,g.stu_sco
re 分数 from grade g
    -&amp;gt; left join curriculum c on g.curriculum=c.curriculum_no
    -&amp;gt; left join student_info s on g.stu_no=s.stu_no
    -&amp;gt; where c.curriculum_name=&#39;c语言&#39;
    -&amp;gt; order by g.stu_score;
+------+------+----------+-------+
| 学号 | 姓名 | 课程名称 | 分数  |
+------+------+----------+-------+
| 0002 | 李四 | C语言    | 60.00 |
| 0003 | 王五 | C语言    | 78.00 |
| 0001 | 张三 | C语言    | 85.00 |
+------+------+----------+-------+
3 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第二题：
费时：3个小时（重写5遍）
&lt;a href=&#34;http://www.rupeng.com/forum/thread-44516-1-1.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://www.rupeng.com/forum/thread-44516-1-1.html&lt;/a&gt;
sql_properties：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysqlDriver=com.mysql.jdbc.Driver
connectDatabase=jdbc:mysql://localhost/study?seUnicode=true&amp;amp;characterEncoding=UTF8
userName=root
Password=root
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;JDBCUtils:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.jdbc.test;

/**
* @author    叶昭良
* @time      2015年2月19日下午10:41:37
*                        10:55     14min
* @version   com.jdbc.testrewrite4 V1.0
*/
import java.util.*;
import java.sql.*;
import java.io.*;
public class rewrite4
{
        private final static String mysqlDriver;
        private final static String connectDatabase;
        private final static String userName;
        private final static String Password;
        
        static
        {
                Properties prop = new Properties();
                InputStream in = rewrite4.class.getResourceAsStream(&amp;quot;sql.properties&amp;quot;);
                try
                {
                        prop.load(in);
                        mysqlDriver = prop.getProperty(&amp;quot;mysqlDriver&amp;quot;);
                        connectDatabase = prop.getProperty(&amp;quot;connectDatabase&amp;quot;);
                        userName = prop.getProperty(&amp;quot;userName&amp;quot;);
                        Password = prop.getProperty(&amp;quot;Password&amp;quot;);
                } catch (IOException e)
                {
                        // TODO Auto-generated catch block
                        throw new RuntimeException(&amp;quot;配置文件加载失败&amp;quot;);
                }
                try
                {
                        Class.forName(mysqlDriver);
                } catch (ClassNotFoundException e)
                {
                        // TODO Auto-generated catch block
                        throw new RuntimeException(&amp;quot;mysql驱动加载失败&amp;quot;);
                }
        }
        public static Connection createConnection()
        {
                Connection conn = null;
                try
                {
                        conn = DriverManager.getConnection(connectDatabase);
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        throw new RuntimeException(&amp;quot;未能正确创建连接&amp;quot;);
                }
                return conn;
                
        }
        public static int executeUpdate(String sql,Object... param) throws SQLException
        {
                Connection conn = rewrite4.createConnection();
                return rewrite4.executeUpdate(conn,sql, param);
        }
        public static int executeUpdate(Connection conn,String sql,Object... param) throws SQLException
        {
                PreparedStatement ps = null;
                int row = 1;
                try
                {
                        ps = conn.prepareStatement(sql);
                        for(Object par:param)
                        {
                                ps.setObject(row, par);
                                row++;
                        }                
                        return ps.executeUpdate();
                }finally
                {
                        rewrite4.closeQuietly(ps);
                }

        }
        
        public static ResultSet executeQuery(String sql,Object... param) throws SQLException
        {
                Connection conn = rewrite4.createConnection();
                return rewrite4.executeQuery(conn, sql, param);
        }
        public static ResultSet executeQuery(Connection conn,String sql,Object... param) throws SQLException
        {
                ResultSet  rs = null;
                PreparedStatement ps = null;
                
                ps = conn.prepareStatement(sql);
                int row =1;
                for(Object par:param)
                {
                        ps.setObject(row, par);
                        row++;
                }
                rs = ps.executeQuery();
                return rs;
                
        }
        public static void closeQuietly(Connection conn)
        {
                if(conn != null)
                {
                        try
                        {
                                conn.close();
                        } catch (SQLException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                }
        }
        public static void closeQuietly(Statement stmt)
        {
                if(stmt != null)
                {
                        try
                        {
                                stmt.close();
                        } catch (SQLException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                }
        }
        public static void closeQuietly(ResultSet rs)
        {
                if(rs != null)
                {
                        try
                        {
                                rs.close();
                        } catch (SQLException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                }
        }
        public static void closeAll(ResultSet rs)
        {
                if(rs != null)
                {
                        try
                        {
                                rs.close();
                        } catch (SQLException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                }
        }
        
        public static void rollback(Connection conn)
        {
                if(conn != null)
                {
                        try
                        {
                                conn.rollback();
                        } catch (SQLException e)
                        {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                        }
                }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第三题：
费时1个小时左右&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

/**
* @author    叶昭良
* @time      2015年2月18日下午3:49:22
*                        下午5:00左右
* @version   com.jdbc.testphoneCheck V1.0
*/
import java.io.*;
import java.sql.*;
import java.util.Scanner;


public class phoneCheck
{

        /**
         * @param args
         */
/**
* ID,MobileNumber,MobileArea,MobileType,AreaCode,PostCode,0
        连接成功
        总共添加了300105条数据.耗时：64712
*/
        private static void load()
        {
                //导入csv数据，利用BufferedInputStream
          InputStream is = null;
          InputStreamReader isr = null;
          BufferedReader bis = null; //一行一行读入数据
          
          Connection conn = null;
          PreparedStatement ps = null;
                int len = 0;
                int i = 0;
                long startms = System.currentTimeMillis();
                try
                {
                        is = new FileInputStream(&amp;quot;e://phone.csv&amp;quot;);
                    isr = new InputStreamReader(is);
                        bis = new BufferedReader(isr);
                        
                        System.out.println(bis.readLine());
                        //第一行字段舍去
                        String apple=  null;
                        String[] applePiles = null;
                        //第一次测试  字符串的行读入
/*                        System.out.println(bis.readLine());
                        System.out.println(bis.readLine());*/
                        /*apple =bis.readLine();
                        //字符串的一次失误！！ 导致插入失败！！＂＂是默认存在的　必须删掉
                        apple = apple.replaceAll(&amp;quot;\&amp;quot;&amp;quot;, &amp;quot;&amp;quot;);
                        //第二次测试 字符串分隔
                        String[] splitArray = apple.split(&amp;quot;,&amp;quot;);
                        for(String apple1 :splitArray)
                        {
                                System.out.println(apple1);
                        }*/
                        conn = JDBCUtils.createConnection();
                        conn.setAutoCommit(false);
                        
                        String sql = &amp;quot;insert into phone(MobileNumber,MobileArea,MobileType,Area&amp;quot;
                                        + &amp;quot;Code,PostCode) values(?,?,?,?,?);&amp;quot;;
                        ps = conn.prepareStatement(sql);
                        /**
                         * 370中国电信
                                371中国电信
                                之后 报错 ，可能是为空的原因 
                         */
                        while((apple=bis.readLine()) != null)
                        {
                                apple = apple.replaceAll(&amp;quot;\&amp;quot;&amp;quot;, &amp;quot;&amp;quot;);
                                applePiles = apple.split(&amp;quot;,&amp;quot;);
                                
                                ps.clearParameters();
                                //ps.setInt(1, Integer.parseInt(applePiles[1].equalsIgnoreCase(&amp;quot;&amp;quot;)?&amp;quot;1111&amp;quot;:applePiles[4]));
                                //ps.setInt(1, Integer.parseInt(applePiles[1]));
                                ps.setString(1, applePiles[1]);
                                ps.setString(2, applePiles[2]);
                                //System.out.println(i+applePiles[3]+applePiles[4]);
                                ps.setString(3, applePiles[3]);
//                                ps.setInt(4, Integer.parseInt(applePiles[4]));//.equalsIgnoreCase(&amp;quot;&amp;quot;)?&amp;quot;1111&amp;quot;:applePiles[4]));
//                                ps.setInt(5, Integer.parseInt(applePiles[5]));//.equalsIgnoreCase(&amp;quot;&amp;quot;)?&amp;quot;1111&amp;quot;:applePiles[4]));
                                ps.setString(4, applePiles[4]);
                                ps.setString(5, applePiles[5]);
                                ps.addBatch();

                                i++;
                                //每个2000步之后进行提交一次 到数据库
                                if(i%2000==0)
                                {
                                        ps.executeBatch();
                                }
                        }
                        //提交 最后的几百步
                        ps.executeBatch();
                        conn.commit();
                        long endMs = System.currentTimeMillis();
                        System.out.println(&amp;quot;总共添加了&amp;quot;+i+&amp;quot;条数据&amp;quot;+&amp;quot;.耗时：&amp;quot;+(endMs-startms));
                }catch(IOException e)
                {
                        throw new RuntimeException(&amp;quot;读取文件异常&amp;quot;);
                }catch(SQLException e)
                {
                        try
                        {
                                conn.rollback();
                        } catch (SQLException e1)
                        {
                                // TODO Auto-generated catch block
                                e1.printStackTrace();
                        } //又忘记了
                        throw new RuntimeException(&amp;quot;数据库插入异常！&amp;quot;);
                        
                }finally
                {
                        //用完之后记得差屁股
                        JDBCUtils.closeQuietly(ps);
                        JDBCUtils.closeQuietly(conn);
                }
        }
        
        public static void checkPhoneNumber(String PhoneNumber)
        {

                
                PhoneNumber = &amp;quot;%&amp;quot;+PhoneNumber+&amp;quot;%&amp;quot;;
                String sql = &amp;quot;select * from phone where MobileNumber like ?&amp;quot;;
                ResultSet rs  = null;
                try
                {
                        rs = JDBCUtils.executeQuery(sql, PhoneNumber);
                        if(!rs.next())
                        {
                                System.out.println(&amp;quot;当前版本没有&amp;quot;+PhoneNumber+&amp;quot;的信息&amp;quot;);
//                                return;
                        }
                        //rs.next();
                        System.out.println(PhoneNumber+&amp;quot;手机号来自&amp;quot;+rs.getString(&amp;quot;MobileArea&amp;quot;)+rs.getString(&amp;quot;MobileType&amp;quot;));
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        return;
                }finally
                {
                        //用完之后就差屁股
                        JDBCUtils.closeAll(rs);
                }
                
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                //导入一次即可
                //load();
                while(true)
                {
                        System.out.println(&amp;quot;请输入手机号(至少7位)&amp;quot;);
                        Scanner sc = new Scanner(System.in);
                        String PhoneNumber = sc.nextLine();
                        
                        if(PhoneNumber.equalsIgnoreCase(&amp;quot;exit&amp;quot;)||PhoneNumber.equalsIgnoreCase(&amp;quot;quit&amp;quot;))
                        {
                                return;
                        }
                        PhoneNumber = PhoneNumber.substring(0,7);
                        checkPhoneNumber(PhoneNumber);
                }
                
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;加上对话框的设计：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.jdbc.test;

import java.sql.ResultSet;
import java.sql.SQLException;



import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;



/**
* @author    叶昭良
* @time      2015年2月22日下午7:48:03
* @version   com.jdbc.testPhoneCheckUpdate V1.0
*/
import GTKEncapsulate.*;
public class PhoneCheckUpdate
{

        /**
         * @param args
         */
        private static  OOLabel olLabel;
        private static  OOEntry oeCerti;
        private static OOButton obClick;
        private static OOBox obBox;
        private static OOWindow owPig;
        public PhoneCheckUpdate()
        {
                olLabel = new  OOLabel(&amp;quot;请输入电话的前六位：&amp;quot;);
                oeCerti = new OOEntry();
                oeCerti.setTextMaxLength(6);
                oeCerti.setText(&amp;quot;151010&amp;quot;);
                
                obBox = new OOBox();
                obClick = new OOButton(&amp;quot;查询&amp;quot;);
                owPig = new OOWindow();
                owPig.setWidgetSize(200, 50);
                //show
                owPig.show();
                owPig.setExitAfterDestroy(true);
                olLabel.show();
                oeCerti.show();
                obBox.show();
                obClick.show();
                
                //contains
                owPig.add(obBox);        
                obBox.add(olLabel);
                obBox.add(oeCerti);
                obBox.add(obClick);
                
                //添加事件
                obClick.addClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                String text= oeCerti.getText();
                                OOMessageDialog omd = new OOMessageDialog(checkPhoneNumber(text));
                                omd.run();
                                omd.destroy();
                                
                        }
                });
        }
        private static String checkPhoneNumber(String PhoneNumber)
        {

                
                PhoneNumber = &amp;quot;%&amp;quot;+PhoneNumber+&amp;quot;%&amp;quot;;
                String sql = &amp;quot;select * from phone where MobileNumber like ?&amp;quot;;
                ResultSet rs  = null;
                try
                {
                        rs = JDBCUtils.executeQuery(sql, PhoneNumber);
                        if(!rs.next())
                        {
                                System.out.println(&amp;quot;当前版本没有&amp;quot;+PhoneNumber+&amp;quot;的信息&amp;quot;);
                                return &amp;quot;当前版本没有&amp;quot;+PhoneNumber+&amp;quot;的信息&amp;quot;;
                                
//                                return;
                        }
                        //rs.next();
                        System.out.println(PhoneNumber+&amp;quot;手机号来自&amp;quot;+rs.getString(&amp;quot;MobileArea&amp;quot;)+rs.getString(&amp;quot;MobileType&amp;quot;));
                        return PhoneNumber+&amp;quot;手机号来自&amp;quot;+rs.getString(&amp;quot;MobileArea&amp;quot;)+rs.getString(&amp;quot;MobileType&amp;quot;);
                        
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        return null;
                }finally
                {
                        JDBCUtils.closeAll(rs);
                }
                
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                PhoneCheckUpdate pcu = new PhoneCheckUpdate();
                
                GTK.gtk_main();
        }

}
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>2月4日Java班GTK</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-4ri-javaban-gtk/</link>
      <pubDate>Mon, 11 May 2015 14:58:41 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/2yue-4ri-javaban-gtk/</guid>
      <description>&lt;p&gt;第一部分：笔记&lt;/p&gt;
&lt;p&gt;1：封装两个不需要Id的类，OORGB,OOCairo
OORGB用于设置颜色值，并封装几个常见的颜色OORGB.RED OORGB.BLUE OORGB.GREEN..
OOCairo则是一个绘图类，主要包括移动点，画线，画圆，画矩形等。当然先前的GTK.Cairo类的方法中，都是包含环境句柄，所以OOCairo的封装需要考虑环境句柄，并在封装之后不需要再
调入环境句柄(已封装）&lt;/p&gt;
&lt;p&gt;2：封装GtkWidget为OOWidget
最为关键的一步是设置Id的工作。 每一个句柄都具有一个对象标识，而Gtk+默认是通过一个
整数来表示对象标识，于是需要把这个值设置为私有的Id(估计想到这个得费点时间。。）于是
就有了getId和setId。这一步的作用影响到下节的进一步封装，
javadoc的注释： /** + enter键，会自动导入方法的参量和返回值以及类的创建者等
javadoc的生成： 项目&amp;mdash;&amp;gt;生成javadoc&amp;mdash;&amp;gt;填入javadoc路径
jd2chm+httphelper 转化为chm文档&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;利用上述方法，让所有的控件都继承自OOWidget(现在想想有点不合理），封装了21个类
包括：OOBox, OOButton,OOCairo,OOCalendar,OODialog,OOEntry,OOFileChooser,OOGrid
OOLabel,OOMenu,OOProgressBar, OORGB,OOScrollBar,OOSpinBox,OOStatusIcon,
OOSwitch,OOTextIter,OOTextView,OOToolBar,OOTreeView,OOWidget
并进行了一个简单测试 TestOOCairo.java&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;上面的内容构成了源码v1.0版&lt;/p&gt;
&lt;p&gt;进一步发现源码V1.0存在很多问题，没有照顾到继承关系图。&lt;/p&gt;
&lt;p&gt;后来继续学习了杨老师的视频，发现源码v1.0并未体现GTK+继承关系
如图GTK继承结构关系图.png
由此可见，并不是所有的控件是直接继承OOWidget的，并考虑到以下bug情况
bug1:
Protected是指兄弟和儿子可以访问！！ 也就是不同包的不可以访问。
为什么setId()最好改为protected呢？
因为我们经常是让一个包打成tar，然后别人引用这个jar包！ 也就是和这个jar包不一样
也就是他无法执行这样的操作
也就是 比如OOEntry oe = new OOEntry();
Oe.setId(GTK.gtk_label_new())的换心操作。 不要让entry变成了label而你却是不知道。&lt;/p&gt;
&lt;p&gt;bug2：
把OOWidget 标记为抽象类！ 这样防止用户&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;直接OOWidget ow = new OOWidget() ; ow.show()&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;                                  这完全是无意义的工作
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这就是抽象的好处！！ 让子类去做，父类不要去实例化了&lt;/p&gt;
&lt;p&gt;bug3:&lt;/p&gt;
&lt;p&gt;见图Container是只大老虎.png ,发现先前写的大部分控件的封装都是container的子类，于是新建了OOContainer类，并重新改写了OOBox，OOGrid,OOTextView,OOToolBar,OOTreeView ,（修改的只是把extends 改为了OOContainer，这个工作量不大，发现有效  其他构造函数不需要改，修改完毕）
并发现我并未封装combobox,和radiobutton之类的，checkbox
并最终还使得button在原先的两个构造函数的基础上增加了图片资源的加载，和加载图片的位置控制
增加了8个工作量。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/uunubt/article/details/6089402&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://blog.csdn.net/uunubt/article/details/6089402&lt;/a&gt;
参考此文，琢磨出来RadioButton的用法：
int cbMan = GTK.gtk_radio_button_new_with_label(0, &amp;ldquo;男&amp;rdquo;);
int cbWoman = GTK.gtk_radio_button_new_with_label_from_widget(cbMan, &amp;ldquo;女&amp;rdquo;);&lt;/p&gt;
&lt;p&gt;OK经过了努力终于完成此项工作的封装
（修改的只是把extends 改为了OOContainer，这个工作量不大，发现有效  其他构造函数不需要改，修改完毕）&lt;/p&gt;
&lt;p&gt;后来发现这种该法其实有不恰当的地方，应该是可以省略掉构造函数。但是这是仅仅如果构造函数和OOContainer是一样的情况（还是涉及到构造函数可以重写的问题）&lt;/p&gt;
&lt;p&gt;bug4:&lt;/p&gt;
&lt;p&gt;后来发现bug3并不完善，观察继承图发现很多的控件都是来自Gtkbin，见GtkBin是只小老虎.png.
由于GtkBin是单控件容器，于是采用杨老师针对OOContainer的 add方法的Override重写（GtkBin也是OOContainer的一部分）
Override方法：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
        public void add(OOWidget ow)
        {
                int[] children = GTK.gtk_container_get_children(this.getId());
                if(children.length &amp;lt;= 0 )
                {
                        //调用父类的add方法
                        super.add(ow);
                        //super.add  调用父类
                        //this.add   调用本类
                        //super() 调用父类构造方法(在构造函数中)
                        //this()  调用本类的构造方法(在构造函数中，记得我为什写上括号)
                }else
                {
                        throw new IllegalArgumentException(&amp;quot;容器中已经有了一个对象&amp;quot;);
                }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;bug5:
并进一步修改了GTKButton, GTKImageButton   GGTKComboBox   GTKToolItem  GTKWindow
学习了封装原则： 能省则省，尽量调用父类实现的代码，减少代码量，减少出错的语句
最终把代码封装到了31个，见图2.0的所有类文件。&lt;/p&gt;
&lt;p&gt;下面是我代码的提交记录：
1：重新封装了程序 根据GTK的继承关系  所有的控件都来自GTKwidget  GTKBin是指只能添加一个空间的类
GTKContainer是包含着GTKBin  GTKGrid GTKBox，GTKToolBar,OOTreeView,OOTextView
2. 封装了GTKImage
3. 封装了GTKCheckButton和radioButton，并琢磨了GTKRadioButton的用法
4. 添加了GTKBin和GTKWindow的封装，至此基本上所有的东西，都已经面向对象化了
5. 测试了OOPassword之类的用法，使得OOPassword继承自OOEntry
6. 添加了OOFileChooser的封装
7  修改OOButton 使其继承自OOBin,也就是只能添加单一空间
8. 使得OOWidget变得抽象画，这样就不会出现 定义一个OOWidget对象的额情况，使得程序更具可靠性
9. 使得OOWidget的setId变成protected，这样只有子类和兄弟类（同包）可以使用，不同包的不可以使用。
10：增加了OOCombo(从OOBin继承得到)类充当 OOCombobox的父类
11: 把ComboBoxText的 addLister 添加到OOCombo类中！！
12: 增加了OOToggleButton类
13：修改了CheckBox使其充当OOToggleButtonde
14： 修改了OOScrollBar的继承项 从OOWidget到OOContainer&lt;/p&gt;
&lt;p&gt;上面的内容构成了GTKEncapsulateV2.0源码&lt;/p&gt;
&lt;p&gt;第二部分 作业&lt;/p&gt;
&lt;p&gt;源码V1.0版本.rar
源码V2.0版本.rar
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/gtk%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E5%9B%BE.png&#34; alt=&#34;gtk继承关系图&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/Container%E6%98%AF%E5%8F%AA%E5%A4%A7%E8%80%81%E8%99%8E&#34; alt=&#34;&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/Gtkbin%E6%98%AF%E5%8F%AA%E5%B0%8F%E8%80%81%E8%99%8E.png&#34; alt=&#34;Gtkbin是只小老虎&#34;&gt;
&lt;img src=&#34;V2.0%E7%BB%A7%E6%89%BF%E5%9B%BE.png&#34; alt=&#34;v2.0的所有类文件&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Bug再修复1  menu的clicked事件改为activate(menu  item响应 activate事件），这个activate让我花费了至少两个小时，因为把所有的OOMenu的过程                  重新在书写了一遍，并拆成孤立的四个片段分别是： OOMenuBar.java（将包装添入包装条，菜单条）    OOSubMenu.java（把菜单包装）    OOSingleMenu.java （绘制菜单） OOMenuVegetable.java （绘制一盘菜）。具体的也在源代码第三个版本。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Bug修复2    文件过滤器的 抽象方法的返回值从void变为 String[]，这样可以返回字符串（比如打开文件夹的文件名）
//public abstract void processResponse();
public abstract String[] processResponse();&lt;/p&gt;
&lt;p&gt;Bug修复3    FileChooser的run方法 从void 变到int,  这样可以接受返回值，判断对应的执行行为
Bug修复4    修改了OOTextView 使其从&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void addScrollBar(int width, int height)
        {
                OOScrollBar osb = new OOScrollBar();
                osb.setWidgetSize(width, height);
                osb.addView(this.getId());
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;变到&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void addScrollBar(OOGrid og,int start,int width, int height)
        {
                OOScrollBar osb = new OOScrollBar();
                osb.setWidgetSize(width, height);
                osb.addView(this.getId());
                osb.show();
                og.add(osb.getId(), start);
                
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;让textview自动可以添加滚动条。&lt;/p&gt;
&lt;p&gt;bug5修复
使OOToolBar里面的addTool方法从void方法改变到返回值为ToolButton&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void addTool(String toolName,String toolPic,int position)
        {
                tbApple[i] = new ToolButton(toolName);
                tbApple[i].show();
                tbApple[i].setStock(toolPic);
                GTK.gtk_toolbar_insert(this.getId(), tbApple[i].getId(), position);
                i++;
                
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;到&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public ToolButton addTool(String toolName,String toolPic,int position)
        {
                tbApple[i] = new ToolButton(toolName);
                tbApple[i].show();
                tbApple[i].setStock(toolPic);
                GTK.gtk_toolbar_insert(this.getId(), tbApple[i].getId(), position);
                i++;
                return tbApple[i-1];
                
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样就可以添加事件监听。&lt;/p&gt;
&lt;p&gt;bug6修复    OOWindow的ExitAfterDestroy 的返回值的设置
//也就是当收到 destroy信号的时候 不一定是关闭的（一般我们写的时候是关闭的）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;        public void setExitAfterDestroy(boolean value)
        {
                this.exitAfterDestroy  = true;
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;到&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void setExitAfterDestroy(boolean value)
        {
                this.exitAfterDestroy  = value;
        }
``



针对OOMenu针对两种封装方法进行了测试：
1：封装方法1(体现在TestMenuFileChooserToolbar.java)
     所有的方法 都浓缩到OOMenu中 ，包括第一步创建 menubar    第二步创建submenu     第三步创建 menu   第四步创建menuitem
2：封装方法2(体现在TestNewMenuFourStep)
     把原先的OOMenu 分为四个类   第一步 OOMenuBar类      第二步 OOSubMenu类     第三步   OOSingleMenu类    第四步  OOMenuVegetable类

从上面看到也许第二种方法更加体现着面向对象的方法，这也是被逼的，一直测试为什么menuitem的clicked方法不通过，原来是因为menuitem响应的是activate信号。

同时也可以看到面向对象方法的清晰性
封装方法1 的源代码 TestMenuFileChooseAndToolBar.java:

```java
package GTKEncapsulate;



import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* 
* @author    叶昭良
* @time      2015年2月6日下午8:13:45
* @version   GTKEncapsulateTestMenuFileChooserAndToolbar V1.0
*                                                         并进一步采用封装的OOWindow编写程序，由于继承了OOBin，所以具有add 一个控件的功能
*                                                         由于OOWindow在构造函数中添加了destroy的事件监听，所以不需要再重写，但是现在的
*                                                         OOWindow的对象还是可以添加destroy监听，要是可以不能再添加destroy就好了！！！
*                                 
*                                                         另外发现了一个不对的地方，所有的控件现在都是可以弹出消息对话框，question对话框。
* 
* 这个测试出现在事件监听！还有bug，等到以后再次修改，估计是继承关系出现了问题
*解决了这个问题，原来是因为menu的监听是通过activate而不是click
*涉及到的文件      OOMenu.java （这是主要的类包含另外一种方法的OOMenuBar OOSubMenu OOSingleMenu)
*              OOMenuVegetable.java （这是原先从OOMenu剥离出来的一个文件）
*/
public class TestMenuFileChooserAndToolbar
{
/*        public IGCallBack IGCQuit = new IGCallBack()
        {
                
                @Override
                public void execute(int instance, int eventData, Object object)
                {
                        // TODO Auto-generated method stub
                        GTK.gtk_main_quit();
                }
        };*/
        static OOTextView ootv =  null;
        public static void main(String[] args)
        {
                //初始化还是需要的
                GTK.gtk_init();
                //创建一个OOWindow对象，其中已经包含了  
                OOWindow window = new OOWindow();
                window.setTitle(&amp;quot;测试面向对象&amp;quot;);
                window.setExitAfterDestroy(true);
                window.show();
                
                
                //创建布局对象
                OOGrid grid = new OOGrid();
                grid.show();
                //添加到window对象
                window.add(grid);
                
                
                
                //创建一个textview 界面
                ootv = new OOTextView();
                ootv.setType();
                ootv.show();
                ootv.addScrollBar(grid, 2, 500, 300);
                //创建menubar对象
                OOMenu omMenu = new OOMenu();
                omMenu.show();
                
                //创建垂直menubar（最终需要文件的下拉菜单 添加到menubar(水平的menubar)
                omMenu.createVerticalMenu(&amp;quot;File&amp;quot;);
                //创建单一的一盘菜
                omMenu.createMenu();
                
                //往菜盘中添菜,改变了return选项 使得可以返回Vegetable对象，从而进行事件监听
                //由于已经在内部show了 所以不需要show
                OOMenuVegetable vgNew = new OOMenuVegetable(&amp;quot;新建&amp;quot;);
                OOMenuVegetable vgOpen = new OOMenuVegetable(&amp;quot;打开&amp;quot;);
                OOMenuVegetable vgSave = new OOMenuVegetable(&amp;quot;保存&amp;quot;);
                OOMenuVegetable vgQuit = new OOMenuVegetable(&amp;quot;退出&amp;quot;);
                vgOpen.addActivateListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                youOpenfile(ootv);
                                
                        }
                });
                vgSave.addActivateListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                youSavefile();
                                
                        }
                });
                vgQuit.addActivateListener( new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                GTK.gtk_main_quit();
                        }
                });
                omMenu.addMenuVegetable(vgNew);
                omMenu.addMenuVegetable(vgOpen);
                omMenu.addMenuVegetable(vgSave);
                omMenu.addMenuVegetable(vgQuit);
                
                //已经show了，唯一需要的是添加进网格
                omMenu.addVerticalMenuTOBar();
                
                grid.add(omMenu.getId(), 0);
                
                //上面的部分都是关于menu的现在做一个关于
                OOToolBar otbApple = new OOToolBar();
                //必须设置上 否则太小了
                otbApple.setWidgetSize(300, 20);
                OOToolBar.ToolButton tbApple = otbApple.addTool(&amp;quot;新建&amp;quot;, GTK.GTK_STOCK_NEW, 0);
                OOToolBar.ToolButton tbBanana =otbApple.addTool(&amp;quot;打开&amp;quot;, GTK.GTK_STOCK_OPEN, 1);
                OOToolBar.ToolButton tbOrange =otbApple.addTool(&amp;quot;保存&amp;quot;, GTK.GTK_STOCK_SAVE, 2);
                tbBanana.addClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                youOpenfile(ootv);
                        }
                });
                tbOrange.addClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                youSavefile();
                        }
                });
                otbApple.show();
                grid.add(otbApple.getId(),1);
                
        
                
                GTK.gtk_main();
                
        }
        
        public static void youOpenfile(OOTextView ootv)
        {
                OpenFile ofApple = new OpenFile();
                ofApple.setMultipleSelect();
                ofApple.createFilter();
                ofApple.nameFilter(&amp;quot;文本文件&amp;quot;);
                ofApple.editFilter(&amp;quot;*.txt&amp;quot;);
                ofApple.editFilter(&amp;quot;*.java&amp;quot;);
                //把filter的操作放入打开对话框中
                ofApple.finishFilter();
                String[] filenames = ofApple.processResponse();
                showAllFiles(filenames,  ootv);
        }
        public static void youSavefile()
        {
                SaveFile ofBanana = new SaveFile(&amp;quot;保存文件&amp;quot;,GTK.GTK_FILE_CHOOSER_ACTION_SAVE,&amp;quot;保存&amp;quot;);
                //把filter的操作放入打开对话框中
                
                ofBanana.processResponse();
        }
        
        public static void showAllFiles(String[] filenames,OOTextView otv)
        {
                for(int i = 0 ; i &amp;lt; filenames.length; i++)
                {
                        showOneFile(filenames[i],otv);
                }
        }
        
        public static void showOneFile(String filename, OOTextView otv)
        {
                try
                (
                        InputStream is = new FileInputStream(filename);
                        InputStreamReader osr = new InputStreamReader(is);
                        BufferedReader br = new BufferedReader(osr);
                )
                {
                        
                        String  temp= filename.substring(filename.lastIndexOf(&#39;\\&#39;)+1);
                        System.out.println(temp);
                        otv.insertTextAtEnd(&amp;quot;******************\n当期文件为&amp;quot;+filename+&amp;quot;\n******************\n\n&amp;quot;+temp+&amp;quot; 文件内容如下：\n+---------------------------------------------------------------------------+\n&amp;quot;);
                        String content = null;
                        while((content = br.readLine())!=null) // -1读取完毕
                        {
                                //InsertStringToTextViewFunction(textview,fileToFile.toString());
                                otv.insertTextAtEnd(new String(content));
                                
                        }
                        otv.insertTextAtEnd(&amp;quot;\n+---------------------------------------------------------------------------+\n******************\n文件&amp;quot;+filename+&amp;quot;读取结束\n******************\n&amp;quot;);
                }
                catch(IOException e)
                {
                        System.out.println(&amp;quot;文件读入异常&amp;quot;);
                }
                
        }
}


class OpenFile extends OOFileChooser
{

        @Override
        public  String[] processResponse()
        {
                String[] filenames = null;
                // TODO Auto-generated method stub
                int ret = this.run();
                if(ret == GTK.GTK_RESPONSE_OK) 
                {
                        filenames = GTK.gtk_file_chooser_get_filenames(this.getId());
                        for(int i = 0 ; i&amp;lt; filenames.length ; i++)
                        {
                                
                                System.out.println(&amp;quot;选中文件名&amp;quot;+i+&amp;quot;: &amp;quot;+filenames[i]);
                        }
                        GTK.gtk_widget_destroy(this.getId()); //必须需要！！否则报错
                }else
                {
                        GTK.gtk_widget_destroy(this.getId());
                }
                return filenames;
        }                
}

class SaveFile extends OOFileChooser
{
        public SaveFile(String title, int action, String buttonText)
        {
                setId(GTK.gtk_file_chooser_dialog_new(title, 0, action, buttonText));
        }
        @Override
        public String[] processResponse()
        {
                String[] filenames = null;
                GTK.gtk_file_chooser_set_do_overwrite_confirmation(this.getId(), true);
                // TODO Auto-generated method stub
                System.out.println(&amp;quot;已进入save&amp;quot;);
                //SaveOneFile(filename,textview);
                int ret = GTK.gtk_dialog_run(this.getId());
                if(ret == GTK.GTK_RESPONSE_CANCEL)
                {
                        GTK.gtk_widget_destroy(this.getId());
                }else 
                {
                        String filename = GTK.gtk_file_chooser_get_filename(this.getId());
                        filenames[0] = filename;
                        System.out.println(filename);
                        GTK.gtk_widget_destroy(this.getId());
                        return  filenames;
                }
                return filenames;
                
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;封装方法2 的源代码TestNewMenuFourStep.java:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package GTKEncapsulate;

import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author    叶昭良
* @time      2015年2月6日下午10:09:33
* @version   GTKEncapsulateTestNewMenuFourStep V1.0
* 
* 涉及到四个类       OOMenuBar.java
*               OOSubMenu.java
*               OOSingleMenu.java
*               OOMenuVetetable.menu   依次创建四个类即可
*/
public class TestNewMenuFourStep
{

        /**
         * @param args
         */
        static OOTextView ootv =  null;
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                //初始化还是需要的
                                GTK.gtk_init();
                                //创建一个OOWindow对象，其中已经包含了  
                                OOWindow window = new OOWindow();
                                window.setTitle(&amp;quot;测试面向对象&amp;quot;);
                                window.setExitAfterDestroy(true);
                                window.show();
                                
                                
                                //创建布局对象
                                OOGrid grid = new OOGrid();
                                grid.show();
                                //添加到window对象
                                window.add(grid);
                                
                                //创建一个textview 界面
                                ootv = new OOTextView();
                                ootv.setType();
                                ootv.show();
                                ootv.addScrollBar(grid, 2, 500, 300);
                                //创建一个大的menubar
                                OOMenuBar ombApple = new OOMenuBar();
                                //创建第二大的（可以有很多个）
                                OOSubMenu osmApple = new OOSubMenu(&amp;quot;File&amp;quot;);
                                
                                //创建第三大的（可以有很多个）
                                OOSingleMenu menuApple = new OOSingleMenu();
                                
                                //往菜盘中添菜,改变了return选项 使得可以返回Vegetable对象，从而进行事件监听
                                //由于已经在内部show了 所以不需要show
                                //创建第四大的（可以有很多个）
                                OOMenuVegetable vgNew = new OOMenuVegetable(&amp;quot;新建&amp;quot;);
                                OOMenuVegetable vgOpen = new OOMenuVegetable(&amp;quot;打开&amp;quot;);
                                OOMenuVegetable vgSave = new OOMenuVegetable(&amp;quot;保存&amp;quot;);
                                OOMenuVegetable vgQuit = new OOMenuVegetable(&amp;quot;退出&amp;quot;);
                                vgOpen.addActivateListener(new IGCallBack()
                                {
                                        
                                        @Override
                                        public void execute(int instance, int eventData, Object object)
                                        {
                                                youOpenfile(ootv);
                                                
                                        }
                                });
                                vgSave.addActivateListener(new IGCallBack()
                                {
                                        
                                        @Override
                                        public void execute(int instance, int eventData, Object object)
                                        {
                                                youSavefile();
                                                
                                        }
                                });
                                vgQuit.addActivateListener(new IGCallBack()
                                {
                                        
                                        @Override
                                        public void execute(int instance, int eventData, Object object)
                                        {
                                                // TODO Auto-generated method stub
                                                GTK.gtk_main_quit();
                                        }
                                });
                                //添加第四大到第三大
                                menuApple.addVegetable(vgNew);
                                menuApple.addVegetable(vgOpen);
                                menuApple.addVegetable(vgSave);
                                menuApple.addVegetable(vgQuit);
                                
                                //添加第三大到第二大  采用的是填充
                                osmApple.fillSubMenu(menuApple);
                                //添加第二大到第一大
                                ombApple.addSubMenuToBar(osmApple);
                                ombApple.show();
                                
                                grid.add(ombApple.getId(), 0);
                                
                                
                                //上面的部分都是关于menu的现在做一个关于
                                OOToolBar otbApple = new OOToolBar();
                                //必须设置上 否则太小了
                                otbApple.setWidgetSize(300, 20);
                                OOToolBar.ToolButton tbApple = otbApple.addTool(&amp;quot;新建&amp;quot;, GTK.GTK_STOCK_NEW, 0);
                                OOToolBar.ToolButton tbBanana =otbApple.addTool(&amp;quot;打开&amp;quot;, GTK.GTK_STOCK_OPEN, 1);
                                OOToolBar.ToolButton tbOrange =otbApple.addTool(&amp;quot;保存&amp;quot;, GTK.GTK_STOCK_SAVE, 2);
                                tbBanana.addClickedListener(new IGCallBack()
                                {
                                        
                                        @Override
                                        public void execute(int instance, int eventData, Object object)
                                        {
                                                // TODO Auto-generated method stub
                                                youOpenfile(ootv);
                                        }
                                });
                                tbOrange.addClickedListener(new IGCallBack()
                                {
                                        
                                        @Override
                                        public void execute(int instance, int eventData, Object object)
                                        {
                                                youSavefile();
                                        }
                                });
                                otbApple.show();
                                grid.add(otbApple.getId(),1);
                                //启动循环
                                GTK.gtk_main();
        }
        
        public static void youOpenfile(OOTextView ootv)
        {
                OpenFileNew ofApple = new OpenFileNew();
                ofApple.setMultipleSelect();
                ofApple.createFilter();
                ofApple.nameFilter(&amp;quot;文本文件&amp;quot;);
                ofApple.editFilter(&amp;quot;*.txt&amp;quot;);
                ofApple.editFilter(&amp;quot;*.java&amp;quot;);
                //把filter的操作放入打开对话框中
                ofApple.finishFilter();
                String[] filenames = ofApple.processResponse();
                showAllFiles(filenames,  ootv);
        }
        public static void youSavefile()
        {
                SaveFileNew ofBanana = new SaveFileNew(&amp;quot;保存文件&amp;quot;,GTK.GTK_FILE_CHOOSER_ACTION_SAVE,&amp;quot;保存&amp;quot;);
                //把filter的操作放入打开对话框中
                
                ofBanana.processResponse();
        }
        
        public static void showAllFiles(String[] filenames,OOTextView otv)
        {
                for(int i = 0 ; i &amp;lt; filenames.length; i++)
                {
                        showOneFile(filenames[i],otv);
                }
        }
        
        public static void showOneFile(String filename, OOTextView otv)
        {
                try
                (
                        InputStream is = new FileInputStream(filename);
                        InputStreamReader osr = new InputStreamReader(is);
                        BufferedReader br = new BufferedReader(osr);
                )
                {
                        
                        String  temp= filename.substring(filename.lastIndexOf(&#39;\\&#39;)+1);
                        System.out.println(temp);
                        otv.insertTextAtEnd(&amp;quot;******************\n当期文件为&amp;quot;+filename+&amp;quot;\n******************\n\n&amp;quot;+temp+&amp;quot; 文件内容如下：\n+---------------------------------------------------------------------------+\n&amp;quot;);
                        String content = null;
                        while((content = br.readLine())!=null) // -1读取完毕
                        {
                                //InsertStringToTextViewFunction(textview,fileToFile.toString());
                                otv.insertTextAtEnd(new String(content));
                                
                        }
                        otv.insertTextAtEnd(&amp;quot;\n+---------------------------------------------------------------------------+\n******************\n文件&amp;quot;+filename+&amp;quot;读取结束\n******************\n&amp;quot;);
                }
                catch(IOException e)
                {
                        System.out.println(&amp;quot;文件读入异常&amp;quot;);
                }
                
        }

}
//取和OpenFile不一样的类名防止重复
class OpenFileNew extends OOFileChooser
{

        @Override
        public  String[] processResponse()
        {
                String[] filenames = null;
                // TODO Auto-generated method stub
                int ret = this.run();
                if(ret == GTK.GTK_RESPONSE_OK) 
                {
                        filenames = GTK.gtk_file_chooser_get_filenames(this.getId());
                        for(int i = 0 ; i&amp;lt; filenames.length ; i++)
                        {
                                
                                System.out.println(&amp;quot;选中文件名&amp;quot;+i+&amp;quot;: &amp;quot;+filenames[i]);
                        }
                        GTK.gtk_widget_destroy(this.getId()); //必须需要！！否则报错
                }else
                {
                        GTK.gtk_widget_destroy(this.getId());
                }
                return filenames;
        }                
}

class SaveFileNew extends OOFileChooser
{
        public SaveFileNew(String title, int action, String buttonText)
        {
                setId(GTK.gtk_file_chooser_dialog_new(title, 0, action, buttonText));
        }
        @Override
        public String[] processResponse()
        {
                String[] filenames = null;
                GTK.gtk_file_chooser_set_do_overwrite_confirmation(this.getId(), true);
                // TODO Auto-generated method stub
                System.out.println(&amp;quot;已进入save&amp;quot;);
                //SaveOneFile(filename,textview);
                int ret = GTK.gtk_dialog_run(this.getId());
                if(ret == GTK.GTK_RESPONSE_CANCEL)
                {
                        GTK.gtk_widget_destroy(this.getId());
                }else 
                {
                        String filename = GTK.gtk_file_chooser_get_filename(this.getId());
                        filenames[0] = filename;
                        System.out.println(filename);
                        GTK.gtk_widget_destroy(this.getId());
                        return  filenames;
                }
                return filenames;
                
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;基本上两种封装方法的思路一样，就书写来说，第二种方法，更加的清晰些。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行界面一样：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/filechooser1.png&#34; alt=&#34;软件的运行界面&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/filechooser2.png&#34; alt=&#34;利用工具栏打开一个文件&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/filechooser3.png&#34; alt=&#34;利用菜单栏保存一个文档&#34;&gt;&lt;/p&gt;
&lt;p&gt;2月7号的笔记：
再次介绍主要的控件的封装过程
OOWindow的封装思路
这个控件是OOBin的子类，也就是该控件只能容纳一个控件，为此在封装之前必须封装OOBin。
OOWindow类的封装主要包含 1：构造函数创建window并添加关闭的监听  2：设置window文本  3：设置window全屏 4：设置winow可以调整大小 5：设置window居中&lt;/p&gt;
&lt;p&gt;有一点不明白的是：为毛非得有这个setExitAfterDestroy(boolean value)判断在window的关闭程序的事件监听，直接关掉不是大吉？！&lt;/p&gt;
&lt;p&gt;OOFileChooser为什么把它封装成抽象类？
OOFileChooser的处理GTK.gtk_dialog_run的返回值的函数被我封装成一个抽象函数，如下&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
         *   一个抽象方法 ，要求继承者去实现它
         */
        public abstract String[] processResponse();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样只要子类继承了OOFileChooser就让他去实现对应的processResponse方法，因为也许每次你打开文件的时候需要的处理都是有所不一样的并且为了能够让打开的时候保存多个文件名字，在保存的时候又不需要保存多个文件 ，新建了一个抽象类的方法针对savafile
public abstract void processResponse1();  //用于保存
public abstract String[] processResponse(); //用于打开&lt;/p&gt;
&lt;p&gt;OOBin的封装思路
之前在介绍OOWindow中提及了OOBin的单容器功能，而OOBin是继承自OOContainer的，比如OOGrid,OOBox的都是继承自OOContainer的，但是他们都是可以容纳多个控件，为此必须重写OOBin的add方法。主要的作用是利用gtk_container_get_children判断是否当前的OOBin对象是否有多个控件，如果有了一个则 不能再添加，如果没有则可以添加&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
        public void add(OOWidget ow)
        {
                int[] children = GTK.gtk_container_get_children(this.getId());
                if(children.length &amp;lt;= 0 )
                {
                        //调用父类的add方法
                        super.add(ow);
                        //super.add  调用父类
                        //this.add   调用本类
                        //super() 调用父类构造方法(在构造函数中)
                        //this()  调用本类的构造方法(在构造函数中，记得我为什写上括号)
                }else
                {
                        throw new IllegalArgumentException(&amp;quot;容器中已经有了一个对象&amp;quot;);
                }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;OOWidget的封装思路
OOWidget是祖宗级的任务，必须是大大滴。试想所有的控件都是可以显示、隐藏、摧毁，于是可以把这些函数的封装都容纳在OOWidget中，这是一个比较实际而又有效的封装。 然而是否所有的控件都有click事件的监听？ 这点我表示质疑，比如GtkMenuItem控件就没有，他只是响应activate事件，所以把click的事件监听放在OOWidget里面还是有点问题的。
另外地，把所有的基于OODialog(OODialog基于OOWindow)的消息对话框showInfo,问题对话框showYesNo,确认对话框showOkCancle放在OOWidget,从当前考虑也是可以的，但是封装的函数内部的实现还是面向过程，可不可以把MessageInfo类也可以提取出来，当然可以。
当然首先得把OODialog修改为继承自OOWindow！ 因为OODialog也是单容器控件。然后再把OOCalendar，OOFileChooser也修改为继承自OODialog
并新建OOInputDialog（暂时未能实现，com.rupeng.gtk4j没有）,OOMessageDialog  因为这些Dialog都有一个共同的特点需要GTK.gtk_dialog_run，可以把这个方法封装在OODialog中&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
         *    在一切设置完毕后  必须要让他run起来，类似于线程的做法,并且一定要摧毁它 this.destroy..
         */
        public  int run()
        {
                int response =  GTK.gtk_dialog_run(this.getId());
                return response;
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样所有的OOdialog子类都可以run起来，并且都是单容器控件了。也算是一个bug修复。&lt;/p&gt;
&lt;p&gt;OOBox容器的修改：
public OOBox(int orientation)的封装改为 this（orientation,0)的实现，这样如果以后需要修改GTK.gtk_box_new..只需要修改一个地方即可，不至于留下bug,此方法可以思考&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public OOBox(int orientation,int spacing)
        {
                setId(GTK.gtk_box_new(orientation, spacing));
        }
        /**
         * 
         * @param orientation   方向的说明
         */
        public OOBox(int orientation)
        {
                this(orientation,0);  //调用本类的构造函数
                //setId(GTK.gtk_box_new(orientation,0));
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;至此  源码v4.0已经增加到37个类，并进行了4个简单的测试。&lt;/p&gt;
&lt;p&gt;2月8号笔记：
接口
接口其实就是一个头文件，提供方法的声明或者变量的声(）&lt;/p&gt;
&lt;p&gt;接口文件仅仅是一个能力的声明，我能够做什么，具体实现还得自己去做。&lt;/p&gt;
&lt;p&gt;一句话总结：接口定义做什么，实现接口能力的类定义怎么做
使用：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;1：drawingCallback
public interface OODrawCallback
{
        public void drawCairo(OOCairo cairo);
//        public void speak();
}


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用接口：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//使用
public void addDrawListener(final OODrawCallback ocbApple) //声明了我要调用一个接口，里头可以假设已经
  //实现了OODrawCallback的接口，并进行调用。 等到OODrawingArea这个对象生成，并添加了

  //draw监听器，传入接口对象时候，则需要具体去实现借口对象的方法（并且是所有方法）
        {
                GTK.g_signal_connect(this.getId(), &amp;quot;draw&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                
//通过现象来解释的话，在一个类中方法，调用了接口的未实现的类，那么当你
//定义这个包含接口类方法的对象时候，需要实现这个接口的未实现类，因为
//类似于Throws的方法，我就让你调用这个类的对象去实现它，你们谁调用
//谁就给我去维护，我就提供一本秘籍，你自己去修炼！！！！当前的话eventData
                         
//小结：  在&amp;quot;draw&amp;quot;信号发出 执行了一个IGCallBack的接口，通过内部类实现，
//          在execute实现IGCallback接口的execute方法，主要是定义了一个Cairo对象
//          传进去了绘画环境，然后通过新建了一个OODrawCallback提供一个内容的接口
//          并调用了drawCairo，而由于drawCairo是未定义的方法，且是一个接口的未实现
//          方法，所以允许放在一个定义类中空着，
// 但是必须在存在未实现方法的类接口的对象去实现它（注意是对象中）
// 
// 猜想： 一个class的定义，不带有implemetns,那么其内部有一个变量  CanWithouImplement = true;
//       如果一个calss定义，带有implements,那么其内的  CanWithouImplement = false、
//      通过这个猜想来解释为什么我们下面在未实现drawCairo方法还是可以调用了drawCairo
// 但是有一句话是正确的，这边肯定是声明了具有drawCairo的能力。（具体什么能力不知道）
// 猜想： implements ocbApple是必须实现ocbApple的所有方法，而ocbApple.drawCairo仅仅需要实现一个方法。
//     错误：因为在一开头就定义了final  OODrawCallback ocbApple,形参定义了接口声明，调用的时候需要传入
//           接口对象（一般可以通过内部类实现)
//     测试方法： 通过在OODrawCallback增加一个未实现方法，发现还是需要实现两种未实现方法
//再次小结： 这边仅仅是一个形式上的定义！接口在形参变量中出现，则在调用具有该形参变量表的函数时候，必须
//         去实现他们，当然在该方法的定义中可以直接使用该方法。相当于是在该形式方法中事先隐式调用了
复制代码
接口调用的实现：
//创建绘图
                 //1 面向对象的方法
                OODrawingArea odaApple = new OODrawingArea();
                odaApple.show();
                //必须setSize否则看不到  这点一定要注意了
                odaApple.setWidgetSize(300, 300);
                gridApple.add(odaApple, 0);
                // 第一种情况重画： 画面被挡住了，揭开画面时候
                // 第二种情况重画： 打开画面饿时候
                odaApple.addDrawListener(new OODrawCallback()
                {
                        
                        @Override
                        public void drawCairo(OOCairo cairo)
                        {
                                // TODO Auto-generated method stub
                                cairo.setPenColor(OORGB.RED);
                                cairo.drawRectangle(20, 20, 100, 100);
                                cairo.fill();
                                cairo.drawCircle(200, 200, 50);
                                cairo.stroke();
                        }
                });
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2：treeview当中的双击事件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;        public void addDoubleClickedListener(final IGCallBack callback)
        {
                GTK.g_signal_connect(this.getId(), &amp;quot;button-press-event&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                if(GTK.gdk_event_get_type(eventData)==GTK.GDK_2BUTTON_PRESS)
                                {
                                        //调用时候 需要再次重写他。
                                        callback.execute(instance, eventData, object);
                                }
                        }
                }, null);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;TestTreeView
定义了一个 TestOOTreeView otv = new TestOOTreeView(); //通过内部接口&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;  otv.addDoubleClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                int[] selection = otv.getMultipleSelectRows();
                                for(int i = 0; i &amp;lt; selection.length; i++)
                                {
                                        System.out.println(&amp;quot;selection&#39;s length== &amp;quot;+ selection.length+&amp;quot;当前行&amp;quot;+selection[i]);
                                        //values[i]  = otv.getliststore().getValue(selection[i], 1);
                                        OOMessageDialog.showInfo(&amp;quot;选中的信息为&amp;quot;+otv.getliststore().getValue(selection[i], 1), &amp;quot;用户名&amp;quot;);
                                        System.out.println(&amp;quot;selection[&amp;quot;+i+&amp;quot;]&amp;quot;+selection[i]);
                                }
                        }
                });
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;接口的多态，比如Speakable sp = new People()&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package InterfacePractice;

/**
* @author    叶昭良
* @time      2015年2月8日上午9:30:40
* @version   InterfacePracticeTestSpeackable V1.0
*/
public class TestSpeackable implements Speakable
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                new TestSpeackable().speak();
                new TestSpeackable().look();
                //利用多态来实现        
                Speakable sp = new TestSpeackable();
                sp.speak();
                
                //利用匿名类的方式 是吸纳了Speakable接口，并立马返回
                Speakable sp1 = new Speakable()
                {
                        
                        @Override
                        public void speak()
                        {
                                // TODO Auto-generated method stub
                                System.out.println(&amp;quot;这也可以&amp;quot;);
                        }
                        
                        @Override
                        public void look()
                        {
                                // TODO Auto-generated method stub
                                System.out.println(&amp;quot;这也可以&amp;quot;);
                        }
                };
                
                sp1.speak();
                sp1.look();
                
        }

        @Override
        public  void speak()
        {
                // TODO Auto-generated method stub
                System.out.println(&amp;quot;yamadie&amp;quot;);
        }

        @Override
        public void look()
        {
                // TODO Auto-generated method stub
                System.out.println(&amp;quot;带你去看星星&amp;quot;);
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;小技巧：
Ctr+H可以在workspace项目里面查找。。。
Ctrl+shift+T 显示workspace的类
Ctrl+T  O则显示当前文件夹下的类(ctrl+O列举当前类的所有成员)&lt;/p&gt;
&lt;p&gt;枚举类&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package GTKEncapsulate;

import com.rupeng.gtk4j.GTK;

/**
* @author    叶昭良
* @time      2015年2月8日下午4:07:49
* @version   GTKEncapsulateOOResponseType V1.0  用途 简化对话框返回值的判断
*                                   V2.0 parseResponseType 替换掉parseInt这样更加符合常规
*                                        封装返回值的一个返回值，不至于说传递的值是非法（非法值有提醒）
*                                        增加程序的稳定性
*/
public enum OOResponseType
{
        //对话框几种可能的返回值类型
        //GTK_RESPONSE_HELP    GTK_RESPONSE_DELETE_EVENT   GTK_RESPONSE_NONE
        OK(GTK.GTK_RESPONSE_OK),  //最常用放在第一个
        YES(GTK.GTK_RESPONSE_YES),
        NO(GTK.GTK_RESPONSE_NO),
        CANCEL(GTK.GTK_RESPONSE_CANCEL),
        ACCEPT(GTK.GTK_RESPONSE_ACCEPT), //如果改为分号则报错
        APPLY(GTK.GTK_RESPONSE_APPLY),
        REJECT(GTK.GTK_RESPONSE_REJECT),
        NONE(GTK.GTK_RESPONSE_NONE),        
        HELP(GTK.GTK_RESPONSE_HELP),
        DELETE_EVENT(GTK.GTK_RESPONSE_DELETE_EVENT);
        
        
        private  int value = 0;
        /**
         * 
         * @param value  构造函数的参数
         */
        private OOResponseType(int value)
        {
                this.value = value;
        }
        /**
         * 
         * @return  返回OOResponseType对象的int值
         */
        public int getValue()
        {
                return this.value;
        }
        /**
         * 
         * @param value   带解析的数字 在OOResponse枚举类中代表的枚举值
         * @return        返回一个OOResponseType对象
         */
        public static OOResponseType parseResponseType(int value)
        {
                OOResponseType[] apple = OOResponseType.values();
                for(int i = 0 ; i &amp;lt; apple.length; i++)
                {
                        if(value == apple[i].getValue())
                        {
                                return  apple[i];
                        }
                }
                throw new IllegalArgumentException(&amp;quot;ResponseValue = &amp;quot;+value+&amp;quot;是个不合法的参数&amp;quot;);
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;OODialog的封装修改
OODialog封装的思路：分成两个区域进行封装 actionarea     contentarea     Run函数（返回responseType枚举对象）  response（解析responsetype类型，就是你传给一个responseType类型的参数给你在对话框上面响应一个函数）。&lt;/p&gt;
&lt;p&gt;涉及到OOContainer    定义了一个无参构造函数和一个有参构造函数；无参构造函数是为了防止子类报错，因为当父类定义了有参构造函数，
无参构造函数默认会被屏蔽，所以增加一个protected无参构造函数，可以防止类似于OOContainer的子类OOBin不会 报错。
默认OOBin会调用的构造函数是   public OOBin(){super();}  ;//而super默认即是指 OOContainer(){}如果没有
则会报错。
OODialog
OOResponseType &amp;ndash;?涉及到枚举的知识-?枚举类的定义减少用户输错的可能性，增加程序的稳定性&lt;/p&gt;
&lt;p&gt;还是得再次使用枚举类OOMESSAGEType 以及OOButtonsType来显示不同的对话框类型！  类似于OOResponseType（当时并不知道考虑去封装这一步 还一直傻呵呵利用GTK_MESSAGE_ERROR之类的）,封装了一个信息类&lt;/p&gt;
&lt;p&gt;再次复习了OOResponseTyep的parseResponseType的方法实现。&lt;/p&gt;
&lt;p&gt;TreeView的封装思路
1：MVC的V  建立一个View
2：MVC的M  建立一个OOListStore  和OOTreeIter(注意和OOTextIter的区别）
3：MVC的C  用于控制view和listmodel
详看练习TestOOTreeView&lt;/p&gt;
&lt;p&gt;一种新的编程方式：玻璃出来业务逻辑从main函数中，减少界面的组合过程，main只是负责显示。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package GTKEncapsulate;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author    叶昭良
* @time      2015年2月9日下午1:33:31
* @version   GTKEncapsulateTestOOTreeView2Window V1.0
*/
public class TestOOTreeView2Window extends OOWindow
{

        /**
         * @param args
         */
        private static OOTreeView otv ;
        public TestOOTreeView2Window() 
        {
                
                //设置布局
                otv = new  OOTreeView();
                otv.addField(&amp;quot;ID&amp;quot;, 0);
                otv.addField(&amp;quot;Name&amp;quot;, 1);
                otv.addField(&amp;quot;Age&amp;quot;, 2);
                
                otv.createModel(3);
                otv.setFieldValue(&amp;quot;001&amp;quot;, &amp;quot;yezhao&amp;quot;, &amp;quot;21&amp;quot;);
                otv.setFieldValue(&amp;quot;002&amp;quot;, &amp;quot;huowa&amp;quot;, &amp;quot;32&amp;quot;);
                otv.setFieldValue(&amp;quot;003&amp;quot;, &amp;quot;yefeng&amp;quot;, &amp;quot;31&amp;quot;);
                OOScrollBar osb = new OOScrollBar();
                osb.show();
                osb.setWidgetSize(300, 300);
                osb.addView(otv);
                //otv.addScrollBar(grid, 0, 200, 200);
                
                //显示
                otv.fillModel();
                otv.show();
                otv.setRecordColumn(2);
                otv.setResizeColumn(2);
                otv.setColumnSort(2);
                otv.setMultipleSelect();
                System.out.println(otv.getliststore().getValue(1, 1));
                System.out.println(otv.getliststore().getValue(2, 1));
                System.out.println(otv.getliststore().getValue(2, 2));
                otv.addDoubleClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                int[] selection = otv.getMultipleSelectRows();
                                for(int i = 0; i &amp;lt; selection.length; i++)
                                {
                                        //System.out.println(&amp;quot;selection&#39;s length== &amp;quot;+ selection.length+&amp;quot;当前行&amp;quot;+selection[i]);
                                        //values[i]  = otv.getliststore().getValue(selection[i], 1);
                                        OOMessageDialog.showInfo(&amp;quot;选中的信息为&amp;quot;+otv.getliststore().getValue(selection[i], 1), &amp;quot;用户名&amp;quot;);
                                //        System.out.println(&amp;quot;selection[&amp;quot;+i+&amp;quot;]&amp;quot;+selection[i]);
                                }
                        }
                });
                this.add(osb);
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                //TestOOTreeView2Window 的封装的责任是新建字段 添加数据 加入监听  main不负责这些事情，main只是显示
                TestOOTreeView2Window ttv2w = new TestOOTreeView2Window();
                ttv2w.setExitAfterDestroy(true);
                ttv2w.show();
                GTK.gtk_main();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2月8号练习：&lt;/p&gt;
&lt;p&gt;1：学习了接口类，并利用接口类进一步学习了匿名类对接口类的实现，在多处体现，比如比如打开文件夹 的处理可以放在匿名接口类
比如封装的treeView的双击时间的匿名接口类的实现,比如画图板的draw事件的匿名接口类的实现&lt;/p&gt;
&lt;p&gt;2：封装了OODrawingArea  和 OODrawCallback（待实现drawCairo方法）接口，进一步理解了匿名接口类&lt;/p&gt;
&lt;p&gt;3：学习了枚举类用于封装OOResponseTyep   OOMessageType  OOFileAction   OOButtonsType四个枚举类，
这样可以减少用户输入参数的错误&lt;/p&gt;
&lt;p&gt;4：封装了消息对话框  OOMessageDialog  ，包含showInfo  showError 等，兵删掉OOWidget中的showInfo等函数&lt;/p&gt;
&lt;p&gt;5：继承OODialog实现了OOInputDialog，了解了ActionArea和contentArea&lt;/p&gt;
&lt;p&gt;6: 修改了OOFileChooser的实现，利用OOFileAction枚举类在修改，并增加部分函数&lt;/p&gt;
&lt;p&gt;7：修改了OOTreeView的实现，玻璃出OOListStore和OOlistIter这两个类，并进一步的在OOTreeView的内部中新建了
两个内部类OOColumn  OOSelection，更加体现面向对象的过程。&lt;/p&gt;
&lt;p&gt;8：修改了OOToolBar的实现，为了让外包可以访问工具栏的按钮，增加了一个共有的OOToolButton类&lt;/p&gt;
&lt;p&gt;9：修改了OOContainer类的方法，利用对象直接添加。&lt;/p&gt;
&lt;p&gt;10：增加了一个测试包TestGTKEncapsulate，用于测试。&lt;/p&gt;
&lt;p&gt;源码V5.0版本 类增加到46个类，不包含内部类，并做了外包测试，修正了使用，已在TestGTKEncapsulate文件夹。&lt;/p&gt;
&lt;p&gt;面向对象：让对象自己去做自己的内部逻辑，就好像我们自己去打扮我们自己的程序，main（杨老师）定义了一个对象，然后一个show而已。面向对象其实就是师傅领进门修行在个人。&lt;/p&gt;
&lt;p&gt;2-9号笔记和练习
第一部分 笔记
1计时器的使用&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;                GTK.g_timeout_add(1000, new IGSourceFunc()
                {
                        
                        @Override
                        public boolean execute(Object userdata)
                        {
                                // TODO Auto-generated method stub
                                getTime();
                                return true;
                        }
                }, null);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;说明： 1000表示1000ms也就是1s
IGS&amp;hellip;是一个回调函数，当return为true时候继续监听，当return为false则停止计时器的即使，所以如果一直为true，则计时器一直再走。
2：打开音乐
GTK.mci_play(filename)  打开音乐
GTK.mci_close(deviceID) 关闭音乐&lt;/p&gt;
&lt;p&gt;3： OOToolButton 没有OOToolItem的 setToolTip的方法，但是在OOToolButton可以设置图片
并进行监听。OOToolButton暂时用的多。&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;OODialog response的作用
理解了OODialog的response的作用之后，重新修改了，OOInputDialog等继承自OODialog的空间。
response是使得添加进dialog的控件能够发出某种信号！！ 当我们定义完之后，后期新建一个对象，并run之后，就会返回一个信号（可能来自原先的dialog的信号，也可能是按钮的信号，这边的按钮不再用clicked事件进行外部监听了，但是其实是封装在对应的dialog子类控件中，表面上是活的对话框的OOResponseTyep的信号，其实内部也是触发了clicked事件，只不过是在clicked事件中，调用response函数，发出对应的OOResponseTyep的信号）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;5：LED时钟
a. 冒号和空图片的切换&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;colon1.setResourceImage(&amp;quot;ledclock//&amp;quot;+(secondGe%2==1?&amp;quot;colon&amp;quot;:&amp;quot;empty&amp;quot;)+&amp;quot;.png&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;b.LED的整点报时&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;String[] table = {&amp;quot;零&amp;quot;,&amp;quot;壹&amp;quot;,&amp;quot;贰&amp;quot;,&amp;quot;叁&amp;quot;,&amp;quot;肆&amp;quot;,&amp;quot;伍&amp;quot;,&amp;quot;陆&amp;quot;,&amp;quot;柒&amp;quot;,&amp;quot;扒&amp;quot;,&amp;quot;玖&amp;quot;};
if( minute ==0 &amp;amp;&amp;amp; second == 0)
                {
                        System.out.println(&amp;quot;北京时间&amp;quot;+table[hourShi]+table[hourGe]+&amp;quot;整&amp;quot;);
                        OOMessageDialog.showInfo(&amp;quot;北京时间&amp;quot;+table[hourShi]+table[hourGe]+&amp;quot;整&amp;quot;, &amp;quot;整点消息&amp;quot;);
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6：三重button：OOCalendarButton的封装
目的：简化开发的过程，提供一个按钮，并让用户选择日期，回馈到按钮的标签上
设计的三个类：
OOCalendar (继承自OOContainer)
OOCalendarDialog(继承自OODialog)
OOCalendarButton(继承自OOButton)&lt;/p&gt;
&lt;p&gt;OOCalendarDialog的封装和OOInputDialog的封装基本上思路一样。在actionaArea添加两个按钮，在contentArea添加一个OOCalendar，进行对应的事件监听。&lt;/p&gt;
&lt;p&gt;一个小bug:(自己犯的一点小错误)
OOCalendarButton 的&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;SimpleDateFormat sdf = new SimpleDateFormat(&amp;quot;yyyy年mm月dd日&amp;quot;);

改为
SimpleDateFormat sdf = new SimpleDateFormat(&amp;quot;yyyy年MM月dd日&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;一个重点：
三种调用类私有变量date的方式
1 可以用  date = ocd.getDate();    直接写上date,那么编译器会从内往外一层一层走，直到
找到date,所以可能会造成外层需要被赋值的date并未被赋值，而里层不需要赋值的date反而
赋值了
2.  this.date  也可能会造成错误，比如在一个匿名类中，那么this.date的意思就是匿名类的date,如果匿名类没有定义date，则报错&lt;/p&gt;
&lt;p&gt;3 OOCalendarButton.this.date = ocd.getDate();  //最好的一种方法
//OOCalendarButton的this对象，直接找到该类中的类变量。&lt;/p&gt;
&lt;p&gt;第二部分  练习&lt;/p&gt;
&lt;p&gt;1： 计时器
case1  progereeBar 的安装条&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package GTKEncapsulate;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
import com.rupeng.gtk4j.IGSourceFunc;

/**
* @author    叶昭良
* @time      2015年2月9日下午3:13:29
* @version   GTKEncapsulateTestOOProgressBar2Window V1.0
*/
public class TestOOProgressBar2Window extends OOWindow
{

        /**
         * @param args
         */
        private OOLabel  olApple = null;
        private OOProgressBar opbApple = null;
        private OOButton obApple = null;
        public  TestOOProgressBar2Window()
        {
                
                OOBox obtemp = new OOBox();
                obtemp.show();
                
                olApple = new OOLabel(&amp;quot;0&amp;quot;);
                olApple.show();
                obtemp.add(olApple);
                opbApple = new OOProgressBar();
                opbApple.setText(&amp;quot;请稍等&amp;quot;);
                opbApple.showText(&amp;quot;请稍后&amp;quot;);
                opbApple.show();
                obtemp.add(opbApple);
                
                obApple = new OOButton(&amp;quot;安装&amp;quot;);
                obApple.show();
                obtemp.add(obApple);
                obApple.addClickedListener(new IGCallBack()
                {
                        
@Override
public void execute(int instance, int eventData, Object object)
{
        // TODO Auto-generated method stub
        GTK.g_timeout_add(1000, new IGSourceFunc()
        {
                
                @Override
                public boolean execute(Object userdata)
                {
                        // TODO Auto-generated method stu
                        String txt = olApple.getText();        
                        
                        int apple = Integer.parseInt(txt);
                        
                        apple++;
                        olApple.setText(Integer.toString(apple));
                        double banana = apple*0.1;
                        if(banana== 1.0)
                        {
                                OOMessageDialog.showInfo(&amp;quot;安装完成&amp;quot;, &amp;quot;安装&amp;quot;);
                        }
                        opbApple.setProgress(banana);
                        return banana&amp;lt;=1;
                }
        }, null);
}
                });
                
                this.add(obtemp);
                
                
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                TestOOProgressBar2Window top2w = new TestOOProgressBar2Window();
                top2w.show();
                top2w.setExitAfterDestroy(true);
                GTK.gtk_main();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case2 LED灯+整点报时（未加上声音改用弹出对话框）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package TestGTKEncapsulate;



import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGSourceFunc;

import GTKEncapsulate.*;

/**
* @author    叶昭良
* @time      2015年2月10日下午1:17:40
* @version   TestGTKEncapsulateLEDClock V1.0
*/
public class LEDClock extends OOWindow
{

        /**
         * @param args
         */
        private OOImage oiHourShi;
        
        private OOImage oiHourGe;
        private OOImage oiMinuteShi;
        private OOImage oiMinuteGe;
        private OOImage oiSecondShi;
        private OOImage oiSecondGe;
        private int hourShi;
        private int hourGe;
        private int minuteShi;
        private int minuteGe;
        private int secondShi;
        private int secondGe;
        private OOBox obApple;
        private OOImage colon1;
        private OOImage colon2;
        private OOLabel olDate;
        public LEDClock()
        {
                obApple = new OOBox();
                obApple.show();
                
                olDate = new OOLabel(&amp;quot;&amp;quot;);
                olDate.show();

                obApple.addWidget(olDate);

                oiHourShi = new OOImage();
                oiHourGe = new OOImage();
                colon1 = new OOImage();
                oiMinuteShi = new OOImage();
                oiMinuteGe = new OOImage();
                colon2 = new OOImage();
                oiSecondShi = new OOImage();
                oiSecondGe = new OOImage();
                obApple.addWidget(oiHourShi);
                obApple.addWidget(oiHourGe);
                obApple.addWidget(colon1);
                obApple.addWidget(oiMinuteShi);
                obApple.addWidget(oiMinuteGe);
                obApple.addWidget(colon2);
                obApple.addWidget(oiSecondShi);
                obApple.addWidget(oiSecondGe);
                getTime();
                
                GTK.g_timeout_add(1000, new IGSourceFunc()
                {
                        
                        @Override
                        public boolean execute(Object userdata)
                        {
                                // TODO Auto-generated method stub
                                getTime();
                                return true;
                        }
                }, null);
                this.setWidgetSize(200, 100);
                this.add(obApple);
        }
        
        public void getTime()
        {
                String[] table = {&amp;quot;零&amp;quot;,&amp;quot;壹&amp;quot;,&amp;quot;贰&amp;quot;,&amp;quot;叁&amp;quot;,&amp;quot;肆&amp;quot;,&amp;quot;伍&amp;quot;,&amp;quot;陆&amp;quot;,&amp;quot;柒&amp;quot;,&amp;quot;扒&amp;quot;,&amp;quot;玖&amp;quot;};
                
                Date date = new Date();
                SimpleDateFormat sdf = new SimpleDateFormat(&amp;quot;yyyy年-MM月-dd日 &amp;quot;);
                String labelText = sdf.format(date);
                //System.out.println(labelText);
                olDate.setText(labelText);
                Calendar cl = Calendar.getInstance();
                cl.setTime(date);
                int hour = cl.get(Calendar.HOUR_OF_DAY);
                int minute = cl.get(Calendar.MINUTE);
                int second = cl.get(Calendar.SECOND);
                
                hourShi = hour/10;
                hourGe  = hour%10;
                minuteShi = minute/10;
                minuteGe = minute%10;
                secondShi = second/10;
                secondGe  = second%10;
                
                
                oiHourShi.setResourceImage(&amp;quot;ledclock//&amp;quot;+hourShi+&amp;quot;.png&amp;quot;);
                oiHourGe.setResourceImage(&amp;quot;ledclock//&amp;quot;+hourGe+&amp;quot;.png&amp;quot;);
                colon1.setResourceImage(&amp;quot;ledclock//&amp;quot;+(secondGe%2==1?&amp;quot;colon&amp;quot;:&amp;quot;empty&amp;quot;)+&amp;quot;.png&amp;quot;);
                oiMinuteShi.setResourceImage(&amp;quot;ledclock//&amp;quot;+minuteShi+&amp;quot;.png&amp;quot;);
                oiMinuteGe.setResourceImage(&amp;quot;ledclock//&amp;quot;+minuteGe+&amp;quot;.png&amp;quot;);
                colon2.setResourceImage(&amp;quot;ledclock//&amp;quot;+(secondGe%2==1?&amp;quot;colon&amp;quot;:&amp;quot;empty&amp;quot;)+&amp;quot;.png&amp;quot;);
                oiSecondShi.setResourceImage(&amp;quot;ledclock//&amp;quot;+secondShi+&amp;quot;.png&amp;quot;);
                oiSecondGe.setResourceImage(&amp;quot;ledclock//&amp;quot;+secondGe+&amp;quot;.png&amp;quot;);
                
                if( minute ==0 &amp;amp;&amp;amp; second == 0)
                {
                        System.out.println(&amp;quot;北京时间&amp;quot;+table[hourShi]+table[hourGe]+&amp;quot;整&amp;quot;);
                        OOMessageDialog.showInfo(&amp;quot;北京时间&amp;quot;+table[hourShi]+table[hourGe]+&amp;quot;整&amp;quot;, &amp;quot;整点消息&amp;quot;);
                }
        
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                LEDClock lc = new LEDClock();
                lc.show();
                lc.setExitAfterDestroy(true);
                GTK.gtk_main();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3小兵聊天工具：
事先封装了键盘上面的ASCII码  为一个枚举类OOKeycode:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package GTKEncapsulate;

/**
* @author    叶昭良
* @time      2015年2月9日下午9:28:07
* @version   GTKEncapsulateOOKeycode V1.0  封装大部分的GTK对于键盘识别的keycode
*/
public enum OOKeycode
{
        //字母
                A(&amp;quot;键盘上的a&amp;quot;,65),
                B(&amp;quot;键盘上的b&amp;quot;,66),
                C(&amp;quot;键盘上的c&amp;quot;,67),
                D(&amp;quot;键盘上的d&amp;quot;,68),
                E(&amp;quot;键盘上的e&amp;quot;,69),
                F(&amp;quot;键盘上的f&amp;quot;,70),
                G(&amp;quot;键盘上的g&amp;quot;,71),
                H(&amp;quot;键盘上的h&amp;quot;,72),
                I(&amp;quot;键盘上的i&amp;quot;,73),
                J(&amp;quot;键盘上的j&amp;quot;,74),
                K(&amp;quot;键盘上的k&amp;quot;,75),
                L(&amp;quot;键盘上的l&amp;quot;,76),
                M(&amp;quot;键盘上的m&amp;quot;,77),
                N(&amp;quot;键盘上的n&amp;quot;,78),
                O(&amp;quot;键盘上的o&amp;quot;,79),
                P(&amp;quot;键盘上的p&amp;quot;,80),
                Q(&amp;quot;键盘上的q&amp;quot;,81),
                R(&amp;quot;键盘上的r&amp;quot;,82),
                S(&amp;quot;键盘上的s&amp;quot;,83),
                T(&amp;quot;键盘上的t&amp;quot;,84),
                U(&amp;quot;键盘上的u&amp;quot;,85),
                V(&amp;quot;键盘上的v&amp;quot;,86),
                W(&amp;quot;键盘上的w&amp;quot;,87),
                X(&amp;quot;键盘上的x&amp;quot;,88),
                Y(&amp;quot;键盘上的y&amp;quot;,89),
                Z(&amp;quot;键盘上的z&amp;quot;,90),
        //数字
            NUM_0(&amp;quot;键盘上的0和)&amp;quot;,48),
            NUM_1(&amp;quot;键盘上的1和!&amp;quot;,49),
            NUM_2(&amp;quot;键盘上的2和@&amp;quot;,50),
            NUM_3(&amp;quot;键盘上的3和#&amp;quot;,51),
            NUM_4(&amp;quot;键盘上的4和[        DISCUZ_CODE_6        ]quot;,52),
            NUM_5(&amp;quot;键盘上的5和%&amp;quot;,53),
            NUM_6(&amp;quot;键盘上的6和^&amp;quot;,54),
            NUM_7(&amp;quot;键盘上的7和&amp;amp;&amp;quot;,55),
            NUM_8(&amp;quot;键盘上的8和*&amp;quot;,56),
            NUM_9(&amp;quot;键盘上的9和(&amp;quot;,57),
        //比较重要的几个按键
            SHIFT(&amp;quot;键盘上的SHIFT键&amp;quot;,16),
            CTRL(&amp;quot;键盘上的ctrl键&amp;quot;,17),
            ALT(&amp;quot;键盘上的ALT键&amp;quot;,18),
            CAPS_LOCK(&amp;quot;键盘上的大写键&amp;quot;,20),
            ESC(&amp;quot;键盘上的ESC键&amp;quot;,27),
            TAB(&amp;quot;键盘上的Tab键&amp;quot;,9),
            RIGTH_SHIFT(&amp;quot;键盘上右边的SHIFT键&amp;quot;,161),
            RIGHT_CTRL(&amp;quot;键盘上右边的ctrl键&amp;quot;,163),
            RIGHT_ALT(&amp;quot;键盘上右边的ALT键&amp;quot;,165),
            WINDOWS(&amp;quot;键盘上的WINDOWS键&amp;quot;,91),
            FN(&amp;quot;键盘上的FN键&amp;quot;,17),
            BACKSPACE(&amp;quot;键盘上的baskspace回退键&amp;quot;,8),
            SPACE(&amp;quot;键盘上的空格键&amp;quot;,32),
        //方向键
            LEFT(&amp;quot;键盘上的左方向键&amp;quot;,37),
            UP(&amp;quot;键盘上的上方向键&amp;quot;,38),
            RIGHT(&amp;quot;键盘上的右方向键&amp;quot;,39),
            DOWN(&amp;quot;键盘上的下方向键&amp;quot;,40),

        //小键盘数字 当前情况下必须是在小键盘开启的情况下，否则会匹配错误
            SMALLBOARD_0(&amp;quot;小键盘上的0和insert&amp;quot;,96),
            SMALLBOARD_1(&amp;quot;小键盘上的1和end&amp;quot;,97),
            SMALLBOARD_2(&amp;quot;小键盘上的2和向下方向键&amp;quot;,98),
            SMALLBOARD_3(&amp;quot;小键盘上的3和pgdn&amp;quot;,99),
            SMALLBOARD_4(&amp;quot;小键盘上的4和向左方向键&amp;quot;,100),
            SMALLBOARD_5(&amp;quot;小键盘上的5&amp;quot;,101),
            SMALLBOARD_6(&amp;quot;小键盘上的6和向右方向键&amp;quot;,102),
            SMALLBOARD_7(&amp;quot;小键盘上的7和home&amp;quot;,103),
            SMALLBOARD_8(&amp;quot;小键盘上的8和向上方向键&amp;quot;,104),
            SMALLBOARD_9(&amp;quot;小键盘上的9和pgdn&amp;quot;,105),
        //小键盘上的+ - * /
            SMALLBOARD_PLUS(&amp;quot;小键盘上的加号&amp;quot;,107),
            SMALLBOARD_MINUS(&amp;quot;小键盘上的减号&amp;quot;,109),
            SMALLBOARD_MULTIPLY(&amp;quot;小键盘上的乘号&amp;quot;,106),
            SMALLBOARD_DIVIDE(&amp;quot;小键盘上的除号&amp;quot;,111),
        //小键盘上的enter和点号（delete),enter和主键盘一样
            SMALLBOARD_DELETE(&amp;quot;小键盘上的点号&amp;quot;,110),
            ENTER(&amp;quot;小键盘上的ENTER以及主键盘的ENTER&amp;quot;,13),

        //右手边的一些符号键
            SINGLEQUOTE(&amp;quot;键盘上的双引号和单引号&amp;quot;,222),
            SEMICOLON(&amp;quot;键盘上的分号和冒号colon键&amp;quot;,186),
            COMMA(&amp;quot;键盘上的逗号键和&amp;lt;&amp;quot;,188),
            POINT(&amp;quot;键盘盘上的句号和&amp;gt;&amp;quot;,190),
            SLASH(&amp;quot;键盘上的/正斜杠表示除法和问号&amp;quot;,191),
            BACKSLASH(&amp;quot;键盘上的反斜杠\\和竖线&amp;quot;,220),
            LEFTSQUARE(&amp;quot;键盘上的左中括号和左大括号&amp;quot;,219),
            RIGHTSQUARE(&amp;quot;键盘上的右中括号和右大括号&amp;quot;,221),
            
            DASH(&amp;quot;键盘上的破折号和减号&amp;quot;,189),
            EQUAL(&amp;quot;键盘上的等号和加号&amp;quot;,187),
            REVERSEQUOTE(&amp;quot;键盘上的反引号和约等号&amp;quot;,192),
            
          //一些不经常用的
//            PRINT(&amp;quot;键盘上的PRINT&amp;quot;,)
            PAUSE(&amp;quot;键盘上的暂停键和break&amp;quot;,19),
            DELETE(&amp;quot;键盘上的delete和insert键&amp;quot;,46),
            HOME(&amp;quot;键盘上的HOME键&amp;quot;,36),
            PAGEUP(&amp;quot;键盘上的PAGEUP&amp;quot;,33),
            PAGEDOWN(&amp;quot;键盘上的PAGEDOWN&amp;quot;,34),
            END(&amp;quot;键盘上的END&amp;quot;,35),
            NUMLOCK(&amp;quot;键盘上的NUMLOCK&amp;quot;,144),
            
            //F1--F12
            F1(&amp;quot;键盘上的F1键&amp;quot;,112),
            F2(&amp;quot;键盘上的F2键&amp;quot;,113),
            F3(&amp;quot;键盘上的F3键&amp;quot;,114),
            F4(&amp;quot;键盘上的F4键&amp;quot;,115),
            
            F5(&amp;quot;键盘上的F5键&amp;quot;,116),
            F6(&amp;quot;键盘上的F6键&amp;quot;,117),
            F7(&amp;quot;键盘上的F7键&amp;quot;,118),
            F8(&amp;quot;键盘上的F8键&amp;quot;,119),
            F9(&amp;quot;键盘上的F9键&amp;quot;,120),
            F10(&amp;quot;键盘上的F10键&amp;quot;,121),
            F11(&amp;quot;键盘上的F11键&amp;quot;,122),
            F12(&amp;quot;键盘上的F12键&amp;quot;,123),
            ;



        
        //ctrl shift tab caps_lock  , . ; / &#39; [ ]的
        private int keycode;
        private String keyName;
        private OOKeycode(String keyName,int keycode)
        {
                this.keyName = keyName;
                this.keycode = keycode;
        }
        
        public int getKeycode()
        {
                return this.keycode;
        }
        public String getKeyName()
        {
                return this.keyName;
        }
        
        public static OOKeycode parseOOKeycode(int keycode)
        {
                OOKeycode[] apples = OOKeycode.values();
                for(int i = 0 ; i &amp;lt; apples.length; i++)
                {
                        if(keycode == apples[i].getKeycode())
                        {
                                return apples[i];
                        }
                }
                throw new IllegalArgumentException(keycode+&amp;quot;是一个不合法的参数&amp;quot;);
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;修改了OOEntry, 添加一个键盘敲击响应事件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void addKeyPressListener(final IGCallBack callback)
        {
                GTK.g_signal_connect(this.getId(), &amp;quot;key-press-event&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                callback.execute(instance, eventData, object);
                        }
                }, null);
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;小兵聊天主程序&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package TestGTKEncapsulate;

import javax.xml.crypto.dsig.keyinfo.KeyValue;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

import GTKEncapsulate.OOContainer;
import GTKEncapsulate.OODialog;
import GTKEncapsulate.OOEntry;
import GTKEncapsulate.OOFileChooser;
import GTKEncapsulate.OOGrid;
import GTKEncapsulate.OOImage;
import GTKEncapsulate.OOKeycode;
import GTKEncapsulate.OOMessageDialog;
import GTKEncapsulate.OOMusic;
import GTKEncapsulate.OOMusicMode;
import GTKEncapsulate.OOScrollBar;
import GTKEncapsulate.OOTextView;
import GTKEncapsulate.OOWindow;
//import GTKEncapsulate.OpenFile;

/**
* @author    叶昭良
* @time      2015年2月9日下午8:20:47
* @version   TestGTKEncapsulateTestXiaoBingWindow V1.0
*                                                         V2.0  把所有的equalsIgnoreCase 改为contains 只需要字符串包含即可，
*/
public class TestXiaoBingWindow extends OOWindow
{

        /**
         * @param args
         */
        private  OOEntry oeApple ;
        private OOTextView otvApple;
        private OOImage oim;
        private OOMusic om;
        public TestXiaoBingWindow()
        {
                OOGrid grid = new OOGrid();
                oeApple = new OOEntry();
                oeApple.show();
                //oeApple.setText(&amp;quot;请在这边输入文本：&amp;quot;);
                otvApple = new OOTextView();
                otvApple.show();
                otvApple.setEditable(false);
                OOScrollBar osbApple = new OOScrollBar();
                osbApple.show();
                osbApple.setWidgetSize(300, 300);
                osbApple.add(otvApple);
                
                grid.add(osbApple, 0);
                grid.add(oeApple,1);
                grid.show();
                this.add(grid);
//                GTK.MCI_MODE_OPEN
                
                //设置监听
                oeApple.addKeyPressListener(new IGCallBack()
                {
                        
@Override
public void execute(int instance, int eventData, Object object)
{
        // TODO Auto-generated method stub
        int keycode = GTK.gdk_event_get_keycode(eventData);
        if(keycode == OOKeycode.ENTER.getKeycode())
        {
                
                String text = oeApple.getText();
                otvApple.insertTextAtEnd(&amp;quot;你说:&amp;quot;+text+&amp;quot;\n&amp;quot;);
                oeApple.setText(&amp;quot;&amp;quot;);
                //text.contains
                if(text.contains(&amp;quot;你好啊&amp;quot;))
                {
                        otvApple.insertTextAtEnd(&amp;quot;小兵说:&amp;quot;+&amp;quot;好你妹！\n&amp;quot;);
                }else if(text.contains(&amp;quot;脱衣舞&amp;quot;))
                {
                        otvApple.insertTextAtEnd(&amp;quot;小兵说:&amp;quot;+&amp;quot;不跟你玩了\n&amp;quot;);
                }else if(text.contains(&amp;quot;今年几岁&amp;quot;))
                {
                        otvApple.insertTextAtEnd(&amp;quot;小兵说:&amp;quot;+&amp;quot;女孩子的年龄不能随便告诉别人\n&amp;quot;);
                }else if(text.contains(&amp;quot;你是男的还是女的&amp;quot;))
                {
                        otvApple.insertTextAtEnd(&amp;quot;Little Bing Said:&amp;quot;+&amp;quot;You guess\n&amp;quot;);
                }else if(text.contains(&amp;quot;让我们去外面玩吧&amp;quot;))
                {
                        otvApple.insertTextAtEnd(&amp;quot;Little Bing Said:&amp;quot;+&amp;quot;去哪里玩？\n&amp;quot;);
                }else if(text.contains(&amp;quot;select&amp;quot;))
                {
                        OpenFile ofApple = new OpenFile();
                        ofApple.setMultipleSelect();
                        ofApple.createFilter();
                        ofApple.nameFilter(&amp;quot;音乐文件&amp;quot;);
                        ofApple.editFilter(&amp;quot;*.MP3&amp;quot;);
                        ofApple.editFilter(&amp;quot;*.wav&amp;quot;);
                        //把filter的操作放入打开对话框中
                        ofApple.finishFilter();
                        String[] filenames = ofApple.processResponse();
                        //在src文件夹下
                        om = new OOMusic(filenames[0]);
                        om.playOnce();
                }else if(text.contains(&amp;quot;sing&amp;quot;))
                {
                        //在src文件夹下
                        om = new OOMusic(&amp;quot;breathless.mp3&amp;quot;,false);
                        om.playOnce();
                }else if(text.contains(&amp;quot;pause&amp;quot;))
                {
                        //在src文件夹下
                        
                        om.pause();
                }else if(text.contains(&amp;quot;resume&amp;quot;))
                {
                        //在src文件夹下
                        
                        om.pause();
                }else if(text.contains(&amp;quot;close&amp;quot;))
                {
                        //在src文件夹下
                        
                        om.close();
                }else if(text.contains(&amp;quot;show&amp;quot;))
                {
                        OODialog od = new OODialog();
                        OOContainer oct = od.createContentArea();
                        oim = new OOImage();
                        oim.setResourceImage(&amp;quot;hunsha.jpg&amp;quot;);
                        oim.setWidgetSize(200, 200);
                        oim.show();
                        oct.add(oim);
                        od.run();
                        od.destroy();
                }
                else if(text.contains(&amp;quot;北京怎么样&amp;quot;))
                {
                        otvApple.insertTextAtEnd(&amp;quot;Little Bing Said:&amp;quot;+&amp;quot;不怎么样，先这样，改天再聊\n&amp;quot;);       
                }else
                {
                        otvApple.insertTextAtEnd(&amp;quot;小兵说：没听见，再说一遍\n&amp;quot;);
                }
        }
//                                System.out.println(OOKeycode.parseOOKeycode(keycode).getKeyName());
}
});
/*GTK.g_signal_connect(oeApple.getId(), &amp;quot;key-press-event&amp;quot;, new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                int keycode = GTK.gdk_event_get_keycode(eventData);
                                
//                                System.out.println(keycode);
                                System.out.println(OOKeycode.parseOOKeycode(keycode).getKeyName());
                                //int value = GTK.gdk_event_get_keyval(eventData);
                                //String enterCharacterString= String.valueOf(keycode);
                                //System.out.println(enterCharacterString);
                                //char enterCharacter = enterCharacterString.charAt(0);
                                //String text = oeApple.getText();
                                //char lastchar = text.charAt(text.length()-1);
                                //System.out.println(text+&amp;quot;text length=&amp;quot;+text.length());
//                                System.out.println(&amp;quot;当前输入的字符&amp;quot;+enterCharacter+&amp;quot;的ascii码为:&amp;quot;+keycode+&amp;quot;\n并且的他的10进制数为&amp;quot;+value);
//                                OOMessageDialog.showInfo(&amp;quot;当前输入的字符&amp;quot;+enterCharacter+&amp;quot;的ascii码为:&amp;quot;+keycode+&amp;quot;\n并且的他的10进制数为&amp;quot;+value, &amp;quot;学习ASCII码&amp;quot;);
                                //System.out.println(&amp;quot;当前输入的字符&amp;quot;+enterCharacter+&amp;quot;的ascii码为:&amp;quot;+keycode);
                                //OOMessageDialog.showInfo(&amp;quot;当前输入的字符&amp;quot;+enterCharacter+&amp;quot;的ascii码为:&amp;quot;+keycode, &amp;quot;学习ASCII码&amp;quot;);
                        }
                }, null);*/
}
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                TestXiaoBingWindow txbw = new TestXiaoBingWindow();
                txbw.setExitAfterDestroy(true);
                txbw.show();
                GTK.gtk_main();
        }
        class OpenFile extends OOFileChooser
        {

                @Override
                public  String[] processResponse()
                {
                        String[] filenames = null;
                        // TODO Auto-generated method stub
                        int ret = this.run().getValue();
                        if(ret == GTK.GTK_RESPONSE_OK) 
                        {
                                filenames = GTK.gtk_file_chooser_get_filenames(this.getId());
                                for(int i = 0 ; i&amp;lt; filenames.length ; i++)
                                {
                                        
                                        System.out.println(&amp;quot;选中文件名&amp;quot;+i+&amp;quot;: &amp;quot;+filenames[i]);
                                }
                                GTK.gtk_widget_destroy(this.getId()); //必须需要！！否则报错
                        }else
                        {
                                GTK.gtk_widget_destroy(this.getId());
                        }
                        return filenames;
                }

                @Override
                public void processResponse1()
                {
                        // TODO Auto-generated method stub
                        
                }                
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4 音乐的使用+定时器+图片空间+textview === 女神表达神器之爱的誓言&lt;/p&gt;
&lt;p&gt;在敲完誓言之后，开始播放音乐
未修复的bug: 有时候读着读着文字就崩溃了， 另外加入背景音乐也不行。。。相当不稳定。
最大的bug:  memery  error&amp;hellip;&amp;hellip;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package TestGTKEncapsulate;
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGSourceFunc;

import GTKEncapsulate.*;

/**
* @author    叶昭良
* @time      2015年2月10日上午1:17:57
* @version   TestGTKEncapsulateTestGrilGift V1.0 女朋友表达神器
*/
public class TestGirlGift extends OOWindow
{

        /**
         * @param args
         */
        private OOImage oim ;
        private OOTextView otv;
        private OOMusic om ;
        public TestGirlGift() 
        {
                OOBox ob =new OOBox(false);
                ob.show();
                oim = new OOImage();
                oim.setResourceImage(&amp;quot;yumufeng.jpg&amp;quot;);
                oim.show();
                ob.addWidget(oim);
                otv = new OOTextView();
                otv.show();
                otv.setType();
                OOScrollBar osb = new OOScrollBar();
                osb.show();
                osb.setWidgetSize(200, 220);
                osb.add(otv);
                ob.addWidget(osb);
                this.add(ob);
                
                final StringBuilder love = new StringBuilder();
                // +号之后都会出现bug
                final String Lovewords = &amp;quot;欣然:\r\n谢谢你给我的所有关怀和理解，尤其是那些孤立无助的时刻你温暖的陪伴，它让我始终强大坚定!\r\n&amp;quot;
                    +&amp;quot;我要让你成为世界上最幸福的女人,不是因为这一生积累的名望,地位与财富,而仅仅因为我默默恒久的爱!\r\n&amp;quot;
                    +&amp;quot;今天,说出这些话语是那么艰难却又那么快乐,这都是我这么长时间以来埋在心底的话语!这一切只是因为下面我要唱给&amp;quot;
                    +&amp;quot;你听的这首歌的名字:我如此爱你!\r\n落款人：叶昭良 &amp;quot;;
                love.append(Lovewords);
        //这个过程是慢慢地，但是一直持续的在运行
                GTK.g_timeout_add(100, new IGSourceFunc()
                {
                        
                        @Override
                        public boolean execute(Object userdata)
                        {
                                // TODO Auto-generated method stub
                                int len = otv.getText().length();
                                char ch = love.charAt(len);
                                otv.insertTextAtEnd(Character.toString(ch));
                                if(otv.getText().length() == love.length()-1)
                                {
                                        //om.close();
                                        om = new OOMusic(&amp;quot;我如此爱你.mp3&amp;quot;,true);
                                        om.playRepeat();
                                        return true;
                                }else if(otv.getText().length() == love.length())
                                {
                                        return false;
                                }
                                else
                                { 
                                        
                                        //System.out.println(&amp;quot;2&amp;quot;);
                                        return true;
                                }

                        }
                }, null);
                
                //System.out.println(&amp;quot;134&amp;quot;);
/*                if(otv.getText().length() == Lovewords.length()-1)
                {
                        System.out.println(&amp;quot;12&amp;quot;);
                        OOMusic om = new OOMusic(&amp;quot;我如此爱你.mp3&amp;quot;,true);
                        om.playRepeat();
                }*/
                //不能放在里面。。。
                //暂时有问题  添加报错   只好让他在写字的时候专心写字，不放背景音乐
/*                om = new OOMusic(&amp;quot;ISurrender.mp3&amp;quot;,true);
                om.playOnce();*/
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                TestGirlGift tgg = new TestGirlGift();
                tgg.setTitle(&amp;quot;女神表达神器之爱的誓言&amp;quot;);
                tgg.show();
                tgg.setExitAfterDestroy(true);
                GTK.gtk_main();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5OOCalendarButton的创建&lt;/p&gt;
&lt;p&gt;具体的OOCalendarDialog   OOCalendarButton的封装详见   GTKEncapsulate源码6.0&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package TestGTKEncapsulate;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

import GTKEncapsulate.*;

/**
* @author    叶昭良
* @time      2015年2月10日下午2:48:55
* @version   TestGTKEncapsulateTestCalendar V1.0
*/
public class TestCalendar extends OOWindow
{

        /**
         * @param args
         */
        private OOCalendar ocl ;
        private OOCalendarDialog ocld;
        private OOBox obApple;
        private OOButton btnclick;
        private OOCalendarButton ocbApple;
        public TestCalendar()
        {
                ocl = new OOCalendar();
                ocl.show();
                
                btnclick = new OOButton(&amp;quot;点击&amp;quot;);
                btnclick.show();
                btnclick.addClickedListener(new IGCallBack()
                {
                        
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO Auto-generated method stub
                                ocld = new OOCalendarDialog();
                                ocld.show();
                        }
                });
                
                ocbApple = new OOCalendarButton(&amp;quot;选择日期&amp;quot;);
                ocbApple.show();
                
                
                obApple = new OOBox();
                obApple.addWidget(ocl);
                obApple.addWidget(btnclick);
                obApple.addWidget(ocbApple);
                obApple.show();
                
                System.out.println(ocl.getDay()+ocl.getMonth()+ocl.getYear());
                this.add(obApple);
        }
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                GTK.gtk_init();
                TestCalendar tc = new TestCalendar();
                tc.show();
                tc.setExitAfterDestroy(true);
                GTK.gtk_main();
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当前主要的OO库加上枚举类总的有56个，V6.0主要增加了  OOImageButton , OOKeycode,OOMusic, OOMusicMode ,OOMusicStatus,OOStockImage, OOStockSize,OOCalendarDialog，OOCalendarButton&lt;/p&gt;
&lt;p&gt;GTKEncapsulate源码V6.0.rar&lt;/p&gt;
&lt;p&gt;测试了一个toolbar控件，修正了ToolButton的构造函数没有设置ID的重大的bug&lt;/p&gt;
&lt;p&gt;修改的代码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class OOToolButton extends OOContainer
{
        /**
         * V2.0  新的构造方法
         * @param icon_widget
         * @param label
         */
        public OOToolButton(OOWidget icon_widget,String label)
        {
                //如果为0 则工具栏控件没有图片
                int icon_widgetID = (icon_widget==null)?0:icon_widget.getId();
                //GTK.gtk_tool_button_new(icon_widgetID, label) 已添加setId否则报错
                setId(GTK.gtk_tool_button_new(icon_widgetID, label));
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;测试代码就是之前2月6号的TestMenuFileChooseAndToolBar.java
因为采用了新的封装的ToolButton类，所以重新测试，发现了在ToolButton类构造函数缺失setId()的问题，特此修正&lt;/p&gt;
&lt;p&gt;OOFileChooser为抽象类，使用起来不是特别舒服，于是改变成为非抽象的，并提供一个接口，供用户使用。
具体OOFileChooser的修改如下：
县创建一个OOFileChooserInterface接口：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package GTKEncapsulate;

/**
* @author    叶昭良
* @time      2015年2月13日下午2:13:25
* @version   GTKEncapsulateOOFileChooserInterface V1.0
*/
public interface OOFileChooserInterface
{
        public void doit();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后在OOFileChooser类中开放接口并加入默认的两个处理打开和保存的函数：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package GTKEncapsulate;

import java.io.BufferedWriter;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.io.OutputStreamWriter;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author    叶昭良
* @time      2015年2月5日下午4:38:57
* @version   GTKEncapsulateOOFileChooser V1.0 把类标记为abstract，
*                                 这样的类无法被直接实例化（new），这就叫抽象类。
*  V2.0   修改了run方法
*  V3.0   抽象方法的返回值从void 该到了String[]
*  v4.0   修改OOFileChooser继承类为来自OODailog
*         并把public int run()方法提到OODialog中
*  V5.0   利用OOFileAction枚举类 重新编写了OOFIleChooser
*  V6.0   创建了setDoOverWrittenConfirmatio函数，并在封装构造函数中
*         运用了一个判断技巧，增加了 getFileName()  setCurrentFilename
*         createFileFolder 
*  V7.0   从抽象类转变到非抽象类
*         增加了一个文件接口 OOFileChooserInterface 供用户使用
*         增加了打开文件和保存文件的默认处理方式
*/
public  class OOFileChooser extends OODialog
{
        private static Filter fi ;
        //private static int response;  //对话框的响应
        /**
         * 
         * @param title     有参构造函数的窗口标题
         * @param action    有参构造函数的 行为，打开、保存。。
         * @param buttonText  有参构造函数的 按钮的标签名字 
         *  创建一个文件对话框，对话框一定要run一下。。。。。 并且一定要摧毁它
         */
/*        public OOFileChooser(String title, int action, String buttonText)
        {
                setId(GTK.gtk_file_chooser_dialog_new(title, 0, action, buttonText));
        }*/
        public OOFileChooser(String title, OOFileAction action, String buttonText)
        {
                setId(GTK.gtk_file_chooser_dialog_new(title, 0, action.getValue(), buttonText));
                //一个封装技巧。
                if(action ==OOFileAction.SAVE)
                {
                        setDoOverWrittenConfirmation(true);
                }
                
        }
        
        /**
         *   无参构造函数  默认为打开文件对话框说
         */
        public OOFileChooser()
        {
                this(&amp;quot;打开文件&amp;quot;, OOFileAction.OPEN, &amp;quot;打开&amp;quot;);
        }
        /**
         *   设置文件打开窗口的多选
         */
        public void setMultipleSelect() 
        {
                GTK.gtk_file_chooser_set_select_multiple(this.getId(), true);
        }
        /**
         * 
         * @param do_overwrite_confirmation  在save模式下，保存时需要判断是否覆盖
         */
        public void setDoOverWrittenConfirmation(boolean do_overwrite_confirmation)
        {
                GTK.gtk_file_chooser_set_do_overwrite_confirmation(this.getId(), do_overwrite_confirmation);
        }
        /**
         * 
         * @param text  设置当前选择的文件名为text
         */
        public void setCurrentFilename(String text)
        {
                GTK.gtk_file_chooser_set_current_name(this.getId(), text);
        }
        
        /**
         * 
         * @param create_folders  布尔值 用于判断是否创建。。。不清楚这边。
         */
        public void createFileFolder(boolean create_folders)
        {
                GTK.gtk_file_chooser_set_create_folders(this.getId(), create_folders);
        }
        /**
         *   创建一个过滤器
         */
        public void createFilter()
        {
                fi = new Filter();
        }
        /**
         * 
         * @param text     设置过滤器的名字
         */
        public void nameFilter(String text)
        {
                fi.setFilterName(text);
        }
        /**
         * 
         * @param pattern   增加过滤器的后缀
         */
        public void editFilter(String pattern)
        {
                fi.addFilterPattern(pattern);
        }
        
        public void finishFilter()
        {
                GTK.gtk_file_chooser_add_filter(this.getId(), fi.getId());
        }
        

        
        
        public String[]  getFileNames()
        {
                return GTK.gtk_file_chooser_get_filenames(this.getId());
        }
        
        public String  getFileName()
        {
                return GTK.gtk_file_chooser_get_filename(this.getId());
        }
        /**
         *   一个抽象方法 ，要求继承者去实现它
         *   多了一个
         *   
         *   V 可不可以用接口来实现，估计也是一样的下过
         */
        /**
         * 
         * @param ofci  开放了一个OOFileChooserInterface接口，
         *              用于处理打开文件和保存文件，需要进行的额外操作
         */
        public void processResponse(final OOFileChooserInterface ofci)
        {
                ofci.doit();
        }
        /**
         *   默认处理打开的函数的方式，得到文件！！ 显示到textview和treeview交给用户去做
         *   而processSave则交给OOFileChooser的processSave去做
         *   新版本改用OOResponseTyep的类型进行判断
         */
        public String[] processOpen()
        {
                String[] filenames = null;
                // TODO Auto-generated method stub
                OOResponseType ret = this.run();
                //int ret = this.run().getValue();
                if(ret == OOResponseType.OK) 
                {
                        filenames = GTK.gtk_file_chooser_get_filenames(this.getId());
                        for(int i = 0 ; i&amp;lt; filenames.length ; i++)
                        {
                                
                                System.out.println(&amp;quot;选中文件名&amp;quot;+i+&amp;quot;: &amp;quot;+filenames[i]);
                        }
                        //GTK.gtk_widget_destroy(this.getId()); //必须需要！！否则报错
                        this.destroy();
                }else
                {
                        //GTK.gtk_widget_destroy(this.getId());
                        this.destroy();
                }
                return filenames;
        }
        /**
         *   默认处理保存对话框的方式   基本上默认是大部分采用的方式，
         *   保存文件的打开文件流有OOFileChooser去做
         *   
         *   暂时直接接受textview的文本信息，类似的可以使用OOTreeview
         *   
         *   新版本改用OOResponseTyep的类型进行判断
         */
        public void processSave(OOTextView ootv)
        {
                //GTK.gtk_file_chooser_set_do_overwrite_confirmation(this.getId(), true);
                // TODO Auto-generated method stub
                System.out.println(&amp;quot;已进入save&amp;quot;);
                //SaveOneFile(filename,textview);
                OOResponseType ret = this.run();
                //int ret = GTK.gtk_dialog_run(this.getId());
                if(ret == OOResponseType.CANCEL)
                {
                        this.destroy();
                        //GTK.gtk_widget_destroy(this.getId());
                }else 
                {
                        String filename =this.getFileName() ;
                        //保存文件
                        SaveOneFile(filename,ootv);
                        System.out.println(filename);
                        //GTK.gtk_widget_destroy(this.getId());
                        this.destroy();
                        
                }
        }
        
        
        public static void SaveOneFile(String filename, OOTextView ootv)
        {
                try
                (
                        OutputStream os = new FileOutputStream(filename);
                        OutputStreamWriter osw = new OutputStreamWriter(os);
                        BufferedWriter bw = new BufferedWriter(osw);
                )
                {
                        
                        String  temp= filename.substring(filename.lastIndexOf(&#39;\\&#39;)+1);
                        System.out.println(temp);
                        
                        /*int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                        //这是一个空的iter，需要用textBuffer进行赋值
                        int textIter = GTK.gtk_text_iter_new();  
                        
                        GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);
                        // 或者textview的textBuffer的末尾！
                        String tempText = GTK.gtk_text_buffer_get_text(textBuffer);*/
                        
                        //while(tempText != null) // -1读取完毕
                        {
                                //InsertStringToTextViewFunction(textview,fileToFile.toString());
                                bw.write(ootv.getText());
                                bw.newLine();
                        //        GTK.gtk_text_iter_backward_char(textIter);
                        //        tempText = GTK.gtk_text_buffer_get_text(textBuffer);
                        }
                }
                catch(IOException e)
                {
                        System.out.println(&amp;quot;文件读入异常&amp;quot;);
                }
                
        }
        
        
/*        public abstract void processResponse1();  //用于保存
        public abstract String[] processResponse(); //用于打开
*/        /**
         * 
         * @author    叶昭良
         * @time      2015年2月5日下午5:07:17
         * @version   GTKEncapsulateFilter V1.0
         */
        class Filter extends OOWidget
        {
                public Filter()
                {
                        setId(GTK.gtk_file_filter_new());
                }
                /**
                 * 
                 * @param text   设置过滤器的名字
                 */
                public void setFilterName(String text)
                {
                        GTK.gtk_file_filter_set_name(this.getId(), text);
                }
                /**
                 * 
                 * @param pattern  设置过滤器的过滤类型
                 */
                public void addFilterPattern(String pattern)
                {
                        GTK.gtk_file_filter_add_pattern(this.getId(), pattern);
                }
                
                
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;附上 最新版本的封装GTK的源代码： 感兴趣的鹏友，可以下载交流哈。
最新的提交记录：1.修正了OOToolButton 缺少setId的一个重大bug
2.原先的OOFileChooser为抽象类，看起来不爽，于是再给OOFileChooser配置了一个接口和两个默认的处理函数
一个用于打开一个用于关闭
3.修改了项目文件相关的  TestXiaoBingWindow.java  TestNewMenuFourStep.java&lt;br&gt;
4.利用OOResponseTyep的判断方式修改代码
基本测试通过，同时顺便复习了内部类的接口类的实现和在一个类中添加接口的方式。
具体可以参看本贴第一次讲过的关于内部类实现接口的问题包含OODrawCallback和OOTreeView的双击事件的内部类的实现。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>3月21日Java周末班试题收集</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/3yue-21ri-javazhou-mo-ban-shi-ti-shou-ji/</link>
      <pubDate>Mon, 11 May 2015 14:58:41 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/3yue-21ri-javazhou-mo-ban-shi-ti-shou-ji/</guid>
      <description>&lt;p&gt;阶段性考试（考试6个小时，讲评+重写6个小时）
题目1：简述LinkedList和ArrayList的区别是什么？
题目2：简述Java 中Set有哪几种？区别是什么？
题目3：有如下一个类：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;class Person
{
private int age;
private String name;
public void setAge(int age)
{
    this.age = age;
}
public void setName(String name)
{
    this.name = name;
}
public void sayHello()
{
    System.out.println(&amp;quot;你好，我是&amp;quot;+name+&amp;quot;，我&amp;quot;+age+&amp;quot;岁了&amp;quot;);
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;采用反射的方法创建Person类的一个对象，并且通过反射的方法调用setAge、setName进行赋值，并且用反射的方法调用sayHello方法。
记录完成所需要的时长。
题目4：要求用户输入一个email地址，使用正则表达式检查用户输入的是否是合法的email地址，如果是合法的email地址，则把用户名和域名分别输出，比如用户输入yzk@rupeng.com，则输出“用户名为yzk，域名为rupeng.com”；
记录完成所需要的时长。
题目5：创建一个数据库表T_Students，包含Id（主键）、Name（姓名）、Num（学号）三个列。编写一个Socket服务器端，服务器接受如下的Socket指令：
客户端发送“1|学号”（比如&amp;quot;1|a001&amp;quot;），代表客户端要查询指定学号的学生的姓名，服务器端通过JDBC连接数据库进行查询，如果找到了则返回&amp;quot;ok|姓名&amp;quot;（比如&amp;quot;ok|张三&amp;quot;），如果没找到则返回&amp;quot;error|notfound&amp;quot;，如果服务器端查询过程中出现异常等则返回&amp;quot;error|servererror&amp;quot;。
客户端发送&amp;quot;2&amp;quot;，则代表客户端要查询学生总人数，服务器端通过JDBC连接数据库进行查询学生总人数，并且进行返回，比如&amp;quot;ok|30&amp;quot;，如果服务器端查询过程中出现异常等则返回&amp;quot;error|servererror&amp;quot;。
编写Socket客户端对于服务的两个指令进行测试。客户端和服务器端都使用控制台窗口就可以，不用图形界面。
记录完成所需要的时长。&lt;/p&gt;
&lt;p&gt;第一题：
ArrayList 本质数组，优点： 易于获取缺点：不方便插入和删除。
LinkedList本质链表，优点：易于添加和删除。缺点：不方便获取。&lt;/p&gt;
&lt;p&gt;第二题：
Set:HashSet  TreeSet     LinkedHashSet
HashSet的本质是链表数组，实现基于HashMap,速度快
优点：添加和删除效率高
缺点：获取慢（遍历都一样）,只能遍历一遍，Set集合无法直接获取某个元素
TreeSet：二叉树，注意查看root节点（这是二叉树结构的标志）  TreeSet关键是排序！（不是插入 和获取元素）
优点：增加和删除
缺点：获取
但是必须加入计数器也就是实现comparable接口，或者new Comparator
具体参看：http://www.rupeng.com/forum/thread-44838-1-1.html&lt;/p&gt;
&lt;p&gt;LinkedHashSet:是基于HashSet只不过是使得插入获得存在顺序
未做深入研究
第三题：
Person类的设计：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package com.reflect.test;

/**
* @author    叶昭良
* @time      2015年3月21日下午1:42:37
* @version   com.reflect.testPerson1 V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class Person1
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        private int age;

        private String name;

        public void setAge(int age)

        {

            this.age = age;

        }

        public void setName(String name)

        {

            this.name = name;

        }

        public void sayHello()

        {

            System.out.println(&amp;quot;你好，我是&amp;quot;+name+&amp;quot;，我&amp;quot;+age+&amp;quot;岁了&amp;quot;);

        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;测试Person类：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
* 采用反射的方法创建Person类的一个对象，并且通过反射的方法调用setAge、setName进行赋值，并且用反射的方法调用sayHello方法。

记录完成所需要的时长

*/
package com.reflect.test;
import java.lang.reflect.*;
/**
* @author    叶昭良
* @time      2015年3月21日下午1:43:08
* @version   com.reflect.testTestPerson1Reflect V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class TestPerson1Reflect
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Person1 p1 = new Person1();
                Class testClass = p1.getClass();
                try
                {
                        Field nameField  = testClass.getDeclaredField(&amp;quot;name&amp;quot;);
                        Field ageField = testClass.getDeclaredField(&amp;quot;age&amp;quot;);
                        nameField.setAccessible(true);
                        ageField.setAccessible(true);
                        nameField.set(p1, &amp;quot;张三&amp;quot;);
                        ageField.set(p1, 32);
                        System.out.println(&amp;quot;通过对象调用sayHello方法&amp;quot;);
                        p1.sayHello();
                        
                        Method helloSay = testClass.getDeclaredMethod(&amp;quot;sayHello&amp;quot;);
                        System.out.println(&amp;quot;第二种方法打印sayHello&amp;quot;);
                        helloSay.invoke(p1);
                        
                } catch (NoSuchFieldException | SecurityException | IllegalArgumentException | IllegalAccessException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                } catch (NoSuchMethodException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                } catch (InvocationTargetException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第四题：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
* 题目4：要求用户输入一个email地址，使用正则表达式检查用户输入的
* 是否是合法的email地址，如果是合法的email地址，则把用户名和域名
* 分别输出，比如用户输入yzk@rupeng.com，则输出“用户名为yzk，
* 域名为rupeng.com”；
*/
package TestRegex;
import java.util.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
/**
* @author    叶昭良
* @time      2015年3月21日下午1:54:30
* @version   TestRegexTestRegexExam V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class TestRegexExam
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Scanner sc = new Scanner(System.in);
                String temp = null;
                while(true)
                {
                        System.out.println(&amp;quot;请输入一个邮箱地址,比如zhaoturkkey@163.com,退出敲exit|quit&amp;quot;);
                        temp= sc.nextLine();
                        if(temp.equalsIgnoreCase(&amp;quot;exit&amp;quot;)||temp.equalsIgnoreCase(&amp;quot;quit&amp;quot;))
                        {
                                break;
                        }
                        
                        if(temp.matches(&amp;quot;@&amp;quot;))
                        {
                                System.out.println(&amp;quot;你输入的不是正确的邮箱地址！&amp;quot;);
                                continue;
                        }
                        
                        int countAddr = 0;
                        Pattern p1 = Pattern.compile(&amp;quot;@&amp;quot;);
                        Matcher mp = p1.matcher(temp);
                        while(mp.find())
                        {
                                countAddr++;
                        }
                        if(countAddr == 1)
                        {
                                String[] piles = temp.split(&amp;quot;@&amp;quot;);
                                System.out.println(&amp;quot;用户名为&amp;quot;+piles[0]+&amp;quot;  域名为&amp;quot;+piles[1]);
                        }else
                        {
                                System.out.println(&amp;quot;你输入的邮箱有多个@&amp;quot;);
                        }
                        //matches要求整体匹配！
                        System.out.println(&amp;quot;sdfas|fsdfs&amp;quot;.matches(&amp;quot;fsdfs&amp;quot;));
                        String likeType = &amp;quot;23&amp;quot;;
                          String pattern = &amp;quot;[a-zA-Z0-9]*[&amp;quot; + likeType + &amp;quot;]{1}[a-zA-Z0-9]*&amp;quot;;
                          String sourceStr = &amp;quot;adfjaslfj23ldfalsf&amp;quot;;
                             System.out.println(sourceStr.matches(&amp;quot;.*&amp;quot;+likeType+&amp;quot;.*&amp;quot;));
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;请输入一个邮箱地址,比如zhaoturkkey@163.com,退出敲exit|quit
zhaoturkkey@163.com
用户名为zhaoturkkey  域名为163.com
false
true
请输入一个邮箱地址,比如zhaoturkkey@163.com,退出敲exit|quit
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第五题：&lt;/p&gt;
&lt;p&gt;采用ORM的实现
具体查看http://www.rupeng.com/forum/thread-44526-1-1.html
满足ORM的设计条件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;约束条件：主键必须为Id，且是int类型，自动递增&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;        字段名必须和属性名一样   也就是类的属性和表的字段保持一致
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;        表名字和类的名字一样
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Student表的设计：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;create table student(
id int not null auto_increment primary key
name varchar(20) not null default &#39;&#39;,
num varchar(20) not null default &#39;&#39;);


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Student类的设计：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/
package com.introspect.test;

/**
* @author    叶昭良
* @time      2015年3月21日下午2:10:39
* @version   com.introspect.testStudent V1.0
*/
//据说下面是符合javaBeans设计思想的普通类
public class Student
{
        //字段私有化  ，使用BeansInfo必须是用id  name  num而不是id name num
        /*private String id;
        private String name;
        private int num;*/
        
        private int id;
        private String name;
        private String num;
        
        //提供一个无参的构造函数
        public Student()
        {
                
        }
        @Override
        public String toString()
        {
                StringBuilder studentInfo = new StringBuilder();
                studentInfo.append(&amp;quot;学生的id：&amp;quot;).append(id).append(&amp;quot;,姓名:&amp;quot;).append(name).append(
                                &amp;quot;,学号是:&amp;quot;).append(num);
                return studentInfo.toString();
        }        
        public int getid()
        {
                return id;
        }
        public void setid(int id)
        {
                this.id = id;
        }
        public String getname()
        {
                return name;
        }
        public void setname(String name)
        {
                this.name = name;
        }
        public String getnum()
        {
                return num;
        }
        public void setnum(String num)
        {
                
                this.num = num;
        }
}
	```
MyORM的修改
1： 修改select的id变为num即可  修改对应的代码段 
2： 重载select方法   变成只接受一个class的函数，具体如下所示

```java
public static Object select(Class clazz) throws SQLException
        {
                int count = 0;
                //用于数据库表
                String className = clazz.getSimpleName(); 
                StringBuilder sbSQL = new StringBuilder();
                
                //第一步 拼接  insert
                sbSQL.append(&amp;quot;select count(*) tb from &amp;quot;).append(className);
                //获取到 ResultSet
                ResultSet rs = JDBCUtils.executeQuery(sbSQL.toString());
                while(rs.next())
                {
                        count = rs.getInt(&amp;quot;tb&amp;quot;);
                        System.out.println(&amp;quot;总共有&amp;quot;+count+&amp;quot;个数据&amp;quot;);
                }
                
                System.out.println(&amp;quot;成功&amp;quot;);
                return count;
                
                //先非泛型  再泛型的selectById
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最终的MyORM代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
*  对象 Student
*  mysql表   Student
*  
*  类 表对应！  通过对象传递进数组，并利用内省机制，获得类中的所有属性！
*   并获得其中的值，然后组合成为一个sql语句，并执行JDBCUtils 来进行
*   增、删、修改、查等操作
*   
*   目的 ：对象 --mysql表 进行一一对应并且可以进行传递
*   简单的MyOrm.insert(
*              delete
*              select
*              update 等
*         
*    约束条件：主键必须为Id，且是int类型，自动递增
*             字段名必须和属性名一样   也就是类的属性和表的字段保持一致
*             表名字和类的名字一样
*/

package com.introspect.test;
import com.jdbc.test.*;

import java.beans.BeanInfo;
import java.beans.IntrospectionException;
import java.beans.Introspector;
import java.beans.PropertyDescriptor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.*;  //需要存储字段的 list  同时需要存储值的list 
                     // 最后组装成一条mysql语句
/**
* @author    叶昭良
* @time      2015年3月4日下午8:57:46
* @version   com.introspect.testMyORM V1.0
*/
public class MyORM
{

        /**
         * sql = insert into Person(fieldName) values(?,?..)
         *         1                 2             3   4
         *  JDBCUTils.executeUpdate(sql,propValue)
         * @param args
         */
        public static void insert(Object obj) throws SQLException
        {
                Class clazz = obj.getClass();
                BeanInfo beanInfo = null;
                beanInfo = getBeanInfo(clazz);
                
                //用于数据库表
                String className = clazz.getSimpleName(); 
                
                PropertyDescriptor[] pro = beanInfo.getPropertyDescriptors();
                List&amp;lt;String&amp;gt; listFieldName = new ArrayList&amp;lt;String&amp;gt;();
                for(PropertyDescriptor temp:pro)
                {
                        String propName = temp.getName();
                        if(!propName.equals(&amp;quot;id&amp;quot;) &amp;amp;&amp;amp; !propName.equals(&amp;quot;class&amp;quot;)) 
                        {
                                //扣除 id和class这两个内部字段
                                listFieldName.add(propName);
                        }
                }
                
                StringBuilder sbSQL = new StringBuilder();
                
                //第一步 拼接  insert
                sbSQL.append(&amp;quot;insert into &amp;quot;).append(className);

                //第二步 拼接  字段
                String fieldNames = listFieldName.toString();
                sbSQL.append(fieldNames.replace(&#39;[&#39;, &#39;(&#39;).replace(&#39;]&#39;, &#39;)&#39;));
        
                //第三步  拼接  值
                sbSQL.append(&amp;quot; values&amp;quot;);
                
                //第四步  拼接  添加问号
                char[] paramMarkArray  = new char[listFieldName.size()];
                for(int i = 0 ; i &amp;lt; listFieldName.size() ; i++)
                {
                        paramMarkArray[i] = &#39;?&#39;;
                }
                sbSQL.append(Arrays.toString(paramMarkArray).replace(&#39;[&#39;, &#39;(&#39;).replace
                                (&#39;]&#39;, &#39;)&#39;));
                
                //最后一步    调用JDBCUtils的 executeUpdate
                List&amp;lt;Object&amp;gt; paramValues = new ArrayList&amp;lt;Object&amp;gt;();
                for(String propName : listFieldName)
                {
                        PropertyDescriptor propDesc = findPropertyDescriptor(propName, pro);
                        Object propValue =null;
                        //obj传入的类或者表名的对象
                        propValue = invoke(propDesc, obj);
                        paramValues.add(propValue);
                }
                //最终过程  toString  toArray的转换
                JDBCUtils.executeUpdate(sbSQL.toString(), paramValues.toArray());
                
        }
        /**
         * 
         * @param clazz
         * @return  返回一个beanInfo对象
         */
        private static BeanInfo getBeanInfo(Class clazz)
        {
                BeanInfo beanInfo = null;
                try
                {
                        beanInfo = Introspector.getBeanInfo(clazz);
                }catch(IntrospectionException e)
                {
                        throw new RuntimeException(&amp;quot;内省出错！&amp;quot;+e.getMessage());
                }
                return beanInfo;
        }
        /**
         *  从propDesc中找名字为propName的PropertyDescriptor
         * @param propName
         * @param prop
         * @return
         */
        private static PropertyDescriptor findPropertyDescriptor(String propName,
                        PropertyDescriptor[] prop)
        {
                for(PropertyDescriptor temp : prop)
                {
                        if(temp.getName().equals(propName))
                        {
                                return temp;
                        }
                }
                return null;
        }
        /**
         *  执行某个字段的读方法  并返回 propValue
         * @param propDesc
         * @param obj
         * @return
         */
        private static Object invoke(PropertyDescriptor propDesc,Object obj)
        {
                Object propValue = null;

                try
                {
                        propValue = propDesc.getReadMethod().invoke(obj);
                } catch (IllegalAccessException | IllegalArgumentException
                                | InvocationTargetException e)
                {
                        // TODO Auto-generated catch block
                        throw new RuntimeException(&amp;quot;获取&amp;quot;+propDesc.getName()+&amp;quot;错误&amp;quot;);
                }
                return propValue; 
        }
        //------------------------insert 程序 结束----------------
        /**
         * delete from className where id = ?
         * 
         * 
         *   删除clazz对应表中的字段id为id的值   delete(Person.class,5);
         * @param clazz
         * @param id
         */
        public static void delete(Class clazz, int id) throws SQLException
        {
                BeanInfo beanInfo = null;
                beanInfo = getBeanInfo(clazz);
                
                //用于数据库表
                String className = clazz.getSimpleName(); 
                
                PropertyDescriptor[] pro = beanInfo.getPropertyDescriptors();
                List&amp;lt;String&amp;gt; listFieldName = new ArrayList&amp;lt;String&amp;gt;();
                
                
                StringBuilder sbSQL = new StringBuilder();
                
                //第一步 拼接  insert
                sbSQL.append(&amp;quot;delete from &amp;quot;).append(className).append(&amp;quot; where id = ?&amp;quot;);
                
                JDBCUtils.executeUpdate(sbSQL.toString(), id);
                
        }
        
        
        /**
         * select * from Person where id = 2;
         * 
         *   获取clazz对应表中id为字段为id的对应航的   并且填充到对象中
         *   Person p1 = (Person)select(Person.class,2)
         *   p1.getName(), p1.getAge();
         * @param clazz
         * @param id
         * @return
         */
        //----------------------delete 程序结束--------------------
        public static Object select(Class clazz,String num) throws SQLException
        {
                Object b1 = null;
                b1 = getInstance(clazz);
                
                BeanInfo beanInfo = null;
                beanInfo = getBeanInfo(clazz);
                
                //用于数据库表
                String className = clazz.getSimpleName(); 
                
                PropertyDescriptor[] pro = beanInfo.getPropertyDescriptors();
                List&amp;lt;String&amp;gt; listFieldName = new ArrayList&amp;lt;String&amp;gt;();
                for(PropertyDescriptor temp:pro)
                {
                        String propName = temp.getName();
                        if(!propName.equals(&amp;quot;id&amp;quot;) &amp;amp;&amp;amp; !propName.equals(&amp;quot;class&amp;quot;)) 
                        {
                                //扣除 id和class这两个内部字段
                                listFieldName.add(propName);
                        }
                }
                
                StringBuilder sbSQL = new StringBuilder();
                
                //第一步 拼接  insert
                sbSQL.append(&amp;quot;select * from &amp;quot;).append(className).append(&amp;quot; where num = ?&amp;quot;);
                //获取到 ResultSet
                ResultSet rs = JDBCUtils.executeQuery(sbSQL.toString(), num);
                if(!rs.next())
                {
                        System.out.println(&amp;quot;当前版本没有&amp;quot;+num+&amp;quot;的信息&amp;quot;);
//                        return;
                }else
                {
                        System.out.println(&amp;quot;当前版本有&amp;quot;+num+&amp;quot;的信息&amp;quot;);
                        for(String propName : listFieldName)
                        {
                                PropertyDescriptor propDesc = findPropertyDescriptor(propName, pro);
                                //obj传入的类或者表名的对象
                                invoke(propDesc, b1,rs.getObject(propName));
                                //invoke(propDesc, b1,rs.getString(propName));
                        }
                }
                //设置num字段
                PropertyDescriptor propDesc1 = findPropertyDescriptor(&amp;quot;num&amp;quot;, pro);
                invoke(propDesc1, b1,num);
                System.out.println(&amp;quot;成功&amp;quot;);
                return b1;
                
                //先非泛型  再泛型的selectById
        }
        
        public static Object select(Class clazz) throws SQLException
        {
                int count = 0;
                //用于数据库表
                String className = clazz.getSimpleName(); 
                StringBuilder sbSQL = new StringBuilder();
                
                //第一步 拼接  insert
                sbSQL.append(&amp;quot;select count(*) tb from &amp;quot;).append(className);
                //获取到 ResultSet
                ResultSet rs = JDBCUtils.executeQuery(sbSQL.toString());
                while(rs.next())
                {
                        count = rs.getInt(&amp;quot;tb&amp;quot;);
                        System.out.println(&amp;quot;总共有&amp;quot;+count+&amp;quot;个数据&amp;quot;);
                }
                
                System.out.println(&amp;quot;成功&amp;quot;);
                return count;
                
                //先非泛型  再泛型的selectById
        }
        private static Object getInstance(Class clazz)
        {
                Object b1 = null;
                try
                {
                        b1 = clazz.newInstance();
                } catch (InstantiationException | IllegalAccessException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
                return b1;
        }
        //private static void invoke(PropertyDescriptor propDesc,Object obj,String value)
        
        private static void invoke(PropertyDescriptor propDesc,Object obj,Object value)
        {

                //有问题 因为
                /*try
                {
                        propDesc.getWriteMethod().invoke(obj,value);
                } catch (IllegalAccessException | IllegalArgumentException
                                | InvocationTargetException e)
                {
                        // TODO Auto-generated catch block
                        throw new RuntimeException(&amp;quot;获取&amp;quot;+propDesc.getName()+&amp;quot;错误&amp;quot;);
                } */
                try
                {
                        Method methodSet= propDesc.getWriteMethod();
                        if(methodSet !=null)
                        {
                                methodSet.invoke(obj,value);
                        }
                        
                } catch (IllegalAccessException | IllegalArgumentException
                                | InvocationTargetException e)
                {
                        // TODO Auto-generated catch block
                        throw new RuntimeException(&amp;quot;获取&amp;quot;+propDesc.getName()+&amp;quot;错误&amp;quot;);
                } 
        }
        
        //------------------select 结束------------------
        
        // update Person set age=&#39;&#39; where id=4;
        
        /**
         *   设置id= id的对象 ， 他的年龄为。。。 也可以名字 ，具体修改update 语句
         * @param clazz
         * @param newValue    设置年龄的新值
         * @param id          设置某个id
         * @throws SQLException
         */
        public static void update(Class clazz,Object newValue,int id) throws SQLException
        {
                BeanInfo beanInfo = null;
                beanInfo = getBeanInfo(clazz);
                
                //用于数据库表
                String className = clazz.getSimpleName(); 
                
                PropertyDescriptor[] pro = beanInfo.getPropertyDescriptors();
                List&amp;lt;String&amp;gt; listFieldName = new ArrayList&amp;lt;String&amp;gt;();
                for(PropertyDescriptor temp:pro)
                {
                        String propName = temp.getName();
                        if(!propName.equals(&amp;quot;id&amp;quot;) &amp;amp;&amp;amp; !propName.equals(&amp;quot;class&amp;quot;)) 
                        {
                                //扣除 id和class这两个内部字段
                                listFieldName.add(propName);
                        }
                }
                
                StringBuilder sbSQL = new StringBuilder();
                
                //第一步 拼接  insert
                //可以设置 update 那个字符串  比如 String temp = &amp;quot;age&amp;quot;
                sbSQL.append(&amp;quot;update &amp;quot;).append(className).append(&amp;quot; set age = &amp;quot;).append(newValue).append(&amp;quot;&amp;quot;
                                + &amp;quot; where id = ?&amp;quot;);
                JDBCUtils.executeUpdate(sbSQL.toString(), id);
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;关于JDBCUtils的片段：请参考http://www.rupeng.com/forum/thread-44526-1-1.html
测试新版本MyORM的有效性&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package com.introspect.test;

import java.sql.SQLException;

/**
* @author    叶昭良
* @time      2015年3月21日下午2:21:40
* @version   com.introspect.testFifthExam V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class FifthExam
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Student s1 = new Student();
                //插入数据
/*                s1.setname(&amp;quot;zhaoliang&amp;quot;);
                s1.setnum(&amp;quot;a001&amp;quot;);*/
/*                s1.setname(&amp;quot;xinran&amp;quot;);
                s1.setnum(&amp;quot;a002&amp;quot;);*/
/*                s1.setname(&amp;quot;liming&amp;quot;);
                s1.setnum(&amp;quot;a003&amp;quot;);*/
                s1.setname(&amp;quot;wanglei&amp;quot;);
                s1.setnum(&amp;quot;a004&amp;quot;);
                try
                {
                        //插入数据部分
                        //MyORM.insert(s1);
                        //测试查询第一部分
                        System.out.println(MyORM.select(Student.class));
                        
                        //测试查询第二部分
                        //s1= (Student)MyORM.select(Student.class,&amp;quot;a001&amp;quot;);
                        //s1= (Student)MyORM.select(Student.class,&amp;quot;a002&amp;quot;);
                        System.out.println(s1.toString());
                } catch (SQLException e)
                {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果很好，并插入数据到了表中&lt;/p&gt;
&lt;p&gt;紧接着进行网络编程   Server端和Client段，参考了我的复习笔记的http://www.rupeng.com/forum/thread-44838-1-1.html网络编程部分 ，针对Server的主要修改部分是ServerRead, 从客户端读取的字符串，需要进行两个判断  1：  1|a001     如何是这种情况  则使用MyORM.select(Student.class,num)         2: 2  如果输入的是一个2,则使用 MyORM.select(Student.class)返回总共的学生数 ，Server端代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package com.introspect.test;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Font;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.ServerSocket;
import java.net.Socket;

import javax.swing.JOptionPane;
import javax.swing.UIManager;


/**
* @author    叶昭良
* @time      2015年3月21日下午2:56:04
* @version   com.introspect.testTestExamServer V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class TestExamServer
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                // TODO Auto-generated method stub
                Font font = new Font(&amp;quot;Dialog&amp;quot;, Font.PLAIN, 12); //一下是改变默认的组建上显示的字体，这样更加美观一些
                UIManager.put(&amp;quot;MenuBar.font&amp;quot;, font);
                UIManager.put(&amp;quot;MenuItem.font&amp;quot;, font);
                UIManager.put(&amp;quot;Menu.font&amp;quot;, font);
                UIManager.put(&amp;quot;PopupMenu.font&amp;quot;, font);
                UIManager.put(&amp;quot;ToolBar.font&amp;quot;, font);
                UIManager.put(&amp;quot;ToolTip.font&amp;quot;, font);
                UIManager.put(&amp;quot;TabbedPane.font&amp;quot;, font);
                UIManager.put(&amp;quot;Label.font&amp;quot;, font);
                UIManager.put(&amp;quot;List.font&amp;quot;, font);
                UIManager.put(&amp;quot;ComboBox.font&amp;quot;, font);
                UIManager.put(&amp;quot;Button.font&amp;quot;, font);
                UIManager.put(&amp;quot;Table.font&amp;quot;, font);
                UIManager.put(&amp;quot;TableHeader.font&amp;quot;, font);
                UIManager.put(&amp;quot;Tree.font&amp;quot;, font);
                UIManager.put(&amp;quot;TextField.font&amp;quot;, font);
                UIManager.put(&amp;quot;TextArea.font&amp;quot;, font);
                UIManager.put(&amp;quot;TitledBorder.font&amp;quot;, font);
                UIManager.put(&amp;quot;OptionPane.font&amp;quot;, font);
                UIManager.put(&amp;quot;RadioButton.font&amp;quot;, font);
                UIManager.put(&amp;quot;CheckBox.font&amp;quot;, font);
                UIManager.put(&amp;quot;ToggleButton.font&amp;quot;, font);
                UIManager.put(&amp;quot;Dialog.font&amp;quot;, font);
                UIManager.put(&amp;quot;Panel.font&amp;quot;, font);
                 new TCPServer().launch();
        }

}


class TCPServer
{
        // class variables
        // class variables
        // connect
         private ServerSocket ss = null;
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private Frame f = null;
         private TextArea ta = null;
         private TextField tf = null;
         private Button  bn = null;

       
         public void launch()
         {
             createUI();
             connect();
             new ServerRead().start();
             new ServerWrite().start();
         }
        // construct member
        /*
        public TCPServer()
        {

        }
        */
        public void createUI()
        {
            Frame f = new Frame(&amp;quot;服务器&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        public void connect()
        {
            try{
                ss = new ServerSocket(5599);
                s = ss.accept();
                dis = new DataInputStream(s.getInputStream());
                dos = new DataOutputStream(s.getOutputStream());
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
        public void close()
        {
            try{
                dis.close();
                dos.close();
                ss.close();
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }

        class ServerRead extends Thread
        {
            public void run()
            {
                while(true)
                {
                   try{
                        String str = dis.readUTF();
              //          System.out.println(&amp;quot;对方说:&amp;quot;+str);
                        ta.append(&amp;quot;客户端说：&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                        if(str.matches(&amp;quot;.*\\|.*&amp;quot;))
                        {
                                System.out.println(&amp;quot;的确存在&amp;quot;);
                                String[] piles = str.split(&amp;quot;[|]&amp;quot;);
                                Student s1 = (Student)MyORM.select(Student.class, piles[1]);
                                ta.append(&amp;quot;str的姓名是:&amp;quot;+s1.getname());
                        }
                        if(str.matches(&amp;quot;2&amp;quot;))
                        {
                                ta.append(&amp;quot;服务器对客户端说：总共有&amp;quot;+MyORM.select(Student.class)+&amp;quot;个学生\n&amp;quot;); 
                        }
                   }catch(Exception e)
                   {
                       JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
                       return;
                   //    e.printStackTrace();
                   }
                }
            }
        }
        class ServerWrite extends Thread
        {
            public void run()
            {
                tf.addActionListener(new TCPServerListener());
                bn.addActionListener(new TCPServerListener());
            }
        }
        class TCPServerListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                        String str = tf.getText();
                        tf.setText(&amp;quot;&amp;quot;);
                        ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client端代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 解释：
*/
package com.introspect.test;

import java.awt.BorderLayout;
import java.awt.Button;
import java.awt.Font;
import java.awt.Frame;
import java.awt.Panel;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.Socket;

import javax.swing.JOptionPane;
import javax.swing.UIManager;


/**
* @author    叶昭良
* @time      2015年3月21日下午2:56:17
* @version   com.introspect.testTestExamClient V1.0
* 功能： 
                步骤：
* 注意：
* 掌握：
                思考：
* 回顾：
*/
public class TestExamClient
{

        /**
         * @param args 
         * 原因：
         * 解决：
         * 功能：
         *       思考：        
         *       步骤：
         */
        public static void main(String[] args)
        {
                // TODO Auto-generated method stub
                Font font = new Font(&amp;quot;Dialog&amp;quot;, Font.PLAIN, 12); //一下是改变默认的组建上显示的字体，这样更加美观一些
                UIManager.put(&amp;quot;MenuBar.font&amp;quot;, font);
                UIManager.put(&amp;quot;MenuItem.font&amp;quot;, font);
                UIManager.put(&amp;quot;Menu.font&amp;quot;, font);
                UIManager.put(&amp;quot;PopupMenu.font&amp;quot;, font);
                UIManager.put(&amp;quot;ToolBar.font&amp;quot;, font);
                UIManager.put(&amp;quot;ToolTip.font&amp;quot;, font);
                UIManager.put(&amp;quot;TabbedPane.font&amp;quot;, font);
                UIManager.put(&amp;quot;Label.font&amp;quot;, font);
                UIManager.put(&amp;quot;List.font&amp;quot;, font);
                UIManager.put(&amp;quot;ComboBox.font&amp;quot;, font);
                UIManager.put(&amp;quot;Button.font&amp;quot;, font);
                UIManager.put(&amp;quot;Table.font&amp;quot;, font);
                UIManager.put(&amp;quot;TableHeader.font&amp;quot;, font);
                UIManager.put(&amp;quot;Tree.font&amp;quot;, font);
                UIManager.put(&amp;quot;TextField.font&amp;quot;, font);
                UIManager.put(&amp;quot;TextArea.font&amp;quot;, font);
                UIManager.put(&amp;quot;TitledBorder.font&amp;quot;, font);
                UIManager.put(&amp;quot;OptionPane.font&amp;quot;, font);
                UIManager.put(&amp;quot;RadioButton.font&amp;quot;, font);
                UIManager.put(&amp;quot;CheckBox.font&amp;quot;, font);
                UIManager.put(&amp;quot;ToggleButton.font&amp;quot;, font);
                UIManager.put(&amp;quot;Dialog.font&amp;quot;, font);
                UIManager.put(&amp;quot;Panel.font&amp;quot;, font);
                 new TCPClient().launch();
        }

}

class TCPClient
{
        // class variables
        // class variables
        // connect
         private Socket s = null;
         // data flow
         private DataOutputStream dos = null;
         private DataInputStream dis = null;
         // UI
         private Frame f = null;
         private TextArea ta = null;
         private TextField tf = null;
         private Button  bn = null;

       
         public void launch()
         {
             createUI();
             connect();
             new ClientRead().start();
             new ClientWrite().start();
         }
        // construct member
        /*
        public TCPClient()
        {

        }
        */
        public void createUI()
        {
            Frame f = new Frame(&amp;quot;客户端&amp;quot;);
            ta = new TextArea();
            tf = new TextField();
            Panel p = new Panel(new BorderLayout());
            bn = new Button(&amp;quot;发送&amp;quot;);
            p.add(tf,BorderLayout.CENTER);
            p.add(bn,BorderLayout.EAST);

            f.add(ta,BorderLayout.CENTER);
            f.add(p,BorderLayout.SOUTH);

            f.setSize(400,200);
            f.setVisible(true);
            //f.setVisable(true);
            f.addWindowListener(new WindowAdapter()
                    {
                        public void windowClosing(WindowEvent e)
                        {
                            System.exit(0);
                        }
                    });
        }
        public void connect()
        {
            try{
                s = new Socket(&amp;quot;127.0.0.1&amp;quot;,5599);
                dis = new DataInputStream(s.getInputStream());
                dos = new DataOutputStream(s.getOutputStream());
            }catch(Exception e)
            {
                System.exit(0);
            }
        }
        public void close()
        {
            try{
                dis.close();
                dos.close();
                s.close();
            }catch(Exception e)
            {
                System.exit(0);
            }
        }

        class ClientRead extends Thread
        {
            public void run()
            {
                while(true)
                {
                   try{
                        String str = dis.readUTF();
                   //     System.out.println(&amp;quot;对方说:&amp;quot;+str);
                        ta.append(&amp;quot;服务器说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e)
                   {
                       JOptionPane.showMessageDialog(f,&amp;quot;客户端已离开&amp;quot;);
                       return;
                   //    e.printStackTrace();
                   }
                }
            }
        }
        class ClientWrite extends Thread
        {
            public void run()
            {
                tf.addActionListener(new TCPClientListener());
                bn.addActionListener(new TCPClientListener());
            }
        }
        class TCPClientListener implements ActionListener
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                   try{
                        String str = tf.getText();
                        tf.setText(&amp;quot;&amp;quot;);
                        ta.append(&amp;quot;客户端说:&amp;quot;+str+&amp;quot;\n&amp;quot;);
                        dos.writeUTF(str);
                        if(str.equalsIgnoreCase(&amp;quot;再见&amp;quot;))
                        {
                            close();
                            System.exit(0);
                        }
                   }catch(Exception e1)
                   {
                      // e.printStackTrace();
                      System.exit(0);
                   } 
            }
        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/kehuduan.png&#34; alt=&#34;客户端读取服务器段数据库的学生信息&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>1月25日Java班笔记试题</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-25ri-javaban-bi-ji-shi-ti/</link>
      <pubDate>Mon, 11 May 2015 14:58:40 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-25ri-javaban-bi-ji-shi-ti/</guid>
      <description>&lt;p&gt;一、IO基础
1.File在Java中，既可以表示文件，也可以表示目录。可以通过File对象来判定文件是否可读，可写，存在等。
2.File对象的mkdirs()推荐使用这个方法，此方法可以创建多层次的目录。而mkdir()只能一层一层创建。
3.File的createNewfile()是创建的文件。
4.File的delete()删除的File的构造函数String的那最后的一级，如果是文件，可以删除。如果是目录，需要这个目录是空的才能够删除。
5.File的listFiles()返回的是File构造函数指定路径下的所有File对象，包括了目录，也包括了文件。
6.File的静态方法，listRoots()可以获取所有的盘符。
7.OutputStream和InputStream都是字节流。
8.以后对于流的关闭等操作，还是使用JDK1.6的形式。1.7的怕以后公司不用。
9.NullPointerException是空指针异常。
10.当通过InputStream的read()方法读取值的时候他是一个byte一个byte的读取的，所以对于汉字读取会出现乱码。
11.java中数字是1个byte，汉字和汉字标点是2个byte。
12.可以通过System.currentTimMillis()来获取1970年1月1日到现在的毫秒数。
13.在Java中，字节流的读取推荐使用read方法，对于read方法，是把一个流的内容读取到byte[] 这种缓冲区中。且如果读取到了最后，返回值是-1.C#是0.所以如果使用do-while需要判定下！
14.缓冲区也不是越大越好！一般来说1M就够了！1024*1024
15.closeable为哪些可以关闭流的接口。所以封装finally中的close方法的时候，可以使用closeable的多态来表示完成。
16.对于output流，不用写创建一个File。会自动覆盖。
17.对于InputStream每次读取的是一个byte，就是一个byte一个byte的读，本质来说，其实是非常费时间的。
18.FileInputStream在read到最后返回值是-1.如果不是-1的话，那么返回值为int。int代表的是ASCII(?)的char。所以强制转成char就可以获取汉字。
19.InputStream在读取汉字的时候，内部是在做判定的，本质来说他也是一个byte一个byte的在读，但是没读取一个byte，他会判定是否是中文特征码，如果是那么会在读下一个byte。合起来返回一个char。
20.为了规避乱码问题，用什么编码来写，就用什么编码来读。
21.ANSI编码不是一种真正意义上的编码，而是根据不同的操作系统来设定不同的编码。就是default编码。
22.关于字符串编码的设置是在InputStreamReader或者OutputStreamWriter中。
23.在关闭流的时候，推荐从外到内依次关闭。
24.BufferedReader读取到最后，返回时是null。
25.获取默认编码的2个方法 System.getProperty(&amp;ldquo;file.encoding&amp;rdquo;)  还有一个是 Charset.defaultCharset().toString()&lt;/p&gt;
&lt;ol start=&#34;26&#34;&gt;
&lt;li&gt;文件夹的遍历  可以通过listFiles(), 如果是文件夹，则递归调用该定义方法
27.BufferedReader 需要一个Reader对象充当其参数，一般是InputStreamReader, 而InputStreamReader又需要一个InputStream（抽象方法不能new处对象）类的对象，一般采用InputStream的子类FileInputStream，类似的BufferedWriter
28.通过创建Properties对象可以载入项目的配置文件。一般有两种方法载入文件 ，1是 直接通过项目文件载入 调用当前类的getClass方法，并接着调用getResourceAsStream载入文件流  ，通过Properites对象的load方法载入 。（得写好b.properties的路径  com/rupeng/b.properties 表示在com.rupeng这个包下的b.properties文件） 2 直接通过FileInputStream创建一个文件流，然后再用Properties对象的load方法载入。两者区别未知，效果一样。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;CommonsIO的学习
统一说明：
import org.apache.commons.io.IOUtils; // 加载类库
import org.apache.commons.io.FilesUtils; // 加载类库&lt;/p&gt;
&lt;p&gt;1： IOUtils
案例1：从一个URL中读取字节并打印
主要代码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;InputStream in = null;
                try
                {
                        in = new URL(&amp;quot;http://www.rupeng.com&amp;quot;).openStream();
                        System.out.println(IOUtils.toString(in,&amp;quot;utf-8&amp;quot;));
                } catch (MalformedURLException e)
                {
                        // TODO 自动生成的 catch 块
                        
                } catch (IOException e)
                {
                        // TODO 自动生成的 catch 块
                        e.printStackTrace();
                }finally
                {
                        IOUtils.closeQuietly(in);
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在大多数的运用领域，上述的CommonsIO操作是非常常见的，并且会节省很多的时间。对于工具代码，比如IOUtils,灵活性和速度
占据主要的作用。然而，在使用过程中也需要注意他的缺点，比如如果使用上述的技术读取一个1GB的大文件，将导致产生一个
1GB的字符串对象。&lt;/p&gt;
&lt;p&gt;案例2:复制文件
主要代码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;                try
                {
                        fis = new FileInputStream(&amp;quot;e://a.txt&amp;quot;);
                        fos = new FileOutputStream(&amp;quot;e://acopyByStream.txt&amp;quot;);
                        IOUtils.copy(fis, fos); // 把e盘下的a.txt复制到e://的acopyByStream.txt
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2：FileUtils
案例1：复制url内容链接到文件
主要代码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;URL url1 = null;
                File newFile = new File(&amp;quot;e://rupeng.html&amp;quot;);
                try
                {
                        url1  = new URL(&amp;quot;http://www.rupeng.com&amp;quot;);
                        FileUtils.copyURLToFile(url1, newFile); //把如鹏网首页写入e盘下的rupeng.html
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例2：复制文本、文件夹
主要代码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;                // TODO 自动生成的方法存根
                File input = new File(&amp;quot;e://a.txt&amp;quot;);
                File output = new File(&amp;quot;e://acopy.txt&amp;quot;);
                File Input1 = new File(&amp;quot;e://a&amp;quot;);  //文件夹
                File Output1 = new File(&amp;quot;e://TestFile&amp;quot;);//文件夹
                String loveWord = &amp;quot;love you,my girl&amp;quot;;
                
                try
                {
                        //FileUtils.cleanDirectory(readyToDeleteDir); // 保留文件夹
                        System.out.println(&amp;quot;目录e://a的大小：&amp;quot;+FileUtils.sizeOfDirectory(readyToDeleteDir)/1024.0+&amp;quot;KB&amp;quot;);
                        //FileUtils.deleteDirectory(readyToDeleteDir); // 连文件夹多没有
                        FileUtils.copyFile(input, output);  //复制文件
                        FileUtils.copyDirectory(Input1, Output1); //复制文件夹
                        FileUtils.copyFileToDirectory(input, Output1); //复制文件到文件夹
                        FileUtils.writeStringToFile(output, loveWord, true); // 追加写入
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;IOUtils是采用流方式进行复制，FileUtils把文本文件作为参数（省去中间流的创建，估计有）&lt;/p&gt;
&lt;p&gt;3：Directory-walker
DirectoryWalker 是一个抽象类，无法直接创建对象。通过创建一个继承类，并实现类中的抽象方法。
案例1：递归删除某个文件夹下的文件
全部代码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import java.io.*;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Iterator;
import java.util.List;

import org.apache.commons.io.DirectoryWalker;
public class TestCommonIODiretoryWalk extends DirectoryWalker
{

        /**
         * @param args
         */
        public TestCommonIODiretoryWalk() 
        {
                     super();
    }
        public List reName(File startDirectory) 
        {
                List results = new ArrayList();
                try
                {
                        walk(startDirectory,results        );
                } catch (IOException e)
                {
                        // TODO 自动生成的 catch 块
                        e.printStackTrace();
                }
                return results;
        }
        
        protected boolean handleDirectory(File directory,int depth,Collection results)
        {
                //save.svn directories and then skip 不会删除.svn文件夹下的任何信息
                if(&amp;quot;fasf&amp;quot;.equals(directory.getName())) // 如果你想要保存某个文件夹
                                                        //就添加elseif即可！！当然文件架构还在
                {
                        directory.delete();
                        return false;
                }else
                {
                        return true;
                }
        }
        
        protected void handleFile(File file,int depth, Collection results)
        {
                file.delete();
                results.add(file);
        }
        // 使用Directory Walker来遍历一个目录并进行相应操作步骤如下
        // 1:创建一个继承DirectoryWalker的类，并在构造函数调用super()
        // 2:定义一个业务入口方法，比如clean，这个方法调用walk方法
        // 3:重写handleDiretory方法  提供相应的业务逻辑
        // 4:重写handleFile方法，提供相应处理逻辑
        
        // 其中最为关键的是walk方法，该方法制定入口路径，
        // 并提供一个用于接受处理结构的参数。
        // 在walk方法的内部：针对目录对象调用handleDirectory
        //                       文件对象调用handleFile
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                TestCommonIODiretoryWalk dw = new TestCommonIODiretoryWalk() ;
                List l1 = dw.reName(new File(&amp;quot;e://b&amp;quot;));
                Iterator it = l1.iterator();
                while(it.hasNext())
                {
                        System.out.println(it.next());
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;案例2：修改一个文件加下的所有以txt结尾的修改为doc结尾的
主要代码：（基本上 框架类似于案例1  主要修改handleFile的子程序 其他地方不需要怎么修改）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void handleFile(File file,int depth, Collection results)
        {
                String banana = file.getName();
                String newFilename= file.getParent()+File.separator+banana.replaceAll(&amp;quot;.txt&amp;quot;+&amp;quot;[        DISCUZ_CODE_5        ]quot;, &amp;quot;.doc&amp;quot;);
                file.renameTo(new File(newFilename));
                results.add(file);
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4.Filters
过滤器：过滤在这边的意思是指保留那些满足某个条件的文件(而不是取消）
Org.apache.commons.io.filefilter 包定义了一个接口（IOFileFilter）用于连接java.io.FileFilter和java.io.FilenameFilter.除了这个之外，包中提供了一系列可以使用的IOFileFilter接口的实现，包括允许你连接其他过滤器的实现。这些过滤器可以被用于列出文件或者在FileDialog
全部代码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import java.io.File;
import java.io.FilenameFilter;

import org.apache.commons.io.filefilter.SuffixFileFilter;
import org.apache.commons.io.filefilter.IOFileFilter;
import org.apache.commons.io.filefilter.NotFileFilter;
import org.apache.commons.io.filefilter.OrFileFilter;
import org.apache.commons.io.filefilter.AndFileFilter;
import org.apache.commons.io.filefilter.DirectoryFileFilter;

import java.io.*;
public class TestCommonIOgetTxtFiles
{

        /**
         * @param args
         */        
public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                
                File rootDir = new File(&amp;quot;e://&amp;quot;);
                // 列出所有的java结尾的所有文件（当前目录）
                // SuffixFileFilter的使用，定义了一个FilenameFilter接口
                FilenameFilter fileFilter = new SuffixFileFilter(&amp;quot;.java&amp;quot;); // 满足.java结尾的文件，这也正好符合过滤在当前情况下的定义。
                String[] txtFiles = rootDir.list(fileFilter);
                for(int i = 0 ; i &amp;lt; txtFiles.length; i++)
                {
                        System.out.println(rootDir+File.separator+txtFiles[i]);
                }
                // 列出所有的html和htm的文件（在当前文件目录下）
                // IOFileFilter、OrFileFilter、NotFileFilter、AndFileFilter的使用（and or 逻辑）
                IOFileFilter htmlFilter =   // 定义了一个IOFileFilter接口接口
                                new OrFileFilter(new SuffixFileFilter(&amp;quot;.html&amp;quot;),new SuffixFileFilter(&amp;quot;.htm&amp;quot;));  // 为什么有时候用IOFileFilter 而有时候用FilenameFilter?
                IOFileFilter notDirectory = new NotFileFilter(DirectoryFileFilter.INSTANCE);
                // 拒绝选择目录
                FilenameFilter fileFilter1= new AndFileFilter(htmlFilter,notDirectory); // 利用AndFileFilter连接两个过滤器接口
                File[] htmlfiles = rootDir.listFiles(fileFilter1);
                for(int i = 0; i&amp;lt; htmlfiles.length; i++)
                {
                        System.out.println(htmlfiles[i]);
                }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;代码说明：
接口是一个更高级别的类，所以可以定义类型变量。具体看filename.gif&lt;/p&gt;
&lt;p&gt;案例2： 当前文件夹下的一天前的所有文件
AgeFileFilter : 通过一个cutoff截止时间来过滤文件，可以过滤出更新的 更旧的 或者就是某一个时间点的信息。
比如下面的  打印所有当前文件夹内的早于一天前创建的文件和文件夹
主要代码：
查看主要代码的图片。&lt;/p&gt;
&lt;p&gt;案例3： 获取文件夹下的可读 可写   目录文件（普通文件类似） 空文件  隐藏文件
说明：最好是在打印时候(for 循环)加上异常的判断（NullPointerException)
主要代码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import org.apache.commons.io.filefilter.CanReadFileFilter;
import org.apache.commons.io.filefilter.CanWriteFileFilter;
import org.apache.commons.io.filefilter.DirectoryFileFilter;
import org.apache.commons.io.filefilter.EmptyFileFilter;
import org.apache.commons.io.filefilter.HiddenFileFilter;
                // TODO 自动生成的方法存根
                 File dirBanana = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesBanana = dirBanana.list(CanReadFileFilter.CAN_READ);
                 for(int i = 0; i &amp;lt; filesBanana.length; i++)
                 {
                         System.out.println(&amp;quot;Banana可读文件:&amp;quot;+filesBanana[i]);
                 }
                 System.out.println(&amp;quot;分割线--------------------------&amp;quot;);
                 File dirOrange = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesOrange = dirOrange.list(CanReadFileFilter.READ_ONLY);
                 for(int i = 0; i &amp;lt; filesOrange.length; i++)
                 {
                         System.out.println(&amp;quot;Orange只读文件:&amp;quot;+filesOrange[i]);
                 }
                 
                 System.out.println(&amp;quot;分割线--------------------------&amp;quot;);
                 File dirApple = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesApple = dirApple.list(CanReadFileFilter.CANNOT_READ);
                 if(filesApple.length == 0)
                 {
                          System.out.println(&amp;quot;Apple未找到不可读文件&amp;quot;);
                 }else
                 {
                         for(int i = 0; i &amp;lt; filesApple.length; i++)
                         {
                                 System.out.println(&amp;quot;Apple不可读文件:&amp;quot;+filesApple[i]);
                         }
                 }
                 
                 
                 File dirEgg = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesEgg = dirEgg.list(CanWriteFileFilter.CAN_WRITE);
                 for(int i = 0 ; i &amp;lt; filesEgg.length; i++)
                 {
                         System.out.println(&amp;quot;Egg 找到了可写文件:&amp;quot;+filesEgg[i]);
                 }
                 
                 File dirChichen = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesChichen = dirChichen.list(CanWriteFileFilter.CANNOT_WRITE);
                 for(int i = 0 ; i &amp;lt; filesChichen.length; i++)
                 {
                         System.out.println(&amp;quot;Chichen 找到了不可写文件:&amp;quot;+filesChichen[i]);
                 }
                 
                 File dirDirectory = new File(&amp;quot;E:\\&amp;quot;);
                 String[] filesDirectory = dirDirectory.list(DirectoryFileFilter.INSTANCE);
                 for(int i = 0; i &amp;lt; filesDirectory.length; i++)
                 {
                         System.out.println(&amp;quot;列出所有E盘下的文件夹名字:&amp;quot;+filesDirectory[i]);
                 }
                 
                 File dirEmpty = new File(&amp;quot;E:\\&amp;quot;);
                 String[] filesEmpty = dirEmpty.list(EmptyFileFilter.EMPTY);
                 for(int i = 0; i &amp;lt; filesEmpty.length; i++)
                 {
                         System.out.println(&amp;quot;dirEmpty列出所有E盘下的空文件名字（包括空文件夹）:&amp;quot;+filesEmpty[i]);
                 }
                 
                 File dirNotEmpty = new File(&amp;quot;E:\\&amp;quot;);
                 String[] filesNotEmpty = dirNotEmpty.list(EmptyFileFilter.NOT_EMPTY);
                 for(int i = 0; i &amp;lt; filesNotEmpty.length; i++)
                 {
                         System.out.println(&amp;quot;dirNotEmpty列出所有E盘下的非空文件名字（包括空文件夹）:&amp;quot;+filesNotEmpty[i]);
                 }
                 
                 File dirHidden = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesHidden = dirHidden.list(HiddenFileFilter.HIDDEN);
                 try
                 {
                         for(int i = 0; i &amp;lt; filesHidden.length; i++)
                         {
                                 System.out.println(&amp;quot;dirHidden列出所有E盘下的隐藏名字（包括空文件夹）:&amp;quot;+filesHidden[i]);
                         }
                 }catch(NullPointerException e)
                 {
                         System.out.println(&amp;quot;未找到任何隐藏文件 在测试目录下&amp;quot;);
                 }
                 
                 File dirVisible = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesVisible = dirHidden.list(HiddenFileFilter.VISIBLE);
                 try
                 {
                         for(int i = 0; i &amp;lt; filesVisible.length; i++)
                         {
                                 System.out.println(&amp;quot;dirHidden列出所有E盘下的隐藏名字（包括空文件夹）:&amp;quot;+filesHidden[i]);
                         }
                 }catch(NullPointerException e)
                 {
                         System.out.println(&amp;quot;未找到任何隐藏文件 在测试目录下&amp;quot;);
                 }

        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;文件过滤器的规律是: 都是以FileFilter结尾的 比如SuffixFileFilter   AndFileFilter,OrFileFilter, NotFileFilter,AgeFileFilter,CanWriteFileFilter,CanReadFileFilter,DirectoryFileFilter,FileFileFilter,NameFileFilter,WildcardFileFilter。。。
有些接口需要new出来一个对象，比如new  SuffixFileFilter(&amp;quot;.txt&amp;quot;)  ,new NameFileFilter(&amp;ldquo;TestFile&amp;rdquo;) 、new SizeFileFilter(1024*1024) 、new And,Or,NotFileFilter&amp;hellip;等有些接口是直接使用，比如HiddenFileFilter.HIDDEN|VISIBLE   CanReadFileFilter.CANREAD|CANNOTREAD     CanWriteFileFilter.CANWRITE|CANNOTWRITE   EmptyFileFilter.EMPTY|NOTEMPTY   DirectoryFileFilter.INSTANCE   FileFileFilter.FILE等&lt;/p&gt;
&lt;p&gt;5.Stream部分：
主要测试了CountingInputStream 、  CountingOutputStream、TeeOutputStream、TeeInputStream&lt;/p&gt;
&lt;p&gt;CountingInputStream :统计输出流的字节个数（Counting InputStream），可用于网络收费
CountingOutputStream:测量输入流的统计，可用于网络收费
TeeOutputStream:需要输入两个OutputStreams，同时输出到两个硬盘文件
TeeOutputStream：一个inputStream 一个OutputStream,在读取InputStream的同时，也输出到硬盘上的另一个文件，充当备份。&lt;/p&gt;
&lt;p&gt;TeeInputStream:
CommonsIO刚刚接触，只是一些浅显的知识，跟大家分享了,可以通过比较传统的IO流的实现，
CommonsIO流的确为我们封装了很多有用而且快捷的类方法，当然前提是得对基本的IO流有一定的基础性认识。
有问题的，求指教。
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/filename.gif&#34; alt=&#34;过滤器接口的说明&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E4%B8%BB%E8%A6%81%E4%BB%A3%E7%A0%81.gif&#34; alt=&#34;打印所有当前文件夹内的早于一天前创建的文件和文件夹&#34;&gt;&lt;/p&gt;
&lt;p&gt;另外的,WildcardFileFilter类似于RegexFileFilter可以模糊的定位当前文件夹下的所有符合模糊条件的文件，
比如&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;WildcardFileFilter
         //列出所有的文件大小大于*test*.java*的文件
                 File dirWildcard = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 String[] filesWildcard = dirWildcard.list(new WildcardFileFilter(&amp;quot;*test*.java*&amp;quot;)); //正则表达式
                 try
                 {
                         for(int i = 0; i &amp;lt; filesWildcard.length; i++)
                         {
                                 System.out.println(&amp;quot;dirWildcard列出所有E盘下的隐藏名字（包括空文件夹）:&amp;quot;+filesWildcard[i]);
                         }
                 }catch(NullPointerException e)
                 {
                         System.out.println(&amp;quot;未找到任何普通文件 在测试目录下&amp;quot;);
                 }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;RegexFileFilter:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//列出所有的文件包含*test*.java的文件
                 File dirRegex = new File(&amp;quot;E:\\测试目录&amp;quot;);
                 FileFilter ff = new RegexFileFilter(&amp;quot;.*test.*\\.java.*&amp;quot;); //正则表达式 不能写成*test*
                 File[] filesRegex = dirRegex.listFiles(ff);
                 try
                 {
                         for(int i = 0; i &amp;lt; filesRegex.length; i++)
                         {
                                 System.out.println(&amp;quot;dirRegex列出所有E盘下的隐藏名字（包括空文件夹）:&amp;quot;+filesRegex[i]);
                         }
                 }catch(NullPointerException e)
                 {
                         System.out.println(&amp;quot;未找到任何普通文件 在测试目录下&amp;quot;);
                 }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;说明：FileFilter ff = new RegexFileFilter(&amp;quot;.&lt;em&gt;test.&lt;/em&gt;\.java&amp;quot;);  ff可以作为listFiles的参数类型，但是RegexFileFilter这个FileFilter的子类产生的对象无法充当listFiles的参数，这边体现着多态的概念，而且是接口的多态。有一个问题：不明白为什么不能用RegexFileFilter 的对象？？？？ RegexFileFilter查阅源码的确是继承FileFilter和FilenameFilter的，难道是说多态一般只是使用在赋值语句，而在构造函数必须使用对应的类型   listFiles函数的声明为 public File[] listFiles(FileFilter filter){..}  或者public File[] listFiles(FilenameFilter filter){..} ）   求指教~-~&lt;/p&gt;
&lt;p&gt;首先感谢杨老师的远控解决了我的一个困惑。
其实自己也应该猜到，分享一下讲解过程
public class RegexFileFilter extends AbstractFileFilter&lt;br&gt;
复制代码
RegexFileFilter继承了AbstractFileFilter&lt;/p&gt;
&lt;p&gt;public abstract class AbstractFileFilter implements IOFileFilter
复制代码&lt;/p&gt;
&lt;p&gt;AbstractFileFilter实现了IOFileFilter  接口可以实现多继承，于是进一步观看了IOFileFilter
public interface IOFileFilter extends FileFilter, FilenameFilter
复制代码&lt;/p&gt;
&lt;p&gt;IOFileFilter又继承了FileFilter和FilenameFilter这两个接口，并且这两个接口已经是祖先级的接口&lt;/p&gt;
&lt;p&gt;之前我一直用RegexFileFilter定义ff变量，传到listFiles()中死活报错，如下：
RegexFileFilter ff = new RegexFileFilter(&amp;quot;.&lt;em&gt;test.&lt;/em&gt;\.java.*&amp;quot;);
复制代码
原因是RegexFileFilter继承了两个接口FileFilter,FilenameFilter,而listFiles也是实现了两种方式的重载（可以进入listFiles类，利用神健组合ctrl+o观看到   listFiles(FileFilte)  listFiles(FileFilename))
所以如果ff不显示指定的话，listFiles怎么知道要重载哪个函数？&lt;/p&gt;
&lt;p&gt;三种解决方法：
1：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;   File[] filesRegex = dirRegex.listFiles((FilenameFilter)ff);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;   File[] filesRegex = dirRegex.listFiles((FileFilter)ff);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;都是可以的，也可以用上面的多态的方法
3：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;   FileFilter ff = new RegexFileFilter(&amp;quot;.*test.*\\.java&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;问题的根源：重载+显示指定类型&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;学习了    /**  然后摁下 Enter键 在eclipse中自动加入注释段，并且 敲击@可以产生想要的注释字段。
较专业写法，代码的注释，必须学习
/**
* 输入流中的内容到输出流去
* @param input
* @param out
* @throws Exception
*/&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>1月26日Java班笔记</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-26ri-javaban-bi-ji/</link>
      <pubDate>Mon, 11 May 2015 14:58:40 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-26ri-javaban-bi-ji/</guid>
      <description>&lt;p&gt;进一步针对com.rupeng.gtk.GTK主类进行了分析
第一部分：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class GTK
{

        static
        {
                Utils.unZipShared();
                Utils.loadGtkLibs();
                Utils.loadDll(&amp;quot;gtk4j.dll&amp;quot;);
        }
.....
        /**
         * 初始化gtk环境
         */
        public static native void gtk_init();//
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在GTK类中包含主要两个部分，一个是静态代码段Static部分，主要用于做前期工作，产生dll文件以及解压缩，文件流的复制等
另一部分主要是静态代码的声明；&lt;/p&gt;
&lt;p&gt;针对第一部分静态代码段需要分为三个部分 unZipShare()部分、loadGtkLibs和loadDll，他们三个分别是Utils类的主要静态方法。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Utils.unZipShare():
        public static void unZipShared()
        {
                File gtkDir = new File(System.getProperty(&amp;quot;user.dir&amp;quot;), &amp;quot;gtk&amp;quot;);// *.dll放的文件夹
                if (!gtkDir.exists())
                {
                        gtkDir.mkdirs();
                }
                InputStream inStream = Utils.class.getResourceAsStream(&amp;quot;/gtkshare.zip&amp;quot;);
                if (inStream == null)
                {
                        throw new UnsatisfiedLinkError(&amp;quot;没找到gtkshare.zip&amp;quot;);
                }
                try
                {                        
                        unZip(inStream, gtkDir.toString());
                } catch (IOException e)
                {
                        System.err.println(&amp;quot;解压缩gtkshare.zip失败&amp;quot; + toFullString(e));
                }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这段代码的主要功能是：
1.利用File(System.getProperties(&amp;ldquo;User.dir&amp;rdquo;,&amp;ldquo;gtk&amp;rdquo;)创建主要文件夹gtk，用于存放dll文件
2.利用Utils类的反射（不清楚，和之前的Properties的当前类TestProperties.class.getClassLoader().getResourceAsStream()的效果一样） 都是获取一个输入流。在这边获取的是一个当前文件夹下的gtkshare.zip输入流附上Properties的语法，当做复习&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;inStream = TestProperties.class.getClassLoader().getResourceAsStream(&amp;quot;b.properties&amp;quot;);
                // 用于提取项目文件中的文件  默认如果没有包名字  就只写项目里面的文件即可！
            System.out.println(inStream.getClass());
                Properties prop  = new Properties();//修正图片中存在的错误  TestProperties是一个当前类
类似于图片中的Utils类！ 有所不同的是class之后还需要调用getClassLoader 。 当前的dll载入，rupeng的
包是采用System.load而Properities是采用prop.load(inStream);的方式。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3.最后通过unZip方式打开，为此还需要进一步研究unZip代码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;        public static void unZip(InputStream streamToZip,String destDir)throws IOException
        {  
                ZipInputStream zipStream = new ZipInputStream(streamToZip);
                try
                {
                        ZipEntry zipEntry = null;
                        while((zipEntry=zipStream.getNextEntry())!=null)
                        {
                                if(zipEntry.isDirectory())
                                {
                                        File dir = new File(destDir,zipEntry.getName());
                                        if(!dir.exists())
                                        {
                                                dir.mkdirs();
                                        }
                                }
                                else
                                {
                                        FileOutputStream fileOutStream = new FileOutputStream(new File(destDir,zipEntry.getName()));
                                        try
                                        {
                                                copy(zipStream, fileOutStream);
                                        }
                                        finally
                                        {
                                                close(fileOutStream);
                                        }
                                }
                        }
                }
                finally
                {
                        close(zipStream);
                }
                
    }  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这段代码的主要作用是
1：把一个输入的压缩流zipStream 利用压缩流特有的ZipEntry（类似容器当中的Iterator ）逐个从流中解压缩，
1.1 如果该流文件夹，则创建文件夹
1.2 如果该流是文件夹 ，则利用文件输出流（FileOutputStream），把解压缩流的信息存到输出流中。
所以也就是说：解压缩流的文件的结构也是和为解压缩时候的结构是一样的，既有文件夹文件，又有普通文件（另外文件File是一个比较宽泛的定义，File定义的对象既可以是文件夹文件对戏那个，也可以是普通文件，或者管道文件，索引文件，设备文件 ，即File可以代表文件夹、普通文件、管道文件、索引文件、设备文件等。)&lt;/p&gt;
&lt;p&gt;为了进一步研究Utils.unZip(),我们需要进一步研究Utils.copy()：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;        static void copy(InputStream inStream, OutputStream outStream)
                        throws IOException
        {
                byte[] buffer = new byte[512 * 1024];// 0.5MB 的缓冲区
                int len;
                while ((len = inStream.read(buffer)) &amp;gt;= 0)
                {
                        outStream.write(buffer, 0, len);
                }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;说明: 如鹏网先通过建立0.5MB的缓冲区，用于载入输入的压缩流，当达到0.5MB的时候，再利用文件输出流写出压缩流信息到先前创建的gtk/bin目录下。
我想着是不是可以用BufferedInputStream和BufferedOutputStream,于是修改代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;        static void copy(InputStream inStream, OutputStream outStream)
                        throws IOException
        {
BufferedInputStream bis = null;
BufferedOutputStream bos = null;
try
{
bis = new BufferedInputStream(inStream);
bos = new BufferedOutputStream(outStream);

                byte[] buffer = new byte[512 * 1024];// 0.5MB 的缓冲区(rupeng采用的策略)
                int len;
       
                while ((len = bis.read(buffer)) &amp;gt;= 0) //最后一个返回的是-1
                {
                        bos.write(buffer, 0, len);
                }
}catch(IOException e)
{   System.out.println(“读取错误”);
}        
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;并未做测试。只是想着为什么不用缓冲流？当然两者的效果一样
于是我做了下面的测试 针对BufferedInputStream BufferedOutputStream 以及FileInputstream ,FileOutputStream（不是如鹏gtk4j的ZipInputStream 和FileOutputStream）&lt;/p&gt;
&lt;p&gt;测试代码：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* 
*/

/**
* @author 叶昭良
*
*/
import java.io.*;
import java.util.Arrays;
public class TestBufferedInputStream
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                long t1 = System.currentTimeMillis();
                TestBufferedInputStream();
                //System.out.printf(&amp;quot;BufferedInputStream总共用时:&amp;quot;+Long.toString((System.currentTimeMillis() - t1)));
                System.out.println(&amp;quot;BufferedInputStream总共用时:&amp;quot;+(System.currentTimeMillis() - t1));
                //System.out.printf(&amp;quot;BufferedInputStream总共用时:%ld&amp;quot;,(System.currentTimeMillis() - t1));
                
                
                long t2 = System.currentTimeMillis();
                TestFileInputStream();
                //System.out.printf(&amp;quot;FileInputStream总共用时:&amp;quot;+Long.toString((System.currentTimeMillis() - t2)));
                System.out.println(&amp;quot;FileInputStream总共用时:&amp;quot;+(System.currentTimeMillis() - t2));
                //System.out.printf(&amp;quot;FileInputStream总共用时:%ld&amp;quot;,(System.currentTimeMillis() - t2));
                
        }
        public static void TestBufferedInputStream()        
        {
                // TODO 自动生成的方法存根
                BufferedInputStream bis = null;
                BufferedOutputStream  bos = null;
                byte[] fileToFile = new byte[512*1024];
                int len = 0;
                try
                {
                        bis = new BufferedInputStream(new FileInputStream(&amp;quot;E:\\测试目录\\MindManager.exe&amp;quot;));
                        bos = new BufferedOutputStream(new FileOutputStream(&amp;quot;E:\\测试目录\\Mind1.exe&amp;quot;));
                        
                        len  = bis.read(fileToFile);
                        while(-1 != len)
                        {
                                //System.out.printf(&amp;quot;%s&amp;quot;,new String(fileToFile));
                                //System.out.printf(&amp;quot;%s&amp;quot;,Arrays.toString(fileToFile));
                                bos.write(fileToFile,0,len);
                                bos.flush();
                                len = bis.read(fileToFile);
                                
                        }
                }catch(Exception e)
                {
                        e.printStackTrace();
                }
                finally
                {
                        try
                        {
                                bis.close();
                                bos.close();
                        }catch(Exception e)
                        {
                                e.printStackTrace();
                        }
                }
        }
        
        
        public static void TestFileInputStream()        
        {
                // TODO 自动生成的方法存根
                FileInputStream fis = null;
                FileOutputStream  fos = null;
                byte[] fileToFile = new byte[512*1024];
                int len = 0;
                try
                {
                        fis = new FileInputStream(&amp;quot;E:\\测试目录\\MindManager.exe&amp;quot;);
                        fos = new FileOutputStream(&amp;quot;E:\\测试目录\\Mind2.exe&amp;quot;);
                        
                        len  = fis.read(fileToFile);
                        while(-1 != len)
                        {
                                //System.out.printf(&amp;quot;%s&amp;quot;,fileToFile);
                                //System.out.printf(&amp;quot;%s&amp;quot;,Arrays.toString(fileToFile));
                                fos.write(fileToFile,0,len);
                                fos.flush();
                                len = fis.read(fileToFile);
                                
                        }
                }catch(Exception e)
                {
                        e.printStackTrace();
                }
                finally
                {
                        try
                        {
                                fis.close();
                                fos.close();
                        }catch(Exception e)
                        {
                                e.printStackTrace();
                        }
                }
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;基本上保持上下的代码的一致性，除了输入流和输出流的不一样，并比较时间&lt;/p&gt;
&lt;p&gt;说明：测试对象 MindManage.exe 大概是126MB ，
测试结果：第一阶段测试：
第一次：
BufferedInputStream总共用时:301
FileInputStream总共用时:369
第二次再运行:
BufferedInputStream总共用时:296
FileInputStream总共用时:319
第三次
BufferedInputStream总共用时:280
FileInputStream总共用时:278
第四次
BufferedInputStream总共用时:337
FileInputStream总共用时:305&lt;/p&gt;
&lt;p&gt;分析发现，前两次基本上是Buffered方式较好，后两种基本上是File较好，这有可能是eclipse已经帮你载入了缓存的原因，于是删掉测试目录下的Mind1.exe Mind2.exe&lt;/p&gt;
&lt;p&gt;进行第二次测试阶段：
第一次：
BufferedInputStream总共用时:251
FileInputStream总共用时:261&lt;/p&gt;
&lt;p&gt;第二次：
BufferedInputStream总共用时:286
FileInputStream总共用时:303&lt;/p&gt;
&lt;p&gt;第三次： 报错，提示Mind1.exe被占用，问题不是主要的，于是再次删掉Mind1.exe Mind2.exe&lt;/p&gt;
&lt;p&gt;第三阶段测试：
第一次：
BufferedInputStream总共用时:304
FileInputStream总共用时:431
第二次：
又提醒Mind1.exe被占用，估计还未写完，但其实文件的大小已经是和MindMange.exe相等。
第三次：
BufferedInputStream总共用时:299   ，变长了
FileInputStream总共用时:284&lt;/p&gt;
&lt;p&gt;经过三个阶段测试发现: 如果单以第一次为标准的话，Buffered的方式是比FileInputStream的方式快一些。&lt;/p&gt;
&lt;p&gt;回到主题，已经从Utils.unZipShared()&amp;mdash;-&amp;gt;Utils.unZip()&amp;mdash;-&amp;gt;Utils.copy()这条线走通了一遍，基本上完成的是
1.创建主目录gtk ,并解压缩gtkshare.zip,并调用unzip
2.创建gtk底下的子目录bin和share以及其他，并导入其中的一些dll文件（暂时不清楚具体是哪个dll)(导入的方式是通过文件流的复制过程，当然其实也是可以用IOUtils.copy(inStream,outStream）的方式&lt;/p&gt;
&lt;p&gt;第二部分：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Utils.loadGtkLibs();
        static void loadGtkLibs()
        {
                // 如果这些dll放到user.dir根目录下，则只要在gtk4j.dll加载之前把libffi-6.dll等这些被依赖的放到user.dir根目录下即可
                // 但是如果放到其他目录下（放到根目录下在项目里看到一堆dll文件，太难看，所以放到gtkbin下），就要注意加载顺序
                // 要先加载被依赖的dll。使用DependencyWalker可以看dll的依赖关系

                loadDll(&amp;quot;libffi-6.dll&amp;quot;);
                loadDll(&amp;quot;libpixman-1-0.dll&amp;quot;);
                loadDll(&amp;quot;zlib1.dll&amp;quot;);
                loadDll(&amp;quot;liblzma-5.dll&amp;quot;);
                loadDll(&amp;quot;libiconv-2.dll&amp;quot;);
                loadDll(&amp;quot;pthreadGC2.dll&amp;quot;);

                loadDll(&amp;quot;libxml2-2.dll&amp;quot;);// 依赖于libiconv-2.dll、liblzma-5.dll

                loadDll(&amp;quot;libpng15-15.dll&amp;quot;);// 依赖于zlib1.dll
。。。。
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;说明： 原来这个函数主要是用于载入存在于gtk/bin目录下的大多数的dll文件 ，但是不包含gtk4j.dll (这是在第三步的时候单独实现，为什么分开不明白？）&lt;/p&gt;
&lt;p&gt;为此进一步追踪了loadDll的实现：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;        static void loadDll(String dllName)
        {
                // 把dll拷贝到项目根目录下
                File gtkBinDir = new File(System.getProperty(&amp;quot;user.dir&amp;quot;), &amp;quot;gtk/bin&amp;quot;);// *.dll放的文件夹
                if (!gtkBinDir.exists())
                {
                        gtkBinDir.mkdirs();
                }
                File destDllFile = new File(gtkBinDir, dllName);

                // dll位于项目的lib目录下，并且把lib设定为“源码文件夹”，这样这些dll就会生成到jar的根目录下了
                InputStream inStream = Utils.class.getResourceAsStream(&amp;quot;/&amp;quot; + dllName);
                if (inStream == null)
                {
                        throw new UnsatisfiedLinkError(&amp;quot;没找到&amp;quot; + dllName);
                }

                // 如果dll已经存在，则尝试删除，再拷贝新的，这样保证能自动升级
                if (destDllFile.exists())
                {
                        // 如果文件已经存在，则不覆盖，提高运行效率，如果需要升级，则需要手动清理dll
                        System.out.println(dllName + &amp;quot;已经存在，默认加载。如果需要采用新版本dll，请先删除文件夹&amp;quot;
                                        + gtkBinDir + &amp;quot;下所有的*.dll&amp;quot;);
                } else
                {
                        // 拷贝来新的
                        FileOutputStream fileOutStream = null;
                        try
                        {
                                fileOutStream = new FileOutputStream(destDllFile);
                                copy(inStream, fileOutStream);
                        } catch (IOException e)
                        {
                                throw new RuntimeException(&amp;quot;拷贝&amp;quot; + dllName + &amp;quot;失败&amp;quot;, e);
                        } finally
                        {
                                close(inStream);
                                close(fileOutStream);
                        }
                }
                System.load(destDllFile.toString());
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;说明：正如源代码的注释拷贝dll文件到gtk/bin目录下。
1：先创建一个主目录gtk/bin
2:  根据gtk/bin这个file对象和dll文件名字创建一个File对象，并判断是否存在，如果不存在则复制到gtk/bin中，如果存在，则会发现一句我们比较熟悉的“已经存在，默认加载。如果需要采用新版本dll，请先删除文件夹&amp;quot;+ gtkBinDir + &amp;ldquo;下所有的*.dll”
3.拷贝dll文件方式  基本上也是利用FileOutputStream 和copy函数
4.载入dll文件到系统当中，通过System.load(*.dll);&lt;/p&gt;
&lt;p&gt;到这里为止，基本上完成了GTK.class和Utils.class中主要使用到的类的实现和调用学习。&lt;/p&gt;
&lt;p&gt;后来经赵帅提醒原来GTK里面其实是有很多的native的静态类的声明，但是并没有对应的实现，那么实现到底去哪里？ 当然这个是dll载入和JNI接口的问题（而之所以用dll动态链接库载入文件，是因为原先的gtk源代码是通过c语言编写，在java中可以利用jni接口方便的调用c语言产生的动态链接库的实现，而具体的调用规范可以见下面的五个步骤），为此我用最简单的hello、hi程序进行模拟。&lt;/p&gt;
&lt;p&gt;主要分为五步（感谢帅帅）：
1.建立一个hello.java模仿GTK class的方式 建立了静态代码快 导入待生成的dll文件，然后创建了一个类对象调用dll实现的方法  javac hello.java 生成一个java.class
2.利用javah -jni hello 生成hello.h ，这个hello.h是关键，提示hello.c的函数头的书写
3.利用hello.h内部的函数头，新建hello.c文件 ，并按照函数头的形式实现三个函数&lt;br&gt;
4.利用 gcc -shared hello.c -o hello.dll的形式生成dll 文件
5.java hello&lt;/p&gt;
&lt;p&gt;分解第一步：创建了hello.java&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class hello
{
    public native void sayHello(); // 3个native函数声明，表明需要有3个c语言的实现
    public native void sayHi();
    public native int max(int a ,int  b);
    static // 静态代码块
    {
        System.loadLibrary(&amp;quot;hello&amp;quot;);
    }

    public static void main(String[] args)
    {
        new hello().sayHello();
        new hello().sayHi();
        int  a = new hello().max(3,5);
        System.out.println(&amp;quot;the maximum value of 3 and 5 is &amp;quot;+a);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;上面的过程基本上和GTK.class有点像，
1.三个非静态函数的声明（这边不用静态 ，如果是静态也可以直接加上一个native），
2.然后是一个静态代码快载入dll文件，
3.紧接着是main函数调用当前对象的方法，实现java调用c语言的实现&lt;/p&gt;
&lt;p&gt;编译1：
javac hello.java
复制代码&lt;/p&gt;
&lt;p&gt;编译2：
javah -jni  hello
复制代码&lt;/p&gt;
&lt;p&gt;在编译2中生成了hello.h ,打开了，文件内容为：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;/* DO NOT EDIT THIS FILE - it is machine generated */
#include &amp;lt;jni.h&amp;gt;
/* Header for class hello */

#ifndef _Included_hello
#define _Included_hello
#ifdef __cplusplus
extern &amp;quot;C&amp;quot; {
#endif
/*
* Class:     hello
* Method:    sayHello
* Signature: ()V
*/
JNIEXPORT void JNICALL Java_hello_sayHello
  (JNIEnv *, jobject);

/*
* Class:     hello
* Method:    sayHi
* Signature: ()V
*/
JNIEXPORT void JNICALL Java_hello_sayHi
  (JNIEnv *, jobject);

/*
* Class:     hello
* Method:    max
* Signature: (II)I
*/
JNIEXPORT jint JNICALL Java_hello_max
  (JNIEnv *, jobject, jint, jint);

#ifdef __cplusplus
}
#endif
#endif
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;上面的c语言编译指令，暂时不管，因为我们关心的是函数的声明，把他们一一拷贝到hello.c
当然首先你得用记事本新建一个hello.c文件，然后一一拷贝上面的三个函数头声明，并在里面写上实现（当时我也是蒙着写着那些实现，猜的），注意导入jni.h(我是直接拷贝%JAVA_HOME%/include/jni.h到当前目录下) 和
hello.h 以及stdio.h（printf函数的声明）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;lt;jni.h&amp;gt;
#include &amp;quot;hello.h&amp;quot;
#include &amp;lt;stdio.h&amp;gt;
JNIEXPORT void JNICALL Java_hello_sayHello(JNIEnv * env, jclass obj)
{
    printf(&amp;quot;say Hello to you\n&amp;quot;);
}

JNIEXPORT void JNICALL Java_hello_sayHi(JNIEnv * env, jclass obj)
{
    printf(&amp;quot;say hi to you\n&amp;quot;);
}

JNIEXPORT jint JNICALL Java_hello_max(JNIEnv * env, jclass obj, jint a , jint b)
{
    int  max =  a;
    if(max &amp;lt; b)
    {
        return b;
    }else
    {
        return  a;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;于是我们得到了c语言的实现，并进一步整理为一个dll文件
编译3：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;gcc -I. -LD --add-stdcall-alias -shared hello.c -o hello.dll
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再用gcc进行编译成java可以使用的dll文件时候一定要加入&amp;ndash;add-stdcall-alias,否则报UnsatisfiedLinkError  ,如果查过loadDLL的实现会发现，&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;                if (inStream == null)
                {
                        throw new UnsatisfiedLinkError(&amp;quot;没找到&amp;quot; + dllName);
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这个异常的出现和编译指令&amp;ndash;add-stdcall-alias惊人的对应，一个产生，一个消去。&lt;/p&gt;
&lt;p&gt;完成了编译3之后，我们就得到了hello.dll(动态链接库是什么，就是你在运行时候java会导入的函数实现，供java进行c语言函数调用，当然这个过程不用管，只需要hello.dll在当前的项目文件夹下即可）&lt;/p&gt;
&lt;p&gt;运行：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;java hello
E:\testDLL\testJavaDll&amp;gt;java hello
say Hello to you
say hi to you
the maximum value of 3 and 5 is 5
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可见已经连接成功。&lt;/p&gt;
&lt;p&gt;另外如果大家觉得编译过程麻烦，我也附上一个makefile&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;JC=javac
JH=javah
JHOption=-jni
JRun=java
CC=gcc
# I had put the jni.h into current directory
DLLOPTION  = -I.  -LD -Wl,--add-stdcall-alias -shared
CFLAGS = -c


src = hello.java
srctemp = hello.c
srcClass = $(basename $(src))
# generate  the hello.java
# generate hello.h
#NOw you need to write your hello.c according to hello.h

Dll1 =$(addsuffix .dll,$(basename $(src))) 
HeadTarget:
        $(JC)  $(src)
        $(JH)  $(JHOption) $(srcClass) 

AppTarget:
        $(CC) $(DLLOPTION) -o $(Dll1) $(srctemp)
        $(JRun) $(srcClass)

.PHONY:clean
clean:
        del $(Dll1) /s
        del $(srcClass).class /s
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;先是运行：
1：make  HeadTarget
会得到hello.h,然后得去编写hello.c文件
2:  make AppTarget
会得到hello.dll文件，并运行java hello&lt;/p&gt;
&lt;p&gt;前提你得安装gnu make.&lt;/p&gt;
&lt;p&gt;附上loadDLL的实现：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/4.png&#34; alt=&#34;loadDLL的注释&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/5.gif&#34; alt=&#34;hello.c hello.java Makefile&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/5.png&#34; alt=&#34;unZipShare&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/6.gif&#34; alt=&#34;unZip的注释&#34;&gt;&lt;/p&gt;
&lt;p&gt;认识界面！
控制台程序
界面程序（GUI）
网站程序（HTML+JavaScript+JSP）
手机程序（Android）&lt;/p&gt;
&lt;p&gt;学GTK不是主要目的
学工具是低层次，学思想才是王道，后期学习javaee的ssh的架构思想。&lt;/p&gt;
&lt;p&gt;GTK的学习目的是深刻理解面向对象的意义，而不是学会GTK的使用
名字中没有gtk的都是通用的java知识。&lt;/p&gt;
&lt;p&gt;案例1：带有彻底关闭对话框功能的简单对话框，并设置对话框的名字为“冰封”&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
*
*/
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

public class TestGtk
{

        /**
         * @param args
         */
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
        GTK.gtk_init(); // initialize
        int window  = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); //创建一个新窗口的顶级标        识，在c语言也叫做文件句柄，这边应该叫做窗口句柄。 句柄其实就是一串唯一标识一个资源的数字
        // 设置窗口的名字，通过调用GTK类的静态方法
        GTK.gtk_window_set_title(window,&amp;quot;冰封&amp;quot;);// 
        // 设置窗口的显示位置
        GTK.gtk_window_set_position(window,GTK.GTK_WIN_POS_CENTER_ALWAYS);
        //每一个空间都得show出来
        GTK.gtk_widget_show(window); // show it
        //事件的创建，当点击删除按钮时候 摧毁对话框
//IGCallBack中的代码块是“回调”的，在发生“destroy”事件的时候才执行。回调是一个操作系统的机制
//同时解决无法彻底关闭GTK对话框
//解释：在唯一标识的当前窗口，绑定一个destroy的事件，当发生destroy信号的时候，则调用
//一个匿名类，匿名类是一个回调类，JVM负责执行内部的内代码
        GTK.g_signal_connect(window,&amp;quot;destroy&amp;quot;,new IGCallBack()
                {
                    @Override
                    public void execute(int instance,int eventData,Object object)
                    {
                        GTK.gtk_main_quit();
                    }
                },null);
        //创建一个box用于盛放控件
        int box = GTK.gtk_box_new(GTK.GTK_ORIENTATION_HORIZONTAL,0);
        // 在gtk_container_add只能盛放一个容器或者控件
        GTK.gtk_container_add(window,box);
        //显示box
        GTK.gtk_widget_show(box);
        //GTK的主循环程序 gtk_main();如果不添加则闪退。
        GTK.gtk_main();
//一般在GTK.gtk_main()之后不能有程序
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行效果为：&lt;/p&gt;
&lt;p&gt;通过本例：
1.可以学习com.rupeng.gtk4j.GTK和IGCallback的简答使用
2.GTK的静态方法库的调用
3.以及彻底关闭时候涉及到的对于特殊的匿名类的创建和回调函数的使用。
4.并归纳出简单的GTK制作流程为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   a. GTK.gtk_init();
   b. 中间的额外过程
   c. GTK.gtk_widget_show(window) 以及GTK.gtk_widget_show(其他控件)
   d.   GTK.g_signal_connect(window,&amp;quot;destroy&amp;quot;,new IGCallBack()
            {
                @Override
                public void execute(int instance,int eventData,Object object)
                {
                    GTK.gtk_main_quit();
                }
            },null);   来关闭窗口
 e:  GTK.gtk_container_add（window,box) 并show一下。
 f:   GTK.gtk_main();   启动循环线程
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/1.png&#34; alt=&#34;GTK的冰封对话框&#34;&gt;&lt;/p&gt;
&lt;p&gt;在使用com.rupeng.gtk4j.Utils遇到如下问题：
import com.rupeng.gtk4j.Utils;  一直倒不进去(这也说明一点 我们在使用com.rupeng.gtk4j的时候，不需要使用Utils这个类)
于是查了一下Utils类的实现
class Utils
{
&amp;hellip;
}
复制代码&lt;/p&gt;
&lt;p&gt;原来不是公有类，并且不处于同一个包下，相互之间不能访问。默认的Utils是 default修饰符（default限制在同包内（同一山寨）），对于我们使用者需要管两个问题1：可否继承？ 2：可否访问   不管他们如何进行分包。如果站在更高的高度，就需要有座山雕的风范，统一东北18座山寨（假设座山雕拥有此技能，山寨之间如何访问，如何继承由他说了算）。&lt;/p&gt;
&lt;p&gt;在使用类的时候，得问自己，“哪个山寨的？” “可否继承？” “可否访问”（只有public支持不同包的访问（访问是指直接可以new &amp;hellip;），protected是在不同包的情况允许继承(j继承是指可以extends)）&lt;/p&gt;
&lt;p&gt;大部分情况我们是在不同包下进行调用，所以一般是public和protected。&lt;br&gt;
小部分情况下 我们在自己建包的时候，使用 default或者private&lt;/p&gt;
&lt;p&gt;在复习了一下包的机制，找到了一张好的总结图：
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E5%8C%85%E7%9A%84%E6%8E%A7%E5%88%B6%E6%9C%BA%E5%88%B6.png&#34; alt=&#34;包的控制机制&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>1月28日Java班笔记提交帖</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-28ri-javaban-bi-ji-ti-jiao-tie/</link>
      <pubDate>Mon, 11 May 2015 14:58:40 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-28ri-javaban-bi-ji-ti-jiao-tie/</guid>
      <description>&lt;p&gt;第一部分：笔记
引用杨老师笔记，的确经典
1、GTK命名规则
1）一般以gtk_开头
2）gtk_widget_代表这个函数可以应用于GtkWidget及所有子类。gtk_container_代表这个函数可以应用于GtkContainer及所有子类。
3）gtk_***_new，创建一个控件并且返回它的标识(编号)。
4）gtk_AAA_get_BBB，从AAA类型的控件的标识获得控件的BBB属性的值；gtk_AAA_set_BBB，设置指定标识的类型为AAA的控件的BBB属性的值&lt;/p&gt;
&lt;p&gt;分析上述结论：
a.        的确原始的gtk程序都是以gtk_开头的  ，而现在com.rupeng.gtk4j.*，则是利用GTK这个类封装起来这些方法。
b.        一般的规律都是gtk_widget_开头表示继承GtkWidget及所有子类，所以需要有一张GTK的总体继承图
看 总体继承图.gif
说明：也就是说在思考widget的时候，一般接着思考Container、Entry、Label,针对Container有需要思考Bin\Box\Grid\Fixed，针对Bin有需要接着思      考Window|NoteBook|,ScrolledWindow|Button,针对Window有需要接着思考Dialog&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; c. 之所以是gtk_***_new_*** 是因为***既可以代表 gtk_window_new  也可以代表gtk_progress_bar_new                   gtk_check_box_new   gtk_button_new_with_label   gtk_toggle_button_new等。
     d.  Gtk_AAA_get|set_BBB   其实AAA一般代表控件   BBB一般代表属性，也可以代表地方  比如  gtk_screen_get_width()   gtk_entry_set_max_length   gtk_widget_set_visible()
 Gtk_tool_item_set_toolkit_item   AAA也可以有两个_连接。
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;GTK的使用框架：
//初始化
GTK.gtk_init();
//建立窗口  设置成static int window变量
window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
//设置窗口名称
GTK.gtk_window_set_title(window, &amp;ldquo;计算器v1.0&amp;rdquo;);
//添加窗口
GTK.gtk_widget_show(window);&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         //关闭对话框
         GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
         {
                 @Override
                 public void execute(int instance, int eventData, Object object)
                 {
                         // TODO 自动生成的方法存根
                         GTK.gtk_main_quit();
                 }
         }, null);

         //网格布局  盒子布局   固定布局。。。 当前选择网格布局
     int houseGrid = GTK.gtk_grid_new();
     //载入控件
     //省略 一万行代码。。。。

     //载入到windows当中
         GTK.gtk_container_add(window, houseGrid);
         //启动循环
         GTK.gtk_main();
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;GTK.gtk_container_add(window,box1) ;在一个main中只能使用一次gtk_container_add..&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CheckBox
int gtk_check_button_new_with_label(String label)
CheckButton继承自ToggleButton
所以可以使用 void gtk_toggle_button_set_active(int toggle_button, boolean is_active) 设置是否选中
boolean gtk_toggle_button_get_active(int toggle_button) 获得是否选中&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;5.gtk_entry_new
基本的文本框设置
使用void gtk_label_set_text(int label, String str)修改Label的文本内容
void gtk_entry_set_max_length(int entry, int max)设置输入框最大的宽度
void gtk_entry_set_text(int entry, String text)设置输入框的文本
String gtk_entry_get_text(int entry)获得输入框的文本值&lt;/p&gt;
&lt;p&gt;密码文本框设置：
void gtk_entry_set_visibility(int entry,boolean visible)当把visible设置为false的时候输入的内容都会显示成 gtk_entry_set_invisible_char(int entry,char inv_char)设置的字符。用于实现密码框&lt;/p&gt;
&lt;p&gt;第二部分： 作业&lt;/p&gt;
&lt;p&gt;case1: 固定布局的测试&lt;/p&gt;
&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;@author 叶昭良&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@version  v1.0
*/
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
//import com.rupeng.gtk4j.Utils;
public class TestGtkWidgetFixedLayout
{&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  /**
   * @param args
   */
  public static void main(String[] args)
  {
          // TODO 自动生成的方法存根
          GTK.gtk_init();
      int window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); // 原来还有个POPUP估计是右键菜单
      GTK.gtk_widget_show(window);

      GTK.gtk_window_set_title(window, &amp;quot;霜雪&amp;quot;); // widget下没有 只有在window下有。
     // GTK.gtk_window_set_position(window, GTK.GTK_WIN_POS_CENTER);

      GTK.gtk_window_set_position(window, GTK.GTK_WIN_POS_CENTER_ALWAYS);
      //GTK.gtk_window_set_resizable(window, true);  //默认可以拉伸
      // 默认的窗口可以最大化， GTK.gtk_widget_set_maximize(widget)

      //新建了一个文本框
      int entry1  = GTK.gtk_entry_new();
      GTK.gtk_widget_show(entry1);
      //新建了一个button 
      int button1 = GTK.gtk_button_new_with_label(&amp;quot;click me&amp;quot;);
      GTK.gtk_widget_show(button1);

      //新建了一个标签
      int label1 =  GTK.gtk_label_new(&amp;quot;请输入：&amp;quot;);
      GTK.gtk_widget_show(label1);

      // 安静的关闭对话框
      GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
      {
              @Override
              public void execute(int instance, int eventData, Object object)
              {
                      // TODO 自动生成的方法存根
                      GTK.gtk_main_quit();
              }
      }, null);

      //int box1= GTK.gtk_box_new(GTK., spacing)
      //新加了一个house  用来整租给文本框 +button+label
      int house = GTK.gtk_fixed_new();
      GTK.gtk_fixed_put(house, entry1,0,0);
      GTK.gtk_fixed_put(house,button1,50,0);
      GTK.gtk_fixed_put(house,label1,0,100); //很难适应屏幕大小！！所以一般很少用
      GTK.gtk_widget_show(house);

      GTK.gtk_container_add(window,house);

      GTK.gtk_main();
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;}
复制代码&lt;/p&gt;
&lt;p&gt;case2 盒子布局的测试&lt;/p&gt;
&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@author 叶昭良&lt;/li&gt;
&lt;li&gt;@version  v1.0
*/
import java.awt.AWTException;
import java.awt.Robot;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
//import com.rupeng.gtk4j.Utils;
public class TestGtkWidgetBoxLayout
{&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    /**
     * @param args
     */
    public static void main(String[] args)
    {
            // TODO 自动生成的方法存根
            GTK.gtk_init();
        int window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); // 原来还有个POPUP估计是右键菜单
        GTK.gtk_widget_show(window);
        
        GTK.gtk_window_set_title(window, &amp;quot;霜雪&amp;quot;); // widget下没有 只有在window下有。
       // GTK.gtk_window_set_position(window, GTK.GTK_WIN_POS_CENTER);
        
        GTK.gtk_window_set_position(window, GTK.GTK_WIN_POS_CENTER_ALWAYS);
        //GTK.gtk_window_set_resizable(window, true);  //默认可以拉伸
        // 默认的窗口可以最大化， GTK.gtk_widget_set_maximize(widget)
       
        //新建了一个文本框
        int entry1  = GTK.gtk_entry_new();
        GTK.gtk_widget_show(entry1);
        //新建了一个button 
        int button1 = GTK.gtk_button_new_with_label(&amp;quot;click me&amp;quot;);
        GTK.gtk_widget_show(button1);
        
        //新建了一个标签
        int label1 =  GTK.gtk_label_new(&amp;quot;请输入：&amp;quot;);
        int label2 =  GTK.gtk_label_new(&amp;quot;&amp;quot;);
        int label3 =  GTK.gtk_label_new(&amp;quot;&amp;quot;);
        
        // 显示标签
        GTK.gtk_widget_show(label1);
        GTK.gtk_widget_show(label2);
        GTK.gtk_widget_show(label3);
        // 安静的关闭对话框
        GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
        {
                @Override
                public void execute(int instance, int eventData, Object object)
                {
                        // TODO 自动生成的方法存根
                        GTK.gtk_main_quit();
                }
        }, null);
        
        //int box1= GTK.gtk_box_new(GTK., spacing)
        //新加了一个house  用来整租给文本框 +button+label
        // gtk_box_new 的第一个参数 一般是两种赋值方式GTK.GTK_ORIENTATION_HORIZONTAL和_VERTICAL
        // 第二个参数表示的间隔space,如果设置为5则为5pt的间隔
        int houseApple = GTK.gtk_box_new(GTK.GTK_ORIENTATION_HORIZONTAL, 0);
        int houseBanana = GTK.gtk_box_new(GTK.GTK_ORIENTATION_HORIZONTAL, 0);
        int houseTree = GTK.gtk_box_new(GTK.GTK_ORIENTATION_VERTICAL, 0);
        //水平house
        GTK.gtk_box_pack_start(houseApple, label1, true, true, 0);
        GTK.gtk_box_pack_start(houseApple,entry1 , true, true, 0);
        GTK.gtk_box_pack_start(houseBanana,label2 , true, true, 0);
        GTK.gtk_box_pack_start(houseBanana,button1 , true, true, 0);
        GTK.gtk_box_pack_start(houseBanana,label3 , true, true, 0);
        //垂直house
        GTK.gtk_box_pack_start(houseTree, houseApple, true, true, 0);
        GTK.gtk_box_pack_start(houseTree, houseBanana, true, true, 0);
        

        // 显示三个容器 的house
        GTK.gtk_widget_show(houseApple);
        GTK.gtk_widget_show(houseBanana);
        GTK.gtk_widget_show(houseTree);
        
        GTK.gtk_container_add(window,houseTree);
        
        GTK.gtk_main();
        
        
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;}
复制代码&lt;/p&gt;
&lt;p&gt;case3 网格布局的测试&lt;/p&gt;
&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@author 叶昭良&lt;/li&gt;
&lt;li&gt;@version v1.0&lt;/li&gt;
&lt;li&gt;@version v1.1 改进了密码框&lt;br&gt;
*/
import java.awt.AWTException;
import java.awt.Robot;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
//import com.rupeng.gtk4j.Utils;
public class TestGtkWidgetGridLayout
{&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    /**
     * @param args
     */
    public static void main(String[] args)
    {
            // TODO 自动生成的方法存根
            GTK.gtk_init();
        int window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); // 原来还有个POPUP估计是右键菜单
        GTK.gtk_widget_show(window);
        
        GTK.gtk_window_set_title(window, &amp;quot;霜雪&amp;quot;); // widget下没有 只有在window下有。
       // GTK.gtk_window_set_position(window, GTK.GTK_WIN_POS_CENTER);
        
        GTK.gtk_window_set_position(window, GTK.GTK_WIN_POS_CENTER_ALWAYS);
        //GTK.gtk_window_set_resizable(window, true);  //默认可以拉伸
        // 默认的窗口可以最大化， GTK.gtk_widget_set_maximize(widget)
       
     
        // 安静的关闭对话框
        GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
        {
                @Override
                public void execute(int instance, int eventData, Object object)
                {
                        // TODO 自动生成的方法存根
                        GTK.gtk_main_quit();
                }
        }, null);
        
        //int box1= GTK.gtk_box_new(GTK., spacing)
        //新加了一个网格屋子
        int houseGrid = GTK.gtk_grid_new();




        // 显示 的houseGrid
        GTK.gtk_widget_show(houseGrid);
        // 0开头是程序员的惯例
        testGtk(houseGrid,0);
        landInternet(houseGrid,2);
        

        
        GTK.gtk_container_add(window,houseGrid);
        GTK.gtk_main();
        
        
    }
    //新建一个测试的界面
    /**
     * 
     * @param houseGrid  整租的大房子  表示gtk_grid_new的返回值
     * @param start      在houseGrid分配到的第几行开始编号
     */
    public static void testGtk(int houseGrid,int start)
    {
               //新建了一个文本框
        int entry1  = GTK.gtk_entry_new();
        GTK.gtk_widget_show(entry1);
        //新建了一个button 
        int button1 = GTK.gtk_button_new_with_label(&amp;quot;click me&amp;quot;);
        GTK.gtk_widget_show(button1);
        
        //新建了一个标签
        int label1 =  GTK.gtk_label_new(&amp;quot;请输入：&amp;quot;);
        int label2 =  GTK.gtk_label_new(&amp;quot;&amp;quot;);
        int label3 =  GTK.gtk_label_new(&amp;quot;&amp;quot;);
        
        // 显示标签
        GTK.gtk_widget_show(label1);
        GTK.gtk_widget_show(label2);
        GTK.gtk_widget_show(label3);
        
        //整租到housegrid
        // gtk_grid_attach(int grid, int child, int left,int top, int width, int height);
        GTK.gtk_grid_attach(houseGrid, label1, 0, start, 1, 1);
        GTK.gtk_grid_attach(houseGrid, entry1, 1, start, 1, 1);
        
        GTK.gtk_grid_attach(houseGrid, button1, 1, start+1, 1, 1);
    }
    
//新建一个登陆界面的GTK
    public static void landInternet(int houseGrid,int start) 
    {
               //新建了一个文本框
        int entry1  = GTK.gtk_entry_new();

        int entry2  = GTK.gtk_entry_new();
        
        //增加了文本框的密码框的设置y2, false);
        //可以设置显示的
        GTK.gtk_entry_set_visibility(entry2,false);  //字符 默认的密码框为*
        GTK.gtk_entry_set_invisible_char(entry2, &#39;1&#39;); //只能是字符  不能是&amp;quot;1&amp;quot;

        //新建了一个button 
        int buttonEnter = GTK.gtk_button_new_with_label(&amp;quot;登陆&amp;quot;);

        int buttonClosed = GTK.gtk_button_new_with_label(&amp;quot;取消&amp;quot;);

        int checkbox1= GTK.gtk_check_button_new_with_label(&amp;quot;是否保存密码&amp;quot;);
        //新建了一个标签
        int label1 =  GTK.gtk_label_new(&amp;quot;用户名：&amp;quot;);
        int label2 =  GTK.gtk_label_new(&amp;quot;密码  ：&amp;quot;);
        
        //为什么要声明为final暂时不是特别清楚
        final int label3 =  GTK.gtk_label_new(&amp;quot;&amp;quot;);
        
        // 显示标签
        GTK.gtk_widget_show(entry1);
        GTK.gtk_widget_show(entry2);
        GTK.gtk_widget_show(label1);
        GTK.gtk_widget_show(label2);
        GTK.gtk_widget_show(label3);
        GTK.gtk_widget_show(checkbox1);
        GTK.gtk_widget_show(buttonEnter);
        GTK.gtk_widget_show(buttonClosed);
        
        //整租到houseGrid
        GTK.gtk_grid_attach(houseGrid, label1, 0, start, 1, 1);
        GTK.gtk_grid_attach(houseGrid, entry1, 1, start, 1, 1);
        GTK.gtk_grid_attach(houseGrid, label2, 0, start+1, 1, 1);
        GTK.gtk_grid_attach(houseGrid, entry2, 1, start+1, 1, 1);
        GTK.gtk_grid_attach(houseGrid, checkbox1, 1, start+2, 1, 1);
        GTK.gtk_grid_attach(houseGrid, buttonEnter, 1, start+3, 1, 1);
        GTK.gtk_grid_attach(houseGrid, buttonClosed, 2, start+3, 1, 1);
        GTK.gtk_grid_attach(houseGrid, label3, 1, start+5, 1, 1);
        
        
        // 进行按钮的事件连接
        GTK.g_signal_connect(buttonEnter,&amp;quot;clicked&amp;quot;,new IGCallBack()
        {
                @Override
                public void execute(int instance, int eventData, Object object)
                {
                        // TODO 自动生成的方法存根
                        System.out.println(&amp;quot;你点击了登陆&amp;quot;);
                        GTK.gtk_label_set_text(label3, &amp;quot;你点击了登陆&amp;quot;);
                }
        },null);
        
        GTK.g_signal_connect(buttonClosed,&amp;quot;clicked&amp;quot;,new IGCallBack()
        {
                @Override
                public void execute(int instance, int eventData, Object object)
                {
                        // TODO 自动生成的方法存根
                        System.out.println(&amp;quot;你点击了关闭&amp;quot;);
                        GTK.gtk_label_set_text(label3, &amp;quot;你点击了关闭&amp;quot;);
                }
        },null);
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;}
复制代码&lt;/p&gt;
&lt;p&gt;case4 checkBox模拟 安装界面
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
/**
*
*/&lt;/p&gt;
&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;@author 叶昭良&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@version  v1.0
*/
public class TestGtkCheckBox
{&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  /**
   * @param args
   */
  private static int window ;
  private static int box;
  public static void main(String[] args)
  {
          // TODO 自动生成的方法存根

  //        gtkHead(window,&amp;quot;gtkCheckbox测试&amp;quot;);
          GTK.gtk_init();
          window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
          GTK.gtk_window_set_title(window, &amp;quot;hello&amp;quot;);
          GTK.gtk_widget_show(window);
          GTK.g_signal_connect(window,&amp;quot;destroy&amp;quot;,new IGCallBack() 
          {

                  @Override
                  public void execute(int instance, int eventData, Object object)
                  {
                          // TODO 自动生成的方法存根
                          GTK.gtk_main_quit();
                  }

          },null);
          box = GTK.gtk_box_new(GTK.GTK_ORIENTATION_VERTICAL, 0);
          int box2= GTK.gtk_box_new(GTK.GTK_ORIENTATION_VERTICAL,0);
          int box1= GTK.gtk_box_new(GTK.GTK_ORIENTATION_VERTICAL,0);
          testGtkCheckBox(window,box2);
          testGtkCheckBoxInstall(window,box1);
          GTK.gtk_box_pack_start(box, box2, false, false, 0);
          GTK.gtk_box_pack_start(box, box1, false, false, 0);

          GTK.gtk_container_add(window, box);
          GTK.gtk_widget_show(box);
          GTK.gtk_main();

  }


  public static void testGtkCheckBox(int window,int box2)
  {

          int cbMan = GTK.gtk_check_button_new_with_label(&amp;quot;男&amp;quot;);
          int cbWoman = GTK.gtk_check_button_new_with_label(&amp;quot;女&amp;quot;);


          GTK.gtk_box_pack_start(box2, cbMan, false,false        , 0);
          GTK.gtk_box_pack_start(box2, cbWoman, false,false        , 0);


          GTK.gtk_widget_show(cbMan);
          GTK.gtk_widget_show(cbWoman);
          GTK.gtk_widget_show(box2);

  }
  public static void testGtkCheckBoxInstall(int window,int box1)
  {
          int entryLicense = GTK.gtk_entry_new();
          GTK.gtk_entry_set_text(entryLicense, &amp;quot;产品使用声明:\n 尊重ISIS国际标准&amp;quot;);

          //定义控件
          int boxInner = GTK.gtk_box_new(GTK.GTK_ORIENTATION_HORIZONTAL, 0);
          //为什么要修改为终态
          final int cbAgree = GTK.gtk_check_button_new_with_label(&amp;quot;我同意上面的协议&amp;quot;);
          final int btnInstall = GTK.gtk_button_new_with_label(&amp;quot;install&amp;quot;);
          int btnClosed  = GTK.gtk_button_new_with_label(&amp;quot;close&amp;quot;);
          GTK.gtk_widget_set_sensitive(btnInstall, false);

          //添加控件
          GTK.gtk_box_pack_start(box1, entryLicense, false,false        , 0);
          GTK.gtk_box_pack_start(box1, cbAgree, false,false, 0);
          GTK.gtk_box_pack_start(boxInner, btnInstall, false,false,0);
          GTK.gtk_box_pack_start(boxInner, btnClosed, false,false,0);
          GTK.gtk_box_pack_start(box1, boxInner, false,false        , 0);

          //显示控件
          GTK.gtk_widget_show(entryLicense);
          GTK.gtk_widget_show(cbAgree);
          GTK.gtk_widget_show(btnInstall);
          GTK.gtk_widget_show(btnClosed);
          GTK.gtk_widget_show(boxInner);
          GTK.gtk_widget_show(box1);

          //添加事件
          GTK.g_signal_connect(cbAgree, &amp;quot;clicked&amp;quot;, new IGCallBack() 
          {
                  @Override
                  public void execute(int instance, int eventData, Object object)
                  {
                          // TODO 自动生成的方法存根
                          boolean isChecked =  GTK.gtk_toggle_button_get_active(cbAgree);

                          //写了gtk_checkbox发现没有set命令 于是用了widget..
                          GTK.gtk_widget_set_sensitive(btnInstall, isChecked);
                  }
          }, null);
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;}
复制代码&lt;/p&gt;
&lt;p&gt;通过上面的练习： 学习了GTK框架的编程方式，掌握了 label,entry,checkbox(继承toggle_button),Box Layout, Grid Layout , Fixed Layout的基本使用方法，包括clicked,destroy这两个信号的事件处理。  另外拓展的学习了匿名类 new IGCallback(){..}的使用方法。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/checkbox.gif&#34; alt=&#34;checkbox的结果&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E7%9B%92%E5%AD%90.gif&#34; alt=&#34;盒子布局的结果&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E5%9B%BA%E5%AE%9A.gif&#34; alt=&#34;固定布局的结果&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E7%BD%91%E6%A0%BC%E5%B8%83%E5%B1%80.gif&#34; alt=&#34;网格布局的结果&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/%E6%80%BB%E4%BD%93%E6%A1%86%E6%9E%B6%E5%9B%BE.gif&#34; alt=&#34;GTK的总体框架图&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>1月31日Java班笔记作业</title>
      <link>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-31ri-javaban-bi-ji-zuo-ye/</link>
      <pubDate>Mon, 11 May 2015 14:58:40 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2015/05/11/1yue-31ri-javaban-bi-ji-zuo-ye/</guid>
      <description>&lt;p&gt;第一部分：笔记
First: SpinBox
背景：spinButton 控制了文本框的数字，所以不需要研究entry的数字限制形式&lt;/p&gt;
&lt;p&gt;第一点：微调按钮（SpinButton）从GtkEntry继承，只能输入数字。
基本函数使用说明：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;    int gtk_spin_button_new_with_range(double  min,double  max,double  step)  创建实例。min最小值、max最大值、单步变化值。double可以用来表示小数。
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   double gtk_spin_button_get_value(int spin_button)  获得double类型的值。
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;int gtk_spin_button_get_value_as_int(int spin_button) 以整数类型获得值，小数部分忽略。
void gtk_spin_button_set_value(int spin_button,double value)  设置值&lt;/p&gt;
&lt;p&gt;学会：解决问题的能力。1 .查文档  2.google+baidu  3.FAQ&lt;/p&gt;
&lt;p&gt;Second: ComboBox
第一点：GtkComboBoxText从GtkComboBox继承，GtkComboBoxText子类定义ComboBox.
基本函数：(使用说明)
第一步： int gtk_combo_box_text_new()创建一个ComboBoxText；
第二部： void gtk_combo_box_text_append(int combo_box,String id, String text) 附加一个文本，并且给它设定一个自定义id（String类型）。
第三步：
String gtk_combo_box_get_active_id(int combo_box)得到选中行的自定义id
gtk_combo_box_set_active_id(int combo_box,String active_id)设定自定义id等于active_id的项被选中
void gtk_combo_box_text_remove_all(int combo_box)清除所有内容
第四步  当选中一行的时候会发出“changed”信号 GTK.g_signal_connect(….);&lt;/p&gt;
&lt;p&gt;Third: GTKIMAGE
第一点：GtkImage 可以分为三种方式加载图片资源，包括：磁盘文件（file），项目资源（resource），内置图片（STOCK），对应三个
家在函数gtk_image_set_from_file，gtk_image_set_from_resource，gtk_image_set_from_stock。&lt;/p&gt;
&lt;p&gt;基本函数使用说明：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   void gtk_image_set_from_file(int image, String filename)从文件全路径为filename的文件中加载图片。注意文件路径的转义问题，“\\”因为“\”有特殊含义，后面讲字符串会详细讲。
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   void gtk_image_set_from_resource(int image, String resName)从项目资源中加载图片，格式&amp;quot;com/rupeng/1.jpg&amp;quot;（其中com/rupeng表示com.rupeng包），不要以/开头，把资源放在src里面！！！
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;png可以背景透明，jpg、jpege压缩图片, Gif  动态图片&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;   GTK.gtk_image_new_from_stock(GTK.GTK_STOCK_ABOUT, GTK.GTK_ICON_SIZE_LARGE_TOOLBAR); 从GTK的内置图片载入图片。
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;设置按钮图片一般是    GTK.GTK_STOCK*
设置大小的时候  利用GTK.GTK_ICON就可以弹出几个。。。&lt;/p&gt;
&lt;p&gt;Fourth: GTKIMAGE的简单调研
/**
* 把资源resName保存到临时文件夹，返回值为临时文件的全路径
*
* @param resName
*            com/rupeng/a.mp3这样的格式，注意不以/开头
* @return
*/
public synchronized static String saveResourceToTemp(String resName)
{
// 如果resname之前释放到过临时文件，并且临时文件还存在，则不再重复释放，直接返回之前的文件，以提高性能
if (resourceCache.containsKey(resName)) //资源缓存中判断是否存在图片
{
String cachedFileName = resourceCache.get(resName);//从资源缓存中获取图片
if (new File(cachedFileName).exists())
{
return cachedFileName;
} else
{
resourceCache.remove(resName);
}
}
// 获取文件扩展名
String[] strs = resName.split(&amp;quot;\.&amp;quot;); //利用字符串的split函数
String extesion = strs[strs.length - 1]; //获取最后一个&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;            InputStream inStream = GTK.class.getClassLoader().getResourceAsStream(resName);//ClassLoader.getSystemResourceAsStream(resName);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;//通过反射机制 自动载入图片资源的ＩｎｐｕｔＳｔｒｅａｍ ！！！利用文件名字，这也是一个悬念     &lt;br&gt;
if (inStream == null)
{
throw new RuntimeException(&amp;ldquo;找不到资源&amp;rdquo; + resName);
}
try
{                     &lt;br&gt;
//java 1.6后，运行在Windows下，如果启用了Guest账户，则由于createTempFile调用了SecureRandom 会卡5秒钟
//因此第一次运行createTempFile会非常慢
//参考：http://stackoverflow.com/questions/2608763/why-does-first-call-to-java-io-file-createtempfilestring-string-file-take-5-se
//File tempFile = File.createTempFile(&amp;ldquo;temp&amp;rdquo;, &amp;ldquo;.&amp;rdquo; + extesion);
//因此不用createTempFile，改用存到项目的restemp文件夹下
File resDir = new File(System.getProperty(&amp;ldquo;user.dir&amp;rdquo;), &amp;ldquo;gtk/temp&amp;rdquo;);// *.dll放的文件夹
if (!resDir.exists())
{
resDir.mkdirs();//创建临时文件夹
}
inStream.mark(Integer.MAX_VALUE);　／／不清楚作何用
String md5 = Utils.getMD5(inStream);//用md5值做文件名
inStream.reset();//指针复位到mark标记的位置，便于后面保存文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;                    // 如果不加扩展名，mci_send_command则无法识别文件类型
                    File tempFile = new File(resDir,md5+&amp;quot;.&amp;quot;+extesion); //创建一个File
                    FileOutputStream outStream = new FileOutputStream(tempFile); //写出一个文件
                    Utils.copy(inStream,outStream); //把当前的图片资源靠背出去
                    inStream.close();
                    outStream.close();
                    
                    resourceCache.put(resName, tempFile.getAbsolutePath());//放到绝对路径下
                    return tempFile.getAbsolutePath(); //最终返回图片
            } catch (IOException e)
            {
                    throw new RuntimeException(e);
            }
    }

    /**
     * 从java资源中加载资源图片生成image。不是gtk提供的native方法
     * 
     * @param resName
     * @return
     */
    public static int gtk_image_new_from_resource(String resName)
    {
            return gtk_image_new_from_file(saveResourceToTemp(resName));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;复制代码&lt;/p&gt;
&lt;p&gt;Fifth: TextView
背景：先前entry是当行文本框
TextView基本函数使用说明：
第一步： 创建多行文本夹
int gtk_text_view_new()创建多行文本
第二步： 进行接本的设置
void gtk_text_view_set_wrap_mode(int text_view,int wrap_mode) 设置自动换行模式。wrap_mode可选值：GTK_WRAP_NONE(不自动换行)；GTK_WRAP_CHAR(在任意字符换行)；GTK_WRAP_WORD(保持单词完整性换行，)；GTK_WRAP_WORD_CHAR (尽量保持单词完整性，实在不行也可以在任意字符换行)&lt;/p&gt;
&lt;p&gt;第三步：  添加文字和读取文字
读取文字
String text = GTK.gtk_text_buffer_get_text(textbuffer);
添加文字
GTK.gtk_text_buffer_set_text(textbuffer, loveWords)
额外的标注：
一般第三步采用的方式适合比较小的String，对于较大的情况可以再加一个TextIter类似可以在多行文本或者对话框
添加一个滚动条ScrolledBar
TextIter使用说明：
1：TextIter是对TextBuffer遍历的遍历器。
2： int gtk_text_iter_new()创建一个空的TextIter，使用完后用gtk_text_iter_free(int iter)释放。
3： void gtk_text_buffer_get_start_iter(int buffer,int iter)用buffer这个TextBuffer的开始位置去初始化iter这个TextIter（开头插入  或者用backward指针  向后读）
void gtk_text_buffer_get_end_iter(int buffer, int iter)用buffer这个TextBuffer的结束位置去初始化iter这个TextIter（结尾插入  或者也可以用forward指针 向前读）
(*)用gtk_text_buffer_get_iter_*系列方法移动迭代器的位置。
4.   void gtk_text_buffer_insert(int buffer, int iter,String text)在buffer这个TextBuffer的iter这个TextIter的当前位置插入文本text&lt;/p&gt;
&lt;p&gt;5          gtk_text_iter_free(int iter)  释放textIter资源&lt;/p&gt;
&lt;p&gt;Sixth: Cairo
1： 画布板   是一个框架，一般仅仅在第一步创建的时候使用 GTK.gtk_drawing_area();
2： 画布环境(Cairo_t)，缺不了，在java的Cairo中直接在GTK.g_signal_connect中的draw时间中使用，对应execute函数的
eventsData 即使Cairo_t ,基本上每一个Cairo函数都少不了ct
3:  com.rupeng.gtk4j.Cairo简化了绘画的步骤，一般是
3.1        设置画笔的大小  Cairo.cairo_set_font…
3.2        设置画笔的颜色
3.3        Cairo.cairo_move_to(cr…)
3.4        Cairo.cairo_line_to(cr,,,)画直线
3.5        Cairo.cairo_arc(cr,…)画圆弧   记住最好是分段绘制也就是每画一个加入 GTK.gtk_stroke() 或者GTK.gtk_fill();
3.6        Cairo.cairo_rec  画矩形
3.7        文字的绘制
3.7.1        //画文字
3.7.2        Cairo.cairo_move_to(eventData, 180, 260);
3.7.3        Cairo.cairo_set_source_rgb(eventData, 0.4, 0.3, 0.2);
3.7.4        Cairo.cairo_set_font_size(eventData, 16);
3.7.5        //选择文字类型
3.7.6        Cairo.cairo_select_font_face(eventData, &amp;ldquo;宋体&amp;rdquo;, Cairo.CAIRO_FONT_SLANT_ITALIC, Cairo.CAIRO_FONT_WEIGHT_BOLD);
3.7.7        Cairo.cairo_show_text(eventData,&amp;ldquo;三毛的自画像&amp;rdquo;);
3.7.8        //Cairo.cairo_stroke(eventData);  //不需要这句话也可以&lt;/p&gt;
&lt;p&gt;第二部分：作业
First: SpinBox 的使用
case1: 使用控件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author 叶昭良
* @version SpinBoxv1.0
*/
public class TestGTKSPinBox
{

        /**
         * @param args
         *  
         */
        static int window;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window  = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                GTK.gtk_window_set_title(window, &amp;quot;测试SpinBox&amp;quot;);
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                GTK.gtk_widget_show(window);
                
                
                //开始建立布局
                 gridHouse = GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                //开始插入控件
                int start = 0 ;
                createSpinbox(window,gridHouse,start);
                
                GTK.gtk_container_add(window, gridHouse);
                GTK.gtk_main();
        }
        /**
         * 
         * @param window     窗口标识
         * @param gridHouse  整租房标识
         * @param start      整租房的起始位置
         */
        public static void createSpinbox(int window,int gridHouse,int start)
        {
                //定义控件
                int label1 = GTK.gtk_label_new(&amp;quot;数字：0-9&amp;quot;);
                int label2 = GTK.gtk_label_new(&amp;quot;范围: -10~10&amp;quot;);
                final int labelSpinbox = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                final int labelSpinboxApple = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                final int spinbox = GTK.gtk_spin_button_new_with_range(0, 9, 1);
                final int spinboxApple = GTK.gtk_spin_button_new_with_range(-10, 10, 0.1);
                
        
                //添加控件到整租房间
                GTK.gtk_grid_attach(gridHouse, label1, 0, start, 1, 1); 
                GTK.gtk_grid_attach(gridHouse, spinbox, 1, start, 1, 1); 
                GTK.gtk_grid_attach(gridHouse, label2, 0, start+1, 1, 1); 
                GTK.gtk_grid_attach(gridHouse, spinboxApple, 1, start+1, 1, 1);
                
                GTK.gtk_grid_attach(gridHouse, labelSpinbox, 0, start+3, 1, 1);
                GTK.gtk_grid_attach(gridHouse, labelSpinboxApple, 0, start+4, 1, 1);
                //显示控件
                GTK.gtk_widget_show(label1);
                GTK.gtk_widget_show(spinbox);
                GTK.gtk_widget_show(label2);
                GTK.gtk_widget_show(spinboxApple);
                GTK.gtk_widget_show(labelSpinbox);
                GTK.gtk_widget_show(labelSpinboxApple);
                GTK.gtk_widget_show(gridHouse);
                
                
                //添加事件
                GTK.g_signal_connect(spinbox, &amp;quot;changed&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                double apple = GTK.gtk_spin_button_get_value(spinbox);
                                GTK.gtk_label_set_text(labelSpinbox, &amp;quot;您当前选择的数字式：&amp;quot;+Double.toString(apple));
                                
                        }
                }, null);
                
                GTK.g_signal_connect(spinboxApple, &amp;quot;changed&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                double apple = GTK.gtk_spin_button_get_value(spinboxApple);
                                GTK.gtk_label_set_text(labelSpinboxApple, &amp;quot;您当前选择的数字式：&amp;quot;+Double.toString(apple));
                                
                        }
                }, null);
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case2 ：建议四则运算器，加上指数和取余&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author 叶昭良
* @version SpinBoxv1.0
*/
public class TestGTKSPinBox
{

        /**
         * @param args
         *  
         */
        static int window;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window  = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                GTK.gtk_window_set_title(window, &amp;quot;测试SpinBox&amp;quot;);
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                GTK.gtk_widget_show(window);
                
                
                //开始建立布局
                 gridHouse = GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                //开始插入控件
                int start = 0 ;
                createSpinbox(window,gridHouse,start);
                
                GTK.gtk_container_add(window, gridHouse);
                GTK.gtk_main();
        }
        /**
         * 
         * @param window     窗口标识
         * @param gridHouse  整租房标识
         * @param start      整租房的起始位置
         */
        public static void createSpinbox(int window,int gridHouse,int start)
        {
                //定义控件
                int label1 = GTK.gtk_label_new(&amp;quot;数字：0-9&amp;quot;);
                int label2 = GTK.gtk_label_new(&amp;quot;范围: -10~10&amp;quot;);
                final int labelSpinbox = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                final int labelSpinboxApple = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                final int spinbox = GTK.gtk_spin_button_new_with_range(0, 9, 1);
                final int spinboxApple = GTK.gtk_spin_button_new_with_range(-10, 10, 0.1);
                
        
                //添加控件到整租房间
                GTK.gtk_grid_attach(gridHouse, label1, 0, start, 1, 1); 
                GTK.gtk_grid_attach(gridHouse, spinbox, 1, start, 1, 1); 
                GTK.gtk_grid_attach(gridHouse, label2, 0, start+1, 1, 1); 
                GTK.gtk_grid_attach(gridHouse, spinboxApple, 1, start+1, 1, 1);
                
                GTK.gtk_grid_attach(gridHouse, labelSpinbox, 0, start+3, 1, 1);
                GTK.gtk_grid_attach(gridHouse, labelSpinboxApple, 0, start+4, 1, 1);
                //显示控件
                GTK.gtk_widget_show(label1);
                GTK.gtk_widget_show(spinbox);
                GTK.gtk_widget_show(label2);
                GTK.gtk_widget_show(spinboxApple);
                GTK.gtk_widget_show(labelSpinbox);
                GTK.gtk_widget_show(labelSpinboxApple);
                GTK.gtk_widget_show(gridHouse);
                
                
                //添加事件
                GTK.g_signal_connect(spinbox, &amp;quot;changed&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                double apple = GTK.gtk_spin_button_get_value(spinbox);
                                GTK.gtk_label_set_text(labelSpinbox, &amp;quot;您当前选择的数字式：&amp;quot;+Double.toString(apple));
                                
                        }
                }, null);
                
                GTK.g_signal_connect(spinboxApple, &amp;quot;changed&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                double apple = GTK.gtk_spin_button_get_value(spinboxApple);
                                GTK.gtk_label_set_text(labelSpinboxApple, &amp;quot;您当前选择的数字式：&amp;quot;+Double.toString(apple));
                                
                        }
                }, null);
        }

}

    ```

Second: ComboBox

case1: 你想要购买的是什么水果？  combobox
```java
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* @author 叶昭良
* @version ComboBoxText v1.0
*
*/
public class TestGtkComboBoxText
{

        /**
         * @param args
         */
        static int window;
        //static int box;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); 
                GTK.gtk_window_set_title(window, &amp;quot;SpinBoxV1.0&amp;quot;);
                GTK.gtk_widget_show(window);
                //安全关闭GTK
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                String names[] = {&amp;quot;Andy&amp;quot;,&amp;quot;Jerry&amp;quot;,&amp;quot;laulence&amp;quot;,&amp;quot;Lucy&amp;quot;,&amp;quot;jack&amp;quot;};
                // 创建布局
                gridHouse =  GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                createComboBoxText(window,gridHouse,0);  //yij
                loadComboBox(window, names, gridHouse, 2); //之所以从2开始 是因为 0 1已经被使用
                GTK.gtk_container_add(window,gridHouse);
                //启动循环
                GTK.gtk_main();
        }
        
        public static void createComboBoxText(int window,int gridHouse,int start)
        {
                final int comboBoxBig = GTK.gtk_combo_box_text_new();
                GTK.gtk_combo_box_text_append_text(comboBoxBig, &amp;quot;苹果&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxBig, &amp;quot;香蕉&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxBig, &amp;quot;葡萄&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxBig, &amp;quot;橘子&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxBig, &amp;quot;蜜柚&amp;quot;);
                final int comboBoxApple = GTK.gtk_combo_box_text_new();
                GTK.gtk_combo_box_text_append_text(comboBoxApple, &amp;quot;红苹果&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxApple, &amp;quot;青苹果&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxApple, &amp;quot;小苹果&amp;quot;);
                final int comboBoxBanana = GTK.gtk_combo_box_text_new();
                GTK.gtk_combo_box_text_append_text(comboBoxBanana, &amp;quot;天宝蕉&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxBanana, &amp;quot;竹蕉&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxBanana, &amp;quot;大香蕉&amp;quot;);
                final int comboBoxGrape = GTK.gtk_combo_box_text_new();
                GTK.gtk_combo_box_text_append_text(comboBoxGrape, &amp;quot;青葡萄&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxGrape, &amp;quot;玫瑰香&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxGrape, &amp;quot;巨峰&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxGrape, &amp;quot;夏黑&amp;quot;);
                final int comboBoxOrange = GTK.gtk_combo_box_text_new();
                GTK.gtk_combo_box_text_append_text(comboBoxOrange, &amp;quot;小橘子&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxOrange, &amp;quot;大橘子&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxOrange, &amp;quot;年橘&amp;quot;);
                final int comboBoxYouzi = GTK.gtk_combo_box_text_new();
                GTK.gtk_combo_box_text_append_text(comboBoxYouzi, &amp;quot;白心蜜柚&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxYouzi, &amp;quot;红心蜜柚&amp;quot;);
                GTK.gtk_combo_box_text_append_text(comboBoxYouzi, &amp;quot;臭蜜柚&amp;quot;);
                
        /*        int label1 = GTK.gtk_label_new(&amp;quot;您当前想要购买的是&amp;quot;+GTK.gtk_combo_box_text_get_active_text(comboBoxBig)
                                +&amp;quot;下的&amp;quot;+GTK.gtk_combo_box_text_get_active_text(comboBoxApple));*/
                final int label1 = GTK.gtk_label_new(&amp;quot;您当前想要购买的是?&amp;quot;);
                
                // 添加控件到整租房间
                
                GTK.gtk_grid_attach(gridHouse, comboBoxBig, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, comboBoxApple, 1, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, comboBoxBanana, 1, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, comboBoxGrape, 1, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, comboBoxOrange, 1, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, comboBoxYouzi, 1, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, label1, 0, start+1, 1, 1);
                
                //显示控件
                GTK.gtk_widget_show(comboBoxBig);
                GTK.gtk_widget_show(comboBoxApple);
                GTK.gtk_widget_show(label1);
                
                //设置combobox的激活状态
                GTK.gtk_combo_box_set_active(comboBoxBig, 0);
                GTK.gtk_combo_box_set_active(comboBoxApple, 0);
                
                //添加事件
                GTK.g_signal_connect(comboBoxBig, &amp;quot;changed&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                String fruit = GTK.gtk_combo_box_text_get_active_text(comboBoxBig);
                                if(fruit.equalsIgnoreCase(&amp;quot;苹果&amp;quot;))
                                {
                                        helpFunction(comboBoxApple,label1);
                                        GTK.gtk_widget_hide(comboBoxBanana);
                                        GTK.gtk_widget_hide(comboBoxGrape);
                                        GTK.gtk_widget_hide(comboBoxOrange);
                                        GTK.gtk_widget_hide(comboBoxYouzi);
                                }else if(fruit.equalsIgnoreCase(&amp;quot;香蕉&amp;quot;))
                                {
                                        helpFunction(comboBoxBanana,label1);
                                        GTK.gtk_widget_hide(comboBoxApple);
                                        GTK.gtk_widget_hide(comboBoxGrape);
                                        GTK.gtk_widget_hide(comboBoxOrange);
                                        GTK.gtk_widget_hide(comboBoxYouzi);
                                }else if(fruit.equalsIgnoreCase(&amp;quot;葡萄&amp;quot;))
                                {
                                        helpFunction(comboBoxGrape,label1);
                                        GTK.gtk_widget_hide(comboBoxApple);
                                        GTK.gtk_widget_hide(comboBoxBanana);
                                        GTK.gtk_widget_hide(comboBoxOrange);
                                        GTK.gtk_widget_hide(comboBoxYouzi);
                                }else if(fruit.equalsIgnoreCase(&amp;quot;橘子&amp;quot;))
                                {
                                        helpFunction(comboBoxOrange,label1);
                                        GTK.gtk_widget_hide(comboBoxApple);
                                        GTK.gtk_widget_hide(comboBoxBanana);
                                        GTK.gtk_widget_hide(comboBoxGrape);
                                        GTK.gtk_widget_hide(comboBoxYouzi);        
                                }
                                else if(fruit.equalsIgnoreCase(&amp;quot;蜜柚&amp;quot;))
                                {
                                        helpFunction(comboBoxYouzi,label1);
                                        GTK.gtk_widget_hide(comboBoxApple);
                                        GTK.gtk_widget_hide(comboBoxBanana);
                                        GTK.gtk_widget_hide(comboBoxGrape);
                                        GTK.gtk_widget_hide(comboBoxOrange);        
                                }
                        }
                }, null);
                
        }
        
        public static void helpFunction(final int comboBoxText,final int label1)
        {
                GTK.gtk_widget_show(comboBoxText);
                GTK.gtk_combo_box_set_active(comboBoxText, 0);
                GTK.g_signal_connect(comboBoxText, &amp;quot;changed&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object) 
                        {
                                String fruit = GTK.gtk_combo_box_text_get_active_text(comboBoxText);
                                GTK.gtk_label_set_text(label1, &amp;quot;您想要购买的&amp;quot;+fruit+&amp;quot;没有了！请到别家购买&amp;quot;);
                        };
                }, null);
        }
        
        public static void loadComboBox(int window,String[] names, int gridHouse,int start)
        {
                int cmbApple = GTK.gtk_combo_box_text_new();
                for(int  i = 0 ; i &amp;lt; names.length; i++)
                {
                        GTK.gtk_combo_box_text_append_text(cmbApple, names[i]);
                }
                
                GTK.gtk_widget_show(cmbApple);
                GTK.gtk_grid_attach(gridHouse, cmbApple, 0, start, 1, 1);
        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case2: 省市联动器 （上一次的水果选择器，未使用id方法。。）&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
/**
* 
*/

/**
* @author 叶昭良
* @version 省市联动器 V1.0
*
*/
public class ProvincedSelect
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        static int cmbProvince;
        static int cmbCity;
        static int labelShow;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                //初始化
                GTK.gtk_init();
                //建立窗口
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                //显示窗口
                GTK.gtk_widget_show(window);
                // 安静关闭
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {

                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                        
                }, null);
                //布局设置
                gridHouse = GTK.gtk_grid_new();                        
                GTK.gtk_widget_show(gridHouse);        
                //包含整租房
                GTK.gtk_container_add(window, gridHouse);
                //创建控件
                //
                labelShow = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                cmbProvince = GTK.gtk_combo_box_text_new();
                cmbCity     = GTK.gtk_combo_box_text_new();

                
                int start =  0;
                //添加控件
                GTK.gtk_grid_attach(gridHouse, cmbProvince, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, cmbCity, 0,start+1, 1, 1);
                GTK.gtk_grid_attach(gridHouse, labelShow, 1,start+2, 1, 1);

                //显示控件

                GTK.gtk_widget_show(cmbProvince);
                GTK.gtk_widget_show(cmbCity);
                GTK.gtk_widget_show(labelShow);
                createProvince(window);
                

                
                //启动循环
                GTK.gtk_main();

        }
        
        public static void createProvince(int window)
        {
                

                GTK.gtk_combo_box_text_append(cmbProvince, &amp;quot;fj&amp;quot;, &amp;quot;福建&amp;quot;);
                GTK.gtk_combo_box_text_append(cmbProvince, &amp;quot;bj&amp;quot;, &amp;quot;北京&amp;quot;);
                //GTK.gtk_combo_box_text_append(cmbProvince, &amp;quot;sh&amp;quot;, &amp;quot;上海&amp;quot;);
                GTK.gtk_combo_box_text_append(cmbProvince, &amp;quot;hn&amp;quot;, &amp;quot;河南&amp;quot;);
                GTK.gtk_combo_box_text_append(cmbProvince, &amp;quot;hb&amp;quot;, &amp;quot;河北&amp;quot;);
                GTK.gtk_combo_box_text_append(cmbProvince, &amp;quot;sd&amp;quot;,&amp;quot;山东&amp;quot;);
                
                GTK.gtk_combo_box_set_active_id(cmbProvince, &amp;quot;bj&amp;quot;);

//添加事件
                GTK.g_signal_connect(cmbProvince, &amp;quot;changed&amp;quot;, new IGCallBack() 
                {

                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                
                                String province  =  GTK.gtk_combo_box_get_active_id(cmbProvince);
                                if(province==null)return;
                                System.out.println(province);
                                GTK.gtk_combo_box_text_remove_all(cmbCity); //删除所有项
                                //GTK.gtk_combo_box_text_remove_all(cmbCity); //删除所有项
                                if(province.equals(&amp;quot;fj&amp;quot;))
                                {
                                        System.out.println(&amp;quot;福建测试中&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;zhz&amp;quot;, &amp;quot;漳州&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;xm&amp;quot;, &amp;quot;厦门&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;fz&amp;quot;, &amp;quot;福州&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;qz&amp;quot;, &amp;quot;泉州&amp;quot;);
                                        
                                }else if(province.equals(&amp;quot;bj&amp;quot;))
                                {
                                        System.out.println(&amp;quot;福建测试中&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;cp&amp;quot;, &amp;quot;昌平区&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;hd&amp;quot;, &amp;quot;海淀区&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;tz&amp;quot;, &amp;quot;通州区&amp;quot;);
                                        GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;cy&amp;quot;, &amp;quot;朝阳区&amp;quot;);
                                }else if(province.equals(&amp;quot;hn&amp;quot;))
                                {
                                        System.out.println(&amp;quot;福建测试中&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;zz&amp;quot;, &amp;quot;郑州&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;zmd&amp;quot;, &amp;quot;驻马店&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;ny&amp;quot;, &amp;quot;南阳&amp;quot;);
                                }else if(province.equals(&amp;quot;hb&amp;quot;))
                                {
                                        System.out.println(&amp;quot;福建测试中&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;sjz&amp;quot;, &amp;quot;石家庄&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;ts&amp;quot;, &amp;quot;唐山&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;qhd&amp;quot;, &amp;quot;秦皇岛&amp;quot;);
                                }else if(province.equals(&amp;quot;sd&amp;quot;))
                                {
                                        System.out.println(&amp;quot;福建测试中&amp;quot;);
                                   GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;jn&amp;quot;, &amp;quot;济南&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;qd&amp;quot;, &amp;quot;青岛&amp;quot;);
                               GTK.gtk_combo_box_text_append(cmbCity, &amp;quot;yt&amp;quot;, &amp;quot;烟台&amp;quot;);
                                }
                        }        
                }, null);
                
                //原来remove之后 也是会促发cmbCity的 信号  而导致改变 ，根源在于这个
                GTK.g_signal_connect(cmbCity, &amp;quot;changed&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                 String tempProvince = GTK.gtk_combo_box_text_get_active_text(cmbProvince);
                                
                                int  apple  = GTK.gtk_combo_box_get_active(cmbCity);
                                if(apple &amp;lt; 0)
                                {
                                        System.out.println(&amp;quot;nothing in the city&amp;quot;);
                                        return;
                                }
                                
                                String tempCity = GTK.gtk_combo_box_text_get_active_text(cmbCity);
                                if(tempProvince==null||tempCity==null)return;
                                //GTK.gtk_label_set_text(labelShow, &amp;quot;你准备去&amp;quot;+tempProvince+tempCity);
                                GTK.gtk_label_set_text(labelShow,tempProvince+tempCity);
                                System.out.println(tempProvince);
                                System.out.println(tempCity);

                        }
                }, null);
                
                
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Third: GTKIMAGE&lt;/p&gt;
&lt;p&gt;case1  三种方式读入Image&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;


/**
* @author 叶昭良
* @version GtkImage v1.0
*
*/
public class TestGtkImage
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); 
                GTK.gtk_window_set_title(window, &amp;quot;GtkImage V1.0&amp;quot;);
                GTK.gtk_widget_show(window);
                //安全关闭GTK
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                // 创建布局
                gridHouse =  GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                
                int start  = 0;
                createGtkImage(window,gridHouse,start);
                GTK.gtk_container_add(window,gridHouse);
                //启动循环
                GTK.gtk_main();
        }
        
        public static void createGtkImage(int window,int gridHouse,int start)
        {
                int imgWall = GTK.gtk_image_new_from_file(&amp;quot;E:\\娱乐频道\\图片频道\\xin\\greatWall.jpg&amp;quot;);
                int imgHun = GTK.gtk_image_new_from_resource(&amp;quot;yumufeng.jpg&amp;quot;);
                int imgStock = GTK.gtk_image_new_from_stock(GTK.GTK_STOCK_ABOUT, GTK.GTK_ICON_SIZE_LARGE_TOOLBAR);
                
                
                int labelWall = GTK.gtk_label_new(&amp;quot;通过磁盘文件读入长城照片&amp;quot;);
                int labelHun = GTK.gtk_label_new(&amp;quot;通过项目文件读入婚纱照片&amp;quot;);
                int labelStock = GTK.gtk_label_new(&amp;quot;通过GTK内置图片文件读入关于照片&amp;quot;);
                
                //添加到整租房间
                GTK.gtk_grid_attach(gridHouse, imgWall, 0, start+1, 1, 1);
                GTK.gtk_grid_attach(gridHouse, imgHun, 1, start+1, 1, 1);
                GTK.gtk_grid_attach(gridHouse, imgStock, 2, start+1, 1, 1);
                GTK.gtk_grid_attach(gridHouse, labelWall, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, labelHun, 1, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, labelStock, 2, start, 1, 1);
                
                //显示控件
                GTK.gtk_widget_show(imgWall);
                GTK.gtk_widget_show(imgHun);
                GTK.gtk_widget_show(imgStock);
                GTK.gtk_widget_show(labelWall);
                GTK.gtk_widget_show(labelHun);
                GTK.gtk_widget_show(labelStock);
        }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case2  按钮图片&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;


/**
* @author 叶昭良
* @version ButtonImage v1.0
*
*/
public class TestGtkButtonImage
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                // TODO 自动生成的方法存根
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); 
                GTK.gtk_window_set_title(window, &amp;quot;ButtonImage V1.0&amp;quot;);
                GTK.gtk_widget_show(window);
                //安全关闭GTK
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                // 创建布局
                gridHouse =  GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                
                int start  = 0;
                createButtonImage(window,gridHouse,start);
                GTK.gtk_container_add(window,gridHouse);
                //启动循环
                GTK.gtk_main();
        }
        
        public static void createButtonImage(int window,int gridHouse,int start)
        {
                int imgOpen = GTK.gtk_image_new_from_stock(GTK.GTK_STOCK_OPEN, GTK.GTK_ICON_SIZE_BUTTON);
                int imgClosed = GTK.gtk_image_new_from_stock(GTK.GTK_STOCK_CLOSE, GTK.GTK_ICON_SIZE_BUTTON);
                int imgFile = GTK.gtk_image_new_from_stock(GTK.GTK_STOCK_FILE, GTK.GTK_ICON_SIZE_BUTTON);
                int btnCommon = GTK.gtk_button_new_with_label(&amp;quot;普通按钮&amp;quot;);
                int btnOpen = GTK.gtk_button_new_with_label(&amp;quot;打开&amp;quot;);
                int btnClosed = GTK.gtk_button_new_with_label(&amp;quot;关闭&amp;quot;);
                int btnFile = GTK.gtk_button_new_with_label(&amp;quot;文件&amp;quot;);
                GTK.gtk_button_set_image(btnOpen, imgOpen);
                GTK.gtk_button_set_image(btnClosed, imgClosed);
                GTK.gtk_button_set_image(btnFile, imgFile);
                //添加控件 
                //GTK.gtk_grid_attach(gridHouse, imgOpen, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnCommon, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnOpen, 1, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnClosed,2, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnFile,3, start, 1, 1);
                //显示控件
                GTK.gtk_widget_show(btnOpen);
                GTK.gtk_widget_show(btnClosed);
                GTK.gtk_widget_show(btnCommon);
                GTK.gtk_widget_show(btnFile);
                
                GTK.gtk_button_set_image_position(btnClosed, GTK.GTK_POS_TOP); //GTK_POS
                GTK.gtk_button_set_image_position(btnFile, GTK.GTK_POS_RIGHT);
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Fourth: TextView&lt;/p&gt;
&lt;p&gt;case1 女神表达神器：Love you !My Girl&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;



/**
* @author 叶昭良
* @version  TestView v1.0
*/
public class GTKTestTextView
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); 
                GTK.gtk_window_set_title(window, &amp;quot;女朋友告白神器 V1.0&amp;quot;);
                GTK.gtk_widget_show(window);
                //安全关闭GTK
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                // 创建布局
                gridHouse =  GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                
                int start  = 0;
                createTextView(window,gridHouse,start);
                GTK.gtk_container_add(window,gridHouse);
                //启动循环
                GTK.gtk_main();
        }
        
        public static void createTextView(int window, int gridHouse, int start)
        {
                int imgYumu = GTK.gtk_image_new_from_resource(&amp;quot;yumufeng.jpg&amp;quot;);
                int tvGirl = GTK.gtk_text_view_new();
                final int label = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                int btnShow = GTK.gtk_button_new_with_label(&amp;quot;显示&amp;quot;);
                GTK.gtk_text_view_set_wrap_mode(tvGirl, GTK.GTK_WRAP_WORD);
                
                //添加控件
                GTK.gtk_grid_attach(gridHouse, imgYumu, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, tvGirl, 0, start+1, 1, 1);
                GTK.gtk_grid_attach(gridHouse, label, 0 ,start+2, 1,1);
                GTK.gtk_grid_attach(gridHouse, btnShow, 1 ,start+2, 1,1);
                //显示控件
                GTK.gtk_widget_show(imgYumu);
                GTK.gtk_widget_show(tvGirl);
                GTK.gtk_widget_show(label);
                GTK.gtk_widget_show(btnShow);
                
                //读取文本框里面的内容 ，只适用小量的文本，一般用迭代器
                //方法1   先从TextView获取int TextBuffer 
                    //    然后再从TextBuffer获取text
                final int textbuffer= GTK.gtk_text_view_get_buffer(tvGirl);
                String loveWords = &amp;quot;你就像那天上星星，点缀着我们两的星空，璀璨夺目；&amp;quot;
                                + &amp;quot;我愿与你携手共同奋进，原因和你共育我们的sons and grils,&amp;quot;
                                + &amp;quot;建立起一个幸福的家庭&amp;quot;;
                
                //可以直接通过缓冲区编号  设置信息
                GTK.gtk_text_buffer_set_text(textbuffer, loveWords);
                //添加按钮事件
                GTK.g_signal_connect(btnShow, &amp;quot;clicked&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                String text = GTK.gtk_text_buffer_get_text(textbuffer);
                                GTK.gtk_label_set_text(label, text);
                        }
                }, null);
                
                
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case2 : TextIter  实现添加love you 字符串  并加入了滚动条，实现女神表达器的升级版&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;



/**
* @author 叶昭良
* @version  TestView+TestIter v1.0
* @version  TestView+TestIter v2.0 加入了滚动条操作。
*/
public class GTKTestTextIter
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        static int scrolledBar;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL); 
                GTK.gtk_window_set_title(window, &amp;quot;女朋友告白神器 V1.0&amp;quot;);
                GTK.gtk_widget_show(window);
                //安全关闭GTK
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                // 创建布局
                gridHouse =  GTK.gtk_grid_new();
                GTK.gtk_widget_show(gridHouse);
                
                int start  = 0;
                createTextView(window,gridHouse,start);
                GTK.gtk_container_add(window,gridHouse);
                //启动循环
                GTK.gtk_main();
        }
        
        public static void createTextView(int window, int gridHouse, int start)
        {
                int imgYumu = GTK.gtk_image_new_from_resource(&amp;quot;yumufeng.jpg&amp;quot;);
                final int tvGirl = GTK.gtk_text_view_new();
                final int label = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                final int labelIter = GTK.gtk_label_new(&amp;quot;&amp;quot;);
                int btnShow = GTK.gtk_button_new_with_label(&amp;quot;显示&amp;quot;);
                int btnShowIter = GTK.gtk_button_new_with_label(&amp;quot;迭代器插入&amp;quot;);
                GTK.gtk_text_view_set_wrap_mode(tvGirl, GTK.GTK_WRAP_WORD);
                int scrollBar = 0 ;
                //添加控件
                GTK.gtk_grid_attach(gridHouse, imgYumu, 0, start, 1, 1);
                createScrollBar(scrollBar,tvGirl,gridHouse,start);
                //GTK.gtk_grid_attach(gridHouse, tvGirl, 0, start+1, 1, 1);
                GTK.gtk_grid_attach(gridHouse, label, 0 ,start+2, 1,1);
                GTK.gtk_grid_attach(gridHouse, labelIter, 0 ,start+3, 1,1);
                GTK.gtk_grid_attach(gridHouse, btnShow, 1 ,start+2, 1,1);
                GTK.gtk_grid_attach(gridHouse, btnShowIter, 1 ,start+3, 1,1);
                //显示控件
                GTK.gtk_widget_show(imgYumu);
                GTK.gtk_widget_show(tvGirl);
                GTK.gtk_widget_show(label);
                GTK.gtk_widget_show(btnShow);
                GTK.gtk_widget_show(labelIter);
                GTK.gtk_widget_show(btnShowIter);
                
                //读取文本框里面的内容 ，只适用小量的文本，一般用迭代器
                //方法1   先从TextView获取int TextBuffer 
                    //    然后再从TextBuffer获取text
                final int textbuffer= GTK.gtk_text_view_get_buffer(tvGirl);
                String loveWords = &amp;quot;你就像那天上星星，点缀着我们两的星空，璀璨夺目；&amp;quot;
                                + &amp;quot;我愿与你携手共同奋进，原因和你共育我们的sons and grils,&amp;quot;
                                + &amp;quot;建立起一个幸福的家庭&amp;quot;;
                
                //可以直接通过缓冲区编号  设置信息
                GTK.gtk_text_buffer_set_text(textbuffer, loveWords);
                //添加按钮事件
                GTK.g_signal_connect(btnShow, &amp;quot;clicked&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                String text = GTK.gtk_text_buffer_get_text(textbuffer);
                                GTK.gtk_label_set_text(label, text);
                        }
                }, null);
                
                
                GTK.g_signal_connect(btnShowIter, &amp;quot;clicked&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                helpFunction(tvGirl);
                        }
                }, null);
                
        }
        //如何遍历读取textview信息？？ 当前只能插入？
        public static void helpFunction(int textview)
        {
                //TextIter是一个TextView的迭代器。
                int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                int textIter = GTK.gtk_text_iter_new();  //这是一个空的iter，需要用textBuffer进行赋值
                GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);// 或者textview的textBuffer的末尾！
                GTK.gtk_text_buffer_insert(textBuffer, textIter, &amp;quot;I love you! Xinran&amp;quot;);
                
                //GTK.gtk_text_buffer_g
                GTK.gtk_text_iter_free(textIter);
                
        }
        
        public static void createScrollBar(int scrolledBar,int textview,int gridHouse,int start)
        {
                scrolledBar = GTK.gtk_scrolled_window_new();
                GTK.gtk_widget_show(scrolledBar);
                GTK.gtk_grid_attach(gridHouse, scrolledBar, 0, start+1, 1, 1);
                GTK.gtk_widget_set_size_request(scrolledBar, 300, 50);
                GTK.gtk_container_add(scrolledBar,textview);
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case3 : 计算器version 3.0   加入了一些Sin等计算符   以及TextView&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
* @version : 计算器v1.0
* @version : 计算器v 2.0  替换掉entry 采用了SpinBox和ComboBox
* @version : 计算器v 3.0  
*              1.使用button触发计算事件  加入了三角函数、对数函数等的计算，
*              2.使用TextView  and TextIter把结果输入到其中。。 
*              3.对于         
*
*/
import javax.swing.JOptionPane;

import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
//import java.math.*;

public class TestCalc3
{

        /**
         * @param args
         */
        static int window;
        static boolean isEnter = false;

        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                //初始化
                GTK.gtk_init();
                //建立窗口  设置成static int window变量
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                //设置窗口名称
                GTK.gtk_window_set_title(window, &amp;quot;计算器v3.0&amp;quot;);
                //添加窗口
                GTK.gtk_widget_show(window);
                
                //关闭对话框
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                
                //网格布局
            int houseGrid = GTK.gtk_grid_new();
            //载入计算机控件
            
            Calc(window,houseGrid,0); //有两行
            specialCal(window,houseGrid,2); //有两行
            //载入到windows当中
                GTK.gtk_container_add(window, houseGrid);
                //启动循环
                GTK.gtk_main();
                
        }
        /**
         * 
         * @param window     窗口的标识
          * @param houseGrid  整租房间的标识
         * @param start      设置整租房间的起始行数
         */
        public static void Calc(int window,int houseGrid,int start)
        {
                final int sbOne = GTK.gtk_spin_button_new_with_range(-32768, 32767, 1);
                final int sbAnother = GTK.gtk_spin_button_new_with_range(-32768, 32767, 1);
                GTK.gtk_spin_button_set_value(sbOne, 12.0);
                GTK.gtk_spin_button_set_value(sbAnother, 4.0);
                final int cbbOperator = GTK.gtk_combo_box_text_new();
                GTK.gtk_combo_box_text_append_text(cbbOperator, &amp;quot;+&amp;quot;);
                GTK.gtk_combo_box_text_append_text(cbbOperator, &amp;quot;-&amp;quot;);
                GTK.gtk_combo_box_text_append_text(cbbOperator, &amp;quot;*&amp;quot;);
                GTK.gtk_combo_box_text_append_text(cbbOperator, &amp;quot;/&amp;quot;);
                GTK.gtk_combo_box_text_append_text(cbbOperator, &amp;quot;%&amp;quot;);
                GTK.gtk_combo_box_text_append_text(cbbOperator, &amp;quot;^&amp;quot;);
                
                GTK.gtk_combo_box_set_active(cbbOperator, 0);
                int btnEquals = GTK.gtk_button_new_with_label(&amp;quot;=&amp;quot;);
                final int label2 = GTK.gtk_label_new(&amp;quot;我知道答案是什么&amp;quot;);
                
                int labelCommon = GTK.gtk_label_new(&amp;quot;普通的四则运算：&amp;quot;);
                // Box用于存储  + - operator



                //加入整租
                GTK.gtk_grid_attach(houseGrid, labelCommon, 0, start, 1, 1);
                //在下一行再添加
                start= start + 1;
                GTK.gtk_grid_attach(houseGrid, sbOne, 0, start, 1, 1);
                GTK.gtk_grid_attach(houseGrid, cbbOperator, 1, start, 1, 1);
//                GTK.gtk_grid_attach(houseGrid, buttonPlus, 1, start, 1, 1);
//                GTK.gtk_grid_attach(houseGrid, buttonMinus, 1, start+1, 1, 1);
                GTK.gtk_grid_attach(houseGrid, sbAnother, 2, start, 1, 1);
                GTK.gtk_grid_attach(houseGrid, btnEquals, 3, start, 1, 1);
                GTK.gtk_grid_attach(houseGrid, label2, 4, start, 1, 1);
                
                //显示控件
                GTK.gtk_widget_show(labelCommon);
                GTK.gtk_widget_show(sbOne);
                GTK.gtk_widget_show(sbAnother);
                GTK.gtk_widget_show(cbbOperator);

                GTK.gtk_widget_show(btnEquals);
                GTK.gtk_widget_show(label2);
                //GTK.gtk_widget_show(box);
                GTK.gtk_widget_show(houseGrid);
                
                
                //加入事件控制机制 
                GTK.g_signal_connect(btnEquals, &amp;quot;clicked&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                
                                // TODO 自动生成的方法存根
                                double plus1 = GTK.gtk_spin_button_get_value(sbOne);
                                double plus2 = GTK.gtk_spin_button_get_value(sbAnother);
                                
                                //增加一个 只读模式的entry
                                //GTK.gtk_editable_set_editable(entryOne, false); //只读不能写入。
                                
                                String cbbString = GTK.gtk_combo_box_text_get_active_text(cbbOperator);
                                //panduan(plus1,entryOne);
                                panduan(plus2,sbAnother);
                                double sum1 = 0;
                                if(cbbString.equalsIgnoreCase(&amp;quot;+&amp;quot;))
                                {
                                         sum1 = plus1 + plus2;
                                        GTK.gtk_label_set_text(label2, Double.toString(sum1));
                                }else if(cbbString.equalsIgnoreCase(&amp;quot;-&amp;quot;))
                                {
                                        sum1 = plus1 -plus2;
                                        GTK.gtk_label_set_text(label2, Double.toString(sum1));
                                }else if(cbbString.equalsIgnoreCase(&amp;quot;*&amp;quot;))
                                {
                                        sum1 = plus1 * plus2;
                                        GTK.gtk_label_set_text(label2, Double.toString(sum1));
                                }else if(cbbString.equalsIgnoreCase(&amp;quot;/&amp;quot;))
                                {
                                        panduan(plus2,sbAnother);
                                        sum1 = plus1 / plus2;
                                        GTK.gtk_label_set_text(label2, Double.toString(sum1));
                                }else if(cbbString.equalsIgnoreCase(&amp;quot;%&amp;quot;))
                                {
                                        panduan(plus2,sbAnother);
                                        sum1 = plus1 % plus2;
                                        GTK.gtk_label_set_text(label2, Double.toString(sum1));
                                }else if(cbbString.equalsIgnoreCase(&amp;quot;^&amp;quot;))
                                {
                                        //String temp = Double.toString(plus2);
                                        
                                        sum1 = Math.pow(plus1,plus2);
                                        GTK.gtk_label_set_text(label2, Double.toString(sum1));
                                }
                        }
                }, null);        
                
        }
        /**
         * 
         * @param plus1  entry1的数字字符串
         * @param entry1 entry1的标识
         */
        public static void panduan(double plus1,int sbAnother)
        {
                if(plus1 == 0)
                {
                        JOptionPane.showMessageDialog(null, &amp;quot;被除数不能为0,已经置为空 请重新输入&amp;quot;);
                        GTK.gtk_spin_button_set_value(sbAnother, 1.0);;
                        return;
                }
        }
        /**
         * 
         * @param window     计算器窗口的标识
         * @param gridHouse  整租房的标识
         * @param start      整租房的编号
         */
        public static void specialCal(int window,int gridHouse,int start)
        {
                // 建立控件
                final int btnSin = GTK.gtk_button_new_with_label(&amp;quot;sin&amp;quot;);
                final int btnCos = GTK.gtk_button_new_with_label(&amp;quot;cos&amp;quot;);
                final int btnTan = GTK.gtk_button_new_with_label(&amp;quot;tan&amp;quot;);
                final int btnAsin = GTK.gtk_button_new_with_label(&amp;quot;asin&amp;quot;);
                final int btnAcos = GTK.gtk_button_new_with_label(&amp;quot;acos&amp;quot;);
                final int btnAtan = GTK.gtk_button_new_with_label(&amp;quot;atan&amp;quot;);
                final int btnLog = GTK.gtk_button_new_with_label(&amp;quot;log&amp;quot;);
                final int btnSqrt = GTK.gtk_button_new_with_label(&amp;quot;sqrt&amp;quot;);
                final int btnabs = GTK.gtk_button_new_with_label(&amp;quot;abs&amp;quot;);
                final int btnFloor = GTK.gtk_button_new_with_label(&amp;quot;floor&amp;quot;);
                final int btnCeil = GTK.gtk_button_new_with_label(&amp;quot;ceil&amp;quot;);
                final int btnToDegree = GTK.gtk_button_new_with_label(&amp;quot;弧度变角度&amp;quot;);
                final int btnToRadius = GTK.gtk_button_new_with_label(&amp;quot;角度变弧度&amp;quot;);
                final int spinbox= GTK.gtk_spin_button_new_with_range(-32767, 32767, 0.1);
                final int btnEquals = GTK.gtk_button_new_with_label(&amp;quot;=&amp;quot;);
                final int tv1 = GTK.gtk_text_view_new();
                final int labelSpecial = GTK.gtk_label_new(&amp;quot;特殊的四则运算：(先点击运算符，再敲值，最后等号)&amp;quot;);
                //设置GTK TextView的模式
                GTK.gtk_text_view_set_wrap_mode(tv1, GTK.GTK_WRAP_WORD);
                //设置滚动条
                final int scrolledBar = 0 ;


                GTK.gtk_spin_button_set_value(spinbox, 44.0);
                int innerGrid = GTK.gtk_grid_new();
                //添加控件
                GTK.gtk_grid_attach(innerGrid, btnSin, 0, 0, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnCos, 1, 0, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnTan, 2, 0, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnAsin, 0, 1, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnAcos, 1, 1, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnAtan, 2, 1, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnLog, 0, 2, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnSqrt, 1, 2, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnabs, 2, 2, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnFloor, 0, 3, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnCeil, 1, 3, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnToDegree, 0, 4, 1, 1);
                GTK.gtk_grid_attach(innerGrid, btnToRadius, 1, 4, 1, 1);
                
                GTK.gtk_grid_attach(gridHouse,labelSpecial,0,start,1,1);
                
                start = start + 1; //跳到下一行
                GTK.gtk_grid_attach(gridHouse, innerGrid, 0, start, 3, 5);
                GTK.gtk_grid_attach(gridHouse, spinbox, 3, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, btnEquals, 4, start, 1, 1);
                // GTK.gtk_grid_attach(gridHouse, tv1, 4, start+1, 1, 1);
                createScrollBar(scrolledBar,tv1,gridHouse,start);
                
                
                //显示控件
                GTK.gtk_widget_show(labelSpecial);
                GTK.gtk_widget_show(btnSin);
                GTK.gtk_widget_show(btnCos);
                GTK.gtk_widget_show(btnTan);
                GTK.gtk_widget_show(btnAsin);
                GTK.gtk_widget_show(btnAcos);
                GTK.gtk_widget_show(btnAtan);
                GTK.gtk_widget_show(btnSqrt);
                GTK.gtk_widget_show(btnLog);
                GTK.gtk_widget_show(btnabs);
                GTK.gtk_widget_show(btnCeil);
                GTK.gtk_widget_show(btnFloor);
                GTK.gtk_widget_show(btnToDegree);
                GTK.gtk_widget_show(btnToRadius);
                GTK.gtk_widget_show(tv1); //还是得先是  必须show 否则看不到
                GTK.gtk_widget_show(spinbox);
                GTK.gtk_widget_show(btnEquals);
                //GTK.gtk_widget_show(scrolledBar);  //不要在这边show只在scrollbar区域，不然报错
                GTK.gtk_widget_show(innerGrid);
                
                
                
                //添加按钮事件
                insertButtonEvent( btnSin,tv1);
                insertButtonEvent( btnCos,tv1);
                insertButtonEvent( btnTan,tv1);
                insertButtonEvent( btnAsin,tv1);
                insertButtonEvent( btnAcos,tv1);
                insertButtonEvent( btnAtan,tv1);
                insertButtonEvent( btnLog,tv1);
                insertButtonEvent( btnabs,tv1);
                insertButtonEvent( btnCeil,tv1);
                insertButtonEvent( btnFloor,tv1);
                insertButtonEvent( btnToDegree,tv1);
                insertButtonEvent( btnToRadius,tv1);
                
                
                GTK.g_signal_connect(spinbox,&amp;quot;changed&amp;quot;,new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                isEnter = true;
                        }
                },null);
                
                GTK.g_signal_connect(btnEquals, &amp;quot;clicked&amp;quot;, new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                double sum1  = 0 ;
                                double apple = GTK.gtk_spin_button_get_value(spinbox);
                                if(isEnter == false)
                                {
                                        JOptionPane.showMessageDialog(null, &amp;quot;您未选择特殊操作符，请重新选择，并输入数字，进行运算&amp;quot;);
                                        GTK.gtk_spin_button_set_value(spinbox, 44.0);
                                        return;
                                }else
                                {
                                        String temp = GetStringFromTextViewFunction(tv1);
                                        if(temp.equals(&amp;quot;sin&amp;quot;))
                                        {
                                                double orange = Math.toRadians(apple);
                                                sum1  = Math.sin(orange);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;cos&amp;quot;))
                                        {
                                                double orange = Math.toRadians(apple);
                                                sum1  = Math.cos(orange);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;tan&amp;quot;))
                                        {
                                                double orange = Math.toRadians(apple);
                                                sum1  = Math.tan(orange);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;asin&amp;quot;))
                                        {
                                                double orange = Math.toRadians(apple);
                                                sum1  = Math.asin(orange);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;acos&amp;quot;))
                                        {
                                                double orange = Math.toRadians(apple);
                                                sum1  = Math.acos(orange);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;atan&amp;quot;))
                                        {
                                                double orange = Math.toRadians(apple);
                                                sum1  = Math.atan(orange);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;log&amp;quot;))
                                        {
                                                sum1  = Math.log(apple);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;sqrt&amp;quot;))
                                        {
                                                sum1  = Math.sqrt(apple);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;abs&amp;quot;))
                                        {
                                                sum1  = Math.abs(apple);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;floor&amp;quot;))
                                        {
                                                sum1  = Math.floor(apple);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;ceil&amp;quot;))
                                        {
                                                sum1  = Math.ceil(apple);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;弧度变角度&amp;quot;))
                                        {
                                                sum1  = Math.toDegrees(apple);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }else if(temp.equals(&amp;quot;角度变弧度&amp;quot;))
                                        {
                                                sum1  = Math.toRadians(apple);
                                                String finalResult = &amp;quot;(&amp;quot;+apple+&amp;quot;)&amp;quot;+&amp;quot; = &amp;quot;+sum1+&amp;quot;\n&amp;quot;;
                                                InsertStringToTextViewFunction(tv1,finalResult);
                                        }
                                }
                        }
                }, null);
                
        }
        
        /**
         * 
         * @param scrolledBar  滚动条标识
         * @param textview     多行文本标识
         * @param gridHouse    整租房的标识
         * @param start        整租房的初始开始处
         */
        public static void createScrollBar(int scrolledBar,int textview,int gridHouse,int start)
        {
                scrolledBar = GTK.gtk_scrolled_window_new();
                GTK.gtk_widget_show(scrolledBar);
                //滚动条是更大的容器
                GTK.gtk_grid_attach(gridHouse, scrolledBar, 4, start+1, 1, 1); // 4改为0 报错
                GTK.gtk_widget_set_size_request(scrolledBar, 300, 50);
                GTK.gtk_container_add(scrolledBar,textview); // 添加textview到滚动条容器当中
        }
        
        /**
         * 
         * @param textview  多行文本TextView的标识
         * @param temp      插入TextView 的字符串。
         */
        public static void InsertStringToTextViewFunction(int textview,String temp)
        {
                //TextIter是一个TextView的迭代器。
                int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                int textIter = GTK.gtk_text_iter_new();  //这是一个空的iter，需要用textBuffer进行赋值
                //GTK.gtk_text_iter_forward_to_end(textIter);
                GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);// 或者textview的textBuffer的末尾！
                GTK.gtk_text_buffer_insert(textBuffer, textIter, temp);
                
                //GTK.gtk_text_buffer_g
                GTK.gtk_text_iter_free(textIter);
                
        }
        /**
         * 
         * @param textview   TextView的多行文本的标识
         * @return           返回的字符串
         */
        public static String GetStringFromTextViewFunction(int textview)
        {
                //TextIter是一个TextView的迭代器。
                int textBuffer =  GTK.gtk_text_view_get_buffer(textview);
                int textIter = GTK.gtk_text_iter_new();  //这是一个空的iter，需要用textBuffer进行赋值
                GTK.gtk_text_buffer_get_end_iter(textBuffer, textIter);// 或者textview的textBuffer的末尾！
                String temp = GTK.gtk_text_buffer_get_text(textBuffer);
                
                String[] splitArray = temp.split(&amp;quot;\\n&amp;quot;);
                temp = splitArray[splitArray.length-1];
                System.out.println(temp);
                return temp;
                //GTK.gtk_text_buffer_g
                //GTK.gtk_text_iter_free(textIter);
                
        }
        /**
         * 
         * @param btnSin   按钮的标识
         * @param tv1      textview的标识
         */
        public static void insertButtonEvent(final int btnSin,final int tv1)
        {
                GTK.g_signal_connect(btnSin, &amp;quot;clicked&amp;quot;,new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //double sbValue = GTK.gtk_spin_button_get_value(spinbox);
                                String temp = GTK.gtk_button_get_label(btnSin);
                                InsertStringToTextViewFunction(tv1,temp);
                                isEnter = false;
                        }
                }, null);
        }


}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Fifth: Cairo&lt;/p&gt;
&lt;p&gt;case1 : 三毛头部自画像 V1.0&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author 叶昭良
* @version GTK+Cairo v1.0
*/
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
import com.rupeng.gtk4j.Cairo;
public class GTKTestCairo
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                //GTK初始化
                GTK.gtk_init();
                //窗口标识
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                //窗口标题
                GTK.gtk_window_set_title(window, &amp;quot;简易画图板v1.0&amp;quot;);
                //显示窗口
                GTK.gtk_widget_show(window);
                
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                
                
                //设置布局方式
                gridHouse = GTK.gtk_grid_new();
                
                
                //创建控件
                int start = 0;
                createDraw(window, gridHouse, start);
                //circlePoint 原点设置为180
                createDrawLaughFace(window,gridHouse,start+1,180);
                
                
                GTK.gtk_widget_show(gridHouse);
                
                GTK.gtk_container_add(window,gridHouse);
                //启动循环
                GTK.gtk_main();
        }
        
        
        public static void createDraw(int window,int gridHouse,int start) 
        {
                //创建画图板 或者叫画布
                int  dan  = GTK.gtk_drawing_area_new();
                
                int label = GTK.gtk_label_new(&amp;quot;三毛&amp;quot;);
                //创建源
                //添加控件
                GTK.gtk_grid_attach(gridHouse, label, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, dan, 1, start, 1, 1);
                //显示画布
                GTK.gtk_widget_show(dan);
                GTK.gtk_widget_show(label);
                
                //设置画布的大小
                GTK.gtk_widget_set_size_request(dan, 300, 300);
                
                
                //开始绘制  利用事件draw 来不断的绘制
                
                GTK.g_signal_connect(dan, &amp;quot;draw&amp;quot;,new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //eventDate才是画布源
                                //设置画笔的颜色
                                Cairo.cairo_set_source_rgb(eventData, 0.5, 0.6, 0.3);
                                //设置画笔的大小
                                Cairo.cairo_set_line_width(eventData, 3);
                                
                                
                                
                                //移动画笔点   画笔默认位置不是在（0,0）move_to不可少
                                //Cairo.cairo_move_to(eventData, 0, 0);
/*                                //画一条线七点
                                Cairo.cairo_line_to(eventData, 50, 50);
                                //画一条线重点
                                Cairo.cairo_line_to(eventData,100,100);
                                //接着划线
                                Cairo.cairo_line_to(eventData, 120, 120);*/
                                //画一个圆
                                Cairo.cairo_arc(eventData, 180, 180, 60, 0, 2*3.1415926);
                                //画一个圆弧
                                //Cairo.cairo_arc(eventData, 200, 200, 70,1.5*3.1415925, 2*3.1415926);
                                //显示画笔
                                Cairo.cairo_stroke(eventData); //Cairo.cairo_fill(eventData)不同的效果
                                
                                
                                //画一个圆弧  有下面实验知道是从x轴沿顺时针开始画图
/*                                Cairo.cairo_arc(eventData, 220, 220, 30,0, 0.5*3.1415926);

                                Cairo.cairo_fill(eventData); //Cairo.cairo_fill(eventData)不同的效果
                                
                                Cairo.cairo_arc(eventData, 220, 100, 30,0, 3.1415926);
                                Cairo.cairo_stroke(eventData);
                                Cairo.cairo_arc(eventData, 220, 30, 30,0, 1.5*3.1415926);
                                Cairo.cairo_fill(eventData);*/
                                //嘴巴的绘制
                                double Pi = 3.1415926;
                                Cairo.cairo_arc(eventData, 180, 180, 40, 0.25*Pi, 0.75*Pi);
                                Cairo.cairo_fill(eventData);
                                
                                //绘制两只眼睛
                                Cairo.cairo_arc(eventData, 160, 160, 10, 0, 2*Pi);
                                Cairo.cairo_arc(eventData, 200, 160, 10, 0, 2*Pi);
                                Cairo.cairo_fill(eventData);
                                
                                
                                //绘制胡须
                                Cairo.cairo_arc(eventData, 130, 160, 50, 0.166667*Pi, 0.6777777*Pi);
                                
                                Cairo.cairo_stroke(eventData);
                                
                                Cairo.cairo_arc(eventData, 230, 160, 50, 0.333333*Pi, 0.8333333*Pi);
                                Cairo.cairo_stroke(eventData);
                                
                                //绘制头发
                                Cairo.cairo_arc(eventData, 133.6, 136.72, 30,1.3333333*Pi ,1.833333*Pi );
                                
                                Cairo.cairo_stroke(eventData);
                                
                                Cairo.cairo_arc(eventData, 224.4, 136.72, 30, 1.166667*Pi, 1.6777777*Pi);
                                Cairo.cairo_stroke(eventData);
                                
                                
                                //移动画笔点   画笔默认位置不是在（0,0）move_to不可少
                                Cairo.cairo_move_to(eventData, 180, 120);
                            //画一条线七点
                                Cairo.cairo_line_to(eventData, 180, 90);
                                Cairo.cairo_stroke(eventData);
                        }
                }, null);
                
                
        }
        
        public static void createDrawLaughFace(int window,int gridHouse,int start,final int circlePoint) 
        {
                //创建画图板 或者叫画布
                int  dan  = GTK.gtk_drawing_area_new();
                int label = GTK.gtk_label_new(&amp;quot;笑脸&amp;quot;);
                //创建源
                //添加控件
                GTK.gtk_grid_attach(gridHouse, label, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, dan, 1, start, 1, 1);
                //显示画布
                GTK.gtk_widget_show(dan);
                GTK.gtk_widget_show(label);

                
                //设置画布的大小
                GTK.gtk_widget_set_size_request(dan, 300, 300);
                
                
                //开始绘制  利用事件draw 来不断的绘制
                
                GTK.g_signal_connect(dan, &amp;quot;draw&amp;quot;,new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //eventDate才是画布源
                                //设置画笔的颜色
                                Cairo.cairo_set_source_rgb(eventData, 0.5, 0.6, 0.3);
                                //设置画笔的大小
                                Cairo.cairo_set_line_width(eventData, 3);                        
        
                                //画一个圆
                                Cairo.cairo_arc(eventData, circlePoint, circlePoint, 60, 0, 2*3.1415926);
                                //画一个圆弧
                                //Cairo.cairo_arc(eventData, 200, 200, 70,1.5*3.1415925, 2*3.1415926);
                                //显示画笔
                                Cairo.cairo_stroke(eventData); //Cairo.cairo_fill(eventData)不同的效果
                                
                                
                                //画一个圆弧  有下面实验知道是从x轴沿顺时针开始画图

                                //嘴巴的绘制
                                double Pi = 3.1415926;
                                Cairo.cairo_arc(eventData, circlePoint, circlePoint, 40, 0.25*Pi, 0.75*Pi);
                                Cairo.cairo_fill(eventData);
                                
                                //绘制两只眼睛
                                Cairo.cairo_arc(eventData, circlePoint-20, circlePoint-20, 10, 0, 2*Pi);
                                Cairo.cairo_arc(eventData, circlePoint+20, circlePoint-20, 10, 0, 2*Pi);
                                Cairo.cairo_fill(eventData);
                        }
                }, null);
                
                
        }

}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case2  三毛头部自画像  加入了文字的绘制&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.rupeng.gtk4j.Cairo;
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;

/**
* 
*/

/**
* @author 叶昭良
* @version GTKCairoText V1.0
*
*/
public class GTKTestCairoText
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                //GTK初始化
                GTK.gtk_init();
                //窗口标识
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                //窗口标题
                GTK.gtk_window_set_title(window, &amp;quot;简易画图板v2.0&amp;quot;);
                //显示窗口
                GTK.gtk_widget_show(window);
                
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
                
                
                //设置布局方式
                gridHouse = GTK.gtk_grid_new();
                
                
                //创建控件
                int start = 0;
                createDraw(window, gridHouse, start);
                //circlePoint 原点设置为180

                
                
                GTK.gtk_widget_show(gridHouse);
                
                GTK.gtk_container_add(window,gridHouse);
                //启动循环
                GTK.gtk_main();
        }
        
        public static void createDraw(int window,int gridHouse,int start) 
        {
                //创建画图板 或者叫画布
                int  dan  = GTK.gtk_drawing_area_new();
                
                int label = GTK.gtk_label_new(&amp;quot;三毛&amp;quot;);
                //创建源
                //添加控件
                GTK.gtk_grid_attach(gridHouse, label, 0, start, 1, 1);
                GTK.gtk_grid_attach(gridHouse, dan, 1, start, 1, 1);
                //显示画布
                GTK.gtk_widget_show(dan);
                GTK.gtk_widget_show(label);
                
                //设置画布的大小
                GTK.gtk_widget_set_size_request(dan, 300, 300);
                
                
                //开始绘制  利用事件draw 来不断的绘制
                
                GTK.g_signal_connect(dan, &amp;quot;draw&amp;quot;,new IGCallBack() 
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                //eventDate才是画布源
                                //设置画笔的颜色
                                Cairo.cairo_set_source_rgb(eventData, 0.5, 0.6, 0.3);
                                //设置画笔的大小
                                Cairo.cairo_set_line_width(eventData, 3);
                                
                                
                                
                                //移动画笔点   画笔默认位置不是在（0,0）move_to不可少
                                //Cairo.cairo_move_to(eventData, 0, 0);

                                //画一个圆
                                Cairo.cairo_arc(eventData, 180, 180, 60, 0, 2*3.1415926);
                                //画一个圆弧
                                //Cairo.cairo_arc(eventData, 200, 200, 70,1.5*3.1415925, 2*3.1415926);
                                //显示画笔
                                Cairo.cairo_stroke(eventData); //Cairo.cairo_fill(eventData)不同的效果
                                
                                
                                //画一个圆弧  有下面实验知道是从x轴沿顺时针开始画图

                                //嘴巴的绘制
                                double Pi = 3.1415926;
                                Cairo.cairo_arc(eventData, 180, 180, 40, 0.25*Pi, 0.75*Pi);
                                Cairo.cairo_fill(eventData);
                                
                                //绘制两只眼睛
                                Cairo.cairo_arc(eventData, 160, 160, 10, 0, 2*Pi);
                                Cairo.cairo_arc(eventData, 200, 160, 10, 0, 2*Pi);
                                Cairo.cairo_fill(eventData);
                                
                                
                                //绘制胡须
                                Cairo.cairo_arc(eventData, 130, 160, 50, 0.166667*Pi, 0.6777777*Pi);
                                
                                Cairo.cairo_stroke(eventData);
                                
                                Cairo.cairo_arc(eventData, 230, 160, 50, 0.333333*Pi, 0.8333333*Pi);
                                Cairo.cairo_stroke(eventData);
                                
                                //绘制头发
                                Cairo.cairo_arc(eventData, 133.6, 136.72, 30,1.3333333*Pi ,1.833333*Pi );
                                
                                Cairo.cairo_stroke(eventData);
                                
                                Cairo.cairo_arc(eventData, 224.4, 136.72, 30, 1.166667*Pi, 1.6777777*Pi);
                                Cairo.cairo_stroke(eventData);
                                
                                
                                //移动画笔点   画笔默认位置不是在（0,0）move_to不可少
                                Cairo.cairo_move_to(eventData, 180, 120);
                            //画一条线七点
                                Cairo.cairo_line_to(eventData, 180, 90);
                                Cairo.cairo_stroke(eventData);
                                
                                
                                //画文字
                                Cairo.cairo_move_to(eventData, 180, 260);
                                Cairo.cairo_set_source_rgb(eventData, 0.4, 0.3, 0.2);
                                Cairo.cairo_set_font_size(eventData, 16);
                                //选择文字类型
                                Cairo.cairo_select_font_face(eventData, &amp;quot;宋体&amp;quot;, Cairo.CAIRO_FONT_SLANT_ITALIC, Cairo.CAIRO_FONT_WEIGHT_BOLD);
                                Cairo.cairo_show_text(eventData,&amp;quot;三毛的自画像&amp;quot;);
                                //Cairo.cairo_stroke(eventData);  //不需要这句话也可以
                        }
                }, null);
                
                
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;case3  折线图  复习了数组  + 对称折线&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
* @author    叶昭良
* @time      2015年2月1日上午11:30:12
* @version   TestLine V1.0
*/
import com.rupeng.gtk4j.GTK;
import com.rupeng.gtk4j.IGCallBack;
import com.rupeng.gtk4j.Cairo;

public class TestLine
{

        /**
         * @param args
         */
        static int window;
        static int gridHouse;
        static int scrolledBar;
        public static void main(String[] args)
        {
                // TODO 自动生成的方法存根
                //初始化
                GTK.gtk_init();
                window = GTK.gtk_window_new(GTK.GTK_WINDOW_TOPLEVEL);
                //添加窗口
                GTK.gtk_widget_show(window);
                //安静关闭
                GTK.g_signal_connect(window, &amp;quot;destroy&amp;quot;, new IGCallBack()
                {
                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                GTK.gtk_main_quit();
                        }
                }, null);
/*                //创建布局：
                gridHouse = GTK.gtk_grid_new();*/
                
                int drawArea = GTK.gtk_drawing_area_new();
                GTK.gtk_widget_set_size_request(drawArea, 500, 500);
                //GTK.gtk_container_add(window, gridHouse);
                GTK.gtk_container_add(window, drawArea);
                GTK.g_signal_connect(drawArea, &amp;quot;draw&amp;quot;, new IGCallBack()
                {

                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                Cairo.cairo_move_to(eventData, 0, 500);
                                int[] arrApple = {50, 90, 80, 120, 10, 50};
                                
                                // 获取最大值
                                int max = arrApple[0];
                                for(int i = 1; i &amp;lt; arrApple.length; i++)
                                {
                                        if(max &amp;lt; arrApple[i])
                                        {
                                                max = arrApple[i];
                                        }
                                }
                                // 
                                for(int i = 0; i&amp;lt;  arrApple.length; i++)
                                {
                                        // 获取坐标(x,y)
                                        int  x =  (i+1)*50;
                                        int  y =  500 - 500*arrApple[i]/max;
                                        // 绘制坐标点
                                        Cairo.cairo_line_to(eventData, x, y);
                                }
                                // 创建绘画
                                Cairo.cairo_stroke(eventData);
                        }
                        
                }, null);
                 createDraw( window, drawArea, gridHouse,0);
                GTK.gtk_widget_show(drawArea);
                //添加循环
                GTK.gtk_main();
        }
        
        public static void createDraw(int window, int drawArea,int gridHouse,int start)
        {
                GTK.g_signal_connect(drawArea, &amp;quot;draw&amp;quot;, new IGCallBack()
                {

                        @Override
                        public void execute(int instance, int eventData, Object object)
                        {
                                // TODO 自动生成的方法存根
                                Cairo.cairo_move_to(eventData, 0, 0);
                                int[] arrApple = {50, 90, 80, 120, 10, 50};
                                
                                // 获取最大值
                                int max = arrApple[0];
                                for(int i = 1; i &amp;lt; arrApple.length; i++)
                                {
                                        if(max &amp;lt; arrApple[i])
                                        {
                                                max = arrApple[i];
                                        }
                                }
                                // 
                                for(int i = 0; i&amp;lt;  arrApple.length; i++)
                                {
                                        // 获取坐标(x,y)
                                        int  x =  (i+1)*50;
                                        //int  y =  300 - 300*arrApple[i]/max;
                                        int  y =  500*arrApple[i]/max;
                                        // 绘制坐标点
                                        Cairo.cairo_line_to(eventData, x, y);
                                }
                                // 创建绘画
                                Cairo.cairo_stroke(eventData);
                        }
                        
                }, null);
                //createScrolledBar(window,drawArea,scrolledBar,start);
        }
/*         //滚动条无法用于drawArea
        public static void createScrolledBar(int window,int drawArea,int scrolledBar,int start) 
        {
                scrolledBar = GTK.gtk_scrolled_window_new();
                GTK.gtk_widget_set_size_request(scrolledBar, 300, 100);
                GTK.gtk_widget_show(scrolledBar);
                GTK.gtk_container_add(scrolledBar,drawArea);
                GTK.gtk_grid_attach(gridHouse, scrolledBar, 0, start, 1, 1);
                
        }*/

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/sanmao.gif&#34; alt=&#34;三毛的自画像&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/jianyi.gif&#34; alt=&#34;三毛+笑脸&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/ButtonImage.gif&#34; alt=&#34;图片按钮&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/calc2.gif&#34; alt=&#34;计算器v2.0 使用spinbox&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/spinbox1.gif&#34; alt=&#34;spinbox的数字范围&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nvshen2.gif&#34; alt=&#34;女神告白神器2 加入了迭代插入&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/nvshen.gif&#34; alt=&#34;女神告白神奇 TextView的初次使用&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/shuiguo.gif&#34; alt=&#34;水果购买选择器&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/province.gif&#34; alt=&#34;省市联动器&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/huizhide.png&#34; alt=&#34;笑脸的绘制测量&#34;&gt;
&lt;img src=&#34;https://jueqingsizhe66.github.io/images/java/symmetry.gif&#34; alt=&#34;对称折线图&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>模块分割--工厂机制</title>
      <link>https://jueqingsizhe66.github.io/blog/2014/05/15/mo-kuai-fen-ge-gong-han-ji-zhi/</link>
      <pubDate>Thu, 15 May 2014 22:27:07 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2014/05/15/mo-kuai-fen-ge-gong-han-ji-zhi/</guid>
      <description>&lt;ol&gt;
&lt;li&gt;map&lt;/li&gt;
&lt;li&gt;reduce&lt;/li&gt;
&lt;li&gt;deploy(by makefile)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;#map&amp;mdash;do   or map&amp;ndash;action#&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;FC=gfortran
FFLAGS=-O3
split : ./f90split.f90 ./output/cmd.sh
    $(FC) $(FFLAGS) $^ -o $@
    mv $@ ./output/
    /bin/sh ./output/cmd.sh

.PHONY: clean
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id=&#34;不是不适合是超级适合只不过你不会而已&#34;&gt;不是不适合，是超级适合，只不过你不会而已&lt;/h2&gt;
&lt;p&gt;#makefile:(负责让对应的文件夹去做对应的事情)#&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;FC=gfortran
FFLAGS=-O3
split : ./f90split.f90 ./output/cmd.sh
    $(FC) $(FFLAGS) $&amp;lt; -o $@                # 造出一个工人出来！
    cp $@ ./output/          # 把一个高级技术工人调到现场 去干活去！  最好用cp 这样就可以派到其他工厂去了
    cd ./output/ &amp;amp;&amp;amp;sh cmd.sh#切换到对应目录下 去做他该做的事情就可以了（而不是原先你想的

    # sh .output/cmd.sh 这样是在当前的目录下产生所有的东西 而不是对应的目录）
.PHONY: clean

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#在我的output目录下新建了一个#
##cmd.sh:(他只做本目录下的内容)##&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/sh
# sh cmd.sh

for i in `ls -l /home/incompact3dNew/channel|grep f90|awk &#39;{print $NF}&#39;`;
do
    file=/home/incompact3dNew/channel/$i;
#    echo $file;
     ./split $file
done;
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>makefile编译fortran的module</title>
      <link>https://jueqingsizhe66.github.io/blog/2014/05/14/makefilebian-yi-fortrande-module/</link>
      <pubDate>Wed, 14 May 2014 13:09:20 +0800</pubDate>
      <guid>https://jueqingsizhe66.github.io/blog/2014/05/14/makefilebian-yi-fortrande-module/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;FC = gfortran
FFLAGS = -g -Wall -O3 --free-form
modFFLAGS =  --free-form

OPTFC = -O3 -funroll-loops -ftree-vectorize -fcray-pointer -cpp
#src = $(wildcard *.f90)
src = secdmo.f90 record.f90
obj = $(src:.f90=.o )
secd : $(obj)
    $(FC) $(FFLAGS) -o $@ $^

%.o : %.f90
    $(FC) $(modFFLAGS) $(OPTFC) -c $&amp;lt;

#secdmo.mod : secdmo.f
#	$(FC) $(modFFLAGS) @ $&amp;lt;

.phony: clean

clean:
    rm -rf secd secdmo.mod funct.plo accu* fort* ./errdi* *.o

&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
  </channel>
</rss>
