<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="令狐冲">

  
  
  
    
  
  <meta name="description" content="Blog Ideas DONE perl拆分大文件到excel表 背景介绍 在风资源分析中">

  
  <link rel="alternate" hreflang="en-us" href="https://jueqingsizhe66.github.io/post/blog/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  




  
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','4703127160');
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://jueqingsizhe66.github.io/post/blog/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jueqingsizhe66">
  <meta property="twitter:creator" content="@jueqingsizhe66">
  
  <meta property="og:site_name" content="30年磨一剑">
  <meta property="og:url" content="https://jueqingsizhe66.github.io/post/blog/">
  <meta property="og:title" content=" | 30年磨一剑">
  <meta property="og:description" content="Blog Ideas DONE perl拆分大文件到excel表 背景介绍 在风资源分析中"><meta property="og:image" content="https://jueqingsizhe66.github.io/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_3.png">
  <meta property="twitter:image" content="https://jueqingsizhe66.github.io/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-10-07T20:08:21&#43;08:00">
    
    <meta property="article:modified_time" content="2021-10-07T20:08:21&#43;08:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jueqingsizhe66.github.io/post/blog/"
  },
  "headline": "",
  
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "2021-10-07T20:08:21+08:00",
  
  "author": {
    "@type": "Person",
    "name": "令狐冲"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "30年磨一剑",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jueqingsizhe66.github.io/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Blog Ideas DONE perl拆分大文件到excel表 背景介绍 在风资源分析中"
}
</script>

  

  


  


  





  <title> | 30年磨一剑</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  <script src="/js/wowchemy-init.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">30年磨一剑</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">30年磨一剑</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>概要</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>博文</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/categories/"><span>分类</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/archives"><span>归档</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>标签</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  








  
 <script async src="//cdn.busuanzi.ibruce.info/cdn/busuanzi/2.3/busuanzi.pure.mini.js"></script> 
 <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> 
 <script> 
     $(document).ready(function() { 
         var int = setInterval(fixCount, 100); 
         var busuanziSiteOffset =  100000  
         function fixCount() { 
             if ($("#busuanzi_container_site_pv").css("display") != "none") { 
                 clearInterval(int); 
                 $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + busuanziSiteOffset); 
             } 
         } 
     }); 
 </script> 
  






  

  
  
  
<div class="article-container pt-3">
  <h1></h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    2021年10月7日
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    28 min read
  </span>
  

  
  
  
  
  

  
  

</div>

    














  
</div>





<span class="article-metadata" >Reading time: 62 minutes and    53 seconds with 13836 words. 本文总阅读量<span id="busuanzi_value_page_pv"></span>次 </span>
    <aside>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#blog-ideas">Blog Ideas</a>
      <ul>
        <li><a href="#perl拆分大文件到excel表"><span class="org-todo done DONE">DONE</span> perl拆分大文件到excel表</a></li>
        <li><a href="#python提取多个文件汇总到一个excel表"><span class="org-todo done DONE">DONE</span> python提取多个文件汇总到一个excel表</a></li>
        <li><a href="#python提取多个文件的存在null速度廓线"><span class="org-todo done DONE">DONE</span> python提取多个文件的存在null速度廓线</a></li>
        <li><a href="#python提取各个扇区不同机位点风速风向表"><span class="org-todo done DONE">DONE</span> python提取各个扇区不同机位点风速风向表</a></li>
        <li><a href="#python对比作图两个风速风向表"><span class="org-todo done DONE">DONE</span> python对比作图两个风速风向表</a></li>
        <li><a href="#python众多文件中提取轮毂高度处风速"><span class="org-todo done DONE">DONE</span> python众多文件中提取轮毂高度处风速</a></li>
        <li><a href="#python-pandas数据结构转化"><span class="org-todo done DONE">DONE</span> python pandas数据结构转化</a></li>
        <li><a href="#玩转python-datetime"><span class="org-todo done DONE">DONE</span> 玩转python datetime</a></li>
        <li><a href="#perl批量工作机器程序-设计-programme-python"><span class="org-todo done DONE">DONE</span> perl批量工作机器程序                  @设计:@programme:python:</a></li>
        <li><a href="#python制作曲线动画"><span class="org-todo done DONE">DONE</span> python制作曲线动画</a></li>
        <li><a href="#风电场scada风速手算理论发电量和k值"><span class="org-todo done DONE">DONE</span> 风电场SCADA风速手算理论发电量和K值</a></li>
        <li><a href="#语言的魅力"><span class="org-todo todo TODO">TODO</span> 语言的魅力</a></li>
        <li><a href="#python绕点旋转"><span class="org-todo done DONE">DONE</span> python绕点旋转</a></li>
        <li><a href="#python提取时间序列白天和黑夜的时间段"><span class="org-todo done DONE">DONE</span> python提取时间序列白天和黑夜的时间段</a></li>
        <li><a href="#健身活动计划"><span class="org-todo done DONE">DONE</span> 健身活动计划</a></li>
        <li><a href="#相互资源竞争带来恶性循环"><span class="org-todo done DONE">DONE</span> 相互资源竞争带来恶性循环</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </aside>
  <div class="article-container">


    <div class="article-style">
      <h2 id="blog-ideas">Blog Ideas</h2>
<h3 id="perl拆分大文件到excel表"><span class="org-todo done DONE">DONE</span> perl拆分大文件到excel表</h3>
<h4 id="背景介绍">背景介绍</h4>
<p>在风资源分析中，经常需要导出测风塔和风机点位不同扇区下的风速风向、湍流度等风资源信息，而这些信息导出后糅合在同一个大的文件下不好分析，为此需要进行拆分.</p>
<p>数据文件也有一些规律和关键信息，看下面的原始数据片段</p>
<pre><code class="language-text">
WECS number        :          1
WECS name          : T12
Manufacturer       : GW121.1
Type               : gw
Nominal effect     :       2500
Hub height         :       90.0
x (local)          :     5452.0
y (local)          :     4103.5
x (global)         : 20380130.0
y (global)         :  4475007.5



sector:     0

  k       z-coord        UCRT         VCRT         WCRT      Speed_2D       Inflow        Shear    Shear_low   Shear_high           KE           TI        alpha           EP
 (-)        (m)          (m/s)        (m/s)        (m/s)        (m/s)        (deg)        (1/s)        (1/s)        (1/s)    (m*2/s*2)          (%)          (-)    (m*2/s*3)
   1        4.546        0.076       -3.410       -0.093        3.411       -1.557        0.316        0.750        0.099        0.325       19.289        0.212       0.0165
   2       13.636        0.095       -4.306       -0.158        4.307       -2.107        0.072        0.099        0.045        0.364       16.171        0.195       0.0069

   ....

WECS number        :         23
WECS name          : T18
Manufacturer       : GW121.1
Type               : gw
Nominal effect     :       2500
Hub height         :       90.0
x (local)          :     4920.0
y (local)          :     5961.5
x (global)         : 20379598.0
y (global)         :  4476865.5



sector:     0

  k       z-coord        UCRT         VCRT         WCRT      Speed_2D       Inflow        Shear    Shear_low   Shear_high           KE           TI        alpha           EP
 (-)        (m)          (m/s)        (m/s)        (m/s)        (m/s)        (deg)        (1/s)        (1/s)        (1/s)    (m*2/s*2)          (%)          (-)    (m*2/s*3)
   1        4.545       -0.043       -3.503       -0.156        3.503       -2.558        0.304        0.771        0.071        0.343       19.305        0.154       0.0180


sector:   337

  k       z-coord        UCRT         VCRT         WCRT      Speed_2D       Inflow        Shear    Shear_low   Shear_high           KE           TI        alpha           EP
 (-)        (m)          (m/s)        (m/s)        (m/s)        (m/s)        (deg)        (1/s)        (1/s)        (1/s)    (m*2/s*2)          (%)          (-)    (m*2/s*3)
   1        4.545        1.902       -3.359       -0.050        3.860       -0.744        0.325        0.849        0.064        0.412       19.205        0.127       0.0235
   2       13.636        1.984       -3.970       -0.124        4.438       -1.595        0.045        0.064        0.025        0.418       16.813        0.113       0.0076
   3       22.727        1.986       -4.226       -0.166        4.670       -2.035        0.022        0.025        0.018        0.450       16.586        0.101       0.0046
</code></pre>
<h4 id="原始数据分析">原始数据分析</h4>
<p>通过分析发现，数据具有以下特点</p>
<ol>
<li>存在WECS name ，代表新的机位点</li>
<li>每个机位点 有很多的扇区，sector开头，并用冒号划分</li>
<li>为了提取坐标信息，增加了global字段，分别提取x， y信息,可用于保存文件名</li>
<li>存在WECS name 表示停止打印标记</li>
<li>Sector之下的一行到数据信息截止【下一个扇区前或者WECS name前】需要保存到一个文件内</li>
</ol>
<h4 id="技术需求梳理">技术需求梳理</h4>
<ol>
<li>每个文件起名标准，&ldquo;风机名-扇区名.csv&rdquo;</li>
<li>什么时候修改风机名？ 遇到WECS name的时候； 但因为还需要提取x,y信息放入headname所以增加一个skip的标记号
<ol>
<li>skip==1 表示在sector数据范围内,开始打印到文件名内【此时用于提取核心数据】</li>
<li>skip==2 表示在新风机位置处[此时用于提取x, y坐标信息]</li>
<li>skip==3 表示停止打印，遇到WECS number【此时用于截断数据打印】</li>
</ol>
</li>
<li>得到扇区名字后，开始进行文件读取命令</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<p>为此设计了需求字段</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl"><span style="color:#66d9ef">my</span>  $specialSectorTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sector&#34;</span>;
<span style="color:#66d9ef">my</span>  $specialHeadTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;WECS name&#34;</span>;
<span style="color:#75715e">#my  $specialHeadTag=&#34;Clim name&#34;;</span>
<span style="color:#75715e">## Sometimes, there are chinese （）</span>
<span style="color:#66d9ef">my</span>  $specialHeadTag1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;global&#34;</span>;
<span style="color:#66d9ef">my</span>  $specialPrintTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;z-coord&#34;</span>;
<span style="color:#66d9ef">my</span>  $specialStopPrintTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;WECS number&#34;</span>;
<span style="color:#75715e">#my  $specialStopPrintTag=&#34;Climatology number&#34;;</span>
<span style="color:#66d9ef">my</span>  $skip<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;</code></pre></div>
<p>其中SectorTag表示得到扇区信息,开始生成文件名，创建文件指针，
SpecialHeadTag可设置多个，当前只需要提取头部两个信息，分别为WECS name风机名字和全局坐标点，所以设置了HeadTag 和HeadTag1，理论上无数多个</p>
<p>PrintTag用于打印核心数据； StopPrintTag用于停止打印核心数据</p>
<p>所有源代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl"><span style="color:#75715e">#!/usr/bin/env perl</span>
<span style="color:#75715e">#===============================================================================</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#         FILE: forSplitWindSim.pl</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#        USAGE: ./forSplitWindSim.pl</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#  DESCRIPTION:</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#      OPTIONS: ---</span>
<span style="color:#75715e"># REQUIREMENTS: ---</span>
<span style="color:#75715e">#         BUGS: ---</span>
<span style="color:#75715e">#        NOTES: ---</span>
<span style="color:#75715e">#       AUTHOR: Ye Zhaoliang (Ye Zhaoliang), yezhaoliang@ncepu.edu.cn</span>
<span style="color:#75715e"># ORGANIZATION:</span>
<span style="color:#75715e">#      VERSION: 1.0</span>
<span style="color:#75715e">#      CREATED: 2019-10-15 14:31:13</span>
<span style="color:#75715e">#     REVISION: ---</span>
<span style="color:#75715e">#===============================================================================</span>

<span style="color:#66d9ef">use</span> strict;
<span style="color:#66d9ef">use</span> warnings;
<span style="color:#66d9ef">use</span> utf8;

<span style="color:#66d9ef">my</span>  $specialSectorTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sector&#34;</span>;
<span style="color:#66d9ef">my</span>  $specialHeadTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;WECS name&#34;</span>;
<span style="color:#75715e">#my  $specialHeadTag=&#34;Clim name&#34;;</span>
<span style="color:#75715e">## Sometimes, there are chinese （）</span>
<span style="color:#66d9ef">my</span>  $specialHeadTag1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;global&#34;</span>;
<span style="color:#66d9ef">my</span>  $specialPrintTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;z-coord&#34;</span>;
<span style="color:#66d9ef">my</span>  $specialStopPrintTag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;WECS number&#34;</span>;
<span style="color:#75715e">#my  $specialStopPrintTag=&#34;Climatology number&#34;;</span>
<span style="color:#66d9ef">my</span>  $skip<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;

<span style="color:#75715e">#my	$INPUTDATA_file_name = &#39;D:/vertical_profile_wecs_cosMount.dat&#39;;		# input file name</span>
<span style="color:#66d9ef">my</span>	$INPUTDATA_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\work\AIWind\processWindSim\HuaiLaiTurbineZhuFengxiang\vertical_profile_wecs.dat&#39;</span>;		<span style="color:#75715e"># in</span>

open  <span style="color:#66d9ef">my</span> $INPUTDATA, <span style="color:#e6db74">&#39;&lt;&#39;</span>, $INPUTDATA_file_name
    <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  input file &#39;$INPUTDATA_file_name&#39; : $!\n&#34;</span>;

<span style="color:#66d9ef">my</span>  $filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>;
<span style="color:#66d9ef">my</span>  $headName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>;
<span style="color:#66d9ef">my</span>  $sectorName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>;
<span style="color:#66d9ef">my</span> $INPUTDATAsector;
<span style="color:#66d9ef">my</span>	$INPUTDATAsector_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;		<span style="color:#75715e"># input file name</span>

<span style="color:#66d9ef">while</span> ( <span style="color:#e6db74">&lt;$INPUTDATA&gt;</span> ) {

    <span style="color:#75715e">## Jump out empty line</span>
    <span style="color:#66d9ef">next</span> <span style="color:#66d9ef">if</span> ($_<span style="color:#f92672">=~</span><span style="color:#e6db74">/^\s*$/</span>);
    chomp();
    <span style="color:#66d9ef">my</span>  $line<span style="color:#f92672">=</span>trim($_);
    <span style="color:#75715e">#my  @columns=split(/\s+|:/,$line);</span>
    <span style="color:#75715e"># Every files have different patterns, you need to feel it! Modify it!</span>
    <span style="color:#66d9ef">my</span>  @columns<span style="color:#f92672">=</span>split(<span style="color:#e6db74">/:/</span>,$line);
    <span style="color:#66d9ef">print</span> $#columns,<span style="color:#e6db74">&#34;\n&#34;</span>;
    <span style="color:#75715e">#print &#34;$.: $_\n&#34; if($_=~/kpoint/);</span>

    <span style="color:#75715e">##  Test commands for specialTag1  when you are using newest word</span>
    <span style="color:#75715e">##   You need to find out the most comfortable pattern  for you</span>
    <span style="color:#75715e">#print &#34;$.: Sector $columns[0]  $columns[1] \n&#34; if($line=~/$specialSectorTag/);</span>
    <span style="color:#75715e">#print &#34;$.: Name     $columns[0]  $columns[1] \n&#34; if($line=~/$specialHeadTag/);</span>
    <span style="color:#75715e">#print &#34;$.: X     $columns[0]  $columns[1] \n&#34; if($line=~/$specialHeadTag1/);</span>


    <span style="color:#66d9ef">my</span>	$INPUTDATAsector_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;		<span style="color:#75715e"># input file name</span>


    <span style="color:#75715e">## 根据skip标记号控制打印,逐行执行,</span>
    <span style="color:#75715e">## tag the start print position with $specialPrintTag</span>
    <span style="color:#75715e">## tag the end print position with $specialStopPrintTag</span>
    <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span><span style="color:#e6db74">/$specialHeadTag|$specialHeadTag1/</span> <span style="color:#f92672">&amp;&amp;</span> $skip<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span>) {

        $headName <span style="color:#f92672">=</span> trim($columns[<span style="color:#ae81ff">1</span>]);  <span style="color:#75715e">## update the headName</span>
        $skip <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
    }<span style="color:#66d9ef">elsif</span>(( $line <span style="color:#f92672">=~</span><span style="color:#e6db74">/$specialHeadTag|$specialHeadTag1/</span> <span style="color:#f92672">&amp;&amp;</span> $skip<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>)){

        $headName <span style="color:#f92672">=</span> join(<span style="color:#e6db74">&#34;-&#34;</span>,trim($headName),trim($columns[<span style="color:#ae81ff">1</span>])); <span style="color:#75715e">## Apeend the headName</span>
    }

    <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span><span style="color:#e6db74">/$specialSectorTag/</span> ) {

        $sectorName <span style="color:#f92672">=</span> trim($columns[<span style="color:#ae81ff">1</span>]);
        $INPUTDATAsector_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D://$headName-$sectorName.csv&#34;</span>;		<span style="color:#75715e"># input file name</span>
        open  $INPUTDATAsector, <span style="color:#e6db74">&#39;&gt;&#39;</span>, $INPUTDATAsector_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  input file &#39;$INPUTDATAsector_file_name&#39; : $!\n&#34;</span>;

        <span style="color:#75715e">#        $skip=1;</span>
    }

    <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span><span style="color:#e6db74"> /$specialPrintTag/</span>) {
        $skip<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
    }

    <span style="color:#75715e">### New Position for different sectors</span>
    <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span><span style="color:#e6db74"> /$specialStopPrintTag/</span>) {
        $skip<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>;

    }

    <span style="color:#66d9ef">if</span> ( $skip <span style="color:#f92672">==</span><span style="color:#ae81ff">1</span> ) {
        $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/\s+/,/g</span>;  <span style="color:#75715e">### colon separate delimiter</span>
        <span style="color:#66d9ef">print</span> $INPUTDATAsector $line,<span style="color:#e6db74">&#34;\n&#34;</span>;

    }


}
close  $INPUTDATA
    <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close input file &#39;$INPUTDATA_file_name&#39; : $!\n&#34;</span>;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">ltrim</span> { <span style="color:#66d9ef">my</span> $s <span style="color:#f92672">=</span> shift; $s <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/^\s+//</span>;       <span style="color:#66d9ef">return</span> $s };
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">rtrim</span> { <span style="color:#66d9ef">my</span> $s <span style="color:#f92672">=</span> shift; $s <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/\s+$//</span>;       <span style="color:#66d9ef">return</span> $s };
<span style="color:#66d9ef">sub</span>  <span style="color:#a6e22e">trim</span> { <span style="color:#66d9ef">my</span> $s <span style="color:#f92672">=</span> shift; $s <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/^\s+|\s+$//g</span>; <span style="color:#66d9ef">return</span> $s };</code></pre></div>
<h3 id="python提取多个文件汇总到一个excel表"><span class="org-todo done DONE">DONE</span> python提取多个文件汇总到一个excel表</h3>
<h4 id="背景介绍">背景介绍</h4>
<p>在<a href="https://jueqingsizhe66.github.io/post/perl%25E6%258B%2586%25E5%2588%2586%25E5%25A4%25A7%25E6%2596%2587%25E4%25BB%25B6%25E5%2588%25B0excel%25E8%25A1%25A8/" target="_blank" rel="noopener">perl拆分大文件</a>后我们得到下图信息</p>
<p><a href="/images/windsim/windsimResults.png">windsim处理结果</a></p>
<p>我们希望单独提取三列信息到一个excel表大文件夹内，方便比较数据</p>
<h4 id="技术分解">技术分解</h4>
<ol>
<li>遍历</li>
<li>提却对应文件标识信息，并保存计算结果到xlsx文件</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<p>主要用到pandas的ExcelWriter函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> os


<span style="color:#75715e">#headDir=r&#34;C:\Users\yezhaoliang\Desktop\work\AIWind\CompareCloseTOSingle\8.00&#34;</span>
headDir<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\work\AIWind\processWindSim\HuaiLaiTurbine&#34;</span>
<span style="color:#75715e">#headDir=r&#34;D:\BoundaryLines&#34;</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_files</span>(path<span style="color:#f92672">=</span>headDir, rule<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.csv&#34;</span>):
    all <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> fpathe,dirs,fs <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(path):   <span style="color:#75715e"># os.walk是获取所有的目录</span>
        <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> fs:
            filename <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(fpathe,f)
            <span style="color:#66d9ef">if</span> filename<span style="color:#f92672">.</span>endswith(rule):  <span style="color:#75715e"># 判断是否是&#34;xxx&#34;结尾</span>
                all<span style="color:#f92672">.</span>append(filename)
    <span style="color:#66d9ef">return</span> all

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    b <span style="color:#f92672">=</span> get_files()
    writer<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelWriter(<span style="color:#e6db74">&#34;Results-WindSimHuaiLaiTurbine.xlsx&#34;</span>)
    altitudesName<span style="color:#f92672">=</span>[]
    <span style="color:#75715e"># googleEarthAltitude=[]</span>
    <span style="color:#75715e"># computedAltitude=[]</span>
    <span style="color:#75715e"># deltaAltitude=[]</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> b:
        them<span style="color:#f92672">=</span>i<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>)
        <span style="color:#75715e">#secondPart=them[them.__len__()-2]</span>
        <span style="color:#75715e"># sheetName=them[them.__len__()-3]+them[them.__len__()-2]+them[them.__len__()-1]</span>
        <span style="color:#75715e">#sheetName=them[them.__len__()-3]+them[them.__len__()-2]+them[them.__len__()-1]</span>
        sheetName<span style="color:#f92672">=</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
        altitudesName<span style="color:#f92672">.</span>append(sheetName)
        sd<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(i,skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
        <span style="color:#75715e">## 去除Null行（注意空格，数字也一样处理)</span>
        <span style="color:#75715e">#squeezeZseries = sdNotNull.iloc[0:300, 2] - sdNotNull.iat[0, 2]  ## 减去海拔值</span>

        result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
            <span style="color:#e6db74">&#39;Velocity v/(m/s)&#39;</span>:sd<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">5</span>],
            <span style="color:#e6db74">&#39;KE /(m*2/s*2)&#39;</span>:sd<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">10</span>],
            <span style="color:#e6db74">&#39;Z/(m)&#39;</span>:sd<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">1</span>]})
        result<span style="color:#f92672">.</span>to_excel(writer,sheet_name<span style="color:#f92672">=</span>sheetName)
    writer<span style="color:#f92672">.</span>save()
    writer<span style="color:#f92672">.</span>close()</code></pre></div>
<h3 id="python提取多个文件的存在null速度廓线"><span class="org-todo done DONE">DONE</span> python提取多个文件的存在null速度廓线</h3>
<h4 id="背景介绍">背景介绍</h4>
<p>在前面 <a href="https://jueqingsizhe66.github.io/post/python%25E6%258F%2590%25E5%258F%2596%25E5%25A4%259A%25E4%25B8%25AA%25E6%2596%2587%25E4%25BB%25B6%25E6%25B1%2587%25E6%2580%25BB%25E5%2588%25B0%25E4%25B8%2580%25E4%25B8%25AAexcel%25E8%25A1%25A8/" target="_blank" rel="noopener">python提取多个文件</a>的案例中，只是遍历了全部有效数据，并提取其中两列数据，
而如果数据存在NULL? pandas该如何处理?</p>
<p>在CFDpost处理怀来风电场数据的廓线时候遇到如下问题，速度廓线存在Null值，如下图所示</p>
<p><a href="/images/aiwind/AIWINDVelocity.png">AIWINDVelocity</a></p>
<h4 id="技术分解">技术分解</h4>
<ol>
<li>遍历</li>
<li>提取所有非Null行 满足条件sd[sd.iloc[:, 3] != ' null'] 即可。</li>
<li>减去对应海拔值</li>
<li>存储结果到对应的sheet表中</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> os


headDir<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\PythonAIWind\pandasHuaiLaiProfile&#34;</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_files</span>(path<span style="color:#f92672">=</span>headDir, rule<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.csv&#34;</span>):
    all <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> fpathe,dirs,fs <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(path):   <span style="color:#75715e"># os.walk是获取所有的目录</span>
        <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> fs:
            filename <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(fpathe,f)
            <span style="color:#66d9ef">if</span> filename<span style="color:#f92672">.</span>endswith(rule):  <span style="color:#75715e"># 判断是否是&#34;xxx&#34;结尾</span>
                all<span style="color:#f92672">.</span>append(filename)
    <span style="color:#66d9ef">return</span> all

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    b <span style="color:#f92672">=</span> get_files()
    writer<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelWriter(<span style="color:#e6db74">&#34;Results.xlsx&#34;</span>)
    altitudesName<span style="color:#f92672">=</span>[]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> b:
        them<span style="color:#f92672">=</span>i<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>)
        sheetName<span style="color:#f92672">=</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>]<span style="color:#f92672">+</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>]<span style="color:#f92672">+</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
        altitudesName<span style="color:#f92672">.</span>append(sheetName)
        sd<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(i,skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
        <span style="color:#75715e">## 去除Null行（注意空格，数字也一样处理)</span>
        sdNotNull <span style="color:#f92672">=</span> sd[sd<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">3</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39; null&#39;</span>]
        startZ <span style="color:#f92672">=</span> sdNotNull<span style="color:#f92672">.</span>iat[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>]  <span style="color:#75715e">## the third column at begin sequence you selected</span>
        squeezeZseries <span style="color:#f92672">=</span> sdNotNull<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> sdNotNull<span style="color:#f92672">.</span>iat[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>]  <span style="color:#75715e">## 减去海拔值</span>
        temp1 <span style="color:#f92672">=</span> sdNotNull<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">3</span>]
        temp2 <span style="color:#f92672">=</span> temp1<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;str&#39;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>strip()  <span style="color:#75715e">##转换成字符串 然后去除左右空格</span>
        squeezeVelocityseries <span style="color:#f92672">=</span> temp2<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float64&#39;</span>);
        result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([squeezeVelocityseries, squeezeZseries], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
        result<span style="color:#f92672">.</span>to_excel(writer,sheet_name<span style="color:#f92672">=</span>sheetName,index_label<span style="color:#f92672">=</span>startZ)
    writer<span style="color:#f92672">.</span>save()
    writer<span style="color:#f92672">.</span>close()
     <span style="color:#75715e">#tags=os.path.split(i)</span>
     <span style="color:#75715e">#print(os.path.join(tags[0],&#39;done&#39;,tags[1]))</span></code></pre></div>
<h4 id="问题发现">问题发现</h4>
<p>300个点得到的结果不依，高程不统一，为此专门提取500个点，可以帅选</p>
<p>改进main部分</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    b <span style="color:#f92672">=</span> get_files()
    writer<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelWriter(<span style="color:#e6db74">&#34;Results-compare-600.xlsx&#34;</span>)
    altitudesName<span style="color:#f92672">=</span>[]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> b:
        them<span style="color:#f92672">=</span>i<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>)
        secondPart<span style="color:#f92672">=</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]
        <span style="color:#75715e"># sheetName=them[them.__len__()-3]+them[them.__len__()-2]+them[them.__len__()-1]</span>
        sheetName<span style="color:#f92672">=</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>]<span style="color:#f92672">+</span>secondPart[<span style="color:#f92672">-</span><span style="color:#ae81ff">9</span>:]<span style="color:#f92672">+</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
        altitudesName<span style="color:#f92672">.</span>append(sheetName)
        sd<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(i,skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
        <span style="color:#75715e">## 去除Null行（注意空格，数字也一样处理)</span>
        sdNotNull <span style="color:#f92672">=</span> sd[sd<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">3</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39; null&#39;</span>]
        <span style="color:#75715e">#squeezeZseries = sdNotNull.iloc[0:300, 2] - sdNotNull.iat[0, 2]  ## 减去海拔值</span>
        temp1 <span style="color:#f92672">=</span> sdNotNull<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">1000</span>, <span style="color:#ae81ff">3</span>]
        temp2 <span style="color:#f92672">=</span> temp1<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;str&#39;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>strip()  <span style="color:#75715e">##转换成字符串 然后去除左右空格</span>
        squeezeVelocityseriesPre <span style="color:#f92672">=</span> temp2<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float64&#39;</span>);
        squeezeVelocityseriesPreNumpy <span style="color:#f92672">=</span> squeezeVelocityseriesPre<span style="color:#f92672">.</span>to_numpy();
        temp3 <span style="color:#f92672">=</span> sdNotNull<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">1000</span>,<span style="color:#ae81ff">2</span>]
        temp4 <span style="color:#f92672">=</span> temp3<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;str&#39;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>strip()
        squeezeZseriesPre <span style="color:#f92672">=</span> temp4<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float64&#39;</span>);
        squeezeZseriesPreNumpy <span style="color:#f92672">=</span> squeezeZseriesPre<span style="color:#f92672">.</span>to_numpy();
        initialArray<span style="color:#f92672">=</span>squeezeVelocityseriesPre[squeezeVelocityseriesPre<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">0.0</span>]<span style="color:#f92672">.</span>size
        initialZ<span style="color:#f92672">=</span>squeezeZseriesPreNumpy[initialArray]
        squeezeVelocityseriese <span style="color:#f92672">=</span> squeezeVelocityseriesPreNumpy[initialArray:initialArray<span style="color:#f92672">+</span><span style="color:#ae81ff">501</span>]
        squeezeZOriginial <span style="color:#f92672">=</span> squeezeZseriesPreNumpy[initialArray:initialArray<span style="color:#f92672">+</span><span style="color:#ae81ff">501</span>]
        squeezeZSeries <span style="color:#f92672">=</span> squeezeZseriesPreNumpy[initialArray:initialArray<span style="color:#f92672">+</span><span style="color:#ae81ff">501</span>]<span style="color:#f92672">-</span>initialZ

        result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
            <span style="color:#e6db74">&#39;Velocity/(m/s)&#39;</span>:pd<span style="color:#f92672">.</span>Series(squeezeVelocityseriese),
            <span style="color:#e6db74">&#39;Z-Z0/(m)&#39;</span>:pd<span style="color:#f92672">.</span>Series(squeezeZSeries),
            <span style="color:#e6db74">&#39;Z/(m)&#39;</span>:pd<span style="color:#f92672">.</span>Series(squeezeZOriginial)})
        result<span style="color:#f92672">.</span>to_excel(writer,sheet_name<span style="color:#f92672">=</span>sheetName)
    writer<span style="color:#f92672">.</span>save()
    writer<span style="color:#f92672">.</span>close()</code></pre></div>
<h3 id="python提取各个扇区不同机位点风速风向表"><span class="org-todo done DONE">DONE</span> python提取各个扇区不同机位点风速风向表</h3>
<h4 id="背景介绍">背景介绍</h4>
<p>在前面<a href="https://jueqingsizhe66.github.io/post/perl%25E6%258B%2586%25E5%2588%2586%25E5%25A4%25A7%25E6%2596%2587%25E4%25BB%25B6%25E5%2588%25B0excel%25E8%25A1%25A8/" target="_blank" rel="noopener">perl拆分大文件</a>一文中我们得到各个机位点在不同扇区下的物理量信息，并存放在一个excel表里头</p>
<p>而其实我们更关心的是轮毂高度处的风速风向信息，即形成下面的轮毂高度处不同扇区和机位点的风速风向</p>
<p><a href="/images/windsim/windspeedAngle.png">windSpeedAngle</a></p>
<h4 id="技术分解">技术分解</h4>
<ol>
<li>遍历</li>
<li>建立一个扇区表和特征物理量【标识信息即可】， 该特征物理量为velocity表示提取偶数行，物理量为Angle表示提取奇数行</li>
<li>对特定的物理量进行atan2计算，atan2(vx,vy)得到[-pi,+pi]范围值，加上180°就变成了[0,2pi]</li>
<li>导出数据</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<ol>
<li>建立扇区表, 即excel表列信息</li>
</ol>
<!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">columnMe<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;0&#39;</span>,<span style="color:#e6db74">&#39;22&#39;</span>,<span style="color:#e6db74">&#39;45&#39;</span>,<span style="color:#e6db74">&#39;67&#39;</span>,<span style="color:#e6db74">&#39;90&#39;</span>,<span style="color:#e6db74">&#39;112&#39;</span>,<span style="color:#e6db74">&#39;135&#39;</span>,<span style="color:#e6db74">&#39;157&#39;</span>,<span style="color:#e6db74">&#39;180&#39;</span>,<span style="color:#e6db74">&#39;202&#39;</span>,<span style="color:#e6db74">&#39;225&#39;</span>,<span style="color:#e6db74">&#39;247&#39;</span>,<span style="color:#e6db74">&#39;270&#39;</span>,<span style="color:#e6db74">&#39;292&#39;</span>,<span style="color:#e6db74">&#39;315&#39;</span>,<span style="color:#e6db74">&#39;337&#39;</span>];</code></pre></div>
<ol>
<li>
<p>建立机位风速、风向信息,即excel表行信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    indexMe<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;T12_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T12_Angle&#34;</span>, <span style="color:#e6db74">&#34;T11_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T11_Angle&#34;</span>, <span style="color:#e6db74">&#34;T10_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T10_Angle&#34;</span>, <span style="color:#e6db74">&#34;T1_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T1_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T3_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T3_Angle&#34;</span>, <span style="color:#e6db74">&#34;T2_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T2_Angle&#34;</span>, <span style="color:#e6db74">&#34;T4_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T4_Angle&#34;</span>, <span style="color:#e6db74">&#34;T5_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T5_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T9_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T9_Angle&#34;</span>, <span style="color:#e6db74">&#34;T8_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T8_Angle&#34;</span>, <span style="color:#e6db74">&#34;T7_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T7_Angle&#34;</span>, <span style="color:#e6db74">&#34;T6_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T6_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T13_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T13_Angle&#34;</span>, <span style="color:#e6db74">&#34;T14_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T14_Angle&#34;</span>, <span style="color:#e6db74">&#34;T15_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T15_Angle&#34;</span>, <span style="color:#e6db74">&#34;T16_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T16_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T17_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T17_Angle&#34;</span>, <span style="color:#e6db74">&#34;T23_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T23_Angle&#34;</span>, <span style="color:#e6db74">&#34;T22_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T22_Angle&#34;</span>, <span style="color:#e6db74">&#34;T21_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T21_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T20_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T20_Angle&#34;</span>, <span style="color:#e6db74">&#34;T19_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T19_Angle&#34;</span>, <span style="color:#e6db74">&#34;T18_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T18_Angle&#34;</span>, <span style="color:#e6db74">&#34;HL387_24035001_Velocity&#34;</span>,
     <span style="color:#e6db74">&#34;HL387_24035001_Angle&#34;</span>]

    </code></pre></div>
</li>
<li>
<p>使用pandas创建数组、存储文件</p>
</li>
</ol>
<p>根据扇区和机位信息建立pandas空数组</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">results<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([],index<span style="color:#f92672">=</span>indexMe,columns<span style="color:#f92672">=</span>columnMe)</code></pre></div>
<p>并通过iloc进行精确定位，同时赋值</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">results<span style="color:#f92672">.</span>iloc[turbineVId,sectorId]<span style="color:#f92672">=</span>speed2d
results<span style="color:#f92672">.</span>iloc[turbineAId,sectorId]<span style="color:#f92672">=</span>actualAngle</code></pre></div>
<p>最终的全部实现如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> re
<span style="color:#f92672">import</span> math <span style="color:#66d9ef">as</span> ma


<span style="color:#75715e">#headDir=r&#34;C:\Users\yezhaoliang\Desktop\work\AIWind\processWindSim\HuaiLaiTurbine&#34;</span>
headDir<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\work\AIWind\processWindSim\HuaiLaiTurbineZhuFengxiang&#34;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_files</span>(path<span style="color:#f92672">=</span>headDir, rule<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.csv&#34;</span>):
    all <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> fpathe,dirs,fs <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(path):   <span style="color:#75715e"># os.walk是获取所有的目录</span>
        <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> fs:
            filename <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(fpathe,f)
            <span style="color:#66d9ef">if</span> filename<span style="color:#f92672">.</span>endswith(rule):  <span style="color:#75715e"># 判断是否是&#34;xxx&#34;结尾</span>
                all<span style="color:#f92672">.</span>append(filename)
    <span style="color:#66d9ef">return</span> all

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    columnMe<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;0&#39;</span>,<span style="color:#e6db74">&#39;22&#39;</span>,<span style="color:#e6db74">&#39;45&#39;</span>,<span style="color:#e6db74">&#39;67&#39;</span>,<span style="color:#e6db74">&#39;90&#39;</span>,<span style="color:#e6db74">&#39;112&#39;</span>,<span style="color:#e6db74">&#39;135&#39;</span>,<span style="color:#e6db74">&#39;157&#39;</span>,<span style="color:#e6db74">&#39;180&#39;</span>,<span style="color:#e6db74">&#39;202&#39;</span>,<span style="color:#e6db74">&#39;225&#39;</span>,<span style="color:#e6db74">&#39;247&#39;</span>,<span style="color:#e6db74">&#39;270&#39;</span>,<span style="color:#e6db74">&#39;292&#39;</span>,<span style="color:#e6db74">&#39;315&#39;</span>,<span style="color:#e6db74">&#39;337&#39;</span>];
    indexMe<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;T12_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T12_Angle&#34;</span>, <span style="color:#e6db74">&#34;T11_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T11_Angle&#34;</span>, <span style="color:#e6db74">&#34;T10_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T10_Angle&#34;</span>, <span style="color:#e6db74">&#34;T1_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T1_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T3_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T3_Angle&#34;</span>, <span style="color:#e6db74">&#34;T2_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T2_Angle&#34;</span>, <span style="color:#e6db74">&#34;T4_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T4_Angle&#34;</span>, <span style="color:#e6db74">&#34;T5_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T5_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T9_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T9_Angle&#34;</span>, <span style="color:#e6db74">&#34;T8_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T8_Angle&#34;</span>, <span style="color:#e6db74">&#34;T7_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T7_Angle&#34;</span>, <span style="color:#e6db74">&#34;T6_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T6_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T13_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T13_Angle&#34;</span>, <span style="color:#e6db74">&#34;T14_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T14_Angle&#34;</span>, <span style="color:#e6db74">&#34;T15_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T15_Angle&#34;</span>, <span style="color:#e6db74">&#34;T16_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T16_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T17_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T17_Angle&#34;</span>, <span style="color:#e6db74">&#34;T23_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T23_Angle&#34;</span>, <span style="color:#e6db74">&#34;T22_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T22_Angle&#34;</span>, <span style="color:#e6db74">&#34;T21_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T21_Angle&#34;</span>,
     <span style="color:#e6db74">&#34;T20_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T20_Angle&#34;</span>, <span style="color:#e6db74">&#34;T19_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T19_Angle&#34;</span>, <span style="color:#e6db74">&#34;T18_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T18_Angle&#34;</span>, <span style="color:#e6db74">&#34;HL387_24035001_Velocity&#34;</span>,
     <span style="color:#e6db74">&#34;HL387_24035001_Angle&#34;</span>]
    results<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([],index<span style="color:#f92672">=</span>indexMe,columns<span style="color:#f92672">=</span>columnMe)
    b <span style="color:#f92672">=</span> get_files()
    altitudesName<span style="color:#f92672">=</span>[]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> b:
        them<span style="color:#f92672">=</span>i<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>)
        currentFilename<span style="color:#f92672">=</span>them[them<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
        turbinesAndSectors<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>split(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;[.|-]&#39;</span>,currentFilename)
        currentTurbine<span style="color:#f92672">=</span>turbinesAndSectors[<span style="color:#ae81ff">0</span>]
        currentSector<span style="color:#f92672">=</span>turbinesAndSectors[turbinesAndSectors<span style="color:#f92672">.</span>__len__()<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]
        <span style="color:#75715e"># sheetName=them[them.__len__()-3]+them[them.__len__()-2]+them[them.__len__()-1]</span>
        <span style="color:#75715e">#altitudesName.append(sheetName)</span>
        sectorId<span style="color:#f92672">=</span>columnMe<span style="color:#f92672">.</span>index(currentSector);
        turbineVId<span style="color:#f92672">=</span>indexMe<span style="color:#f92672">.</span>index(currentTurbine<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_Velocity&#34;</span>)
        turbineAId<span style="color:#f92672">=</span>indexMe<span style="color:#f92672">.</span>index(currentTurbine<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_Angle&#34;</span>)
        sd<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(i,skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
        <span style="color:#75715e">## 去除Null行（注意空格，数字也一样处理)</span>
        UCRT<span style="color:#f92672">=</span>sd<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">2</span>]
        VCRT<span style="color:#f92672">=</span>sd<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">3</span>]
        speed2d<span style="color:#f92672">=</span>sd<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">5</span>]
        actualAngle<span style="color:#f92672">=</span>ma<span style="color:#f92672">.</span>atan2(UCRT,VCRT)<span style="color:#f92672">*</span><span style="color:#ae81ff">180</span><span style="color:#f92672">/</span><span style="color:#ae81ff">3.1415926</span><span style="color:#f92672">+</span><span style="color:#ae81ff">180</span>
        results<span style="color:#f92672">.</span>iloc[turbineVId,sectorId]<span style="color:#f92672">=</span>speed2d
        results<span style="color:#f92672">.</span>iloc[turbineAId,sectorId]<span style="color:#f92672">=</span>actualAngle

    results<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#34;Results-WindSimSpeedTableZhuFengxiagn.csv&#34;</span>,index<span style="color:#f92672">=</span>indexMe,columns<span style="color:#f92672">=</span>columnMe)</code></pre></div>
<h3 id="python对比作图两个风速风向表"><span class="org-todo done DONE">DONE</span> python对比作图两个风速风向表</h3>
<h4 id="背景介绍">背景介绍</h4>
<p>在前面<a href="https://jueqingsizhe66.github.io/post/python%25E6%258F%2590%25E5%258F%2596%25E5%2590%2584%25E4%25B8%25AA%25E6%2589%2587%25E5%258C%25BA%25E4%25B8%258D%25E5%2590%258C%25E6%259C%25BA%25E4%25BD%258D%25E7%2582%25B9%25E9%25A3%258E%25E9%2580%259F%25E9%25A3%258E%25E5%2590%2591%25E8%25A1%25A8/" target="_blank" rel="noopener">python得到风速风向图</a>一文中，我们得到风速风向表后，</p>
<p>有时候我们需要快速比较一个扇区或者多个扇区的不同机位点风速图或者风向图</p>
<p>方便进行对比分析，为此需要提取对应列信息，并进行重排以及绘图工作</p>
<h4 id="技术分解">技术分解</h4>
<ol>
<li>遍历</li>
<li>提取信息</li>
<li>绘图 matplotlib.pyplot模块用于作图</li>
<li>根据数据表提取信息，并根据表间转换提取数组中的index，设置count和newcount【妙用】
参照表(according_table)是实际需要的X轴信息， x_axix是当前风速风向表的信息, 该值需要根据参照表进行调整</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<p>原先的x轴</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x_axix<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;T12&#34;</span>, <span style="color:#e6db74">&#34;T11&#34;</span>, <span style="color:#e6db74">&#34;T10&#34;</span>, <span style="color:#e6db74">&#34;T1&#34;</span>, <span style="color:#e6db74">&#34;T3&#34;</span>, <span style="color:#e6db74">&#34;T2&#34;</span>, <span style="color:#e6db74">&#34;T4&#34;</span>, <span style="color:#e6db74">&#34;T5&#34;</span>, <span style="color:#e6db74">&#34;T9&#34;</span>, <span style="color:#e6db74">&#34;T8&#34;</span>, <span style="color:#e6db74">&#34;T7&#34;</span>, <span style="color:#e6db74">&#34;T6&#34;</span>, <span style="color:#e6db74">&#34;T13&#34;</span>, <span style="color:#e6db74">&#34;T14&#34;</span>, <span style="color:#e6db74">&#34;T15&#34;</span>, <span style="color:#e6db74">&#34;T16&#34;</span>, <span style="color:#e6db74">&#34;T17&#34;</span>, <span style="color:#e6db74">&#34;T23&#34;</span>, <span style="color:#e6db74">&#34;T22&#34;</span>, <span style="color:#e6db74">&#34;T21&#34;</span>, <span style="color:#e6db74">&#34;T20&#34;</span>, <span style="color:#e6db74">&#34;T19&#34;</span>, <span style="color:#e6db74">&#34;T18&#34;</span>, <span style="color:#e6db74">&#34;table_387&#34;</span>];</code></pre></div>
<p>新的x轴</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">accordingTable<span style="color:#f92672">=</span>[ <span style="color:#e6db74">&#34;T1&#34;</span>,<span style="color:#e6db74">&#34;T2&#34;</span>, <span style="color:#e6db74">&#34;T3&#34;</span>, <span style="color:#e6db74">&#34;T4&#34;</span>, <span style="color:#e6db74">&#34;T5&#34;</span>, <span style="color:#e6db74">&#34;T6&#34;</span>,<span style="color:#e6db74">&#34;T7&#34;</span>,<span style="color:#e6db74">&#34;T8&#34;</span>, <span style="color:#e6db74">&#34;T9&#34;</span>, <span style="color:#e6db74">&#34;T10&#34;</span>,<span style="color:#e6db74">&#34;T11&#34;</span>,<span style="color:#e6db74">&#34;T12&#34;</span>,  <span style="color:#e6db74">&#34;T13&#34;</span>, <span style="color:#e6db74">&#34;T14&#34;</span>, <span style="color:#e6db74">&#34;T15&#34;</span>, <span style="color:#e6db74">&#34;T16&#34;</span>, <span style="color:#e6db74">&#34;T17&#34;</span>,<span style="color:#e6db74">&#34;T18&#34;</span>,<span style="color:#e6db74">&#34;T19&#34;</span>,<span style="color:#e6db74">&#34;T20&#34;</span>,<span style="color:#e6db74">&#34;T21&#34;</span>,<span style="color:#e6db74">&#34;T22&#34;</span>,  <span style="color:#e6db74">&#34;T23&#34;</span>, <span style="color:#e6db74">&#34;table_387&#34;</span>];</code></pre></div>
<p>x轴显示信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x_axisChange<span style="color:#f92672">=</span>[ <span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;6&#34;</span>,<span style="color:#e6db74">&#34;7&#34;</span>,<span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#e6db74">&#34;10&#34;</span>,<span style="color:#e6db74">&#34;11&#34;</span>,<span style="color:#e6db74">&#34;12&#34;</span>,  <span style="color:#e6db74">&#34;13&#34;</span>, <span style="color:#e6db74">&#34;14&#34;</span>, <span style="color:#e6db74">&#34;15&#34;</span>, <span style="color:#e6db74">&#34;16&#34;</span>, <span style="color:#e6db74">&#34;17&#34;</span>,<span style="color:#e6db74">&#34;18&#34;</span>,<span style="color:#e6db74">&#34;19&#34;</span>,<span style="color:#e6db74">&#34;20&#34;</span>,<span style="color:#e6db74">&#34;21&#34;</span>,<span style="color:#e6db74">&#34;22&#34;</span>,  <span style="color:#e6db74">&#34;23&#34;</span>, <span style="color:#e6db74">&#34;Clim&#34;</span>];</code></pre></div>
<p>需要提取的扇区和物理量</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plotSector<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;22&#39;</span>
plotPhysics<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Velocity&#39;</span></code></pre></div>
<p>并通过数组的index函数得到对应你的sectorID或者类似的TurbineID等。</p>
<p>通过numpy创建两个空数组</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">windsimYaxis<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(x_axix<span style="color:#f92672">.</span>__len__())
aiwindYaxis<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(x_axix<span style="color:#f92672">.</span>__len__())</code></pre></div>
<p>最终实现</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np

columnMe <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;0&#39;</span>, <span style="color:#e6db74">&#39;22&#39;</span>, <span style="color:#e6db74">&#39;45&#39;</span>, <span style="color:#e6db74">&#39;67&#39;</span>, <span style="color:#e6db74">&#39;90&#39;</span>, <span style="color:#e6db74">&#39;112&#39;</span>, <span style="color:#e6db74">&#39;135&#39;</span>, <span style="color:#e6db74">&#39;157&#39;</span>, <span style="color:#e6db74">&#39;180&#39;</span>, <span style="color:#e6db74">&#39;202&#39;</span>, <span style="color:#e6db74">&#39;225&#39;</span>, <span style="color:#e6db74">&#39;247&#39;</span>, <span style="color:#e6db74">&#39;270&#39;</span>, <span style="color:#e6db74">&#39;292&#39;</span>, <span style="color:#e6db74">&#39;315&#39;</span>, <span style="color:#e6db74">&#39;337&#39;</span>];
indexMe <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;T12_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T12_Angle&#34;</span>, <span style="color:#e6db74">&#34;T11_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T11_Angle&#34;</span>, <span style="color:#e6db74">&#34;T10_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T10_Angle&#34;</span>, <span style="color:#e6db74">&#34;T1_Velocity&#34;</span>,
           <span style="color:#e6db74">&#34;T1_Angle&#34;</span>,
           <span style="color:#e6db74">&#34;T3_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T3_Angle&#34;</span>, <span style="color:#e6db74">&#34;T2_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T2_Angle&#34;</span>, <span style="color:#e6db74">&#34;T4_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T4_Angle&#34;</span>, <span style="color:#e6db74">&#34;T5_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T5_Angle&#34;</span>,
           <span style="color:#e6db74">&#34;T9_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T9_Angle&#34;</span>, <span style="color:#e6db74">&#34;T8_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T8_Angle&#34;</span>, <span style="color:#e6db74">&#34;T7_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T7_Angle&#34;</span>, <span style="color:#e6db74">&#34;T6_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T6_Angle&#34;</span>,
           <span style="color:#e6db74">&#34;T13_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T13_Angle&#34;</span>, <span style="color:#e6db74">&#34;T14_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T14_Angle&#34;</span>, <span style="color:#e6db74">&#34;T15_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T15_Angle&#34;</span>, <span style="color:#e6db74">&#34;T16_Velocity&#34;</span>,
           <span style="color:#e6db74">&#34;T16_Angle&#34;</span>,
           <span style="color:#e6db74">&#34;T17_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T17_Angle&#34;</span>, <span style="color:#e6db74">&#34;T23_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T23_Angle&#34;</span>, <span style="color:#e6db74">&#34;T22_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T22_Angle&#34;</span>, <span style="color:#e6db74">&#34;T21_Velocity&#34;</span>,
           <span style="color:#e6db74">&#34;T21_Angle&#34;</span>,
           <span style="color:#e6db74">&#34;T20_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T20_Angle&#34;</span>, <span style="color:#e6db74">&#34;T19_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T19_Angle&#34;</span>, <span style="color:#e6db74">&#34;T18_Velocity&#34;</span>, <span style="color:#e6db74">&#34;T18_Angle&#34;</span>,
           <span style="color:#e6db74">&#34;HL387_24035001_Velocity&#34;</span>,
           <span style="color:#e6db74">&#34;HL387_24035001_Angle&#34;</span>]


asd <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\PythonAIWind\AIWINDspeedTable.csv&#39;</span>, skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
wsd <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\PythonAIWind\Results-WindSimSpeedTableZhuFengxiagn.csv&#39;</span>, skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

x_axix<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;T12&#34;</span>, <span style="color:#e6db74">&#34;T11&#34;</span>, <span style="color:#e6db74">&#34;T10&#34;</span>, <span style="color:#e6db74">&#34;T1&#34;</span>, <span style="color:#e6db74">&#34;T3&#34;</span>, <span style="color:#e6db74">&#34;T2&#34;</span>, <span style="color:#e6db74">&#34;T4&#34;</span>, <span style="color:#e6db74">&#34;T5&#34;</span>, <span style="color:#e6db74">&#34;T9&#34;</span>, <span style="color:#e6db74">&#34;T8&#34;</span>, <span style="color:#e6db74">&#34;T7&#34;</span>, <span style="color:#e6db74">&#34;T6&#34;</span>, <span style="color:#e6db74">&#34;T13&#34;</span>, <span style="color:#e6db74">&#34;T14&#34;</span>, <span style="color:#e6db74">&#34;T15&#34;</span>, <span style="color:#e6db74">&#34;T16&#34;</span>, <span style="color:#e6db74">&#34;T17&#34;</span>, <span style="color:#e6db74">&#34;T23&#34;</span>, <span style="color:#e6db74">&#34;T22&#34;</span>, <span style="color:#e6db74">&#34;T21&#34;</span>, <span style="color:#e6db74">&#34;T20&#34;</span>, <span style="color:#e6db74">&#34;T19&#34;</span>, <span style="color:#e6db74">&#34;T18&#34;</span>, <span style="color:#e6db74">&#34;table_387&#34;</span>];
windsimYaxis<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(x_axix<span style="color:#f92672">.</span>__len__())
aiwindYaxis<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(x_axix<span style="color:#f92672">.</span>__len__())
accordingTable<span style="color:#f92672">=</span>[ <span style="color:#e6db74">&#34;T1&#34;</span>,<span style="color:#e6db74">&#34;T2&#34;</span>, <span style="color:#e6db74">&#34;T3&#34;</span>, <span style="color:#e6db74">&#34;T4&#34;</span>, <span style="color:#e6db74">&#34;T5&#34;</span>, <span style="color:#e6db74">&#34;T6&#34;</span>,<span style="color:#e6db74">&#34;T7&#34;</span>,<span style="color:#e6db74">&#34;T8&#34;</span>, <span style="color:#e6db74">&#34;T9&#34;</span>, <span style="color:#e6db74">&#34;T10&#34;</span>,<span style="color:#e6db74">&#34;T11&#34;</span>,<span style="color:#e6db74">&#34;T12&#34;</span>,  <span style="color:#e6db74">&#34;T13&#34;</span>, <span style="color:#e6db74">&#34;T14&#34;</span>, <span style="color:#e6db74">&#34;T15&#34;</span>, <span style="color:#e6db74">&#34;T16&#34;</span>, <span style="color:#e6db74">&#34;T17&#34;</span>,<span style="color:#e6db74">&#34;T18&#34;</span>,<span style="color:#e6db74">&#34;T19&#34;</span>,<span style="color:#e6db74">&#34;T20&#34;</span>,<span style="color:#e6db74">&#34;T21&#34;</span>,<span style="color:#e6db74">&#34;T22&#34;</span>,  <span style="color:#e6db74">&#34;T23&#34;</span>, <span style="color:#e6db74">&#34;table_387&#34;</span>];

x_axisChange<span style="color:#f92672">=</span>[ <span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;6&#34;</span>,<span style="color:#e6db74">&#34;7&#34;</span>,<span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#e6db74">&#34;10&#34;</span>,<span style="color:#e6db74">&#34;11&#34;</span>,<span style="color:#e6db74">&#34;12&#34;</span>,  <span style="color:#e6db74">&#34;13&#34;</span>, <span style="color:#e6db74">&#34;14&#34;</span>, <span style="color:#e6db74">&#34;15&#34;</span>, <span style="color:#e6db74">&#34;16&#34;</span>, <span style="color:#e6db74">&#34;17&#34;</span>,<span style="color:#e6db74">&#34;18&#34;</span>,<span style="color:#e6db74">&#34;19&#34;</span>,<span style="color:#e6db74">&#34;20&#34;</span>,<span style="color:#e6db74">&#34;21&#34;</span>,<span style="color:#e6db74">&#34;22&#34;</span>,  <span style="color:#e6db74">&#34;23&#34;</span>, <span style="color:#e6db74">&#34;Clim&#34;</span>];


plotSector<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;22&#39;</span>
plotPhysics<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Velocity&#39;</span>
<span style="color:#75715e">#plotPhysics=&#39;Angle&#39;</span>
sectorId<span style="color:#f92672">=</span>columnMe<span style="color:#f92672">.</span>index(plotSector)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
plotId<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
newCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#75715e"># for turbine in x_axix:</span>
<span style="color:#66d9ef">for</span> turbine <span style="color:#f92672">in</span> accordingTable:
    <span style="color:#66d9ef">if</span>(plotPhysics<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Velocity&#39;</span>):
        plotId<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">else</span>:
        plotId<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
    <span style="color:#75715e"># windsimYaxis[count]=wsd.iloc[2*count+plotId,sectorId]</span>
    <span style="color:#75715e"># aiwindYaxis[count]=asd.iloc[2*count+plotId,sectorId]</span>
    <span style="color:#75715e"># count = count+1</span>
    newCount<span style="color:#f92672">=</span>x_axix<span style="color:#f92672">.</span>index(turbine)
    windsimYaxis[count]<span style="color:#f92672">=</span>wsd<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>newCount<span style="color:#f92672">+</span>plotId,sectorId]
    aiwindYaxis[count]<span style="color:#f92672">=</span>asd<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>newCount<span style="color:#f92672">+</span>plotId,sectorId]
    count <span style="color:#f92672">=</span> count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
tempArray<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array([windsimYaxis,aiwindYaxis])
ylimMax<span style="color:#f92672">=</span>tempArray<span style="color:#f92672">.</span>max()
ylimMin<span style="color:#f92672">=</span>tempArray<span style="color:#f92672">.</span>min()
<span style="color:#75715e"># 开始画图</span>
plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">8</span>))
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Sector-&#39;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Analysis&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span> )
<span style="color:#75715e">#plt.plot(x_axix, aiwindYaxis, marker=&#39;o&#39;, color=&#39;black&#39;, label=&#39;AIWIND&#39;)</span>
plt<span style="color:#f92672">.</span>plot(x_axisChange, aiwindYaxis, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span>,markersize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;9&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>,markerfacecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;grey&#39;</span>,markeredgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;solid&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;AIWIND&#39;</span>,linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
<span style="color:#75715e">#plt.plot(sub_axix, test_acys,marker=&#39;*&#39;, color=&#39;red&#39;, label=&#39;testing accuracy&#39;)</span>
<span style="color:#75715e">#plt.plot(x_axix, windsimYaxis,marker=&#39;*&#39;, color=&#39;blue&#39;, label=&#39;WindSiM&#39;)</span>
plt<span style="color:#f92672">.</span>plot(x_axisChange, windsimYaxis,marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;*&#39;</span>,markersize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;9&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,markerfacecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;grey&#39;</span>,markeredgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;WindSiM&#39;</span>,linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
<span style="color:#75715e">#plt.plot(x_axix, thresholds, color=&#39;blue&#39;, label=&#39;threshold&#39;)</span>
plt<span style="color:#f92672">.</span>legend()  <span style="color:#75715e"># 显示图例</span>
plt<span style="color:#f92672">.</span>margins(<span style="color:#ae81ff">0</span>)
plt<span style="color:#f92672">.</span>grid()
plt<span style="color:#f92672">.</span>ylim(ylimMin<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,ylimMax<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Turbine Names&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span> )
plt<span style="color:#f92672">.</span>ylabel(plotPhysics,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span> )
plt<span style="color:#f92672">.</span>tick_params(axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;both&#39;</span>,which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>,labelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span>)
plt<span style="color:#f92672">.</span>savefig(plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_&#34;</span><span style="color:#f92672">+</span>plotPhysics<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.jpg&#34;</span>,dpi <span style="color:#f92672">=</span> <span style="color:#ae81ff">900</span>)
plt<span style="color:#f92672">.</span>show()

<span style="color:#75715e"># python 一个折线图绘制多个曲线</span>
<span style="color:#75715e"># color：曲线颜色，blue，green，red等等</span>
<span style="color:#75715e"># label：图例，这个参数内容就自定义啦，注意如果写这个参数一定要加上plt.legend()，之后再plt.show()才有有用！</span>
<span style="color:#75715e"># linestyle：曲线风格，’–’，’-.’，’:’等等</span>
<span style="color:#75715e"># linewidth：曲线宽度，自定义就可以</span>
<span style="color:#75715e"># marker：标记点样式，’o’,’x’，也就是说这些符号会标示出曲线上具体的“点”，这样一来就易于观察曲线上那些地方是支撑点</span>
<span style="color:#75715e"># markersize：标记点的大小，自定义就可以</span></code></pre></div>
<h4 id="改为批处理版本">改为批处理版本</h4>
<p>增加一下for循环，通过ColumnMe,用于提取section</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> plotSector <span style="color:#f92672">in</span> columnMe:
    <span style="color:#75715e">#plotPhysics=&#39;Angle&#39;</span>
    sectorId<span style="color:#f92672">=</span>columnMe<span style="color:#f92672">.</span>index(plotSector)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    plotId<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    newCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#75715e"># for turbine in x_axix:</span>
    <span style="color:#66d9ef">for</span> turbine <span style="color:#f92672">in</span> accordingTable:
        <span style="color:#75715e">#if(plotPhysics==&#39;Velocity&#39;):</span>
        <span style="color:#66d9ef">if</span> (plotPhysics <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Velocity&#39;</span>):
                plotId<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">else</span>:
            plotId<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
        <span style="color:#75715e"># windsimYaxis[count]=wsd.iloc[2*count+plotId,sectorId]</span>
        <span style="color:#75715e"># aiwindYaxis[count]=asd.iloc[2*count+plotId,sectorId]</span>
        <span style="color:#75715e"># count = count+1</span>
        newCount<span style="color:#f92672">=</span>x_axix<span style="color:#f92672">.</span>index(turbine)
        windsimYaxis[count]<span style="color:#f92672">=</span>wsd<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>newCount<span style="color:#f92672">+</span>plotId,sectorId]
        aiwindYaxis[count]<span style="color:#f92672">=</span>asd<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>newCount<span style="color:#f92672">+</span>plotId,sectorId]
        count <span style="color:#f92672">=</span> count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    tempArray<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array([windsimYaxis,aiwindYaxis])
    ylimMax<span style="color:#f92672">=</span>tempArray<span style="color:#f92672">.</span>max()
<span style="color:#f92672">....</span></code></pre></div>
<p><a href="/images/aiwind/sectorAngleTurbines.png">最终结果</a></p>
<h3 id="python众多文件中提取轮毂高度处风速"><span class="org-todo done DONE">DONE</span> python众多文件中提取轮毂高度处风速</h3>
<h4 id="背景分析">背景分析</h4>
<p>在前面的 <a href="https://jueqingsizhe66.github.io/post/python%25E6%258F%2590%25E5%258F%2596%25E5%25A4%259A%25E4%25B8%25AA%25E6%2596%2587%25E4%25BB%25B6%25E6%25B1%2587%25E6%2580%25BB%25E5%2588%25B0%25E4%25B8%2580%25E4%25B8%25AAexcel%25E8%25A1%25A8/" target="_blank" rel="noopener">python提取多个文件汇总到一个excel表</a>一文中，我们使用ExcelWriter把提取的速度信息汇总在一个xls文件，各个sheet存放真实数据</p>
<p>而在AIWIND计算中，有可能插值错误，会出现Null值，于是a <a href="https://jueqingsizhe66.github.io/post/python%25E6%258F%2590%25E5%258F%2596%25E5%25A4%259A%25E4%25B8%25AA%25E6%2596%2587%25E4%25BB%25B6%25E7%259A%2584%25E5%25AD%2598%25E5%259C%25A8nan%25E9%2580%259F%25E5%25BA%25A6%25E5%25BB%2593%25E7%25BA%25BF/" target="_blank" rel="noopener">python提取多个文件的存在null速度廓线</a>提出了过滤NULL值得方案</p>
<p>以上工作针对的是风廓线，我们现在想要从这个汇总表提取出来各个机位点在一定扇区下，比如0°得的轮毂高度处速度曲线, 也就是每计算一个扇区，我们都希望立马处理得到对应的
对比结果，观察是否有所改进！于是做了下面工作</p>
<p>在<a href="https://jueqingsizhe66.github.io/post/python%25E5%25AF%25B9%25E6%25AF%2594%25E4%25BD%259C%25E5%259B%25BE%25E4%25B8%25A4%25E4%25B8%25AA%25E9%25A3%258E%25E9%2580%259F%25E9%25A3%258E%25E5%2590%2591%25E8%25A1%25A8/" target="_blank" rel="noopener">python对比作图</a>一文中加入了数据的导出功能，可在此基础上进行改写</p>
<p>下图中左边为瞬态扇区的AIWIND即时结果，右边为改进前的WINDSIM和AIWIND在各个扇区的对比图,我们希望AIWIND即时结果能够较好地吻合规律，与之前的WINDSIM结果做对比，即提取即时扇区下的各个机位点的速度廓线，汇总表格，遍历所有sheetnames,提取轮毂点位的速度信息,作图，也可以导出，当前未进行。</p>
<p><a href="/images/aiwind/hubVelocity.png">轮毂风速</a></p>
<h4 id="技术分解">技术分解</h4>
<ol>
<li>依然利用脚本提取风廓线文件，一个扇区生成一个汇总表</li>
<li>遍历汇总表的所有sheetnames, 利用Excel_File()和parse的功能</li>
<li>利用列表数据结构+条件提取对应高度处的风速</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<p>设计了一个plotSector，可针对对应扇区处理;</p>
<ol>
<li>注意观察fileReadyAnalysis的及时结果存放位置？</li>
<li>注意观察<a href="https://jueqingsizhe66.github.io/post/python%25E5%25AF%25B9%25E6%25AF%2594%25E4%25BD%259C%25E5%259B%25BE%25E4%25B8%25A4%25E4%25B8%25AA%25E9%25A3%258E%25E9%2580%259F%25E9%25A3%258E%25E5%2590%2591%25E8%25A1%25A8/" target="_blank" rel="noopener">对比作图</a>导出的数据表格`0-Velocity.xlsx..`存放位置?</li>
</ol>
<!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt

<span style="color:#75715e">## 注意需要有windsim各个扇区的数据 , 当前有一个问题必须配合AIIWND</span>
<span style="color:#75715e">#fileReadyAnalysis=r&#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation45.xlsx&#34;</span>
<span style="color:#75715e">#fileReadyAnalysis=r&#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation0.xlsx&#34;</span>
<span style="color:#75715e">## Sector: 0 22 45 67 90 112 135 157 180 202 247 270 292 315 337</span>
plotSector<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;0&#39;</span>
<span style="color:#75715e">## AIWIND导出的数据需要汇总</span>
fileReadyAnalysis<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation&#34;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.xlsx&#34;</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    x_axix <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;T11&#34;</span>, <span style="color:#e6db74">&#34;T12&#34;</span>, <span style="color:#e6db74">&#34;T13&#34;</span>, <span style="color:#e6db74">&#34;T21&#34;</span>, <span style="color:#e6db74">&#34;T22&#34;</span>, <span style="color:#e6db74">&#34;T23&#34;</span>, <span style="color:#e6db74">&#34;T1&#34;</span>, <span style="color:#e6db74">&#34;T10&#34;</span>, <span style="color:#e6db74">&#34;T14&#34;</span>, <span style="color:#e6db74">&#34;T15&#34;</span>, <span style="color:#e6db74">&#34;T16&#34;</span>, <span style="color:#e6db74">&#34;T17&#34;</span>, <span style="color:#e6db74">&#34;T18&#34;</span>, <span style="color:#e6db74">&#34;T19&#34;</span>, <span style="color:#e6db74">&#34;T2&#34;</span>, <span style="color:#e6db74">&#34;T20&#34;</span>,
              <span style="color:#e6db74">&#34;T3&#34;</span>, <span style="color:#e6db74">&#34;T4&#34;</span>, <span style="color:#e6db74">&#34;T5&#34;</span>, <span style="color:#e6db74">&#34;T6&#34;</span>, <span style="color:#e6db74">&#34;T7&#34;</span>, <span style="color:#e6db74">&#34;T8&#34;</span>, <span style="color:#e6db74">&#34;T9&#34;</span>, <span style="color:#e6db74">&#34;366&#34;</span>,<span style="color:#e6db74">&#34;387&#34;</span>];
    accordingTable <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;T1&#34;</span>, <span style="color:#e6db74">&#34;T2&#34;</span>, <span style="color:#e6db74">&#34;T3&#34;</span>, <span style="color:#e6db74">&#34;T4&#34;</span>, <span style="color:#e6db74">&#34;T5&#34;</span>, <span style="color:#e6db74">&#34;T6&#34;</span>, <span style="color:#e6db74">&#34;T7&#34;</span>, <span style="color:#e6db74">&#34;T8&#34;</span>, <span style="color:#e6db74">&#34;T9&#34;</span>, <span style="color:#e6db74">&#34;T10&#34;</span>, <span style="color:#e6db74">&#34;T11&#34;</span>, <span style="color:#e6db74">&#34;T12&#34;</span>, <span style="color:#e6db74">&#34;T13&#34;</span>, <span style="color:#e6db74">&#34;T14&#34;</span>, <span style="color:#e6db74">&#34;T15&#34;</span>,
                      <span style="color:#e6db74">&#34;T16&#34;</span>, <span style="color:#e6db74">&#34;T17&#34;</span>, <span style="color:#e6db74">&#34;T18&#34;</span>, <span style="color:#e6db74">&#34;T19&#34;</span>, <span style="color:#e6db74">&#34;T20&#34;</span>, <span style="color:#e6db74">&#34;T21&#34;</span>, <span style="color:#e6db74">&#34;T22&#34;</span>, <span style="color:#e6db74">&#34;T23&#34;</span>, <span style="color:#e6db74">&#34;366&#34;</span>,<span style="color:#e6db74">&#34;387&#34;</span>];
    x_axisChange <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;6&#34;</span>, <span style="color:#e6db74">&#34;7&#34;</span>, <span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#e6db74">&#34;10&#34;</span>, <span style="color:#e6db74">&#34;11&#34;</span>, <span style="color:#e6db74">&#34;12&#34;</span>, <span style="color:#e6db74">&#34;13&#34;</span>, <span style="color:#e6db74">&#34;14&#34;</span>, <span style="color:#e6db74">&#34;15&#34;</span>, <span style="color:#e6db74">&#34;16&#34;</span>, <span style="color:#e6db74">&#34;17&#34;</span>, <span style="color:#e6db74">&#34;18&#34;</span>,
                    <span style="color:#e6db74">&#34;19&#34;</span>, <span style="color:#e6db74">&#34;20&#34;</span>, <span style="color:#e6db74">&#34;21&#34;</span>, <span style="color:#e6db74">&#34;22&#34;</span>, <span style="color:#e6db74">&#34;23&#34;</span> ];

    speedTableDir<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\work\AIWind\processWindSim\速度表速度分析&#39;</span>
    speedTable<span style="color:#f92672">=</span>speedTableDir<span style="color:#f92672">+</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;-velocity.xlsx&#39;</span>
    speedTableData<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_excel(speedTable,usecols<span style="color:#f92672">=</span>[<span style="color:#ae81ff">2</span>])
    <span style="color:#75715e"># b = pd.read_excel(fileReadyAnalysis,None)</span>
    <span style="color:#75715e"># sheetnames=b.keys()</span>
    <span style="color:#75715e"># sheetvalues=b.values()</span>
    <span style="color:#75715e">#hubVelocities=np.zeros(sheetvalues.__len__())</span>

    xlsx <span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelFile(fileReadyAnalysis)
    turbines<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">25</span>)
    turbineVelocity<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">25</span>,dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;float&#39;</span>)
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#75715e">## 读取通过程序汇总的各个扇区的数据(各个机位点存储在相应sheet表中</span>
    <span style="color:#66d9ef">for</span> sheetname <span style="color:#f92672">in</span> xlsx<span style="color:#f92672">.</span>sheet_names:
        pdtemp<span style="color:#f92672">=</span>xlsx<span style="color:#f92672">.</span>parse(sheetname)
        <span style="color:#75715e">#print(pdtemp.iloc[5:20,2])</span>
        <span style="color:#75715e">#linreg = LinearRegression()</span>
        newCount<span style="color:#f92672">=</span>accordingTable<span style="color:#f92672">.</span>index(x_axix[count])
        <span style="color:#75715e">## 机位点名字</span>
        print(sheetname[<span style="color:#f92672">-</span><span style="color:#ae81ff">7</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>])
        turbines[newCount]<span style="color:#f92672">=</span>sheetname[<span style="color:#f92672">-</span><span style="color:#ae81ff">7</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>]
        <span style="color:#75715e">## 数据提取</span>
        text1<span style="color:#f92672">=</span>pdtemp<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">2</span>]
        text2<span style="color:#f92672">=</span>pdtemp<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">1</span>]
        iMax<span style="color:#f92672">=</span>[i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(text1)) <span style="color:#66d9ef">if</span> text1[i]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">90</span>]

        neededIndex<span style="color:#f92672">=</span>iMax[<span style="color:#ae81ff">0</span>]
        neededIndexSmaller<span style="color:#f92672">=</span>iMax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        smallZ<span style="color:#f92672">=</span>text1[neededIndexSmaller]
        smallV<span style="color:#f92672">=</span>text2[neededIndexSmaller]

        bigZ <span style="color:#f92672">=</span> text1[neededIndex]
        bigV <span style="color:#f92672">=</span> text2[neededIndex]
       <span style="color:#75715e"># yi=[y for y in pdtemp.iloc[0:100,1]]</span>
       <span style="color:#75715e"># linreg.fit(pdtemp.iloc[5:20,2], pdtemp.iloc[5:20,1])</span>
        hub_height<span style="color:#f92672">=</span><span style="color:#ae81ff">90</span>
        velocityPredict<span style="color:#f92672">=</span>(bigV<span style="color:#f92672">-</span>smallV)<span style="color:#f92672">/</span>(bigZ<span style="color:#f92672">-</span>smallZ)<span style="color:#f92672">*</span>(hub_height<span style="color:#f92672">-</span>smallZ)<span style="color:#f92672">+</span>smallV
<span style="color:#75715e">#        velocityPredict= linreg.predict(hub_height)</span>
        print(velocityPredict)
        turbineVelocity[newCount]<span style="color:#f92672">=</span>velocityPredict
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>concat([turbines,turbineVelocity],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
    <span style="color:#75715e">#df.to_excel(&#39;hello45.xlsx&#39;)</span>
    df<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\NewSimulation\hello&#39;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.xlsx&#39;</span>)
    <span style="color:#75715e"># speeTableSeries=pd.Series(speedTableData.values())</span>
    <span style="color:#75715e"># tempArray=pd.concat(turbineVelocity[0:23],speeTableSeries)</span>
    <span style="color:#75715e">#temp1=[x for x in speedTableData]</span>
    <span style="color:#75715e">#temp2=[y for y in turbineVelocity]</span>
    <span style="color:#75715e">#tempArray=[temp1,temp2]</span>
    aiwindYaxis<span style="color:#f92672">=</span>turbineVelocity[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">23</span>]
    windsimYaxis<span style="color:#f92672">=</span>speedTableData[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">23</span>]
    <span style="color:#75715e">#ylimMax=max(tempArray[1])</span>
    <span style="color:#75715e">#ylimMin=min(tempArray[1])</span>

    ylimMax<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>
    ylimMin<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>
    <span style="color:#75715e"># 开始画图</span>

    plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">8</span>))
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Sector-&#39;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Analysis&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span> )
    <span style="color:#75715e">#plt.plot(x_axix, aiwindYaxis, marker=&#39;o&#39;, color=&#39;black&#39;, label=&#39;AIWIND&#39;)</span>
    plt<span style="color:#f92672">.</span>plot(x_axisChange, aiwindYaxis, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span>,markersize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;9&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>,markerfacecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;grey&#39;</span>,markeredgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;solid&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;AIWIND&#39;</span>,linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
    <span style="color:#75715e">#plt.plot(sub_axix, test_acys,marker=&#39;*&#39;, color=&#39;red&#39;, label=&#39;testing accuracy&#39;)</span>
    <span style="color:#75715e">#plt.plot(x_axix, windsimYaxis,marker=&#39;*&#39;, color=&#39;blue&#39;, label=&#39;WindSiM&#39;)</span>
    plt<span style="color:#f92672">.</span>plot(x_axisChange, windsimYaxis,marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;*&#39;</span>,markersize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;9&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,markerfacecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;grey&#39;</span>,markeredgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;WindSiM&#39;</span>,linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
    <span style="color:#75715e">#plt.plot(x_axix, thresholds, color=&#39;blue&#39;, label=&#39;threshold&#39;)</span>
    plt<span style="color:#f92672">.</span>legend()  <span style="color:#75715e"># 显示图例</span>
    plt<span style="color:#f92672">.</span>margins(<span style="color:#ae81ff">0</span>)
    plt<span style="color:#f92672">.</span>grid()
    plt<span style="color:#f92672">.</span>ylim(ylimMin<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,ylimMax<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Turbine Names&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span> )
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Velocity&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span> )
    plt<span style="color:#f92672">.</span>tick_params(axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;both&#39;</span>,which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>,labelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span>)
    plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\NewSimulation</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_&#34;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#39;Velocity-test&#39;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.jpg&#34;</span>,dpi <span style="color:#f92672">=</span> <span style="color:#ae81ff">900</span>)
    <span style="color:#75715e">#plt.show()</span></code></pre></div>
<h3 id="python-pandas数据结构转化"><span class="org-todo done DONE">DONE</span> python pandas数据结构转化</h3>
<h4 id="背景介绍">背景介绍</h4>
<p>windsim已经导出所有机位点的风速风向，每个机组都有16个扇区的风速和风向信息(轮毂高度处)</p>
<p>同时你还有fluent或者AIWIND一个扇区的CFD结果, 一个excel表包含所有机组的信息，每个机组的速度廓线放在一个sheet表中, 为了提取对应轮毂高度处的信息，</p>
<p>AIWIND或者fluent计算得到的一个方向的速度廓线计算结果：</p>
<p><a href="/images/aiwind/dongping.png">dongping</a></p>
<h4 id="技术分解">技术分解</h4>
<ol>
<li>访问windsim的speed table</li>
<li>遍历AIWIND或者fluent速度廓线得到的所有机位点的sheet，并选取90m高度处，存放入新的表中</li>
<li>转化pandas的Series和list，方便实用index函数</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt

<span style="color:#75715e">## 注意需要有windsim各个扇区的数据</span>
<span style="color:#75715e">#fileReadyAnalysis=r&#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation45.xlsx&#34;</span>
<span style="color:#75715e">#fileReadyAnalysis=r&#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation0.xlsx&#34;</span>
<span style="color:#75715e">## Sector: 0 22 45 67 90 112 135 157 180 202 247 270 292 315 337</span>
plotSector<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;0&#39;</span>
<span style="color:#75715e">## AIWIND导出的数据需要汇总</span>
<span style="color:#75715e">#fileReadyAnalysis=r&#34;C:\Users\yezhaoliang\Desktop\NewSimulation\Results-newSimulation&#34;+plotSector+&#34;.xlsx&#34;</span>
aiwindfileReadyAnalysis<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing\Results-newSimulation&#34;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.xlsx&#34;</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    accordingTable <span style="color:#f92672">=</span> [
        <span style="color:#e6db74">&#34;C1566&#34;</span>,<span style="color:#e6db74">&#34;C2738&#34;</span>,<span style="color:#e6db74">&#34;C2742&#34;</span>,<span style="color:#e6db74">&#34;C3284&#34;</span>,<span style="color:#e6db74">&#34;C4179&#34;</span>,<span style="color:#e6db74">&#34;C4182&#34;</span>,<span style="color:#e6db74">&#34;K01&#34;</span>, <span style="color:#e6db74">&#34;K02&#34;</span>, <span style="color:#e6db74">&#34;K03&#34;</span>, <span style="color:#e6db74">&#34;K04&#34;</span>, <span style="color:#e6db74">&#34;K05&#34;</span>, <span style="color:#e6db74">&#34;K06&#34;</span>, <span style="color:#e6db74">&#34;K07&#34;</span>, <span style="color:#e6db74">&#34;K08&#34;</span>, <span style="color:#e6db74">&#34;K09&#34;</span>, <span style="color:#e6db74">&#34;K10&#34;</span>, <span style="color:#e6db74">&#34;X1&#34;</span>, <span style="color:#e6db74">&#34;X2&#34;</span>, <span style="color:#e6db74">&#34;X3&#34;</span>, <span style="color:#e6db74">&#34;X4&#34;</span>, <span style="color:#e6db74">&#34;X5&#34;</span>, <span style="color:#e6db74">&#34;X6&#34;</span>, <span style="color:#e6db74">&#34;X7&#34;</span>,
        <span style="color:#e6db74">&#34;X8&#34;</span>, <span style="color:#e6db74">&#34;X9&#34;</span>, <span style="color:#e6db74">&#34;X10&#34;</span>, <span style="color:#e6db74">&#34;X11&#34;</span>, <span style="color:#e6db74">&#34;X12&#34;</span>, <span style="color:#e6db74">&#34;X13&#34;</span>, <span style="color:#e6db74">&#34;X14&#34;</span>, <span style="color:#e6db74">&#34;X15&#34;</span>, <span style="color:#e6db74">&#34;X16&#34;</span>, <span style="color:#e6db74">&#34;X17&#34;</span>, <span style="color:#e6db74">&#34;X18&#34;</span>, <span style="color:#e6db74">&#34;X19&#34;</span>, <span style="color:#e6db74">&#34;X20&#34;</span>, <span style="color:#e6db74">&#34;X21&#34;</span>, <span style="color:#e6db74">&#34;X22&#34;</span>, <span style="color:#e6db74">&#34;X23&#34;</span>, <span style="color:#e6db74">&#34;X24&#34;</span>,
        <span style="color:#e6db74">&#34;X25&#34;</span>, <span style="color:#e6db74">&#34;X26&#34;</span>, <span style="color:#e6db74">&#34;X27&#34;</span>, <span style="color:#e6db74">&#34;X28&#34;</span>, <span style="color:#e6db74">&#34;X29&#34;</span>, <span style="color:#e6db74">&#34;X30&#34;</span>, <span style="color:#e6db74">&#34;X31&#34;</span>, <span style="color:#e6db74">&#34;X32&#34;</span>, <span style="color:#e6db74">&#34;X33&#34;</span>, <span style="color:#e6db74">&#34;X34&#34;</span>, <span style="color:#e6db74">&#34;X35&#34;</span>, <span style="color:#e6db74">&#34;X36&#34;</span>, <span style="color:#e6db74">&#34;X37&#34;</span>, <span style="color:#e6db74">&#34;X38&#34;</span>, <span style="color:#e6db74">&#34;X40&#34;</span>, <span style="color:#e6db74">&#34;X41&#34;</span>,
        <span style="color:#e6db74">&#34;X42&#34;</span>, <span style="color:#e6db74">&#34;X43&#34;</span>, <span style="color:#e6db74">&#34;X44&#34;</span>, <span style="color:#e6db74">&#34;X45&#34;</span>, <span style="color:#e6db74">&#34;X46&#34;</span>, <span style="color:#e6db74">&#34;X47&#34;</span>, <span style="color:#e6db74">&#34;X48&#34;</span>, <span style="color:#e6db74">&#34;X49&#34;</span>, <span style="color:#e6db74">&#34;X50&#34;</span>, <span style="color:#e6db74">&#34;X51&#34;</span>, <span style="color:#e6db74">&#34;X52&#34;</span>, <span style="color:#e6db74">&#34;X53&#34;</span>, <span style="color:#e6db74">&#34;X54&#34;</span>, <span style="color:#e6db74">&#34;X55&#34;</span>, <span style="color:#e6db74">&#34;X56&#34;</span>, <span style="color:#e6db74">&#34;X57&#34;</span>,
        <span style="color:#e6db74">&#34;X58&#34;</span>, <span style="color:#e6db74">&#34;X59&#34;</span>, <span style="color:#e6db74">&#34;X60&#34;</span>, <span style="color:#e6db74">&#34;X61&#34;</span>, <span style="color:#e6db74">&#34;X62&#34;</span>, <span style="color:#e6db74">&#34;X63&#34;</span>, <span style="color:#e6db74">&#34;X64&#34;</span>, <span style="color:#e6db74">&#34;X65&#34;</span>, <span style="color:#e6db74">&#34;X66&#34;</span>, <span style="color:#e6db74">&#34;X67&#34;</span>, <span style="color:#e6db74">&#34;X68&#34;</span>, <span style="color:#e6db74">&#34;X69&#34;</span>, <span style="color:#e6db74">&#34;X70&#34;</span>, <span style="color:#e6db74">&#34;X71&#34;</span>, <span style="color:#e6db74">&#34;X72&#34;</span>, <span style="color:#e6db74">&#34;X73&#34;</span>,
        <span style="color:#e6db74">&#34;X74&#34;</span>, <span style="color:#e6db74">&#34;X75&#34;</span>, <span style="color:#e6db74">&#34;X76&#34;</span>, <span style="color:#e6db74">&#34;X77&#34;</span>, <span style="color:#e6db74">&#34;X78&#34;</span>, <span style="color:#e6db74">&#34;X79&#34;</span>, <span style="color:#e6db74">&#34;X80&#34;</span>, <span style="color:#e6db74">&#34;X81&#34;</span>, <span style="color:#e6db74">&#34;X82&#34;</span>, <span style="color:#e6db74">&#34;X83&#34;</span>, <span style="color:#e6db74">&#34;X84&#34;</span>, <span style="color:#e6db74">&#34;X85&#34;</span>, <span style="color:#e6db74">&#34;X86&#34;</span>, <span style="color:#e6db74">&#34;X87&#34;</span>, <span style="color:#e6db74">&#34;X88&#34;</span>, <span style="color:#e6db74">&#34;X89&#34;</span>,
        <span style="color:#e6db74">&#34;X90&#34;</span>, <span style="color:#e6db74">&#34;X91&#34;</span>, <span style="color:#e6db74">&#34;X92&#34;</span>, <span style="color:#e6db74">&#34;X93&#34;</span>, <span style="color:#e6db74">&#34;X94&#34;</span>, <span style="color:#e6db74">&#34;X95&#34;</span>, <span style="color:#e6db74">&#34;X96&#34;</span>, <span style="color:#e6db74">&#34;X97&#34;</span>, <span style="color:#e6db74">&#34;X98&#34;</span>, <span style="color:#e6db74">&#34;X99&#34;</span>, <span style="color:#e6db74">&#34;X100&#34;</span>]
    x_axisChange <span style="color:#f92672">=</span> [
        <span style="color:#e6db74">&#34;C1566&#34;</span>,<span style="color:#e6db74">&#34;C2738&#34;</span>,<span style="color:#e6db74">&#34;C2742&#34;</span>,<span style="color:#e6db74">&#34;C3284&#34;</span>,<span style="color:#e6db74">&#34;C4179&#34;</span>,<span style="color:#e6db74">&#34;C4182&#34;</span>,<span style="color:#e6db74">&#34;K01&#34;</span>, <span style="color:#e6db74">&#34;K02&#34;</span>, <span style="color:#e6db74">&#34;K03&#34;</span>, <span style="color:#e6db74">&#34;K04&#34;</span>, <span style="color:#e6db74">&#34;K05&#34;</span>, <span style="color:#e6db74">&#34;K06&#34;</span>, <span style="color:#e6db74">&#34;K07&#34;</span>, <span style="color:#e6db74">&#34;K08&#34;</span>, <span style="color:#e6db74">&#34;K09&#34;</span>, <span style="color:#e6db74">&#34;K10&#34;</span>, <span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;6&#34;</span>, <span style="color:#e6db74">&#34;7&#34;</span>, <span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;9&#34;</span>,
        <span style="color:#e6db74">&#34;10&#34;</span>, <span style="color:#e6db74">&#34;11&#34;</span>, <span style="color:#e6db74">&#34;12&#34;</span>, <span style="color:#e6db74">&#34;13&#34;</span>, <span style="color:#e6db74">&#34;14&#34;</span>, <span style="color:#e6db74">&#34;15&#34;</span>, <span style="color:#e6db74">&#34;16&#34;</span>, <span style="color:#e6db74">&#34;17&#34;</span>, <span style="color:#e6db74">&#34;18&#34;</span>, <span style="color:#e6db74">&#34;19&#34;</span>, <span style="color:#e6db74">&#34;20&#34;</span>, <span style="color:#e6db74">&#34;21&#34;</span>, <span style="color:#e6db74">&#34;22&#34;</span>, <span style="color:#e6db74">&#34;23&#34;</span>, <span style="color:#e6db74">&#34;24&#34;</span>, <span style="color:#e6db74">&#34;25&#34;</span>, <span style="color:#e6db74">&#34;26&#34;</span>, <span style="color:#e6db74">&#34;27&#34;</span>, <span style="color:#e6db74">&#34;28&#34;</span>,
        <span style="color:#e6db74">&#34;29&#34;</span>, <span style="color:#e6db74">&#34;30&#34;</span>, <span style="color:#e6db74">&#34;31&#34;</span>, <span style="color:#e6db74">&#34;32&#34;</span>, <span style="color:#e6db74">&#34;33&#34;</span>, <span style="color:#e6db74">&#34;34&#34;</span>, <span style="color:#e6db74">&#34;35&#34;</span>, <span style="color:#e6db74">&#34;36&#34;</span>, <span style="color:#e6db74">&#34;37&#34;</span>, <span style="color:#e6db74">&#34;38&#34;</span>, <span style="color:#e6db74">&#34;40&#34;</span>, <span style="color:#e6db74">&#34;41&#34;</span>, <span style="color:#e6db74">&#34;42&#34;</span>, <span style="color:#e6db74">&#34;43&#34;</span>, <span style="color:#e6db74">&#34;44&#34;</span>, <span style="color:#e6db74">&#34;45&#34;</span>, <span style="color:#e6db74">&#34;46&#34;</span>, <span style="color:#e6db74">&#34;47&#34;</span>, <span style="color:#e6db74">&#34;48&#34;</span>,
        <span style="color:#e6db74">&#34;49&#34;</span>, <span style="color:#e6db74">&#34;50&#34;</span>, <span style="color:#e6db74">&#34;51&#34;</span>, <span style="color:#e6db74">&#34;52&#34;</span>, <span style="color:#e6db74">&#34;53&#34;</span>, <span style="color:#e6db74">&#34;54&#34;</span>, <span style="color:#e6db74">&#34;55&#34;</span>, <span style="color:#e6db74">&#34;56&#34;</span>, <span style="color:#e6db74">&#34;57&#34;</span>, <span style="color:#e6db74">&#34;58&#34;</span>, <span style="color:#e6db74">&#34;59&#34;</span>, <span style="color:#e6db74">&#34;60&#34;</span>, <span style="color:#e6db74">&#34;61&#34;</span>, <span style="color:#e6db74">&#34;62&#34;</span>, <span style="color:#e6db74">&#34;63&#34;</span>, <span style="color:#e6db74">&#34;64&#34;</span>, <span style="color:#e6db74">&#34;65&#34;</span>, <span style="color:#e6db74">&#34;66&#34;</span>, <span style="color:#e6db74">&#34;67&#34;</span>,
        <span style="color:#e6db74">&#34;68&#34;</span>, <span style="color:#e6db74">&#34;69&#34;</span>, <span style="color:#e6db74">&#34;70&#34;</span>, <span style="color:#e6db74">&#34;71&#34;</span>, <span style="color:#e6db74">&#34;72&#34;</span>, <span style="color:#e6db74">&#34;73&#34;</span>, <span style="color:#e6db74">&#34;74&#34;</span>, <span style="color:#e6db74">&#34;75&#34;</span>, <span style="color:#e6db74">&#34;76&#34;</span>, <span style="color:#e6db74">&#34;77&#34;</span>, <span style="color:#e6db74">&#34;78&#34;</span>, <span style="color:#e6db74">&#34;79&#34;</span>, <span style="color:#e6db74">&#34;80&#34;</span>, <span style="color:#e6db74">&#34;81&#34;</span>, <span style="color:#e6db74">&#34;82&#34;</span>, <span style="color:#e6db74">&#34;83&#34;</span>, <span style="color:#e6db74">&#34;84&#34;</span>, <span style="color:#e6db74">&#34;85&#34;</span>, <span style="color:#e6db74">&#34;86&#34;</span>,
        <span style="color:#e6db74">&#34;87&#34;</span>, <span style="color:#e6db74">&#34;88&#34;</span>, <span style="color:#e6db74">&#34;89&#34;</span>, <span style="color:#e6db74">&#34;90&#34;</span>, <span style="color:#e6db74">&#34;91&#34;</span>, <span style="color:#e6db74">&#34;92&#34;</span>, <span style="color:#e6db74">&#34;93&#34;</span>, <span style="color:#e6db74">&#34;94&#34;</span>, <span style="color:#e6db74">&#34;95&#34;</span>, <span style="color:#e6db74">&#34;96&#34;</span>, <span style="color:#e6db74">&#34;97&#34;</span>, <span style="color:#e6db74">&#34;98&#34;</span>, <span style="color:#e6db74">&#34;99&#34;</span>, <span style="color:#e6db74">&#34;100&#34;</span>];

    windSimspeedTable<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing\ResultsDongPingSpeedTable.csv&#39;</span>
    speedTableData<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(windSimspeedTable)
    indexMe<span style="color:#f92672">=</span>[x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> speedTableData<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>]]
    <span style="color:#75715e"># b = pd.read_excel(fileReadyAnalysis,None)</span>
    <span style="color:#75715e"># sheetnames=b.keys()</span>
    <span style="color:#75715e"># sheetvalues=b.values()</span>
    <span style="color:#75715e">#hubVelocities=np.zeros(sheetvalues.__len__())</span>

    xlsxAiwind <span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelFile(aiwindfileReadyAnalysis)
    turbines<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>accordingTable<span style="color:#f92672">.</span>__len__())
    turbineVelocity<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>accordingTable<span style="color:#f92672">.</span>__len__(),dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;float&#39;</span>)
    windSimVelocity<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>accordingTable<span style="color:#f92672">.</span>__len__(),dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;float&#39;</span>)
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#75715e">## 读取通过程序汇总的各个扇区的数据(各个机位点存储在相应sheet表中</span>
    <span style="color:#66d9ef">for</span> sheetname <span style="color:#f92672">in</span> xlsxAiwind<span style="color:#f92672">.</span>sheet_names:
        pdtemp<span style="color:#f92672">=</span>xlsxAiwind<span style="color:#f92672">.</span>parse(sheetname)
        <span style="color:#75715e">#print(pdtemp.iloc[5:20,2])</span>
        <span style="color:#75715e">#linreg = LinearRegression()</span>

        newCount<span style="color:#f92672">=</span>accordingTable<span style="color:#f92672">.</span>index(sheetname[<span style="color:#ae81ff">1</span>:])
        newCountST<span style="color:#f92672">=</span>indexMe<span style="color:#f92672">.</span>index(sheetname[<span style="color:#ae81ff">1</span>:]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_Velocity&#34;</span>)
        turbines[newCount]<span style="color:#f92672">=</span>sheetname[<span style="color:#ae81ff">1</span>:]
        windSimVelocity[newCount]<span style="color:#f92672">=</span> speedTableData<span style="color:#f92672">.</span>iloc[newCountST,<span style="color:#ae81ff">1</span>]

        <span style="color:#75715e">## 机位点名字</span>
        print(sheetname[<span style="color:#f92672">-</span><span style="color:#ae81ff">7</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>])
        <span style="color:#75715e">## 数据提取  AIWIND  单个扇区下的处理</span>
        text1<span style="color:#f92672">=</span>pdtemp<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">2</span>]
        text2<span style="color:#f92672">=</span>pdtemp<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">1</span>]
        iMax<span style="color:#f92672">=</span>[i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(text1)) <span style="color:#66d9ef">if</span> text1[i]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">90</span>]

        neededIndex<span style="color:#f92672">=</span>iMax[<span style="color:#ae81ff">0</span>]
        neededIndexSmaller<span style="color:#f92672">=</span>iMax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        smallZ<span style="color:#f92672">=</span>text1[neededIndexSmaller]
        smallV<span style="color:#f92672">=</span>text2[neededIndexSmaller]

        bigZ <span style="color:#f92672">=</span> text1[neededIndex]
        bigV <span style="color:#f92672">=</span> text2[neededIndex]
       <span style="color:#75715e"># yi=[y for y in pdtemp.iloc[0:100,1]]</span>
       <span style="color:#75715e"># linreg.fit(pdtemp.iloc[5:20,2], pdtemp.iloc[5:20,1])</span>
        hub_height<span style="color:#f92672">=</span><span style="color:#ae81ff">90</span>
        velocityPredict<span style="color:#f92672">=</span>(bigV<span style="color:#f92672">-</span>smallV)<span style="color:#f92672">/</span>(bigZ<span style="color:#f92672">-</span>smallZ)<span style="color:#f92672">*</span>(hub_height<span style="color:#f92672">-</span>smallZ)<span style="color:#f92672">+</span>smallV
<span style="color:#75715e">#        velocityPredict= linreg.predict(hub_height)</span>
        print(velocityPredict)
        turbineVelocity[newCount]<span style="color:#f92672">=</span>velocityPredict
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>concat([turbines,turbineVelocity,windSimVelocity],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
    <span style="color:#75715e">#df.to_excel(&#39;hello45.xlsx&#39;)</span>
    df<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.xlsx&#39;</span>)
    <span style="color:#75715e"># speeTableSeries=pd.Series(speedTableData.values())</span>
    <span style="color:#75715e"># tempArray=pd.concat(turbineVelocity[0:23],speeTableSeries)</span>
    <span style="color:#75715e">#temp1=[x for x in speedTableData]</span>
    <span style="color:#75715e">#temp2=[y for y in turbineVelocity]</span>
    <span style="color:#75715e">#tempArray=[temp1,temp2]</span>
    aiwindYaxis<span style="color:#f92672">=</span> turbineVelocity
    windsimYaxis<span style="color:#f92672">=</span>windSimVelocity
    <span style="color:#75715e">#ylimMax=max(tempArray[1])</span>
    <span style="color:#75715e">#ylimMin=min(tempArray[1])</span>

    ylimMax<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
    ylimMin<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>
    <span style="color:#75715e"># 开始画图</span>

    plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">8</span>))
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Sector-&#39;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Analysis&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span> )
    <span style="color:#75715e">#plt.plot(x_axix, aiwindYaxis, marker=&#39;o&#39;, color=&#39;black&#39;, label=&#39;AIWIND&#39;)</span>
    plt<span style="color:#f92672">.</span>plot(x_axisChange, aiwindYaxis, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span>,markersize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;9&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>,markerfacecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;grey&#39;</span>,markeredgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;solid&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;AIWIND&#39;</span>,linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
    <span style="color:#75715e">#plt.plot(sub_axix, test_acys,marker=&#39;*&#39;, color=&#39;red&#39;, label=&#39;testing accuracy&#39;)</span>
    <span style="color:#75715e">#plt.plot(x_axix, windsimYaxis,marker=&#39;*&#39;, color=&#39;blue&#39;, label=&#39;WindSiM&#39;)</span>
    plt<span style="color:#f92672">.</span>plot(x_axisChange, windsimYaxis,marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;*&#39;</span>,markersize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;9&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,markerfacecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;grey&#39;</span>,markeredgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;WindSiM&#39;</span>,linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
    <span style="color:#75715e">#plt.plot(x_axix, thresholds, color=&#39;blue&#39;, label=&#39;threshold&#39;)</span>
    plt<span style="color:#f92672">.</span>legend()  <span style="color:#75715e"># 显示图例</span>
    plt<span style="color:#f92672">.</span>margins(<span style="color:#ae81ff">0</span>)
    plt<span style="color:#f92672">.</span>grid()
    plt<span style="color:#f92672">.</span>ylim(ylimMin<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,ylimMax<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Turbine Names&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span> )
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Velocity&#39;</span>,fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span> )
    plt<span style="color:#f92672">.</span>tick_params(axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;both&#39;</span>,which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>,labelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span>)
    plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\work\AIWind\DongPing\Velocity-test&#34;</span><span style="color:#f92672">+</span>plotSector<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.jpg&#34;</span>,dpi <span style="color:#f92672">=</span> <span style="color:#ae81ff">900</span>)</code></pre></div>
<h3 id="玩转python-datetime"><span class="org-todo done DONE">DONE</span> 玩转python datetime</h3>
<h4 id="背景介绍">背景介绍</h4>
<p>需要把文本数据格式的时间转变为空格划分的时间信息，见下图
<a href="/images/aiwind/t1.png">功能实现</a></p>
<h4 id="技术分解">技术分解</h4>
<ol>
<li>提取时间信息</li>
<li>字符串处理，头信息组装</li>
<li>datetime格式转变，运用</li>
</ol>
<h4 id="技术实现">技术实现</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd

    <span style="color:#f92672">import</span> datetime<span style="color:#f92672">,</span>time
    csvFile<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\ew.csv&#34;</span>

    csvData<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(csvFile,skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

    <span style="color:#75715e"># print(csvData.iloc[1,0])</span>
    <span style="color:#75715e"># a=csvData.iloc[1,0]</span>
    <span style="color:#75715e"># print(a)</span>
    <span style="color:#75715e"># timeArray = time.strptime(a, &#34;%Y%m%d %H:%M:%S&#34;)</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e"># print(timeArray[1])</span>
    <span style="color:#75715e"># print(csvDatum)</span>
    versionName<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;version&#39;</span>
    versionNumber<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;01&#39;</span>
    sitename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;site name&#39;</span>
    measureTimeName<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;measure period&#39;</span>
    siteposName<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;site position&#39;</span>
    coorName<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;coordinate system&#39;</span>
    measureHeightName<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;measurement height&#39;</span>

    <span style="color:#75715e">### 必须填对测风塔位置！</span>
    sitePositionX<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;20379022.37&#39;</span>
    sitePositionY<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;4475481.11&#39;</span>
    bakFile <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;./testOutput2.tws&#34;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
  <span style="color:#75715e">## 用于字符串的填充！打印效果好看些</span>
    NameListLength<span style="color:#f92672">=</span><span style="color:#ae81ff">22</span>
    earlistDay<span style="color:#f92672">=</span>csvData<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]
    earlistDate <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>datetime<span style="color:#f92672">.</span>strptime(earlistDay, <span style="color:#e6db74">&#39;%Y%m</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> %H:%M:%S&#39;</span>)
    latestDay<span style="color:#f92672">=</span>csvData<span style="color:#f92672">.</span>iloc[len(csvData)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]
    latestDate <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>datetime<span style="color:#f92672">.</span>strptime(latestDay, <span style="color:#e6db74">&#39;%Y%m</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> %H:%M:%S&#39;</span>)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>versionName<span style="color:#f92672">.</span>ljust(NameListLength,<span style="color:#e6db74">&#34; &#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>versionNumber<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>sitename<span style="color:#f92672">.</span>ljust(NameListLength,<span style="color:#e6db74">&#34; &#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">: Tower_wind_</span><span style="color:#e6db74">{</span>earlistDate<span style="color:#f92672">.</span>year<span style="color:#e6db74">:</span><span style="color:#e6db74">04</span><span style="color:#e6db74">}{</span>earlistDate<span style="color:#f92672">.</span>month<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}{</span>earlistDate<span style="color:#f92672">.</span>day<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
          <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;-</span><span style="color:#e6db74">{</span>latestDate<span style="color:#f92672">.</span>year<span style="color:#e6db74">:</span><span style="color:#e6db74">04</span><span style="color:#e6db74">}{</span>latestDate<span style="color:#f92672">.</span>month<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}{</span>latestDate<span style="color:#f92672">.</span>day<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#e6db74">.tim&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>measureTimeName<span style="color:#f92672">.</span>ljust(NameListLength,<span style="color:#e6db74">&#34; &#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>earlistDate<span style="color:#e6db74">:</span><span style="color:#e6db74">%m/%d/%Y %H:%M</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">{</span>latestDate<span style="color:#e6db74">:</span><span style="color:#e6db74">%m/%d/%Y %H:%m</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>siteposName<span style="color:#f92672">.</span>ljust(NameListLength,<span style="color:#e6db74">&#34; &#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>sitePositionX<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>sitePositionY<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>coorName<span style="color:#f92672">.</span>ljust(NameListLength,<span style="color:#e6db74">&#34; &#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">: 3&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>measureHeightName<span style="color:#f92672">.</span>ljust(NameListLength,<span style="color:#e6db74">&#34; &#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">: 90.0&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;rec nr:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">year:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">mon:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">date:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">hour:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">min:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">dir:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">speed:&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
<span style="color:#75715e">###正式打入需要的数据</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(csvData)):
        a <span style="color:#f92672">=</span> csvData<span style="color:#f92672">.</span>iloc[i, <span style="color:#ae81ff">0</span>]
        direction <span style="color:#f92672">=</span> csvData<span style="color:#f92672">.</span>iloc[i, <span style="color:#ae81ff">1</span>]
        velocity <span style="color:#f92672">=</span> csvData<span style="color:#f92672">.</span>iloc[i, <span style="color:#ae81ff">2</span>]
        d1 <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>datetime<span style="color:#f92672">.</span>strptime(a, <span style="color:#e6db74">&#39;%Y%m</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> %H:%M:%S&#39;</span>)
        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">{</span>d1<span style="color:#f92672">.</span>year<span style="color:#e6db74">:</span><span style="color:#e6db74">04</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">{</span>d1<span style="color:#f92672">.</span>month<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">{</span>d1<span style="color:#f92672">.</span>day<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">{</span>d1<span style="color:#f92672">.</span>hour<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">{</span>d1<span style="color:#f92672">.</span>minute<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">{</span>direction<span style="color:#e6db74">}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">{</span>velocity<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>,file<span style="color:#f92672">=</span>bakFile)
    bakFile<span style="color:#f92672">.</span>close()</code></pre></div>
<h4 id="附录">附录</h4>
<ol>
<li><a href="https://blog.csdn.net/qq%5F35711912/article/details/80477950" target="_blank" rel="noopener">补全字符串</a></li>
<li><a href="https://blog.csdn.net/sunxb10/article/details/81036693" target="_blank" rel="noopener">Python格式化字符串f-string概览</a></li>
<li><a href="https://segmentfault.com/a/1190000010310346" target="_blank" rel="noopener">输出print信息到文件</a></li>
</ol>
<h3 id="perl批量工作机器程序-设计-programme-python"><span class="org-todo done DONE">DONE</span> perl批量工作机器程序                  @设计:@programme:python:</h3>
<h4 id="背景分析">背景分析</h4>
<p>很多时候，我们需要执行一条命令比如`batchFluent.bat`, `cfdpost -batch \*.cse`, `fluent 3d -i batchFluent2000`等， 在执行该命令时候，我们需要打开
cmd或者terminal，然后切换到对应脚本目录，拷贝相应脚本需要的程序，甚是麻烦，
可否把这个过程程序化？</p>
<h4 id="单个文件处理">单个文件处理</h4>
<!--list-separator-->
<ul>
<li>
<p>管道1: 转换Openfoam结果为msh和dat</p>
<p>通过下面的程序得到一个项目文件相关的msh, 比如YangJiang ,就会得到YangJiang.msh以及YangJiang.dat等， 也就是升华技术，可提取一个
技术变量，projectName=&ldquo;YangJiang&rdquo;</p>
<p>batchFluent.bat(不需要修改!)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">    rem 路径相应修改为电脑上的安装文件夹路径
    set OPENFOAM_WIN_DIR<span style="color:#f92672">=</span>D:/Program Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span>/AIWind/solver/OpenFOAMv18.06
    set WM_PROJECT_DIR<span style="color:#f92672">=</span>%OPENFOAM_WIN_DIR%
    set PATH<span style="color:#f92672">=</span>%OPENFOAM_WIN_DIR%<span style="color:#ae81ff">\b</span>in;%OPENFOAM_WIN_DIR%<span style="color:#ae81ff">\b</span>in/mpi;%OPENFOAM_WIN_DIR%<span style="color:#ae81ff">\l</span>ib;
    set MPI_BUFFER_SIZE<span style="color:#f92672">=</span><span style="color:#ae81ff">20000000</span>
    rem 将foamDataToFluentDict放入算例<span style="color:#ae81ff">\n</span>oTurbine<span style="color:#ae81ff">\1</span>0.00<span style="color:#ae81ff">\0\k</span>h<span style="color:#ae81ff">\s</span>ystem
    rem 转换网格
    foamMeshToFluent
    rem 转换数据
    foamDataToFluent

    </code></pre></div>
<p>system/foamdatatofluentdict(不需要修改)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">    FoamFile
    <span style="color:#f92672">{</span>
      version     2.0;
      format      ascii;
      note        <span style="color:#e6db74">&#34;OpenFOAM to Fluent interface control dictionary&#34;</span>;
      class       dictionary;
      object      foamDataToFluentDict;
    <span style="color:#f92672">}</span>

    p               1;
    U               2;
    //T               3;//
    //h               4;//
    k               5;
    epsilon         6;
    //alpha1          150;//
    </code></pre></div>
</li>
</ul>
<!--list-separator-->
<ul>
<li>
<p>管道2: 转换msh和dat为fluent的cas and dat(需要修改)</p>
<p>YangJiang.msh 和 YangJiang2000.dat和 YangJiang20001.cas得适配，应需进行修正，把这个升级为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">    <span style="color:#f92672">(</span>cx-gui-do cx-activate-item <span style="color:#e6db74">&#34;MenuBar*ReadSubMenu*Mesh...&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">(</span>cx-gui-do cx-set-file-dialog-entries <span style="color:#e6db74">&#34;Select File&#34;</span> <span style="color:#e6db74">&#39;( &#34;YangJiang.msh&#34;) &#34;Mesh Files (*.msh* *.MSH* )&#34;)
</span><span style="color:#e6db74">    (cx-gui-do cx-activate-item &#34;MenuBar*ReadSubMenu*Data...&#34;)
</span><span style="color:#e6db74">    (cx-gui-do cx-set-file-dialog-entries &#34;Select File&#34; &#39;</span><span style="color:#f92672">(</span> <span style="color:#e6db74">&#34;YangJiang2000.dat&#34;</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;Data Files (*.dat* *.pdat* )&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">(</span>cx-gui-do cx-activate-item <span style="color:#e6db74">&#34;MenuBar*WriteSubMenu*Case &amp; Data...&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">(</span>cx-gui-do cx-set-file-dialog-entries <span style="color:#e6db74">&#34;Select File&#34;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">(</span> <span style="color:#e6db74">&#34;YangJiang20001.cas&#34;</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;Case/Data Files (*.cas* *.pdat* )&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">(</span>cx-gui-do cx-activate-item <span style="color:#e6db74">&#34;MenuBar*WriteSubMenu*Stop Journal&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">(</span>cx-gui-do cx-activate-item <span style="color:#e6db74">&#34;MenuBar*FileMenu*Exit&#34;</span><span style="color:#f92672">)</span>

    </code></pre></div>
<p>运行方式为 `fluent 3d -i batchFluent2000`</p>
<p>由此可得到YangJiang20001.cas和YangJiang20001.dat</p>
</li>
</ul>
<!--list-separator-->
<ul>
<li>
<p>管道3: 提取post结果(需要修改, 修改一次，然后进行循环即可)</p>
<p>然后针对cas和dat进行线信息提取即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">    !@processDir<span style="color:#f92672">=(</span><span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface&#34;</span><span style="color:#f92672">)</span>;

    <span style="color:#75715e">################################################</span>
    <span style="color:#75715e">## 文件过滤设置</span>
    <span style="color:#75715e">################################################</span>


    !$length<span style="color:#f92672">=</span>@processDir; <span style="color:#75715e">#get the length of the processDir array</span>
    !for<span style="color:#f92672">(</span>$count<span style="color:#f92672">=</span>0;$count&lt;$length;$count++<span style="color:#f92672">){</span>

      !$pathDir <span style="color:#f92672">=</span> $processDir<span style="color:#f92672">[</span>$count<span style="color:#f92672">]</span>;
      <span style="color:#75715e">#!$file = &#34;huailai20m220001.dat&#34;; ## for 814w and 1425w</span>
      !$file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;YangJiang20001.dat&#34;</span>; <span style="color:#75715e">## for 325w</span>
      !$currentFilename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>pathDir<span style="color:#e6db74">}</span><span style="color:#e6db74">//</span>$file<span style="color:#e6db74">&#34;</span>;

      <span style="color:#75715e">###   Create output directory</span>
      !$outputLine<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;forLinesOutput0&#34;</span>;
      !$outputLineDir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>pathDir<span style="color:#e6db74">}</span><span style="color:#e6db74">//</span>$outputLine<span style="color:#e6db74">&#34;</span>;
      !if<span style="color:#f92672">(</span>! -e $outputLineDir<span style="color:#f92672">){</span>
        !mkdir $outputLineDir;
        !print <span style="color:#e6db74">&#34;</span>$outputLineDir<span style="color:#e6db74"> create successfully!&#34;</span>;
        !<span style="color:#f92672">}</span>

    </code></pre></div>
</li>
</ul>
<h4 id="技术分解1-批量后处理openfoam结果到dat格式">技术分解1&mdash;- 批量后处理Openfoam结果到dat格式</h4>
<ol>
<li>准备文件</li>
<li>链接目录，切换到脚本目录，执行脚本</li>
</ol>
<h4 id="技术实现1">技术实现1</h4>
<!--list-separator-->
<ul>
<li>
<p>基础版本(初始版本)</p>
<p>事先拷贝好需要的文件放在指定位置处,使用system运行系统命令即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#75715e">#!/usr/bin/env perl</span>
    <span style="color:#75715e">#===============================================================================</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#         FILE: batchProcess814w.pl</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#        USAGE: ./batchProcess814w.pl</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#  DESCRIPTION:</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#      OPTIONS: ---</span>
    <span style="color:#75715e"># REQUIREMENTS: ---</span>
    <span style="color:#75715e">#         BUGS: ---</span>
    <span style="color:#75715e">#        NOTES: ---</span>
    <span style="color:#75715e">#       AUTHOR: YOUR NAME (),</span>
    <span style="color:#75715e"># ORGANIZATION:</span>
    <span style="color:#75715e">#      VERSION: 1.0</span>
    <span style="color:#75715e">#      CREATED: 2019/9/24 11:11:49</span>
    <span style="color:#75715e">#     REVISION: ---</span>
    <span style="color:#75715e">#===============================================================================</span>

    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;
    <span style="color:#66d9ef">use</span> utf8;
    <span style="color:#66d9ef">use</span> Cwd;

    <span style="color:#66d9ef">my</span>  $directory   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:\\huaiiLaiPP\\AIWindProject1\\noTurbine\\10.00\\&#34;</span>;
    <span style="color:#66d9ef">my</span>  $specialDirSign<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">22.5</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">67.5</span>,<span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">112.5</span>,<span style="color:#ae81ff">135</span>,<span style="color:#ae81ff">157.5</span>,<span style="color:#ae81ff">180</span>,<span style="color:#ae81ff">202.5</span>,<span style="color:#ae81ff">225</span>,<span style="color:#ae81ff">247.5</span>,<span style="color:#ae81ff">270</span>,<span style="color:#ae81ff">292.5</span>,<span style="color:#ae81ff">315</span>,<span style="color:#ae81ff">337.5</span>];


    <span style="color:#66d9ef">foreach</span> <span style="color:#66d9ef">my</span> $name ( @$specialDirSign ) {
        <span style="color:#66d9ef">my</span>  $tempdirectory<span style="color:#f92672">=</span>sprintf(<span style="color:#e6db74">&#34;$directory\\$name\\huailai20m2\\&#34;</span>);
        <span style="color:#75715e">#my  $tempBatchFile=sprintf(&#34;$directory\\$name\\huailai20m2\\batchFluent.bat&#34;);</span>
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
        chdir($tempdirectory);
        <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
        <span style="color:#75715e">#system($tempBatchFile)</span>
        system(<span style="color:#e6db74">&#34;batchFluent.bat&#34;</span>)
    }

    </code></pre></div>
</li>
</ul>
<!--list-separator-->
<ul>
<li>
<p>高级版本</p>
<p>让程序在指定的位置自己拷贝需要的文件, 采用&lt;:Copy函数&gt;</p>
<p>根据目录结构可以进行对应修改</p>
 <!--list-separator-->
<ul>
<li>
<p>下面针对的是不同风速，相同扇区【0扇区】的结果</p>
<ol>
<li>规律：找到noturbine文件夹</li>
<li>规律：找到项目文件名kh, yandun,YangJiang等</li>
</ol>
 <!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">        <span style="color:#75715e">#!/usr/bin/env perl</span>
        <span style="color:#75715e">#===============================================================================</span>
        <span style="color:#75715e">#</span>
        <span style="color:#75715e">#         FILE: batchProcess814w.pl</span>
        <span style="color:#75715e">#</span>
        <span style="color:#75715e">#        USAGE: ./batchProcess814w.pl</span>
        <span style="color:#75715e">#</span>
        <span style="color:#75715e">#  DESCRIPTION:</span>
        <span style="color:#75715e">#</span>
        <span style="color:#75715e">#      OPTIONS: ---</span>
        <span style="color:#75715e"># REQUIREMENTS: ---</span>
        <span style="color:#75715e">#         BUGS: ---</span>
        <span style="color:#75715e">#        NOTES: ---</span>
        <span style="color:#75715e">#       AUTHOR: YOUR NAME (),</span>
        <span style="color:#75715e"># ORGANIZATION:</span>
        <span style="color:#75715e">#      VERSION: 1.0</span>
        <span style="color:#75715e">#      CREATED: 2019/9/24 11:11:49</span>
        <span style="color:#75715e">#     REVISION: ---</span>
        <span style="color:#75715e">#===============================================================================</span>

        <span style="color:#66d9ef">use</span> strict;
        <span style="color:#66d9ef">use</span> warnings;
        <span style="color:#66d9ef">use</span> utf8;
        <span style="color:#66d9ef">use</span> Cwd;
        <span style="color:#66d9ef">use</span> File::Copy;

        <span style="color:#66d9ef">my</span>  $directory   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:\\NewCosMount\\noTurbine\\&#34;</span>;
        <span style="color:#66d9ef">my</span>  $specialDirSign<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;6.00&#34;</span>,<span style="color:#e6db74">&#34;7.00&#34;</span>,<span style="color:#e6db74">&#34;8.00&#34;</span>,<span style="color:#e6db74">&#34;9.00&#34;</span>,<span style="color:#e6db74">&#34;10.00&#34;</span>];

        <span style="color:#66d9ef">my</span> $sourceFileDirs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\NewCosMount\\noTurbine\\batChProcess\\&#34;</span>;
        <span style="color:#66d9ef">my</span>  $targetFileSign1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;foamDataToFluentDict&#34;</span>;
        <span style="color:#66d9ef">my</span>  $targetFileSign2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;batchFluent.bat&#34;</span>;

        <span style="color:#66d9ef">foreach</span> <span style="color:#66d9ef">my</span> $name ( @$specialDirSign ) {
            <span style="color:#66d9ef">my</span>  $tempdirectory<span style="color:#f92672">=</span>sprintf(<span style="color:#e6db74">&#34;$directory\\$name\\0\\kh\\&#34;</span>);
            <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
            chdir($tempdirectory);

            <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
            <span style="color:#66d9ef">my</span> $dictFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;$tempdirectory//system//$targetFileSign1&#34;</span>;
            <span style="color:#66d9ef">my</span> $batchFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;$tempdirectory//$targetFileSign2&#34;</span>;
            copy(<span style="color:#e6db74">&#34;$sourceFileDirs\\$targetFileSign1&#34;</span>,<span style="color:#e6db74">&#34;$dictFile&#34;</span>);

            copy(<span style="color:#e6db74">&#34;$sourceFileDirs\\$targetFileSign2&#34;</span>,<span style="color:#e6db74">&#34;$batchFile&#34;</span>);
            <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
            <span style="color:#75715e">#system($tempBatchFile)</span>
            system(<span style="color:#e6db74">&#34;batchFluent.bat&#34;</span>)
        }

        </code></pre></div>
</li>
</ul>
 <!--list-separator-->
<ul>
<li>
<p>相同风速，不同扇区的结果</p>
<ol>
<li>找到noTurbine文件夹</li>
</ol>
 <!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">          <span style="color:#75715e">#!/usr/bin/env perl</span>
          <span style="color:#75715e">#===============================================================================</span>
          <span style="color:#75715e">#</span>
          <span style="color:#75715e">#         FILE: batchProcessHuailai814w.pl</span>
          <span style="color:#75715e">#</span>
          <span style="color:#75715e">#        USAGE: ./batchProcessHuailai814w.pl</span>
          <span style="color:#75715e">#</span>
          <span style="color:#75715e">#  DESCRIPTION:</span>
          <span style="color:#75715e">#</span>
          <span style="color:#75715e">#      OPTIONS: ---</span>
          <span style="color:#75715e"># REQUIREMENTS: ---</span>
          <span style="color:#75715e">#         BUGS: ---</span>
          <span style="color:#75715e">#        NOTES: ---</span>
          <span style="color:#75715e">#       AUTHOR: YOUR NAME (),</span>
          <span style="color:#75715e"># ORGANIZATION:</span>
          <span style="color:#75715e">#      VERSION: 1.0</span>
          <span style="color:#75715e">#      CREATED: 2019/11/7 18:47:43</span>
          <span style="color:#75715e">#     REVISION: ---</span>
          <span style="color:#75715e">#===============================================================================</span>

          <span style="color:#66d9ef">use</span> strict;
          <span style="color:#66d9ef">use</span> warnings;
          <span style="color:#66d9ef">use</span> utf8;
          <span style="color:#66d9ef">use</span> Cwd;
          <span style="color:#66d9ef">use</span> File::Copy;

          <span style="color:#75715e">#my  $directory   = &#34;&#34;;</span>
          <span style="color:#66d9ef">my</span>  $directory   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:\\YanDun20191106\\yuandun\\noTurbine\\&#34;</span>;
          <span style="color:#66d9ef">my</span>  $specialDirSign<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">22.5</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">67.5</span>,<span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">112.5</span>,<span style="color:#ae81ff">135</span>,<span style="color:#ae81ff">157.5</span>,<span style="color:#ae81ff">180</span>,<span style="color:#ae81ff">202.5</span>,<span style="color:#ae81ff">225</span>,<span style="color:#ae81ff">247.5</span>,<span style="color:#ae81ff">270</span>,<span style="color:#ae81ff">292.5</span>,<span style="color:#ae81ff">315</span>];

          <span style="color:#66d9ef">my</span> $sourceFileDirs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\huaiiLaiPP\\NewSolverLimit10e9KE\\noTurbine\\10.00\\0\\huailai20m2\\&#34;</span>;
          <span style="color:#66d9ef">my</span>  $targetFileSign1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;foamDataToFluentDict&#34;</span>;
          <span style="color:#66d9ef">my</span>  $targetFileSign2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;batchFluent.bat&#34;</span>;

          <span style="color:#66d9ef">my</span>  $projectVelocity<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;10.00&#39;</span>;
          <span style="color:#66d9ef">my</span> $projectName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;yandun&#34;</span>;
          <span style="color:#66d9ef">foreach</span> <span style="color:#66d9ef">my</span> $name ( @$specialDirSign ) {
              <span style="color:#66d9ef">my</span>  $tempdirectory<span style="color:#f92672">=</span>sprintf(<span style="color:#e6db74">&#34;$directory\\$projectVelocity\\$name\\$projectName\\&#34;</span>);
              <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
              chdir($tempdirectory);

              <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
              <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
              <span style="color:#66d9ef">my</span> $dictFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;$tempdirectory//system//$targetFileSign1&#34;</span>;
              <span style="color:#66d9ef">my</span> $batchFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;$tempdirectory//$targetFileSign2&#34;</span>;
        <span style="color:#75715e">## bug 修复！</span>
              copy(<span style="color:#e6db74">&#34;$sourceFileDirs\\system\\$targetFileSign1&#34;</span>,<span style="color:#e6db74">&#34;$dictFile&#34;</span>);

              copy(<span style="color:#e6db74">&#34;$sourceFileDirs\\$targetFileSign2&#34;</span>,<span style="color:#e6db74">&#34;$batchFile&#34;</span>);
              <span style="color:#75715e">#system($tempBatchFile)</span>
              system(<span style="color:#e6db74">&#34;batchFluent.bat&#34;</span>);
          }

        </code></pre></div>
</li>
</ul>
</li>
</ul>
<h4 id="技术分解2-批量处理dat文件到post格式">技术分解2&mdash;-批量处理dat文件到post格式</h4>
<p>需要执行fluent的journal命令
核心是fluent脚本</p>
<ol>
<li>读入msh</li>
<li>读入dat</li>
<li>保存cas &amp; dat
具体文件需要修改msh和dat前缀</li>
</ol>
<!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">(cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>activate<span style="color:#f92672">-</span>item <span style="color:#e6db74">&#34;MenuBar*ReadSubMenu*Mesh...&#34;</span>)
(cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>set<span style="color:#f92672">-</span>file<span style="color:#f92672">-</span>dialog<span style="color:#f92672">-</span>entries <span style="color:#e6db74">&#34;Select File&#34;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>( <span style="color:#e6db74">&#34;huailai20m2.msh&#34;</span>) <span style="color:#e6db74">&#34;Mesh Files (*.msh* *.MSH* )&#34;</span>)
  (cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>activate<span style="color:#f92672">-</span>item <span style="color:#e6db74">&#34;MenuBar*ReadSubMenu*Data...&#34;</span>)
  (cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>set<span style="color:#f92672">-</span>file<span style="color:#f92672">-</span>dialog<span style="color:#f92672">-</span>entries <span style="color:#e6db74">&#34;Select File&#34;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>( <span style="color:#e6db74">&#34;huailai20m22000.dat&#34;</span>) <span style="color:#e6db74">&#34;Data Files (*.dat* *.pdat* )&#34;</span>)
  (cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>activate<span style="color:#f92672">-</span>item <span style="color:#e6db74">&#34;MenuBar*WriteSubMenu*Case &amp; Data...&#34;</span>)
  (cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>set<span style="color:#f92672">-</span>file<span style="color:#f92672">-</span>dialog<span style="color:#f92672">-</span>entries <span style="color:#e6db74">&#34;Select File&#34;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>( <span style="color:#e6db74">&#34;huailai20m220001.cas&#34;</span>) <span style="color:#e6db74">&#34;Case/Data Files (*.cas* *.pdat* )&#34;</span>)
  (cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>activate<span style="color:#f92672">-</span>item <span style="color:#e6db74">&#34;MenuBar*WriteSubMenu*Stop Journal&#34;</span>)
  (cx<span style="color:#f92672">-</span>gui<span style="color:#f92672">-</span><span style="color:#66d9ef">do</span> cx<span style="color:#f92672">-</span>activate<span style="color:#f92672">-</span>item <span style="color:#e6db74">&#34;MenuBar*FileMenu*Exit&#34;</span>)</code></pre></div>
<p>核心命令： `fluent 3d -i batchFluent2000`</p>
<h4 id="技术实现2">技术实现2</h4>
<!--list-separator-->
<ul>
<li>
<p>相同风速下，不同扇区处理</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#75715e">#!/usr/bin/env perl</span>
    <span style="color:#75715e">#===============================================================================</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#         FILE: journalTransferAIWINDTOFluentCasDat814w.pl</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#        USAGE: ./journalTransferAIWINDTOFluentCasDat814w.pl</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#  DESCRIPTION:</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#      OPTIONS: ---</span>
    <span style="color:#75715e"># REQUIREMENTS: ---</span>
    <span style="color:#75715e">#         BUGS: ---</span>
    <span style="color:#75715e">#        NOTES: ---</span>
    <span style="color:#75715e">#       AUTHOR: YOUR NAME (),</span>
    <span style="color:#75715e"># ORGANIZATION:</span>
    <span style="color:#75715e">#      VERSION: 1.0</span>
    <span style="color:#75715e">#      CREATED: 2019/9/27 15:43:35</span>
    <span style="color:#75715e">#     REVISION: ---</span>
    <span style="color:#75715e">#===============================================================================</span>

    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;
    <span style="color:#66d9ef">use</span> utf8;
    <span style="color:#66d9ef">use</span> Cwd;
    <span style="color:#66d9ef">use</span> File::Copy;

    <span style="color:#75715e">#my  $directory   = &#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&#34;;</span>
    <span style="color:#66d9ef">my</span>  $directory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:\\huaiiLaiPP\\AIWindProject1\\noTurbine\\10.00\\&#34;</span>;
    <span style="color:#75715e">#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];</span>
    <span style="color:#75715e">#my  $specialDirSign=[0,45,135,270,292.5];</span>

    <span style="color:#66d9ef">my</span>  $sourceFluentBatchFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\90\\huailai20m2\\fluentInterface\\batchFluent2000&#34;</span>;

    <span style="color:#66d9ef">foreach</span> <span style="color:#66d9ef">my</span> $name ( @$specialDirSign ) {
        <span style="color:#66d9ef">my</span>  $tempdirectory<span style="color:#f92672">=</span>sprintf(<span style="color:#e6db74">&#34;$directory\\$name\\huailai20m2\\fluentInterface\\&#34;</span>);
        <span style="color:#66d9ef">my</span>  $destinationFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;$tempdirectory\\batchFluent2000&#34;</span>;

        copy($sourceFluentBatchFile,$destinationFile) <span style="color:#f92672">or</span> die <span style="color:#e6db74">&#34;Copy failed: $!&#34;</span>;
        <span style="color:#75715e">#my  $tempBatchFile=sprintf(&#34;$directory\\$name\\huailai20m2\\batchFluent.bat&#34;);</span>
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
        chdir($tempdirectory);
        <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
        <span style="color:#75715e">#system($tempBatchFile)</span>
        system(<span style="color:#e6db74">&#34;fluent 3d -i batchFluent2000&#34;</span>);
    }
    </code></pre></div>
</li>
</ul>
<!--list-separator-->
<ul>
<li>
<p>快速格式化项目的batchFluent2000</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;

    <span style="color:#66d9ef">use</span> File::Slurp <span style="color:#e6db74">qw(read_file write_file)</span>;
    <span style="color:#75715e">#open(FEIJI,&#34;C:\\Users\\yezhaoliang\\Desktop\\probe.cse&#34;) or die &#34;can&#39;t open the file \n&#34;;</span>
    <span style="color:#75715e">#my $car =&#34;@lidarX1&#34;;</span>


    <span style="color:#66d9ef">my</span> $filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C:\\Users\\yezhaoliang\\Desktop\\batchFluent2000&#34;</span>;

    <span style="color:#66d9ef">my</span>  $projectOld<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;huailai20m2&#34;</span>;
    <span style="color:#66d9ef">my</span>  $projectNew<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YangJiang&#34;</span>;
    <span style="color:#66d9ef">my</span> $data <span style="color:#f92672">=</span> read_file $filename, {binmode <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;utf8&#39;</span>};
    <span style="color:#75715e">## 文件内容替换---- 也可以用IO:All-&gt;slurp函数</span>

    $data <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/$projectOld/$projectNew/g</span>;
    <span style="color:#75715e">## 删除掉^M</span>
    $data <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/\r//g</span>;
    write_file $filename, {binmode <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;:utf8&#39;</span>},$data;

    </code></pre></div>
</li>
</ul>
<h4 id="技术升维">技术升维</h4>
<ol>
<li>思考目录结构</li>
<li>思考要执行命令</li>
<li>思考命令执行的内容&mdash;可升级对应文件内容的修改</li>
<li>一个可以生成你需要的可执行程序，并具备普适性!Macro programming</li>
</ol>
<h4 id="附录">附录</h4>
<ol>
<li>
<p><a href="https://blog.csdn.net/lxp90/article/details/76228104" target="_blank" rel="noopener">perl单行替换文件内容</a>(先temp，然后rename到原始文件名，删除temp备份)</p>
</li>
<li>
<p><a href="https://blog.csdn.net/blog%5Fabel/article/details/40589227" target="_blank" rel="noopener">perl s替换</a></p>
</li>
<li>
<p><a href="https://cn.perlmaven.com/how-to-replace-a-string-in-a-file-with-perl" target="_blank" rel="noopener">perl slurp</a>(输入s命令到slurp中，执行！ `cpanm &lt;:Slurp&gt;`)</p>
</li>
<li>
<p><a href=":Slurphttps://metacpan.org/pod/File">File::Slurp</a> edit_file command file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#66d9ef">use</span> File::Slurp <span style="color:#e6db74">qw(edit_file)</span>;
    <span style="color:#75715e"># perl -0777 -pi -e &#39;s/foo/bar/g&#39; /path/file</span>
    edit_file { <span style="color:#e6db74">s/foo/bar/g</span> } <span style="color:#e6db74">&#39;/path/file&#39;</span>;
    edit_file <span style="color:#66d9ef">sub</span> { <span style="color:#e6db74">s/foo/bar/g</span> }, <span style="color:#e6db74">&#39;/path/file&#39;</span>;
    <span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">replace_foo</span> { <span style="color:#e6db74">s/foo/bar/g</span> }
    edit_file <span style="color:#f92672">\&amp;</span>replace_foo, <span style="color:#e6db74">&#39;/path/file&#39;</span>;
    </code></pre></div>
</li>
<li>
<p><a href="http://blogs.perl.org/users/leon%5Ftimmermans/2015/08/fileslurp-is-broken-and-wrong.html" target="_blank" rel="noopener">perl slurp bugs and unmaintained</a>  可以选用Slurper, <a href="https://metacpan.org/pod/Path::Tiny" target="_blank" rel="noopener">Path:Tiny</a>  or <a href="https://metacpan.org/pod/IO::All" target="_blank" rel="noopener">Io:ALL</a></p>
</li>
<li>
<p>path::Tiny   `path(&ldquo;foo.txt&rdquo;)-&gt;move(&ldquo;bar.txt&rdquo;);`</p>
</li>
<li>
<p>简单处理<a href="https://www.perl.com/pub/2004/03/12/ioall.html/" target="_blank" rel="noopener">IO::All</a></p>
</li>
<li>
<p>虽然slurp废弃了，但发现依然不错
文件内容单行处理，所以无法循环，没有if判断等。但可以执行批处理，而IO:All使用
`my $line = $io-&gt;getline` ,其实使用内置的函数即可`while(&lt;$fh&gt;)`即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">         <span style="color:#66d9ef">use</span> strict;
         <span style="color:#66d9ef">use</span> warnings;
         <span style="color:#66d9ef">use</span> File::Slurp <span style="color:#e6db74">qw(read_file write_file)</span>;
         <span style="color:#66d9ef">my</span> $filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C:\\Users\\yezhaoliang\\Desktop\\probe.cse&#34;</span>;

    <span style="color:#75715e">##gbk or gb2312</span>
         <span style="color:#66d9ef">my</span> $data <span style="color:#f92672">=</span> read_file $filename, {binmode <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;gbk&#39;</span>};
         <span style="color:#75715e">## 文件内容替换---- 也可以用IO:All-&gt;slurp函数</span>
         $data <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/风廓线/小心了/g</span>;
         <span style="color:#75715e">## 删除掉^M</span>
         $data <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/\r//g</span>;
         write_file $filename, {binmode <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;:gbk&#39;</span>},$data;

    </code></pre></div>
<p>英文替换</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;
    <span style="color:#66d9ef">use</span> File::Slurp <span style="color:#e6db74">qw(read_file write_file)</span>;
    <span style="color:#66d9ef">my</span> $filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C:\\Users\\yezhaoliang\\Desktop\\probe.cse&#34;</span>;

    <span style="color:#66d9ef">my</span> $data <span style="color:#f92672">=</span> read_file $filename, {binmode <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;utf8&#39;</span>};
    <span style="color:#75715e">## 文件内容替换---- 也可以用IO:All-&gt;slurp函数</span>
    $data <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/lidar/Leida/g</span>;
    <span style="color:#75715e">## 删除掉^M</span>
    $data <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/\r//g</span>;
    write_file $filename, {binmode <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;:utf8&#39;</span>},$data;

    </code></pre></div>
</li>
<li>
<p>回归到原始程序，只用内置函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    open(F1,<span style="color:#e6db74">&#39;&lt;test.txt&#39;</span>);
    open(F2,<span style="color:#e6db74">&#39;&gt;test.txt.tmp&#39;</span>);
    <span style="color:#66d9ef">while</span> ($s<span style="color:#f92672">=</span><span style="color:#e6db74">&lt;F1&gt;</span>){
        $s <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/1234/ABCD/g</span>;
        <span style="color:#66d9ef">print</span> F2, $s;
    }
    close(F2);
    close(F1);

    unlink(<span style="color:#e6db74">&#39;test.txt&#39;</span>);
    rename(<span style="color:#e6db74">&#39;test.txt.tmp&#39;</span>,<span style="color:#e6db74">&#39;test.txt&#39;</span>);
    </code></pre></div>
<p>其实外置、内置的思路都是open、循环、删除、重命名的过程
这样还可以不断拓展，增加判断等。</p>
</li>
</ol>
<!--list-separator-->
<ul>
<li>
<p>增强版的自定义功能</p>
<p>如果遇到某种条件下的文件则执行对应的修正</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;


    <span style="color:#66d9ef">my</span>	$input_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">qw&#34;c:\users\yezhaoliang\desktop\probe1.cse&#34;</span>;

    open  <span style="color:#66d9ef">my</span> $input, <span style="color:#e6db74">&#39;&lt;&#39;</span>, $input_file_name
        <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  input file &#39;$input_file_name&#39; : $!\n&#34;</span>;


    <span style="color:#66d9ef">my</span>	$output_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">qw&#34;c:\users\yezhaoliang\desktop\probe2.cse&#34;</span>; <span style="color:#75715e"># output file name</span>

    open  <span style="color:#66d9ef">my</span> $output, <span style="color:#e6db74">&#39;&gt;&#39;</span>, $output_file_name
        <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  output file &#39;$output_file_name&#39; : $!\n&#34;</span>;


    <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">my</span> $line<span style="color:#f92672">=</span><span style="color:#e6db74">&lt;$input&gt;</span>){

        <span style="color:#66d9ef">if</span> (  $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/(^!\@processDir=)/xm</span>) {
            $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/(^!\@processDir=)/$1She/g</span>;
        }
        <span style="color:#66d9ef">elsif</span> (   $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/(^!\$file\s=\s&#34;(.*)&#34;)/xm</span> ) {
            $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/$2/hello.dat/g</span>;
        }
        <span style="color:#66d9ef">print</span> $output $line;
    }


    close  $output
        <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close output file &#39;$output_file_name&#39; : $!\n&#34;</span>;
    close  $input
        <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close input file &#39;$input_file_name&#39; : $!\n&#34;</span>;


    </code></pre></div>
</li>
</ul>
<!--list-separator-->
<ul>
<li>
<p>案例1：批量修改batchFluent2000、替换 然后执行【完美版】</p>
<ol>
<li>修改</li>
<li>执行</li>
</ol>
 <!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;
    <span style="color:#66d9ef">use</span> utf8;
    <span style="color:#66d9ef">use</span> Cwd;

    <span style="color:#75715e">#my  $directory   = &#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&#34;;</span>
    <span style="color:#66d9ef">my</span>  $directory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00&#34;</span>;
    <span style="color:#75715e">#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];</span>
    <span style="color:#66d9ef">my</span>  $specialDirSign<span style="color:#f92672">=</span>[<span style="color:#ae81ff">22.5</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">67.5</span>,<span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">112.5</span>,<span style="color:#ae81ff">135</span>,<span style="color:#ae81ff">157.5</span>];
    <span style="color:#75715e">#my  $specialDirSign=[0,45,135,270,292.5];</span>

    <span style="color:#66d9ef">my</span>  $sourceFluentBatchFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\batchFluent2000&#34;</span>;

    <span style="color:#66d9ef">my</span>  $oldProjectName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Huailai20m2&#34;</span>;
    <span style="color:#66d9ef">my</span>  $projectName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YangJiang&#34;</span>;

    <span style="color:#66d9ef">foreach</span> <span style="color:#66d9ef">my</span> $name ( @$specialDirSign ) {
        <span style="color:#66d9ef">my</span>  $tempdirectory<span style="color:#f92672">=</span>sprintf(<span style="color:#e6db74">&#34;$directory\\$name\\$projectName\\fluentInterface\\&#34;</span>);
        <span style="color:#66d9ef">my</span>  $destinationFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;$tempdirectory\\batchFluent2000&#34;</span>;

        <span style="color:#66d9ef">my</span>	$input_file_name <span style="color:#f92672">=</span> $sourceFluentBatchFile;
        open  <span style="color:#66d9ef">my</span> $input, <span style="color:#e6db74">&#39;&lt;&#39;</span>, $input_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  input file &#39;$input_file_name&#39; : $!\n&#34;</span>;
        <span style="color:#66d9ef">my</span>	$output_file_name <span style="color:#f92672">=</span> sprintf(<span style="color:#e6db74">&#34;$tempdirectory\\batchFluent2000&#34;</span>); <span style="color:#75715e"># output file name</span>
        open  <span style="color:#66d9ef">my</span> $output, <span style="color:#e6db74">&#39;&gt;&#39;</span>, $output_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  output file &#39;$output_file_name&#39; : $!\n&#34;</span>;

        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">my</span> $line<span style="color:#f92672">=</span><span style="color:#e6db74">&lt;$input&gt;</span>){

            <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/$oldProjectName/xm</span>) {
                <span style="color:#75715e">## 要求1</span>
                $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/$oldProjectName/$projectName/gm</span>
            }
            <span style="color:#66d9ef">print</span> $output $line;
        }

        close  $output
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close output file &#39;$output_file_name&#39; : $!\n&#34;</span>;
        close  $input
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close input file &#39;$input_file_name&#39; : $!\n&#34;</span>;


        <span style="color:#75715e">#copy($sourceFluentBatchFile,$destinationFile) or die &#34;Copy failed: $!&#34;;</span>
        <span style="color:#75715e">#my  $tempBatchFile=sprintf(&#34;$directory\\$name\\huailai20m2\\batchFluent.bat&#34;);</span>
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
        chdir($tempdirectory);
        <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
        <span style="color:#75715e">#system($tempBatchFile)</span>
        system(<span style="color:#e6db74">&#34;fluent 3d -i batchFluent2000&#34;</span>);
    }

    </code></pre></div>
</li>
</ul>
<!--list-separator-->
<ul>
<li>
<p>案例2：批量修改probelinesAndexport.cse、替换 然后执行【完美版】</p>
<p>原先是使用copy命令，现在完全用perl程序，控制不同扇区或者速度的修正，并更新到对应文件后，写入到具体目录， 最终执行即可!</p>
<ol>
<li>修改</li>
<li>执行</li>
</ol>
 <!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;
    <span style="color:#66d9ef">use</span> Cwd;

    <span style="color:#75715e">#my  $directory   = &#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&#34;;</span>
    <span style="color:#66d9ef">my</span>  $directory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00&#34;</span>;
    <span style="color:#75715e">#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];</span>
    <span style="color:#66d9ef">my</span>  $specialDirSign<span style="color:#f92672">=</span>[<span style="color:#ae81ff">22.5</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">67.5</span>,<span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">112.5</span>,<span style="color:#ae81ff">135</span>,<span style="color:#ae81ff">157.5</span>];
    <span style="color:#75715e">#my  $specialDirSign=[0,45,135,270,292.5];</span>
    <span style="color:#66d9ef">my</span>  $projectName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YangJiang&#34;</span>;

    <span style="color:#66d9ef">my</span>  $sourceFluentBatchFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\probeLinesAndExportYangJiang.cse&#34;</span>;

    <span style="color:#66d9ef">foreach</span> <span style="color:#66d9ef">my</span> $Sectorname ( @$specialDirSign ) {
        <span style="color:#66d9ef">my</span>  $tempdirectory<span style="color:#f92672">=</span>sprintf(<span style="color:#e6db74">&#34;$directory\\$Sectorname\\$projectName\\fluentInterface\\&#34;</span>);

        <span style="color:#66d9ef">my</span>	$input_file_name <span style="color:#f92672">=</span> $sourceFluentBatchFile;
        open  <span style="color:#66d9ef">my</span> $input, <span style="color:#e6db74">&#39;&lt;&#39;</span>, $input_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  input file &#39;$input_file_name&#39; : $!\n&#34;</span>;
        <span style="color:#66d9ef">my</span>	$output_file_name <span style="color:#f92672">=</span> sprintf(<span style="color:#e6db74">&#34;$tempdirectory\\probelinesAndExport.cse&#34;</span>); <span style="color:#75715e"># output file name</span>
        open  <span style="color:#66d9ef">my</span> $output, <span style="color:#e6db74">&#39;&gt;&#39;</span>, $output_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  output file &#39;$output_file_name&#39; : $!\n&#34;</span>;

        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">my</span> $line<span style="color:#f92672">=</span><span style="color:#e6db74">&lt;$input&gt;</span>){

            <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/(^!\@processDir=\(&#34;(.*)&#34;\))/xm</span>) {
                $line <span style="color:#f92672">=</span> sprintf(<span style="color:#e6db74">&#34;!\@processDir=\&#34;$tempdirectory\&#34;;&#34;</span>);
                <span style="color:#75715e">## 要求1</span>
                $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/\\/\\\\/gxm</span>
            }
            <span style="color:#66d9ef">elsif</span> (  $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/(^!\$file\s=\s&#34;(.*)&#34;)/xm</span> ) {
                <span style="color:#75715e">## 规律</span>
                $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/$2/${projectName}20001.dat/xg</span>;
            }
            <span style="color:#66d9ef">print</span> $output $line;
        }

        close  $output
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close output file &#39;$output_file_name&#39; : $!\n&#34;</span>;
        close  $input
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close input file &#39;$input_file_name&#39; : $!\n&#34;</span>;

        <span style="color:#75715e">#copy($sourceFluentBatchFile,$destinationFile) or die &#34;Copy failed: $!&#34;;</span>
        <span style="color:#75715e">#my  $tempBatchFile=sprintf(&#34;$directory\\$name\\huailai20m2\\batchFluent.bat&#34;);</span>
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
        chdir($tempdirectory);
        <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
        <span style="color:#75715e">#system($tempBatchFile)</span>
        <span style="color:#75715e">#system(&#34;fluent 3d -i batchFluent2000&#34;);</span>
        system(<span style="color:#e6db74">&#34;cfdpost -batch probeLinesAndExport.cse&#34;</span>);
    }

    </code></pre></div>
</li>
</ul>
<!--list-separator-->
<ul>
<li>
<p>上述两个过程案例1、2可以合并</p>
<ol>
<li>确定处理哪个case, 烟墩? 怀来? 东平?</li>
<li>确定源文件是否存在! 原先的BatchFluent2000和cse文件在？</li>
</ol>
 <!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">    <span style="color:#75715e">#!/usr/bin/env perl</span>
    <span style="color:#75715e">#===============================================================================</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#         FILE: journalTransferAIWINDTOFluentCasDat814w.pl</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#        USAGE: ./journalTransferAIWINDTOFluentCasDat814w.pl</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#  DESCRIPTION:</span>
    <span style="color:#75715e">#</span>
    <span style="color:#75715e">#      OPTIONS: ---</span>
    <span style="color:#75715e"># REQUIREMENTS: ---</span>
    <span style="color:#75715e">#         BUGS: ---</span>
    <span style="color:#75715e">#        NOTES: ---</span>
    <span style="color:#75715e">#       AUTHOR: YOUR NAME (),</span>
    <span style="color:#75715e"># ORGANIZATION:</span>
    <span style="color:#75715e">#      VERSION: 1.0</span>
    <span style="color:#75715e">#      CREATED: 2019/9/27 15:43:35</span>
    <span style="color:#75715e">#     REVISION: ---</span>
    <span style="color:#75715e">#===============================================================================</span>

    <span style="color:#66d9ef">use</span> strict;
    <span style="color:#66d9ef">use</span> warnings;
    <span style="color:#66d9ef">use</span> utf8;
    <span style="color:#66d9ef">use</span> Cwd;
    <span style="color:#66d9ef">use</span> File::Copy;

    <span style="color:#75715e">#my  $directory   = &#34;D:\\huaiLaiUnder\\huaiLaiNew20190722\\huaiLaiNew20190722\\noTurbine\\10.00\\&#34;;</span>
    <span style="color:#66d9ef">my</span>  $directory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00&#34;</span>;
    <span style="color:#75715e">#my  $specialDirSign=[0,22.5,45,67.5,90,112.5,135,157.5,180,202.5,225,247.5,270,292.5,315,337.5];</span>
    <span style="color:#66d9ef">my</span>  $specialDirSign<span style="color:#f92672">=</span>[<span style="color:#ae81ff">22.5</span>];
    <span style="color:#75715e">#my  $specialDirSign=[0,45,135,270,292.5];</span>

    <span style="color:#75715e">## 确认文件是否存在</span>
    <span style="color:#66d9ef">my</span>  $sourceFluentBatchFileStep2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\batchFluent2000&#34;</span>;

    <span style="color:#75715e">## 确认文件是否存在</span>
    <span style="color:#66d9ef">my</span>  $sourceFluentBatchFileStep3<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\fluentInterface\\probeLinesAndExportYangJiang.cse&#34;</span>;

    <span style="color:#75715e">## step1</span>
    <span style="color:#66d9ef">my</span> $sourceFileDirs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D:\\AIwind\\AIWindCases\\Dongping20191105\\noTurbine\\10.00\\0\\YangJiang\\&#34;</span>;
    <span style="color:#66d9ef">my</span>  $targetFileSign1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;foamDataToFluentDict&#34;</span>;
    <span style="color:#66d9ef">my</span>  $targetFileSign2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;batchFluent.bat&#34;</span>;
    <span style="color:#66d9ef">my</span>  $projectVelocity<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;10.00&#39;</span>;
    <span style="color:#66d9ef">my</span> $projectName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YangJiang&#34;</span>;

    <span style="color:#75715e">## step2</span>
    <span style="color:#66d9ef">my</span>  $oldProjectName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Huailai20m2&#34;</span>;
    <span style="color:#75715e">#my  $projectName=&#34;YangJiang&#34;;</span>

    <span style="color:#66d9ef">foreach</span> <span style="color:#66d9ef">my</span> $name ( @$specialDirSign ) {


        <span style="color:#75715e">###########################STEP 2 ###########################</span>
        <span style="color:#66d9ef">my</span>  $tempdirectory<span style="color:#f92672">=</span>sprintf(<span style="color:#e6db74">&#34;$directory\\$name\\$projectName\\fluentInterface\\&#34;</span>);
        <span style="color:#66d9ef">my</span>  $destinationFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;$tempdirectory\\batchFluent2000&#34;</span>;

        <span style="color:#66d9ef">my</span>	$input_file_name <span style="color:#f92672">=</span> $sourceFluentBatchFileStep2;
        open  <span style="color:#66d9ef">my</span> $input, <span style="color:#e6db74">&#39;&lt;&#39;</span>, $input_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  input file &#39;$input_file_name&#39; : $!\n&#34;</span>;
        <span style="color:#66d9ef">my</span>	$output_file_name <span style="color:#f92672">=</span> sprintf(<span style="color:#e6db74">&#34;$tempdirectory\\batchFluent2000&#34;</span>); <span style="color:#75715e"># output file name</span>
        open  <span style="color:#66d9ef">my</span> $output, <span style="color:#e6db74">&#39;&gt;&#39;</span>, $output_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  output file &#39;$output_file_name&#39; : $!\n&#34;</span>;

        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">my</span> $line<span style="color:#f92672">=</span><span style="color:#e6db74">&lt;$input&gt;</span>){

            <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/$oldProjectName/xm</span>) {
                <span style="color:#75715e">## 要求1</span>
                $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/$oldProjectName/$projectName/gm</span>
            }
            <span style="color:#66d9ef">print</span> $output $line;
        }

        close  $output
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close output file &#39;$output_file_name&#39; : $!\n&#34;</span>;
        close  $input
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close input file &#39;$input_file_name&#39; : $!\n&#34;</span>;


        <span style="color:#75715e">#copy($sourceFluentBatchFile,$destinationFile) or die &#34;Copy failed: $!&#34;;</span>
        <span style="color:#75715e">#my  $tempBatchFile=sprintf(&#34;$directory\\$name\\huailai20m2\\batchFluent.bat&#34;);</span>
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
        chdir($tempdirectory);
        <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
        <span style="color:#75715e">#system($tempBatchFile)</span>
        system(<span style="color:#e6db74">&#34;fluent 3d -i batchFluent2000&#34;</span>);

        <span style="color:#75715e">###########################STEP 2 ###########################</span>

        <span style="color:#75715e">###########################STEP 3 ###########################</span>
        <span style="color:#66d9ef">my</span>	$input_file_name <span style="color:#f92672">=</span> $sourceFluentBatchFileStep3;
        open  <span style="color:#66d9ef">my</span> $input, <span style="color:#e6db74">&#39;&lt;&#39;</span>, $input_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  input file &#39;$input_file_name&#39; : $!\n&#34;</span>;
        <span style="color:#66d9ef">my</span>	$output_file_name <span style="color:#f92672">=</span> sprintf(<span style="color:#e6db74">&#34;$tempdirectory\\probelinesAndExport.cse&#34;</span>); <span style="color:#75715e"># output file name</span>
        open  <span style="color:#66d9ef">my</span> $output, <span style="color:#e6db74">&#39;&gt;&#39;</span>, $output_file_name
            <span style="color:#f92672">or</span> die  <span style="color:#e6db74">&#34;$0 : failed to open  output file &#39;$output_file_name&#39; : $!\n&#34;</span>;

        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">my</span> $line<span style="color:#f92672">=</span><span style="color:#e6db74">&lt;$input&gt;</span>){

            <span style="color:#66d9ef">if</span> ( $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/(^!\@processDir=\(&#34;(.*)&#34;\))/xm</span>) {
                $line <span style="color:#f92672">=</span> sprintf(<span style="color:#e6db74">&#34;!\@processDir=\&#34;$tempdirectory\&#34;;&#34;</span>);
                <span style="color:#75715e">## 要求1</span>
                $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/\\/\\\\/gxm</span>
            }
            <span style="color:#66d9ef">elsif</span> (  $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/(^!\$file\s=\s&#34;(.*)&#34;)/xm</span> ) {
                <span style="color:#75715e">## 规律</span>
                $line <span style="color:#f92672">=~</span> <span style="color:#e6db74">s/$2/${projectName}20001.dat/xg</span>;
            }
            <span style="color:#66d9ef">print</span> $output $line;
        }

        close  $output
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close output file &#39;$output_file_name&#39; : $!\n&#34;</span>;
        close  $input
            <span style="color:#f92672">or</span> warn <span style="color:#e6db74">&#34;$0 : failed to close input file &#39;$input_file_name&#39; : $!\n&#34;</span>;

        <span style="color:#75715e">#copy($sourceFluentBatchFile,$destinationFile) or die &#34;Copy failed: $!&#34;;</span>
        <span style="color:#75715e">#my  $tempBatchFile=sprintf(&#34;$directory\\$name\\huailai20m2\\batchFluent.bat&#34;);</span>
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;$tempdirectory\n&#34;</span>;
        chdir($tempdirectory);
        <span style="color:#66d9ef">my</span>  $mypath<span style="color:#f92672">=</span>getcwd();
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34; Temp Director: -----------&gt; $mypath\n&#34;</span>;
        <span style="color:#75715e">#system($tempBatchFile)</span>
        <span style="color:#75715e">#system(&#34;fluent 3d -i batchFluent2000&#34;);</span>
        system(<span style="color:#e6db74">&#34;cfdpost -batch probeLinesAndExport.cse&#34;</span>);

        <span style="color:#75715e">###########################STEP 3 ###########################</span>

    }


    </code></pre></div>
</li>
</ul>
<h3 id="python制作曲线动画"><span class="org-todo done DONE">DONE</span> python制作曲线动画</h3>
<p>动画是一个比较直观的方式展示你的设计过程，下文的codes可以方便按照你规定的
点序进行逐点绘制</p>
<p>编写的步骤如下技术路线图</p>
<p><a href="/images/python/hugoAnimation.png">技术路线</a></p>
<h4 id="text绘制添加增加动画效果">text绘制添加增加动画效果</h4>
<p><a href="https://www.cnblogs.com/endlesscoding/p/10308111.html" target="_blank" rel="noopener">如何在运动过程中添加背景点text</a></p>
<h4 id="mp4格式导出">mp4格式导出</h4>
<p>在Ubuntu或者mac系统可以试用image
注意控制<a href="https://blog.csdn.net/sailist/article/details/79502007" target="_blank" rel="noopener">ffmpeg</a>的路径</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">## 设置ffmpeg路径</span>
  ffmpegpath <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>abspath(<span style="color:#e6db74">&#34;./ffmpeg/bin/ffmpeg.exe&#34;</span>)
  plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#34;animation.ffmpeg_path&#34;</span>] <span style="color:#f92672">=</span> ffmpegpath
  writer <span style="color:#f92672">=</span> animation<span style="color:#f92672">.</span>FFMpegWriter()
<span style="color:#75715e">## 在sava函数中设置执行者</span>
  anim<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;test_animation.mp4&#39;</span>,writer<span style="color:#f92672">=</span>writer)</code></pre></div>
<h4 id="技术实现">技术实现</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">import</span> matplotlib.animation <span style="color:#66d9ef">as</span> animation
<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> math

<span style="color:#75715e">#fig, ax = plt.subplots()</span>
fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>))
<span style="color:#75715e">#https://blog.csdn.net/xiaosebi1111/article/details/50617433  控制子图</span>
xdata, ydata <span style="color:#f92672">=</span> [], []
ln, <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>plot([], [], <span style="color:#e6db74">&#39;rs&#39;</span>,animated<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
text_pt <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>text(<span style="color:#ae81ff">8</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">18</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">init</span>():
    ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">18</span>)
    ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">26</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>)
    <span style="color:#66d9ef">return</span> ln,

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update</span>(frame):
    xdata<span style="color:#f92672">.</span>append(frame)
    <span style="color:#75715e">#ydata.append(np.sin(frame))</span>
    ydata<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
    ln<span style="color:#f92672">.</span>set_data(xdata, ydata)
    ln<span style="color:#f92672">.</span>set_markersize(<span style="color:#ae81ff">12</span>)
    <span style="color:#66d9ef">return</span> ln,
<span style="color:#75715e"># 16控制点数</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update2</span>(frame):
    xdata<span style="color:#f92672">.</span>append(frame<span style="color:#f92672">%</span><span style="color:#ae81ff">16</span>)
    <span style="color:#75715e">#ydata.append(np.sin(frame))</span>
    ydata<span style="color:#f92672">.</span>append(math<span style="color:#f92672">.</span>floor(frame<span style="color:#f92672">/</span><span style="color:#ae81ff">16</span>) )
    ln<span style="color:#f92672">.</span>set_data(xdata, ydata)
    text_pt<span style="color:#f92672">.</span>set_text(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Sector=</span><span style="color:#e6db74">{</span>frame<span style="color:#f92672">%</span><span style="color:#ae81ff">16</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, VelocityBin=</span><span style="color:#e6db74">{</span>math<span style="color:#f92672">.</span>floor(frame<span style="color:#f92672">/</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> )
    <span style="color:#66d9ef">return</span> ln,text_pt,
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generateFrames</span>(rows<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>,cols<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>):
   count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
   dataArray<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(<span style="color:#ae81ff">16</span><span style="color:#f92672">*</span><span style="color:#ae81ff">25</span>)
   <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(rows):
       dataArray[count]<span style="color:#f92672">=</span>i
       count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
   <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(rows):
       <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(cols<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
           dataArray[count]<span style="color:#f92672">=</span>(j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>rows<span style="color:#f92672">+</span>i
           count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
   <span style="color:#66d9ef">return</span> dataArray

<span style="color:#75715e"># 16控制点数</span>
ffmpegpath <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>abspath(<span style="color:#e6db74">&#34;./ffmpeg/bin/ffmpeg.exe&#34;</span>)
plt<span style="color:#f92672">.</span>grid(ls<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>)
plt<span style="color:#f92672">.</span>tick_params(axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;both&#39;</span>, which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, labelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">18</span>)
x<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">16</span>)
y<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>ones(<span style="color:#ae81ff">16</span>)
plt<span style="color:#f92672">.</span>plot(x,y,<span style="color:#e6db74">&#39;r--&#39;</span>)
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#34;animation.ffmpeg_path&#34;</span>] <span style="color:#f92672">=</span> ffmpegpath

<span style="color:#75715e">##https://blog.csdn.net/sailist/article/details/79502007  ffmpeg路径</span>
<span style="color:#75715e">##https://www.cnblogs.com/endlesscoding/p/10308111.html   改进</span>
writer <span style="color:#f92672">=</span> animation<span style="color:#f92672">.</span>FFMpegWriter()
<span style="color:#75715e">#frames=np.linspace(0,16*25,16*25+1)</span>
frames<span style="color:#f92672">=</span>generateFrames(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">25</span>)
<span style="color:#75715e">#frames=np.linspace(-np.pi,np.pi, 16)</span>
anim <span style="color:#f92672">=</span> animation<span style="color:#f92672">.</span>FuncAnimation(fig, update2, frames<span style="color:#f92672">=</span>frames,interval<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>,
                    init_func<span style="color:#f92672">=</span>init,blit<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)

<span style="color:#75715e"># anim = animation.FuncAnimation(fig, update, frames=np.linspace(-np.pi,np.pi, 16),interval=10,</span>
<span style="color:#75715e">#                                init_func=init,blit=True)</span>
<span style="color:#75715e">#anim.save(&#39;test_animation.gif&#39;,writer=&#39;imagemagick&#39;)</span>
anim<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;test_animation.mp4&#39;</span>,writer<span style="color:#f92672">=</span>writer)
<span style="color:#75715e">#plt.show()</span></code></pre></div>
<h4 id="结果展示">结果展示</h4>
<p><a href="/images/python/dotSeries.png">点序结果</a></p>
<p>小结</p>
<p>只要修改好update函数，使其根据你设定的frames，就可以得到符合你需要的动画</p>
<h3 id="风电场scada风速手算理论发电量和k值"><span class="org-todo done DONE">DONE</span> 风电场SCADA风速手算理论发电量和K值</h3>
<h4 id="背景分析">背景分析</h4>
<p>有时候需要根据一条功率曲线，手算scada速度序列的发电量</p>
<ol>
<li>设计功率曲线</li>
<li>scada风速序列</li>
</ol>
<!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np

<span style="color:#75715e">## Yandun</span>
<span style="color:#75715e">#powerlaw=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\power12.csv&#39;)</span>
<span style="color:#75715e">## Dongping</span>
<span style="color:#75715e">#powerlaw=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\my89_12.csv&#39;)</span>
powerlaw<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\SL3000_121.pws.csv&#39;</span>)

cpVs <span style="color:#f92672">=</span> powerlaw<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">0</span>]
cpPs <span style="color:#f92672">=</span> powerlaw<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">1</span>]
<span style="color:#75715e">#velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\nacWindsim2.csv&#39;)</span>
<span style="color:#75715e">#velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\lidar.csv&#39;)</span>
<span style="color:#75715e"># velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\nac1.csv&#39;,skiprows=1)</span>

<span style="color:#75715e"># nac1= velocitySet.iloc[:,0]</span>
<span style="color:#75715e"># nac2= velocitySet.iloc[:,1]</span>
<span style="color:#75715e"># nac4= velocitySet.iloc[:,2]</span>
<span style="color:#75715e"># nac7= velocitySet.iloc[:,3]</span>
<span style="color:#75715e"># nac8= velocitySet.iloc[:,4]</span>
<span style="color:#75715e"># nac12= velocitySet.iloc[:,5]</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">find</span>(vel, cpVs):
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> cpV <span style="color:#f92672">in</span> cpVs:
        <span style="color:#66d9ef">if</span>(cpV <span style="color:#f92672">&gt;</span> vel):
            <span style="color:#66d9ef">return</span> count
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getMean</span>(cpVs,cpPs,vel):
    <span style="color:#66d9ef">if</span>(vel<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">2</span>):
        rePower<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">return</span> rePower
    index <span style="color:#f92672">=</span> find(vel, cpVs)
    v1<span style="color:#f92672">=</span> cpVs[index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    v2<span style="color:#f92672">=</span> cpVs[index]
    p1<span style="color:#f92672">=</span> cpPs[index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    p2<span style="color:#f92672">=</span> cpPs[index]
    rePower <span style="color:#f92672">=</span> p1<span style="color:#f92672">+</span>(p2<span style="color:#f92672">-</span>p1)<span style="color:#f92672">/</span>(v2<span style="color:#f92672">-</span>v1)<span style="color:#f92672">*</span>(vel<span style="color:#f92672">-</span>v1)
    <span style="color:#66d9ef">return</span> rePower
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">modify</span>(vel):
    <span style="color:#66d9ef">return</span> (vel<span style="color:#f92672">+</span><span style="color:#ae81ff">0.7081</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">0.9869</span>

<span style="color:#75715e">############################################################</span>
<span style="color:#75715e">##  Velocity linear interpolation Method ####################################</span>
<span style="color:#75715e">############################################################</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getPower</span>(nac,i):
    calPower<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    calVel<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> vel <span style="color:#f92672">in</span> nac:
        calPower[count]<span style="color:#f92672">=</span>getMean(cpVs,cpPs,modify(vel))
        <span style="color:#75715e">#calPower[count]=getMean(cpVs,cpPs,vel)</span>
        <span style="color:#75715e">#calPower[count]=getMean(cpVs,cpPs,vel)</span>
        calVel[count]<span style="color:#f92672">=</span>modify(vel)
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    calPowerSeries<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([calVel,calPower])<span style="color:#f92672">.</span>T
    calPowerSeries<span style="color:#f92672">.</span>to_csv(str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-power.csv&#34;</span>)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>sum(calPower)<span style="color:#f92672">/</span><span style="color:#ae81ff">6000</span>
<span style="color:#75715e">############################################################</span>
<span style="color:#75715e">##  Velocity Bin Method ####################################</span>
<span style="color:#75715e">############################################################</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">powerLawIntoZones</span>(zones):
    velocityZones<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">25</span>,zones)
    powerZones<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(velocityZones<span style="color:#f92672">.</span>__len__())
    velocityBinMag<span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span><span style="color:#f92672">/</span>zones
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(zones):
        velocityZones[i]<span style="color:#f92672">=</span>i<span style="color:#f92672">*</span>velocityBinMag
        powerZones[i]<span style="color:#f92672">=</span>getMean(cpVs,cpPs,i<span style="color:#f92672">*</span>velocityBinMag)
    <span style="color:#66d9ef">return</span> velocityZones,powerZones

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">whichZones</span>(vel,velocityZones,powerZones,zones):
    velocityMagnitude<span style="color:#f92672">=</span><span style="color:#ae81ff">25.0</span><span style="color:#f92672">/</span>zones
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(zones):
        <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0</span><span style="color:#f92672">==</span>i):
            <span style="color:#66d9ef">if</span>(vel<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> vel <span style="color:#f92672">&lt;</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>):
                power<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">if</span>(vel<span style="color:#f92672">&gt;=</span>(velocityZones[i]<span style="color:#f92672">-</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>)  <span style="color:#f92672">and</span>
                    vel<span style="color:#f92672">&lt;</span>(velocityZones[i]<span style="color:#f92672">+</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>) ):
                power <span style="color:#f92672">=</span> powerZones[i]
    <span style="color:#66d9ef">return</span> power


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getPowerVelocityBin</span>(nac,i,zones<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>):
    calPower<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    calVel<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    [velocityZones,powerZones]<span style="color:#f92672">=</span>powerLawIntoZones(zones)
    cps<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([velocityZones,powerZones])<span style="color:#f92672">.</span>T
    cps<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;powerVelocityBin</span><span style="color:#e6db74">{</span>zones<span style="color:#e6db74">}</span><span style="color:#e6db74">.xlsx&#34;</span>)
    <span style="color:#66d9ef">for</span> vel <span style="color:#f92672">in</span> nac:
        <span style="color:#75715e">#calPower[count]=getMean(cpVs,cpPs,vel)</span>
        calVel[count]<span style="color:#f92672">=</span>vel
        calPower[count]<span style="color:#f92672">=</span>whichZones(modify(vel),velocityZones,powerZones,zones)
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    calPowerSeries<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([calVel,calPower])<span style="color:#f92672">.</span>T
    calPowerSeries<span style="color:#f92672">.</span>to_csv(str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-powerBin.csv&#34;</span>)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>sum(calPower)<span style="color:#f92672">/</span><span style="color:#ae81ff">6000</span>
<span style="color:#75715e"># nac8 = velocitySet.iloc[:, 0]</span>
<span style="color:#75715e"># power1 = getPower(nac8,0)</span>
<span style="color:#75715e"># print(power1)</span>
<span style="color:#75715e"># 烟墩6台机组 ：0-6</span>
<span style="color:#75715e">#velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\nacVelocity.csv&#39;,skiprows=1)</span>
velocitySet<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\nacVelocity220.csv&#39;</span>,skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># 东平10台机组 ： 0-10</span>
<span style="color:#75715e">#velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\VP.csv&#39;,skiprows=1)</span>

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>):
<span style="color:#75715e">#for i in range(0,10):</span>
    nac8 <span style="color:#f92672">=</span> velocitySet<span style="color:#f92672">.</span>iloc[:, i]
    power1 <span style="color:#f92672">=</span> getPower(nac8,i)
    <span style="color:#75715e">#power1 = getPowerVelocityBin(nac8,i,50)</span>
    print(power1)</code></pre></div>
<h4 id="速度分仓">速度分仓</h4>
<ol>
<li>设计功率曲线按照分仓个数bin,进行分仓</li>
<li>按照分仓大小，设置速度范围多少归入一个仓中，比如50个分仓，仓大小为0.5, 那么第二个分仓也就是0.5，得满足所有大于等于0.25 小于0.75的速度序列术语第二个分仓</li>
<li>结果发现速度分仓超过25仓之后，对功率曲线计算结果基本上和线性插值类似。</li>
</ol>
<h4 id="悟空-条件">悟空[条件]</h4>
<p>注意判断中大于号和小于号都不能写错，涉及到判断、抉择、条件、空的时候一定得注意
思考对，曾经我就犯过错误!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span>(vel<span style="color:#f92672">&gt;=</span>(velocityZones[i]<span style="color:#f92672">-</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>)  <span style="color:#f92672">and</span>
        vel<span style="color:#f92672">&lt;</span>(velocityZones[i]<span style="color:#f92672">+</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>) ):</code></pre></div>
<h4 id="手算两条功率的k值">手算两条功率的k值</h4>
<p>实际功率曲线[一般是scada的风速和功率的散点图]和设计功率曲线之比如果达到1，也就是k值，那么认为是最好的，如果大点也可以，但是最好不要少于，为了计算这个k值，简单编写了下面代码</p>
<p>核心的地方在于比较提取的过程，即</p>
<ol>
<li>scada的风速-功率关系散点图</li>
<li>设计功率曲线</li>
</ol>
<!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> vel <span style="color:#f92672">in</span> range(nac<span style="color:#f92672">.</span>__len__()):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(zones):
        <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0</span><span style="color:#f92672">==</span>j <span style="color:#f92672">and</span> nac[vel]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> nac[vel] <span style="color:#f92672">&lt;</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>):
            counts[j]<span style="color:#f92672">=</span>counts[j]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
            velocitySum[j]<span style="color:#f92672">=</span>velocitySum[j]<span style="color:#f92672">+</span>nac[vel]
            powerSum[j]<span style="color:#f92672">=</span>powerSum[j]<span style="color:#f92672">+</span>power[vel]
            <span style="color:#66d9ef">break</span>
        <span style="color:#66d9ef">elif</span>(nac[vel]<span style="color:#f92672">&gt;=</span>(velocityZones[j]<span style="color:#f92672">-</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>)  <span style="color:#f92672">and</span>
            nac[vel]<span style="color:#f92672">&lt;</span>(velocityZones[j]<span style="color:#f92672">+</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>)):
            counts[j]<span style="color:#f92672">=</span>counts[j]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
            velocitySum[j]<span style="color:#f92672">=</span>velocitySum[j]<span style="color:#f92672">+</span>nac[vel]
            powerSum[j]<span style="color:#f92672">=</span>powerSum[j]<span style="color:#f92672">+</span>power[vel]
            <span style="color:#66d9ef">break</span></code></pre></div>
<p>全部代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np

<span style="color:#75715e">### 规定风速范围从0-25 不能少于25</span>
powerlaw<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\my89_12.csv&#39;</span>)

cpVs <span style="color:#f92672">=</span> powerlaw<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">0</span>]
cpPs <span style="color:#f92672">=</span> powerlaw<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">1</span>]
<span style="color:#75715e">#velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\nacWindsim2.csv&#39;)</span>
<span style="color:#75715e">#velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\lidar.csv&#39;)</span>
<span style="color:#75715e"># velocitySet=pd.read_csv(r&#39;C:\Users\yezhaoliang\Desktop\nac1.csv&#39;,skiprows=1)</span>

<span style="color:#75715e"># nac1= velocitySet.iloc[:,0]</span>
<span style="color:#75715e"># nac2= velocitySet.iloc[:,1]</span>
<span style="color:#75715e"># nac4= velocitySet.iloc[:,2]</span>
<span style="color:#75715e"># nac7= velocitySet.iloc[:,3]</span>
<span style="color:#75715e"># nac8= velocitySet.iloc[:,4]</span>
<span style="color:#75715e"># nac12= velocitySet.iloc[:,5]</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">find</span>(vel, cpVs):
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> cpV <span style="color:#f92672">in</span> cpVs:
        <span style="color:#66d9ef">if</span>(cpV <span style="color:#f92672">&gt;</span> vel):
            <span style="color:#66d9ef">return</span> count
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getMean</span>(cpVs,cpPs,vel):
    <span style="color:#66d9ef">if</span>(vel<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">2</span>):
        rePower<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">return</span> rePower
    index <span style="color:#f92672">=</span> find(vel, cpVs)
    v1<span style="color:#f92672">=</span> cpVs[index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    v2<span style="color:#f92672">=</span> cpVs[index]
    p1<span style="color:#f92672">=</span> cpPs[index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    p2<span style="color:#f92672">=</span> cpPs[index]
    rePower <span style="color:#f92672">=</span> p1<span style="color:#f92672">+</span>(p2<span style="color:#f92672">-</span>p1)<span style="color:#f92672">/</span>(v2<span style="color:#f92672">-</span>v1)<span style="color:#f92672">*</span>(vel<span style="color:#f92672">-</span>v1)
    <span style="color:#66d9ef">return</span> rePower

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">modify</span>(vel):
    <span style="color:#66d9ef">return</span> (vel<span style="color:#f92672">+</span><span style="color:#ae81ff">0.7081</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">0.9869</span>

<span style="color:#75715e">############################################################</span>
<span style="color:#75715e">##  Velocity linear interpolation Method ####################################</span>
<span style="color:#75715e">############################################################</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getPower</span>(nac,i):
    calPower<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    calVel<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> vel <span style="color:#f92672">in</span> nac:
        calPower[count]<span style="color:#f92672">=</span>getMean(cpVs,cpPs,modify(vel))
        <span style="color:#75715e">#calPower[count]=getMean(cpVs,cpPs,vel)</span>
        calVel[count]<span style="color:#f92672">=</span>vel
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    calPowerSeries<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([calVel,calPower])<span style="color:#f92672">.</span>T
    calPowerSeries<span style="color:#f92672">.</span>to_csv(str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-power.csv&#34;</span>)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>sum(calPower)<span style="color:#f92672">/</span><span style="color:#ae81ff">6000</span>
<span style="color:#75715e">############################################################</span>
<span style="color:#75715e">##  Velocity Bin Method ####################################</span>
<span style="color:#75715e">############################################################</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">powerLawIntoZones</span>(zones):
    velocityZones<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">25</span>,zones)
    powerZones<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(velocityZones<span style="color:#f92672">.</span>__len__())
    velocityBinMag<span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span><span style="color:#f92672">/</span>zones
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(zones):
        velocityZones[i]<span style="color:#f92672">=</span>i<span style="color:#f92672">*</span>velocityBinMag
        powerZones[i]<span style="color:#f92672">=</span>getMean(cpVs,cpPs,i<span style="color:#f92672">*</span>velocityBinMag)
    <span style="color:#66d9ef">return</span> velocityZones,powerZones

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">velocitySeriesSplitIntoZones</span>(nac,power,zones<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>):
    [velocityZones,powerZones]<span style="color:#f92672">=</span>powerLawIntoZones(zones)
    velocityMagnitude<span style="color:#f92672">=</span><span style="color:#ae81ff">25.0</span><span style="color:#f92672">/</span>zones
    counts<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    probability<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    velocitySum<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    velocityMean<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    powerSum<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    powerMean<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    powerTheory<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)

    AEPActual<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    AEPTheory<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(zones)
    <span style="color:#66d9ef">for</span> vel <span style="color:#f92672">in</span> range(nac<span style="color:#f92672">.</span>__len__()):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(zones):
            <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0</span><span style="color:#f92672">==</span>j <span style="color:#f92672">and</span> nac[vel]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> nac[vel] <span style="color:#f92672">&lt;</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>):
                counts[j]<span style="color:#f92672">=</span>counts[j]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
                velocitySum[j]<span style="color:#f92672">=</span>velocitySum[j]<span style="color:#f92672">+</span>nac[vel]
                powerSum[j]<span style="color:#f92672">=</span>powerSum[j]<span style="color:#f92672">+</span>power[vel]
                <span style="color:#66d9ef">break</span>
            <span style="color:#66d9ef">elif</span>(nac[vel]<span style="color:#f92672">&gt;=</span>(velocityZones[j]<span style="color:#f92672">-</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>)  <span style="color:#f92672">and</span>
                 nac[vel]<span style="color:#f92672">&lt;</span>(velocityZones[j]<span style="color:#f92672">+</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>)):
                counts[j]<span style="color:#f92672">=</span>counts[j]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
                velocitySum[j]<span style="color:#f92672">=</span>velocitySum[j]<span style="color:#f92672">+</span>nac[vel]
                powerSum[j]<span style="color:#f92672">=</span>powerSum[j]<span style="color:#f92672">+</span>power[vel]
                <span style="color:#66d9ef">break</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(counts<span style="color:#f92672">.</span>__len__()):
        <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0</span><span style="color:#f92672">==</span>counts[i]):
            <span style="color:#66d9ef">continue</span>
        <span style="color:#66d9ef">else</span>:
            probability[i]<span style="color:#f92672">=</span>counts[i]<span style="color:#f92672">/</span>nac<span style="color:#f92672">.</span>__len__()
            velocityMean[i]<span style="color:#f92672">=</span>velocitySum[i]<span style="color:#f92672">/</span>counts[i]
            powerMean[i]<span style="color:#f92672">=</span>powerSum[i]<span style="color:#f92672">/</span>counts[i]
            powerTheory[i]<span style="color:#f92672">=</span>getMean(cpVs,cpPs,velocityMean[i])
            AEPActual[i]<span style="color:#f92672">=</span>probability[i]<span style="color:#f92672">*</span>powerMean[i]<span style="color:#f92672">*</span><span style="color:#ae81ff">8760</span>
            AEPTheory[i]<span style="color:#f92672">=</span>probability[i]<span style="color:#f92672">*</span>powerTheory[i]<span style="color:#f92672">*</span><span style="color:#ae81ff">8760</span>


    k<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>sum(AEPActual)<span style="color:#f92672">/</span>np<span style="color:#f92672">.</span>sum(AEPTheory)

    <span style="color:#66d9ef">return</span> probability,velocityMean,powerMean,k




<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">whichZones</span>(vel,velocityZones,powerZones,zones):
    velocityMagnitude<span style="color:#f92672">=</span><span style="color:#ae81ff">25.0</span><span style="color:#f92672">/</span>zones
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(zones):
        <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0</span><span style="color:#f92672">==</span>i):
            <span style="color:#66d9ef">if</span>(vel<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> vel <span style="color:#f92672">&lt;</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>):
                power<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">if</span>(vel<span style="color:#f92672">&gt;=</span>(velocityZones[i]<span style="color:#f92672">-</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>)  <span style="color:#f92672">and</span>
                    vel<span style="color:#f92672">&lt;</span>(velocityZones[i]<span style="color:#f92672">+</span>velocityMagnitude<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>) ):
                power <span style="color:#f92672">=</span> powerZones[i]
    <span style="color:#66d9ef">return</span> power

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getPowerVelocityBin</span>(nac,i,zones<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>):
    calPower<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    calVel<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(len(nac),dtype<span style="color:#f92672">=</span>float)
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    [velocityZones,powerZones]<span style="color:#f92672">=</span>powerLawIntoZones(zones)
    cps<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([velocityZones,powerZones])<span style="color:#f92672">.</span>T
    cps<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;powerVelocityBin</span><span style="color:#e6db74">{</span>zones<span style="color:#e6db74">}</span><span style="color:#e6db74">.xlsx&#34;</span>)
    <span style="color:#66d9ef">for</span> vel <span style="color:#f92672">in</span> nac:
        <span style="color:#75715e">#calPower[count]=getMean(cpVs,cpPs,vel)</span>
        calVel[count]<span style="color:#f92672">=</span>vel
        calPower[count]<span style="color:#f92672">=</span>whichZones(modify(vel),velocityZones,powerZones,zones)
        count<span style="color:#f92672">=</span>count<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    calPowerSeries<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([calVel,calPower])<span style="color:#f92672">.</span>T
    calPowerSeries<span style="color:#f92672">.</span>to_csv(str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-powerBin.csv&#34;</span>)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>sum(calPower)<span style="color:#f92672">/</span><span style="color:#ae81ff">6000</span>
<span style="color:#75715e"># nac8 = velocitySet.iloc[:, 0]</span>
<span style="color:#75715e"># power1 = getPower(nac8,0)</span>
<span style="color:#75715e"># print(power1)</span>
velocitySet<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\nacVelocity.csv&#39;</span>,skiprows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
velocityPowerSeries<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\yezhaoliang\Desktop\vp.csv&#39;</span>)

kvalues<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(<span style="color:#ae81ff">10</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>):
    <span style="color:#75715e"># nac8 = velocitySet.iloc[:, i]</span>
    nac8 <span style="color:#f92672">=</span> velocityPowerSeries<span style="color:#f92672">.</span>iloc[:, i]
    power8 <span style="color:#f92672">=</span> velocityPowerSeries<span style="color:#f92672">.</span>iloc[:, i<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>]
    [probability,velocitySet,PowerSet,k] <span style="color:#f92672">=</span> velocitySeriesSplitIntoZones(nac8,power8,<span style="color:#ae81ff">50</span>)
    kvalues[i] <span style="color:#f92672">=</span> k
    print(np<span style="color:#f92672">.</span>sum(probability))
    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;k value is </span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
    <span style="color:#75715e">#power1 = getPower(nac8,i)</span>
<span style="color:#75715e">#    power1 = getPowerVelocityBin(nac8,i,125)</span>
<span style="color:#75715e">#    print(power1)</span>
kset<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Series(kvalues)
kset<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#34;kvalues.csv&#34;</span>)</code></pre></div>
<h3 id="语言的魅力"><span class="org-todo todo TODO">TODO</span> 语言的魅力</h3>
<p><span class="timestamp-wrapper"><span class="timestamp">[2019-11-24 周日 10:53]</span></span></p>
<p><a href="https://wenku.baidu.com/view/eb9f528f6ad97f192279168884868762cbaebb7b.html" target="_blank" rel="noopener">何振梁</a>(2001年夏季奥运会):
不论你们今天做出什么决定，都将载入史册。但是，只有一种决定，可以创造历史</p>
<p>你们今天的决定可以通过体育运动促使世界和中国拥抱在一起，从而为全人类造福。</p>
<p>你们所传达的信息也许将意味着一个全球团结新时代的开始。</p>
<p>如果你们把举办2008年奥运会的荣誉授予北京，亲爱的同事们，我可以向你们保证
7年之后，北京将让你们为今天的决定而自豪。</p>
<p>一定要把语言的感情表现出来！由内置外。</p>
<p>这就是振作精神的振，有一股精气神</p>
<p>何老说，不同种族、不同肤色、不同语言、不同文化的人们，完全可以采取一种美好的方式和谐共处，这是奥林匹克文化的内涵，也是他终其一生为之奋斗的动力</p>
<p>不论我今天做出什么决定，都将被历史所遗忘。但是，只有一种决定，可以完成项目。我今天的决定可以通过我的辛勤劳动促使项目验收结果推进一步，从而推进部门的项目验收。</p>
<h3 id="python绕点旋转"><span class="org-todo done DONE">DONE</span> python绕点旋转</h3>
<p><a href="https://blog.csdn.net/can3981132/article/details/52518833" target="_blank" rel="noopener">数学理论公式推导</a>,基于相同的半径，然后旋转，利用三角函数的拆分方法得到旋转后的坐标</p>
<p>具体实现，</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#75715e"># 绕pointx,pointy逆时针旋转</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Nrotate</span>(angle,valuex,valuey,pointx,pointy):
  valuex <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(valuex)
  valuey <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(valuey)
  nRotatex <span style="color:#f92672">=</span> (valuex<span style="color:#f92672">-</span>pointx)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>cos(angle) <span style="color:#f92672">-</span> (valuey<span style="color:#f92672">-</span>pointy)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>sin(angle) <span style="color:#f92672">+</span> pointx
  nRotatey <span style="color:#f92672">=</span> (valuex<span style="color:#f92672">-</span>pointx)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>sin(angle) <span style="color:#f92672">+</span> (valuey<span style="color:#f92672">-</span>pointy)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>cos(angle) <span style="color:#f92672">+</span> pointy
  <span style="color:#66d9ef">return</span> nRotatex, nRotatey
<span style="color:#75715e"># 绕pointx,pointy顺时针旋转</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Srotate</span>(angle,valuex,valuey,pointx,pointy):
  valuex <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(valuex)
  valuey <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(valuey)
  sRotatex <span style="color:#f92672">=</span> (valuex<span style="color:#f92672">-</span>pointx)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>cos(angle) <span style="color:#f92672">+</span> (valuey<span style="color:#f92672">-</span>pointy)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>sin(angle) <span style="color:#f92672">+</span> pointx
  sRotatey <span style="color:#f92672">=</span> (valuey<span style="color:#f92672">-</span>pointy)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>cos(angle) <span style="color:#f92672">-</span> (valuex<span style="color:#f92672">-</span>pointx)<span style="color:#f92672">*</span>math<span style="color:#f92672">.</span>sin(angle) <span style="color:#f92672">+</span> pointy
  <span style="color:#66d9ef">return</span> sRotatex,sRotatey

<span style="color:#75715e">## 绕点坐标</span>
pointx <span style="color:#f92672">=</span> <span style="color:#ae81ff">7.352847966</span>
pointy <span style="color:#f92672">=</span> <span style="color:#ae81ff">210</span>

<span style="color:#75715e">## 旋转前坐标</span>
targetX<span style="color:#f92672">=</span><span style="color:#ae81ff">6.074863636</span>
targetY<span style="color:#f92672">=</span><span style="color:#ae81ff">40</span>

<span style="color:#75715e">## 旋转后坐标   0.5代表°， 注意如果x和y差距较大，则角度相应较小些。</span>
sPointx ,sPointy <span style="color:#f92672">=</span> Srotate(math<span style="color:#f92672">.</span>radians(<span style="color:#ae81ff">0.5</span>),targetX,targetY,pointx,pointy)
print(sPointx,sPointy)
plt<span style="color:#f92672">.</span>plot([pointx,targetX],[pointy,targetY])
plt<span style="color:#f92672">.</span>plot([pointx,sPointx],[pointy,sPointy])
<span style="color:#75715e"># plt.xlim(-3.,3.)</span>
<span style="color:#75715e"># plt.ylim(-3.,3.)</span>
<span style="color:#75715e"># plt.xticks(np.arange(-3.,3.,1))</span>
<span style="color:#75715e"># plt.yticks(np.arange(-3.,3.,1))</span>
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<h3 id="python提取时间序列白天和黑夜的时间段"><span class="org-todo done DONE">DONE</span> python提取时间序列白天和黑夜的时间段</h3>
<p><a href="https://jueqingsizhe66.github.io/post/%25E7%258E%25A9%25E8%25BD%25ACpython-datetime/" target="_blank" rel="noopener">玩转Python datetime</a>已针对时间序列进行了相关处理，得到了满足AIWIND计算要求的测风塔时间序列</p>
<p><a href="https://www.semanticscholar.org/paper/Atmospheric-boundary-layer-stability-and-its-to-Breedt/9bfd308031989e2a7f31dc54779182a4f8735980" target="_blank" rel="noopener">Atmospheric Boundary Layer Stability</a>一文我们知道地表边界层在昼夜存在不同；白天
由于地表被加热，边界层较薄，反之亦然；为此需要对雷达的测量结果提取昼夜的分布信息</p>
<p><a href="https://www.jianshu.com/p/3d1d648406f3" target="_blank" rel="noopener">Astral库计算日出日落时间</a>一文解决获取当天日出日落时间，进一步可参考<a href="https://astral.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener">Astral手册</a></p>
<h4 id="原始数据格式">原始数据格式</h4>
<p><a href="/images/aiwind/dataFormatDayNight.png">原始数据格式</a>：第一列为时间序列，2,3列分别为雷达40m处的风向风速，依次类推</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">  <span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
  <span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
  <span style="color:#f92672">import</span> datetime
  <span style="color:#f92672">import</span> astral

  <span style="color:#75715e">##https://www.jianshu.com/p/3d1d648406f3</span>
  longititude<span style="color:#f92672">=</span><span style="color:#ae81ff">21.45</span> <span style="color:#75715e">## 城市经度信息</span>
  latitude<span style="color:#f92672">=</span><span style="color:#ae81ff">112.15</span> <span style="color:#75715e">## 城市纬度度信息</span>
  location_yangjiang <span style="color:#f92672">=</span> astral<span style="color:#f92672">.</span>Location((<span style="color:#e6db74">&#39;Yangjiang&#39;</span>, <span style="color:#e6db74">&#39;China&#39;</span>,<span style="color:#ae81ff">21.45</span> ,<span style="color:#ae81ff">112.15</span> , <span style="color:#e6db74">&#39;Asia/Shanghai&#39;</span>, <span style="color:#ae81ff">0</span>))
  <span style="color:#75715e">#location_yangjiang = astral.Location((&#39;YanDun&#39;, &#39;China&#39;,42.3369 ,94.382 , &#39;Asia/Shanghai&#39;, 0))</span>
  <span style="color:#75715e">#location_yangjiang = astral.Location((&#39;huailai&#39;, &#39;China&#39;,42.242 ,115.35 , &#39;Asia/Shanghai&#39;, 0))</span>
  <span style="color:#75715e">#time_sunrise=location_yangjiang.sunrise(date=datetime.date.today(),local=True)</span>
  time_sunrise<span style="color:#f92672">=</span>location_yangjiang<span style="color:#f92672">.</span>sunrise(date<span style="color:#f92672">=</span>datetime<span style="color:#f92672">.</span>date(<span style="color:#ae81ff">2019</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>),local<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
  time_sunrise_update<span style="color:#f92672">=</span>time_sunrise <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(hours<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) <span style="color:#75715e">#提前/延后日出时间量</span>
  time_sunrise_new<span style="color:#f92672">=</span>str(time_sunrise_update)
  print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;日出时间:</span><span style="color:#e6db74">{</span>time_sunrise_new<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)

  <span style="color:#75715e">#time_sunset=location_yangjiang.sunset(date=datetime.date.today(),local=True)</span>
  time_sunset<span style="color:#f92672">=</span>location_yangjiang<span style="color:#f92672">.</span>sunset(date<span style="color:#f92672">=</span>datetime<span style="color:#f92672">.</span>date(<span style="color:#ae81ff">2019</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>),local<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)

  time_sunset_update<span style="color:#f92672">=</span>time_sunset <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(hours<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) <span style="color:#75715e">#提前/延后日落时间量</span>
  time_sunset_new<span style="color:#f92672">=</span>str(time_sunset_update)
  print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;日落时间:</span><span style="color:#e6db74">{</span>time_sunset_new<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)


  <span style="color:#75715e">#dongpingLidar=pd.read_excel(r&#34;C:\Users\yezhaoliang\Desktop\dongpingLidar67.xlsx&#34;)</span>
  dongpingLidar<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\yezhaoliang\Desktop\work\AIWind\功率曲线\手算白天黑夜\dongpingLidar14WithTime.xlsx&#34;</span>)
  positions<span style="color:#f92672">=</span>[<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">65</span>,<span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">115</span>,<span style="color:#ae81ff">140</span>,<span style="color:#ae81ff">150</span>,<span style="color:#ae81ff">160</span>,<span style="color:#ae81ff">170</span>,<span style="color:#ae81ff">180</span>,<span style="color:#ae81ff">190</span>,<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">210</span>]
  windDirection<span style="color:#f92672">=</span><span style="color:#ae81ff">180</span>
  minusPlus<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>
  velMean<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>zeros(positions<span style="color:#f92672">.</span>__len__())

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getSunriseFromDay</span>(today):
      <span style="color:#75715e">## 日出</span>
      year<span style="color:#f92672">=</span>today[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">4</span>]
      month<span style="color:#f92672">=</span>today[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">6</span>]
      day<span style="color:#f92672">=</span>today[<span style="color:#ae81ff">6</span>:<span style="color:#ae81ff">8</span>]
      time_sunrise <span style="color:#f92672">=</span> location_yangjiang<span style="color:#f92672">.</span>sunrise(date<span style="color:#f92672">=</span>datetime<span style="color:#f92672">.</span>date(int(year), int(month), int(day)), local<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
      time_sunrise_update <span style="color:#f92672">=</span> time_sunrise <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(hours<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)  <span style="color:#75715e"># 提前/延后日出时间量</span>
      time_sunrise_new <span style="color:#f92672">=</span> str(time_sunrise_update)
      <span style="color:#66d9ef">return</span> time_sunrise_new[<span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">19</span>]

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getSunsetFromDay</span>(today):
      year<span style="color:#f92672">=</span>today[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">4</span>]
      month<span style="color:#f92672">=</span>today[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">6</span>]
      day<span style="color:#f92672">=</span>today[<span style="color:#ae81ff">6</span>:<span style="color:#ae81ff">8</span>]
      <span style="color:#75715e">## 日落</span>
      time_sunset <span style="color:#f92672">=</span> location_yangjiang<span style="color:#f92672">.</span>sunset(date<span style="color:#f92672">=</span>datetime<span style="color:#f92672">.</span>date(int(year), int(month), int(day)), local<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
      time_sunset_update <span style="color:#f92672">=</span> time_sunset <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(hours<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)  <span style="color:#75715e"># 提前/延后日落时间量</span>
      time_sunset_new <span style="color:#f92672">=</span> str(time_sunset_update)
      <span style="color:#66d9ef">return</span> time_sunset_new[<span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">19</span>]


  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getDayArrayCursorByDay</span>():
      timeseries<span style="color:#f92672">=</span>dongpingLidar<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>]

      <span style="color:#75715e">## timeSeries 9-19 为小时：分钟:秒      time_sunset_new 11:19为小时:分钟:秒</span>
      <span style="color:#75715e"># for (idx, val) in enumerate(timeseries):</span>
      <span style="color:#75715e">#     time_sunrise_new,time_sunset_new=getSunriseSunsetFromDay(val)</span>
      <span style="color:#75715e">#     if(val[9:19] &gt;= time_sunrise_new[11:19] and val[9:19] &lt;= time_sunset_new[11:19]]):</span>
      <span style="color:#75715e">#         dayIndex</span>

      <span style="color:#75715e"># dayIndex = [idx for (idx, val) in enumerate(timeseries) if val[9:19] &gt;= time_sunrise_new[11:19] and val[9:19] &lt;=time_sunset_new[11:19]]</span>
      <span style="color:#75715e"># nightIndex = [idx for (idx, val) in enumerate(timeseries) if val[9:19] &lt; time_sunrise_new[11:19] or val[9:19] &gt; time_sunset_new[11:19]]</span>
      dayIndex <span style="color:#f92672">=</span> [idx <span style="color:#66d9ef">for</span> (idx, val) <span style="color:#f92672">in</span> enumerate(timeseries) <span style="color:#66d9ef">if</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&gt;=</span> getSunriseFromDay(val) <span style="color:#f92672">and</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&lt;=</span>getSunsetFromDay(val)]
      nightIndex <span style="color:#f92672">=</span> [idx <span style="color:#66d9ef">for</span> (idx, val) <span style="color:#f92672">in</span> enumerate(timeseries) <span style="color:#66d9ef">if</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&lt;</span> getSunriseFromDay(val) <span style="color:#f92672">or</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&gt;</span> getSunsetFromDay(val)]
      <span style="color:#66d9ef">return</span> dayIndex,nightIndex

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getDayArrayCursor</span>():
      timeseries<span style="color:#f92672">=</span>dongpingLidar<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>]

      <span style="color:#75715e">## timeSeries 9-19 为小时：分钟:秒      time_sunset_new 11:19为小时:分钟:秒</span>
      dayIndex <span style="color:#f92672">=</span> [idx <span style="color:#66d9ef">for</span> (idx, val) <span style="color:#f92672">in</span> enumerate(timeseries) <span style="color:#66d9ef">if</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&gt;=</span> time_sunrise_new[<span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">and</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&lt;=</span>time_sunset_new[<span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">19</span>]]
      nightIndex <span style="color:#f92672">=</span> [idx <span style="color:#66d9ef">for</span> (idx, val) <span style="color:#f92672">in</span> enumerate(timeseries) <span style="color:#66d9ef">if</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&lt;</span> time_sunrise_new[<span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">or</span> val[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">19</span>] <span style="color:#f92672">&gt;</span> time_sunset_new[<span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">19</span>]]
      <span style="color:#66d9ef">return</span> dayIndex,nightIndex

<span style="color:#75715e">## 逐日跟踪日落日出</span>
  dayIndex,nightIndex<span style="color:#f92672">=</span>getDayArrayCursorByDay()

<span style="color:#75715e">## 中间日期跟踪日落日出</span>
  <span style="color:#75715e"># dayIndex,nightIndex=getDayArrayCursor()</span>
  <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(positions)):
      print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">:&#34;</span>)
      dir1 <span style="color:#f92672">=</span> dongpingLidar<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]
      vel <span style="color:#f92672">=</span> dongpingLidar<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]

      dayDir1<span style="color:#f92672">=</span>dir1[dayIndex]
      dayVel<span style="color:#f92672">=</span>vel[dayIndex]

      <span style="color:#75715e"># dayDir1=dir1[nightIndex]</span>
      <span style="color:#75715e"># dayVel=vel[nightIndex]</span>
      idx <span style="color:#f92672">=</span> [idx <span style="color:#66d9ef">for</span> (idx, val) <span style="color:#f92672">in</span> enumerate(dayDir1) <span style="color:#66d9ef">if</span> val <span style="color:#f92672">&gt;=</span> (windDirection<span style="color:#f92672">-</span>minusPlus) <span style="color:#f92672">and</span> val <span style="color:#f92672">&lt;=</span>(windDirection<span style="color:#f92672">+</span>minusPlus)]
      <span style="color:#75715e">## dir1[idx]  vel[idx]</span>
      countVel<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
      <span style="color:#66d9ef">for</span> cursor1 <span style="color:#f92672">in</span> range(len(idx)):
          cursor<span style="color:#f92672">=</span>idx[cursor1]
          countVel<span style="color:#f92672">=</span>countVel<span style="color:#f92672">+</span>dayVel<span style="color:#f92672">.</span>iloc[cursor]

      velMean[i]<span style="color:#f92672">=</span>countVel<span style="color:#f92672">/</span>len(idx)

  profiles<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame([velMean,positions])<span style="color:#f92672">.</span>T
  profiles<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#34;Lidar387Profiles14Day30.csv&#34;</span>)</code></pre></div>
<h4 id="结论">结论</h4>
<ol>
<li>1-2个月的雷达用中间日期即可，差别不大；如果全年的话，最好是跟踪每日。</li>
<li>白天的计算速度边界层较薄，夜晚较厚一些，原因是白天的地表收到加热效应。</li>
</ol>
<p>顺便提及，我喜欢用TotalCommander对文件夹和文件进行颜色控制</p>
<ol>
<li>凡是有备注的都显示粉色</li>
<li>凡是一周之内有变动的文件和文件夹都显示蓝色</li>
<li>凡是一天之内有变动的文件和文件夹都显示红色</li>
<li>凡是office文件都显示灰色</li>
</ol>
<h3 id="健身活动计划"><span class="org-todo done DONE">DONE</span> 健身活动计划</h3>
<ol>
<li>In all affairs it&rsquo;s a healthy thing now and then to hang a question mark on the things you have long taken for granted.</li>
<li>Men are born ignorant, not stupid. They are made stupid by education.</li>
<li>Do not fear to be eccentric in opinion, for every opinion now accepted was once eccentric.</li>
<li>The fundamental cause of the trouble is that in the modern world the stupid are cocksure while the intelligent are full of doubt.</li>
<li>I would never die for my beliefs because I might be wrong.</li>
<li>在所有事务中，时不时地在您早已视为理所当然的事情上打上问号是一件健康的事情。</li>
<li>人生而无知，但是并不愚蠢，是教育使人愚蠢。</li>
<li>不要为自己持独特看法而感到害怕，因为我们现在所接受的常识都曾是独特看法。</li>
<li>不用盲目地崇拜任何权威，因为你总能找到相反的权威。</li>
<li>这个世界的问题在于聪明人充满疑惑，而傻子们坚信不疑。</li>
<li>我绝不会为我的信仰而献身，因为我可能是错的。</li>
</ol>
<p><a href="https://github.com/evmn/Workouts" target="_blank" rel="noopener">健身者的建议</a></p>
<p><a href="/images/life/wise.jpg">智者的建议</a></p>
<h4 id="静坐">静坐</h4>
<p>潘石屹说：“现在社会十年的变化，比过去500年变化都大！过去听爸爸的、爷爷的没问题，现在听叔叔的、哥哥的可能都不行了。”</p>
<p>成年之后，我们每天思考的东西太多了，但是有很多问题不是我们思考就可以解决的，有时候放慢节奏，让自己静下来，或许对自己更好。</p>
<p>乔布斯、比尔盖茨、尤瓦尔·赫拉利或早或晚都开始做这件事了。如果想要看相关的书，可以参考《因是子静坐法》。我已经忘记书中讲的什么了，静坐时也没有什么宗教的神圣感，只是熄灯闭目，关注呼吸，努力不去思考任何问题，获得片刻的安宁。</p>
<p>内视！囚徒健身</p>
<p><a href="/images/life/silentsit.jpg">Silent Sit</a></p>
<h4 id="爬行">爬行</h4>
<p>现在城市的生活方式非常不利于人们的健康，人们每天运动时间相比过去急剧下降，我们亟需改变自己的健身方式。</p>
<p>走路和跑步虽然也是不错的运动方式，但是爬行也许性价比更高。通过爬行，我们全身大多数平时忽视的部位都可以锻炼到，每天爬上几百步可能比跑几千步还要累。</p>
<p>我感觉爬行可能会缓解人们腕部、颈部、肩部、腰部的不适，增强腿部及核心的力量，当然还有待长期观察。</p>
<h4 id="跑步">跑步</h4>
<p>人类天生就具有奔跑的欲望，需要做的只是将它释放出来</p>
<h4 id="立定跳远">立定跳远</h4>
<p>我认为跳远是非常实用的技能，有人会认为跑步、跳远会对膝关节造成很大的伤害，我感觉主要还是现在人们穿运动鞋导致落地方式不自然，只要养成不穿运动鞋的习惯，用脚掌前部落地，你会发现自己变得越来越年轻。</p>
<p>不论是武术、体操练习者翻跟头，还是跑酷爱好者从高空跳下，你都会发现他们是用前脚掌落地的</p>
<h4 id="节食">节食</h4>
<p>间歇性禁食可以降低心脏病、神经系统疾病和糖尿病的风险，减少发炎、氧化压力和高血压等症状，最重要的是可以预防癌症，延长寿命，平衡胆固醇水平。</p>
<h4 id="侧睡">侧睡</h4>
<p>侧睡可能有助于提高睡眠质量，预防老年痴呆，防止打呼噜。但我认为人们还是应该根据自己的情况选择适合自己的姿势，无论如何，尽可能保持充足的睡眠吧，善待自己</p>
<p>Reduce stress and improve your mood</p>
<h3 id="相互资源竞争带来恶性循环"><span class="org-todo done DONE">DONE</span> 相互资源竞争带来恶性循环</h3>
<p><span class="timestamp-wrapper"><span class="timestamp">[2021-10-07 周四 20:06]</span></span></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestLOck</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        Makeup g1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Makeup<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;灰姑娘&#34;</span><span style="color:#f92672">);</span>
        Makeup g2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Makeup<span style="color:#f92672">(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;白雪公主&#34;</span><span style="color:#f92672">);</span>

        g1<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
        g2<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">//口红
</span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Lipstick</span><span style="color:#f92672">{</span>

<span style="color:#f92672">}</span>

<span style="color:#75715e">// 镜子
</span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mirror</span><span style="color:#f92672">{</span>

<span style="color:#f92672">}</span>


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Makeup</span> <span style="color:#66d9ef">extends</span> Thread<span style="color:#f92672">{</span>

    <span style="color:#75715e">//需要的资源只有一份
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">static</span> Lipstick lip <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Lipstick<span style="color:#f92672">();</span>
    <span style="color:#66d9ef">static</span> Mirror mir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Mirror<span style="color:#f92672">();</span>

    <span style="color:#75715e">//
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> choice <span style="color:#f92672">;</span> <span style="color:#75715e">//选择
</span><span style="color:#75715e"></span>    String girlName <span style="color:#f92672">;</span> <span style="color:#75715e">//使用化妆品的人
</span><span style="color:#75715e"></span>
    Makeup<span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> choice<span style="color:#f92672">,</span> String girlName<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">choice</span> <span style="color:#f92672">=</span> choice<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">girlName</span> <span style="color:#f92672">=</span>girlName<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        makeUp<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">//化妆，互相持有对方的锁，就是需要拿到对方的资源
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">makeUp</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>choice<span style="color:#f92672">==</span>0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">synchronized</span><span style="color:#f92672">(</span>lip<span style="color:#f92672">){</span><span style="color:#75715e">//获得了口红的锁
</span><span style="color:#75715e"></span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">girlName</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;获得口红的锁&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                    Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>1000<span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
                <span style="color:#f92672">}</span>
                <span style="color:#75715e">// 1s钟想获得镜子
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">synchronized</span><span style="color:#f92672">(</span>mir<span style="color:#f92672">){</span>
                    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">girlName</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;获得镜子的锁&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
            <span style="color:#75715e">//死锁了，相互抱住对方的锁
</span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span><span style="color:#f92672">{</span>

            <span style="color:#66d9ef">synchronized</span><span style="color:#f92672">(</span>mir<span style="color:#f92672">){</span> <span style="color:#75715e">//获得了镜子的锁
</span><span style="color:#75715e"></span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">girlName</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;获得镜子的锁&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                    Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>2000<span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
                <span style="color:#f92672">}</span>
                <span style="color:#75715e">// 2s钟想获得镜子
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">synchronized</span><span style="color:#f92672">(</span>lip<span style="color:#f92672">){</span>
                    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">girlName</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;获得口红的锁&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

    </div>
 <div class="nav-links" style="padding:10;">
        
        <div align="left">
        <a href="https://jueqingsizhe66.github.io/post/%E7%9B%B8%E4%BA%92%E8%B5%84%E6%BA%90%E7%AB%9E%E4%BA%89%E5%B8%A6%E6%9D%A5%E6%81%B6%E6%80%A7%E5%BE%AA%E7%8E%AF/"><span class="arrow">←</span> <strong>上一篇:相互资源竞争带来恶性循环</strong></a>
        </div>
        
        
      </div>
    








<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jueqingsizhe66.github.io/post/blog/&amp;text=" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jueqingsizhe66.github.io/post/blog/&amp;t=" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=&amp;body=https://jueqingsizhe66.github.io/post/blog/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://jueqingsizhe66.github.io/post/blog/&amp;title=" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=%20https://jueqingsizhe66.github.io/post/blog/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://jueqingsizhe66.github.io/post/blog/&amp;title=" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://jueqingsizhe66.github.io/"><img class="avatar mr-3 avatar-circle" src="/author/%E4%BB%A4%E7%8B%90%E5%86%B2/avatar_huc99f1f2e739130747140db298bdd1890_46492_270x270_fill_q90_lanczos_center.jpg" alt="令狐冲"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jueqingsizhe66.github.io/">令狐冲</a></h5>
      <h6 class="card-subtitle">Engineer of offshore wind turbine technique research</h6>
      <p class="card-text">My research interests include distributed energy, wind turbine power generation technique , Computational fluid dynamic and programmable matter.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=7VyEMyQAAAAJ&amp;hl=zh-CN" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>














  
  

         <span id="busuanzi_container_site_pv"> 
             本站访问量：<span id="busuanzi_value_site_pv"></span>次 
         </span> 
         &nbsp; 
   </div> 


  </div>

</article>
<script src="https://utteranc.es/client.js"
        repo="jueqingsizhe66/jueqingsizhe66.github.io"
        issue-term="pathname"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
  

  <p class="powered-by">
    ©2021 &middot; 

    ^-^ LingHuChong ^-^ Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/go.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/vim.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/matlab.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/sql.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/c.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/scheme.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/racket.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/perl.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/awk.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/clojure.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.516d1df876a80aa80a06ab72f875bdd4.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
