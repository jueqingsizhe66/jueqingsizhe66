<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ye Zhaoliang">

  
  
  
    
  
  <meta name="description" content="The Little Scheme(TLS) 提出了rember,multirember,multirember*以及multirember&amp;Col collector等系列">

  
  <link rel="alternate" hreflang="en-us" href="https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.e8d4d5fd376e67b34452ebe1cae16341.css">

  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jueqingsizhe66">
  <meta property="twitter:creator" content="@jueqingsizhe66">
  
  <meta property="og:site_name" content="简约派">
  <meta property="og:url" content="https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/">
  <meta property="og:title" content="From Little Scheme to Season Scheme | 简约派">
  <meta property="og:description" content="The Little Scheme(TLS) 提出了rember,multirember,multirember*以及multirember&amp;Col collector等系列"><meta property="og:image" content="https://jueqingsizhe66.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://jueqingsizhe66.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2017-08-11T20:13:42&#43;08:00">
    
    <meta property="article:modified_time" content="2017-08-11T20:13:42&#43;08:00">
  

  



  


  


  





  <title>From Little Scheme to Season Scheme | 简约派</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">简约派</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>概要</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>博文</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>项目</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>课程</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/categories/"><span>分类</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/archives"><span>归档</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>标签</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  








  
 <script async src="//cdn.busuanzi.ibruce.info/cdn/busuanzi/2.3/busuanzi.pure.mini.js"></script> 
 <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> 
 <script> 
     $(document).ready(function() { 
         var int = setInterval(fixCount, 100); 
         var busuanziSiteOffset =  100000  
         function fixCount() { 
             if ($("#busuanzi_container_site_pv").css("display") != "none") { 
                 clearInterval(int); 
                 $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + busuanziSiteOffset); 
             } 
         } 
     }); 
 </script> 
  






  

  
  
  
<div class="article-container pt-3">
  <h1>From Little Scheme to Season Scheme</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Aug 11, 2017
  </span>

  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/programme/">programme</a></span>

  
</div>

    














  
</div>





<span class="article-metadata" >Reading time: 20 minutes and    40 seconds with 4549 words. 本文总阅读量<span id="busuanzi_value_page_pv"></span>次 </span>
    <aside>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#11-rember">1.1 rember</a></li>
    <li><a href="#12-multirember">1.2 multirember</a></li>
    <li><a href="#13-multirember">1.3 multirember*</a></li>
    <li><a href="#14-multiremberstar-and-collector">1.4 multiremberstar and collector</a></li>
  </ul>

  <ul>
    <li><a href="#22-rember-letrec">2.2 rember-letrec</a></li>
    <li><a href="#23-rember-letcc">2.3 rember-letcc</a></li>
    <li><a href="#24-remberstar">2.4 remberstar</a></li>
  </ul>
</nav>
    </aside>
  <div class="article-container">


    <div class="article-style">
      <p>The Little Scheme(TLS) 提出了<code>rember</code>,<code>multirember</code>,<code>multirember*</code>以及<code>multirember&amp;Col collector</code>等系列函数的定义，而在The Season Scheme(TSS) 进一步改进了<code>rember</code>系列函数， 使用<code>let</code>、<code>letrec</code>、<code>letcc</code>进行改写，并结合<code>leftmost</code>和<code>deep</code>函数的想法，又提出了<code>rember</code>的函数，该函数表示删除最左边的函数。在此过程中，剖析每一个简单的函数(并由此带来智趣)， 并进行改进，升级，提炼，从中可以体味到<a href="http://blog.sina.com.cn/s/blog_bffd70da0101f4sl.html"> 华罗庚老先生 </a>说的”书越读越薄，并积厚薄书”的感觉,从繁杂中感受直观的本质， 借以理解事物，从另外一个角度看待事物。</p>
<p>一、The Little Scheme
rember
multirember
multiremberStar
multiremberStarCol
二、The Season Scheme
rember-let
rember-letrec
rember-letcc
rember star
depthStar improvement</p>
<h1 id="一the-little-scheme">一、The Little Scheme</h1>
<p>scheme的核心数据结构是List，通过list进行算法的演算，而rember是其中的一种算法，用于去除其中的一个元素。 并在rember的同级函数中，也定义了subst，member，insert left, insert right等。在TLS书中也提出了这些函数的相同之处并最终使用insert-g来统一各个函数，这是不错的思想。</p>
<h2 id="11-rember">1.1 rember</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> rember-f
  (<span style="color:#66d9ef">lambda</span> (test?)
          (<span style="color:#66d9ef">lambda</span> (a lat)
            (<span style="color:#66d9ef">cond</span>
              ((null? lat) <span style="color:#f92672">&#39;</span>())
              ((test? a (car lat))
               (cdr lat))
              (<span style="color:#66d9ef">else</span>
               (cons (car lat)
                     ((multirember-f test?) a (cdr lat))))))))

</code></pre></div><p>Another related procedures:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> insertL
  (<span style="color:#66d9ef">lambda</span> (<span style="color:#66d9ef">new</span> old lat)
    (<span style="color:#66d9ef">cond</span>
      ((null? lat)
       <span style="color:#f92672">&#39;</span>())
      ((eq? (car lat) old)
       (cons <span style="color:#66d9ef">new</span> (cons old (cdr lat))))
      (<span style="color:#66d9ef">else</span>
       (cons <span style="color:#66d9ef">new</span> (insertL <span style="color:#66d9ef">new</span> old (cdr lat)))))))


(<span style="color:#66d9ef">define</span> insertLR
  (<span style="color:#66d9ef">lambda</span> (<span style="color:#66d9ef">new</span> oldL oldR lat)
    (<span style="color:#66d9ef">cond</span>
      ((null? lat)
       <span style="color:#f92672">&#39;</span>())
      ((eq? (car lat) oldL)
       (cons <span style="color:#66d9ef">new</span> (cons oldL (cdr lat))))
      ((eq? (car lat) oldR)
       (cons oldR (cons <span style="color:#66d9ef">new</span> (cdr lat))))
      (<span style="color:#66d9ef">else</span>
       (cons (car lat) (insertLR <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)))))))

</code></pre></div><p>进一步可以参考 <a href="http://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/"> TLS and TSS Backup </a></p>
<p>为了更进一步删除一个列表(未嵌套多个list)时候所有的元素(定义为lat version)</p>
<h2 id="12-multirember">1.2 multirember</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> multirember-f
  (<span style="color:#66d9ef">lambda</span> (test?)
          (<span style="color:#66d9ef">lambda</span> (a lat)
            (<span style="color:#66d9ef">cond</span>
              ((null? lat) <span style="color:#f92672">&#39;</span>())
              ((test? a (car lat))
               ((multirember-f test?) a (cdr lat)))
              (<span style="color:#66d9ef">else</span>
               (cons (car lat)
                     ((multirember-f test?) a (cdr lat))))))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Another related procedures:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> multiinsertLR
  (<span style="color:#66d9ef">lambda</span> (<span style="color:#66d9ef">new</span> oldL oldR lat)
    (<span style="color:#66d9ef">cond</span>
      ((null? lat)
       <span style="color:#f92672">&#39;</span>())
      ((eq? (car lat) oldL)
       (cons <span style="color:#66d9ef">new</span> (cons oldL (multiinsertLR <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)))))
      ((eq? (car lat) oldR)
       (cons oldR (cons <span style="color:#66d9ef">new</span> (multiinsertLR <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)))))
      (<span style="color:#66d9ef">else</span>
       (cons (car lat) (multiinsertLR <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)))))))


<span style="color:#75715e">;(insertL &#39;a &#39;b &#39;(a b c (a b c)))</span>
<span style="color:#75715e">;&#39;(a a b c (a b c))</span>

<span style="color:#75715e">;(insertLR &#39;water &#39;a &#39;b &#39;(a bc b c d (a c b)))</span>
<span style="color:#75715e">;&#39;(water a bc b c d (a c b))</span>

 (multiinsertLR <span style="color:#f92672">&#39;</span><span style="color:#e6db74">water</span> <span style="color:#f92672">&#39;</span><span style="color:#e6db74">a</span> <span style="color:#f92672">&#39;</span><span style="color:#e6db74">b</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span> <span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span>)))
<span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">water</span> <span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">water</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span> <span style="color:#e6db74">water</span> <span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">water</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span>))
&gt; (insertLR <span style="color:#f92672">&#39;</span><span style="color:#e6db74">water</span> <span style="color:#f92672">&#39;</span><span style="color:#e6db74">a</span> <span style="color:#f92672">&#39;</span><span style="color:#e6db74">b</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span> <span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span>)))
<span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">water</span> <span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span> <span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span>))

</code></pre></div><h2 id="13-multirember">1.3 multirember*</h2>
<pre><code class="language-rakcet" data-lang="rakcet">(define multiinsertLR*
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (cond
      ((null? lat)
       '())
      ((atom? (car lat))
       (cond 
         ((eq? (car lat) oldL)
          (cons new (cons oldL (multiinsertLR* new oldL oldR (cdr lat)))))
         ((eq? (car lat) oldR)
          (cons oldR (cons new (multiinsertLR* new oldL oldR (cdr lat)))))
         (else
          (cons (car lat) (multiinsertLR* new oldL oldR (cdr lat))))))
      (else
       (cons (multiinsertLR* new oldL oldR (car lat))
             (multiinsertLR* new oldL oldR (cdr lat)))))))


(define evens-only*
  (lambda (l)

    (define atom?
      (lambda (x)
        (and (not (pair? x)) (not (null? x)))))
    (cond
      ((null? l) '())
      ((atom? (car l))
       (cond
         ((even? (car l))
          (cons (car l) (evens-only* (cdr l))))
         (else (evens-only* (cdr l)))))
      (else
       (cons (evens-only* (car l))
             (evens-only* (cdr l)))))))


&gt; (multiinsertLR* 'water 'a 'b '(a b c d a b (a b c d)))
'(water a b water c d water a b water (water a b water c d))
&gt; (multiinsertLR 'water 'a 'b '(a b c d a b (a b c d)))
'(water a b water c d water a b water (a b c d))
</code></pre><p>Another related procedures:</p>
<pre><code class="language-rakect" data-lang="rakect">(define multiinsertLR*let
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (cond
      ((null? lat)
       '())
      ((atom? (car lat))
        (let ((rest (multiinsertLR* new oldL oldR (cdr lat))))
          (cond 
            ((eq? (car lat) oldL)
             (cons new (cons oldL rest)))
            ((eq? (car lat) oldR)
             (cons oldR (cons new rest)))
            (else
             (cons (car lat) rest)))))
      (else
       (let ((first (multiinsertLR* new oldL oldR (car lat)))
             (rest (multiinsertLR* new oldL oldR (cdr lat))))
       (cons first rest))))))



(define multiinsertLR*letrec
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (define mul-help
      (lambda (lat)
        (cond
          ((null? lat)
           '())
          ((atom? (car lat))
           (cond 
             ((eq? (car lat) oldL)
              (cons new (cons oldL (mul-help  (cdr lat)))))
             ((eq? (car lat) oldR)
              (cons oldR (cons new (mul-help  (cdr lat)))))
             (else
              (cons (car lat) (mul-help  (cdr lat))))))
          (else
           (cons (mul-help  (car lat))
                 (mul-help  (cdr lat)))))))
    (mul-help lat)))

&gt; (multiinsertLR*let 'water 'a 'b '(a b c d a b (a b c d)))
'(water a b water c d water a b water (water a b water c d))
&gt; (multiinsertLR* 'water 'a 'b '(a b c d a b (a b c d)))
'(water a b water c d water a b water (water a b water c d))
&gt; (multiinsertLR 'water 'a 'b '(a b c d a b (a b c d)))
'(water a b water c d water a b water (a b c d))

(multiinsertLR*letrec 'water 'a 'b '(a b c d a b (a b c d)))
'(water a b water c d water a b water (water a b water c d))



(define multiinsertLR*letreclet
  (lambda (new oldL oldR lat)
    (define atom?
      (lambda (x)
        (and  (not (pair? x)) (not (null? x)))))
    (define mul-help
      (lambda (lat)
        (cond
          ((null? lat)
           '())
          ((atom? (car lat))
           (let ((rest (mul-help  (cdr lat))))
           (cond 
             ((eq? (car lat) oldL)
              (cons new (cons oldL rest)))
             ((eq? (car lat) oldR)
              (cons oldR (cons new rest)))
             (else
              (cons (car lat) rest)))))
          (else
           (let ((first (mul-help  (car lat)))
                 (rest (mul-help  (cdr lat))))
           (cons first rest))))))
    (mul-help lat)))

(multiinsertLR*letreclet 'water 'a 'b '(a b c d a b (a b c d)))
'(water a b water c d water a b water (water a b water c d))
</code></pre><h2 id="14-multiremberstar-and-collector">1.4 multiremberstar and collector</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> multirember*co
  (<span style="color:#66d9ef">lambda</span> (a lat col)
    (<span style="color:#66d9ef">define</span> atom?
      (<span style="color:#66d9ef">lambda</span> (x)
        (<span style="color:#66d9ef">and</span> (not (pair? x)) (not (null? x)))))
    (<span style="color:#66d9ef">cond</span>
      (( null? lat)
       (col (<span style="color:#66d9ef">quote</span> ()) (<span style="color:#66d9ef">quote</span> ())))
      ((atom? (car lat))
       (<span style="color:#66d9ef">cond</span>
         ((eq? ( car lat) a)
         (multirember*co a (cdr lat)
                        (<span style="color:#66d9ef">lambda</span> ( newlat seen)
                          (col newlat (cons (car lat)
                                            seen)))))
       (<span style="color:#66d9ef">else</span>
        (multirember*co a (cdr lat)
                       (<span style="color:#66d9ef">lambda</span> (newlat seen)
                         (col (cons (car lat) newlat) seen))))))
      (<span style="color:#66d9ef">else</span>
       (multirember*co a (car lat)
                       (<span style="color:#66d9ef">lambda</span> (al as)
                         (multirember*co a (cdr lat)
                                         (<span style="color:#66d9ef">lambda</span> (dl ds)
                                           (col (cons al dl)
                                                (cons as ds))))))))))

</code></pre></div><p>Another related procedures:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> col
   (<span style="color:#66d9ef">lambda</span> (x y)
      (null? y)))


(<span style="color:#66d9ef">define</span> a-friend
   (<span style="color:#66d9ef">lambda</span> (x y)
      (length x)))

(<span style="color:#66d9ef">define</span> a-friend-y
   (<span style="color:#66d9ef">lambda</span> (x y)
      (length y)))


(<span style="color:#66d9ef">define</span> a-friend-z
   (<span style="color:#66d9ef">lambda</span> (x y)
      (cons x (cons y <span style="color:#f92672">&#39;</span>()))))

(<span style="color:#66d9ef">define</span> a-friend-zp
   (<span style="color:#66d9ef">lambda</span> (x y z)
      (cons x (cons y (cons z <span style="color:#f92672">&#39;</span>())))))

(<span style="color:#66d9ef">define</span> evens-only*col
  (<span style="color:#66d9ef">lambda</span> (l col)

    (<span style="color:#66d9ef">define</span> atom?
      (<span style="color:#66d9ef">lambda</span> (x)
        (<span style="color:#66d9ef">and</span> (not (pair? x)) (not (null? x)))))
    (<span style="color:#66d9ef">cond</span>
      ((null? l) (col <span style="color:#f92672">&#39;</span>() <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>))
      ((atom? (car l))
       (<span style="color:#66d9ef">cond</span>
         ((even? (car l))
          (evens-only*col (cdr l)
                          (<span style="color:#66d9ef">lambda</span> (newlat L R)
                            (col (cons (car l) newlat) (* (car l) L) R))))
         (<span style="color:#66d9ef">else</span> (evens-only*col (cdr l) (<span style="color:#66d9ef">lambda</span> (newlat L R)
                                      (col newlat L
                                           (+ (car l) R)))))))
      (<span style="color:#66d9ef">else</span>
       (evens-only*col (car l)
                       (<span style="color:#66d9ef">lambda</span> (al ale ari)
                         (evens-only*col (cdr l)
                                         (<span style="color:#66d9ef">lambda</span> (dl dle dri)
                                           (col (cons al dl)
                                                (* ale dle)
                                                (+ ari dri))))))))))


(<span style="color:#66d9ef">define</span> multiinsertLRo
  (<span style="color:#66d9ef">lambda</span> (<span style="color:#66d9ef">new</span> oldL oldR lat col)
    (<span style="color:#66d9ef">cond</span>
      ((null? lat) (col <span style="color:#f92672">&#39;</span>() <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>))
      ((eq? (car lat) oldL)
       (multiinsertLRo <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)
                       (<span style="color:#66d9ef">lambda</span> (newlat L R)
                         (col (cons <span style="color:#66d9ef">new</span> (cons oldL newlat))
                              (+ L <span style="color:#ae81ff">1</span>) R))))
      ((eq? (car lat) oldR)
       (multiinsertLRo <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)
                       (<span style="color:#66d9ef">lambda</span> (newlat L R)
                         (col (cons oldR (cons <span style="color:#66d9ef">new</span> newlat))
                              L (+ R <span style="color:#ae81ff">1</span>)))))
      (<span style="color:#66d9ef">else</span>
       (multiinsertLRo <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)
                       (<span style="color:#66d9ef">lambda</span> (newlat L R)
                         (col (cons (car lat) newlat)
                              L
                              R)))))))




(<span style="color:#66d9ef">define</span> multiinsertLR*o
  (<span style="color:#66d9ef">lambda</span> (<span style="color:#66d9ef">new</span> oldL oldR lat col)
    (<span style="color:#66d9ef">define</span> atom?
      (<span style="color:#66d9ef">lambda</span> (x)
        (<span style="color:#66d9ef">and</span> (not (pair? x)) (not (null? x)))))
    (<span style="color:#66d9ef">cond</span>
      ((null? lat) (col <span style="color:#f92672">&#39;</span>() <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>))
      ((atom? (car lat))
       (<span style="color:#66d9ef">cond</span>
         ((eq? (car lat) oldL)
          (multiinsertLR*o <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)
                          (<span style="color:#66d9ef">lambda</span> (newlat L R)
                            (col (cons <span style="color:#66d9ef">new</span> (cons oldL newlat))
                                 (+ L <span style="color:#ae81ff">1</span>) R))))
         ((eq? (car lat) oldR)
          (multiinsertLR*o <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)
                          (<span style="color:#66d9ef">lambda</span> (newlat L R)
                            (col (cons oldR (cons <span style="color:#66d9ef">new</span> newlat))
                                 L (+ R <span style="color:#ae81ff">1</span>)))))
         (<span style="color:#66d9ef">else</span>
          (multiinsertLR*o <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)
                          (<span style="color:#66d9ef">lambda</span> (newlat L R)
                            (col (cons (car lat) newlat)
                                 L
                                 R))))))
      (<span style="color:#66d9ef">else</span>
       (multiinsertLR*o <span style="color:#66d9ef">new</span> oldL oldR (car lat)
                        (<span style="color:#66d9ef">lambda</span> (al ale ari)
                          (multiinsertLR*o <span style="color:#66d9ef">new</span> oldL oldR (cdr lat)
                                           (<span style="color:#66d9ef">lambda</span> (dl dle dri)
                                             (col (cons al dl)
                                                  (+ ale dle)
                                                  (+ ari dri))))))))))

</code></pre></div><h1 id="二the-season-scheme">二、The Season Scheme</h1>
<p>由<code>member</code>和<code>rember</code>又可以深入进行剖析，于是引进了<code>member</code>的升级版本<code>two-in-a-lat</code>,未包含TSS的最后一个two-in-a-lat的实现，并通过let,letrec,letcc改写TLS中的rember系列函数，在结合leftmost和deep(Later on,deep有两外一层意思就是产生n层的pizza)函数，升级rember到删除最左边的一个元素。</p>
<p>Member实际上在所有的函数的实现中都有对应的组成，他是一个十分重要的组成部分，包括基于member的union,intersect,intersectall函数的，一个相对基础的函数。
the definition of member</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> member?
  (<span style="color:#66d9ef">lambda</span> (a lat)
    (<span style="color:#66d9ef">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else</span>
       (<span style="color:#66d9ef">or</span> (eq? a (car lat))
           (member a (cdr lat)))))))

<span style="color:#75715e">; member-letrec version</span>
(<span style="color:#66d9ef">define</span> member?
  (<span style="color:#66d9ef">lambda</span> (a l)
    (<span style="color:#66d9ef">letrec</span>
      ((yes? (<span style="color:#66d9ef">lambda</span> (l)
               (<span style="color:#66d9ef">cond</span>
                 ((null? l) <span style="color:#66d9ef">#f</span>)
                 ((eq? (car l) a) <span style="color:#66d9ef">#t</span>)
                 (<span style="color:#66d9ef">else</span> (yes? (cdr l)))))))
      (yes? l))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>现在让我们看看two-in-a-lat的引申(通过member)
Two -in -a -lat</p>
<p>包含two-in-a-lat(用member2代替),并附加sum-of-prefix和scramble函数的实现，目的是说如果你想让函数知道额外的信息，可以通过增加参数的方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> member-letrec-ju?
  (<span style="color:#66d9ef">lambda</span> (a lat)
    (<span style="color:#66d9ef">letrec</span> ((yes? (<span style="color:#66d9ef">lambda</span> (l)
                    (<span style="color:#66d9ef">cond</span>
                      ((null? l) <span style="color:#66d9ef">#f</span>)
                      (<span style="color:#66d9ef">else</span>
                       (<span style="color:#66d9ef">or</span> (eq? a (car l))
                           (yes? a (cdr l))))))))
      (yes? lat))))

(<span style="color:#66d9ef">define</span> member2?
  (<span style="color:#66d9ef">lambda</span> (preceding lat)
    (<span style="color:#66d9ef">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else</span> (<span style="color:#66d9ef">or</span> (eq? preceding (car lat))
                (member2? (car lat) (cdr lat)))))))

<span style="color:#75715e">;;; (member2? &#39;a &#39;(a b c))  bugs!</span>

(<span style="color:#66d9ef">define</span> memberContinue?
  (<span style="color:#66d9ef">lambda</span> (lat)
    (<span style="color:#66d9ef">define</span> M2?
      (<span style="color:#66d9ef">lambda</span> (preceding lat)
        (<span style="color:#66d9ef">cond</span>
          ((null? lat) <span style="color:#66d9ef">#f</span>)
          (<span style="color:#66d9ef">else</span> (<span style="color:#66d9ef">or</span> (eq? preceding (car lat))
                    (M2? (car lat) (cdr lat)))))))
    (M2? <span style="color:#f92672">&#39;</span>() lat)))


(<span style="color:#66d9ef">define</span> memberContinueAlter?
  (<span style="color:#66d9ef">lambda</span> (lat)
    (<span style="color:#66d9ef">letrec</span> ((M2? (<span style="color:#66d9ef">lambda</span> (preceding lat)
                    (<span style="color:#66d9ef">cond</span>
                      ((null? lat) <span style="color:#66d9ef">#f</span>)
                      (<span style="color:#66d9ef">else</span>
                       (<span style="color:#66d9ef">let</span> ((pre (car lat)))
                         (<span style="color:#66d9ef">or</span> (eq? preceding pre)
                                (M2? pre (cdr lat)))))))))
             (M2? <span style="color:#f92672">&#39;</span>() lat))))


(<span style="color:#66d9ef">define</span> sum-of-prefixes
  (<span style="color:#66d9ef">lambda</span> (tup)
    (<span style="color:#66d9ef">define</span> sum-of-prefixes-b
      (<span style="color:#66d9ef">lambda</span> (sonssf tup)     <span style="color:#75715e">; sonssf stands for &#39;sum of numbers seen so far&#39;</span>
        (<span style="color:#66d9ef">cond</span>
          ((null? tup) <span style="color:#f92672">&#39;</span>())
          (<span style="color:#66d9ef">else</span> (cons (+ sonssf (car tup))
                      (sum-of-prefixes-b
                       (+ sonssf (car tup))
                       (cdr tup)))))))
    (sum-of-prefixes-b <span style="color:#ae81ff">0</span> tup)))

<span style="color:#75715e">;  (sum-of-prefixes &#39;(1 2 3 4))</span>
<span style="color:#75715e">; &#39;(1 3 6 10)</span>


(<span style="color:#66d9ef">define</span> sum-of-prefixes1
  (<span style="color:#66d9ef">lambda</span> (tup)
    (<span style="color:#66d9ef">letrec</span>
      ((S (<span style="color:#66d9ef">lambda</span> (sss tup)
            (<span style="color:#66d9ef">cond</span>
              ((null? tup) <span style="color:#f92672">&#39;</span>())
              (<span style="color:#66d9ef">else</span>
               (<span style="color:#66d9ef">let</span> ((first (car tup)))
                (cons (+ sss first)
                      (S (+ sss first) (cdr tup)))))))))
(S <span style="color:#ae81ff">0</span> tup))))

(<span style="color:#66d9ef">define</span> scramble-b
  (<span style="color:#66d9ef">lambda</span> (tup rev-pre)
    (<span style="color:#66d9ef">define</span> one?
      (<span style="color:#66d9ef">lambda</span> (n)
        (= n  <span style="color:#ae81ff">1</span>)))
    (<span style="color:#66d9ef">define</span> sub1
      (<span style="color:#66d9ef">lambda</span> (n)
        (- n <span style="color:#ae81ff">1</span>)))
    (<span style="color:#66d9ef">define</span> pick
      (<span style="color:#66d9ef">lambda</span> (n lat)
        (<span style="color:#66d9ef">cond</span>
          ((one? n) (car lat))
          (<span style="color:#66d9ef">else</span> (pick (sub1 n) (cdr lat))))))
    (<span style="color:#66d9ef">cond</span>
      ((null? tup) <span style="color:#f92672">&#39;</span>())
      (<span style="color:#66d9ef">else</span>
       (cons (pick (car tup) (cons (car tup) rev-pre))
             (scramble-b (cdr tup)
                         (cons (car tup) rev-pre)))))))


(<span style="color:#66d9ef">define</span> scramble
  (<span style="color:#66d9ef">lambda</span> (tup)
    (<span style="color:#66d9ef">letrec</span> ((scramble-b
              (<span style="color:#66d9ef">lambda</span> (tup rev-pre)
                (<span style="color:#66d9ef">define</span> one?
                  (<span style="color:#66d9ef">lambda</span> (n)
                    (= n  <span style="color:#ae81ff">1</span>)))
                (<span style="color:#66d9ef">define</span> sub1
                  (<span style="color:#66d9ef">lambda</span> (n)
                    (- n <span style="color:#ae81ff">1</span>)))
                (<span style="color:#66d9ef">define</span> pick
                  (<span style="color:#66d9ef">lambda</span> (n lat)
                    (<span style="color:#66d9ef">cond</span>
                      ((one? n) (car lat))
                      (<span style="color:#66d9ef">else</span> (pick (sub1 n) (cdr lat))))))
                (<span style="color:#66d9ef">cond</span>
                  ((null? tup) <span style="color:#f92672">&#39;</span>())
                  (<span style="color:#66d9ef">else</span>
                   (<span style="color:#66d9ef">let</span> ((first (car tup)))
                     (cons (pick first (cons first rev-pre))
                     (scramble-b (cdr tup)
                                 (cons first rev-pre)))))))))
      (scramble-b tup <span style="color:#f92672">&#39;</span>()))))




(<span style="color:#66d9ef">define</span> scramble2
  (<span style="color:#66d9ef">lambda</span> (tup)
    (<span style="color:#66d9ef">letrec</span> ((one?
              (<span style="color:#66d9ef">lambda</span> (n)
                (= n  <span style="color:#ae81ff">1</span>)))
             (sub1
              (<span style="color:#66d9ef">lambda</span> (n)
                (- n <span style="color:#ae81ff">1</span>)))
             (pick
              (<span style="color:#66d9ef">lambda</span> (n lat)
                (<span style="color:#66d9ef">cond</span>
                  ((one? n) (car lat))
                  (<span style="color:#66d9ef">else</span> (pick (sub1 n) (cdr lat))))))
             (scramble-b
              (<span style="color:#66d9ef">lambda</span> (tup rev-pre)
                (<span style="color:#66d9ef">cond</span>
                  ((null? tup) <span style="color:#f92672">&#39;</span>())
                  (<span style="color:#66d9ef">else</span>
                   (<span style="color:#66d9ef">let</span> ((first (car tup)))
                     (cons (pick first (cons first rev-pre))
                           (scramble-b (cdr tup)
                                       (cons first rev-pre)))))))))
      (scramble-b tup <span style="color:#f92672">&#39;</span>()))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>##2.1 rember-let</p>
<p>Note: use let to define the repeated expression, so simplify the definition of the procedure.</p>
<h2 id="22-rember-letrec">2.2 rember-letrec</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#75715e">;;; see at the TSS</span>
(<span style="color:#66d9ef">define</span> rember
  (<span style="color:#66d9ef">lambda</span> (a lat)
    (<span style="color:#66d9ef">letrec</span>
        ((R (<span style="color:#66d9ef">lambda</span> (lat)
              (<span style="color:#66d9ef">cond</span>
                ((null? lat) <span style="color:#f92672">&#39;</span>())
                ((eq? (car lat) a) (cdr lat))
                (<span style="color:#66d9ef">else</span>
                 (cons (car lat) (R (cdr lat))))))))
      (R lat))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>如果我们想要进一步实现rember-beyond-first(保留删除元素之前的所有元素)和rember-upto-last(只保留删除元素之后的元素)</p>
<h2 id="23-rember-letcc">2.3 rember-letcc</h2>
<p>Rember-Beyond-first</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#75715e">; The rember-beyond-first function rembers everything beyond first match</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define</span> rember-beyond-first
  (<span style="color:#66d9ef">lambda</span> (a lat)
    (<span style="color:#66d9ef">letrec</span>
      ((R (<span style="color:#66d9ef">lambda</span> (lat)
            (<span style="color:#66d9ef">cond</span>
              ((null? lat) <span style="color:#f92672">&#39;</span>())
              ((eq? (car lat) a) <span style="color:#f92672">&#39;</span>())
              (<span style="color:#66d9ef">else</span>
                (cons (car lat) (R (cdr lat))))))))
      (R lat))))
	

(rember-beyond-first
  <span style="color:#f92672">&#39;</span><span style="color:#e6db74">roots</span>
  <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">noodles</span> <span style="color:#e6db74">spaghetti</span> <span style="color:#e6db74">spatzle</span> <span style="color:#e6db74">bean-thread</span> <span style="color:#e6db74">roots</span> <span style="color:#e6db74">potatoes</span> <span style="color:#e6db74">yam</span> <span style="color:#e6db74">others</span> <span style="color:#e6db74">rice</span>))
<span style="color:#75715e">; ==&gt; &#39;(noodles spaghetti spaghetti bean-thread)</span>

Rember-upto-last


(<span style="color:#66d9ef">define-syntax</span> letcc
  (<span style="color:#66d9ef">syntax-rules</span> ()
    ((letcc ?k ?body <span style="color:#66d9ef">...</span>)
     (call/cc (<span style="color:#66d9ef">lambda</span> (?k) ?body <span style="color:#66d9ef">...</span>)))))
(<span style="color:#66d9ef">define</span> rember-upto-last
  (<span style="color:#66d9ef">lambda</span> (a lat) <span style="color:#75715e">; Look Ma, no cons   </span>
    (letcc skip
      (<span style="color:#66d9ef">letrec</span> 
          ((R
            (<span style="color:#66d9ef">lambda</span> (l)
              (<span style="color:#66d9ef">cond</span>
                ((null? l) (void))
                (<span style="color:#66d9ef">else</span> (<span style="color:#66d9ef">let</span> ()
                        (R (cdr l))
                        (<span style="color:#66d9ef">cond</span>
                          ((eq? a (car l))
                           (skip (cdr l)))
                          (<span style="color:#66d9ef">else</span> (void)))))))))
        (R lat)
        lat))))

	

(rember-upto-last
  <span style="color:#f92672">&#39;</span><span style="color:#e6db74">roots</span>
  <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">noodles</span> <span style="color:#e6db74">spaghetti</span> <span style="color:#e6db74">spatzle</span> <span style="color:#e6db74">bean-thread</span> <span style="color:#e6db74">roots</span> <span style="color:#e6db74">potatoes</span> <span style="color:#e6db74">yam</span> <span style="color:#e6db74">others</span> <span style="color:#e6db74">rice</span>))
<span style="color:#75715e">; ==&gt; &#39;(potatoes yam others rice)</span>

</code></pre></div><h2 id="24-remberstar">2.4 remberstar</h2>
<p>the definition of leftmost</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> leftmost-fixed-let
  (<span style="color:#66d9ef">lambda</span> (l)
    (<span style="color:#66d9ef">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((atom? (car l)) (car l))
      (<span style="color:#66d9ef">else</span>
       (<span style="color:#66d9ef">let</span> ((a (leftmost-fixed (car l))))
         (<span style="color:#66d9ef">cond</span>
           ((atom? a) a)
           (<span style="color:#66d9ef">else</span> (leftmost-fixed (cdr l)))))))))

<span style="color:#75715e">;(leftmost-fixed-let &#39;((() a b) (c d))) ;; bug fixed</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;(leftmost-fixed-let &#39;(((y) b) (c d)))   ; &#39;y</span>
<span style="color:#75715e">;(leftmost-fixed-let &#39;(((y) ()) () (e))) ; &#39;y</span>
<span style="color:#75715e">;(leftmost-fixed-let &#39;(((() y) ())))     ; &#39;y</span>
<span style="color:#75715e">;(leftmost-fixed-let &#39;(((()) ()))) ; &#39;()</span>



<span style="color:#75715e">;;letcc version</span>

(<span style="color:#66d9ef">define</span> leftmost-letcc
  (<span style="color:#66d9ef">letrec</span>
      ((lm (<span style="color:#66d9ef">lambda</span> (l out)
             (<span style="color:#66d9ef">cond</span>
               ((null? l) <span style="color:#f92672">&#39;</span>())
               ((atom? (car l)) (out (car l)))
               (<span style="color:#66d9ef">else</span>
                (<span style="color:#66d9ef">begin</span>
                  (lm (car l) out)
                  (lm (cdr l) out)))))))
    (<span style="color:#66d9ef">lambda</span> (l)
      (call-with-current-continuation
       (<span style="color:#66d9ef">lambda</span> (skip)
         (lm l skip))))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>the definition of deep</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> deep
  (<span style="color:#66d9ef">lambda</span> (m)
    (<span style="color:#66d9ef">cond</span>
      ((zero? m) <span style="color:#f92672">&#39;</span><span style="color:#e6db74">pizza</span>)
      (<span style="color:#66d9ef">else</span> (cons (deep (sub1 m)) <span style="color:#f92672">&#39;</span>())))))


(<span style="color:#66d9ef">define</span> toppings <span style="color:#ae81ff">0</span>)
(<span style="color:#66d9ef">define</span> deepB
  (<span style="color:#66d9ef">lambda</span> (m)
    (<span style="color:#66d9ef">cond</span>
      ((zero? m)
       (call-with-current-continuation
        (<span style="color:#66d9ef">lambda</span> (jump)
          (<span style="color:#66d9ef">set!</span> toppings jump)
          <span style="color:#f92672">&#39;</span><span style="color:#e6db74">pizza</span>)))
      (<span style="color:#66d9ef">else</span>
       (cons (deepB (sub1 m)) <span style="color:#f92672">&#39;</span>())))))

(<span style="color:#66d9ef">define</span> deep&amp;co
  (<span style="color:#66d9ef">lambda</span> (m k)
    (<span style="color:#66d9ef">cond</span>
      ((zero? m) (k <span style="color:#f92672">&#39;</span><span style="color:#e6db74">pizza</span>))
      (<span style="color:#66d9ef">else</span>
       (deep&amp;co (sub1 m)
                (<span style="color:#66d9ef">lambda</span> (x) (k (cons x <span style="color:#f92672">&#39;</span>()))))))))

(deep&amp;co <span style="color:#ae81ff">0</span> (<span style="color:#66d9ef">lambda</span> (x) x))          <span style="color:#75715e">; &#39;pizza</span>
(deep&amp;co <span style="color:#ae81ff">6</span> (<span style="color:#66d9ef">lambda</span> (x) x))          <span style="color:#75715e">; &#39;((((((pizza))))))</span>
(deep&amp;co <span style="color:#ae81ff">2</span> (<span style="color:#66d9ef">lambda</span> (x) x)) <span style="color:#75715e">; &#39;((pizza))</span>


(<span style="color:#66d9ef">define</span> deep&amp;coB
  (<span style="color:#66d9ef">lambda</span> (m k)
    (<span style="color:#66d9ef">cond</span>
      ((zero? m)
       (<span style="color:#66d9ef">let</span> ()
         (<span style="color:#66d9ef">set!</span> toppings k)
         (k <span style="color:#f92672">&#39;</span><span style="color:#e6db74">pizza</span>)))
      (<span style="color:#66d9ef">else</span>
       (deep&amp;coB (sub1 m)
                 (<span style="color:#66d9ef">lambda</span> (x)
                   (k (cons x <span style="color:#f92672">&#39;</span>()))))))))

(deep&amp;coB <span style="color:#ae81ff">6</span> (<span style="color:#66d9ef">lambda</span> (x) x))         <span style="color:#75715e">; &#39;((((((pizza))))))</span>
(deep&amp;coB <span style="color:#ae81ff">4</span> (<span style="color:#66d9ef">lambda</span> (x) x)) <span style="color:#75715e">; &#39;((((pizza))))</span>
</code></pre></div><p>接下来，再看看由leftmost结合rember得到rember star.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">
<span style="color:#75715e">; The rember1* function removes the leftmost occurrence of a in l</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define</span> rember1*
  (<span style="color:#66d9ef">lambda</span> (a l)
    (<span style="color:#66d9ef">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((atom? (car l))
       (<span style="color:#66d9ef">cond</span>
         ((eq? (car l) a) (cdr l))
         (<span style="color:#66d9ef">else</span>
           (cons (car l) (rember1* a (cdr l))))))
      (<span style="color:#66d9ef">else</span>
        (<span style="color:#66d9ef">cond</span>
          ((equal? (rember1* a (car l)) (car l)) <span style="color:#75715e">; if the list with &#39;a&#39; removed doesn&#39;t change</span>
           (cons (car l) (rember1* a (cdr l))))  <span style="color:#75715e">; then recurse</span>
          (<span style="color:#66d9ef">else</span>
            (cons (rember1* a (car l)) (cdr l)))))))) <span style="color:#75715e">; otherwise remove &#39;a&#39;</span>

	


<span style="color:#75715e">; Examples of rember1*</span>
<span style="color:#75715e">;</span>
(rember1*
  <span style="color:#f92672">&#39;</span><span style="color:#e6db74">salad</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">Swedish</span> <span style="color:#e6db74">rye</span>) (<span style="color:#e6db74">French</span> (<span style="color:#e6db74">mustard</span> <span style="color:#e6db74">salad</span> <span style="color:#e6db74">turkey</span>)) <span style="color:#e6db74">salad</span>))
<span style="color:#75715e">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>

(rember1*
  <span style="color:#f92672">&#39;</span><span style="color:#e6db74">meat</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pasta</span> <span style="color:#e6db74">meat</span>) <span style="color:#e6db74">pasta</span> (<span style="color:#e6db74">noodles</span> <span style="color:#e6db74">meat</span> <span style="color:#e6db74">sauce</span>) <span style="color:#e6db74">meat</span> <span style="color:#e6db74">tomatoes</span>))
<span style="color:#75715e">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>

</code></pre></div><p>下面是letrec version of rember1</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">
(<span style="color:#66d9ef">define</span> rember1*-letrec
  (<span style="color:#66d9ef">lambda</span> (a l)
    (<span style="color:#66d9ef">letrec</span>
        ((R (<span style="color:#66d9ef">lambda</span> (l)
              (<span style="color:#66d9ef">cond</span>
                ((null? l) <span style="color:#f92672">&#39;</span>())
                ((atom? (car l))
                 (<span style="color:#66d9ef">let</span> ((first (car l))
                       (second (cdr l)))
                   (<span style="color:#66d9ef">cond</span>
                     ((eq? first a) second)
                     (<span style="color:#66d9ef">else</span>
                      (cons first (R second))))))
                 (<span style="color:#66d9ef">else</span>
                  (<span style="color:#66d9ef">let</span> ((first (car l))
                        (second (cdr l)))
                    (<span style="color:#66d9ef">cond</span>
                      ((equal? (R first) first) <span style="color:#75715e">; if the list with &#39;a&#39; removed doesn&#39;t change</span>
                       (cons first (R second)))  <span style="color:#75715e">; then recurse</span>
                      (<span style="color:#66d9ef">else</span>
                       (cons (R first) second))))))))) <span style="color:#75715e">; otherwise remove &#39;a&#39;</span>
      (R l))))
(rember1*-letrec
  <span style="color:#f92672">&#39;</span><span style="color:#e6db74">salad</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">Swedish</span> <span style="color:#e6db74">rye</span>) (<span style="color:#e6db74">French</span> (<span style="color:#e6db74">mustard</span> <span style="color:#e6db74">salad</span> <span style="color:#e6db74">turkey</span>)) <span style="color:#e6db74">salad</span>))
(rember1*-letrec
  <span style="color:#f92672">&#39;</span><span style="color:#e6db74">meat</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pasta</span> <span style="color:#e6db74">meat</span>) <span style="color:#e6db74">pasta</span> (<span style="color:#e6db74">noodles</span> <span style="color:#e6db74">meat</span> <span style="color:#e6db74">sauce</span>) <span style="color:#e6db74">meat</span> <span style="color:#e6db74">tomatoes</span>))

</code></pre></div><p>the version of letcc (我暂时不太理解)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#75715e">; rember1* via letcc</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define</span> rember1*-letcc
  (<span style="color:#66d9ef">lambda</span> (a l)
    (<span style="color:#66d9ef">letrec</span>
        ((rm (<span style="color:#66d9ef">lambda</span> (a l oh)
               (<span style="color:#66d9ef">cond</span>
                 ((null? l) (oh <span style="color:#f92672">&#39;</span><span style="color:#e6db74">no</span>))
                 ((atom? (car l))
                  (<span style="color:#66d9ef">if</span> (eq? (car l) a)
                      (cdr l)
                      (cons (car l) (rm a (cdr l) oh))))
                 (<span style="color:#66d9ef">else</span>
                  (<span style="color:#66d9ef">let</span> ((new-car
                         (call-with-current-continuation
                          (<span style="color:#66d9ef">lambda</span> (oh)
                            (rm a (car l) oh)))))
                    (<span style="color:#66d9ef">if</span> (atom? new-car)
                        (cons (car l) (rm a (cdr l) oh))
                        (cons new-car (cdr l)))))))))
      (<span style="color:#66d9ef">let</span> ((new-l
             (call-with-current-continuation
              (<span style="color:#66d9ef">lambda</span> (oh)
                (rm a l oh)))))
        (<span style="color:#66d9ef">if</span> (atom? new-l)
            l
            new-l)))))

<span style="color:#75715e">; Tests of rember1*-letcc</span>
<span style="color:#75715e">;</span>
(rember1*-letcc
 <span style="color:#f92672">&#39;</span><span style="color:#e6db74">salad</span>
 <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">Swedish</span> <span style="color:#e6db74">rye</span>) (<span style="color:#e6db74">French</span> (<span style="color:#e6db74">mustard</span> <span style="color:#e6db74">salad</span> <span style="color:#e6db74">turkey</span>)) <span style="color:#e6db74">salad</span>))
<span style="color:#75715e">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>

(rember1*-letcc
 <span style="color:#f92672">&#39;</span><span style="color:#e6db74">meat</span>
 <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pasta</span> <span style="color:#e6db74">meat</span>) <span style="color:#e6db74">pasta</span> (<span style="color:#e6db74">noodles</span> <span style="color:#e6db74">meat</span> <span style="color:#e6db74">sauce</span>) <span style="color:#e6db74">meat</span> <span style="color:#e6db74">tomatoes</span>))
<span style="color:#75715e">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>

(rember1*-letcc
 <span style="color:#f92672">&#39;</span><span style="color:#e6db74">a</span>
 <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">foo</span> <span style="color:#e6db74">bar</span>) <span style="color:#e6db74">baz</span>))
<span style="color:#75715e">; ==&gt; &#39;((foo bar) baz)</span>
</code></pre></div><p>the definition of union</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> union2
  (<span style="color:#66d9ef">lambda</span> (set1 set2)
    (<span style="color:#66d9ef">letrec</span> ((member? (<span style="color:#66d9ef">lambda</span> (a lat)
                (<span style="color:#66d9ef">cond</span> ((null? lat) <span style="color:#66d9ef">#f</span>)
                              ((eq? a (car lat)) <span style="color:#66d9ef">#t</span>)
                              (<span style="color:#66d9ef">else</span> (member? a (cdr lat))))))
             (A (<span style="color:#66d9ef">lambda</span> (set1)
                (<span style="color:#66d9ef">cond</span>
                  ((null? set1) set2)
                  (<span style="color:#66d9ef">else</span>
                   (<span style="color:#66d9ef">let</span> ((p1 (A (cdr set1))))
                     (<span style="color:#66d9ef">if</span> (member? (car set1) set2)
                         p1
                         (cons (car set1) p1))))))))
      (A set1))))
      (union2 <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span> <span style="color:#e6db74">c</span>) <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">c</span> <span style="color:#e6db74">d</span> <span style="color:#e6db74">e</span> <span style="color:#e6db74">f</span>))

</code></pre></div><p>the definition of intersect</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> intersect
  (<span style="color:#66d9ef">lambda</span> (set1 set2)
    (<span style="color:#66d9ef">cond</span>
      ((null? set1) <span style="color:#f92672">&#39;</span>())  <span style="color:#75715e">; don&#39;t forget the 1st commandment</span>
      ((member? (car set1) set2)
       (cons (car set1) (intersect (cdr set1) set2)))
      (<span style="color:#66d9ef">else</span>
        (intersect (cdr set1) set2)))))
<span style="color:#75715e">; Examples of intersect</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;(intersect &#39;(a b x c d) &#39;(q w e x r t y a))     ; &#39;(a x)</span>
<span style="color:#75715e">;(intersect &#39;(a b x c d) &#39;())                    ; &#39;()</span>
<span style="color:#75715e">;(intersect &#39;() &#39;())                             ; &#39;()</span>
<span style="color:#75715e">;(intersect &#39;() &#39;(a b x c d))                    ; &#39;()</span>
<span style="color:#75715e">;(intersect &#39;(a b x c d) &#39;(a b x c d))           ; &#39;(a b x c d)</span>

</code></pre></div><p>intersect letrec version</p>
<p>use letrec to remove arguments that do not change for recursive applications</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> intersect-letrec
  (<span style="color:#66d9ef">lambda</span> (set1 set2)
    (<span style="color:#66d9ef">letrec</span>
      ((I (<span style="color:#66d9ef">lambda</span> (set)
            (<span style="color:#66d9ef">cond</span>
              ((null? set) <span style="color:#f92672">&#39;</span>())
              ((member? (car set) set2)
               (cons (car set) (I (cdr set))))
              (<span style="color:#66d9ef">else</span>
                (I (cdr set)))))))
      (I set1))))

<span style="color:#75715e">; Test of intersect-letrec</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;(intersect-letrec &#39;(a b x c d) &#39;(q w e x r t y a))     ; &#39;(a x)</span>
<span style="color:#75715e">;(intersect-letrec &#39;(a b x c d) &#39;())                    ; &#39;()</span>
<span style="color:#75715e">;(intersect-letrec &#39;() &#39;())                             ; &#39;()</span>
<span style="color:#75715e">;(intersect-letrec &#39;() &#39;(a b x c d))                    ; &#39;()</span>
<span style="color:#75715e">;(intersect-letrec &#39;(a b x c d) &#39;(a b x c d))           ; &#39;(a b x c d)</span>
</code></pre></div><p>the definition of intersectall</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#75715e">; The intersectall function finds intersect of a bunch of sets</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define</span> intersectall
  (<span style="color:#66d9ef">lambda</span> (lset)
    (<span style="color:#66d9ef">cond</span>
      ((null? lset) <span style="color:#f92672">&#39;</span>())
      ((null? (cdr lset)) (car lset))
      (<span style="color:#66d9ef">else</span>
        (intersect (car lset)
                   (intersectall (cdr lset)))))))

<span style="color:#75715e">; Examples of intersectall</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;(intersectall &#39;((a) (a) (a)))                   ; &#39;(a)</span>
<span style="color:#75715e">;(intersectall &#39;((a) () (a)))                    ; &#39;()</span>
<span style="color:#75715e">;(intersectall &#39;())                              ; &#39;()</span>
<span style="color:#75715e">;(intersectall &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)</span>

<span style="color:#75715e">; Obeying the 12th commandment</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define</span> intersectall-letrec
  (<span style="color:#66d9ef">lambda</span> (lset)
    (<span style="color:#66d9ef">letrec</span>
      ((A (<span style="color:#66d9ef">lambda</span> (lset)
            (<span style="color:#66d9ef">cond</span>
              ((null? (cdr lset)) (car lset))
              (<span style="color:#66d9ef">else</span>
                (intersect (car lset)
                           (A (cdr lset))))))))
      (<span style="color:#66d9ef">cond</span>
        ((null? lset) <span style="color:#f92672">&#39;</span>())
        (<span style="color:#66d9ef">else</span> (A lset))))))

<span style="color:#75715e">; Tests of intersectall-letrec</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;(intersectall-letrec &#39;((a) (a) (a)))                   ; &#39;(a)</span>
<span style="color:#75715e">;(intersectall-letrec &#39;((a) () (a)))                    ; &#39;()</span>
<span style="color:#75715e">;(intersectall-letrec &#39;())                              ; &#39;()</span>
<span style="color:#75715e">;(intersectall-letrec &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)</span>


(<span style="color:#66d9ef">define</span> intersectall-ap
  (<span style="color:#66d9ef">lambda</span> (lset)
    (call-with-current-continuation
      (<span style="color:#66d9ef">lambda</span> (hop)
        (<span style="color:#66d9ef">letrec</span>
          ((A (<span style="color:#66d9ef">lambda</span> (lset)
                (<span style="color:#66d9ef">cond</span>
                  ((null? (car lset)) (hop <span style="color:#f92672">&#39;</span>()))
                  ((null? (cdr lset)) (car lset))
                  (<span style="color:#66d9ef">else</span>
                    (I (car lset)
                       (A (cdr lset)))))))
           (I (<span style="color:#66d9ef">lambda</span> (s1 s2)
                (<span style="color:#66d9ef">letrec</span>
                  ((J (<span style="color:#66d9ef">lambda</span> (s1)
                        (<span style="color:#66d9ef">cond</span>
                          ((null? s1) <span style="color:#f92672">&#39;</span>())
                          ((member? (car s1) s2)
                           (cons (car s1) (J (cdr s1))))
                          (<span style="color:#66d9ef">else</span>
                            (J (cdr s1)))))))
                  (<span style="color:#66d9ef">cond</span>
                    ((null? s2) (hop <span style="color:#f92672">&#39;</span>()))
                    (<span style="color:#66d9ef">else</span> (J s1)))))))
          (<span style="color:#66d9ef">cond</span>
            ((null? lset) <span style="color:#f92672">&#39;</span>())
            (<span style="color:#66d9ef">else</span> (A lset))))))))

<span style="color:#75715e">; Tests of intersectall-ap</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;(intersectall-ap &#39;((a) (a) (a)))                   ; &#39;(a)</span>
<span style="color:#75715e">;(intersectall-ap &#39;((a) () (a)))                    ; &#39;()</span>
<span style="color:#75715e">;(intersectall-ap &#39;())                              ; &#39;()</span>
<span style="color:#75715e">;(intersectall-ap &#39;((a b c d) (b c d e) (c d e f))) ; &#39;(c d)</span>
</code></pre></div><p>最后再透过deep star的写法优化过程来体会TSS的函数精髓。
depthStar improvement</p>
<p>通过depth进一步阐释letrec的意义（从原始的depth到depth-let 然后depth-let-if，以及更为清晰版本的depth-let-max,然后最后浓缩到最后的6行代码depth-max。
depth</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#75715e">; The depth* function finds the max depth of an s-expression</span>

<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define</span> depth*
  (<span style="color:#66d9ef">lambda</span> (l)
    (<span style="color:#66d9ef">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((atom? (car l)) (depth* (cdr l)))
      (<span style="color:#66d9ef">else</span>
        (<span style="color:#66d9ef">cond</span>
          ((&gt; (depth* (cdr l))
              (add1 (depth* (car l))))
           (depth* (cdr l)))
          (<span style="color:#66d9ef">else</span>
(add1 (depth* (car l)))))))))


(depth* <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pickled</span>) <span style="color:#e6db74">peppers</span> (<span style="color:#e6db74">peppers</span> <span style="color:#e6db74">pickled</span>)))                          <span style="color:#75715e">; 2</span>
(depth* <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">margarine</span> ((<span style="color:#e6db74">bitter</span> <span style="color:#e6db74">butter</span>) (<span style="color:#e6db74">makes</span>) (<span style="color:#e6db74">batter</span> (<span style="color:#e6db74">bitter</span>))) <span style="color:#e6db74">butter</span>)) <span style="color:#75715e">; 4</span>
(depth* <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">c</span> (<span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span>) <span style="color:#e6db74">a</span>) <span style="color:#e6db74">a</span>)) <span style="color:#75715e">; 3</span>
</code></pre></div><p>let version:
depth-let</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> depth*-let
  (<span style="color:#66d9ef">lambda</span> (l)
    (<span style="color:#66d9ef">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((atom? (car l)) (depth*-let (cdr l)))
      (<span style="color:#66d9ef">else</span>
       (<span style="color:#66d9ef">let</span> ((rightPart (depth*-let (cdr l)))
             (leftPart (add1 (depth*-let (car l)))))
         (<span style="color:#66d9ef">cond</span>
           ((&gt; rightPart
               leftPart)
            rightPart)
           (<span style="color:#66d9ef">else</span>
            leftPart)))))))

(depth*-let <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pickled</span>) <span style="color:#e6db74">peppers</span> (<span style="color:#e6db74">peppers</span> <span style="color:#e6db74">pickled</span>)))                          <span style="color:#75715e">; 2</span>
(depth*-let <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">margarine</span> ((<span style="color:#e6db74">bitter</span> <span style="color:#e6db74">butter</span>) (<span style="color:#e6db74">makes</span>) (<span style="color:#e6db74">batter</span> (<span style="color:#e6db74">bitter</span>))) <span style="color:#e6db74">butter</span>)) <span style="color:#75715e">; 4</span>
(depth*-let <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">c</span> (<span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span>) <span style="color:#e6db74">a</span>) <span style="color:#e6db74">a</span>)) <span style="color:#75715e">; 3</span>

</code></pre></div><p>let-if version:
depth-let-if</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> depth*-let-if
  (<span style="color:#66d9ef">lambda</span> (l)
    (<span style="color:#66d9ef">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((atom? (car l)) (depth*-let-if (cdr l)))
      (<span style="color:#66d9ef">else</span>
       (<span style="color:#66d9ef">let</span> ((rightPart (depth*-let-if (cdr l)))
             (leftPart (add1 (depth*-let-if (car l)))))
         (<span style="color:#66d9ef">if</span> (&gt; rightPart leftPart)
            rightPart
            leftPart))))))

(depth*-let-if <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pickled</span>) <span style="color:#e6db74">peppers</span> (<span style="color:#e6db74">peppers</span> <span style="color:#e6db74">pickled</span>)))                          <span style="color:#75715e">; 2</span>
(depth*-let-if <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">margarine</span> ((<span style="color:#e6db74">bitter</span> <span style="color:#e6db74">butter</span>) (<span style="color:#e6db74">makes</span>) (<span style="color:#e6db74">batter</span> (<span style="color:#e6db74">bitter</span>))) <span style="color:#e6db74">butter</span>)) <span style="color:#75715e">; 4</span>
(depth*-let-if <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">c</span> (<span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span>) <span style="color:#e6db74">a</span>) <span style="color:#e6db74">a</span>)) <span style="color:#75715e">; 3</span>

depth-let-max version:
depth-let-max<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#66d9ef">define</span> depth*-let-max
  (<span style="color:#66d9ef">lambda</span> (l)
    (<span style="color:#66d9ef">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((atom? (car l)) (depth*-let-max (cdr l)))
      (<span style="color:#66d9ef">else</span>
       (<span style="color:#66d9ef">let</span> ((rightPart (depth*-let-max (cdr l)))
             (leftPart (add1 (depth*-let-max (car l)))))
         (max rightPart leftPart)))))<span style="color:#960050;background-color:#1e0010">)</span>

(depth*-let-max <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pickled</span>) <span style="color:#e6db74">peppers</span> (<span style="color:#e6db74">peppers</span> <span style="color:#e6db74">pickled</span>)))                          <span style="color:#75715e">; 2</span>
(depth*-let-max <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">margarine</span> ((<span style="color:#e6db74">bitter</span> <span style="color:#e6db74">butter</span>) (<span style="color:#e6db74">makes</span>) (<span style="color:#e6db74">batter</span> (<span style="color:#e6db74">bitter</span>))) <span style="color:#e6db74">butter</span>)) <span style="color:#75715e">; 4</span>
(depth*-let-max <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">c</span> (<span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span>) <span style="color:#e6db74">a</span>) <span style="color:#e6db74">a</span>)) <span style="color:#75715e">; 3</span>

depth-max version:
depth-max

(<span style="color:#66d9ef">define</span> depth*-max
  (<span style="color:#66d9ef">lambda</span> (l)
    (<span style="color:#66d9ef">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((atom? (car l)) (depth*-max (cdr l)))
      (<span style="color:#66d9ef">else</span>
         (max (depth*-max (cdr l)) (add1 (depth*-max (car l))))))))

(depth*-max <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">pickled</span>) <span style="color:#e6db74">peppers</span> (<span style="color:#e6db74">peppers</span> <span style="color:#e6db74">pickled</span>)))                          <span style="color:#75715e">; 2</span>
(depth*-max <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">margarine</span> ((<span style="color:#e6db74">bitter</span> <span style="color:#e6db74">butter</span>) (<span style="color:#e6db74">makes</span>) (<span style="color:#e6db74">batter</span> (<span style="color:#e6db74">bitter</span>))) <span style="color:#e6db74">butter</span>)) <span style="color:#75715e">; 4</span>
(depth*-max <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">c</span> (<span style="color:#e6db74">b</span> (<span style="color:#e6db74">a</span> <span style="color:#e6db74">b</span>) <span style="color:#e6db74">a</span>) <span style="color:#e6db74">a</span>)) <span style="color:#75715e">; 3</span>

</code></pre></div><p>常用链接，</p>
<p><a href="http://jueqingsizhe66.github.io/blog/2016/02/14/si-ji-mo-si-de-le-yuan-schemers/"> Scheme清单 </a>
<a href="https://groups.google.com/forum/#!forum/racket-users"> Google racket User group </a>
<a href="https://groups.google.com/forum/#!topic/racket-users/cPuTr8lrXCs"> Gossip about the decision tree </a>
GreghenderShoot 1970</p>
<ol>
<li>
<p><a href="https://github.com/greghendershott"> Github Repo </a></p>
</li>
<li>
<p><a href="https://github.com/greghendershott/fear-of-macros"> Fear of macro </a> Tell us the history of macro, overcome the fear of macro</p>
</li>
<li>
<p><a href="https://github.com/greghendershott/frog"> frog </a> one static website generator tool</p>
</li>
<li>
<p><a href="http://www.greghendershott.com/"> His Website </a>
Tonyg</p>
</li>
<li>
<p><a href="https://github.com/tonyg?tab=repositories"> Github Repo </a></p>
</li>
<li>
<p><a href="http://tonyg.github.io/racket-bitsyntax/"> His opensource tools: Bitsyntax </a></p>
</li>
</ol>
<p><a href="https://botbot.me/freenode/racket/"> racket freenote robot, Gossip Platform </a>
Husk scheme</p>
<ol>
<li>
<p><a href="https://github.com/justinethier/husk-scheme"> husk repo </a></p>
</li>
<li>
<p><a href="http://justinethier.github.io/husk-scheme/manual/getting-started.html"> husk get started </a>
<a href="https://github.com/alaricsp/chicken-scheme"> chicken scheme </a>
<a href="http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-2.html#%25_toc_start"> R5RS html file </a>
root of lisp</p>
</li>
<li>
<p><a href="http://www.paulgraham.com/rootsoflisp.html"> original site </a></p>
</li>
<li>
<p><a href="https://github.com/hlpp/scheme/tree/master/tests"> define implement </a></p>
</li>
</ol>
<p>BTW, one very good vim tips, you can use <a href="https://github.com/Shougo/vimfiler.vim"> Vimfiler </a>, with shortkey <code>m</code> and then <code>r</code> to rename the file in the editor page.</p>

    </div>
 <div class="nav-links" style="padding:10;">
        
        <div align="left">
        <a href="https://jueqingsizhe66.github.io/blog/2017/08/11/cps-intutive/"><span class="arrow">←</span> <strong>上一篇:CPS Intutive</strong></a>
        </div>
        
        


       <div align="right"> <a href="https://jueqingsizhe66.github.io/blog/2017/08/13/what-vim-teaches-you/" ><strong>下一篇:What Vim Teaches You? </strong><span class="arrow">→</span></a></div>
        
      </div>
    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/scheme/">scheme</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/&amp;text=From%20Little%20Scheme%20to%20Season%20Scheme" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/&amp;t=From%20Little%20Scheme%20to%20Season%20Scheme" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=From%20Little%20Scheme%20to%20Season%20Scheme&amp;body=https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/&amp;title=From%20Little%20Scheme%20to%20Season%20Scheme" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=From%20Little%20Scheme%20to%20Season%20Scheme%20https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://jueqingsizhe66.github.io/blog/2017/08/11/from-little-scheme-to-season-scheme/&amp;title=From%20Little%20Scheme%20to%20Season%20Scheme" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hub2bcfcfc92fc067668c68513c0d68b69_23221_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jueqingsizhe66.github.io/">Ye Zhaoliang</a></h5>
      <h6 class="card-subtitle">Engineer of offshore wind turbine technique research</h6>
      <p class="card-text">My research interests include distributed energy, wind turbine power generation technique , Computational fluid dynamic and programmable matter.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=7VyEMyQAAAAJ&amp;hl=zh-CN" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/blog/2015/05/18/the-little-scheme-and-part-of-tss/">The-Little-Scheme-And-Part-Of-TSS</a></li>
      
      <li><a href="/blog/2017/08/11/cps-intutive/">CPS Intutive</a></li>
      
      <li><a href="/blog/2016/03/30/program-as-data/">program-as-data</a></li>
      
      <li><a href="/blog/2016/03/03/schemehuan-jing-de-ji-chong-biao-xian-xing-shi-represtations/">scheme环境的几种表现形式-represtations</a></li>
      
      <li><a href="/blog/2016/02/28/cha-ru-pai-xu/">插入排序</a></li>
      
    </ul>


         <span id="busuanzi_container_site_pv"> 
             本站访问量：<span id="busuanzi_value_site_pv"></span>次 
         </span> 
         &nbsp; 
   </div> 


  </div>

</article>
<script src="https://utteranc.es/client.js"
        repo="jueqingsizhe66/jueqingsizhe66.github.io"
        issue-term="pathname"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/go.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/vim.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/matlab.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/sql.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/c.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/scheme.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/racket.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/perl.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/awk.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/clojure.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.d6bd04fdad2ad213aa8111c5a3b72fc5.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    ©2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
