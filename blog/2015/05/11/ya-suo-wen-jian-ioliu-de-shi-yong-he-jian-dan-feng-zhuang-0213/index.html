<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ye Zhaoliang">

  
  
  
    
  
  <meta name="description" content="">

  
  <link rel="alternate" hreflang="en-us" href="https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.e8d4d5fd376e67b34452ebe1cae16341.css">

  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jueqingsizhe66">
  <meta property="twitter:creator" content="@jueqingsizhe66">
  
  <meta property="og:site_name" content="简约派">
  <meta property="og:url" content="https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/">
  <meta property="og:title" content="压缩文件IO流的使用和简单封装（0213） | 简约派">
  <meta property="og:description" content=""><meta property="og:image" content="https://jueqingsizhe66.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://jueqingsizhe66.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2015-05-11T14:58:47&#43;08:00">
    
    <meta property="article:modified_time" content="2015-05-11T14:58:47&#43;08:00">
  

  



  


  


  





  <title>压缩文件IO流的使用和简单封装（0213） | 简约派</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">简约派</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>概要</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>博文</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>项目</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>课程</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/categories/"><span>分类</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/archives"><span>归档</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>标签</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  








  
 <script async src="//cdn.busuanzi.ibruce.info/cdn/busuanzi/2.3/busuanzi.pure.mini.js"></script> 
 <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> 
 <script> 
     $(document).ready(function() { 
         var int = setInterval(fixCount, 100); 
         var busuanziSiteOffset =  100000  
         function fixCount() { 
             if ($("#busuanzi_container_site_pv").css("display") != "none") { 
                 clearInterval(int); 
                 $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + busuanziSiteOffset); 
             } 
         } 
     }); 
 </script> 
  






  

  
  
  
<div class="article-container pt-3">
  <h1>压缩文件IO流的使用和简单封装（0213）</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    May 11, 2015
  </span>

  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/programme/">programme</a></span>

  
</div>

    














  
</div>





<span class="article-metadata" >Reading time: 37 minutes and    13 seconds with 8189 words. 本文总阅读量<span id="busuanzi_value_page_pv"></span>次 </span>
    <aside>
        <nav id="TableOfContents"></nav>
    </aside>
  <div class="article-container">


    <div class="article-style">
      <p>分为三个部分：
第一部分 ，先是试用了zipinputstream的用法
第二部分， 是进一步试用了压缩流zipoutputStream和加密的方法
第三部分 ， 则是对上述过程封装为一个OOZip类</p>
<p>功能简述：  分为普通的压缩和加密的压缩，对应的解压缩 。普通的压缩：文件和文件夹都可以。 加密的压缩：文件和文件夹都可以，当加密的时候，则生成的zip文件里面的文件打开时乱码，必须用对应的unzipCrypto方法进行解压才有效。当然不会像winzip会提醒你输入密码，可以让你打开，只不过打开的是乱码。</p>
<p>1： 先从com.rupeng.gtk4j挖出了zipInputStream的用法，用于解压缩，测试只能针对zip文件。
于是就有了初始版本的解压缩流：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> java.io.Closeable<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.File<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileInputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileNotFoundException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileOutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.IOException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.InputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.OutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.PrintWriter<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.StringWriter<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipEntry<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipInputStream<span style="color:#f92672">;</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e">* @author    叶昭良
</span><span style="color:#75715e">* @time      2015年2月12日下午1:19:18
</span><span style="color:#75715e">* @version   TestZipInputStream V1.0
</span><span style="color:#75715e">*/</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestZipInputStream</span>
<span style="color:#f92672">{</span>

        <span style="color:#75715e">/**
</span><span style="color:#75715e">         * @param args
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[</span><span style="color:#f92672">]</span> args<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">//unZipShared(&#34;e:\\test\\test.zip&#34;);
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//unZipShared(&#34;e:\\test\\test1.zip&#34;);
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//rar暂时无法解压出来，但是zip文件是可以的
</span><span style="color:#75715e"></span>                unZipShared<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;e:\\test\\test1.zip&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;e:\\testOutput&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *   解压缩 zip文件，只能限制为rar
</span><span style="color:#75715e">         * @param zipName        待解压的zip文件
</span><span style="color:#75715e">         * @param outputfolder   解压zip文件到outputFoler文件夹下
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unZipShared</span><span style="color:#f92672">(</span>String zipName<span style="color:#f92672">,</span>String outputfolder<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                File gtkDir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputfolder<span style="color:#f92672">)</span><span style="color:#f92672">;</span><span style="color:#75715e">// *.dll放的文件夹
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">!</span>gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdirs</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                InputStream inStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        inStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span>  FileInputStream<span style="color:#f92672">(</span>zipName<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e1<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e1<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#75715e">//InputStream inStream = Utils.class.getResourceAsStream(&#34;/gtkshare.zip&#34;);
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>inStream <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsatisfiedLinkError<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;没找到&#34;</span><span style="color:#f92672">+</span>zipName<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>                        
                        unZip<span style="color:#f92672">(</span>inStream<span style="color:#f92672">,</span> gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">err</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;解压缩gtkshare.zip失败&#34;</span> <span style="color:#f92672">+</span> toFullString<span style="color:#f92672">(</span>e<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">/**
</span><span style="color:#75715e">         * 把streamToZip这个zip文件流解压到硬盘的destDir文件夹，支持多级目录
</span><span style="color:#75715e">         * @param streamToZip
</span><span style="color:#75715e">         * @param destDir
</span><span style="color:#75715e">         * @throws IOException
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unZip</span><span style="color:#f92672">(</span>InputStream streamToZip<span style="color:#f92672">,</span>String destDir<span style="color:#f92672">)</span><span style="color:#66d9ef">throws</span> IOException
        <span style="color:#f92672">{</span>  
                ZipInputStream zipStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipInputStream<span style="color:#f92672">(</span>streamToZip<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        ZipEntry zipEntry <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                        <span style="color:#75715e">//通过zipEntry方式支持多级目录
</span><span style="color:#75715e"></span>                        <span style="color:#66d9ef">while</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">=</span>zipStream<span style="color:#f92672">.</span><span style="color:#a6e22e">getNextEntry</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">!</span><span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                File dir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>destDir<span style="color:#f92672">,</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span><span style="color:#f92672">!</span>dir<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        dir<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdirs</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">else</span>
        <span style="color:#f92672">{</span>
                FileOutputStream fileOutStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>destDir<span style="color:#f92672">,</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        copy<span style="color:#f92672">(</span>zipStream<span style="color:#f92672">,</span> fileOutStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">finally</span>
                <span style="color:#f92672">{</span>
                        close<span style="color:#f92672">(</span>fileOutStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">finally</span>
                <span style="color:#f92672">{</span>
                        close<span style="color:#f92672">(</span>zipStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                
    <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     从zip文件包中拷贝文件
</span><span style="color:#75715e">         * @param inStream       zipEntry的某个文件
</span><span style="color:#75715e">         * @param outStream      输出的某个文件流
</span><span style="color:#75715e">         * @throws IOException
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>InputStream inStream<span style="color:#f92672">,</span> OutputStream outStream<span style="color:#f92672">)</span>
                        <span style="color:#66d9ef">throws</span> IOException
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>512 <span style="color:#f92672">*</span> 1024<span style="color:#f92672">]</span><span style="color:#f92672">;</span><span style="color:#75715e">// 0.5MB 的缓冲区
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">int</span> len<span style="color:#f92672">;</span>
                <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>len <span style="color:#f92672">=</span> inStream<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>buffer<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">&gt;</span><span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        outStream<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> len<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *    摘自rupeng.gtk4j   不明白具体的作用    非主要问题
</span><span style="color:#75715e">         * @param throwable
</span><span style="color:#75715e">         * @return
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">toFullString</span><span style="color:#f92672">(</span>Throwable throwable<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                StringWriter sw <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                PrintWriter pw <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        sw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringWriter<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        pw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PrintWriter<span style="color:#f92672">(</span>sw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        throwable<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span>pw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">return</span> sw<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span>
                <span style="color:#f92672">{</span>
                        close<span style="color:#f92672">(</span>sw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        close<span style="color:#f92672">(</span>pw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     让文件流安静的关闭
</span><span style="color:#75715e">         * @param closeable   关闭接口
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">close</span><span style="color:#f92672">(</span>Closeable closeable<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>closeable <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                closeable<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>

                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>


<span style="color:#f92672">}</span>
</code></pre></div><p>2：后来想着有解压缩，必然也是有着压缩，于是就摆了一下，参考了一篇百度知道文章
2.1 首先加入了zip的方法
2.2 改进了zip方法的文件压缩流的写入过程，利用buffersize
2.3 常使用了文章中的加密过程，添加了加密压缩和加密解压缩的过程
2.4 想着实用命令流来进一步实现 压缩和解压缩的调用，后来弃用，改用封装一个OOZip类来实现</p>
<p>于是就有了下面的升级版的压缩和解压缩的程序：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> java.io.Closeable<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.File<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileInputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileNotFoundException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileOutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.IOException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.InputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.OutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.PrintWriter<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.StringWriter<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.InvalidAlgorithmParameterException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.InvalidKeyException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.NoSuchAlgorithmException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.spec.InvalidKeySpecException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.Random<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipEntry<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipInputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipOutputStream<span style="color:#f92672">;</span>

<span style="color:#f92672">import</span> javax.crypto.BadPaddingException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.Cipher<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.IllegalBlockSizeException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.NoSuchPaddingException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.SecretKey<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.SecretKeyFactory<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.interfaces.PBEKey<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.spec.PBEKeySpec<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.spec.PBEParameterSpec<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.spec.SecretKeySpec<span style="color:#f92672">;</span>


<span style="color:#75715e">/**
</span><span style="color:#75715e">* @author    叶昭良
</span><span style="color:#75715e">* @time      2015年2月12日下午5:22:31
</span><span style="color:#75715e">* @version   TestZipInputStreamUpdate V1.0  增加了压缩 
</span><span style="color:#75715e">*                              V2.0   ZipShared加入了 zosTemp.close(); 修复了 压缩的bug，删掉则无法压缩
</span><span style="color:#75715e">*                              V3.0   升级了ZipShared 使用了copy函数。
</span><span style="color:#75715e">*                              V4.0   增加了加密压缩 和解加密压缩
</span><span style="color:#75715e">*/</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestZipInputStreamUpdate</span>
<span style="color:#f92672">{</span>

        
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         * @param args
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String ALGORITHM <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PBEWithMD5AndDES&#34;</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[</span><span style="color:#f92672">]</span> args<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">// TODO Auto-generated method stub
</span><span style="color:#75715e"></span>                TestZipInputStreamUpdate tisu <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TestZipInputStreamUpdate<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//不需要再次加入zip文件后缀了
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//tisu.ZipShared(&#34;e://test1222bak&#34;,&#34;e://test1222&#34;);
</span><span style="color:#75715e"></span>                
                tisu<span style="color:#f92672">.</span><span style="color:#a6e22e">ZipSharedCrypto</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;e://test1222bak&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;e://test1222passwdByZhao.zip&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;123456&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                tisu<span style="color:#f92672">.</span><span style="color:#a6e22e">unzipCrypto</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;e://test1222passwdByZhao.zip&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;c://laoliang&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;123456&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//        tisu.unzipCrypto(&#34;e://test1222passwdByZhao.zip&#34;,&#34;c://laoliang&#34;,&#34;1234565&#34;);
</span><span style="color:#75715e"></span>                
                <span style="color:#75715e">/*
</span><span style="color:#75715e">                 *  你正在进入e:\test1222bak文件夹
</span><span style="color:#75715e">                        你正在进入e:\test1222bak\test1222文件夹
</span><span style="color:#75715e">                        你正在压缩a1.zip
</span><span style="color:#75715e">                        你正在压缩test123.txt
</span><span style="color:#75715e">                        你正在压缩test124.txt
</span><span style="color:#75715e">                        
</span><span style="color:#75715e">                        通过这个实验总结了：所有操作系统内部的文件都是文件，无论是普通的文件
</span><span style="color:#75715e">                        还是文件夹文件，还是管道文件，还是索引文件，还是设备文件，本质上都是
</span><span style="color:#75715e">                        文件，只不过是在文件的头上面增加了一些特殊的标记，比如说你需要在文件夹
</span><span style="color:#75715e">                        的路径增加一个\路径标志 反斜杠的道理是一样的。
</span><span style="color:#75715e">                 */</span>
                
                <span style="color:#75715e">/*  这是一个命令流的使用方式：：
</span><span style="color:#75715e">                 *         if(args.length==2){ 
</span><span style="color:#75715e">            String name = args[1]; 
</span><span style="color:#75715e">            Zip zip = new Zip(); 
</span><span style="color:#75715e">
</span><span style="color:#75715e">            if(args[0].equals(&#34;-zip&#34;)) 
</span><span style="color:#75715e">            {
</span><span style="color:#75715e">                    zipname = args[2];
</span><span style="color:#75715e">                    zip.doZip(name); 
</span><span style="color:#75715e">            }
</span><span style="color:#75715e">                
</span><span style="color:#75715e">            else if(args[0].equals(&#34;-unzip&#34;)) 
</span><span style="color:#75715e">            {
</span><span style="color:#75715e">                    outputfolder = args[2];
</span><span style="color:#75715e">                     zip.unZip(name);          
</span><span style="color:#75715e">            }     
</span><span style="color:#75715e">        } 
</span><span style="color:#75715e">        else{ 
</span><span style="color:#75715e">            System.out.println(&#34;Usage:&#34;); 
</span><span style="color:#75715e">            System.out.println(&#34;压缩:java Zip -zip directoryName  zipname&#34;); 
</span><span style="color:#75715e">            System.out.println(&#34;解压:java Zip -unzip fileName.zip outputfolder&#34;); 
</span><span style="color:#75715e">            throw new Exception(&#34;Arguments error!&#34;); 
</span><span style="color:#75715e">        } 
</span><span style="color:#75715e">                 */</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipShared</span><span style="color:#f92672">(</span>String fileinput<span style="color:#f92672">,</span>String zos<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">//加入&#34;zip&#34;后缀！
</span><span style="color:#75715e"></span>                        ZipOutputStream zosTemp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>zos<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;zip&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        File fApple <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        ZipShared<span style="color:#f92672">(</span>fApple<span style="color:#f92672">,</span>zosTemp<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                <span style="color:#75715e">/// 为什么加入这个就可以？？？？
</span><span style="color:#75715e"></span>                                <span style="color:#75715e">//  不加入这有异常？？？？why   Tell me 
</span><span style="color:#75715e"></span>                                zosTemp<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>
                                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipShared</span><span style="color:#f92672">(</span>File fileinput<span style="color:#f92672">,</span>ZipOutputStream zos<span style="color:#f92672">,</span>String base<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">//ZipOutputStream zos = new ZipOutputStream(new FileOutputStream(outputZipName));
</span><span style="color:#75715e"></span>                
                <span style="color:#75715e">//File fileinput = new File(outputZipName);
</span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在进入&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        File<span style="color:#f92672">[</span><span style="color:#f92672">]</span> fBanana <span style="color:#f92672">=</span> fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">listFiles</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">//传进一个文件夹标志
</span><span style="color:#75715e"></span>                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//让base加上一个/
</span><span style="color:#75715e"></span>                base <span style="color:#f92672">=</span> base<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">=</span><span style="color:#f92672">=</span>0<span style="color:#f92672">?</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">:</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> fBanana<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        ZipShared<span style="color:#f92672">(</span>fBanana<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">,</span>zos<span style="color:#f92672">,</span>base<span style="color:#f92672">+</span>fBanana<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;压缩文件夹失败&#34;</span><span style="color:#f92672">+</span>e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        
<span style="color:#f92672">}</span><span style="color:#66d9ef">else</span>
<span style="color:#f92672">{</span>
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                FileInputStream fis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//改进写入的方式
</span><span style="color:#75715e"></span>                <span style="color:#75715e">/*int b;
</span><span style="color:#75715e">                while((b = fis.read())!= -1)
</span><span style="color:#75715e">                {
</span><span style="color:#75715e">                        zos.write(b); 
</span><span style="color:#75715e">                        //效率很定不高  每一个字符  进行一次缓冲
</span><span style="color:#75715e">                        //zos.flush();
</span><span style="color:#75715e">                }*/</span>
                copy<span style="color:#f92672">(</span>fis<span style="color:#f92672">,</span>zos<span style="color:#f92672">)</span><span style="color:#f92672">;</span> <span style="color:#75715e">//利用汝鹏版的copy函数
</span><span style="color:#75715e"></span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在压缩&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//fis.close();
</span><span style="color:#75715e"></span>                
                <span style="color:#75715e">//zos.close();
</span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;压缩文件失败&#34;</span><span style="color:#f92672">+</span>e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> 
        <span style="color:#75715e">//为什么加入则错误
</span><span style="color:#75715e"></span>        <span style="color:#75715e">/*finally
</span><span style="color:#75715e">        {
</span><span style="color:#75715e">                try
</span><span style="color:#75715e">                {
</span><span style="color:#75715e">                        zos.close();
</span><span style="color:#75715e">                }catch(IOException e)
</span><span style="color:#75715e">                {
</span><span style="color:#75715e">                        System.out.println(&#34;打开流错误！&#34;);
</span><span style="color:#75715e">                }
</span><span style="color:#75715e">        }*/</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipSharedCrypto</span><span style="color:#f92672">(</span>String fileinput<span style="color:#f92672">,</span>String zosFile<span style="color:#f92672">,</span>String pwd<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>        File f1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//采用和ZipShared一样的FileOutputStream
</span><span style="color:#75715e"></span>                        ZipOutputStream zos  <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                        zos <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>zosFile<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        ZipSharedCrypto<span style="color:#f92672">(</span>f1<span style="color:#f92672">,</span>zos<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">,</span> pwd<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>
                                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;成了&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipSharedCrypto</span><span style="color:#f92672">(</span>File fileinput<span style="color:#f92672">,</span>ZipOutputStream zos<span style="color:#f92672">,</span>String base<span style="color:#f92672">,</span>String pwd<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
<span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在进入&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
File<span style="color:#f92672">[</span><span style="color:#f92672">]</span> fApples <span style="color:#f92672">=</span> fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">listFiles</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#75715e">//因为ZipEntry的isDirectory()方法中，目录以&#34;/&#34;结尾
</span><span style="color:#75715e"></span><span style="color:#66d9ef">try</span>
<span style="color:#f92672">{</span>        
        zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        base <span style="color:#f92672">=</span> base<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">=</span><span style="color:#f92672">=</span>0<span style="color:#f92672">?</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">:</span><span style="color:#f92672">(</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//一种比较新型的方式循环读写东西。
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>File ftemp<span style="color:#f92672">:</span>fApples<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                ZipSharedCrypto<span style="color:#f92672">(</span>ftemp<span style="color:#f92672">,</span>zos<span style="color:#f92672">,</span>base<span style="color:#f92672">+</span>ftemp<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>pwd<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span><span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;文件夹加密压缩失败&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span><span style="color:#66d9ef">else</span>
<span style="color:#f92672">{</span>        
        
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                FileInputStream fis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在开始加密压缩&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        PBEKeySpec keySpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEKeySpec<span style="color:#f92672">(</span>pwd<span style="color:#f92672">.</span><span style="color:#a6e22e">toCharArray</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        SecretKeyFactory keyFactory <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                keyFactory <span style="color:#f92672">=</span> SecretKeyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NoSuchAlgorithmException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        SecretKey passwordKey <span style="color:#f92672">=</span> keyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">generateSecret</span><span style="color:#f92672">(</span>keySpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//生成一个炸弹 进行加密
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> bomb <span style="color:#f92672">=</span>  <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
        Random rnd <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Random<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        rnd<span style="color:#f92672">.</span><span style="color:#a6e22e">nextBytes</span><span style="color:#f92672">(</span>bomb<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> iterations <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>
        PBEParameterSpec parameterSpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEParameterSpec<span style="color:#f92672">(</span>bomb<span style="color:#f92672">,</span> iterations<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        Cipher cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                cipher <span style="color:#f92672">=</span> Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NoSuchAlgorithmException
                        <span style="color:#f92672">|</span> NoSuchPaddingException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">init</span><span style="color:#f92672">(</span>Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">ENCRYPT_MODE</span><span style="color:#f92672">,</span> passwordKey<span style="color:#f92672">,</span>parameterSpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//往输出流 添加炸弹
</span><span style="color:#75715e"></span>        zos<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>bomb<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        
        <span style="color:#75715e">//添加加密的主文件内容  1KB缓存区
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> inputBuffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>1024<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> bytesRead <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
        <span style="color:#75715e">//如果没有读到信息则为-1
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span>bytesRead <span style="color:#f92672">=</span> fis<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>inputBuffer<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">//每个缓冲区 进行加密写入
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> output <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">update</span><span style="color:#f92672">(</span>inputBuffer<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>output <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        zos<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>output<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        
        <span style="color:#75715e">//加密结束语
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> outputFinal <span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                outputFinal <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">doFinal</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IllegalBlockSizeException <span style="color:#f92672">|</span> BadPaddingException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>outputFinal <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>outputFinal<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        
<span style="color:#75715e">/*        fis.close();
</span><span style="color:#75715e">        zos.flush();
</span><span style="color:#75715e">        zos.close();*/</span>
        
        
<span style="color:#f92672">}</span><span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>InvalidKeySpecException <span style="color:#f92672">|</span> InvalidKeyException <span style="color:#f92672">|</span> InvalidAlgorithmParameterException <span style="color:#f92672">|</span> IOException e<span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;加密失败&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *   解压缩 zip文件，只能限制为rar
</span><span style="color:#75715e">         * @param zipName        待解压的zip文件
</span><span style="color:#75715e">         * @param outputfolder   解压zip文件到outputFoler文件夹下
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unZipShared</span><span style="color:#f92672">(</span>String zipName<span style="color:#f92672">,</span>String outputfolder<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                File gtkDir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputfolder<span style="color:#f92672">)</span><span style="color:#f92672">;</span><span style="color:#75715e">// *.dll放的文件夹
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//指定的目录不存在  则创建之
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">!</span>gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdirs</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                InputStream inStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        inStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span>  FileInputStream<span style="color:#f92672">(</span>zipName<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e1<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e1<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#75715e">//InputStream inStream = Utils.class.getResourceAsStream(&#34;/gtkshare.zip&#34;);
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>inStream <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsatisfiedLinkError<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;没找到&#34;</span><span style="color:#f92672">+</span>zipName<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>                        
                        unZip<span style="color:#f92672">(</span>inStream<span style="color:#f92672">,</span> gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">err</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;解压缩gtkshare.zip失败&#34;</span> <span style="color:#f92672">+</span> toFullString<span style="color:#f92672">(</span>e<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">/**
</span><span style="color:#75715e">         * 把streamToZip这个zip文件流解压到硬盘的destDir文件夹，支持多级目录
</span><span style="color:#75715e">         * @param streamToZip
</span><span style="color:#75715e">         * @param destDir
</span><span style="color:#75715e">         * @throws IOException
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unZip</span><span style="color:#f92672">(</span>InputStream streamToZip<span style="color:#f92672">,</span>String destDir<span style="color:#f92672">)</span><span style="color:#66d9ef">throws</span> IOException
        <span style="color:#f92672">{</span>  
                ZipInputStream zipStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipInputStream<span style="color:#f92672">(</span>streamToZip<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        ZipEntry zipEntry <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                        <span style="color:#75715e">//通过zipEntry方式支持多级目录
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">=</span>zipStream<span style="color:#f92672">.</span><span style="color:#a6e22e">getNextEntry</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">!</span><span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在创建文件夹文件 比较特殊&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        File dir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>destDir<span style="color:#f92672">,</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#75715e">//如果指定的目录不存在 则创建之
</span><span style="color:#75715e"></span>                        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span><span style="color:#f92672">!</span>dir<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>
                                dir<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdirs</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">else</span>
                <span style="color:#f92672">{</span>
                        FileOutputStream fileOutStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>destDir<span style="color:#f92672">,</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                copy<span style="color:#f92672">(</span>zipStream<span style="color:#f92672">,</span> fileOutStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                        <span style="color:#66d9ef">finally</span>
                        <span style="color:#f92672">{</span>
                                close<span style="color:#f92672">(</span>fileOutStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在解压缩压缩&#34;</span><span style="color:#f92672">+</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">finally</span>
<span style="color:#f92672">{</span>
        close<span style="color:#f92672">(</span>zipStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
                
    <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     从zip文件包中拷贝文件 ，按照0.5MB的缓冲写入文件(默认方式）
</span><span style="color:#75715e">         * @param inStream       zipEntry的某个文件
</span><span style="color:#75715e">         * @param outStream      输出的某个文件流
</span><span style="color:#75715e">         * @throws IOException
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>InputStream inStream<span style="color:#f92672">,</span> OutputStream outStream<span style="color:#f92672">)</span>
                        <span style="color:#66d9ef">throws</span> IOException
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>512 <span style="color:#f92672">*</span> 1024<span style="color:#f92672">]</span><span style="color:#f92672">;</span><span style="color:#75715e">// 0.5MB 的缓冲区
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">int</span> len<span style="color:#f92672">;</span>
                <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>len <span style="color:#f92672">=</span> inStream<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>buffer<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">&gt;</span><span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        outStream<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> len<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *    摘自rupeng.gtk4j   不明白具体的作用    非主要问题
</span><span style="color:#75715e">         * @param throwable
</span><span style="color:#75715e">         * @return
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">toFullString</span><span style="color:#f92672">(</span>Throwable throwable<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                StringWriter sw <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                PrintWriter pw <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        sw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringWriter<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        pw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PrintWriter<span style="color:#f92672">(</span>sw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        throwable<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span>pw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">return</span> sw<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span>
                <span style="color:#f92672">{</span>
                        close<span style="color:#f92672">(</span>sw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        close<span style="color:#f92672">(</span>pw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     让文件流安静的关闭
</span><span style="color:#75715e">         * @param closeable   关闭接口
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">close</span><span style="color:#f92672">(</span>Closeable closeable<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>closeable <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                closeable<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>

                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        
        <span style="color:#75715e">// 加密解压缩
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/**
</span><span style="color:#75715e">         * 功能描述：将压缩文件解压到指定的文件目录下
</span><span style="color:#75715e">         * @param zipFileName      压缩文件名称(带路径)
</span><span style="color:#75715e">         * @param outputDirectory  指定解压目录
</span><span style="color:#75715e">         * @return
</span><span style="color:#75715e">         * @throws Exception
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unzipCrypto</span><span style="color:#f92672">(</span>String zipFileName<span style="color:#f92672">,</span> String outputDirectory<span style="color:#f92672">,</span> String pwd<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                ZipInputStream inputStream<span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        inputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>zipFileName<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        unzipCrypto<span style="color:#f92672">(</span>inputStream<span style="color:#f92672">,</span> outputDirectory<span style="color:#f92672">,</span> pwd<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                
        <span style="color:#f92672">}</span>


        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unzipCrypto</span><span style="color:#f92672">(</span>ZipInputStream inputStream<span style="color:#f92672">,</span> String outputDirectory<span style="color:#f92672">,</span> String pwd<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception
        <span style="color:#f92672">{</span>
                ZipEntry zipEntry <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                FileOutputStream outputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span><span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>zipEntry <span style="color:#f92672">=</span> inputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">getNextEntry</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> 
                        <span style="color:#f92672">{</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在进入&#34;</span><span style="color:#f92672">+</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        String name <span style="color:#f92672">=</span> zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        name <span style="color:#f92672">=</span> name<span style="color:#f92672">.</span><span style="color:#a6e22e">substring</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> name<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">-</span> 1<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        File file <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputDirectory <span style="color:#f92672">+</span> File<span style="color:#f92672">.</span><span style="color:#a6e22e">separator</span> <span style="color:#f92672">+</span> name<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        file<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdir</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span> 
<span style="color:#66d9ef">else</span> 
<span style="color:#f92672">{</span>
        File file <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputDirectory <span style="color:#f92672">+</span> File<span style="color:#f92672">.</span><span style="color:#a6e22e">separator</span> <span style="color:#f92672">+</span> zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        file<span style="color:#f92672">.</span><span style="color:#a6e22e">createNewFile</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        outputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>file<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在解压缩&#34;</span><span style="color:#f92672">+</span>file<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        PBEKeySpec keySpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEKeySpec<span style="color:#f92672">(</span>pwd<span style="color:#f92672">.</span><span style="color:#a6e22e">toCharArray</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    SecretKeyFactory keyFactory <span style="color:#f92672">=</span> SecretKeyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    SecretKey passwordKey <span style="color:#f92672">=</span> keyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">generateSecret</span><span style="color:#f92672">(</span>keySpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> salt <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
    inputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>salt<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">int</span> iterations <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>
    PBEParameterSpec parameterSpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEParameterSpec<span style="color:#f92672">(</span>salt<span style="color:#f92672">,</span> iterations<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Cipher cipher <span style="color:#f92672">=</span> Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">init</span><span style="color:#f92672">(</span>Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">DECRYPT_MODE</span><span style="color:#f92672">,</span> passwordKey<span style="color:#f92672">,</span> parameterSpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> input <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>1024<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">int</span> bytesRead<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>bytesRead <span style="color:#f92672">=</span> inputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>input<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span> 
    <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> output <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">update</span><span style="color:#f92672">(</span>input<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> bytesRead<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>output <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
            <span style="color:#f92672">{</span>
                    outputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>output<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> output <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">doFinal</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>output <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
            outputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>output<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#75715e">/*                                    outputStream.flush();
</span><span style="color:#75715e">                                    outputStream.close();*/</span>
        
<span style="color:#f92672">}</span>
                        <span style="color:#f92672">}</span>
                        <span style="color:#75715e">//inputStream.close();
</span><span style="color:#75715e"></span>                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>IOException ex<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Exception<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;解压读取文件失败&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Exception<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;解压文件密码不正确&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
<span style="color:#75715e">/*                finally
</span><span style="color:#75715e">                {
</span><span style="color:#75715e">                        inputStream.close();
</span><span style="color:#75715e">                        outputStream.flush();
</span><span style="color:#75715e">                    outputStream.close();
</span><span style="color:#75715e">                }*/</span>
        <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><p>3：进一步 实现先前的想法，封装一个OOZip类，
基本思想：
1：抽取常用变量，比如bufferSize 缓冲区大小     buf缓冲区； 本想着加入压缩和解压缩的流变量，后来删掉了
2：定义构造函数， 设置缓冲区大小
3：复制之前的方法，并利用buffersize和buf改写copy函数和 文件的复制的函数
4：进行简单地压缩和解压缩文件夹      加密压缩和解加密压缩文件夹   的测试。 并找到了压缩单个文件的bug
5：bug修复</p>
<p>完整代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> java.io.Closeable<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.File<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileInputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileNotFoundException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.FileOutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.IOException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.InputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.OutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.PrintWriter<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.StringWriter<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.InvalidAlgorithmParameterException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.InvalidKeyException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.NoSuchAlgorithmException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.security.spec.InvalidKeySpecException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.Random<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipEntry<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipInputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.zip.ZipOutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.BadPaddingException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.Cipher<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.IllegalBlockSizeException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.NoSuchPaddingException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.SecretKey<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.SecretKeyFactory<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.spec.PBEKeySpec<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.spec.PBEParameterSpec<span style="color:#f92672">;</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e">* @author    叶昭良
</span><span style="color:#75715e">* @time      2015年2月12日下午9:51:11
</span><span style="color:#75715e">* @version   OOZip    用于压缩和解压缩
</span><span style="color:#75715e">*                   V1.0  增加了压缩 
</span><span style="color:#75715e">*                   V2.0   ZipShared加入了 zosTemp.close(); 修复了 压缩的bug
</span><span style="color:#75715e">*                   V3.0   改进了构造函数 利用具有缓冲区的压缩
</span><span style="color:#75715e">*                   V4.0   升级了ZipShared 使用了copy函数。
</span><span style="color:#75715e">*                   V5.0   增加了加密压缩 和解加密压缩
</span><span style="color:#75715e">*                   V6.0   改用了面向对象方式修改了一番
</span><span style="color:#75715e">*                   V7.0   加入了一些压缩和解压缩完成的的console标记
</span><span style="color:#75715e">*                   V8.0   修复了单个文件无法加密的bug   new ZipEntry(base) 改为
</span><span style="color:#75715e">*                    new ZipEntry(base+fileinput.getName())，未添入到zipentry的缘故
</span><span style="color:#75715e">*                    而若是文件夹遍历的时候则是有加入文件名的标记！所以在单个文件的时候也需要加入文件名的
</span><span style="color:#75715e">*                    标记
</span><span style="color:#75715e">*                   V9.0   若有中文问题，可以进一步采用import org.apache.tools.zip.* 的zip包！ 更好的支持中文
</span><span style="color:#75715e">*                          具体参看http://blog.csdn.net/liu149339750/article/details/7887701  
</span><span style="color:#75715e">*                                 http://szhnet.iteye.com/blog/199059 ，这个链接当中提供了ant版本 
</span><span style="color:#75715e">*                          当然此版本，不需要org.apache.tool.zip包也不需要ant包  附录了ant版本的代码，的确看起来
</span><span style="color:#75715e">*                          是简单的。
</span><span style="color:#75715e">*/</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OOZip</span>
<span style="color:#f92672">{</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e">*  这几个私有变量的控制，主要体现在针对具体的文件的复制过程中
</span><span style="color:#75715e">*/</span>
        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> bufSize <span style="color:#f92672">;</span> <span style="color:#75715e">//压缩和解压缩会用到。 一次从压缩文件zip读取多少文件信息
</span><span style="color:#75715e"></span>                                                                 <span style="color:#75715e">//或者一次写入多少文件信息到压缩流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> buf<span style="color:#f92672">;</span>   <span style="color:#75715e">//写入或者写出压缩流的字节数组
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> readBytes <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>  <span style="color:#75715e">//实际写入或者写出文件流的大小。
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String ALGORITHM <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PBEWithMD5AndDES&#34;</span><span style="color:#f92672">;</span>
        
        <span style="color:#75715e">//构造函数的定义
</span><span style="color:#75715e"></span>   <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">OOZip</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span> 
           <span style="color:#75715e">// 1025*512  //设置输入输出流的缓冲区的大小 ，统一设置
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">(</span>1024<span style="color:#f92672">*</span>512<span style="color:#f92672">)</span><span style="color:#f92672">;</span> 
    <span style="color:#f92672">}</span> 

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">OOZip</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> bufSize<span style="color:#f92672">)</span><span style="color:#f92672">{</span> 
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">bufSize</span> <span style="color:#f92672">=</span> bufSize<span style="color:#f92672">;</span> 
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buf</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">bufSize</span><span style="color:#f92672">]</span><span style="color:#f92672">;</span> 
    <span style="color:#f92672">}</span> 
        
        <span style="color:#75715e">//常用的类中 内部函数
</span><span style="color:#75715e"></span>        
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[</span><span style="color:#f92672">]</span> args<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">// TODO Auto-generated method stub
</span><span style="color:#75715e"></span>                OOZip oz <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> OOZip<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//单个文件加密和非加密测试暂时失败
</span><span style="color:#75715e"></span>                oz<span style="color:#f92672">.</span><span style="color:#a6e22e">ZipShared</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;e://student.txt&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;e://laoliang&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span> 
                <span style="color:#75715e">//oz.ZipSharedCrypto(&#34;e://student.txt&#34;, &#34;e://laoliang&#34;,&#34;1234&#34;);
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//输入文件夹路径则加密和非加密测试通过
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//oz.ZipShared(&#34;e://test1222bak&#34;, &#34;e://laoliang&#34;);  //已测试通过
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//oz.ZipSharedCrypto(&#34;e://test1222bak&#34;, &#34;e://laoliang&#34;, &#34;123456&#34;);
</span><span style="color:#75715e"></span>                
                <span style="color:#75715e">//解压缩，不用输入.zip后缀，只需要输入文件名
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//oz.unzipCrypto(&#34;e://laoliang&#34;, &#34;c://laozi&#34;,&#34;123456&#34;);
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//测试成功
</span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span>

        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     压缩名字为fileinput变量内容的文件夹
</span><span style="color:#75715e">         * @param fileinput   文件夹名字
</span><span style="color:#75715e">         * @param zos         zip文件夹名字
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipShared</span><span style="color:#f92672">(</span>String fileinput<span style="color:#f92672">,</span>String zos<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">//加入&#34;zip&#34;后缀！
</span><span style="color:#75715e"></span>                        ZipOutputStream zosTemp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>zos<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        File fApple <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        ZipShared<span style="color:#f92672">(</span>fApple<span style="color:#f92672">,</span>zosTemp<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                <span style="color:#75715e">/// 为什么加入这个就可以？？？？
</span><span style="color:#75715e"></span>                                <span style="color:#75715e">//  不加入这有异常？？？？why   Tell me 
</span><span style="color:#75715e"></span>                                zosTemp<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>
                                <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;success to create&#34;</span><span style="color:#f92672">+</span>zos<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     压缩文件夹的中间函数
</span><span style="color:#75715e">         * @param fileinput    输入函数的文件对象
</span><span style="color:#75715e">         * @param zos          压缩输出流对象
</span><span style="color:#75715e">         * @param base         一般是&#34;&#34; 表示子目录的作用，在递归目录的时候会用到，在文件夹递归中，涉及到改变；
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipShared</span><span style="color:#f92672">(</span>File fileinput<span style="color:#f92672">,</span>ZipOutputStream zos<span style="color:#f92672">,</span>String base<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
<span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在进入&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        File<span style="color:#f92672">[</span><span style="color:#f92672">]</span> fBanana <span style="color:#f92672">=</span> fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">listFiles</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">//传进一个文件夹标志
</span><span style="color:#75715e"></span>                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//让base加上一个/
</span><span style="color:#75715e"></span>                base <span style="color:#f92672">=</span> base<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">=</span><span style="color:#f92672">=</span>0<span style="color:#f92672">?</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">:</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> fBanana<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        ZipShared<span style="color:#f92672">(</span>fBanana<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">,</span>zos<span style="color:#f92672">,</span>base<span style="color:#f92672">+</span>fBanana<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;压缩文件夹失败&#34;</span><span style="color:#f92672">+</span>e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        
<span style="color:#f92672">}</span><span style="color:#66d9ef">else</span>
<span style="color:#f92672">{</span>
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">+</span>fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                FileInputStream fis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//改进写入的方式
</span><span style="color:#75715e"></span>                <span style="color:#75715e">/*int b;
</span><span style="color:#75715e">                while((b = fis.read())!= -1)
</span><span style="color:#75715e">                {
</span><span style="color:#75715e">                        zos.write(b); 
</span><span style="color:#75715e">                        //效率很定不高  每一个字符  进行一次缓冲
</span><span style="color:#75715e">                        //zos.flush();
</span><span style="color:#75715e">                }*/</span>
                copy<span style="color:#f92672">(</span>fis<span style="color:#f92672">,</span>zos<span style="color:#f92672">)</span><span style="color:#f92672">;</span> <span style="color:#75715e">//利用汝鹏版的copy函数
</span><span style="color:#75715e"></span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在压缩&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;压缩文件失败&#34;</span><span style="color:#f92672">+</span>e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> 
<span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     加密压缩文件夹
</span><span style="color:#75715e">         * @param fileinput    文件夹字符串
</span><span style="color:#75715e">         * @param zosFile      压缩字符串名字
</span><span style="color:#75715e">         * @param pwd          加密的密码
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipSharedCrypto</span><span style="color:#f92672">(</span>String fileinput<span style="color:#f92672">,</span>String zosFile<span style="color:#f92672">,</span>String pwd<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>        
                        File f1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#75715e">//采用和ZipShared一样的FileOutputStream
</span><span style="color:#75715e"></span>                        ZipOutputStream zos  <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                        zos <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>zosFile<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        ZipSharedCrypto<span style="color:#f92672">(</span>f1<span style="color:#f92672">,</span>zos<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">,</span> pwd<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>
                                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;未找到文件&#34;</span><span style="color:#f92672">+</span>e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;success to create crypto &#34;</span><span style="color:#f92672">+</span>zosFile<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *          加密压缩文件夹     
</span><span style="color:#75715e">         * @param fileinput     压缩文件夹的File对象
</span><span style="color:#75715e">         * @param zos           zip压缩输出流ZipOutputStream
</span><span style="color:#75715e">         * @param base          一般是&#34;&#34;
</span><span style="color:#75715e">         * @param pwd           压缩的密码
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ZipSharedCrypto</span><span style="color:#f92672">(</span>File fileinput<span style="color:#f92672">,</span>ZipOutputStream zos<span style="color:#f92672">,</span>String base<span style="color:#f92672">,</span>String pwd<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
<span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在进入&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        File<span style="color:#f92672">[</span><span style="color:#f92672">]</span> fApples <span style="color:#f92672">=</span> fileinput<span style="color:#f92672">.</span><span style="color:#a6e22e">listFiles</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//因为ZipEntry的isDirectory()方法中，目录以&#34;/&#34;结尾
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>        
                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                base <span style="color:#f92672">=</span> base<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">=</span><span style="color:#f92672">=</span>0<span style="color:#f92672">?</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">:</span><span style="color:#f92672">(</span>base<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//一种比较新型的方式循环读写东西。
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>File ftemp<span style="color:#f92672">:</span>fApples<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        ZipSharedCrypto<span style="color:#f92672">(</span>ftemp<span style="color:#f92672">,</span>zos<span style="color:#f92672">,</span>base<span style="color:#f92672">+</span>ftemp<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>pwd<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;文件夹加密压缩失败&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span><span style="color:#66d9ef">else</span>
<span style="color:#f92672">{</span>        
        
        <span style="color:#66d9ef">try</span>
        <span style="color:#f92672">{</span>
                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">putNextEntry</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ZipEntry<span style="color:#f92672">(</span>base<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                FileInputStream fis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>fileinput<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在开始加密压缩&#34;</span><span style="color:#f92672">+</span>fileinput<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//加密过程的开始
</span><span style="color:#75715e"></span>                PBEKeySpec keySpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEKeySpec<span style="color:#f92672">(</span>pwd<span style="color:#f92672">.</span><span style="color:#a6e22e">toCharArray</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                SecretKeyFactory keyFactory <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        keyFactory <span style="color:#f92672">=</span> SecretKeyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NoSuchAlgorithmException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                SecretKey passwordKey <span style="color:#f92672">=</span> keyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">generateSecret</span><span style="color:#f92672">(</span>keySpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//生成一个炸弹 进行加密
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> bomb <span style="color:#f92672">=</span>  <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
                Random rnd <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Random<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                rnd<span style="color:#f92672">.</span><span style="color:#a6e22e">nextBytes</span><span style="color:#f92672">(</span>bomb<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">int</span> iterations <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>
                PBEParameterSpec parameterSpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEParameterSpec<span style="color:#f92672">(</span>bomb<span style="color:#f92672">,</span> iterations<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                Cipher cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        cipher <span style="color:#f92672">=</span> Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NoSuchAlgorithmException
                                <span style="color:#f92672">|</span> NoSuchPaddingException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">init</span><span style="color:#f92672">(</span>Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">ENCRYPT_MODE</span><span style="color:#f92672">,</span> passwordKey<span style="color:#f92672">,</span>parameterSpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//往输出流 添加炸弹
</span><span style="color:#75715e"></span>                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>bomb<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                
                <span style="color:#75715e">//添加加密的主文件内容  1KB缓存区
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//byte[] inputBuffer = new byte[1024];
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//int bytesRead = 0;
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//如果没有读到信息则为-1
</span><span style="color:#75715e"></span>                
                <span style="color:#75715e">//改用 readBytes  buf在类头定义的私有变量，进行统一的buffer缓存区大小的控制
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">while</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readBytes</span> <span style="color:#f92672">=</span> fis<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buf</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">//每个缓冲区 进行加密写入
</span><span style="color:#75715e"></span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> output <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">update</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buf</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>output <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>
                                zos<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>output<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
                
                <span style="color:#75715e">//加密结束语-------------加密结束
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> outputFinal <span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        outputFinal <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">doFinal</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IllegalBlockSizeException <span style="color:#f92672">|</span> BadPaddingException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>outputFinal <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        zos<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>outputFinal<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>        
        <span style="color:#f92672">}</span><span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>InvalidKeySpecException <span style="color:#f92672">|</span> InvalidKeyException <span style="color:#f92672">|</span> InvalidAlgorithmParameterException <span style="color:#f92672">|</span> IOException e<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;加密失败&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *   解压缩 zip文件，只能限制为zip ,rar无法进行，利用如鹏版的
</span><span style="color:#75715e">         * @param zipName        待解压的zip文件
</span><span style="color:#75715e">         * @param outputfolder   解压zip文件到outputFoler文件夹下
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unzip</span><span style="color:#f92672">(</span>String zipName<span style="color:#f92672">,</span>String outputfolder<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                File gtkDir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputfolder<span style="color:#f92672">)</span><span style="color:#f92672">;</span><span style="color:#75715e">// *.dll放的文件夹
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//指定的目录不存在  则创建之
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">!</span>gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdirs</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                InputStream inStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">//不用输入.zip后缀，只需要输入文件名
</span><span style="color:#75715e"></span>                        inStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span>  FileInputStream<span style="color:#f92672">(</span>zipName<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e1<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e1<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#75715e">//InputStream inStream = Utils.class.getResourceAsStream(&#34;/gtkshare.zip&#34;);
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>inStream <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsatisfiedLinkError<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;没找到&#34;</span><span style="color:#f92672">+</span>zipName<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>                        
                        unzip<span style="color:#f92672">(</span>inStream<span style="color:#f92672">,</span> gtkDir<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#75715e">//System.out.println(gtkDir.toString());
</span><span style="color:#75715e"></span>                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;成功解压缩&#34;</span><span style="color:#f92672">+</span>zipName<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件 到&#34;</span><span style="color:#f92672">+</span>outputfolder<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹下&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        System<span style="color:#f92672">.</span><span style="color:#a6e22e">err</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;解压缩&#34;</span><span style="color:#f92672">+</span>zipName<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip失败&#34;</span> <span style="color:#f92672">+</span> toFullString<span style="color:#f92672">(</span>e<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">/**
</span><span style="color:#75715e">         * 把streamToZip这个zip文件流解压到硬盘的destDir文件夹，支持多级目录
</span><span style="color:#75715e">         * @param streamToZip
</span><span style="color:#75715e">         * @param destDir
</span><span style="color:#75715e">         * @throws IOException
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unzip</span><span style="color:#f92672">(</span>InputStream streamToZip<span style="color:#f92672">,</span>String destDir<span style="color:#f92672">)</span><span style="color:#66d9ef">throws</span> IOException
        <span style="color:#f92672">{</span>  
                ZipInputStream zipStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipInputStream<span style="color:#f92672">(</span>streamToZip<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#66d9ef">try</span>
<span style="color:#f92672">{</span>
        ZipEntry zipEntry <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//通过zipEntry方式支持多级目录
</span><span style="color:#75715e"></span><span style="color:#66d9ef">while</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">=</span>zipStream<span style="color:#f92672">.</span><span style="color:#a6e22e">getNextEntry</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">!</span><span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在创建文件夹文件 比较特殊&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                File dir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>destDir<span style="color:#f92672">,</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//如果指定的目录不存在 则创建之
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span><span style="color:#f92672">!</span>dir<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        dir<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdirs</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">else</span>
        <span style="color:#f92672">{</span>
                FileOutputStream fileOutStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>destDir<span style="color:#f92672">,</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        copy<span style="color:#f92672">(</span>zipStream<span style="color:#f92672">,</span> fileOutStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">finally</span>
                <span style="color:#f92672">{</span>
                        close<span style="color:#f92672">(</span>fileOutStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在解压缩压缩&#34;</span><span style="color:#f92672">+</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">finally</span>
                <span style="color:#f92672">{</span>
                        close<span style="color:#f92672">(</span>zipStream<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                
    <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     从zip文件包中拷贝文件 ，按照0.5MB的缓冲写入文件(默认方式）
</span><span style="color:#75715e">         * @param inStream       zipEntry的某个文件
</span><span style="color:#75715e">         * @param outStream      输出的某个文件流
</span><span style="color:#75715e">         * @throws IOException
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>InputStream inStream<span style="color:#f92672">,</span> OutputStream outStream<span style="color:#f92672">)</span>
                        <span style="color:#66d9ef">throws</span> IOException
        <span style="color:#f92672">{</span>
                <span style="color:#75715e">//byte[] buffer = new byte[512 * 1024];// 0.5MB 的缓冲区
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//int len;
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readBytes</span> <span style="color:#f92672">=</span> inStream<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buf</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">&gt;</span><span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        outStream<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buf</span><span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readBytes</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *    摘自rupeng.gtk4j   不明白具体的作用    非主要问题
</span><span style="color:#75715e">         * @param throwable
</span><span style="color:#75715e">         * @return
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">toFullString</span><span style="color:#f92672">(</span>Throwable throwable<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                StringWriter sw <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                PrintWriter pw <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        sw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringWriter<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        pw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PrintWriter<span style="color:#f92672">(</span>sw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        throwable<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span>pw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">return</span> sw<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span>
                <span style="color:#f92672">{</span>
                        close<span style="color:#f92672">(</span>sw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        close<span style="color:#f92672">(</span>pw<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">/**
</span><span style="color:#75715e">         *     让文件流安静的关闭
</span><span style="color:#75715e">         * @param closeable   关闭接口
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">close</span><span style="color:#f92672">(</span>Closeable closeable<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>closeable <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">try</span>
                        <span style="color:#f92672">{</span>
                                closeable<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span>
                        <span style="color:#f92672">{</span>

                        <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        
        <span style="color:#75715e">// 加密解压缩
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/**
</span><span style="color:#75715e">         * 功能描述：将压缩文件解压到指定的文件目录下
</span><span style="color:#75715e">         * @param zipFileName      压缩文件名称(带路径)
</span><span style="color:#75715e">         * @param outputDirectory  指定解压目录
</span><span style="color:#75715e">         * @return
</span><span style="color:#75715e">         * @throws Exception
</span><span style="color:#75715e">         */</span>
        <span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unzipCrypto</span><span style="color:#f92672">(</span>String zipFileName<span style="color:#f92672">,</span> String outputDirectory<span style="color:#f92672">,</span> String pwd<span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                ZipInputStream inputStream<span style="color:#f92672">;</span>
                File outputDir<span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">//不用输入.zip后缀，只需要输入文件名
</span><span style="color:#75715e"></span>                        inputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ZipInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>zipFileName<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        outputDir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputDirectory<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        unzipCrypto<span style="color:#f92672">(</span>inputStream<span style="color:#f92672">,</span> outputDir<span style="color:#f92672">,</span> pwd<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// TODO Auto-generated catch block
</span><span style="color:#75715e"></span>                        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;成功解压缩&#34;</span><span style="color:#f92672">+</span>zipFileName<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.zip&#34;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件 到&#34;</span><span style="color:#f92672">+</span>outputDirectory<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹下&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                
        <span style="color:#f92672">}</span>


        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unzipCrypto</span><span style="color:#f92672">(</span>ZipInputStream inputStream<span style="color:#f92672">,</span> File outputDir<span style="color:#f92672">,</span> String pwd<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception
        <span style="color:#f92672">{</span>
                ZipEntry zipEntry <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                FileOutputStream outputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">try</span><span style="color:#f92672">{</span>
<span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>zipEntry <span style="color:#f92672">=</span> inputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">getNextEntry</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> 
<span style="color:#f92672">{</span>
        <span style="color:#75715e">//如果是文件夹  则遍历
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
        <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在进入&#34;</span><span style="color:#f92672">+</span>zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件夹&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                String name <span style="color:#f92672">=</span> zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                name <span style="color:#f92672">=</span> name<span style="color:#f92672">.</span><span style="color:#a6e22e">substring</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> name<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">-</span> 1<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                File file <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputDir <span style="color:#f92672">+</span> File<span style="color:#f92672">.</span><span style="color:#a6e22e">separator</span> <span style="color:#f92672">+</span> name<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                file<span style="color:#f92672">.</span><span style="color:#a6e22e">mkdir</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> 
        <span style="color:#75715e">//对单个普通文件进行处理
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">else</span> 
        <span style="color:#f92672">{</span>
                File file <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>outputDir <span style="color:#f92672">+</span> File<span style="color:#f92672">.</span><span style="color:#a6e22e">separator</span> <span style="color:#f92672">+</span> zipEntry<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                file<span style="color:#f92672">.</span><span style="color:#a6e22e">createNewFile</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                outputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>file<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;你正在解压缩&#34;</span><span style="color:#f92672">+</span>file<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#75715e">//解压加密过程的开始
</span><span style="color:#75715e"></span>                PBEKeySpec keySpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEKeySpec<span style="color:#f92672">(</span>pwd<span style="color:#f92672">.</span><span style="color:#a6e22e">toCharArray</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            SecretKeyFactory keyFactory <span style="color:#f92672">=</span> SecretKeyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            SecretKey passwordKey <span style="color:#f92672">=</span> keyFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">generateSecret</span><span style="color:#f92672">(</span>keySpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#75715e">//准备排除加密的炸弹头
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> apple <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
            <span style="color:#75715e">//在zip输入流添加read
</span><span style="color:#75715e"></span>            inputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>apple<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#66d9ef">int</span> iterations <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>
            PBEParameterSpec parameterSpec <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PBEParameterSpec<span style="color:#f92672">(</span>apple<span style="color:#f92672">,</span> iterations<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            Cipher cipher <span style="color:#f92672">=</span> Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>ALGORITHM<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">init</span><span style="color:#f92672">(</span>Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">DECRYPT_MODE</span><span style="color:#f92672">,</span> passwordKey<span style="color:#f92672">,</span> parameterSpec<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#75715e">//byte[] input = new byte[1024];
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//int bytesRead;
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//利用全局的私有变量this.buf  this.readBytes ,已在类开头定义，统一控制
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readBytes</span> <span style="color:#f92672">=</span> inputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buf</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span> 
            <span style="color:#f92672">{</span>
                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> output <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">update</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buf</span><span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readBytes</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>output <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
                    <span style="color:#f92672">{</span>
                            outputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>output<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                    <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> output <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">doFinal</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>output <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
            <span style="color:#f92672">{</span>
                    outputStream<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>output<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
                
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>IOException ex<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Exception<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;解压读取文件失败&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span>
                <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Exception<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;解压文件密码不正确&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
<span style="color:#75715e">/*
</span><span style="color:#75715e">*  附录ant版本的压缩实现http://szhnet.iteye.com/blog/199059
</span><span style="color:#75715e">*  可以加入某些文件和删除某些文件
</span><span style="color:#75715e">*  package net.szh.zip;
</span><span style="color:#75715e">
</span><span style="color:#75715e">import java.io.File;
</span><span style="color:#75715e">
</span><span style="color:#75715e">import org.apache.tools.ant.Project;
</span><span style="color:#75715e">import org.apache.tools.ant.taskdefs.Zip;
</span><span style="color:#75715e">import org.apache.tools.ant.types.FileSet;
</span><span style="color:#75715e">
</span><span style="color:#75715e">public class ZipCompressorByAnt {
</span><span style="color:#75715e">
</span><span style="color:#75715e">        private File zipFile;
</span><span style="color:#75715e">
</span><span style="color:#75715e">        public ZipCompressorByAnt(String pathName) {
</span><span style="color:#75715e">                zipFile = new File(pathName);
</span><span style="color:#75715e">        }
</span><span style="color:#75715e">        
</span><span style="color:#75715e">        public void compress(String srcPathName) {
</span><span style="color:#75715e">                File srcdir = new File(srcPathName);
</span><span style="color:#75715e">                if (!srcdir.exists())
</span><span style="color:#75715e">                        throw new RuntimeException(srcPathName + &#34;不存在！&#34;);
</span><span style="color:#75715e">                
</span><span style="color:#75715e">                Project prj = new Project();
</span><span style="color:#75715e">                Zip zip = new Zip();
</span><span style="color:#75715e">                zip.setProject(prj);
</span><span style="color:#75715e">                zip.setDestFile(zipFile);
</span><span style="color:#75715e">                FileSet fileSet = new FileSet();
</span><span style="color:#75715e">                fileSet.setProject(prj);
</span><span style="color:#75715e">                fileSet.setDir(srcdir);
</span><span style="color:#75715e">                //fileSet.setIncludes(&#34;**/</span><span style="color:#75715e">/*.java&#34;); 包括哪些文件或文件夹 eg:zip.setIncludes(&#34;*.java&#34;);
</span><span style="color:#75715e">                //fileSet.setExcludes(...); 排除哪些文件或文件夹
</span><span style="color:#75715e">                zip.addFileset(fileSet);
</span><span style="color:#75715e">                
</span><span style="color:#75715e">                zip.execute();
</span><span style="color:#75715e">        }
</span><span style="color:#75715e">}
</span><span style="color:#75715e">
</span><span style="color:#75715e">ant版本的使用：
</span><span style="color:#75715e">package net.szh.zip;
</span><span style="color:#75715e">
</span><span style="color:#75715e">public class TestZip {
</span><span style="color:#75715e">        public static void main(String[] args) {                
</span><span style="color:#75715e">                ZipCompressorByAnt zca = new ZipCompressorByAnt(&#34;E:\\szhzipant.zip&#34;);
</span><span style="color:#75715e">                zca.compress(&#34;E:\\test&#34;);
</span><span style="color:#75715e">        }
</span><span style="color:#75715e">}
</span><span style="color:#75715e">*  
</span><span style="color:#75715e">*/</span>
</code></pre></div>
    </div>
 <div class="nav-links" style="padding:10;">
        
        <div align="left">
        <a href="https://jueqingsizhe66.github.io/blog/2015/05/11/fan-she-ji-zhi-nei-sheng-zheng-ze/"><span class="arrow">←</span> <strong>上一篇:反射机制内省正则</strong></a>
        </div>
        
        


       <div align="right"> <a href="https://jueqingsizhe66.github.io/blog/2015/05/12/so-beautiful-code/" ><strong>下一篇:So beautiful code </strong><span class="arrow">→</span></a></div>
        
      </div>
    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/javabasic/">JavaBasic</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/&amp;text=%e5%8e%8b%e7%bc%a9%e6%96%87%e4%bb%b6IO%e6%b5%81%e7%9a%84%e4%bd%bf%e7%94%a8%e5%92%8c%e7%ae%80%e5%8d%95%e5%b0%81%e8%a3%85%ef%bc%880213%ef%bc%89" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/&amp;t=%e5%8e%8b%e7%bc%a9%e6%96%87%e4%bb%b6IO%e6%b5%81%e7%9a%84%e4%bd%bf%e7%94%a8%e5%92%8c%e7%ae%80%e5%8d%95%e5%b0%81%e8%a3%85%ef%bc%880213%ef%bc%89" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=%e5%8e%8b%e7%bc%a9%e6%96%87%e4%bb%b6IO%e6%b5%81%e7%9a%84%e4%bd%bf%e7%94%a8%e5%92%8c%e7%ae%80%e5%8d%95%e5%b0%81%e8%a3%85%ef%bc%880213%ef%bc%89&amp;body=https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/&amp;title=%e5%8e%8b%e7%bc%a9%e6%96%87%e4%bb%b6IO%e6%b5%81%e7%9a%84%e4%bd%bf%e7%94%a8%e5%92%8c%e7%ae%80%e5%8d%95%e5%b0%81%e8%a3%85%ef%bc%880213%ef%bc%89" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=%e5%8e%8b%e7%bc%a9%e6%96%87%e4%bb%b6IO%e6%b5%81%e7%9a%84%e4%bd%bf%e7%94%a8%e5%92%8c%e7%ae%80%e5%8d%95%e5%b0%81%e8%a3%85%ef%bc%880213%ef%bc%89%20https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://jueqingsizhe66.github.io/blog/2015/05/11/ya-suo-wen-jian-ioliu-de-shi-yong-he-jian-dan-feng-zhuang-0213/&amp;title=%e5%8e%8b%e7%bc%a9%e6%96%87%e4%bb%b6IO%e6%b5%81%e7%9a%84%e4%bd%bf%e7%94%a8%e5%92%8c%e7%ae%80%e5%8d%95%e5%b0%81%e8%a3%85%ef%bc%880213%ef%bc%89" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hub2bcfcfc92fc067668c68513c0d68b69_23221_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jueqingsizhe66.github.io/">Ye Zhaoliang</a></h5>
      <h6 class="card-subtitle">Engineer of offshore wind turbine technique research</h6>
      <p class="card-text">My research interests include distributed energy, wind turbine power generation technique , Computational fluid dynamic and programmable matter.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=7VyEMyQAAAAJ&amp;hl=zh-CN" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/blog/2015/05/11/emailyou-jian-fa-song-plus-oogtk-0217/">email邮件发送&#43;OOGTK(0217)</a></li>
      
      <li><a href="/blog/2015/05/11/fan-she-ji-zhi-nei-sheng-zheng-ze/">反射机制内省正则</a></li>
      
      <li><a href="/blog/2015/05/11/jian-yi-de-dai-ma-yun-xing-mo-ni-chuang-kou/">简易的代码运行模拟窗口</a></li>
      
      <li><a href="/blog/2015/05/11/wang-luo-bian-cheng-8-12jie-bi-ji-dai-ma-march18th/">网络编程8-12节笔记代码March18th</a></li>
      
      <li><a href="/blog/2015/05/11/duo-xian-cheng-march18th/">多线程March18th</a></li>
      
    </ul>


         <span id="busuanzi_container_site_pv"> 
             本站访问量：<span id="busuanzi_value_site_pv"></span>次 
         </span> 
         &nbsp; 
   </div> 


  </div>

</article>
<script src="https://utteranc.es/client.js"
        repo="jueqingsizhe66/jueqingsizhe66.github.io"
        issue-term="pathname"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/go.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/vim.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/matlab.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/sql.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/c.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/scheme.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/racket.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/perl.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/awk.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/clojure.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.d6bd04fdad2ad213aa8111c5a3b72fc5.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    ©2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
