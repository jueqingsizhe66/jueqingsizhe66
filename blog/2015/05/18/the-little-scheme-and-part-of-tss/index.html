<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ye Zhaoliang">

  
  
  
    
  
  <meta name="description" content="这部分内容是我练习TLS和TSS的全部学习资料，里面有详细的记录和一些心路历程，以后慢慢修改。
总行数5800左右。">

  
  <link rel="alternate" hreflang="en-us" href="https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.e8d4d5fd376e67b34452ebe1cae16341.css">

  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jueqingsizhe66">
  <meta property="twitter:creator" content="@jueqingsizhe66">
  
  <meta property="og:site_name" content="简约派">
  <meta property="og:url" content="https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/">
  <meta property="og:title" content="The-Little-Scheme-And-Part-Of-TSS | 简约派">
  <meta property="og:description" content="这部分内容是我练习TLS和TSS的全部学习资料，里面有详细的记录和一些心路历程，以后慢慢修改。
总行数5800左右。"><meta property="og:image" content="https://jueqingsizhe66.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://jueqingsizhe66.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2015-05-18T09:25:11&#43;08:00">
    
    <meta property="article:modified_time" content="2015-05-18T09:25:11&#43;08:00">
  

  



  


  


  





  <title>The-Little-Scheme-And-Part-Of-TSS | 简约派</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">简约派</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>概要</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>博文</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>项目</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>课程</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/categories/"><span>分类</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/archives"><span>归档</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>标签</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  








  
 <script async src="//cdn.busuanzi.ibruce.info/cdn/busuanzi/2.3/busuanzi.pure.mini.js"></script> 
 <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> 
 <script> 
     $(document).ready(function() { 
         var int = setInterval(fixCount, 100); 
         var busuanziSiteOffset =  100000  
         function fixCount() { 
             if ($("#busuanzi_container_site_pv").css("display") != "none") { 
                 clearInterval(int); 
                 $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + busuanziSiteOffset); 
             } 
         } 
     }); 
 </script> 
  






  

  
  
  
<div class="article-container pt-3">
  <h1>The-Little-Scheme-And-Part-Of-TSS</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    May 18, 2015
  </span>

  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/programme/">programme</a></span>

  
</div>

    














  
</div>





<span class="article-metadata" >Reading time: 109 minutes and    16 seconds with 24041 words. 本文总阅读量<span id="busuanzi_value_page_pv"></span>次 </span>
    <aside>
        <nav id="TableOfContents"></nav>
    </aside>
  <div class="article-container">


    <div class="article-style">
      <p>这部分内容是我练习TLS和TSS的全部学习资料，里面有详细的记录和一些心路历程，以后慢慢修改。
总行数5800左右。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#f92672">#</span>lang racket

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;; I will introuduce The little scheme From the angles below</span>
<span style="color:#75715e">;;; 1:</span>
<span style="color:#75715e">;;;     why introuduce the concept</span>
<span style="color:#75715e">;;; 2:  </span>
<span style="color:#75715e">;;;     The main knowledge</span>
<span style="color:#75715e">;;; 3: </span>
<span style="color:#75715e">;;;     Map-reduce </span>
<span style="color:#75715e">;;;     .......</span>
<span style="color:#75715e">;;; 4:  How you describe the function works in  your own words? </span>
<span style="color:#75715e">;;; 5:  How do you determine the output when you apply a function?Is it what you want?</span>
<span style="color:#75715e">;;;     no? why no?</span>
<span style="color:#75715e">;;;;Namely, Can you write down the definition of the function member? and its arguments</span>
<span style="color:#75715e">;;;     and refer to them as you go through the next group of questions????</span>
<span style="color:#75715e">;; Do not rush through this book! Read carefully</span>
<span style="color:#75715e">;;; From the introuduction chapter </span>
<span style="color:#75715e">;;; else implicit said that if the condition is wrong do it recurly</span>
<span style="color:#75715e">;;;      also infer that after the recuring ,please go back to home along the Original road!</span>
<span style="color:#75715e">;;;  COns &#39;s function: save the buffer to the stack</span>
<span style="color:#75715e">;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The first part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; The Basic operator</span>
<span style="color:#75715e">;;;   The primitive variables of scheme ::  car ,cdr(is pronounced as &#34;could_er&#34;,cons,  null? zero?</span>
<span style="color:#75715e">;;;                                         eq?(compare two non-numericas atoms),</span>
<span style="color:#75715e">;;;                                         or (or asks two questions,one at a time. If the first one is true</span>
<span style="color:#75715e">;;;                                         .Otherwise it asks the second question and answers with whatever the </span>
<span style="color:#75715e">;;;                                         second question answers)</span>
<span style="color:#75715e">;;;                                         numbers,add1,sub1</span>
<span style="color:#75715e">;;;  COns &#39;s function: save the buffer to the stack</span>
(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))


<span style="color:#75715e">;;;; New added after myracet1.rkt</span>
<span style="color:#75715e">;;;  I want to find ( a  h fd  fs)  but not ( a h (fd s) fs),so I want to create the lat?</span>
<span style="color:#75715e">;;;  can you describe what the function lat? does in your own words? *****************</span>

<span style="color:#75715e">;;;  lat? looks at each S-expression in a list ,in turn,and asks if each S-expression </span>
<span style="color:#75715e">;;;  is an atom ,untill it runs out of S-expression. If it runs out without encountering </span>
<span style="color:#75715e">;;;  a list,the value is #f. If it finds a list,the value is #f,false</span>
<span style="color:#75715e">;;;   What is the meaning of the question *else* ??  </span>
<span style="color:#75715e">;;;             *else* asks if else if true</span>
<span style="color:#75715e">;;;                is *else* true?  Yes,because the question else is always true!</span>
<span style="color:#75715e">;;;         so what is (else #f) means?  ----&gt; as if else is true,If else is true--as it always is</span>
<span style="color:#75715e">;;; else implicit said that if the condition is wrong do it recurly</span>
<span style="color:#75715e">;;;      also infer that after the recuring ,please go back to home along the Original road!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;               --then the answer if #f ---false</span>
<span style="color:#75715e">;;;               In a word:   else is a question whose value is always (implicit)</span>
(<span style="color:#66d9ef">define </span>lat?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#66d9ef">#t</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l)) (<span style="color:#a6e22e">lat?</span> (cdr l)))
      (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>))))

<span style="color:#75715e">;;;; New added after myracet1.rkt</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>&gt;
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#66d9ef">cond </span>
      ((zero? n) <span style="color:#66d9ef">#f</span>)
      ((zero? m) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#66d9ef">else </span>(&gt; (<span style="color:#a6e22e">sub1</span> n) (<span style="color:#a6e22e">sub1</span> m))))))

<span style="color:#75715e">;;; What is the maning of (&gt; (sub1 n) (sub1 m))</span>
<span style="color:#75715e">;;;        Recur, but with both arguments reduced by one</span>
(<span style="color:#66d9ef">define </span>dd
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#66d9ef">cond </span>
      ((zero? n) <span style="color:#66d9ef">#f</span>)
      ((zero? m) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#66d9ef">else </span>(&gt; (<span style="color:#a6e22e">sub1</span> n) (<span style="color:#a6e22e">sub1</span> m))))))

<span style="color:#75715e">;;; Can you describe what leftmost does?</span>
<span style="color:#75715e">;;;      Here is our description:</span>
<span style="color:#75715e">;;;       &#34;The function leftmost finds the leftmost atom in a non-empty list of S-expressions that does not</span>
<span style="color:#75715e">;;;       contain the empty list&#34;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;       Is left a *-function?</span>
<span style="color:#75715e">;;;            It works on lists of S-expressions,but it only recurs on the car(so no)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     Does leftmost need to ask questions about all three possible cases?</span>
<span style="color:#75715e">;;;       No,it only needs to ask two questions,We agreed that leftmost works on non-empty</span>
<span style="color:#75715e">;;;       list that don&#39;t contain empty list</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;       So in a word,the two discussed before,1:recur in car(not together with cdr) 2:2 questions ,not 3 questions which S-expressions</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;       Do you remember what (or ...) does?</span>
<span style="color:#75715e">;;;            (or as questions one at a time until it finds one that is true.Then (or ...) stops,making its value true.</span>
<span style="color:#75715e">;;;            If it cannot find a true argument,the value of (or...) is false</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     After so many illustration ,can you put in your own words what (and ....) does</span>
<span style="color:#75715e">;;;             We put in our words:(lispers&#39; words)</span>
<span style="color:#75715e">;;;             &#34;(and ...) ask questions one at a time until it finds one whose value is false.Then (and ...) stops with false.</span>
<span style="color:#75715e">;;;              If none of the expressions are false,(and ...) is true.&#34;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     Both (and ...) and (or ...) can be expressed as abbreviations of (cond ...)-expressions:</span>
<span style="color:#75715e">;;;              (and a b) == (cond a b) (else #f))</span>
<span style="color:#75715e">;;;              (or a b) == (cond (a #t) (else b))</span>
(<span style="color:#66d9ef">define </span>leftmost
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#66d9ef">cond </span>
      ((<span style="color:#a6e22e">atom?</span> (car l)) (car l))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">leftmost</span>(car l))))))

(<span style="color:#66d9ef">define </span>rember
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) (<span style="color:#a6e22e">quote</span>()))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">cond</span>
              ((eq? (car lat) a) (cdr lat))
              (<span style="color:#66d9ef">else </span>
               (cons (car lat)
                     (<span style="color:#a6e22e">rember</span> a
                             (cdr lat)))))))))
<span style="color:#75715e">;;; Can you write number? which is true if its argument is a numerica atom and false if it is anything else</span>
<span style="color:#75715e">;;;      No:number? like add1,sub1,zero?,car , cdr, cons,null?, eq?,and atom? is a primitive function</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      Can you write a function no-nums which gives as a final value a lat obtained by removing all the</span>
<span style="color:#75715e">;;;      numbers from the lat.</span>

<span style="color:#75715e">;;; Remember to use = for numbers</span>
<span style="color:#75715e">;;;                 eq? for all other atoms(non-numericas atoms)</span>
<span style="color:#75715e">;;;     eqan? contains two part to compare the two atoms: 1 a number   2:an atom</span>
<span style="color:#75715e">;;;     Can you assume that all funtions written using eq? can be generalized by replacing eq?</span>
<span style="color:#75715e">;;;          By eqan?   ------------------Yes,excpet,of course ,for eqan? itself</span>
(<span style="color:#66d9ef">define </span>eqan?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a1</span> a2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#66d9ef">and </span>(number? a1) (number? a2))
       (= a1 a2))
      ((<span style="color:#66d9ef">or </span>(number? a1) (number? a2))
       <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(eq? a1  a2)))))

<span style="color:#75715e">;;;after the introuction of (and  (or   define leftmost</span>
<span style="color:#75715e">;;; What is eqlist?</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  It is a function that determines if two lists are equals</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; How many questions will eqlist? have to ask about it arguments?</span>
<span style="color:#75715e">;;;             Nine  --------------------------------------------------------------&lt;&lt;&lt;&lt;&lt;The first time so many questions!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Can you explain why there are nine questions?</span>
<span style="color:#75715e">;;;        Here are out words:</span>
<span style="color:#75715e">;;;         &#34;Each arguments may be either</span>
<span style="color:#75715e">;;;             ----empty</span>
<span style="color:#75715e">;;;             ----an atom consed onto a list,or</span>
<span style="color:#75715e">;;;             ----a list consed onto a list</span>
<span style="color:#75715e">;;;        For example,at the same time as the first argument may be the empty list,the </span>
<span style="color:#75715e">;;;              seconds argument could be the empty list or have an atom or a list in the car position.&#34;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         Is it okay to asK (atom? (car l2)) in the second question?</span>
<span style="color:#75715e">;;;               Yes ,because we know that the second  list cannot be empty.otherwise the first question would have been true.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         And why is the third question (null? l1)???</span>
<span style="color:#75715e">;;;              At that point ,we know that when the firs argument is empty,the second argument is neither empty list</span>
<span style="color:#75715e">;;;              nor a list with an atom as the first element .If(null? l1) is true now,the second argument must be a list whose first element</span>
<span style="color:#75715e">;;;              is also a list.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         Does this mean the questions (and (null? l1) (null? l2)) and (or (null? l1) (null? l2)) </span>
<span style="color:#75715e">;;;                suffice to determine the answer in the first three cases?</span>
<span style="color:#75715e">;;;             Yes .If the first question is true,eqlist? respoinse with #t; otherwise ,the answer if #f</span>
(<span style="color:#66d9ef">define </span>eqlist?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l1</span> l2)
    (<span style="color:#66d9ef">cond </span>
      ((<span style="color:#66d9ef">and </span>(null? l1) (null? l2)) <span style="color:#66d9ef">#t</span>)
      ((<span style="color:#66d9ef">and </span>(null? l1) (<span style="color:#a6e22e">atom?</span> (car l2))) <span style="color:#66d9ef">#f</span>)
      ((null? l1) <span style="color:#66d9ef">#f</span>)
      ((<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">atom?</span> (car l1)) (null? l2)) <span style="color:#66d9ef">#f</span>)
      ((<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">atom?</span> (car l1)) (<span style="color:#a6e22e">atom?</span> (car l2)))
       (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">eqan?</span> (car l1) (car l2)) (<span style="color:#a6e22e">eqlist?</span> (cdr l1) (cdr l2))))
      ((<span style="color:#a6e22e">atom?</span> (car l1)) <span style="color:#66d9ef">#f</span>)
      ((null? l2) <span style="color:#66d9ef">#f</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l2)) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">eqlist?</span> (car l1) (car l2))
            (<span style="color:#a6e22e">eqlist?</span> (cdr l1) (cdr l2)))))))

(<span style="color:#66d9ef">define </span>eqlist1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l1</span> l2)
    (<span style="color:#66d9ef">cond </span>
      ((<span style="color:#66d9ef">and </span>(null? l1) (null? l2)) <span style="color:#66d9ef">#t</span>)
      ((<span style="color:#66d9ef">or </span>(null? l1) (null? l2)) <span style="color:#66d9ef">#f</span>)
      ((<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">atom?</span> (car l1)) (<span style="color:#a6e22e">atom?</span> (car l2)))
       (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">eqan?</span> (car l1) (car l2)) (<span style="color:#a6e22e">eqlist1?</span> (cdr l1) (cdr l2))))
      ((<span style="color:#66d9ef">or </span>(<span style="color:#a6e22e">atom?</span> (car l1))
           (<span style="color:#a6e22e">atom?</span> (car l2)))
       <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">eqlist1?</span> (car l1) (car l2))
            (<span style="color:#a6e22e">eqlist1?</span> (cdr l1) (cdr l2)))))))

<span style="color:#75715e">;;; So  What is an S-expresssion? </span>
<span style="color:#75715e">;;;                                    An S-expression is either an atom or a (possibly empty) list of S-expressions.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      How many questions does equal? ask to determine whether two S-empty are the same?</span>
<span style="color:#75715e">;;;           Four. The first argument  may be an atom or a list of S-expressions at the same time as the second argument may be</span>
<span style="color:#75715e">;;;           an atom or a list of S-expressions.</span>
<span style="color:#75715e">;;; can we summarize the second questions and the third question of the equal? </span>
<span style="color:#75715e">;;;   as   (or (atom? s1) (atom? s2))</span>
<span style="color:#75715e">;;;              Yes, we can</span>


(<span style="color:#66d9ef">define </span>equal?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s1</span> s2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">atom?</span> s1) (<span style="color:#a6e22e">atom?</span> s2)) 
       (<span style="color:#a6e22e">eqan?</span> s1 s2))
      ((<span style="color:#a6e22e">atom?</span> s1) <span style="color:#66d9ef">#f</span>)
      ((<span style="color:#a6e22e">atom?</span> s2) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">eqlist?</span> s1 s2)))))

(<span style="color:#66d9ef">define </span>equal1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s1</span> s2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">atom?</span> s1) (<span style="color:#a6e22e">atom?</span> s2)) 
       (<span style="color:#a6e22e">eqan?</span> s1 s2))
      ((<span style="color:#66d9ef">or </span>(<span style="color:#a6e22e">atom?</span> s1) (<span style="color:#a6e22e">atom?</span> s1))
       <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">eqlist?</span> s1 s2)))))

<span style="color:#75715e">;;; The sixth chapter:</span>
<span style="color:#75715e">;;;    Is 1,3,1+3,1+3*4,cookie,3^y_5 all arithmetic expression?  Yes ,of course</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is an arithmetic expression? in your words?</span>
<span style="color:#75715e">;;;       In ours:</span>
<span style="color:#75715e">;;;         &#34;For the purpose of this chapter,an arithmetic expression is either an atom</span>
<span style="color:#75715e">;;;         (including numbers),or two arithmetic expressions combined by +,-,*,/,or expr.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Is (n+3) an arithmetic expression?</span>
<span style="color:#75715e">;;;        Not really,since there are parentheses around n+3, our definition of arithmetic</span>
<span style="color:#75715e">;;;        expression does not mention parentheses....</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Could we think of (n+3) as an arithmetic expression?</span>
<span style="color:#75715e">;;;        Yes if we keep in mind that the parentheses are not really there (the empire&#39;s new clothes)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What would you call (n+3)  </span>
<span style="color:#75715e">;;;                   we call it a representation for n+3</span>
<span style="color:#75715e">;;;         why is (n+3) a good representation?</span>
<span style="color:#75715e">;;;                  Because </span>
<span style="color:#75715e">;;;                          1. (n+3) is an S-expression. </span>
<span style="color:#75715e">;;;                               It can therefore serve as an argument for a function</span>
<span style="color:#75715e">;;;                          2.It stucturally resembles n+3</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; True or false: (numbered? x)  True while x is 1</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; How do you represent 3+4*5  ?                      ------&gt; (3+4*5)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is numbered?     </span>
<span style="color:#75715e">;;;                     It is a function that determines whether a representation? of an arithmetic expression </span>
<span style="color:#75715e">;;;                      contains only number besides the +,* and expr</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Now you can write a skeleton for numbered?</span>
<span style="color:#75715e">;;;           (define numbered?</span>
<span style="color:#75715e">;;;           (lambda (axep)</span>
<span style="color:#75715e">;;;           (cond </span>
<span style="color:#75715e">;;;           (_________   _________)</span>
<span style="color:#75715e">;;;           (_________   _________)</span>
<span style="color:#75715e">;;;           (_________   _________)</span>
<span style="color:#75715e">;;;           (_________   _________))))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is the first question?        --------------(atom? axep)</span>
<span style="color:#75715e">;;; What is (eq? (car (cdr aexp)) (quote +))  ------It is the second question</span>
<span style="color:#75715e">;;; can you guess the third one (eq? (car (cdr aexp)) (quote *))</span>
<span style="color:#75715e">;;; And you must know the fourth one.                     (eq? (car (cdr aexp)) (quote )e)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; why do we ask four,instead of two,  </span>
<span style="color:#75715e">;;;          questions about the arithmetic expressions?</span>
<span style="color:#75715e">;;;          after all,arithmetic expressions like (1+3) are lats</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         ------------------------------Because we consider (1+3) as a representation of an arithmetic expression in </span>
<span style="color:#75715e">;;;         list form,not as a list itself.And,an arithmetic expression is either a number,or two arithmetic expressions combined</span>
<span style="color:#75715e">;;;         by + ,*,expr.</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>numbered?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">aexp</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> aexp) (number? aexp))
      ((eq? (car (cdr aexp)) (<span style="color:#66d9ef">quote </span>+))
       <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>)
      ((eq? (car (cdr aexp)) (<span style="color:#66d9ef">quote </span>+))
       <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>)
     ((eq? (car (cdr aexp)) (<span style="color:#66d9ef">quote </span>+))
       <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>))))


(<span style="color:#66d9ef">define </span>numbered1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">aexp</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> aexp) (number? aexp))
      ((eq? (car (cdr aexp)) (<span style="color:#66d9ef">quote </span>+))
       (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">numbered?</span> (car aexp))
            (<span style="color:#a6e22e">numbered?</span> 
              (car (cdr (cdr aexp))))))
      ((eq? (car (cdr aexp)) (<span style="color:#66d9ef">quote </span>+))
       (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">numbered?</span> (car aexp))
            (<span style="color:#a6e22e">numbered?</span> 
              (car (cdr (cdr aexp))))))
     ((eq? (car (cdr aexp)) (<span style="color:#66d9ef">quote </span>+))
       (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">numbered?</span> (car aexp))
            (<span style="color:#a6e22e">numbered?</span> 
              (car (cdr (cdr aexp)))))))))

<span style="color:#75715e">;;; Since aexp was already understood to be an arithmetic expression,could we have written numbered? in a simpler way?</span>

(<span style="color:#a6e22e">defin</span> numbered2?
       (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">aexp</span>)
         (<span style="color:#a6e22e">cond</span>
           ((<span style="color:#a6e22e">atom?</span> aexp) (number? aexp))
           (<span style="color:#a6e22e">else</span>
             (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">numbered2?</span> (car aexp))
                  (<span style="color:#a6e22e">numbered2?</span> 
                    (car (cdr (cdr aexp))))))))))

<span style="color:#75715e">;;; why can we simplify ??-</span>
<span style="color:#75715e">;;;                        because we know we&#39;ve got the function right!</span>

<span style="color:#75715e">;;; We want to value the arithmetic expressions? ------------------</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; THe seventh commandments!!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Recur on the subparts that are of the same nature:</span>
<span style="color:#75715e">;;;            On the sublists of a list</span>
<span style="color:#75715e">;;;            on the subexpressions of an arithmetic expression</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; To (3 + 4)    &#39;s value</span>
(<span style="color:#66d9ef">define </span>value
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">nexp</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> nexp) nexp)
      ((eq? (car (cdr nexp)) (<span style="color:#66d9ef">quote </span>+))
       (+ (<span style="color:#a6e22e">value</span> (car nexp))
          (<span style="color:#a6e22e">value</span> (car (cdr (cdr nexp))))))
      ((eq? (car (cdr nexp)) (<span style="color:#66d9ef">quote </span>*))
       (+ (<span style="color:#a6e22e">value</span> (car nexp))
          (<span style="color:#a6e22e">value</span> (car (cdr (cdr nexp))))))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">expr</span> (<span style="color:#a6e22e">value</span> (car nexp))
          (<span style="color:#a6e22e">value</span> (car (cdr (cdr nexp)))))))))

<span style="color:#75715e">;;; Can you think of a different representation of arithmetic expressions?</span>
<span style="color:#75715e">;;;          There are several of thme</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;          (3 4 +)</span>
<span style="color:#75715e">;;;          (+ 3 4)</span>
<span style="color:#75715e">;;;          (plus 3 4)</span>
<span style="color:#75715e">;;;          (+ (* 3 6) (expr 8 2))</span>
<span style="color:#75715e">;;;         TO value (+ 3 4)</span>
      
(<span style="color:#66d9ef">define </span>value1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">nexp</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> nexp) nexp)
      ((eq? (car nexp) (<span style="color:#66d9ef">quote </span>+))
       (+ (<span style="color:#a6e22e">value1</span> (car (cdr nexp)))
          (<span style="color:#a6e22e">value1</span> (car (cdr (cdr nexp))))))
      ((eq? (car nexp) (<span style="color:#66d9ef">quote </span>*))
       (+ (<span style="color:#a6e22e">value1</span> (car (cdr nexp)))
          (<span style="color:#a6e22e">value1</span> (car (cdr (cdr nexp))))))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">expr</span> (<span style="color:#a6e22e">value1</span> (car nexp))
          (<span style="color:#a6e22e">value1</span> (car (cdr (cdr nexp)))))))))

<span style="color:#75715e">;;;(1 2) is not a arithmetic expressions ,so we  violated The Seventh Commandments. (1 3) is not a subpart that is </span>
<span style="color:#75715e">;;;   representation of an arithmetic expression! We obviosuly  recurred on a list.But,remember,not alll lists are representations</span>
<span style="color:#75715e">;;;   of arithmetic expressions. We have to recur subexpressions.</span>
<span style="color:#75715e">;;;   (3) is the (cdr (cdr nexp)) ,but (3) is not an arithmetic expressions,because there are no parentheses in our </span>
<span style="color:#75715e">;;;   definition of the arithmetic expressions.</span>

(<span style="color:#66d9ef">define </span><span style="color:#ae81ff">1</span>st-sub-exp
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">aexp</span>)
    (<span style="color:#a6e22e">cond</span>
      (<span style="color:#66d9ef">else </span>(car (cdr aexp))))))

<span style="color:#75715e">;;; why do we ask else,</span>
<span style="color:#75715e">;;;                   because the first question is also the last question</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Can we get by without (cons. ..) if we don&#39;t need to ask questions?</span>
<span style="color:#75715e">;;;        Yes remember one-liners from chapter4</span>
<span style="color:#75715e">;;;</span>

(<span style="color:#66d9ef">define </span><span style="color:#ae81ff">1</span>st-sub-exp1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">aexp</span>)
      (car (cdr aexp))))


(<span style="color:#66d9ef">define </span><span style="color:#ae81ff">2</span>nd-sub-exp
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">aexp</span>)
    (<span style="color:#a6e22e">cond</span>
      (<span style="color:#66d9ef">else </span>(car (cdr (cdr aexp)))))))

(<span style="color:#66d9ef">define </span>operator
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">aexp</span>)
    (car aexp)))


(<span style="color:#66d9ef">define </span>value2
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">nexp</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> nexp) nexp)
      ((eq? (<span style="color:#a6e22e">operator</span> nexp) (<span style="color:#66d9ef">quote </span>+))
       (+ (<span style="color:#a6e22e">value</span> (<span style="color:#ae81ff">1</span>st-sub-exp1 nexp))
          (<span style="color:#a6e22e">value</span> (<span style="color:#ae81ff">2</span>nd-sub-exp nexp))))
      ((eq? (<span style="color:#a6e22e">operator</span> nexp) (<span style="color:#66d9ef">quote </span>+))
       (* (<span style="color:#a6e22e">value</span> (<span style="color:#ae81ff">1</span>st-sub-exp1 nexp))
          (<span style="color:#a6e22e">value</span> (<span style="color:#ae81ff">2</span>nd-sub-exp nexp))))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">expr</span> (<span style="color:#a6e22e">value</span> (<span style="color:#ae81ff">1</span>st-sub-exp1 nexp))
          (<span style="color:#a6e22e">value</span> (<span style="color:#ae81ff">2</span>nd-sub-exp nexp)))))))

<span style="color:#75715e">;;; so it we chang the (define operator ) and (1st-sub-exp1) exchangeabley ,the different form of arithmetic expressioned.</span>


<span style="color:#75715e">;;;       ********************************************************************************</span>
<span style="color:#75715e">;;; The Eighth Commandments:</span>
<span style="color:#75715e">;;;       Use help functions to abstract from representation</span>
<span style="color:#75715e">;;;       ********************************************************************************</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;       Have we seen representation? before</span>
<span style="color:#75715e">;;;                                      Yes ,we just did not tell you that were representations.</span>
<span style="color:#75715e">;;;                             For what entities have we used representations?</span>
<span style="color:#75715e">;;;                             Truth-values!  Numbers!</span>
<span style="color:#75715e">;;;                                              Numbers are representations?</span>
<span style="color:#75715e">;;;                                                    Yes ,for example 4 stands for the concpet four. we close the symbol because</span>
<span style="color:#75715e">;;;                                                    we are accustomed to arabic representation.</span>
<span style="color:#75715e">;;;                                              What else could we have used?</span>
<span style="color:#75715e">;;;                                                (() () () ())  would have serve just as well</span>
<span style="color:#75715e">;;;                                                what about  (((((((())))))))?  How about (I V)&#34;</span>
<span style="color:#75715e">;;;                                         Do you know how many primitives we need for numbers?</span>
<span style="color:#75715e">;;;                                          Four: number? ,zero?, add1,and sub1-------------------------------------------&lt;</span>
<span style="color:#75715e">;;;                                                            ****Do You know how many primitives we need for list?</span>
<span style="color:#75715e">;;;                                                                   Four:   atom? null? car cdr</span>
<span style="color:#75715e">;;;                                         Let&#39;s try anouther representation for numbers. How shall we represent zero now/</span>
<span style="color:#75715e">;;;                                                       () is our choice</span>
<span style="color:#75715e">;;;                                         How is one represented?</span>
<span style="color:#75715e">;;;                                                       (()) </span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;                                         How is two represented?</span>
<span style="color:#75715e">;;;                                                       (() () )</span>
<span style="color:#75715e">;;;                                          Got it,What&#39;s Three?</span>
<span style="color:#75715e">;;;                                                       (() () ())</span>
<span style="color:#75715e">;;; So now write thefunction to test zero</span>
(<span style="color:#66d9ef">define </span>sero?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (null? n)))
<span style="color:#75715e">;;; write a function that is like add1</span>
(<span style="color:#66d9ef">define </span>edd1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (cons (<span style="color:#66d9ef">quote </span>()) n)))

<span style="color:#75715e">;;;what about sub1</span>
(<span style="color:#66d9ef">define </span>zub1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (cdr n)))

<span style="color:#75715e">;;; so we can rewrite +</span>
(<span style="color:#66d9ef">define </span>plus
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">sero?</span> m) n)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">edd1</span> (+ n (<span style="color:#a6e22e">zub1</span> m)))))))

<span style="color:#75715e">;;; but what&#39;s lat????t</span>
<span style="color:#75715e">;;;(define lat?</span>
<span style="color:#75715e">;;;  (lambda (l)</span>
<span style="color:#75715e">;;;  (cond</span>
<span style="color:#75715e">;;;      ((null? l) #t)</span>
<span style="color:#75715e">;;;      ((atom? (car l)) (lat? (cdr l)))</span>
<span style="color:#75715e">;;;      (else #f))))</span>
<span style="color:#75715e">;;; So (lat? (1 2 3))     why did you ask???  but now (lat? ((()) (()()) (()()()))) It is very false,!!!</span>
<span style="color:#75715e">;;;                                                 So you must beware of shadows!!!bugs implicit!!</span>



<span style="color:#75715e">;;;                         </span>
<span style="color:#75715e">;;; Why dow we ask (number? aexp) when we know that aexp is an atom?</span>
<span style="color:#75715e">;;;                   Because we want to know if all arithmetic expressions that are atoms are numbers</span>

<span style="color:#75715e">;;; Does equal1? ask enough questions? --The first commandments!!  </span>
<span style="color:#75715e">;;;              Yes,The questions cover all four possible cases</span>

<span style="color:#75715e">;; Now rewrite the eqlist? using equal???                --------------equal? is the most common ,which  S-expression as the arguments</span>
    
(<span style="color:#66d9ef">define </span>eqlist1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l1</span> l2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#66d9ef">and </span>(null? l1) (null? l2)) <span style="color:#66d9ef">#t</span>)
      ((<span style="color:#66d9ef">or </span>(null? l1) (null? l2)) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">and </span>(equal? (car l1) (car l2))
            (<span style="color:#a6e22e">eqlist?</span> (cdr l1) (cdr l2)))))))

<span style="color:#75715e">;;;; THe sixth Commandments</span>
<span style="color:#75715e">;;;     Simplify  only  after the function is correct.   ---------------------------------&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>

<span style="color:#75715e">;;;; Can you describe what (rember1 a lat) do?</span>
<span style="color:#75715e">;;;          It takes an atom and a lat as its *arguments*,and makes a new *lat*</span>
<span style="color:#75715e">;;;          with the *first* occurrence of the atom in the old lat removed</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     How do we(lispers,implicitly) ask questions?</span>
<span style="color:#75715e">;;;            By using</span>
<span style="color:#75715e">;;;                   (cond</span>
<span style="color:#75715e">;;;                     (__________     ____________)</span>
<span style="color:#75715e">;;;                     (__________     ____________)</span>
<span style="color:#75715e">;;;                     (__________     ____________)</span>
<span style="color:#75715e">;;;                     ...</span>
<span style="color:#75715e">;;;                     (__________     ____________)).</span>
<span style="color:#75715e">;;;     How do we  remove the first occurrence of a in the rest of lat?</span>
<span style="color:#75715e">;;;             (rember a (cdr lat))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Write down the function rember and its arguments, and refer to them as you go</span>
<span style="color:#75715e">;;; through the next sequence of questions(the unit test)</span>
<span style="color:#75715e">;;;    In our words:</span>
<span style="color:#75715e">;;;              &#34;The function rember checked each atom of the lat , one at a time,</span>
<span style="color:#75715e">;;;               to see if it was the same  as the atom &#39;and&#39;.If the car was not the</span>
<span style="color:#75715e">;;;               same as the atom, we saved it to be consed to the final value later.</span>
<span style="color:#75715e">;;;               when rember found the atom &#39;and&#39;,it dropped it ,and consed the previous</span>
<span style="color:#75715e">;;;               atoms back onto the rest of the lat</span>
<span style="color:#75715e">;;;  ---------------------------------cons --------------------------------------</span>
(<span style="color:#66d9ef">define </span>rember
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>cond
            ((eq? (car lat) a) (cdr lat))
            (<span style="color:#66d9ef">else </span>(cons (car lat)
                        (<span style="color:#a6e22e">rember</span> a
                                (cdr lat))))))))

<span style="color:#75715e">;;; Can you rewrite rember so that it reflects the abouve description</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>rembersimple
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      ((eq? (car lat) a) (cdr lat))
      (<span style="color:#66d9ef">else </span>(cons (car lat)
                  (<span style="color:#a6e22e">rember</span> a (cdr lat)))))))

<span style="color:#75715e">;;;;  What is the meaning of the  (cons (car lat) (rember a (cdr lat))) </span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;           This says to refer to the funciton rember but with the </span>
<span style="color:#75715e">;;;           argument lat replaced by (cdr lat) and  that after we arrive at a value for</span>
<span style="color:#75715e">;;;           (rember a (cdr lat)) we must cons (car lat) --bacon --onto it</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;           This also says we recur using the function rember, with the argument lat</span>
<span style="color:#75715e">;;;           replaced by (cdr lat),and that after we arrive at a value for (rember a (cdr lat))</span>
<span style="color:#75715e">;;;           we must cons (car lat)---lettuce --onto it</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Here is rember1  after we replace lat by a list l of S-expression </span>
(<span style="color:#66d9ef">define </span>rember1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s</span> l)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) (<span style="color:#a6e22e">quote</span>()))
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#66d9ef">cond </span>
         ((equal? (car l) s) (cdr l))
             (<span style="color:#66d9ef">else </span>(cons (car l)
                         (<span style="color:#a6e22e">rember1</span> s (cdr l))))))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">cond</span>
         ((equal? (car l) s) (cdr l ))
         (<span style="color:#66d9ef">else </span>(cons (car l)
                     (<span style="color:#a6e22e">rember1</span> s 
                             (cdr l)))))))))
<span style="color:#75715e">;;;  And how does that differ?</span>
<span style="color:#75715e">;;;        The funciton rember now removes the first matching S-expression s in l,</span>
<span style="color:#75715e">;;;                  instead of the first matching atom a in lat.</span>
<span style="color:#75715e">;;;    Is rember a  &#34;star&#34; function now? </span>
<span style="color:#75715e">;;;             NO.</span>
<span style="color:#75715e">;;;     Why not?</span>
<span style="color:#75715e">;;;          because rember recurs with the cdr of l only (not togeterh with the car of l ,,correspoding to (define leftmost)</span>
<span style="color:#75715e">;;;; can we simplify rember1 ?</span>
(<span style="color:#66d9ef">define </span>rember2
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s</span> l)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) (<span style="color:#a6e22e">quote</span>()))
      (<span style="color:#66d9ef">else </span>
       (<span style="color:#a6e22e">cond</span>
         ((equal? (car l) s) (cdr l))
         (<span style="color:#a6e22e">else</span>
          (cons (car l)
                (<span style="color:#a6e22e">rember2</span> s (cdr l)<span style="color:#ae81ff">0</span>))))))))

<span style="color:#75715e">;;; Can rember2 be further simplified????????????????????????</span>
<span style="color:#75715e">;;;   Yes,the inner(cond...) asks questions that the outer(cond...) could ask1</span>
(<span style="color:#66d9ef">define </span>rember3
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s</span> l)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      ((equal? (car l) s) (cdr l))
      (<span style="color:#66d9ef">else </span>(cons (car l)
                  (<span style="color:#a6e22e">rember3</span> s (cdr l)))))))

<span style="color:#75715e">;;; &#34;...*&#34; makes us think &#34;oh my gawd&#34;</span>
(<span style="color:#66d9ef">define </span>rember*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#66d9ef">cond </span>
      ((null? l ) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#66d9ef">cond </span>
        ((eq? (car l) a)
         (<span style="color:#a6e22e">rember*</span> a (cdr l)))
        (<span style="color:#66d9ef">else </span>(cons (car l)
                    (<span style="color:#a6e22e">rember*</span> a (cdr l))))))
      (<span style="color:#66d9ef">else </span>(cons (<span style="color:#a6e22e">rember*</span> a (car l))
                  (<span style="color:#a6e22e">rember*</span> a (cdr l)))))))
<span style="color:#75715e">;; Notice that now we are recurring down the car of the list,instead of just the cdr of the list</span>


(<span style="color:#66d9ef">define </span>insertL
       (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old lat)
         (<span style="color:#a6e22e">cond</span>
           ((null? lat) (<span style="color:#66d9ef">quote </span>()))
           (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">cond</span>
                   ((eq? (car lat) old)
                    (cons new 
                          (cons old (cdr lat))))
                   (<span style="color:#66d9ef">else </span>(cons (car lat)
                               (<span style="color:#a6e22e">insertL</span> new old 
                                        (cdr lat)))))))))

<span style="color:#75715e">;;;; after ------------------------------------&lt;the (define firsts  </span>
<span style="color:#75715e">;;;In your own words, what does (insertR new old lat) do?</span>
<span style="color:#75715e">;;;     In our words:</span>
<span style="color:#75715e">;;;             &#34;It takes three arguments: the atoms new  and old,and lat.</span>
<span style="color:#75715e">;;;             The function insertR builds a lat with new inserted to the</span>
<span style="color:#75715e">;;;             right of the *first* occurence of old</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     Which arguments changes when we recur with insertR?</span>
<span style="color:#75715e">;;;           lat, because we can only  look at one of its atoms at a time.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     Which questions do we ask?</span>
<span style="color:#75715e">;;;       First, we ask (null? lat) .Second we ask else,because else is </span>
<span style="color:#75715e">;;;       always the last question.</span>
<span style="color:#75715e">;;;     Which questions do we ask about the first elements?????? Still rember the typical element</span>
<span style="color:#75715e">;;;       in the (define firsts)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     First,we ask (eq? (car lat) old ) .Then we ask else,because there are no other interesting cases</span>
<span style="color:#75715e">;;;  </span>
<span style="color:#75715e">;;;  COns &#39;s function: save the buffer to the stack</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  I want to write an procedure: which sort the list  afterwards?</span>
<span style="color:#75715e">;;;            So I want the change the function&#39; return value?????????????????????????</span>
<span style="color:#75715e">;;;            What I should do??</span>
(<span style="color:#66d9ef">define </span>insertR
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">cond</span>
              ((eq? (car lat) old)
               (cons old 
                     (cons new (cdr lat))))
              (<span style="color:#66d9ef">else </span>(cons (car lat)
                           (<span style="color:#a6e22e">insertR</span> new old 
                                    (cdr lat)))))))))

<span style="color:#75715e">;;;; after the (define makeset1)</span>

(<span style="color:#66d9ef">define </span>subset
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old lat)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">cond</span>
              ((eq? (car lat) old)
               (cons new (cdr lat)))
              (<span style="color:#66d9ef">else </span>(cons (car lat)
                          (<span style="color:#a6e22e">subset</span> new old 
                                  (cdr lat)))))))))

(<span style="color:#66d9ef">define </span>subset2
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> o1 o2 lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">cond</span>
              ((eq? (car lat) o1)
               (cons new (cdr lat)))
              ((eq? (car lat) o2)
               (cons new (cdr lat)))
              (<span style="color:#66d9ef">else </span>(cons (car lat)
                          (<span style="color:#a6e22e">subset2</span> new o1 o2
                                   (cdr lat)))))))))


(<span style="color:#66d9ef">define </span>rember5
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      ((eq? (car lat) a) (cdr lat))
      (<span style="color:#66d9ef">else </span>(cons (car lat)
                  (<span style="color:#a6e22e">rember5</span> a (cdr lat)))))))

(<span style="color:#66d9ef">define </span>factorial 
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
      (<span style="color:#66d9ef">if </span>(&lt;= x <span style="color:#ae81ff">1</span>) <span style="color:#ae81ff">1</span>
          (* x (<span style="color:#a6e22e">factorial</span> (- x <span style="color:#ae81ff">1</span>))))))

<span style="color:#75715e">;;;;  after rember ---------------------------------------------------&lt;&lt;&lt;&lt;&lt;</span>
<span style="color:#75715e">;;; In  your own words , what does (firsts l) do</span>
<span style="color:#75715e">;;;          We tried the following:</span>
<span style="color:#75715e">;;;          &#34;The function firsts takes one argument, a list,which is either</span>
<span style="color:#75715e">;;;          a null list or contains only non-empty lists. It builds another list</span>
<span style="color:#75715e">;;;          composed of the first S-expression(atom or list  or pair) of each internal list</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;          REMEMBER THe Commandments</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;          Why (define firsts</span>
<span style="color:#75715e">;;;                 (lambda (l)</span>
<span style="color:#75715e">;;;                  ...)                     Because we always state the function name,(lambda,and the </span>
<span style="color:#75715e">;;;                                           argument(s) of the function</span>
<span style="color:#75715e">;;;          Why (cond ...)</span>
<span style="color:#75715e">;;;                                           Because we need to ask questions about the actual arguments</span>
<span style="color:#75715e">;;;          Why ((null? l) ...)</span>
<span style="color:#75715e">;;;                                           The first Commandments</span>
<span style="color:#75715e">;;;          Why (else</span>
<span style="color:#75715e">;;;                                           Because we only have two equstions to ask about the list l:</span>
<span style="color:#75715e">;;;                                                      either It is the null list,</span>
<span style="color:#75715e">;;;                                                                or it contains at least one non-empty list.</span>
<span style="color:#75715e">;;;                                                 And Because the last question is always else</span>
<span style="color:#75715e">;;;         Why (cons </span>
<span style="color:#75715e">;;;                                           Because we are building  a lsit  -----The second commandments</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         Why (firsts (cdr l)) </span>
<span style="color:#75715e">;;;                                           Because we can only  look at one S-expression at at time .</span>
<span style="color:#75715e">;;;                                                   To look at the rest,we must recur</span>
<span style="color:#75715e">;;;         why )))</span>
<span style="color:#75715e">;;;                                           Because these are the matching  parentheses for (cond, (lambda,</span>
<span style="color:#75715e">;;;                                           and (define, and they always appear at the end of a function </span>
<span style="color:#75715e">;;;                                           definition</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;        When we find a typical element of (firsts l) </span>
<span style="color:#75715e">;;;                 what do we do with it?</span>
<span style="color:#75715e">;;;                                       --cons it onto the recursion --(firsts (cdr l))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     The third commandments :</span>
<span style="color:#75715e">;;;                 When building a list, describe the first typical element,and then cons it onto the natural recursion</span>
<span style="color:#75715e">;;;         So What is the first typical element?</span>
<span style="color:#75715e">;;;                             -----------------------&gt;  In the (define firsts  The typical element is (car (car l))</span>
<span style="color:#75715e">;;;            What  is the natural recursion?</span>
<span style="color:#75715e">;;;                            -----------------------&gt; (firsts (cdr l))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;             ****************************we are still missing one important ingredient in our recipe!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;             So what is the meaning of (cons (car (car l))  (firsts (cdr l)))</span>
<span style="color:#75715e">;;;                           Save (car (car l)) ,and recur with (firsts (cdr l))</span>
(<span style="color:#66d9ef">define </span>firsts
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>(cons (car (car l))
                  (<span style="color:#a6e22e">firsts</span> (cdr l)))))))

(<span style="color:#66d9ef">define </span>multirember
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car lat) a)
          (<span style="color:#a6e22e">multirember</span> a (cdr lat)))
         (<span style="color:#66d9ef">else </span>(cons (car lat)
                     (<span style="color:#a6e22e">multirember</span> a (cdr lat)))))))))
<span style="color:#75715e">;;; What is the meaning of (cons (car lat) (multirember a (cdr lat)))</span>
<span style="color:#75715e">;;;  Save (car lat) ---coffee ---- to be consed onto the value of (multirember a (cdr lat)) later</span>
<span style="color:#75715e">;;;  Now determine (multirember a (cdr lat))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  THe Fourth commandments:</span>
<span style="color:#75715e">;;;         Always change at least one arguments while recuring.It must be changed to be closer to </span>
<span style="color:#75715e">;;;         termination.The changing argument must be tested in the termination condition:</span>
<span style="color:#75715e">;;;                   When using cdr, test termination with null?, such as (null? lat)  lat is the </span>
<span style="color:#75715e">;;;                   changing argument,so it occur in the terminal condition.</span>

(<span style="color:#66d9ef">define </span>multiinsertR
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car lat) old)
          (cons (car lat)
                (cons new
                      (<span style="color:#a6e22e">multiinsertR</span> new old (cdr lat)))))
         (<span style="color:#66d9ef">else </span>(cons (car lat)
                     (<span style="color:#a6e22e">multiinsertR</span> new old (cdr lat)))))))))


(<span style="color:#66d9ef">define </span>multiinsertL
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car lat) old)
          (cons new
                (cons (car lat)
                      (<span style="color:#a6e22e">multiinsertL</span> new old (cdr lat)))))
         (<span style="color:#66d9ef">else </span>(cons (car lat)
                     (<span style="color:#a6e22e">multiinsertL</span> new old (cdr lat)))))))))

(<span style="color:#66d9ef">define </span>multisubset
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car lat) old)
          (cons new
                (<span style="color:#a6e22e">multisubset</span> new old 
                             (cdr lat))))
         (<span style="color:#a6e22e">else</span>
          (cons (car lat)
                (<span style="color:#a6e22e">multisubset</span> new old 
                             (cdr lat)))))))))

(<span style="color:#66d9ef">define </span>add1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (+ x <span style="color:#ae81ff">1</span>)))

(<span style="color:#66d9ef">define </span>sub1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (- x <span style="color:#ae81ff">1</span>)))




<span style="color:#75715e">; (define +</span>
<span style="color:#75715e">;   (lambda (n m)</span>
<span style="color:#75715e">;     (cond </span>
<span style="color:#75715e">;       ((zero? m) n)</span>
<span style="color:#75715e">;       (else (add1 (+ n (sub1 m)))))))</span>
<span style="color:#75715e">; </span>
<span style="color:#75715e">; (define -</span>
<span style="color:#75715e">;   (lambda (n m)</span>
<span style="color:#75715e">;     (cond </span>
<span style="color:#75715e">;       ((zero? m) n)</span>
<span style="color:#75715e">;       (else (sub1 (- n (sub1 m)))))))</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;;;  Can you describe how (- n m) works??</span>
<span style="color:#75715e">;;;    It takes two numbers as arguments,and reduces the second until it hits zeros.</span>
<span style="color:#75715e">;;;    It subtracts one from the result as many times as it did to cause the second </span>
<span style="color:#75715e">;;;    one to reach zero!!!</span>

<span style="color:#75715e">;if add the box above the wrong to the expr define</span>

<span style="color:#75715e">;;;  What is the natural terminal condition for a list?</span>
<span style="color:#75715e">;;;              (null? l)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  What is the natural terminal conditon for a tup?</span>
<span style="color:#75715e">;;;              (null? tup)</span>
<span style="color:#75715e">;;;              </span>
<span style="color:#75715e">;;; When we build a number from a list of numbers, what should the terminal condition line look like?</span>
<span style="color:#75715e">;;;               ((null? tup) 0)  ,just as ((null? l) (quote ()))  is ofter the terminal conditon line</span>
<span style="color:#75715e">;;;               for lists</span>
<span style="color:#75715e">;;;     So what is the terminal condition line of addtup?</span>
<span style="color:#75715e">;;;           What does addtup do?</span>
<span style="color:#75715e">;;;             It builds a number by totalling all the numbers in its arguments</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is used in the natural recursion on a list?</span>
<span style="color:#75715e">;;;       (cdr lat)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is used in the natural recursion on a tup?</span>
<span style="color:#75715e">;;;        (cdr tup)</span>
<span style="color:#75715e">;;; Why?</span>
<span style="color:#75715e">;;;      Because the rest of a non-empty list is a list</span>
<span style="color:#75715e">;;;              The rest of a non-empty tup  is a tup</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; How is a number defined?</span>
<span style="color:#75715e">;;;    It is either zero or it is one added to a res,</span>
<span style="color:#75715e">;;;           where rest is again  a number</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; what is  the natural terminal condition for numbers?</span>
<span style="color:#75715e">;;;         (zero? n)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is the natural recursion on a number? (sub1 n)            (Cdr tup)  (cdr l)</span>
<span style="color:#75715e">;;;        (how many questions do we need to ask about a number?   ---------------&lt; two</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;        So The first commandments(revision)</span>
<span style="color:#75715e">;;;          When recurring on a list of atoms,lat, ask two questions about it: (null? lat) and else</span>
<span style="color:#75715e">;;;          When recurring on a number,n ,as two questions about it:(zero? n) and else</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;    and What is the terminal condition line of addtup</span>
<span style="color:#75715e">;;;           ((null? tup) 0)</span>
<span style="color:#75715e">;;; So what is the natural recursion for addtup?</span>
<span style="color:#75715e">;;;           (addtup (cdr tup))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     what does addtup use to build a number?</span>
<span style="color:#75715e">;;;               It uses + , because + builds numbers, too!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>addtup
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? tup) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(+ (car tup) (<span style="color:#a6e22e">addtup</span> (cdr tup)))))))

       <span style="color:#75715e">;;(cons (car tup) (addtup (cdr tup)))))))   The last line of function rember is the similar to the one in the addtup!!!!</span>
       <span style="color:#75715e">;;</span>
<span style="color:#75715e">;;;; The fourth commandments(revision)</span>
<span style="color:#75715e">;;;  Always change at least one arguments while recurring. It must be changed to be closer to termination.The changing argument must</span>
<span style="color:#75715e">;;;  be tested in the termination condition:</span>
<span style="color:#75715e">;;;         when using cdr, test termination with  null? and</span>
<span style="color:#75715e">;;;         when using sub1, test termination with zero</span>


(<span style="color:#66d9ef">define </span>expr
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m) <span style="color:#ae81ff">1</span>)
      (<span style="color:#66d9ef">else </span>(* n (<span style="color:#a6e22e">expr</span> n (<span style="color:#a6e22e">sub1</span> m)))))))


(<span style="color:#66d9ef">define </span>multiplication
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#66d9ef">cond </span>
      ((zero? m) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(+ n (<span style="color:#a6e22e">multiplication</span> n (<span style="color:#a6e22e">sub1</span> m)))))))

(<span style="color:#66d9ef">define </span>divide
  (<span style="color:#66d9ef">lambda </span>( n m)
    (<span style="color:#a6e22e">cond</span>
      ((&lt; n m ) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">divide</span> (- n m) m))))))


(<span style="color:#66d9ef">define </span>pick 
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((zero? (<span style="color:#a6e22e">sub1</span> n)) (car lat))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">pick</span> (<span style="color:#a6e22e">sub1</span> n) (cdr lat))))))

<span style="color:#75715e">;;; Can you write number? which is true if its argument is a numerica atom and false if it is anything else</span>
<span style="color:#75715e">;;;      No:number? like add1,sub1,zero?,car , cdr, cons,null?, eq?,and atom? is a primitive function</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      Can you write a function no-nums which gives as a final value a lat obtained by removing all the</span>
<span style="color:#75715e">;;;      numbers from the lat.</span>

<span style="color:#75715e">;;; after (define rempick)  --------------------------------------------&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
(<span style="color:#66d9ef">define </span>no-nums
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">cond</span>
         ((number? (car lat))
          (<span style="color:#a6e22e">no-nums</span> (cdr lat)))
         (<span style="color:#66d9ef">else </span>(cons (car lat)
                     (<span style="color:#a6e22e">no-nums</span> (cdr lat)))))))))

(<span style="color:#66d9ef">define </span>all-nums
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>
       (<span style="color:#a6e22e">cond</span>
         ((number? (car lat))
          (cons (car lat)
                (<span style="color:#a6e22e">all-nums</span> (cdr lat))))
         (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">all-nums</span> (cdr lat))))))))

<span style="color:#75715e">;;;;     after the define of eqan? (define eqan?)</span>
<span style="color:#75715e">;;;what does occur do?</span>
<span style="color:#75715e">;;;        the function occur which counts the number of times an atom a appears in a lat</span>
(<span style="color:#66d9ef">define </span>occur
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) <span style="color:#ae81ff">0</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car lat) a)
          (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">occur</span> a (cdr lat))))
         (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">occur</span> a (cdr lat))))))))

(<span style="color:#66d9ef">define </span>one?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#66d9ef">cond </span>
      ((zero? n) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(zero? (<span style="color:#a6e22e">sub1</span> n))))))

(<span style="color:#66d9ef">define </span>one1? 
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#a6e22e">cond</span>
      (= n <span style="color:#ae81ff">1</span>)
      (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>))))
(<span style="color:#66d9ef">define </span>one11?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (= n <span style="color:#ae81ff">1</span>)))
<span style="color:#75715e">;;; Guess how we can further simplify this  function ,maing it a one-liner</span>
<span style="color:#75715e">;;;       By removing the (cond )clause.</span>

(<span style="color:#66d9ef">define </span>negativeone?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#66d9ef">cond </span>
      ((zero? n) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(zero? (<span style="color:#a6e22e">add1</span> n))))))

(<span style="color:#66d9ef">define </span>rember*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#66d9ef">cond </span>
         ((eq? (car l) a)
          (<span style="color:#a6e22e">rember*</span> a (cdr l)))
         (<span style="color:#66d9ef">else </span>(cons (car l)
                     (<span style="color:#a6e22e">rember*</span> a (cdr l))))))
     (<span style="color:#66d9ef">else </span>(cons (<span style="color:#a6e22e">rember*</span> a (car l))
           (<span style="color:#a6e22e">rember*</span> a (cdr l)))))))

<span style="color:#75715e">;;; After rember*            (define rember*) -----------------------------------------&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span style="color:#75715e">;;; How are insertR* and rember* similar?</span>
<span style="color:#75715e">;;;        0--------------------Each function asks three questions,. Each function recurs on the car</span>
<span style="color:#75715e">;;;                  of its argument when it finds out that the argument&#39;s car is a list</span>
<span style="color:#75715e">;;;                  namely,They both recur with car,whenever the car is alist,as well as with the cdr</span>
<span style="color:#75715e">;;; ******************************************************************************************************************</span>
<span style="color:#75715e">;;;        The first commandments(Final version)</span>
<span style="color:#75715e">;;;          When recurring on  a list of atoms,lat,ask two questions about it:</span>
<span style="color:#75715e">;;;                       (null? lat) and else</span>
<span style="color:#75715e">;;;          When recurring on a number,n ,ask two questions about it:</span>
<span style="color:#75715e">;;;                       (zero? n) and else.</span>
<span style="color:#75715e">;;;          When recurring on a list of S-expression,l ,ask three questtion,about it:</span>
<span style="color:#75715e">;;;                       (null? l),(atom? (car l)) , and else</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; ******************************************************************************************************************</span>
<span style="color:#75715e">;;; How are rember* and multirember different?</span>
<span style="color:#75715e">;;;         The function multirember does not recur with the car. The function rember* recurs with the car when if</span>
<span style="color:#75715e">;;;           finds out that the car is a list</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; So how are all *-functions similar?</span>
<span style="color:#75715e">;;;          They all ask three questions and recur with the car as well as   with the cdr,whenever the car is a list</span>
<span style="color:#75715e">;;;          Why?</span>
<span style="color:#75715e">;;;                             Because all *-functions work on lists that are either </span>
<span style="color:#75715e">;;;                                                                      ---empty</span>
<span style="color:#75715e">;;;                                                                      ---an atom consed onto a list,or</span>
<span style="color:#75715e">;;;                                                                      ---a list consed onto a list</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; ******************************************************************************************************************</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         TheFourthe commandments(final version)</span>
<span style="color:#75715e">;;;             Always change at least one argument while recurring. </span>
<span style="color:#75715e">;;;              when recurring on alist of atoms, lat,use (cdr lat.</span>
<span style="color:#75715e">;;;              When recurring on a number,n ,use (sub1 n). And  </span>
<span style="color:#75715e">;;;              when recurring on a list of S-expressions,l,use (car l) and (cdr l) if neither (null? l) nor (atom? (car l) are true</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;              It must be changed to be closer to termination. The changing argument must be tested in the termination condition:</span>
<span style="color:#75715e">;;;                     When using cdr, test termination with null? and</span>
<span style="color:#75715e">;;;                     When using sub1, test termination with zero?</span>
<span style="color:#75715e">;;; ******************************************************************************************************************</span>
(<span style="color:#66d9ef">define </span>insertR*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#66d9ef">cond </span>
         ((eq? (car l) old)
          (cons old
                (cons new (<span style="color:#a6e22e">insertR*</span> new old (cdr l)))))
         (<span style="color:#66d9ef">else </span>(cons (car l)
                     (<span style="color:#a6e22e">insertR*</span> new old
                               (cdr l)))))
       (<span style="color:#66d9ef">else </span>cons (<span style="color:#a6e22e">insertR*</span> new old
                            (car l))
             (<span style="color:#a6e22e">insertR*</span> new old (cdr l))))))

<span style="color:#75715e">;;; </span>
(<span style="color:#66d9ef">define </span>insertL*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#66d9ef">cond </span>
         ((eq? (car l) old)
          (cons new
                (cons old (<span style="color:#a6e22e">insertR*</span> new old (cdr l)))))
         (<span style="color:#66d9ef">else </span>(cons (car l)
                     (<span style="color:#a6e22e">insertL*</span> new old
                               (cdr l)))))
       (<span style="color:#66d9ef">else </span>cons (<span style="color:#a6e22e">insertL*</span> new old
                            (car l))
             (<span style="color:#a6e22e">insertL*</span> new old (cdr l))))))


(<span style="color:#66d9ef">define </span>occur*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l <span style="color:#ae81ff">0</span>))
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car l) a)
          (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">occur*</span> a (cdr l))))
         (<span style="color:#66d9ef">else </span>
          (<span style="color:#a6e22e">occur*</span> a (cdr l)))))
      (<span style="color:#a6e22e">else</span>
       (+ (<span style="color:#a6e22e">occur*</span> a (car l))
          (<span style="color:#a6e22e">occur*</span> a (cdr l)))))))

<span style="color:#75715e">;;;;</span>
<span style="color:#75715e">;;;  I introuduce how the (or (null? l) (atom? a))  works,Then I can go on </span>
<span style="color:#75715e">;;;    introuducing the member</span>
<span style="color:#75715e">;;; else implicit said that if the condition is wrong do it recurly</span>
<span style="color:#75715e">;;;      also infer that after the recuring ,please go back to home along the Original road!</span>
(<span style="color:#66d9ef">define </span>member*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#66d9ef">#f</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#66d9ef">or </span>(eq? (car l) a)
           (<span style="color:#a6e22e">member*</span> a (cdr l))))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">or </span>(<span style="color:#a6e22e">member*</span> a (car l))
           (<span style="color:#a6e22e">member*</span> a (cdr l)))))))
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; The function tells:</span>
<span style="color:#75715e">;;;          (condition return values)</span>
<span style="color:#75715e">;;; Can you write down the definition of the function member? and its arguments</span>
<span style="color:#75715e">;;;     and refer to them as you go through the next group of questions????</span>
(<span style="color:#66d9ef">define </span>member?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(eq? (car lat) a)
                (<span style="color:#a6e22e">member?</span> a (cdr lat)))))))



(<span style="color:#66d9ef">define </span>first
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#66d9ef">cond </span>(<span style="color:#66d9ef">else </span>(car p)))))
(<span style="color:#66d9ef">define </span>second
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#a6e22e">cond</span>
      (<span style="color:#66d9ef">else </span>(car (cdr p))))))

<span style="color:#75715e">;;;;Could  after (define subset? )        write a function (intersect?)</span>
(<span style="color:#66d9ef">define </span>intersect?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">cond</span>
          ((<span style="color:#a6e22e">member?</span> (car set1) set2) <span style="color:#66d9ef">#t</span>)
          (<span style="color:#66d9ef">else </span>
            (<span style="color:#a6e22e">intersect?</span> 
              (cdr set1) set2)))))))

(<span style="color:#66d9ef">define </span>intersect1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) <span style="color:#66d9ef">#f</span>)
      ((<span style="color:#a6e22e">member?</span> (car set1) set2) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#66d9ef">else </span>
            (<span style="color:#a6e22e">intersect1?</span> 
              (cdr set1) set2)))))
(<span style="color:#66d9ef">define </span>intersect2?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(<span style="color:#a6e22e">member?</span> (car set1) set2)
                (<span style="color:#a6e22e">intersect1?</span> (cdr set1) set2))))))

(<span style="color:#66d9ef">define </span>intersect
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">member?</span> (car set1) set2)
       (cons (car set1)
             (<span style="color:#a6e22e">intersect</span> (cdr set1) set2)))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">intersect</span> (cdr set1) set2)))))
(<span style="color:#66d9ef">define </span>intersect
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">member?</span> (car set1) set2)
       (cons (car set1)
             (<span style="color:#a6e22e">intersect</span> (cdr set1) set2)))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">intersect</span> (cdr set1) set2)))))

<span style="color:#75715e">;;;; In our words: It is a function that return s all the atoms</span>
<span style="color:#75715e">;;;in set1 that are not in the set2,That is ,xxx is the (set) difference functions=</span>
(<span style="color:#66d9ef">define </span>xxx
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">member?</span> (car set1) set2)
       (<span style="color:#a6e22e">xxx</span> (cdr set1) set2)))
      (<span style="color:#a6e22e">else</span>
        (cons (car set1)
              (<span style="color:#a6e22e">xxx</span> (cdr set1) set2)))))

(<span style="color:#66d9ef">define </span>instersectall
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l-set</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? (cdr l-set)) (car l-set))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">interset</span> (car l-set)
                  (<span style="color:#a6e22e">intersectall</span> (cdr l-set)))))))


(<span style="color:#66d9ef">define </span>union
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
     (<span style="color:#a6e22e">cond</span>
       ((null? set1) set2)
       ((<span style="color:#a6e22e">member?</span> (car set1) set2)
        (<span style="color:#a6e22e">union</span> (cdr set1) set2))
       (<span style="color:#a6e22e">else</span>
        (cons (car set1)
              (<span style="color:#a6e22e">union</span> (cdr set1) (<span style="color:#a6e22e">set2</span>)))))))
(<span style="color:#66d9ef">define </span>build 
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s1</span> s2)
    (<span style="color:#66d9ef">cond </span>
      (<span style="color:#66d9ef">else </span>(cons s1 
                  (cons s2 (<span style="color:#66d9ef">quote </span>())))))))


<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The first part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The second part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;  myracet2.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;Can you write a function  insert-g that would insert either at the left or at the right!!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;Which pieces differ?</span>
<span style="color:#75715e">;;;              The second lines differ from each other ,In insertL it is:</span>
<span style="color:#75715e">;;;               ((eq? (car l) old)</span>
<span style="color:#75715e">;;;                (cons new (cons old (cdr l))))</span>
<span style="color:#75715e">;;;               But in the insertR it is:</span>
<span style="color:#75715e">;;;               ((eq? (car l) old)</span>
<span style="color:#75715e">;;;                (cons new (cons old (cdr l))))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         Put the difference in words!</span>
<span style="color:#75715e">;;;               We say:</span>
<span style="color:#75715e">;;;                      &#34;The two functions cons old and new in a different order onto the cdr of the list l</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         So how can we get rid of the difference &gt;</span>
<span style="color:#75715e">;;;                You probably guessed it: by passing in a function that expresses tha appropriate consing.</span>
(<span style="color:#66d9ef">define </span>seqL
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
    (cons new (cons old l))))
(<span style="color:#66d9ef">define </span>seqR
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
    (cons old (cons new l))))

<span style="color:#75715e">;;; so you can (insert-g seqL)  (insert-g seqR)</span>
<span style="color:#75715e">;;; (define insertL (insert-g seqL))</span>
<span style="color:#75715e">;;; (define insertR (insert-g seqR))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>insert-g
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">seq</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
      (<span style="color:#a6e22e">cond</span>
        ((null? l) (<span style="color:#66d9ef">quote </span>()))
        ((eq? (car l) old)
         (<span style="color:#a6e22e">seq</span> new old (cdr l)))
        (<span style="color:#66d9ef">else </span>(cons (car l)
                    ((<span style="color:#a6e22e">insert-g</span> seq) new old
                                    (cdr l))))))))
<span style="color:#75715e">;;; So we can define insertL again with insert-g *****************************^-^************************************</span>
<span style="color:#75715e">;;; Do not pass in seqL this time.</span>
(<span style="color:#66d9ef">define </span>insertL1
  (<span style="color:#a6e22e">insert-g</span>
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
      (cons new (cons old l)))))

<span style="color:#75715e">;;;;;; Perfect--- it is  a great abstraction!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;Is it better?</span>
<span style="color:#75715e">;;;      Yes,Because youu do not need to remember as many names,you can</span>
<span style="color:#75715e">;;;      (rember func-name &#34;your-mind&#34;) </span>
<span style="color:#75715e">;;;                Where func-name is seqL</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;                Do you remember the definition of subst</span>
<span style="color:#75715e">;;;                Yes! it looks like insert-L  insertR  .Just the answer of the second cond-line is differenct</span>

(<span style="color:#66d9ef">define </span>subst
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      ((eq? (car l) old)
       (cons new (cdr l)))
      (<span style="color:#66d9ef">else </span>(cons (car l)
                  (<span style="color:#a6e22e">subst</span> new old (cdr l)))))))

<span style="color:#75715e">;subst insertL insertR the common property is else and different </span>
<span style="color:#75715e">;operator so we can abstract them to the insert-g</span>
(<span style="color:#66d9ef">define </span>seqS
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
    (cons new l)))

(<span style="color:#66d9ef">define </span>subst1 (<span style="color:#a6e22e">insert-g</span> seqS))

(<span style="color:#66d9ef">define </span>seqrem
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
    l))
(<span style="color:#66d9ef">define </span>yyy
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    ((<span style="color:#a6e22e">insert-g</span> seqrem) <span style="color:#66d9ef">#f</span> a l)))
<span style="color:#75715e">;;;;;What do you yyy is?</span>
<span style="color:#75715e">;;;            Surprise ! It is our old friend rember,</span>
<span style="color:#75715e">;;;            Step through the evaluation of (yyy a l)</span>
<span style="color:#75715e">;;;            where </span>
<span style="color:#75715e">;;;                a  is sausage</span>
<span style="color:#75715e">;;;                and l is (pizza with sausage and bacon)</span>
<span style="color:#75715e">;;;             What role does #f paly?</span>
<span style="color:#75715e">;;;             New in the insertL and insertR   ,a is old in the insertL and insertR</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;             **********************************************************************</span>
<span style="color:#75715e">;;;             THe ninth commandments:</span>
<span style="color:#75715e">;;;              Abstract the common patterns with a new function.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;             **********************************************************************</span>
<span style="color:#75715e">;;;</span>

<span style="color:#75715e">;;;So can you simplify the function (define value1)</span>
<span style="color:#75715e">;;; Can you write the funciton atom-to-function </span>
<span style="color:#75715e">;;;         which:</span>
<span style="color:#75715e">;;;               1: Taes one argument x </span>
<span style="color:#75715e">;;;               2: returns the function + if (eq? x (quote +))</span>
<span style="color:#75715e">;;;                  returns the function * if (eq? x (quote *))</span>
<span style="color:#75715e">;;;                  returns the function expr if (eq? x (quote expr))</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>atom-to-function
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#a6e22e">cond</span>
      ((eq? x (<span style="color:#66d9ef">quote </span>+) +))
      ((eq? x (<span style="color:#66d9ef">quote </span>*) *))
      (<span style="color:#66d9ef">else </span>expr))))
<span style="color:#75715e">;;;(atom-to-function (operator nexp))</span>

(<span style="color:#66d9ef">define </span>value3
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">nexp</span>)
    ((<span style="color:#a6e22e">atom?</span> nexp) nexp)
    (<span style="color:#a6e22e">else</span>
      ((<span style="color:#a6e22e">atom-to-function</span>
         (<span style="color:#a6e22e">operator</span> nexp))
       (<span style="color:#a6e22e">value3</span> (<span style="color:#ae81ff">1</span>st-sub-exp nexp))
       (<span style="color:#a6e22e">value3</span> (<span style="color:#ae81ff">2</span>nd-sub-exp nexp))))))


(<span style="color:#66d9ef">define </span>multirember
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      ((eq? (car lat) a)
       (<span style="color:#a6e22e">multirember</span> a (cdr lat)))
      (<span style="color:#66d9ef">else </span>(cons (car lat)
                  (<span style="color:#a6e22e">multirember</span> a (cdr lat)))))))

(<span style="color:#66d9ef">define </span>multirember-f
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">test?</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
      (<span style="color:#66d9ef">cond </span>
        ((null? lat) (<span style="color:#66d9ef">quote </span>()))
        ((<span style="color:#a6e22e">test?</span> a (car lat))
         ((<span style="color:#a6e22e">multirember-f</span> test?) a
                               (cdr lat)))
        (<span style="color:#66d9ef">else </span>(cons (car lat)
                    ((<span style="color:#a6e22e">multirember</span> test?)  a 
                                          (cdr lat))))))))

(<span style="color:#66d9ef">define </span>multirember-eq? (<span style="color:#a6e22e">multirember-f</span> <span style="color:#e6db74">&#39;eq?</span>))

<span style="color:#75715e">;;; After the insturciton os a pair----&gt;  </span>
(<span style="color:#66d9ef">define </span>first
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#66d9ef">cond </span>
      (<span style="color:#66d9ef">else </span>(car p)))))
(<span style="color:#66d9ef">define </span>second 
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#66d9ef">cond </span>
      (<span style="color:#66d9ef">else </span>(car (cdr p))))))
(<span style="color:#66d9ef">define </span>third
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#66d9ef">cond </span>
      (<span style="color:#66d9ef">else </span>(car (cdr (cdr p)))))))
(<span style="color:#66d9ef">define </span>third1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (car (cdr (cdr l)))))
(<span style="color:#66d9ef">define </span>build
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s1</span> s2)
    (<span style="color:#66d9ef">cond </span>
      (<span style="color:#66d9ef">else </span>(cons s1
                  (cons s2 (<span style="color:#66d9ef">quote </span>())))))))

<span style="color:#75715e">;;;; After the (define fun?)</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>revrel
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">rel</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? rel) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (cons (<span style="color:#a6e22e">build</span>
              (<span style="color:#a6e22e">second</span>  (car rel))
              (<span style="color:#a6e22e">first</span> (car rel)))
             (<span style="color:#a6e22e">revrel</span> (cdr rel)))))))
<span style="color:#75715e">;; maybe we can abstract the build part,because it&#39;s the pair part</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;; Now do you see how representabtion aids readability????</span>
<span style="color:#75715e">;;         second   first is the (car (car rel))         second is (car (cdr (car rel)</span>
<span style="color:#75715e">;; so it can hide the build inverse process </span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;; Suppose we had the funciton revpair that reversed the two componets of a pair like this:</span>
<span style="color:#75715e">;;</span>
(<span style="color:#66d9ef">define </span>revpair<span style="color:#75715e">;;hide the build process</span>
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">pair</span>)
    (<span style="color:#a6e22e">build</span> (<span style="color:#a6e22e">second</span> pair) (<span style="color:#a6e22e">first</span> pair))))

(<span style="color:#66d9ef">define </span>revrel1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">rel</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? rel) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (cons (<span style="color:#a6e22e">revpair</span> (car rel))<span style="color:#75715e">;so it can be hided</span>
             (<span style="color:#a6e22e">revrel1</span> (cdr rel)))))))
(<span style="color:#66d9ef">define </span>member?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(eq? (car lat) a)
                (<span style="color:#a6e22e">member?</span> a (cdr lat)))))))
  
<span style="color:#75715e">;;; The 7 chapter ,,after the numbered</span>
(<span style="color:#66d9ef">define </span>set?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">cond </span>
         ((<span style="color:#a6e22e">member?</span> (car lat) (cdr lat)) <span style="color:#66d9ef">#f</span>
               )
         (<span style="color:#a6e22e">else</span>
          (<span style="color:#a6e22e">set?</span> (cdr lat))))))))

<span style="color:#75715e">;;; simplify set?              -------------------------&lt;&lt;&lt;&lt;&lt;&lt;</span>
(<span style="color:#66d9ef">define </span>set1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) <span style="color:#66d9ef">#t</span>)
      ((<span style="color:#a6e22e">member?</span> (car lat) (cdr lat)) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">set?</span> (cdr lat))))))
<span style="color:#75715e">;;; Were you surprised to see the function member? appear in the definition of set?</span>
<span style="color:#75715e">;;;       You should not be,because we have written memeber? already,and now we can </span>
<span style="color:#75715e">;;;       use it whenever we want</span>
         

(<span style="color:#66d9ef">define </span>makeset
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">member?</span> (car lat) (cdr lat))
       (<span style="color:#a6e22e">makeset</span> (cdr lat)))
      (<span style="color:#66d9ef">else </span>(cons (car lat)
                  (<span style="color:#a6e22e">makeset</span> (cdr lat)))))))
(<span style="color:#66d9ef">define </span>makeset1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>(cons (car lat)
                  (<span style="color:#a6e22e">makeset</span> (<span style="color:#a6e22e">multirember</span> (car lat) (cdr lat))))))))
<span style="color:#75715e">;;; Describe in your own words how the second definition of makeset works?????</span>
<span style="color:#75715e">;;;        Here are our words:</span>
<span style="color:#75715e">;;;         &#34;&#34;THe function makeset remembers to cons the first atom in the lat onto the result of the</span>
<span style="color:#75715e">;;;          natural recursion ,after removing all occurences of the first atom from the rest of the lat.</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>subset?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">cond</span>
              ((<span style="color:#a6e22e">member?</span> (car set1) set2)
               (<span style="color:#a6e22e">subset?</span> (cdr set1) set2))
              (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>))))))

<span style="color:#75715e">;;; can you  write a shorter version of subset?</span>
(<span style="color:#66d9ef">define </span>subset1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) <span style="color:#66d9ef">#t</span> )
      ((<span style="color:#a6e22e">member?</span> (car set1) set2)
       (<span style="color:#a6e22e">subset?</span> (cdr set1) set2))
      (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>)))

<span style="color:#75715e">;;; Try to write subset1? with (and ...)</span>

(<span style="color:#66d9ef">define </span>subset2?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">member?</span> (car set1) set2)
             (<span style="color:#a6e22e">subset?</span> (cdr set1) set2))))))

<span style="color:#75715e">;;; equip list</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>eqset?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">subset?</span> set1 set2)
       (<span style="color:#a6e22e">subset?</span> set2 set1))
      (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>))))
(<span style="color:#66d9ef">define </span>eqset1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      (<span style="color:#a6e22e">else</span>
      (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">subset?</span> set1 set2)
       (<span style="color:#a6e22e">subset?</span> set2 set1))))))

(<span style="color:#66d9ef">define </span>eqset2?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
      (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">subset?</span> set1 set2)
       (<span style="color:#a6e22e">subset?</span> set2 set1))))


(<span style="color:#66d9ef">define </span>firsts
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">rel</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? rel) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (cons (<span style="color:#a6e22e">first</span> (car rel))
             (<span style="color:#a6e22e">firsts</span> (cdr rel)))))))
(<span style="color:#66d9ef">define </span>seconds
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">rel</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? rel) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (cons (<span style="color:#a6e22e">second</span> (car rel))
             (<span style="color:#a6e22e">seconds</span> (cdr rel)))))))
<span style="color:#75715e">;; one important known : in the (else,things is called recur</span>
<span style="color:#75715e">;; in the cond&#39;s first question is called the end condtion</span>
<span style="color:#75715e">;; multi and sigle is recognise by the doing&#39;s if satisfied the </span>
<span style="color:#75715e">;; questions!</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;; After te define (pair)</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;Is fun? a simple one-liner?  It sure is</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;How do we reprensent a finite function?</span>
<span style="color:#75715e">;;       For us(lispers)m</span>
<span style="color:#75715e">;;                         a finite function is a list of pairs in which</span>
<span style="color:#75715e">;;                         no first element of any pair is the same as any</span>
<span style="color:#75715e">;;                         other first element</span>
(<span style="color:#66d9ef">define </span>fun?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">rel</span>)
    (<span style="color:#a6e22e">set?</span> (<span style="color:#a6e22e">firsts</span> rel))))


<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>fullfun?<span style="color:#75715e">;;fun is also a relation</span>
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">fun</span>)<span style="color:#75715e">;;fullfun is based on the fun</span>
    (<span style="color:#a6e22e">set?</span> (<span style="color:#a6e22e">seconds</span> fun))))

<span style="color:#75715e">;;fullfun&#39;s another name is one-to-one</span>
<span style="color:#75715e">;;so we can define it another way</span>
(<span style="color:#66d9ef">define </span>one-to-one?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">fun</span>)
    (<span style="color:#a6e22e">fun?</span> (<span style="color:#a6e22e">revrel</span> fun))))


(<span style="color:#66d9ef">define </span>expr
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m) <span style="color:#ae81ff">1</span>)
      (<span style="color:#a6e22e">else</span>
       (* n (<span style="color:#a6e22e">expr</span> n (- m <span style="color:#ae81ff">1</span>)))))))

(<span style="color:#66d9ef">define </span>cookies
  (<span style="color:#66d9ef">lambda </span>()
    (<span style="color:#a6e22e">bake</span>
      (<span style="color:#66d9ef">quote </span>(<span style="color:#ae81ff">350</span> degrees))
      (<span style="color:#66d9ef">quote </span>(<span style="color:#ae81ff">12</span> minitus))
      (<span style="color:#a6e22e">mix</span>
        (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">walnuts</span> <span style="color:#ae81ff">1</span> cup))
        (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">chocolate-chips</span> <span style="color:#ae81ff">16</span> ounces))
        mix
        (<span style="color:#a6e22e">mix</span>
          (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">flour</span> <span style="color:#ae81ff">2</span> cups))
          (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">oatmeal</span> <span style="color:#ae81ff">2</span> cups))
          (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">salt</span> <span style="color:#f92672">.</span><span style="color:#ae81ff">5</span> teaspoon))
          (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">baking-powder</span> <span style="color:#ae81ff">1</span> teaspoon))
          (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">baking-soda</span> <span style="color:#ae81ff">1</span> teaspoon)))
        (<span style="color:#a6e22e">mix</span>
          (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">eggs</span> <span style="color:#ae81ff">2</span> large))
          (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">vanilla</span> <span style="color:#ae81ff">1</span> teaspoon))
          (<span style="color:#a6e22e">cream</span>
            (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">butter</span> <span style="color:#ae81ff">1</span> cup))
            (<span style="color:#66d9ef">quote </span>(<span style="color:#a6e22e">sugar</span> <span style="color:#ae81ff">2</span> cups))))))))
<span style="color:#75715e">;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Y</span>
<span style="color:#75715e">;;;The Fifth commandments:</span>
<span style="color:#75715e">;;;  When building a  value with +, always use 0 for the value of the terminating line,for adding 0 does not change the value of an addiction</span>
<span style="color:#75715e">;;;  When building a  value with *, always use 1 for the value of the termination line,for multiplying 1 does not change the value of a multiplication</span>
<span style="color:#75715e">;;;  When building a  value with cons, always consider () for the value of the terminating line</span>
<span style="color:#75715e">;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Y</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What does (tup+ tup1 tup2) do?</span>
<span style="color:#75715e">;;;         It adds the first number of tup1 to the first number of tup2,then it adds the second number of tup1 to the second number of tup2,etc</span>
<span style="color:#75715e">;;;               building a tup of answers,for tups of the same length</span>
<span style="color:#75715e">;;; What is the unusal about tup+?</span>
<span style="color:#75715e">;;;         It looks at each element of two tups at the same time,or in other words, it recus on two tups.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; If you recur on one tup how many questions do you have to ask?</span>
<span style="color:#75715e">;;;         two,they are (null? tup) and else</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; When recuring on two tups, how many question need to be asked about the tups? </span>
<span style="color:#75715e">;;;      Four: if the first tup is empty or none-empty,and if the second tup is empty or non-emptyy</span>
<span style="color:#75715e">;;;      Do you mean the questions (and (null? tup1) (null? tup2)) (null? tup1) (null? tup2) and else </span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      But can the first tup be () at the same time as the second is other than ().</span>
<span style="color:#75715e">;;;         No ,because the tups must have the same length</span>
<span style="color:#75715e">;;;     Does this mean (and (null? tup1) (null? tup2))  and else are the only questions we need to ask?</span>
<span style="color:#75715e">;;;     Yes!</span>
(<span style="color:#66d9ef">define </span>tup+
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup1</span> tup2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#66d9ef">and </span> (null? tup1) (null? tup2))
       (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
        (cons (+ (car tup1) (car tup2))
              (<span style="color:#a6e22e">tup+</span> (cdr tup1) (cdr tup2)))))))
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;  Why  does the natural recursion include the cdr of bouth arguments?</span>
<span style="color:#75715e">;;;      Because the typical element of the final value use the car of both tups,so now</span>
<span style="color:#75715e">;;;      we are ready to consider the rest of both tups -----------------------------&lt;&lt;&lt;&lt;&lt;&lt;Yes the right logic</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
(<span style="color:#66d9ef">define </span>tup++
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup1</span> tup2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#66d9ef">and </span>(null? tup1) (null? tup2)) 
       (<span style="color:#66d9ef">quote </span>()))
      ((null? tup1) tup2)
      ((null? tup2) tup1)
      (<span style="color:#a6e22e">else</span>
        (cons (+ (car tup1) (car tup2))
              (<span style="color:#a6e22e">tup++</span>  
                (cdr tup1) (cdr tup2)))))))

<span style="color:#75715e">;;;; can you simplify it????????????????????????????////</span>
(<span style="color:#66d9ef">define </span>tup+++
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup1</span> tup2)
    (<span style="color:#a6e22e">cond</span>
      ((null? tup1) tup2)
      ((null? tup2) tup1)
      (<span style="color:#a6e22e">else</span>
        (cons (+ (car tup1) (car tup2))
              (<span style="color:#a6e22e">tup+++</span>  
                (cdr tup1) (cdr tup2)))))))



(<span style="color:#66d9ef">define </span>atom-to-function
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#66d9ef">cond </span>
      ((eq? x (<span style="color:#66d9ef">quote </span>+)) +)
      ((eq? x (<span style="color:#66d9ef">quote </span>*)) *)
      ((eq? x (<span style="color:#66d9ef">quote </span>^)) expr)
      ((eq? x (<span style="color:#66d9ef">quote </span>eq?)) eq?)
      (<span style="color:#66d9ef">else </span>-))))
<span style="color:#75715e">; (rember-f (atom-to-function &#39;eq?) &#39;ff &#39;(dfds gi ff sd))  </span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; In the common lisp:</span>
<span style="color:#75715e">;            L: (funcall test? (car l) a) ,use the funcall when invoking a function argument or a function that has </span>
<span style="color:#75715e">;            not been defuned</span>
(<span style="color:#66d9ef">define </span>rember-f
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">test?</span> a l)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">cond </span>
         ((<span style="color:#a6e22e">test?</span> (car l) a) (cdr l))<span style="color:#75715e">;;I think here needs atom2function</span>
         (<span style="color:#66d9ef">else </span>(cons (car l)
                     (<span style="color:#a6e22e">rember-f</span> test? a 
                               (cdr l)))))))))

<span style="color:#75715e">;;; The short version! </span>
(<span style="color:#66d9ef">define </span>rember1-f
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">test?</span> a l)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">test?</span> (car l) a) (cdr l))<span style="color:#75715e">;;I think here needs atom2function</span>
      (<span style="color:#66d9ef">else </span>(cons (car l)
                     (<span style="color:#a6e22e">rember-f</span> test? a 
                               (cdr l)))))))
<span style="color:#75715e">;;; What kind of values can functions return&gt;</span>
<span style="color:#75715e">;;;                  Lists and atoms</span>
<span style="color:#75715e">;;;                       But in the eye of us ,all the things are the lists and atoms</span>
<span style="color:#75715e">;;;                        so we can return all the kind of values</span>
<span style="color:#75715e">;;;                        so what about function themselves? Yes</span>
<span style="color:#75715e">;;;                         such as (lambda (a l) ...) is a function of two arguments ,a and l! returns the function!</span>
<span style="color:#75715e">;;;                 This is calld &#34;Curry-ing&#34;</span>
<span style="color:#75715e">;;;     In the scheme ,Using (define ...)give the preceding function a name,</span>
<span style="color:#75715e">;;;     but in theCL: (define eq?-c  (a) (function (lambda (x) (eq x a))))</span>
<span style="color:#75715e">;;;     while the scheme : (define eq?-c (lambda (a) (lambda (x) (eq? x a))))</span>

(<span style="color:#66d9ef">define </span>insertL-f
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">test?</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
      (<span style="color:#66d9ef">cond </span>
        (( null? l) (<span style="color:#66d9ef">quote </span>()))
        ((<span style="color:#a6e22e">test?</span> (car l) old)
         (cons new (cons old (cdr l))))
        (<span style="color:#66d9ef">else </span>(cons (car l)
                    ((<span style="color:#a6e22e">insertL-f</span> test?) new old
                                       (cdr l))))))))
(<span style="color:#66d9ef">define </span>insertR-f
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">test?</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l)
      (<span style="color:#66d9ef">cond </span>
        (( null? l) (<span style="color:#66d9ef">quote </span>()))
        ((<span style="color:#a6e22e">test?</span> (car l) old)
         (cons old (cons new (cdr l))))
        (<span style="color:#66d9ef">else </span>(cons (car l)
                    ((<span style="color:#a6e22e">insertR-f</span> test?) new old
                                       (cdr l))))))))
<span style="color:#75715e">;;The basic principle</span>
<span style="color:#75715e">;;(name --&gt;(null? ---&gt;(eq?    ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;                ---&gt;(eqan?   ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;                ---&gt;(equal?  ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;                ---&gt;(eqlist? ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;sometimes we abstuct the condition to adapt to different state</span>
<span style="color:#75715e">;; sometimes we abstuct the operations to simplify it</span>
(<span style="color:#66d9ef">define </span>multirember1 
 (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
   (<span style="color:#a6e22e">cond</span>
     ((null? lat) (<span style="color:#66d9ef">quote </span>()))
     ((eq? (car lat) a)
      (<span style="color:#a6e22e">multirember</span> a (cdr lat)))
     (<span style="color:#66d9ef">else </span>(cons (car lat)
                 (<span style="color:#a6e22e">multirember</span> a (cdr lat)))))))
(<span style="color:#66d9ef">define </span>multirember1-f
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">test?</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
      (<span style="color:#a6e22e">cond</span>
        ((null? lat) (<span style="color:#66d9ef">quote </span>()))
        ((<span style="color:#a6e22e">test?</span> a (car lat))
         ((<span style="color:#a6e22e">multirember1-f</span> test?) a 
                                (cdr lat)))
        (<span style="color:#66d9ef">else </span>(cons (car lat)
                    ((<span style="color:#a6e22e">multirember1-f</span> test?)  a 
                                            (cdr lat))))))))
<span style="color:#75715e">;;((multirember1-f (atom-to-function &#39;eq?)) &#39;fd &#39;(sgs fd gasdg fd))</span>
<span style="color:#75715e">;;&#39;(sgs gasdg)</span>
<span style="color:#75715e">;;(define multirember1-eq (multirember1-f (atom-to-function &#39;eq?)))</span>
<span style="color:#75715e">;;Actually:</span>
<span style="color:#75715e">;;((multirember1-f eq?) &#39;fd &#39;(gsd fd gjsi fd go))</span>
<span style="color:#75715e">;;direct apply function eq?,That doesn&#39;t need (eq?, I learn from</span>
<span style="color:#75715e">;; (multiremberT eq?-salad)</span>
(<span style="color:#66d9ef">define </span>rembern
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    ((<span style="color:#a6e22e">insert-g</span> seqrem) <span style="color:#66d9ef">#f</span> a l)))<span style="color:#75715e">;;seqrem doesn&#39;t need (seqrem solve my ?.</span>
(<span style="color:#66d9ef">define </span>seqrem
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> old l) 
    l))

(<span style="color:#66d9ef">define </span>multiremberT
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">test?</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">test?</span> (car lat))
       (<span style="color:#a6e22e">multiremberT</span> test? (cdr lat)))
      (<span style="color:#a6e22e">else</span>
       (cons (car lat)
             (<span style="color:#a6e22e">multiremberT</span> test? 
                           (cdr lat)))))))
(<span style="color:#66d9ef">define </span>eq?-c
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
      (eq? x a))))
(<span style="color:#66d9ef">define </span>eq?-salad (<span style="color:#a6e22e">eq?-c</span> <span style="color:#e6db74">&#39;salad</span>))
<span style="color:#75715e">;;(multiremberT eq?-salad &#39;(fsfd salad fsdf sald sg salad))</span>

<span style="color:#75715e">;;; What is the name of the third arguments that multiremberco uses for the natural recursion?</span>
<span style="color:#75715e">;;; what is the name of the third argument ? And do you know what col stands for?</span>
<span style="color:#75715e">;;;       The name col is short for &#34;collector&#34;, A collector is sometimes called a continuation</span>
(<span style="color:#66d9ef">define </span>multiremberco
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat col)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat)
       (<span style="color:#a6e22e">col</span> (<span style="color:#66d9ef">quote </span>()) (<span style="color:#66d9ef">quote </span>())))
      ((eq? (car lat) a)
       (<span style="color:#a6e22e">multiremberco</span> a 
                      (cdr lat)
                      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> seen) 
                        (<span style="color:#a6e22e">col</span> newlat (cons (car lat) seen)))))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">multiremberco</span> a 
                      (cdr lat)
        )             (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> seen)
                        (<span style="color:#a6e22e">col</span> (cons (car lat) newlat)
                             seen)))))))

(<span style="color:#66d9ef">define </span>a-friend
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span> y)
    (null? y)))
<span style="color:#75715e">;(multiremberco &#39;tuna &#39;(sfds tuna fsd jif) a-friend)</span>
<span style="color:#75715e">;#f</span>
<span style="color:#75715e">;&gt; (multiremberco &#39;tuna &#39;(sfds tuna1 fsd jif) a-friend)</span>
<span style="color:#75715e">;#t</span>
<span style="color:#75715e">;;how can  you get another value in the col</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;can you write this definition differently!  Do you mean the new way where we put tuna into the definition?</span>
<span style="color:#75715e">;;  col is to a-frined what (car lat) is to tuna.   so we can replace the col with a-frined</span>
<span style="color:#75715e">;;</span>
(<span style="color:#66d9ef">define </span>new-friend
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> seen)
    (<span style="color:#a6e22e">a-friend</span> newlat
         (cons (<span style="color:#66d9ef">quote </span>tuna) seen))))

<span style="color:#75715e">;;;; So ANd now?</span>
<span style="color:#75715e">;;;      multiremberco finds out that(null? lat) is true, which means that it uses the collector on two empty lists.</span>
<span style="color:#75715e">;;;        which collector is this?</span>
<span style="color:#75715e">;;;          It is new-friend.</span>
<span style="color:#75715e">;;; how does a-friend differ from new-friend ?</span>
<span style="color:#75715e">;;;              New-friend uses a-friend on the empty list and </span>
<span style="color:#75715e">;;;               the value of (cons (quote tuna) (quote ()))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; And what does the old-collector do (a-friend) with such arguments?</span>
<span style="color:#75715e">;;;              It answers #f,because its second argument is (tuna),which is not the empty list!</span>

<span style="color:#75715e">;;;;;;;; I don&#39;t know that the list length ,so easy but I don&#39;t think it clearly!!!!</span>
<span style="color:#75715e">;;;What is terminal condition ?  (null? lat)</span>
<span style="color:#75715e">;;;what is terminal condition line ? ((null? lat) 0)   (terminal_contition terminal_value)</span>
<span style="color:#75715e">;;;what is the (+1 (length (cdr lat)))</span>
<span style="color:#75715e">;;;        build the number with +,so the terminal condition line is ((null? lat) 0)   use (cdr lat) to closer the terminal!</span>
(<span style="color:#66d9ef">define </span>length
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr lat)))))))

<span style="color:#75715e">;;; a is tuna and lat is (and tuna)  col is a-friend</span>
(<span style="color:#66d9ef">define </span>latest-friend
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> seen)
    (<span style="color:#a6e22e">a-friend</span> (cons (<span style="color:#a6e22e">quotee</span> and) newlat)
              seen))))

<span style="color:#75715e">;;The third collector : the last-friend</span>
(<span style="color:#66d9ef">define </span>last-friend
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> seen)
    (length newlat)))
<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;;;;So  what does (multiremberco a lat f) do?</span>
<span style="color:#75715e">;;;      It looks at every atom of the lat to see whether </span>
<span style="color:#75715e">;;;      it is eq? to a.Those atoms that are  not  are collected in one list ls1</span>
<span style="color:#75715e">;;;      it is eq? to a.The others which the answer is true    are collected in second list ls2</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      Finally  it determine the value of (f ls1 ls2)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      Namely under the process of time(timestep=0,1,2,3,n-1),In the col it classify the data: use cons </span>
<span style="color:#75715e">;;;              while at the last time(timestep=n) in the a-friend (col) it determine the cons datas!!</span>

<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;;;        The Tenth commandments:</span>
<span style="color:#75715e">;;;            Build functions to collect more than one value at a time.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;****************************************************************************</span>
<span style="color:#75715e">;&gt; (multiremberco &#39;tuna &#39;(tunanfdfj tuan jsidjf tuna) last-friend)</span>
<span style="color:#75715e">;3</span>

<span style="color:#75715e">;;actually</span>
<span style="color:#75715e">;;The basic principle</span>
<span style="color:#75715e">;;(name --&gt;(null? (col (quote()...)---&gt;(eq?    ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;                ---&gt;(eqan?   ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;                ---&gt;(equal?  ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;                ---&gt;(eqlist? ---&gt;single (cons new (cdr l))    --&gt;(else</span>
<span style="color:#75715e">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
<span style="color:#75715e">;;sometimes we abstuct the condition to adapt to different state</span>
<span style="color:#75715e">;; sometimes we abstuct the operations to simplify it</span>
<span style="color:#75715e">;;multiremboco sometimes we want to change the return value,so co it</span>

(<span style="color:#66d9ef">define </span>multiinsertLR
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> oldL oldR lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) (<span style="color:#66d9ef">quote </span>()))
      ((eq? (car lat) oldL)
       (cons new 
             (cons oldL
                   (<span style="color:#a6e22e">multiinsertLR</span> new oldL oldR
                                  (cdr lat)))))
      ((eq? (car lat) oldR)
       (cons oldR
             (cons new
                   (<span style="color:#a6e22e">multiinsertLR</span> new oldL oldR
                                 (cdr lat)))))
      (<span style="color:#a6e22e">else</span>
        (cons (car lat)
              (<span style="color:#a6e22e">multiinsertLR</span> new oldL oldR (cdr lat)))))))

<span style="color:#75715e">;;;; The function multiinsertLRco is to multiinsertLR what multiremberco is to multirember</span>
<span style="color:#75715e">;;;           Does this mean that multiinsertLRco takes one more argument than multiinsertLR?</span>
<span style="color:#75715e">;;;            Yes! and what kind of argument is it? </span>
<span style="color:#75715e">;;;                   It is a collector function.</span>
(<span style="color:#66d9ef">define </span>multiinsertLRco
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">new</span> oldL oldR lat col)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat)
       (<span style="color:#a6e22e">col</span> (<span style="color:#66d9ef">quote </span>()) <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>))
      ((eq? (car lat) oldL)
       (<span style="color:#a6e22e">multiinsertLRco</span> new oldL oldR
                        (cdr lat)
                        (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> L R)
                          (<span style="color:#a6e22e">col</span> (cons new 
                                     (cons oldL newlat))
                               (+ <span style="color:#ae81ff">1</span> L) R))))
      ((eq? (car lat) oldR)
       (<span style="color:#a6e22e">multiinsertLRco</span> new oldL oldR
                        (cdr lat)
                        (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> L R)
                          (<span style="color:#a6e22e">col</span> (cons oldR
                                     (cons new newlat))
                               L (+ <span style="color:#ae81ff">1</span> R)))))
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">multiinsertLRco</span> new oldL oldR 
                        (cdr lat)
                        (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newlat</span> L R)
                          (<span style="color:#a6e22e">col</span> (cons (car lat) newlat)
                               L R)))))))

(<span style="color:#66d9ef">define </span>even?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (= (* (/ n <span style="color:#ae81ff">2</span>) <span style="color:#ae81ff">2</span>) n)))

(<span style="color:#66d9ef">define </span>/  <span style="color:#75715e">;rewrite the divide to replace the origianl divide from Drracket</span>
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#a6e22e">cond</span>
      ((&lt; n m) <span style="color:#ae81ff">0</span>)
      (<span style="color:#a6e22e">else</span>
       (+ <span style="color:#ae81ff">1</span> (/ (- n m) m))))))
(<span style="color:#66d9ef">define </span>evens-only*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) (<span style="color:#66d9ef">quote </span>()))
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#a6e22e">cond</span>
         ((even? (car l))
          (cons (car l)
                (<span style="color:#a6e22e">evens-only*</span> (cdr l))))
         (<span style="color:#a6e22e">else</span>
          (<span style="color:#a6e22e">evens-only*</span> (cdr l)))))
      (<span style="color:#66d9ef">else </span>(cons (<span style="color:#a6e22e">evens-only*</span> (car l))
                  (<span style="color:#a6e22e">evens-only*</span> (cdr l)))))))
(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))

<span style="color:#75715e">;;;  Can you explain what (evens-only*co (carl) ...) accomplishes?</span>
<span style="color:#75715e">;;;      It visits every number in the car of l and collects the list without odd numbers,the</span>
<span style="color:#75715e">;;;      product of the even numbers,and the sum of the odd numbers.</span>
<span style="color:#75715e">;;;      So it is the most complicated,actually not very easy to be understood!</span>
<span style="color:#75715e">;;;         You can understand with another lat,so you how to associate two lat!</span>
<span style="color:#75715e">;;;         Youknow (even? (car l)) is in  a lat,so it do +*cons in the lat&#39;s number!</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>evens-only*co
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span> col)
    (<span style="color:#a6e22e">cond</span>
      ((null? l)
       (<span style="color:#a6e22e">col</span> (<span style="color:#66d9ef">quote </span>()) <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>))
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#66d9ef">cond </span>
         ((even? (car l))
          (<span style="color:#a6e22e">evens-only*co</span> (cdr l)
                         (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newl</span> p s)
                           (<span style="color:#a6e22e">col</span> (cons (car l) newl)<span style="color:#75715e">;if it is evens ,so cons it into the newl</span>
                                (* (car l) p) s))))
         (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">evens-only*co</span> (cdr l)
                              (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newl</span> p s)
                                (<span style="color:#a6e22e">col</span> newl p (+ (car l) s)))))))
       (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">evens-only*co</span> (car l)
                            (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">al</span> ap as)
                              (<span style="color:#a6e22e">evens-only*co</span> (cdr l)
                                             (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">dl</span> dp ds)
                                               (<span style="color:#a6e22e">col</span> (cons al dl)
                                                    (* ap dp)
                                                    (+ as ds))))))))))
<span style="color:#75715e">;the fourth collector :: the last-last-friend</span>
(<span style="color:#66d9ef">define </span>the-last-last-friend
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">newl</span> product sum)
    (cons sum 
          (cons product 
                newl))))
<span style="color:#75715e">;&gt; (evens-only*co &#39;(45389 63 45 6 4 234  6 4 23 52 43) the-last-last-friend)</span>
<span style="color:#75715e">;&#39;(45563 7008768 6 4 234 6 4 52)</span>

<span style="color:#75715e">;;;;  after the length !!!!(define length) -------------------------------------&lt;</span>
<span style="color:#75715e">;;;  use car !!   zero?  sub1</span>
(<span style="color:#66d9ef">define </span>pick
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((zero? (<span style="color:#a6e22e">sub1</span> n)) (car lat))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">pick</span> (<span style="color:#a6e22e">sub1</span> n) (cdr lat))))))

(<span style="color:#66d9ef">define </span>rempick
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((zero? (<span style="color:#a6e22e">sub1</span> n)) (cdr lat))
      (<span style="color:#66d9ef">else </span>(cons (car lat)
                  (<span style="color:#a6e22e">rempick</span> (<span style="color:#a6e22e">sub1</span> n) (cdr lat))))
      <span style="color:#75715e">;;;; because n  lat is occur in the terminal condition!!!!!</span>
<span style="color:#75715e">;;; use the function one? to rewrite the function rempick that removes the nth atom from a lat.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>rempick1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> lat)
    (<span style="color:#66d9ef">cond </span>
      ((<span style="color:#a6e22e">one?</span> n) (cdr lat))
      (<span style="color:#66d9ef">else </span>(cons (car lat)
                  (<span style="color:#a6e22e">rempick</span> ((<span style="color:#a6e22e">sub1</span> n)
                            (cdr lat))))))))


(<span style="color:#66d9ef">define </span>keep-looking
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> sorn lat)
    (<span style="color:#a6e22e">cond</span>
      ((number? sorn)
       (<span style="color:#a6e22e">keep-looking</span> a (<span style="color:#a6e22e">pick</span> sorn lat) lat))
      (<span style="color:#66d9ef">else </span>(eq? sorn a)))))


(<span style="color:#66d9ef">define </span>looking
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">keep-looking</span> a (<span style="color:#a6e22e">pick</span> <span style="color:#ae81ff">1</span> lat) lat)))
<span style="color:#75715e">;&gt; (looking &#39;cavier &#39;(6 2 4 cavier 5 7 3))</span>
<span style="color:#75715e">;#t</span>

(<span style="color:#66d9ef">define </span>eternity
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#a6e22e">eternity</span> x)))
<span style="color:#75715e">;;it doesn&#39;t stop ,because the goal is not absolutely, rather then</span>
<span style="color:#75715e">;; 相对的</span>

<span style="color:#75715e">;;; This is trivival; It&#39;s not even recursive</span>
<span style="color:#75715e">;;; What does shift do?</span>
<span style="color:#75715e">;;;   Here are our words:</span>
<span style="color:#75715e">;;;     The shift function takes a pair whose first component is a pair and builds a pair</span>
<span style="color:#75715e">;;;     by shifting the second part of the first component into the second component!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     So what is the meaning of component?  --------Component can means atom,pair and list</span>
<span style="color:#75715e">;;;                  Now it means pair.</span>
(<span style="color:#66d9ef">define </span>shift 
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">pair</span>)
    (<span style="color:#a6e22e">build</span> (<span style="color:#a6e22e">first</span> (<span style="color:#a6e22e">first</span> pair))
           (<span style="color:#a6e22e">build</span> (<span style="color:#a6e22e">second</span> (<span style="color:#a6e22e">first</span> pair))
                  (<span style="color:#a6e22e">second</span> pair)))))
<span style="color:#75715e">;&gt; (shift &#39;((fsd fd)(fd gs)))</span>
<span style="color:#75715e">;&#39;(fsd (fd (fd gs)))</span>
(<span style="color:#66d9ef">define </span>align
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">pora</span>)
    (<span style="color:#66d9ef">cond </span>
      ((<span style="color:#a6e22e">atom?</span> pora) pora)
      ((<span style="color:#a6e22e">a-pair?</span> (<span style="color:#a6e22e">first</span> pora))
       (<span style="color:#a6e22e">align</span> (<span style="color:#a6e22e">shift</span> pora)))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">build</span> (<span style="color:#a6e22e">first</span> pora)
                   (<span style="color:#a6e22e">align</span> (<span style="color:#a6e22e">second</span> pora)))))))
<span style="color:#75715e">;;; What does it  have in common with keep-looking </span>
<span style="color:#75715e">;;;          Both functions change their arguments for their recursive uses but in neither</span>
<span style="color:#75715e">;;;          case is the change guaranteed to get us closer to the goal</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Why are we not guaranteed that align makes progress?</span>
<span style="color:#75715e">;;;                In the second cond-line shift creates an argument for align that </span>
<span style="color:#75715e">;;;                is not a part of the original argument.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Which commandment does that violate?</span>
<span style="color:#75715e">;;;              The Seventh Commandment.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Is the new argument at least  smaller than the original one?</span>
<span style="color:#75715e">;;;            It does not look that way</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Why not?</span>
<span style="color:#75715e">;;;           The function shift only rearranges the pair it gets.</span>
<span style="color:#75715e">;;; And?</span>
<span style="color:#75715e">;;;           Both the result and the argument of shift have the same number of atoms.</span>
<span style="color:#75715e">;;; Can you write a function that counts the number of atoms</span>
<span style="color:#75715e">;;; After the (define intersectall)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;align do what shift can&#39;t do?</span>
<span style="color:#75715e">;;;        Such as  (align &#39;(a b))         but (shift &#39;(a b)) will get wrong message.</span>
(<span style="color:#66d9ef">define </span>a-pair?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> x) <span style="color:#66d9ef">#f</span>)
      ((null? x) <span style="color:#66d9ef">#f</span>)
      ((null? (cdr x)) <span style="color:#66d9ef">#f</span>)
      ((null? (cdr (cdr x))) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>))))
<span style="color:#75715e">;;; how can you refer to the first S-expression of a pair?</span>
<span style="color:#75715e">;;;      By taking the car of the pari</span>
<span style="color:#75715e">;;; How can you refer to the second S-expression of a pair?</span>
<span style="color:#75715e">;;;      By taking the car of the cdr of the pair</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; How can you build a pair with two atoms?</span>
<span style="color:#75715e">;;;  You cons the first ne onto the cons of the second one onto (). Thatis (cons x1 (cons x2 (quote ())))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  How can you build a pair with two S-expressions?</span>
<span style="color:#75715e">;;;   you cns the first one onto the cons of the second one onto ().That is</span>
<span style="color:#75715e">;;;   (cons s1 (cons s2 (quote ()))) or (cons x1 (cons x2 (quote ())))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;   Did you notice the difference between the last two answers?</span>
<span style="color:#75715e">;;;     No ,there aren&#39;t any</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;Is align a partial function?</span>
<span style="color:#75715e">;;;        We don&#39;t now yet.There may be arguments for which it keeps aligning things.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Is there something else that changes about the arguments to align and its recursive uses?</span>
<span style="color:#75715e">;;;        Yes, there is .The first component of a  pair becomes simpler,though the second component becomes more complicated</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; In what way is the first component simpler?</span>
<span style="color:#75715e">;;;       IT is only a part (IT intelligent technique   is equal to it) of the original pair&#39;s first component.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Doesn&#39;t this mean that lenght * is the wrong function for determining the length of the argument? Can you find a better function</span>
<span style="color:#75715e">;;;         A better function should pay more attention to the first component</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; How much more attention should we pay to the first component?</span>
<span style="color:#75715e">;;;          At least twice as much</span>
<span style="color:#75715e">;;;          Do you mean something like weight*</span>
<span style="color:#75715e">;;;     DOes This mean that the arguments get simpler?</span>
<span style="color:#75715e">;;;       Yes ,the weigth* of align&#39;s arguments become successively smaller</span>
<span style="color:#75715e">;;;     Is align a partial function?</span>
<span style="color:#75715e">;;;        No,it yields a value for every argument rather than the partial function looking and looking again.</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>length*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">pora</span>)
    (<span style="color:#66d9ef">cond </span>
      (( atom? pora) <span style="color:#ae81ff">1</span>)
      (<span style="color:#a6e22e">else</span>
       (+ (<span style="color:#a6e22e">length*</span> (<span style="color:#a6e22e">first</span> pora))
          (<span style="color:#a6e22e">length*</span> (<span style="color:#a6e22e">second</span> pora)))))))
(<span style="color:#66d9ef">define </span>weight*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">pora</span>)
    (<span style="color:#66d9ef">cond </span>
      ((<span style="color:#a6e22e">atom?</span> pora) <span style="color:#ae81ff">1</span>)
      (<span style="color:#a6e22e">else</span>
       (+ (* (<span style="color:#a6e22e">weight*</span> (<span style="color:#a6e22e">first</span> pora)) <span style="color:#ae81ff">2</span>)
          (<span style="color:#a6e22e">weight*</span> (<span style="color:#a6e22e">second</span> pora)))))))
<span style="color:#75715e">;;;  Here is shuffle which is like align but uses revpair from chapter7, instead of shift:(when the first component is a-pair?</span>
<span style="color:#75715e">;;;       THen do revpair.</span>
<span style="color:#75715e">;;; The function shuffle and revpair swap the components of pairs when the first component is a pair...</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Does this mean that shuffle is total?</span>
<span style="color:#75715e">;;;        We don&#39;t know yet.(actually  it is not.)</span>
<span style="color:#75715e">;;; Okay,let&#39;s do something interesting. What is the value of (shuffle x) where x is ((a b) (c d))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; And how are you going to do that?</span>
<span style="color:#75715e">;;;          We are going to determine the value (shuffle pora) where pora is ((c d) (a b))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Doesn&#39;t this mean that we need to know the value of (shuffle (revpair pora))</span>
<span style="color:#75715e">;;;            where (revpair pora) is ((a b) (c d))  , yes we do.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; And?</span>
<span style="color:#75715e">;;;         The function shuffle is not total because it now swaps the components of the pair again, which means that we start all over.</span>
(<span style="color:#66d9ef">define </span>shuffle
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">pora</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> pora) pora)
      ((<span style="color:#a6e22e">a-pair?</span> (<span style="color:#a6e22e">first</span> pora))
       (<span style="color:#a6e22e">shuffle</span> (<span style="color:#a6e22e">revpair</span> pora)))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">build</span> (<span style="color:#a6e22e">first</span> pora)
                   (<span style="color:#a6e22e">shuffle</span> (<span style="color:#a6e22e">second</span> pora)))))))
<span style="color:#75715e">;&gt; (shuffle &#39;(a (b c)))</span>
<span style="color:#75715e">;&#39;(a (b c))</span>
<span style="color:#75715e">;&gt; (shuffle &#39;(a b c))</span>
<span style="color:#75715e">;&#39;(a b)</span>
<span style="color:#75715e">;&gt; (shuffle &#39;(a b))</span>
<span style="color:#75715e">;&#39;(a b)</span>
<span style="color:#75715e">;;;;         Thankyou ,Lother Collatz(1910-1990)! It doesn&#39;t yield a value for 0, but otherwise nobody knows.</span>
(<span style="color:#66d9ef">define </span>C
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">one?</span> n) <span style="color:#ae81ff">1</span>)
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">cond</span>
          ((even? n) (<span style="color:#a6e22e">C</span> (/ n <span style="color:#ae81ff">2</span>)))
          (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">C</span> (<span style="color:#a6e22e">add1</span> (* <span style="color:#ae81ff">3</span> n)))))))))

<span style="color:#75715e">;;;;          Thank you,Wilhelm ackermann(1853-1946)</span>
(<span style="color:#66d9ef">define </span>A
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> m)
    (<span style="color:#a6e22e">cond</span>
      ((zero? n) (+ <span style="color:#ae81ff">1</span> m))
      ((zero? m) (<span style="color:#a6e22e">A</span> (- <span style="color:#ae81ff">1</span> n) <span style="color:#ae81ff">1</span>))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">A</span> (<span style="color:#a6e22e">sub1</span> n)
               (<span style="color:#a6e22e">A</span> n (<span style="color:#a6e22e">sub1</span> m)))))))
<span style="color:#75715e">;;; What does A have in common with shuffle and looking?</span>
<span style="color:#75715e">;;;         A&#39;s arguments ,like shuffle&#39;s and looking&#39;s,  do not necessarily decrease for the recursion</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Dose A always give an answer? </span>
<span style="color:#75715e">;;;         Yes,it&#39;s total</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Wouldn&#39;t it be great if we could write a function that tells us whether some function returns with a </span>
<span style="color:#75715e">;;; value for every  argument.</span>
<span style="color:#75715e">;;;        It sure would.Now that we have seen function that never return a value or return a value so lat that </span>
<span style="color:#75715e">;;;        it is too late ,we should have some tool like this around</span>
<span style="color:#75715e">;;;Okay,let&#39;s write it</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;            It sounds complicated.A function can work for many different arguments</span>
<span style="color:#75715e">;;; Then let&#39;s make it simpler.For a warm-up exercise,let&#39;s focus on a function that checks whether some function stops</span>
<span style="color:#75715e">;;; for just the empty list,the simplest of all arguments.</span>
<span style="color:#75715e">;;;          That world simplify it a lot</span>
<span style="color:#75715e">;;; Here is the beginning of this function:</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; (define will-stop?  (lambda (f) ...)))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What does it do?  Do will-stop? return a value for all arguments?</span>
<span style="color:#75715e">;;; That&#39;s the easy part: we said that it either returns #t or #f,depending on whether the argument stops when applied to ()</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Is will-stop? total then?</span>
<span style="color:#75715e">;;;   Yes,it is.It always return #t or #f</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;okay here is  a function that could be an interesting argument for will-stop?</span>
(<span style="color:#66d9ef">define </span>last-try
  (<span style="color:#a6e22e">lambda</span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#66d9ef">and </span>(<span style="color:#a6e22e">will-stop?</span> last-try)
         (<span style="color:#a6e22e">eternity</span> x)))))

    <span style="color:#75715e">;;; what is (will-stop? last-try)</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;; What does it do?</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;; Here is our meaning:</span>
    <span style="color:#75715e">;;;    &#34;we took a really close look at the two possible cases.IF we can define will-stop?,</span>
    <span style="color:#75715e">;;;     then (will-stop? last-try) must yield either #t or #f.Bu it cannot- due to the very</span>
    <span style="color:#75715e">;;;     definition of what will-stop? is supposed to do.This must mean that will-stop? cannot </span>
    <span style="color:#75715e">;;;     be defined&#34;</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;;     Because you know,let&#39;s make up some examples.</span>
    <span style="color:#75715e">;;;     what is the value of (will-stop? last-try) (eternity (quote ()))))</span>
    <span style="color:#75715e">;;;         That depends on the value of (will-stop? last-try)</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;;         we said that will-stop? will stop,so it must return #t or #f,</span>
    <span style="color:#75715e">;;;         let&#39;s say (will-stop? last-try) is #f ,yes,itis .we predict just the opposite</span>
    <span style="color:#75715e">;;;            if the value of (will-stop? last-try) is #f,which really means that last-try</span>
    <span style="color:#75715e">;;;            will not stop..</span>
    <span style="color:#75715e">;;;        So we must have been wrong about (will-stop? last-try) (because it cannot be stopped)</span>
    <span style="color:#75715e">;;;               That&#39;s correct.It must return #t,because will-stop? always gives an answer. we</span>
    <span style="color:#75715e">;;;               said it total(assume)</span>
    <span style="color:#75715e">;;;         Fine. If(will-stop? last-try) is #t. What is the value of (last-try (quote ())) in the definition of last-try.</span>
    <span style="color:#75715e">;;;           Now we just need to determine the value of (and #t (eternity (quote ()))</span>
    <span style="color:#75715e">;;;           which is the same as the value of (eternity (quote ()))</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;;           What is the value of (eternity (quote ())) </span>
    <span style="color:#75715e">;;;                 It doesn&#39;t have a value.we know that it doesn&#39;t stop</span>
    <span style="color:#75715e">;;;                 !</span>
    <span style="color:#75715e">;;;         But that means that we were wrong again!!! The will-stop? neither return #f nor #t. What the hell</span>
    <span style="color:#75715e">;;;                will-stop? will return?</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;;         So will-stop? cannot be defined.</span>
    <span style="color:#75715e">;;;         Is this unique?</span>
    <span style="color:#75715e">;;;                Yes , it is .It makes will-stop? the first function that we can describe percisely but cannot </span>
    <span style="color:#75715e">;;;                define in our language.</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;;         Is there any way around this problem?</span>
    <span style="color:#75715e">;;;                No ,thank you  ,Alan M. Turing (1912-1954)</span>
    <span style="color:#75715e">;;;                and Kurt Godel(1906-1978)</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;;         What is (define...)</span>
    <span style="color:#75715e">;;;                 That is an interesting question. We just saw that (define...) doesn&#39;t work for will-stop?.</span>
    <span style="color:#75715e">;;;</span>
    <span style="color:#75715e">;;;             So what are the recurive definition?</span>
    <span style="color:#75715e">;;;               Hold tight,take a deep breath,and plunge forward when you&#39;re ready.</span>


<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The second part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;****************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The third part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;   myracet3.rkt;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

(<span style="color:#66d9ef">define </span>length 
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l)))))))
(<span style="color:#66d9ef">define </span>eternity
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#a6e22e">eternity</span> x)))
(<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? l ) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (<span style="color:#a6e22e">eternity</span> (cdr l))))))
<span style="color:#75715e">;length&lt;=1</span>
(<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>
       (+ <span style="color:#ae81ff">1</span> 
          ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
             (<span style="color:#66d9ef">cond </span>
               ((null? l) <span style="color:#ae81ff">0</span>)
               (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> 
                        (<span style="color:#a6e22e">eternity</span> (cdr l))))))
           (cdr l))))))

<span style="color:#75715e">;length &lt;=2</span>
(<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      (<span style="color:#a6e22e">else</span>
       (+ <span style="color:#ae81ff">1</span>
        ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
           (<span style="color:#a6e22e">cond</span>
             ((null? l) <span style="color:#ae81ff">0</span>)
             (<span style="color:#66d9ef">else </span>
              (+ <span style="color:#ae81ff">1</span>
                 ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
                    (<span style="color:#a6e22e">cond</span>
                      ((null? l) <span style="color:#ae81ff">0</span>)
                      (<span style="color:#a6e22e">else</span>
                       (+ <span style="color:#ae81ff">1</span>
                          (<span style="color:#a6e22e">eternity</span>
                           (cdr l))))))
                  (cdr l))))))
         (cdr l))))))

<span style="color:#75715e">;;; Now what do you thin recursion is?</span>
<span style="color:#75715e">;;;           What do you mean?</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Well,we have seen how to determine the length of a list with no items,with no more that</span>
<span style="color:#75715e">;;; one item,with no more than two items,and so on. How could we get the function length back.</span>
<span style="color:#75715e">;;;           If we could write an infinite function in the style of length0 ,length1,length2..</span>
<span style="color:#75715e">;;;           then we could write lengthinfinite,which would determine the length of all lists</span>
<span style="color:#75715e">;;;           we can make.</span>
<span style="color:#75715e">;;;     But we cannot write an infinite function. No we can&#39;t, (yes ,we can&#39;t mae it)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      And we still have all these repetitions and patterns in these functions. yes we do.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      What do these pattern look like?</span>
<span style="color:#75715e">;;;               All these programs contain a function that looks like length.Perhaps we should</span>
<span style="color:#75715e">;;;               abstract out this function: see The Ninth Commandment.</span>
<span style="color:#75715e">;;;     We need a function that looks just lie length but starts with (lambda (length) ...).</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;Do you mean this?</span>
<span style="color:#75715e">;;;((lambda (length)</span>
<span style="color:#75715e">;;;(lambda (l)  (cond ((null? l) 0)  (else (add1 (length (cdr l)))))) eternity)</span>
<span style="color:#75715e">;;;       Yes,that&#39;s okay. It creates length0</span>
<span style="color:#75715e">;;;so rewrite length1  in the same style</span>
<span style="color:#75715e">;;;See below.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;we need a function that looks just like length </span>
<span style="color:#75715e">;but starts with (lambda (length)...) and inside it is not </span>
<span style="color:#75715e">;(lambda (length) but maybe (lambda (l)</span>
<span style="color:#75715e">;length0</span>
(<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">legnth</span>)
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#66d9ef">cond </span>
        ((null? l) <span style="color:#ae81ff">0</span>)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (length (cdr l))))))
    eternity)


<span style="color:#75715e">;length1</span>
((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#66d9ef">cond </span>
        ((null? l) <span style="color:#ae81ff">0</span>)
        (<span style="color:#66d9ef">else </span>
         (+ <span style="color:#ae81ff">1</span> (<span style="color:#a6e22e">f</span> (cdr l)))))))
   ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">g</span>)
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
        (<span style="color:#66d9ef">cond </span>
          ((null? l) <span style="color:#ae81ff">0</span>)
          (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (<span style="color:#a6e22e">g</span> (cdr l)))))))
    eternity))

<span style="color:#75715e">;;  Do we have to use length to name the argument?</span>
<span style="color:#75715e">;;         No ,we just used f and g. As long as we are consistent,everything&#39;s okay</span>
<span style="color:#75715e">;length2</span>
<span style="color:#75715e">;;length &lt;=2</span>
((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
     (<span style="color:#a6e22e">cond</span>
       ((null? l) <span style="color:#ae81ff">0</span>)
       (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l)))))))
 ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#a6e22e">cond</span>
        ((null? l) <span style="color:#ae81ff">0</span>)
        (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l)))))))
  ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
     (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
       (<span style="color:#a6e22e">cond</span>
         ((null? l) <span style="color:#ae81ff">0</span>)
         (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l)))))))
   eternity)))

<span style="color:#75715e">;;; close,  But there are still repetitions.  True,let&#39;s get rid of it.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  Where should we start?</span>
<span style="color:#75715e">;;;         Name the function that takes length as an argument and that returns a function that looks like length.</span>
<span style="color:#75715e">;;;  What&#39;s a good-name for this function?</span>
<span style="color:#75715e">;;;           how about mk-length  for &#34;make length&#34;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;let eternity move ahead , eternity in the first part</span>
((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
   (<span style="color:#a6e22e">mk-length</span> eternity))
 (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
     (<span style="color:#66d9ef">cond </span>
       ((null? l) <span style="color:#ae81ff">0</span>)
       (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l))))))))

((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
   <span style="color:#75715e">;;提取池</span>
   (<span style="color:#a6e22e">mk-length</span> 
    (<span style="color:#a6e22e">mk-length</span> eternity)))
 <span style="color:#75715e">;;发生池</span>
 (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
     (<span style="color:#66d9ef">cond </span>
       ((null? l) <span style="color:#ae81ff">0</span>)
       (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l))))))))
<span style="color:#75715e">;;length&lt;=2</span>
((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
   <span style="color:#75715e">;;提取池</span>
   (<span style="color:#a6e22e">mk-length</span> 
    (<span style="color:#a6e22e">mk-length</span> 
     (<span style="color:#a6e22e">mk-length</span> eternity))))
 <span style="color:#75715e">;;发生池</span>
 (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
     (<span style="color:#66d9ef">cond </span>
       ((null? l) <span style="color:#ae81ff">0</span>)
       (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l))))))))
 <span style="color:#75715e">;;length &lt;=3</span>
 ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
   <span style="color:#75715e">;;提取池</span>
   (<span style="color:#a6e22e">mk-length</span> 
    (<span style="color:#a6e22e">mk-length</span> 
     (<span style="color:#a6e22e">mk-length</span>
      (<span style="color:#a6e22e">mk-length</span> eternity)))))

  <span style="color:#75715e">;;;;              So   What is recursion like?</span>
  <span style="color:#75715e">;;;                             It is like an infinite tower of applications of mk-length to ab arbitrary function.</span>
  <span style="color:#75715e">;;;               Do you really need an infinite tower?</span>
  <span style="color:#75715e">;;;                      Not really of course.Everytime we use length we only need a finite number,but we never know </span>
  <span style="color:#75715e">;;;                      know many.</span>
  <span style="color:#75715e">;;;               could we guess how many we need?</span>
  <span style="color:#75715e">;;;                     Sure,but we may not guess a large enough number!</span>
  <span style="color:#75715e">;;;               When do  we  find out that we didn&#39;t guess a large enough number?</span>
  <span style="color:#75715e">;;;                     When we apply the function eternity that is  passed to innermost mk-length.</span>
  <span style="color:#75715e">;;;               What if we could create another application of mk-length to eternity at this point?</span>
  <span style="color:#75715e">;;;                       That would only postpone the problem by one and besides,how could we do that?</span>
  <span style="color:#75715e">;;;</span>
  <span style="color:#75715e">;;;                Well,since nobody cares what function we passwd to mk-length we could pass it mk-length initially.</span>
  <span style="color:#75715e">;;;                      That&#39;s the right idea(right?       )             And then we invoke mk-length on eternity and the </span>
  <span style="color:#75715e">;;;                      result of this on the cdr so that we get one more piece of this tower.</span>
 <span style="color:#75715e">;;发生池</span>
 (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
     (<span style="color:#66d9ef">cond </span>
       ((null? l) <span style="color:#ae81ff">0</span>)
       (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> (length (cdr l))))))))
 
 <span style="color:#75715e">;;how if we replace the eternity with the mk-length</span>
 
 <span style="color:#75715e">;length0; 因为没有人关心我们到底我们传递什么给mk-length 如果他是无穷的话</span>
 <span style="color:#75715e">;那我们可不可以第一次初始化的时候就传递给他 mk-length 来替代eternity呢？</span>
 <span style="color:#75715e">;;; Yes,we could even use mk-length instead of length.</span>
 ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
     (<span style="color:#a6e22e">mk-length</span> mk-length))
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
     (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
       (<span style="color:#66d9ef">cond </span>
         ((null? l) <span style="color:#ae81ff">0</span>)
         (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> 
                  (length (cdr l))))))))
 <span style="color:#75715e">;;和上面一样</span>
 ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
     (<span style="color:#a6e22e">mk-length</span> mk-length))
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
     (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
       (<span style="color:#66d9ef">cond </span>
         ((null? l) <span style="color:#ae81ff">0</span>)
         (<span style="color:#66d9ef">else </span>(+ <span style="color:#ae81ff">1</span> 
                  (<span style="color:#a6e22e">mk-length</span> (cdr l))))))))
 <span style="color:#75715e">;; WHy would we want to do that?</span>
 <span style="color:#75715e">;;         All names are equal, but some names are more equal than others! (with apologies to George Orwell(1903-1950)</span>
 <span style="color:#75715e">;;         True: as long as we use the names consistently ,we are just fine.</span>
 <span style="color:#75715e">;;</span>
 <span style="color:#75715e">;;     And mk-length is a far more equal  name than length. If we use a name like mk-length, it is a  contstant reminder that</span>
 <span style="color:#75715e">;;      the first argument to mk-length is mk-length</span>
 
 <span style="color:#75715e">;;我们为什么想着上面的做法呢？</span>
 <span style="color:#75715e">;;因为所有的名字都是一样的，但是有些名字是更一样比其他</span>
 ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
    (<span style="color:#a6e22e">mk-length</span> mk-length))
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#66d9ef">cond </span>
        ((null? l) <span style="color:#ae81ff">0</span>)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> 
               ((<span style="color:#a6e22e">mk-length</span> eternity)
                (cdr l))))))))
 
 ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
    (<span style="color:#a6e22e">mk-length</span> mk-length))
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
    ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
       (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
         (<span style="color:#a6e22e">cond</span>
           ((null? l) <span style="color:#ae81ff">0</span>)
           (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (length (cdr l)))))))
     (<span style="color:#a6e22e">mk-length</span> mk-length))))

<span style="color:#75715e">;;; How about this?</span>
<span style="color:#75715e">;;;     Yes,this looks just fine.</span>
<span style="color:#75715e">;;; Let&#39;s see thether it works?</span>
<span style="color:#75715e">;;;      Yes ,okay</span>
<span style="color:#75715e">;;; First,we need to know the value of it?</span>

 
 <span style="color:#75715e">;;; what would  you call this  function above?</span>
 <span style="color:#75715e">;;;        It&#39;s length,of course</span>
 <span style="color:#75715e">;;;</span>
 <span style="color:#75715e">;;;    How does it work?</span>
 <span style="color:#75715e">;;;           It keeps adding recurive uses by  passing mk-length to itself,just as it is about to expire</span>
 <span style="color:#75715e">;;;</span>
 <span style="color:#75715e">;;;           One problem is left: it  no longer contains the function that looks like length.</span>
 <span style="color:#75715e">;;;</span>
 <span style="color:#75715e">;;;           can you fix the (mk-length mk-length) .?</span>
 <span style="color:#75715e">;;;            We could extract this new application of mk-length to itself and call it length</span>
 <span style="color:#75715e">;;;        WHy?</span>
 <span style="color:#75715e">;;;             Because it really makes the function length.</span>
 
 <span style="color:#75715e">;;since (mk-length mk-length returns a fucntion of one argument,</span>
 <span style="color:#75715e">;;does (lambda (x) ((mk-length mk-length) x)) retrun a function of</span>
 <span style="color:#75715e">;;one argument? Actually,it is a function</span>
 <span style="color:#75715e">;;</span>
 <span style="color:#75715e">;;Okay ,let&#39;s do this to the application of mk-length to itself</span>
  ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
    (<span style="color:#a6e22e">mk-length</span> mk-length))
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#66d9ef">cond </span>
        ((null? l) <span style="color:#ae81ff">0</span>)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> 
               ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
                  ((<span style="color:#a6e22e">mk-length</span> mk-length) x))
                (cdr l))))))))
  
  <span style="color:#75715e">;;move out the new function so that we get length back</span>
  <span style="color:#75715e">;;Why can&#39;t you move out (lambda (x) ((mk-length mk-length) x))  </span>
  <span style="color:#75715e">;;       </span>
  <span style="color:#75715e">;;            Because you add the (lambda (length)  which is like the definition of define.(actually are)</span>
  <span style="color:#75715e">;;            also here the meaning of length is  (lambda(x) ((mk-length mk-length) x)),so you can use the</span>
  <span style="color:#75715e">;;            usage of lambda(length) and the definition of length in the same S-expressions!!(By zhaoliang)</span>
  <span style="color:#75715e">;;                    You know the same S-expression (the same parathese here)</span>
  <span style="color:#75715e">;;</span>
  <span style="color:#75715e">;;            Is it okay to move out the function?</span>
  <span style="color:#75715e">;;                     Yes,we just always did the opposite by replacing a name with its value. Here we</span>
  <span style="color:#75715e">;;                     extract a value and give it a name.</span>
  <span style="color:#75715e">;;            Can we extract the function in the box(p171) that looks like length and give it a name</span>
  <span style="color:#75715e">;;                          Yes,it does not depend on mk-length at all!</span>
  ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
     (<span style="color:#a6e22e">mk-length</span> mk-length))
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
     ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
        (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
          (<span style="color:#66d9ef">cond </span>
            ((null? l) <span style="color:#ae81ff">0</span>)
            (<span style="color:#a6e22e">else</span>
             (<span style="color:#a6e22e">add1</span> (length (cdr l)))))))
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
        ((<span style="color:#a6e22e">mk-length</span> mk-length) x)))))


<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The third part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;***************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The fourth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;  myracet4.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">;;;; Is this the right function!             ------you can check back the nottation above.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;Here the definition of le(lambda (length)...) and the usage of le (lambda (le)...) is in the same </span>
<span style="color:#75715e">;;;S-expressions!!(the same parathese)</span>
<span style="color:#75715e">;;;</span>
((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">le</span>)
   ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
      (<span style="color:#a6e22e">mk-length</span> mk-length))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
      (<span style="color:#a6e22e">le</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
            ((<span style="color:#a6e22e">mk-length</span> mk-length) x))))))
 (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
     (<span style="color:#a6e22e">cond</span>
       ((null? l) <span style="color:#ae81ff">0</span>)
       (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (length (cdr l))))))))

<span style="color:#75715e">;;;; Let&#39;s separate the funtion that makes length from the function that looks like length.</span>
(<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">le</span>)
  ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
     (<span style="color:#a6e22e">mk-length</span> mk-length))
   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mk-length</span>)
     (<span style="color:#a6e22e">le</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
           ((<span style="color:#a6e22e">mk-length</span> mk-length) x))))))
<span style="color:#75715e">;;; Does this function have a name?</span>
<span style="color:#75715e">;;;         Yes ,it is called the application-order Y combinator.</span>
(<span style="color:#66d9ef">define </span>Y
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">le</span>)
    ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>) 
       (<span style="color:#a6e22e">f</span> f))
     (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
       (<span style="color:#a6e22e">le</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
             ((<span style="color:#a6e22e">f</span> f) x)))))))
<span style="color:#75715e">;;; the above function is replace the mk-length with  f ,so it looks more common!      BUt</span>
<span style="color:#75715e">;;;      it lacks the definition of (le)  just the usage of le.so it means the Y combinator.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      (lambda (length)</span>
<span style="color:#75715e">;;;            (lambda  (l)</span>
<span style="color:#75715e">;;;                 ...           ---&lt; it is the definition of function length</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     ((lambda  (le)</span>
<span style="color:#75715e">;;;          ...</span>
<span style="color:#75715e">;;;        )</span>
<span style="color:#75715e">;;;     (lambda (length)</span>
<span style="color:#75715e">;;;         ...</span>
<span style="color:#75715e">;;;         ))</span>
<span style="color:#75715e">;;;                             ----&lt;  it is the definition of function le is the (lambda (length)...)) and the use </span>
<span style="color:#75715e">;;;                             of the le is in the (lambda (le) ...)   Take care what the left parathese and right </span>
<span style="color:#75715e">;;;                             parathese I utilize.</span>
<span style="color:#75715e">;;;                             ----------------------which is similar to apply-closure that contains three part</span>
<span style="color:#75715e">;;;                                                            table-of   form-of    body-of</span>


<span style="color:#75715e">;; An entry is a pair of lists whose first list is a set. Also ,the two lists must be of equal </span>
<span style="color:#75715e">;; length.Make up some examples for entries</span>
<span style="color:#75715e">;;              Here are some examples:</span>
<span style="color:#75715e">;;              ((appetizer entree beverage)</span>
<span style="color:#75715e">;;              (pate boeuf vin))</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;              and</span>
<span style="color:#75715e">;;              ((appetizer entree beverage)</span>
<span style="color:#75715e">;;              (beer beer beer)  ---------------------------&lt; but the second list can be not a set</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;              and </span>
<span style="color:#75715e">;;              (( beverage dessert)</span>
<span style="color:#75715e">;;               ((food is) (number one with us)))</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;How can we build an entry from a set of names and a list of values?</span>
<span style="color:#75715e">;;           (define new-entry build)           ----&gt;Try to build our examples with this function.</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;What is (lookup-in-entry name entry)</span>
<span style="color:#75715e">;;     where name is entree</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;     and entry is ((appetizer entree beverage)</span>
<span style="color:#75715e">;;                   (food tastes  good))</span>
<span style="color:#75715e">;;                ------------------------------&gt;tastes</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;      What if name is dessert</span>
<span style="color:#75715e">;;             In this case we would like to leave the decision about what to do with the user of lookup-in-entry</span>
<span style="color:#75715e">;;      How can we accomplish this?</span>
<span style="color:#75715e">;;             lookup-in-entry takes an additional argument this is invoked when name is not found in the first </span>
<span style="color:#75715e">;;                list of an entry.</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;      How many arguments do you think this extra function should take?</span>
<span style="color:#75715e">;;            We think it should take one , name. Why?</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The fourth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;***************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The fifth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;myracet5.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>

(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))
  
(<span style="color:#66d9ef">define </span>build
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s1</span> s2)
    (<span style="color:#a6e22e">cond</span>
      (<span style="color:#66d9ef">else </span>(cons s1
                  (cons s2 (<span style="color:#66d9ef">quote </span>())))))))
((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">nothing</span>)
     (<span style="color:#a6e22e">cond</span>
       (<span style="color:#a6e22e">nothing</span> (<span style="color:#66d9ef">quote </span>something))
       (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">quote </span>nothing))))
   <span style="color:#66d9ef">#t</span>)

<span style="color:#75715e">;;;; Here is our dfinition of lookup-in-entry:</span>
(<span style="color:#66d9ef">define </span>lookup-in-entry
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">name</span> entry entry-f)
    (<span style="color:#a6e22e">lookup-in-entry-help</span> name
                          (<span style="color:#a6e22e">first</span> entry)
                          (<span style="color:#a6e22e">second</span> entry)
                          (<span style="color:#a6e22e">entry-f</span>))))
<span style="color:#75715e">;;;Finish the function lookup-in-entry-help-----------------</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>lookup-in-entry-help
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">name</span> names values entry-f)
    (<span style="color:#a6e22e">cond</span>
      ((null? names) (<span style="color:#a6e22e">entry-f</span> name))
      ((eq? (car names) name)
       (car values))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">lookup-in-entry-help</span> name
                                  (cdr names)
                                  (cdr values)
                                  entry-f)))))
<span style="color:#75715e">;;;     A table(based on entries) (also   called an environment) is a list of entries.Here is one example: The empty table</span>
<span style="color:#75715e">;;;     ,represented by ()</span>
<span style="color:#75715e">;;;     Make up some others.</span>
<span style="color:#75715e">;;;      Here is another one:</span>
<span style="color:#75715e">;;;                          (((appetizer entree beverage)</span>
<span style="color:#75715e">;;;                            (pate boeuf vin))</span>
<span style="color:#75715e">;;;                            ((beverage desert)</span>
<span style="color:#75715e">;;;                             ((food is) (number one with us)))</span>
<span style="color:#75715e">;;;                           )</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;         Define the function extend-table which takes an entry and a table (possibly the empty one)</span>
<span style="color:#75715e">;;;         and create a new table by putting the new entry in front of the old table.</span>
<span style="color:#75715e">;;;         (define extend-table cons)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is  </span>
<span style="color:#75715e">;;;         (lookup-in-table name table table-f)</span>
<span style="color:#75715e">;;;          where </span>
<span style="color:#75715e">;;;                 name is entree</span>
<span style="color:#75715e">;;;                 table is (((entree dessert)</span>
<span style="color:#75715e">;;;                            (spaghetti spumoni))</span>
<span style="color:#75715e">;;;                           ((appetizer entree beverage)</span>
<span style="color:#75715e">;;;                            (food tastes good)))</span>
<span style="color:#75715e">;;;                 and </span>
<span style="color:#75715e">;;;                    table-f is (lambda (name) ...)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;             -----&gt; It could be either spaghetti or tastes,but lookup-in-table searches the list of entries in order</span>
<span style="color:#75715e">;;;                    So it is spaghetti</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Can you describe what the following function </span>
<span style="color:#75715e">;;; represents:</span>
<span style="color:#75715e">;;;            (lambda (name)</span>
<span style="color:#75715e">;;;                (lookup-in-table name</span>
<span style="color:#75715e">;;;                     (cdr table)</span>
<span style="color:#75715e">;;;                     table-f))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;                     ---------------------------&gt; This function is the action to take when the name is not found in the first entry</span>
<span style="color:#75715e">;;;                                                  In one table there are a set of entries (set means each of the entries is different </span>
<span style="color:#75715e">;;;                                                  from each other)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Have we chosen a good representation for expressions?</span>
<span style="color:#75715e">;;;           Yes .They are all S-expressions so they can be data for functions.</span>
<span style="color:#75715e">;;; What kind of functions?</span>
<span style="color:#75715e">;;;           For example ,value(later on ,the value is defined as another name  compiler.(like gcc  gfortran  ifort  python perl etc)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Do you remember value from chapter 6?</span>
<span style="color:#75715e">;;;          Recall that value is the function that returns the natural value of expressions.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is the value of</span>
<span style="color:#75715e">;;;  (car (quote (a b c)))</span>
<span style="color:#75715e">;;;         We don&#39;t even know  what (quote (a b c)) is .---------------------------------&lt;&lt;&lt;&lt;The original state of you learning english!</span>
<span style="color:#75715e">;;;                                                                          You don&#39;t know &#39;am&#39; &#39;are&#39; &#39;is&#39; etc.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;What is the value of</span>
<span style="color:#75715e">;;;      (cons rep-a</span>
<span style="color:#75715e">;;;        (cons rep-b</span>
<span style="color:#75715e">;;;          (cons rep-c</span>
<span style="color:#75715e">;;;             (quote ()))))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     Where </span>
<span style="color:#75715e">;;;       rep-a is a</span>
<span style="color:#75715e">;;;       rep-b is b</span>
<span style="color:#75715e">;;;     and</span>
<span style="color:#75715e">;;;       rep-c is c</span>
<span style="color:#75715e">;;;                                         ==================&gt;&gt; It is the same as (a b c)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;And what is the value of</span>
<span style="color:#75715e">;;; (cons rep-car</span>
<span style="color:#75715e">;;;     (cons (cons rep-quote</span>
<span style="color:#75715e">;;;              (cons </span>
<span style="color:#75715e">;;;                  (cons rep-a</span>
<span style="color:#75715e">;;;                     (cons rep-b</span>
<span style="color:#75715e">;;;                        (cons rep-c</span>
<span style="color:#75715e">;;;                             (quote ()))))</span>
<span style="color:#75715e">;;;                  (quote ())))</span>
<span style="color:#75715e">;;;       (quote ())))</span>
<span style="color:#75715e">;;;       where </span>
<span style="color:#75715e">;;;         rep-car is car</span>
<span style="color:#75715e">;;;         rep-quote is quote</span>
<span style="color:#75715e">;;;         rep-a is a</span>
<span style="color:#75715e">;;;         rep-b is b</span>
<span style="color:#75715e">;;;         and</span>
<span style="color:#75715e">;;;         rep-c is c</span>
<span style="color:#75715e">;;;                                        ====================&gt;&gt; It is the representation of the expressions:</span>
<span style="color:#75715e">;;;                                                                      (car (quote (a b c)))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;                                                                      ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^</span>
<span style="color:#75715e">;;;                                                                      The above is  what I say: Lisp is the data with program!</span>
<span style="color:#75715e">;;;                                                                              Data can be code,code can also become data!</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is value of</span>
<span style="color:#75715e">;;;      (car (quote (a b c)))           </span>
<span style="color:#75715e">;;;                                       =====================&gt;&gt; a</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;      where </span>
<span style="color:#75715e">;;;          e is (car (quote (a b c)))</span>
<span style="color:#75715e">;;;                                       =====================&gt;&gt; a</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;       where </span>
<span style="color:#75715e">;;;           e is (quote (car (quote (a b c))))</span>
<span style="color:#75715e">;;;                                       =====================&gt;&gt; (car (quote (a b c)))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;        where</span>
<span style="color:#75715e">;;;            e is (add1 6)</span>
<span style="color:#75715e">;;;                                        ====================&gt;&gt; 7</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;        where </span>
<span style="color:#75715e">;;;            e is 6</span>
<span style="color:#75715e">;;;                                        ====================&gt;&gt; 6 .because numbers are constants</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;        where </span>
<span style="color:#75715e">;;;            e is (quote nothing)</span>
<span style="color:#75715e">;;;                                        ====================&gt;&gt; nothing</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;         where</span>
<span style="color:#75715e">;;;           e is ((lambda (nothing)</span>
<span style="color:#75715e">;;;                    (cons nothing (quote ())))</span>
<span style="color:#75715e">;;;                 (quote </span>
<span style="color:#75715e">;;;                    (from nothing comes something)))</span>
<span style="color:#75715e">;;;                                        ====================&gt;&gt; ((from nothing come something)).</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;        where </span>
<span style="color:#75715e">;;;            e is ((lambda (nothing)</span>
<span style="color:#75715e">;;;                     (cond</span>
<span style="color:#75715e">;;;                        (nothing (quote something))</span>
<span style="color:#75715e">;;;                        (else (quote nothing))))</span>
<span style="color:#75715e">;;;                  #t)             -------------------------&lt; It means nothing is #t(The semtatics of language (the infer of language))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;                                       =====================&gt;&gt; something</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; What is the type of e</span>
<span style="color:#75715e">;;;         where  </span>
<span style="color:#75715e">;;;              e is 6</span>
<span style="color:#75715e">;;;                                        ====================&gt;&gt; *const</span>
<span style="color:#75715e">;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is #f</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; *const</span>
<span style="color:#75715e">;;; What is (value e)</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is #f                 ======================&gt;&gt; #f</span>
<span style="color:#75715e">;;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is cons</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; *const             -----------------------&gt;I think is must be somethin wrong </span>
<span style="color:#75715e">;;;                                                                                   -----------------------&gt;I think it is primitive car</span>
<span style="color:#75715e">;;;                                                                                   -----------------------&gt;I am wrong ,primitive is also *const</span>
<span style="color:#75715e">;;;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is car</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; (primitive car)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is (quote nothing)</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; *quote</span>
<span style="color:#75715e">;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is nothing</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; *identifier</span>
<span style="color:#75715e">;;;;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is (lambda (x y) (cons x y))</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; *lambda</span>
<span style="color:#75715e">;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is ((lambda (nothing)</span>
<span style="color:#75715e">;;;                      (cond</span>
<span style="color:#75715e">;;;                          (nothing (quote something))</span>
<span style="color:#75715e">;;;                          (else (quote nothing))))</span>
<span style="color:#75715e">;;;                     #t)</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; *application</span>
<span style="color:#75715e">;;; What is the type of e</span>
<span style="color:#75715e">;;;         where </span>
<span style="color:#75715e">;;;              e is (cond</span>
<span style="color:#75715e">;;;                      (nothing  (quote something))</span>
<span style="color:#75715e">;;;                      (else (quote nothing)))</span>
<span style="color:#75715e">;;;                                       ======================&gt;&gt; *cond</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; How many types do you think there are?</span>
<span style="color:#75715e">;;;                          we found six:</span>
<span style="color:#75715e">;;;                                         *const</span>
<span style="color:#75715e">;;;                                         *quote</span>
<span style="color:#75715e">;;;                                         *identifier</span>
<span style="color:#75715e">;;;                                         *lambda</span>
<span style="color:#75715e">;;;                                         *cond</span>
<span style="color:#75715e">;;;                                         and</span>
<span style="color:#75715e">;;;                                           *application</span>
<span style="color:#75715e">;;; How do you think we should represent types?</span>
<span style="color:#75715e">;;;              We choose functions.We call these functions &#34;action&#34;;------------------------------------&lt;In python ,it is called as objects</span>
<span style="color:#75715e">;;;                                                                   or,in oop(orient object programming) ,it is called as objects</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; If actions are functions that do &#34;the right thing&#34;  when applied to the appropriate type of expression,</span>
<span style="color:#75715e">;;;                 What should value do?</span>
<span style="color:#75715e">;;;     You guessed it. It would have to find out the type of expression it was passed  and then use the associated action.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Do you remember atom-to-function from chapter8?</span>
<span style="color:#75715e">;;;         We found atom-to-function usefule when we rewrote value for numbered expressions.</span>

<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>lookup-in-table
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">name</span> table table-f)
    (<span style="color:#66d9ef">cond </span>
      ((null? table) (<span style="color:#a6e22e">table-f</span> name))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">lookup-in-entry</span> name
                             (car table)
                             (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">name</span>)
                               (<span style="color:#a6e22e">lookup-in-table</span> name
                                                (cdr table)
                                                (<span style="color:#a6e22e">table-f</span>))))))))
(<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">name</span> table table-f)
    (<span style="color:#a6e22e">lookup-in-table</span> name
                     (cdr table)
                     (<span style="color:#a6e22e">table-f</span>)))
<span style="color:#75715e">;;; Below is a function that produces the correct action (or function) for each possible S-expression:</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; The top level make-up</span>
(<span style="color:#66d9ef">define </span>expression-to-action
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> e) (<span style="color:#a6e22e">atom-to-action</span> e))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">list-to-action</span> e)))))

<span style="color:#75715e">;;; IN the III-formed S-expressions suchas (quote a b), () , (lambda (#t) #t),(lambda (4) 4)  ,(lambda (car) car)</span>
<span style="color:#75715e">;;;         (lambda a),(cond (3 c) (else b) (5 a)) , And (1 2) are not considered here.They can be detected by an </span>
<span style="color:#75715e">;;;         appropriate function to which S-expressions are submitted before they are passed to value.</span>

(<span style="color:#66d9ef">define </span>atom-to-action
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span>)
    (<span style="color:#a6e22e">cond</span>
      ((number? e) *const)
      ((eq? e <span style="color:#66d9ef">#t</span>) *const)
      ((eq? e <span style="color:#66d9ef">#f</span>) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>cons)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>car)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>cdr)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>null?)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>eq?)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>atom?)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>zero?)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>add1)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>sub1)) *const)
      ((eq? e (<span style="color:#66d9ef">quote </span>number?)) *const)
      (<span style="color:#66d9ef">else </span>*identifier))))
<span style="color:#75715e">;;;; so *const is consed by three parts: primitive part ,number , #t or #f part.(not include string part, because string part is called *identifier)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;By zhaoliang</span>
<span style="color:#75715e">;;;It means that the following identifier can see the list as its function&#39;s argument!    --------------------------&lt;</span>
(<span style="color:#66d9ef">define </span>list-to-action
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> (car e))
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car e) (<span style="color:#66d9ef">quote </span>quote))
          *quote)
         ((eq? (car e) (<span style="color:#66d9ef">quote </span>lambda))
          *lambda)
         ((eq? (car e) (<span style="color:#66d9ef">quote </span>cond))
          *cond)
         (<span style="color:#66d9ef">else </span>*application)))
      (<span style="color:#66d9ef">else </span>*application))))

<span style="color:#75715e">;;;;; So the compiler is comming on the way............................</span>
<span style="color:#75715e">;;;       If we assuming the expression-to-action works,we can use it to define value and meanning</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>value
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span>)
    (<span style="color:#a6e22e">meaning</span> e (<span style="color:#66d9ef">quote </span>()))))  <span style="color:#75715e">;;;Now table is empty set.</span>
(<span style="color:#66d9ef">define </span>meaning
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span> table)
    ((<span style="color:#a6e22e">expression-to-action</span> e) e table)))

<span style="color:#75715e">;;;; The function value, together with all the functions it uses ,is called an interpreter.(Note that: all the relevent function value use</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;The function value approximates the function eval  available in Schemes(and Lisp)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;How many arguments should actions take according to the above?</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;             Two,the expression e and a table</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Here is the action for constants:</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>*const
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span> table)
    (<span style="color:#66d9ef">cond </span>
      ((number? e) e)
      ((eq? e <span style="color:#66d9ef">#t</span>) <span style="color:#66d9ef">#t</span>)
      ((eq? e <span style="color:#66d9ef">#f</span>) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">build</span> (<span style="color:#66d9ef">quote </span>primitive) e)))))  <span style="color:#75715e">;;;;-----------------&lt;&lt;&lt;&lt; Yes,primitive car,primitive con,primitive cdr</span>

<span style="color:#75715e">;;; Here is the action for constants:</span>
<span style="color:#75715e">;;; </span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>*quote
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span> table)
    (<span style="color:#a6e22e">text-of</span> e)))

(<span style="color:#66d9ef">define </span>first
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#66d9ef">cond </span>
      (<span style="color:#66d9ef">else </span>(car p)))))

(<span style="color:#66d9ef">define </span>second
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#a6e22e">cond</span>
      (<span style="color:#66d9ef">else </span>car (cdr p)))))

(<span style="color:#66d9ef">define </span>third
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#66d9ef">cond </span>
      (<span style="color:#66d9ef">else </span>car (cdr (cdr p))))))

(<span style="color:#66d9ef">define </span>text-of second)

<span style="color:#75715e">;;; Have we used the table yet?</span>
<span style="color:#75715e">;;;                   No, But we will in a moment.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Why do we need the table?</span>
<span style="color:#75715e">;;;                   To remember the values of identifiers</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;; Given that the table contains the values of identifiers ,write the action of *identifier</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>*identifier
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span> table)
    (<span style="color:#a6e22e">lookup-in-table</span> e table initial-table)))

<span style="color:#75715e">;;; Here is the initial-table ---------------------------------------------&gt;&gt;&gt;&gt;&gt;</span>
(<span style="color:#66d9ef">define </span>initial-table
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">name</span>)
    (car (<span style="color:#66d9ef">quote </span>()))))

<span style="color:#75715e">;;; When is it used?</span>
<span style="color:#75715e">;;;                       Let&#39;s hope never. Why?</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;What is the value of (lambda (x) x)</span>
<span style="color:#75715e">;;         We don&#39;t know yet, But we know that it must be the representation for a non-primitive</span>
<span style="color:#75715e">;;                  function.</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;  How are non-primitive functions different from primitives?</span>
<span style="color:#75715e">;;   We know what primitives do;  non-primitives are defined by their argumentss and their function bodier</span>
<span style="color:#75715e">;;                                                     ^^^^^ ^^ ^^^^^ ^^^^^^^^^^ ^^^ ^^^^^ ^^^^^^^^ ^^^^^^</span>
<span style="color:#75715e">;;                                                     What does it mean?</span>
<span style="color:#75715e">;;                                                      arguments (x y ...)       function bodier: x</span>
<span style="color:#75715e">;;  So when we want to use a non-primitive we need to remember its formal arguments and its function body.</span>
<span style="color:#75715e">;;       At least. Fortunately this is just the cdr of a lambda expression! Because the car of the lambda expression is lambda</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;  And what else do we need to remember?</span>
<span style="color:#75715e">;;                             </span>
<span style="color:#75715e">;;                              We wll also put the table in,just in case we might need it later</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;;  And How do we represent this?</span>
<span style="color:#75715e">;;                   In a list,of course.</span>
<span style="color:#75715e">;;</span>
<span style="color:#75715e">;; Here is the action *lambda</span>
<span style="color:#75715e">;;</span>
(<span style="color:#66d9ef">define </span>*lambda
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span> table)
    (<span style="color:#a6e22e">build</span> (<span style="color:#66d9ef">quote </span>non-primitive)
           (cons table (cdr e)))))
<span style="color:#75715e">;;; What is (meanning a table)</span>
<span style="color:#75715e">;;;        where</span>
<span style="color:#75715e">;;;              e is (lambda (x) (cons x y))</span>
<span style="color:#75715e">;;;        and</span>
<span style="color:#75715e">;;;              table is (((y z) ((8) 9)))</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;              ==========================================&gt;&gt;&gt; (non-primitive</span>
<span style="color:#75715e">;;;                                                                   (   (((y z) ((8) 9)))         (x)             (cons x y)   ))</span>
<span style="color:#75715e">;;;                                                                       ^^^^^^^^^^^^^^^^^         ^^^             ^^^^^^^^^^^^^^^</span>
<span style="color:#75715e">;;;                                                                           table                 formals             body</span>
<span style="color:#75715e">;;;It is probably a good idea to define some help functions for getting back the parts in this three elements</span>
<span style="color:#75715e">;;;list (i.e. the tables,the formal arguments,and the body).</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>table-of first)
(<span style="color:#66d9ef">define </span>formals-of second)
(<span style="color:#66d9ef">define </span>body-of third)


<span style="color:#75715e">;;; Describe (cond...) in your own words</span>
<span style="color:#75715e">;;;     </span>
<span style="color:#75715e">;;;      It is a special form that takes any number of cond-lines. It considers</span>
<span style="color:#75715e">;;;      each line in turn. If the question part on the left is false, it looks</span>
<span style="color:#75715e">;;;      at the rest of the lines.Otherwise it proceeds to answer the right part.</span>
<span style="color:#75715e">;;;       If it sees an else-line,it treats that cond-line as if its question part</span>
<span style="color:#75715e">;;;       were true.</span>

<span style="color:#75715e">;;;;</span>
<span style="color:#75715e">;;; Here is the function evcon that does what we said in words</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>evcon
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lines</span> table)
    (<span style="color:#66d9ef">cond </span>
      ((<span style="color:#a6e22e">else?</span> (<span style="color:#a6e22e">question-of</span> (car lines)))
       (<span style="color:#a6e22e">meaning</span> (<span style="color:#a6e22e">answer-of</span> (car lines))
                table))
      ((<span style="color:#a6e22e">meaning</span> (<span style="color:#a6e22e">question-of</span> (car lines))
                table)
       (<span style="color:#a6e22e">meaning</span> (<span style="color:#a6e22e">answer-of</span> (car lines))
                table))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">evcon</span> (cdr lines) table)))))

<span style="color:#75715e">;;;; else? determine whether the (car expression)  is else or not!</span>
(<span style="color:#66d9ef">define </span>else?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> x) (eq? x (<span style="color:#66d9ef">quote </span>else)))
      (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>))))
<span style="color:#75715e">;;; didn&#39;t we violate the First Commandment?</span>
<span style="color:#75715e">;;;          Yes,we don&#39;t ask (null? lines), so one of the questions in every cond better be true</span>
(<span style="color:#66d9ef">define </span>question-of first)
(<span style="color:#66d9ef">define </span>answer-of second)

<span style="color:#75715e">;;; Now use the function evcon to write the *cond action</span>
<span style="color:#75715e">;;; </span>
<span style="color:#75715e">;;; Here is the action for *cond</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>*cond
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span> table)
    (<span style="color:#a6e22e">evcon</span> (<span style="color:#a6e22e">cond-lines-of</span> e) table)))
<span style="color:#75715e">;;; Aren&#39;t these help functions useful?</span>
<span style="color:#75715e">;;;          Yes they make things quite a bit more readable.But you already knew that.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Do you understand *cond now?</span>
<span style="color:#75715e">;;;           Perhaps not</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; How can you become familiar with it?</span>
<span style="color:#75715e">;;;         The best way is to try an example.</span>
<span style="color:#75715e">;;;         A good one (examples ) is</span>
<span style="color:#75715e">;;;                (*cond e table)</span>
<span style="color:#75715e">;;;                  where </span>
<span style="color:#75715e">;;;                       e is (cond (coffee klatsch) (else (party))</span>
<span style="color:#75715e">;;;                  and </span>
<span style="color:#75715e">;;;                       table is (((coffee) (#t))</span>
<span style="color:#75715e">;;;                                 ((klatsch party) (5 (6))))</span>
(<span style="color:#66d9ef">define </span>cond-lines-of cdr)

<span style="color:#75715e">;;; Have we seen how the table gets used?</span>
<span style="color:#75715e">;;;            Yes,*lambda and *identifier use it</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;But how do the identifiers get into the table?</span>
<span style="color:#75715e">;;;            In the only action we have not defined:</span>
<span style="color:#75715e">;;;                      *application</span>
<span style="color:#75715e">;;;                      ^^^^^^^^^^^^</span>
<span style="color:#75715e">;;;                      ||||||||||||</span>
<span style="color:#75715e">;;; How is an application represented?</span>
<span style="color:#75715e">;;;       </span>
<span style="color:#75715e">;;;        An application us a list of  expressions whose car position contains an expression whose value is a function.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;How does an application differ from a special form, like (and ...) (or ...) or (cond ...)</span>
<span style="color:#75715e">;;;     An application must always determine the meaning of all its arguments.</span>
<span style="color:#75715e">;;; Before we can apply a function ,do we have to get the meaning of all of its arguments?</span>
<span style="color:#75715e">;;;       Yes.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Write a function evils that takes a list of (representations of) arguments and a table, and</span>
<span style="color:#75715e">;;;  returns a list composed of the meaning of each argument</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>evlis
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">args</span> table)
    (<span style="color:#a6e22e">cond</span>
      ((null? args) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (cons (<span style="color:#a6e22e">meaning</span> (car args) table)  <span style="color:#75715e">;;; really  importan  for every argument!</span>
             (<span style="color:#a6e22e">evlis</span> (cdr args) table))))))
<span style="color:#75715e">;;;; What else do we need before we can determine the meaning of an application?</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;We need to find out what its function-of means</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;And what then?</span>
<span style="color:#75715e">;;;  </span>
<span style="color:#75715e">;;;  Then we apply the meaning of the function to the meaning of the arguments</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  Here is *application</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>*application
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">e</span> table)
    (<span style="color:#a6e22e">apply</span>
     (<span style="color:#a6e22e">meaning</span> (<span style="color:#a6e22e">function-of</span> e) table)
     (<span style="color:#a6e22e">evlis</span> (<span style="color:#a6e22e">arguments-of</span> e) table))))
<span style="color:#75715e">;;; Of course, we just have to define apply , function-of, and arguments-of correctly</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>function-of car)

(<span style="color:#66d9ef">define </span>arguments-of cdr)

<span style="color:#75715e">;;;; How many different kinds of functions are there?</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     Two: primitive and non-primitive</span>
<span style="color:#75715e">;;; What are the two representation of functions?</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; (primitive primitive-name)</span>
<span style="color:#75715e">;;; and (non-primitive (table formals body))</span>
<span style="color:#75715e">;;;      The list (table formals body) is called a  closure record.</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;      Write primitive? and non-primitive?</span>
(<span style="color:#66d9ef">define </span>primitive?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (eq? (<span style="color:#a6e22e">first</span> l) (<span style="color:#66d9ef">quote </span>primitive))))
(<span style="color:#66d9ef">define </span>non-primitive?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (eq? (<span style="color:#a6e22e">first</span> l) (<span style="color:#66d9ef">quote </span>non-primitive))))
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; If fun does not evaluate to either a primitive or a non-primitive as</span>
<span style="color:#75715e">;;;         in the expression ((lambda (x) (x 5)) 3) ------&lt;&lt;&lt; This expression cannot be detected in the now preocedure</span>
<span style="color:#75715e">;;;         there is no answer. The function apply approximatly the funcion apply available in Scheme (and lisp)</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>apply
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">fun</span> vals)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">primitive?</span> fun)
       (<span style="color:#a6e22e">apply-primitive</span>
        (<span style="color:#a6e22e">second</span> fun) vals))
      ((<span style="color:#a6e22e">non-primitive?</span> fun)
       (<span style="color:#a6e22e">apply-closure</span>
        (<span style="color:#a6e22e">second</span> fun) vals)))))

<span style="color:#75715e">;;;; This is the definition of apply-primitive</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>apply-primitive
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">name</span> vals)
    (<span style="color:#a6e22e">cond</span>
      ((eq? name (<span style="color:#66d9ef">quote </span>cons))
       (cons (<span style="color:#a6e22e">first</span> vals) (<span style="color:#a6e22e">second</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>car))
       (car (<span style="color:#a6e22e">first</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>cdr))
       (cdr (<span style="color:#a6e22e">first</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>null?))
       (null? (<span style="color:#a6e22e">first</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>eq?))
       (eq? (<span style="color:#a6e22e">first</span> vals) (<span style="color:#a6e22e">second</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>atom?))
       (<span style="color:#a6e22e">:atom?</span> (<span style="color:#a6e22e">first</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>zero?))
       (zero? (<span style="color:#a6e22e">first</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>add1))
       (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">first</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>sub1))
       (<span style="color:#a6e22e">sub1</span> (<span style="color:#a6e22e">first</span> vals)))
      ((eq? name (<span style="color:#66d9ef">quote </span>number?))
       (number? (<span style="color:#a6e22e">first</span> vals))))))
(<span style="color:#66d9ef">define </span>:atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> x) <span style="color:#66d9ef">#t</span>)
      ((null? x) <span style="color:#66d9ef">#f</span>)
      ((eq? (car x) (<span style="color:#66d9ef">quote </span>primitive))
       <span style="color:#66d9ef">#t</span>)
      ((eq? (car x) (<span style="color:#66d9ef">quote </span>non-primitive))
       <span style="color:#66d9ef">#t</span>)
      (<span style="color:#66d9ef">else </span><span style="color:#66d9ef">#f</span>))))
<span style="color:#75715e">;;;Is apply-closure  the only function left?</span>
<span style="color:#75715e">;;;        Yes,and apply-closure must extent the table</span>
<span style="color:#75715e">;;;                    extent the table?</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;     how could we first find the result of (f a b)</span>
<span style="color:#75715e">;;;     where</span>
<span style="color:#75715e">;;;       f is (lambda (x y) (cons x y))</span>
<span style="color:#75715e">;;;       a is 1</span>
<span style="color:#75715e">;;;       and </span>
<span style="color:#75715e">;;;       b  is (2)</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;       ===================That&#39;s tricky. But we know what to do to find the meaning of (cons x y)</span>
<span style="color:#75715e">;;;                                               where </span>
<span style="color:#75715e">;;;                                                     table is (((x y)</span>
<span style="color:#75715e">;;;                                                                (1 (2)))).</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;  Table is the contain of the variables defined by you!!!</span>
<span style="color:#75715e">;;;  Why can we do this?</span>
<span style="color:#75715e">;;;           Here ,we don&#39;t need apply-closure</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;; Can you generalize the last two steps?</span>
<span style="color:#75715e">;;;                                 Applying a non-primitive function --a closure---to</span>
<span style="color:#75715e">;;;                                 a list of values  is the same as finding the meaning  of </span>
<span style="color:#75715e">;;;                                 closure&#39;s body with its table extended by an entry of the form</span>
<span style="color:#75715e">;;;                                 (formals values)</span>
<span style="color:#75715e">;;;                                 In this entry,formals is the formals of closure and values is </span>
<span style="color:#75715e">;;;                                 the result of evils</span>
<span style="color:#75715e">;;;</span>
(<span style="color:#66d9ef">define </span>apply-closure
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">closure</span> vals)
    (<span style="color:#a6e22e">meaning</span> (<span style="color:#a6e22e">body-of</span> closure)
             (<span style="color:#a6e22e">extend-table</span>
              (<span style="color:#a6e22e">new-entry</span>
               (<span style="color:#a6e22e">formals-of</span> closure)
               vals)
              (<span style="color:#a6e22e">table-of</span> closure)))))
<span style="color:#75715e">;;;; This is a complicated function and it deserves an example.</span>
<span style="color:#75715e">;;;         In the following,</span>
<span style="color:#75715e">;;;              closure is ((((u v w)          ;;; entry name</span>
<span style="color:#75715e">;;;                            (1 2 3))         ;;; entry value</span>
<span style="color:#75715e">;;;                            ((x y  z)        ;;;;entry name</span>
<span style="color:#75715e">;;;                             (4 5 6)))       ;;;; entry value</span>
<span style="color:#75715e">;;;                            (x y)             ;;; formal</span>
<span style="color:#75715e">;;;                            (cons z x))        ;;; body </span>
(<span style="color:#66d9ef">define </span>new-entry build)
(<span style="color:#66d9ef">define </span>extend-table cons)


<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The fifth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;****************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The sixth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;;; myracet6.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;;;</span>
<span style="color:#75715e">;;;</span>

(<span style="color:#66d9ef">define </span>member1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(eq? a (car lat))
                (<span style="color:#a6e22e">member1?</span> a (cdr lat)))))))
<span style="color:#75715e">;;the most common thinking,find it and then continul</span>
(<span style="color:#66d9ef">define </span>is-first?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(eq? (car lat) a)))))

(<span style="color:#66d9ef">define </span>two-in-a-row?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">or </span>(<span style="color:#a6e22e">is-first?</span> (car lat) (cdr lat))
           (<span style="color:#a6e22e">two-in-a-row?</span> (cdr lat)))))))
<span style="color:#75715e">;;;the development, more close,but if-first-b must use</span>
<span style="color:#75715e">;;the two-in-a-row? ,so can we write a version which </span>
<span style="color:#75715e">;;didn&#39;t use two-in-a-row? at all?</span>
(<span style="color:#66d9ef">define </span>is-first-b?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(eq? (car lat) a )
                (<span style="color:#a6e22e">two-in-a-row?</span> lat))))))
(<span style="color:#66d9ef">define </span>two-in-a-row-b?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">is-first-b?</span> (car lat) (cdr lat))))))
<span style="color:#75715e">;;the is-first-b? only do the job about eq?,so why can I</span>
<span style="color:#75715e">;;let is-first-b? also do another thing,recur. So I</span>
<span style="color:#75715e">;;don&#39;t need two-in-a-row? again.</span>
(<span style="color:#66d9ef">define </span>is-first-c?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">preceding</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">or </span>(eq? (car lat) preceding)
           (<span style="color:#a6e22e">is-first-c?</span> (car lat)
                        (cdr lat)))))))
(<span style="color:#66d9ef">define </span>two-in-a-row-c?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#66d9ef">cond </span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">is-first-c?</span> (car lat)
                         (cdr lat))))))
<span style="color:#75715e">;;although two-in-a-row-c? and two-in-a-row-b? look</span>
<span style="color:#75715e">;;the same in the shape;</span>
<span style="color:#75715e">;;but the essence is not the same!</span>
<span style="color:#75715e">;;version b, is just encasual the is-first? and two-</span>
<span style="color:#75715e">;;in-a-row?</span>
<span style="color:#75715e">;;version c, is updated version, used it by itself?</span>

(<span style="color:#66d9ef">define </span>sum-of-prefixes-b
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">sonssf</span> tup)
    (<span style="color:#a6e22e">cond</span>
      ((null? tup) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#66d9ef">else </span>(cons (+ sonssf (car tup))
                  (<span style="color:#a6e22e">sum-of-prefixes-b</span>
                   (+ sonssf (car tup))<span style="color:#75715e">;;thinking hole</span>
                   (cdr tup)))))))
<span style="color:#75715e">;;not leave before,important for your thinking</span>
<span style="color:#75715e">;;(sum-of-prefixes-b 0 &#39;(1 3 5))</span>
<span style="color:#75715e">;;two arguments</span>

(<span style="color:#66d9ef">define </span>pick
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((eq? n <span style="color:#ae81ff">1</span>) (car lat))
      (<span style="color:#66d9ef">else </span>
       (<span style="color:#a6e22e">pick</span> (- n <span style="color:#ae81ff">1</span>) (cdr lat))))))


(<span style="color:#66d9ef">define </span>scramble-b
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup</span> rev-pre)
    (<span style="color:#a6e22e">cond</span>
      ((null? tup) (<span style="color:#66d9ef">quote </span>()))
      (<span style="color:#a6e22e">else</span>
       (cons (<span style="color:#a6e22e">pick</span> (car tup)
                   (cons (car tup) rev-pre))
             (<span style="color:#a6e22e">scramble-b</span> (cdr tup)
                         (cons (car tup) rev-pre)))))))
<span style="color:#75715e">;;&gt;  (scramble-b &#39;(1 1 1 3 4 2 1 1 9 2) (quote ()))</span>
<span style="color:#75715e">;;&#39;(1 1 1 1 1 4 1 1 1 9)</span>
<span style="color:#75715e">;;(scramble-b &#39;(2 1 1 3 4 2 1 1 9 2) (quote ())) have a bug</span>
<span style="color:#75715e">;;&gt; (scramble-b &#39;(1 2 1 3 4 2 1 1 9 2) (quote ()))</span>
<span style="color:#75715e">;;&#39;(1 1 1 2 2 4 1 1 1 9)</span>

<span style="color:#75715e">;;the base procedure</span>
<span style="color:#75715e">;;result     rev-pre</span>
<span style="color:#75715e">;;1          1</span>
<span style="color:#75715e">;;1 1        2(tup di er wei) 1</span>
<span style="color:#75715e">;;1 1 1      1(tup di san wei) 2 1</span>
<span style="color:#75715e">;;1 1 1 2    3 1 2 1 (from here to select the index 3 so is 2)</span>
<span style="color:#75715e">;;1 1 1 2 2  4 3 1 2 1  (select the index 4 of lat)</span>
<span style="color:#75715e">;;1 1 1 2 2 4    2 4 3 1 2 1</span>
<span style="color:#75715e">;;1 1 1 2 2 4 1  1 2 4 3 1 2 1</span>
<span style="color:#75715e">;;1 1 1 2 2 4 1 1     1 1 2 4 3 1 2 1</span>
<span style="color:#75715e">;;1 1 1 2 2 4 1 1 1   9 1 1 2 4 2 1 2 1</span>
<span style="color:#75715e">;;1 1 1 2 2 4 1 1 1 9   2 9 1 1 2 4 2 1 2 1</span>
<span style="color:#75715e">;;actually in the list of the lat,</span>
<span style="color:#75715e">;;the first number in the rev-pre expose the target I </span>
<span style="color:#75715e">;;should get from the rev-pre,so on the one-hand,I should</span>
<span style="color:#75715e">;;pick-up the value according the index from varient and</span>
<span style="color:#75715e">;;increasing lat ,on the second hand I should constuct</span>
<span style="color:#75715e">;;the varient list of revpre!</span>
<span style="color:#75715e">;;step1 car the current tup </span>
<span style="color:#75715e">;;step2 and put it into the list of revpre</span>
<span style="color:#75715e">;;step3 watch the index it on the list of revpre</span>
<span style="color:#75715e">;;step4 put the index value into the results! ok!</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;The sixth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">;</span>
<span style="color:#75715e">; Chapter 11 of The Seasoned Schemer:</span>
<span style="color:#75715e">; Welcome Back to the Show</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
<span style="color:#75715e">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
<span style="color:#75715e">;</span>

<span style="color:#75715e">; Remember member? from The Little Schemer? (http://bit.ly/4GjWdP)</span>
<span style="color:#75715e">; It finds if an element &#39;a&#39; is in a list of atoms &#39;lat&#39;.</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>member?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(eq? a (car lat))
                (<span style="color:#a6e22e">member?</span> a (cdr lat)))))))



<span style="color:#75715e">; member? helper function</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>member1?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">yes?</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
               (<span style="color:#a6e22e">cond</span>
                 ((null? l) <span style="color:#66d9ef">#f</span>)
                 ((eq? (car l) a) <span style="color:#66d9ef">#t</span>)
                 (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">yes?</span> (cdr l)))))))
      (<span style="color:#a6e22e">yes?</span> l))))


<span style="color:#75715e">; is-first? function finds out whether the next element in lat, if there is</span>
<span style="color:#75715e">; one, is identical to this element.</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>is-first?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(eq? (car lat) a)))))

<span style="color:#75715e">; two-in-a-row? function determines whether any atom occurs twice in a row.</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#66d9ef">or </span>(<span style="color:#a6e22e">is-first?</span> (car lat) (cdr lat))
            (<span style="color:#a6e22e">two-in-a-row?</span> (cdr lat)))))))

<span style="color:#75715e">; Examples of two-in-a-row?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(Italian sardines spaghetti parsley))           <span style="color:#75715e">; false</span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(Italian sardines sardines spaghetti parsley))  <span style="color:#75715e">; true</span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(Italian sardines more sardines spaghetti))     <span style="color:#75715e">; false</span>

<span style="color:#75715e">; Another version of two-in-a-row? that leaves decision of what to do to</span>
<span style="color:#75715e">; is-first-b?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row-2?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#a6e22e">is-first-b?</span> (car lat) (cdr lat))))))

<span style="color:#75715e">; is-first-b? function for two-in-a-row-2?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>is-first-b?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(eq? (car lat) a)
                (<span style="color:#a6e22e">two-in-a-row-2?</span> lat))))))

<span style="color:#75715e">; Examples of two-in-a-row-2?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">two-in-a-row-2?</span> <span style="color:#f92672">&#39;</span>(Italian sardines spaghetti parsley))           <span style="color:#75715e">; false</span>
(<span style="color:#a6e22e">two-in-a-row-2?</span> <span style="color:#f92672">&#39;</span>(Italian sardines sardines spaghetti parsley))  <span style="color:#75715e">; true</span>
(<span style="color:#a6e22e">two-in-a-row-2?</span> <span style="color:#f92672">&#39;</span>(Italian sardines more sardines spaghetti))     <span style="color:#75715e">; false</span>

<span style="color:#75715e">; Another version of two-in-a-row? that recurs itself instead of using</span>
<span style="color:#75715e">; is-first?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row-b?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">preceding</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#66d9ef">or </span>(eq? (car lat) preceding)
                (<span style="color:#a6e22e">two-in-a-row-b?</span> (car lat) (cdr lat)))))))

<span style="color:#75715e">; The final version of two-in-a-row?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row-final?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">two-in-a-row-b?</span> (car lat) (cdr lat))))))

(<span style="color:#a6e22e">two-in-a-row-final?</span> <span style="color:#f92672">&#39;</span>(Italian sardines spaghetti parsley))           <span style="color:#75715e">; false</span>
(<span style="color:#a6e22e">two-in-a-row-final?</span> <span style="color:#f92672">&#39;</span>(Italian sardines sardines spaghetti parsley))  <span style="color:#75715e">; true</span>
(<span style="color:#a6e22e">two-in-a-row-final?</span> <span style="color:#f92672">&#39;</span>(Italian sardines more sardines spaghetti))     <span style="color:#75715e">; false</span>

<span style="color:#75715e">; Helper function for upcoming sum-of-prefixes function</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sum-of-prefixes-b
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">sonssf</span> tup)     <span style="color:#75715e">; sonssf stands for &#39;sum of numbers seen so far&#39;</span>
    (<span style="color:#a6e22e">cond</span>
      ((null? tup) <span style="color:#f92672">&#39;</span>())
      (<span style="color:#66d9ef">else </span>(cons (+ sonssf (car tup))
                  (<span style="color:#a6e22e">sum-of-prefixes-b</span>
                   (+ sonssf (car tup))
                   (cdr tup)))))))

<span style="color:#75715e">; sum-of-prefixes function finds the running sum of a list of numbers</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sum-of-prefixes
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup</span>)
    (<span style="color:#a6e22e">sum-of-prefixes-b</span> <span style="color:#ae81ff">0</span> tup)))

<span style="color:#75715e">; Examples of sum-of-prefixes</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">sum-of-prefixes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">17</span> <span style="color:#ae81ff">0</span>))   <span style="color:#75715e">; &#39;(2 3 12 29 29)</span>
(<span style="color:#a6e22e">sum-of-prefixes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>))    <span style="color:#75715e">; &#39;(1 2 3 4 5)</span>
(<span style="color:#a6e22e">sum-of-prefixes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>))        <span style="color:#75715e">; &#39;(1 2 3)</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The eleventh commandment                                                   ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; Use additional arguments when a function needs to know what the other      ;</span>
<span style="color:#75715e">; arguments to the function have been like so far.                           ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; Remember the pick function from chapter 4 of The Little Schemer?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>pick
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">one?</span> n) (car lat))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">pick</span> (<span style="color:#a6e22e">sub1</span> n) (cdr lat))))))

<span style="color:#75715e">; It uses one? and sub1 helper functions</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>one?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>) (= n <span style="color:#ae81ff">1</span>)))

(<span style="color:#66d9ef">define </span>sub1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>) (- n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; scramble-b is a helper function for scramble</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>scramble-b
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup</span> rev-pre)
    (<span style="color:#a6e22e">cond</span>
      ((null? tup) <span style="color:#f92672">&#39;</span>())
      (<span style="color:#a6e22e">else</span>
       (cons (<span style="color:#a6e22e">pick</span> (car tup) (cons (car tup) rev-pre))
             (<span style="color:#a6e22e">scramble-b</span> (cdr tup)
                         (cons (car tup) rev-pre)))))))

<span style="color:#75715e">; scramble</span>
(<span style="color:#66d9ef">define </span>scramble
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup</span>)
    (<span style="color:#a6e22e">scramble-b</span> tup <span style="color:#f92672">&#39;</span>())))

<span style="color:#75715e">; Examples of scramble</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">scramble</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2</span>))       <span style="color:#75715e">; &#39;(1 1 1 1 1 4 1 1 1 9)</span>
(<span style="color:#a6e22e">scramble</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span>))         <span style="color:#75715e">; &#39;(1 1 1 1 1 1 1 1 1)</span>
(<span style="color:#a6e22e">scramble</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">10</span>))    <span style="color:#75715e">; &#39;(1 1 1 1 1 1 1 1 2 8 2)</span>

<span style="color:#75715e">;</span>
<span style="color:#75715e">; Chapter 12 of The Seasoned Schemer:</span>
<span style="color:#75715e">; Take Cover</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
<span style="color:#75715e">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
<span style="color:#75715e">;</span>

<span style="color:#75715e">; add1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>add1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) (+ x <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; The Y-combinator</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>Y
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">le</span>)
    ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>) (<span style="color:#a6e22e">f</span> f))
     (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
       (<span style="color:#a6e22e">le</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) ((<span style="color:#a6e22e">f</span> f) x)))))))

<span style="color:#75715e">; length function written via Y-combinator and applied to &#39;(a b c)</span>
<span style="color:#75715e">;</span>
((<span style="color:#a6e22e">Y</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">length</span>)
     (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
       (<span style="color:#a6e22e">cond</span>
         ((null? l) <span style="color:#ae81ff">0</span>)
         (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (length (cdr l)))))))) <span style="color:#f92672">&#39;</span>(a b c))  <span style="color:#75715e">; produces output 3</span>

<span style="color:#75715e">; No need to pass &#39;a&#39; around in multirember</span>
<span style="color:#75715e">; Use Y-combinator not to pass it around</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>multirember
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    ((<span style="color:#a6e22e">Y</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">mr</span>)
          (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? lat) <span style="color:#f92672">&#39;</span>())
              ((eq? a (car lat)) (<span style="color:#a6e22e">mr</span> (cdr lat)))
              (<span style="color:#a6e22e">else</span>
               (cons (car lat) (<span style="color:#a6e22e">mr</span> (cdr lat))))))))
     lat)))

<span style="color:#75715e">; Example of multirember</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">multirember</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>(a b c a a a x))             <span style="color:#75715e">; &#39;(b c x)</span>

<span style="color:#75715e">; multirember via letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>multirember-letrec
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    ((<span style="color:#a6e22e">letrec</span>
       ((<span style="color:#a6e22e">mr</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
              (<span style="color:#a6e22e">cond</span>
                ((null? lat) <span style="color:#f92672">&#39;</span>())
                ((eq? a (car lat)) (<span style="color:#a6e22e">mr</span> (cdr lat)))
                (<span style="color:#a6e22e">else</span>
                  (cons (car lat) (<span style="color:#a6e22e">mr</span> (cdr lat))))))))
       mr)
     lat)))

<span style="color:#75715e">; Example of multirember-letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">multirember-letrec</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>(a b c a a a x))      <span style="color:#75715e">; &#39;(b c x) </span>

<span style="color:#75715e">; Structure of letrec</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; ((letrec ((mr ...)) mr) values)</span>

<span style="color:#75715e">; Another way to write multirember via letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>multirember-letrec-2
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">mr</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
             (<span style="color:#a6e22e">cond</span>
               ((null? lat) <span style="color:#f92672">&#39;</span>())
               ((eq? a (car lat)) (<span style="color:#a6e22e">mr</span> (cdr lat)))
               (<span style="color:#a6e22e">else</span>
                 (cons (car lat) (<span style="color:#a6e22e">mr</span> (cdr lat))))))))
       (<span style="color:#a6e22e">mr</span> lat))))

<span style="color:#75715e">; Another test of applying multirember-letrec-2</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">multirember-letrec-2</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>(a b c a a a x))      <span style="color:#75715e">; &#39;(b c x) </span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The twelfth commandment                                                    ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; Use (letrec ...) to remove arguments that do not change for recursive      ;</span>
<span style="color:#75715e">; applications.                                                              ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; Yet another way to write multirember via letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>multirember-letrec-3
  (<span style="color:#a6e22e">letrec</span>
    ((<span style="color:#a6e22e">mr</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
           (<span style="color:#a6e22e">cond</span>
             ((null? lat) <span style="color:#f92672">&#39;</span>())
             ((eq? (car lat) a) (<span style="color:#a6e22e">mr</span> a (cdr lat)))
             (<span style="color:#a6e22e">else</span>
               (cons (car lat) (<span style="color:#a6e22e">mr</span> a (cdr lat))))))))
    mr))

<span style="color:#75715e">; Test multirember-letrec-3</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">multirember-letrec-3</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>(a b c a a a x))      <span style="color:#75715e">; &#39;(b c x) </span>

<span style="color:#75715e">; The member? function determines if the given element is in the list</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>member?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
    (<span style="color:#a6e22e">cond</span>
      ((null? lat) <span style="color:#66d9ef">#f</span>)
      ((eq? (car lat) a) <span style="color:#66d9ef">#t</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">member?</span> a (cdr lat))))))

<span style="color:#75715e">; Test member?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">member?</span> <span style="color:#e6db74">&#39;x</span> <span style="color:#f92672">&#39;</span>(a b c x d e f))   <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">member?</span> <span style="color:#e6db74">&#39;x</span> <span style="color:#f92672">&#39;</span>(a b c d e f))     <span style="color:#75715e">; #f</span>

<span style="color:#75715e">; member? via letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>member-letrec?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    ((<span style="color:#a6e22e">letrec</span>
       ((<span style="color:#a6e22e">yes?</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
                (<span style="color:#a6e22e">cond</span>
                  ((null? l) <span style="color:#66d9ef">#f</span>)
                  ((eq? (car l) a) <span style="color:#66d9ef">#t</span>)
                  (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">yes?</span> (cdr l)))))))
     yes?)
    l)))

<span style="color:#75715e">; Test member-letrec?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">member-letrec?</span> <span style="color:#e6db74">&#39;x</span> <span style="color:#f92672">&#39;</span>(a b c x d e f))   <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">member-letrec?</span> <span style="color:#e6db74">&#39;x</span> <span style="color:#f92672">&#39;</span>(a b c d e f))     <span style="color:#75715e">; #f</span>

<span style="color:#75715e">; Another member? via letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>member-letrec-2?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">yes?</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
               (<span style="color:#a6e22e">cond</span>
                 ((null? l) <span style="color:#66d9ef">#f</span>)
                 ((eq? (car l) a) <span style="color:#66d9ef">#t</span>)
                 (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">yes?</span> (cdr l)))))))
      (<span style="color:#a6e22e">yes?</span> l))))

<span style="color:#75715e">; Test member-letrec-2?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">member-letrec-2?</span> <span style="color:#e6db74">&#39;x</span> <span style="color:#f92672">&#39;</span>(a b c x d e f))   <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">member-letrec-2?</span> <span style="color:#e6db74">&#39;x</span> <span style="color:#f92672">&#39;</span>(a b c d e f))     <span style="color:#75715e">; #f</span>

<span style="color:#75715e">; The union function takes two sets and merges them</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>union
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) set2)
      ((<span style="color:#a6e22e">member?</span> (car set1) set2) 
       (<span style="color:#a6e22e">union</span> (cdr set1) set2))
      (<span style="color:#a6e22e">else</span>
        (cons (car set1) (<span style="color:#a6e22e">union</span> (cdr set1) set2))))))

<span style="color:#75715e">; Example of union</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">union</span>
  <span style="color:#f92672">&#39;</span>(tomatoes <span style="color:#66d9ef">and </span>macaroni casserole)
  <span style="color:#f92672">&#39;</span>(macaroni <span style="color:#66d9ef">and </span>cheese)) <span style="color:#75715e">; &#39;(tomatoes and macaroni casserole cheese)</span>

<span style="color:#75715e">; union via letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>union-letrec
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">U</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? set) set2)
              ((<span style="color:#a6e22e">member?</span> (car set) set2)
               (<span style="color:#a6e22e">U</span> (cdr set)))
              (<span style="color:#a6e22e">else</span>
                (cons (car set) (<span style="color:#a6e22e">U</span> (cdr set))))))))
      (<span style="color:#a6e22e">U</span> set1))))

<span style="color:#75715e">; Test of union-letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">union-letrec</span>
  <span style="color:#f92672">&#39;</span>(tomatoes <span style="color:#66d9ef">and </span>macaroni casserole)
  <span style="color:#f92672">&#39;</span>(macaroni <span style="color:#66d9ef">and </span>cheese)) <span style="color:#75715e">; &#39;(tomatoes and macaroni casserole cheese)</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The thirteenth commandment                                                 ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; Use (letrec ...) to hide and to protect functions.                         ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

(<span style="color:#66d9ef">define </span>union-letrec-protected
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">U</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? set) set2)
              ((<span style="color:#a6e22e">M?</span> (car set) set2)
               (<span style="color:#a6e22e">U</span> (cdr set)))
              (<span style="color:#a6e22e">else</span>
                (cons (car set) (<span style="color:#a6e22e">U</span> (cdr set)))))))
       (<span style="color:#a6e22e">M?</span>
         (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
           (<span style="color:#a6e22e">cond</span>
             ((null? lat) <span style="color:#66d9ef">#f</span>)
             ((eq? (car lat) a) <span style="color:#66d9ef">#t</span>)
             (<span style="color:#a6e22e">else</span>
               (<span style="color:#a6e22e">M?</span> a (cdr lat)))))))
      (<span style="color:#a6e22e">U</span> set1))))

<span style="color:#75715e">; Test of union-letrec-protected</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">union-letrec-protected</span>
  <span style="color:#f92672">&#39;</span>(tomatoes <span style="color:#66d9ef">and </span>macaroni casserole)
  <span style="color:#f92672">&#39;</span>(macaroni <span style="color:#66d9ef">and </span>cheese)) <span style="color:#75715e">; &#39;(tomatoes and macaroni casserole cheese)</span>

<span style="color:#75715e">; Fixing M? to follow 12th commandment</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>union-letrec-protected-12
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">U</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? set) set2)
              ((<span style="color:#a6e22e">M?</span> (car set) set2)
               (<span style="color:#a6e22e">U</span> (cdr set)))
              (<span style="color:#a6e22e">else</span>
                (cons (car set) (<span style="color:#a6e22e">U</span> (cdr set)))))))
       (<span style="color:#a6e22e">M?</span>
         (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
           (<span style="color:#a6e22e">letrec</span>
             ((<span style="color:#a6e22e">N?</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
                    (<span style="color:#a6e22e">cond</span>
                      ((null? lat) <span style="color:#66d9ef">#f</span>)
                      ((eq? (car lat) a) <span style="color:#66d9ef">#t</span>)
                      (<span style="color:#a6e22e">else</span>
                        (<span style="color:#a6e22e">N?</span> (cdr lat)))))))
             (<span style="color:#a6e22e">N?</span> lat)))))
      (<span style="color:#a6e22e">U</span> set1))))

<span style="color:#75715e">; Test of union-letrec-protected-12</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">union-letrec-protected-12</span>
  <span style="color:#f92672">&#39;</span>(tomatoes <span style="color:#66d9ef">and </span>macaroni casserole)
  <span style="color:#f92672">&#39;</span>(macaroni <span style="color:#66d9ef">and </span>cheese)) <span style="color:#75715e">; &#39;(tomatoes and macaroni casserole cheese)</span>

<span style="color:#75715e">; The two-in-a-row? checks if a lat contains two equal elements</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">W</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
            (<span style="color:#a6e22e">cond</span>
              ((null? lat) <span style="color:#66d9ef">#f</span>)
              ((eq? a (car lat)) <span style="color:#66d9ef">#t</span>)
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">W</span> (car lat) (cdr lat)))))))
      (<span style="color:#a6e22e">cond</span>
        ((null? lat) <span style="color:#66d9ef">#f</span>)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">W</span> (car lat) (cdr lat)))))))

<span style="color:#75715e">; Test two-in-a-row?</span>
<span style="color:#75715e">; </span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(Italian sardines spaghetti parsley))           <span style="color:#75715e">; #f</span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(Italian sardines sardines spaghetti parsley))  <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(Italian sardines more sardines spaghetti))     <span style="color:#75715e">; #f</span>

<span style="color:#75715e">; Another version of two-in-a-row?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row-2?
  (<span style="color:#a6e22e">letrec</span>
    ((<span style="color:#a6e22e">W</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
          (<span style="color:#a6e22e">cond</span>
            ((null? lat) <span style="color:#66d9ef">#f</span>)
            ((eq? a (car lat)) <span style="color:#66d9ef">#t</span>)
            (<span style="color:#a6e22e">else</span>
              (<span style="color:#a6e22e">W</span> (car lat) (cdr lat)))))))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
      (<span style="color:#a6e22e">cond</span>
        ((null? lat) <span style="color:#66d9ef">#f</span>)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">W</span> (car lat) (cdr lat)))))))

<span style="color:#75715e">; Test two-in-a-row-2?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">two-in-a-row-2?</span> <span style="color:#f92672">&#39;</span>(Italian sardines spaghetti parsley))           <span style="color:#75715e">; #f</span>
(<span style="color:#a6e22e">two-in-a-row-2?</span> <span style="color:#f92672">&#39;</span>(Italian sardines sardines spaghetti parsley))  <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">two-in-a-row-2?</span> <span style="color:#f92672">&#39;</span>(Italian sardines more sardines spaghetti))     <span style="color:#75715e">; #f</span>

<span style="color:#75715e">; The sum-of-prefixes finds the running sum of a list of numbers</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sum-of-prefixes
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">tup</span>)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">S</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">sss</span> tup)
            (<span style="color:#a6e22e">cond</span>
              ((null? tup) <span style="color:#f92672">&#39;</span>())
              (<span style="color:#a6e22e">else</span>
                (cons (+ sss (car tup))
                      (<span style="color:#a6e22e">S</span> (+ sss (car tup)) (cdr tup))))))))
      (<span style="color:#a6e22e">S</span> <span style="color:#ae81ff">0</span> tup))))

<span style="color:#75715e">; Examples of sum-of-prefixes</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">sum-of-prefixes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">17</span> <span style="color:#ae81ff">0</span>))   <span style="color:#75715e">; &#39;(2 3 12 29 29)</span>
(<span style="color:#a6e22e">sum-of-prefixes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>))    <span style="color:#75715e">; &#39;(1 2 3 4 5)</span>
(<span style="color:#a6e22e">sum-of-prefixes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>))        <span style="color:#75715e">; &#39;(1 2 3)</span>



(<span style="color:#66d9ef">define </span>intersect
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">cond</span>
      ((null? set1) <span style="color:#f92672">&#39;</span>())  <span style="color:#75715e">; don&#39;t forget the 1st commandment</span>
      ((<span style="color:#a6e22e">member?</span> (car set1) set2)
       (cons (car set1) (<span style="color:#a6e22e">intersect</span> (cdr set1) set2)))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">intersect</span> (cdr set1) set2)))))

<span style="color:#75715e">; It needs member? helper function</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>member?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">yes?</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
               (<span style="color:#a6e22e">cond</span>
                 ((null? l) <span style="color:#66d9ef">#f</span>)
                 ((eq? (car l) a) <span style="color:#66d9ef">#t</span>)
                 (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">yes?</span> (cdr l)))))))
      (<span style="color:#a6e22e">yes?</span> l))))

<span style="color:#75715e">; Examples of intersect</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">intersect</span> <span style="color:#f92672">&#39;</span>(a b x c d) <span style="color:#f92672">&#39;</span>(q w e x r t y a))     <span style="color:#75715e">; &#39;(a x)</span>
(<span style="color:#a6e22e">intersect</span> <span style="color:#f92672">&#39;</span>(a b x c d) <span style="color:#f92672">&#39;</span>())                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersect</span> <span style="color:#f92672">&#39;</span>() <span style="color:#f92672">&#39;</span>())                             <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersect</span> <span style="color:#f92672">&#39;</span>() <span style="color:#f92672">&#39;</span>(a b x c d))                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersect</span> <span style="color:#f92672">&#39;</span>(a b x c d) <span style="color:#f92672">&#39;</span>(a b x c d))           <span style="color:#75715e">; &#39;(a b x c d)</span>

<span style="color:#75715e">; We forgot the 12th commandment - use letrec to remove arguments</span>
<span style="color:#75715e">; that do not change for recursive applications</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>intersect-letrec
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set1</span> set2)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">I</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">set</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? set) <span style="color:#f92672">&#39;</span>())
              ((<span style="color:#a6e22e">member?</span> (car set) set2)
               (cons (car set) (<span style="color:#a6e22e">I</span> (cdr set))))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">I</span> (cdr set)))))))
      (<span style="color:#a6e22e">I</span> set1))))

<span style="color:#75715e">; Test of intersect-letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">intersect-letrec</span> <span style="color:#f92672">&#39;</span>(a b x c d) <span style="color:#f92672">&#39;</span>(q w e x r t y a))     <span style="color:#75715e">; &#39;(a x)</span>
(<span style="color:#a6e22e">intersect-letrec</span> <span style="color:#f92672">&#39;</span>(a b x c d) <span style="color:#f92672">&#39;</span>())                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersect-letrec</span> <span style="color:#f92672">&#39;</span>() <span style="color:#f92672">&#39;</span>())                             <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersect-letrec</span> <span style="color:#f92672">&#39;</span>() <span style="color:#f92672">&#39;</span>(a b x c d))                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersect-letrec</span> <span style="color:#f92672">&#39;</span>(a b x c d) <span style="color:#f92672">&#39;</span>(a b x c d))           <span style="color:#75715e">; &#39;(a b x c d)</span>

<span style="color:#75715e">; The intersectall function finds intersect of a bunch of sets</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>intersectall
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lset</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? lset) <span style="color:#f92672">&#39;</span>())
      ((null? (cdr lset)) (car lset))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">intersect</span> (car lset)
                   (<span style="color:#a6e22e">intersectall</span> (cdr lset)))))))

<span style="color:#75715e">; Examples of intersectall</span>


<span style="color:#75715e">; Examples of intersectall</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">intersectall</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>)))                   <span style="color:#75715e">; &#39;(a)</span>
(<span style="color:#a6e22e">intersectall</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) () (<span style="color:#a6e22e">a</span>)))                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall</span> <span style="color:#f92672">&#39;</span>())                              <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span> b c d) (<span style="color:#a6e22e">b</span> c d e) (<span style="color:#a6e22e">c</span> d e f))) <span style="color:#75715e">; &#39;(c d)</span>



(<span style="color:#66d9ef">define </span>intersectall-letrec
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lset</span>)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">A</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lset</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? (cdr lset)) (car lset))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">intersect</span> (car lset)
                           (<span style="color:#a6e22e">A</span> (cdr lset))))))))
      (<span style="color:#a6e22e">cond</span>
        ((null? lset) <span style="color:#f92672">&#39;</span>())
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">A</span> lset))))))

<span style="color:#75715e">; Tests of intersectall-letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">intersectall-letrec</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>)))                   <span style="color:#75715e">; &#39;(a)</span>
(<span style="color:#a6e22e">intersectall-letrec</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) () (<span style="color:#a6e22e">a</span>)))                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall-letrec</span> <span style="color:#f92672">&#39;</span>())                              <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall-letrec</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span> b c d) (<span style="color:#a6e22e">b</span> c d e) (<span style="color:#a6e22e">c</span> d e f))) <span style="color:#75715e">; &#39;(c d)</span>




<span style="color:#75715e">; Introducing letcc</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>intersectall-letcc
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lset</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">hop</span>)
        (<span style="color:#a6e22e">letrec</span>
          ((<span style="color:#a6e22e">A</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lset</span>)
                (<span style="color:#a6e22e">cond</span>
                  ((null? (car lset)) (<span style="color:#a6e22e">hop</span> <span style="color:#f92672">&#39;</span>()))
                  ((null? (cdr lset)) (car lset))
                  (<span style="color:#a6e22e">else</span>
                    (<span style="color:#a6e22e">intersect</span> (car lset)
                               (<span style="color:#a6e22e">A</span> (cdr lset))))))))
          (<span style="color:#a6e22e">cond</span>
            ((null? lset) <span style="color:#f92672">&#39;</span>())
            (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">A</span> lset))))))))

<span style="color:#75715e">; Tests of intersectall-letcc</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">intersectall-letcc</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>)))                   <span style="color:#75715e">; &#39;(a)</span>
(<span style="color:#a6e22e">intersectall-letcc</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) () (<span style="color:#a6e22e">a</span>)))                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall-letcc</span> <span style="color:#f92672">&#39;</span>())                              <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall-letcc</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span> b c d) (<span style="color:#a6e22e">b</span> c d e) (<span style="color:#a6e22e">c</span> d e f))) <span style="color:#75715e">; &#39;(c d)</span>



<span style="color:#75715e">; intersectall that returns abruptly and promptly</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>intersectall-ap
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lset</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">hop</span>)
        (<span style="color:#a6e22e">letrec</span>
          ((<span style="color:#a6e22e">A</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lset</span>)
                (<span style="color:#a6e22e">cond</span>
                  <span style="color:#75715e">;;;hop one</span>
                  ((null? (car lset)) (<span style="color:#a6e22e">hop</span> <span style="color:#f92672">&#39;</span>()))
                  ((null? (cdr lset)) (car lset))
                  (<span style="color:#a6e22e">else</span>
                    (<span style="color:#a6e22e">I</span> (car lset)
                       (<span style="color:#a6e22e">A</span> (cdr lset)))))))
           (<span style="color:#a6e22e">I</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s1</span> s2)
                (<span style="color:#a6e22e">letrec</span>
                  ((<span style="color:#a6e22e">J</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s1</span>)
                        (<span style="color:#a6e22e">cond</span>
                          ((null? s1) <span style="color:#f92672">&#39;</span>())
                          ((<span style="color:#a6e22e">member?</span> (car s1) s2)
                           <span style="color:#75715e">;;;get the one you need</span>
                           (cons (car s1) (<span style="color:#a6e22e">J</span> (cdr s1))))
                          (<span style="color:#a6e22e">else</span>
                            (<span style="color:#a6e22e">J</span> (cdr s1)))))))
                  (<span style="color:#a6e22e">cond</span>
                    <span style="color:#75715e">;;;hop two</span>
                    ((null? s2) (<span style="color:#a6e22e">hop</span> <span style="color:#f92672">&#39;</span>()))
                    (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">J</span> s1)))))))
          (<span style="color:#a6e22e">cond</span>
            ((null? lset) <span style="color:#f92672">&#39;</span>())
            (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">A</span> lset))))))))

<span style="color:#75715e">; Tests of intersectall-ap</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">intersectall-ap</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>) (<span style="color:#a6e22e">a</span>)))                   <span style="color:#75715e">; &#39;(a)</span>
(<span style="color:#a6e22e">intersectall-ap</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span>) () (<span style="color:#a6e22e">a</span>)))                    <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall-ap</span> <span style="color:#f92672">&#39;</span>())                              <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">intersectall-ap</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">a</span> b c d) (<span style="color:#a6e22e">b</span> c d e) (<span style="color:#a6e22e">c</span> d e f))) <span style="color:#75715e">; &#39;(c d)</span>

<span style="color:#75715e">; rember function via letrec</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Chapter 14 of The Seasoned Schemer:</span>
<span style="color:#75715e">; Let There Be Names</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
<span style="color:#75715e">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
<span style="color:#75715e">;</span>

<span style="color:#75715e">; atom? primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
   (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))  

<span style="color:#75715e">; add1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>add1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (+ n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; The leftmost function finds the leftmost atom in a non-empty list of</span>
<span style="color:#75715e">; s-expressions that does not contain the empty list.</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>leftmost
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#a6e22e">atom?</span> (car l)) (car l))
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">leftmost</span> (car l))))))

<span style="color:#75715e">; Example of leftmost</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">leftmost</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">a</span>) b) (<span style="color:#a6e22e">c</span> d)))         <span style="color:#75715e">; &#39;a</span>

<span style="color:#75715e">; Example of not-applicable leftmost</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; (leftmost &#39;((() a) ()))           ; not applicable because leftmost item is an empty list</span>

<span style="color:#75715e">; Let&#39;s fix this.</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>leftmost-fixed
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((<span style="color:#a6e22e">atom?</span> (car l)) (car l))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">cond</span>
          ((<span style="color:#a6e22e">atom?</span> (<span style="color:#a6e22e">leftmost-fixed</span> (car l)))
           (<span style="color:#a6e22e">leftmost-fixed</span> (car l)))
          (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">leftmost-fixed</span> (cdr l))))))))

<span style="color:#75715e">; Examples of leftmost-fixed</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">leftmost-fixed</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) b) (<span style="color:#a6e22e">c</span> d)))   <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-fixed</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) ()) () (<span style="color:#a6e22e">e</span>))) <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-fixed</span> <span style="color:#f92672">&#39;</span>(((() x) ())))     <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-fixed</span> <span style="color:#f92672">&#39;</span>(((()) ())))       <span style="color:#75715e">; &#39;()</span>

(<span style="color:#66d9ef">define </span>leftmost-let
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((<span style="color:#a6e22e">atom?</span> (car l)) (car l))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">a</span> (<span style="color:#a6e22e">leftmost-let</span> (car l))))
          (<span style="color:#a6e22e">cond</span>
            ((<span style="color:#a6e22e">atom?</span> a) a)
            (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">leftmost-let</span> (cdr l)))))))))

<span style="color:#75715e">; Tests of leftmost-let</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">leftmost-let</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">y</span>) b) (<span style="color:#a6e22e">c</span> d)))   <span style="color:#75715e">; &#39;y</span>
(<span style="color:#a6e22e">leftmost-let</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">y</span>) ()) () (<span style="color:#a6e22e">e</span>))) <span style="color:#75715e">; &#39;y</span>
(<span style="color:#a6e22e">leftmost-let</span> <span style="color:#f92672">&#39;</span>(((() y) ())))     <span style="color:#75715e">; &#39;y</span>
(<span style="color:#a6e22e">leftmost-let</span> <span style="color:#f92672">&#39;</span>(((()) ())))       <span style="color:#75715e">; &#39;()</span>

<span style="color:#75715e">; The rember1* function removes the leftmost occurrence of a in l</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>rember1*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#a6e22e">cond</span>
         ((eq? (car l) a) (cdr l))
         (<span style="color:#a6e22e">else</span>
           (cons (car l) (<span style="color:#a6e22e">rember1*</span> a (cdr l))))))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">cond</span>
          ((equal? (<span style="color:#a6e22e">rember1*</span> a (car l)) (car l)) <span style="color:#75715e">; if the list with &#39;a&#39; removed doesn&#39;t change</span>
           (cons (car l) (<span style="color:#a6e22e">rember1*</span> a (cdr l))))  <span style="color:#75715e">; then recurse</span>
          (<span style="color:#a6e22e">else</span>
            (cons (<span style="color:#a6e22e">rember1*</span> a (car l)) (cdr l)))))))) <span style="color:#75715e">; otherwise remove &#39;a&#39;</span>

<span style="color:#75715e">; Examples of rember1*</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">rember1*</span>
  <span style="color:#e6db74">&#39;salad</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">Swedish</span> rye) (<span style="color:#a6e22e">French</span> (<span style="color:#a6e22e">mustard</span> salad turkey)) salad))
<span style="color:#75715e">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>

(<span style="color:#a6e22e">rember1*</span>
  <span style="color:#e6db74">&#39;meat</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pasta</span> meat) pasta (<span style="color:#a6e22e">noodles</span> meat sauce) meat tomatoes))
<span style="color:#75715e">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>

<span style="color:#75715e">; rember1* rewritten using the 12th commandment</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>rember1*-letrec
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">R</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? l) <span style="color:#f92672">&#39;</span>())
              ((<span style="color:#a6e22e">atom?</span> (car l))
               (<span style="color:#a6e22e">cond</span>
                 ((eq? (car l) a) (cdr l))
                 (<span style="color:#a6e22e">else</span>
                   (cons (car l) (<span style="color:#a6e22e">R</span> (cdr l))))))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">cond</span>
                  ((equal? (<span style="color:#a6e22e">R</span> (car l)) (car l)) <span style="color:#75715e">; if the list with &#39;a&#39; removed doesn&#39;t change</span>
                   (cons (car l) (<span style="color:#a6e22e">R</span> (cdr l))))  <span style="color:#75715e">; then recurse</span>
                  (<span style="color:#a6e22e">else</span>
                    (cons (<span style="color:#a6e22e">R</span> (car l)) (cdr l))))))))) <span style="color:#75715e">; otherwise remove &#39;a&#39;</span>
      (<span style="color:#a6e22e">R</span> l))))

<span style="color:#75715e">; Tests of rember1*-letrec</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">rember1*-letrec</span>
  <span style="color:#e6db74">&#39;salad</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">Swedish</span> rye) (<span style="color:#a6e22e">French</span> (<span style="color:#a6e22e">mustard</span> salad turkey)) salad))
<span style="color:#75715e">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>

(<span style="color:#a6e22e">rember1*-letrec</span>
  <span style="color:#e6db74">&#39;meat</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pasta</span> meat) pasta (<span style="color:#a6e22e">noodles</span> meat sauce) meat tomatoes))
<span style="color:#75715e">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>

<span style="color:#75715e">; rember* rewritten using the 12th commandment and let</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>rember1*-letrec-let
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">R</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? l) <span style="color:#f92672">&#39;</span>())
              ((<span style="color:#a6e22e">atom?</span> (car l))
               (<span style="color:#a6e22e">cond</span>
                 ((eq? (car l) a) (cdr l))
                 (<span style="color:#a6e22e">else</span>
                   (cons (car l) (<span style="color:#a6e22e">R</span> (cdr l))))))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">av</span> (<span style="color:#a6e22e">R</span> (car l))))
                  (<span style="color:#a6e22e">cond</span>
                    ((equal? (car l) av)         <span style="color:#75715e">; if the list with &#39;a&#39; removed didn&#39;t change</span>
                     (cons (car l) (<span style="color:#a6e22e">R</span> (cdr l)))) <span style="color:#75715e">; then recurse</span>
                    (<span style="color:#a6e22e">else</span>
                      (cons av (cdr l))))))))))  <span style="color:#75715e">; otherwise remove &#39;a&#39;</span>
      (<span style="color:#a6e22e">R</span> l))))

<span style="color:#75715e">; Tests of rember1*-letrec-let</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">rember1*-letrec-let</span>
  <span style="color:#e6db74">&#39;salad</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">Swedish</span> rye) (<span style="color:#a6e22e">French</span> (<span style="color:#a6e22e">mustard</span> salad turkey)) salad))
<span style="color:#75715e">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>

(<span style="color:#a6e22e">rember1*-letrec-let</span>
  <span style="color:#e6db74">&#39;meat</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pasta</span> meat) pasta (<span style="color:#a6e22e">noodles</span> meat sauce) meat tomatoes))
<span style="color:#75715e">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The fifteenth commandment (preliminary version)                            ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; Use (let ...) to name the values of repeated expressions.                  ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; The depth* function finds the max depth of an s-expression</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>depth*
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l)) (<span style="color:#a6e22e">depth*</span> (cdr l)))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">cond</span>
          ((&gt; (<span style="color:#a6e22e">depth*</span> (cdr l))
              (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">depth*</span> (car l))))
           (<span style="color:#a6e22e">depth*</span> (cdr l)))
          (<span style="color:#a6e22e">else</span>
            (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">depth*</span> (car l)))))))))

<span style="color:#75715e">; Examples of depth*</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">depth*</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pickled</span>) peppers (<span style="color:#a6e22e">peppers</span> pickled)))                          <span style="color:#75715e">; 2</span>
(<span style="color:#a6e22e">depth*</span> <span style="color:#f92672">&#39;</span>(margarine ((<span style="color:#a6e22e">bitter</span> butter) (<span style="color:#a6e22e">makes</span>) (<span style="color:#a6e22e">batter</span> (<span style="color:#a6e22e">bitter</span>))) butter)) <span style="color:#75715e">; 4</span>
(<span style="color:#a6e22e">depth*</span> <span style="color:#f92672">&#39;</span>(c (<span style="color:#a6e22e">b</span> (<span style="color:#a6e22e">a</span> b) a) a))                                              <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; depth* rewritten using let</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>depth*-let
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l)) (<span style="color:#a6e22e">depth*-let</span> (cdr l)))
      (<span style="color:#66d9ef">else </span>
        (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">a</span> (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">depth*-let</span> (car l))))
              (<span style="color:#a6e22e">d</span> (<span style="color:#a6e22e">depth*-let</span> (cdr l))))
          (<span style="color:#a6e22e">cond</span>
            ((&gt; d a) d)
            (<span style="color:#66d9ef">else </span>a)))))))

<span style="color:#75715e">; Tests of depth*-let</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">depth*-let</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pickled</span>) peppers (<span style="color:#a6e22e">peppers</span> pickled)))                          <span style="color:#75715e">; 2</span>
(<span style="color:#a6e22e">depth*-let</span> <span style="color:#f92672">&#39;</span>(margarine ((<span style="color:#a6e22e">bitter</span> butter) (<span style="color:#a6e22e">makes</span>) (<span style="color:#a6e22e">batter</span> (<span style="color:#a6e22e">bitter</span>))) butter)) <span style="color:#75715e">; 4</span>
(<span style="color:#a6e22e">depth*-let</span> <span style="color:#f92672">&#39;</span>(c (<span style="color:#a6e22e">b</span> (<span style="color:#a6e22e">a</span> b) a) a))                                              <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; Another version of depth*</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>depth*-let-2
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">d</span> (<span style="color:#a6e22e">depth*-let-2</span> (cdr l))))
          (<span style="color:#a6e22e">cond</span>
            ((<span style="color:#a6e22e">atom?</span> (car l)) d)
            (<span style="color:#a6e22e">else</span>
              (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">a</span> (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">depth*-let-2</span> (car l)))))
                (<span style="color:#a6e22e">cond</span>
                  ((&gt; d a) d)
                  (<span style="color:#66d9ef">else </span>a))))))))))

<span style="color:#75715e">; Tests of depth*-let</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">depth*-let-2</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pickled</span>) peppers (<span style="color:#a6e22e">peppers</span> pickled)))                          <span style="color:#75715e">; 2</span>
(<span style="color:#a6e22e">depth*-let-2</span> <span style="color:#f92672">&#39;</span>(margarine ((<span style="color:#a6e22e">bitter</span> butter) (<span style="color:#a6e22e">makes</span>) (<span style="color:#a6e22e">batter</span> (<span style="color:#a6e22e">bitter</span>))) butter)) <span style="color:#75715e">; 4</span>
(<span style="color:#a6e22e">depth*-let-2</span> <span style="color:#f92672">&#39;</span>(c (<span style="color:#a6e22e">b</span> (<span style="color:#a6e22e">a</span> b) a) a))                                              <span style="color:#75715e">; 3</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The fifteenth commandment (revised version)                                ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; Use (let ...) to name the values of repeated expressions in a function     ;</span>
<span style="color:#75715e">; definition if they may be evaluated twice for one and the same use of the  ;</span>
<span style="color:#75715e">; function.                                                                  ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; depth* via if</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>depth*-if
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#a6e22e">depth*-if</span> (cdr l)))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">a</span> (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">depth*</span> (car l))))
              (<span style="color:#a6e22e">d</span> (<span style="color:#a6e22e">depth*</span> (cdr l))))
          (<span style="color:#66d9ef">if </span>(&gt; d a) d a))))))

<span style="color:#75715e">; Tests of depth*-if</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">depth*-if</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pickled</span>) peppers (<span style="color:#a6e22e">peppers</span> pickled)))                          <span style="color:#75715e">; 2</span>
(<span style="color:#a6e22e">depth*-if</span> <span style="color:#f92672">&#39;</span>(margarine ((<span style="color:#a6e22e">bitter</span> butter) (<span style="color:#a6e22e">makes</span>) (<span style="color:#a6e22e">batter</span> (<span style="color:#a6e22e">bitter</span>))) butter)) <span style="color:#75715e">; 4</span>
(<span style="color:#a6e22e">depth*-if</span> <span style="color:#f92672">&#39;</span>(c (<span style="color:#a6e22e">b</span> (<span style="color:#a6e22e">a</span> b) a) a))                                              <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; depth* via max</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>depth*-max
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">1</span>)
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#a6e22e">depth*-max</span> (cdr l)))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">max</span>
          (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">depth*-max</span> (car l)))
          (<span style="color:#a6e22e">depth*-max</span> (cdr l)))))))

<span style="color:#75715e">; Tests of depth*-max</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">depth*-max</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pickled</span>) peppers (<span style="color:#a6e22e">peppers</span> pickled)))                          <span style="color:#75715e">; 2</span>
(<span style="color:#a6e22e">depth*-max</span> <span style="color:#f92672">&#39;</span>(margarine ((<span style="color:#a6e22e">bitter</span> butter) (<span style="color:#a6e22e">makes</span>) (<span style="color:#a6e22e">batter</span> (<span style="color:#a6e22e">bitter</span>))) butter)) <span style="color:#75715e">; 4</span>
(<span style="color:#a6e22e">depth*-max</span> <span style="color:#f92672">&#39;</span>(c (<span style="color:#a6e22e">b</span> (<span style="color:#a6e22e">a</span> b) a) a))                                              <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; Not interested in scramble problem, skipping it.</span>

<span style="color:#75715e">; leftmost via letcc</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>leftmost-letcc
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">skip</span>)
        (<span style="color:#a6e22e">lm</span> l skip)))))

<span style="color:#75715e">; lm is leftmost-letcc&#39;s helper function</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>lm
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span> out)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((<span style="color:#a6e22e">atom?</span> (car l)) (<span style="color:#a6e22e">out</span> (car l)))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#66d9ef">let </span>() <span style="color:#75715e">; can also use &#39;begin&#39;</span>
          (<span style="color:#a6e22e">lm</span> (car l) out)
          (<span style="color:#a6e22e">lm</span> (cdr l) out))))))

(<span style="color:#a6e22e">leftmost-letcc</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) b) (<span style="color:#a6e22e">c</span> d)))   <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-letcc</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) ()) () (<span style="color:#a6e22e">e</span>))) <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-letcc</span> <span style="color:#f92672">&#39;</span>(((() x) ())))     <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-letcc</span> <span style="color:#f92672">&#39;</span>(((()) ())))       <span style="color:#75715e">; &#39;()</span>

<span style="color:#75715e">; letfmost following 13th and 14th commandments</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>leftmost-1314
  (<span style="color:#a6e22e">letrec</span>
    ((<span style="color:#a6e22e">lm</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span> out)
           (<span style="color:#a6e22e">cond</span>
             ((null? l) <span style="color:#f92672">&#39;</span>())
             ((<span style="color:#a6e22e">atom?</span> (car l)) (<span style="color:#a6e22e">out</span> (car l)))
             (<span style="color:#a6e22e">else</span>
               (<span style="color:#a6e22e">begin</span>
                 (<span style="color:#a6e22e">lm</span> (car l) out)
                 (<span style="color:#a6e22e">lm</span> (cdr l) out)))))))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#a6e22e">call-with-current-continuation</span>
        (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">skip</span>)
          (<span style="color:#a6e22e">lm</span> l skip))))))

(<span style="color:#a6e22e">leftmost-1314</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) b) (<span style="color:#a6e22e">c</span> d)))   <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-1314</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) ()) () (<span style="color:#a6e22e">e</span>))) <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-1314</span> <span style="color:#f92672">&#39;</span>(((() x) ())))     <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-1314</span> <span style="color:#f92672">&#39;</span>(((()) ())))       <span style="color:#75715e">; &#39;()</span>

<span style="color:#75715e">; another way to follow 13th and 14th commandments</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>leftmost-13142
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#a6e22e">letrec</span>
        ((<span style="color:#a6e22e">lm</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span> out)
               (<span style="color:#a6e22e">cond</span>
                 ((null? l) <span style="color:#f92672">&#39;</span>())
                 ((<span style="color:#a6e22e">atom?</span> (car l)) (<span style="color:#a6e22e">out</span> (car l)))
                 (<span style="color:#a6e22e">else</span>
                   (<span style="color:#a6e22e">begin</span>
                     (<span style="color:#a6e22e">lm</span> (car l) out)
                     (<span style="color:#a6e22e">lm</span> (cdr l) out)))))))
        (<span style="color:#a6e22e">call-with-current-continuation</span>
          (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">skip</span>)
            (<span style="color:#a6e22e">lm</span> l skip))))))

(<span style="color:#a6e22e">leftmost-13142</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) b) (<span style="color:#a6e22e">c</span> d)))   <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-13142</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) ()) () (<span style="color:#a6e22e">e</span>))) <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-13142</span> <span style="color:#f92672">&#39;</span>(((() x) ())))     <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-13142</span> <span style="color:#f92672">&#39;</span>(((()) ())))       <span style="color:#75715e">; &#39;()</span>

<span style="color:#75715e">; yet another way</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>leftmost-131422
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">skip</span>)
        (<span style="color:#a6e22e">letrec</span>
          ((<span style="color:#a6e22e">lm</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
                 (<span style="color:#a6e22e">cond</span>
                   ((null? l) <span style="color:#f92672">&#39;</span>())
                   ((<span style="color:#a6e22e">atom?</span> (car l)) (<span style="color:#a6e22e">skip</span> (car l)))
                   (<span style="color:#a6e22e">else</span>
                     (<span style="color:#a6e22e">begin</span>
                       (<span style="color:#a6e22e">lm</span> (car l))
                       (<span style="color:#a6e22e">lm</span> (cdr l))))))))
          (<span style="color:#a6e22e">lm</span> l))))))

(<span style="color:#a6e22e">leftmost-131422</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) b) (<span style="color:#a6e22e">c</span> d)))   <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-131422</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">x</span>) ()) () (<span style="color:#a6e22e">e</span>))) <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-131422</span> <span style="color:#f92672">&#39;</span>(((() x) ())))     <span style="color:#75715e">; &#39;x</span>
(<span style="color:#a6e22e">leftmost-131422</span> <span style="color:#f92672">&#39;</span>(((()) ())))       <span style="color:#75715e">; &#39;()</span>

<span style="color:#75715e">; rember1* via letcc</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>rember1*-letcc
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">rm</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l oh)
             (<span style="color:#a6e22e">cond</span>
               ((null? l) (<span style="color:#a6e22e">oh</span> <span style="color:#e6db74">&#39;no</span>))
               ((<span style="color:#a6e22e">atom?</span> (car l))
                (<span style="color:#66d9ef">if </span>(eq? (car l) a)
                  (cdr l)
                  (cons (car l) (<span style="color:#a6e22e">rm</span> a (cdr l) oh))))
               (<span style="color:#a6e22e">else</span>
                 (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">new-car</span>
                         (<span style="color:#a6e22e">call-with-current-continuation</span>
                           (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">oh</span>)
                             (<span style="color:#a6e22e">rm</span> a (car l) oh)))))
                   (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> new-car)
                     (cons (car l) (<span style="color:#a6e22e">rm</span> a (cdr l) oh))
                     (cons new-car (cdr l)))))))))
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">new-l</span>
              (<span style="color:#a6e22e">call-with-current-continuation</span>
                (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">oh</span>)
                  (<span style="color:#a6e22e">rm</span> a l oh)))))
        (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> new-l)
          l
          new-l)))))

<span style="color:#75715e">; Tests of rember1*-letcc</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">rember1*-letcc</span>
  <span style="color:#e6db74">&#39;salad</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">Swedish</span> rye) (<span style="color:#a6e22e">French</span> (<span style="color:#a6e22e">mustard</span> salad turkey)) salad))
<span style="color:#75715e">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>

(<span style="color:#a6e22e">rember1*-letcc</span>
  <span style="color:#e6db74">&#39;meat</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">pasta</span> meat) pasta (<span style="color:#a6e22e">noodles</span> meat sauce) meat tomatoes))
<span style="color:#75715e">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>

(<span style="color:#a6e22e">rember1*-letcc</span>
  <span style="color:#e6db74">&#39;a</span>
  <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">foo</span> bar) baz))
<span style="color:#75715e">; ==&gt; &#39;((foo bar) baz)</span>


<span style="color:#75715e">;</span>
<span style="color:#75715e">; Chapter 16 of The Seasoned Schemer:</span>
<span style="color:#75715e">; Ready, Set, Bang!</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
<span style="color:#75715e">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
<span style="color:#75715e">;</span>

<span style="color:#75715e">; sub1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sub1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (- n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; add1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>add1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (+ n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; atom? primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
   (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))  

<span style="color:#75715e">; member? helper function</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>member?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> l)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">yes?</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
               (<span style="color:#a6e22e">cond</span>
                 ((null? l) <span style="color:#66d9ef">#f</span>)
                 ((eq? (car l) a) <span style="color:#66d9ef">#t</span>)
                 (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">yes?</span> (cdr l)))))))
      (<span style="color:#a6e22e">yes?</span> l))))


<span style="color:#75715e">; Code examples start here</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sweet-tooth
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">food</span>)
    (cons food (cons <span style="color:#e6db74">&#39;cake</span> <span style="color:#f92672">&#39;</span>()))))

(<span style="color:#66d9ef">define </span>last <span style="color:#e6db74">&#39;angelfood</span>)

(<span style="color:#a6e22e">sweet-tooth</span> <span style="color:#e6db74">&#39;fruit</span>)        <span style="color:#75715e">; &#39;(fruit cake)</span>
last                        <span style="color:#75715e">; &#39;angelfood</span>

<span style="color:#75715e">; The sweet-toothL function saves the last food</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sweet-toothL
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">food</span>)
    (<span style="color:#66d9ef">set! </span>last food)
    (cons food (cons <span style="color:#e6db74">&#39;cake</span> <span style="color:#f92672">&#39;</span>()))))

(<span style="color:#a6e22e">sweet-toothL</span> <span style="color:#e6db74">&#39;chocolate</span>)   <span style="color:#75715e">; &#39;(chocolate cake)</span>
last                        <span style="color:#75715e">; &#39;chocolate</span>

(<span style="color:#a6e22e">sweet-toothL</span> <span style="color:#e6db74">&#39;fruit</span>)       <span style="color:#75715e">; &#39;(fruit cake)</span>
last                        <span style="color:#75715e">; &#39;fruit</span>

(<span style="color:#66d9ef">define </span>ingredients <span style="color:#f92672">&#39;</span>())

<span style="color:#75715e">; The sweet-toothR function builds a list of foods</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sweet-toothR
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">food</span>)
    (<span style="color:#66d9ef">set! </span>ingredients
      (cons food ingredients))
    (cons food (cons <span style="color:#e6db74">&#39;cake</span> <span style="color:#f92672">&#39;</span>()))))

(<span style="color:#a6e22e">sweet-toothR</span> <span style="color:#e6db74">&#39;chocolate</span>)   <span style="color:#75715e">; &#39;(chocolate cake)</span>
ingredients                 <span style="color:#75715e">; &#39;(chocolate)</span>

(<span style="color:#a6e22e">sweet-toothR</span> <span style="color:#e6db74">&#39;fruit</span>)       <span style="color:#75715e">; &#39;(fruit cake)</span>
ingredients                 <span style="color:#75715e">; &#39;(fruit chocolate)</span>

(<span style="color:#a6e22e">sweet-toothR</span> <span style="color:#e6db74">&#39;cheese</span>)      <span style="color:#75715e">; &#39;(cheese cake)</span>
ingredients                 <span style="color:#75715e">; &#39;(cheese fruit chocolate)</span>

(<span style="color:#a6e22e">sweet-toothR</span> <span style="color:#e6db74">&#39;carrot</span>)      <span style="color:#75715e">; &#39;(carrot cake)</span>
ingredients                 <span style="color:#75715e">; &#39;(carrot cheese fruit chocolate)</span>

<span style="color:#75715e">; The deep function wraps pizza in n parenthesis</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deep
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m) <span style="color:#e6db74">&#39;pizza</span>)
      (<span style="color:#a6e22e">else</span>
        (cons (<span style="color:#a6e22e">deep</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>())))))

<span style="color:#75715e">; Example of deep</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">3</span>)                    <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">0</span>)                    <span style="color:#75715e">; &#39;pizza</span>

<span style="color:#75715e">; The deepR1 function remembers the numbers deep has seen so far</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>Ns1 <span style="color:#f92672">&#39;</span>())
(<span style="color:#66d9ef">define </span>deepR1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#66d9ef">set! </span>Ns1 (cons n Ns1))
    (<span style="color:#a6e22e">deep</span> n)))

<span style="color:#75715e">; Examples of deepR1</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepR1</span> <span style="color:#ae81ff">3</span>)                  <span style="color:#75715e">; &#39;(((pizza)))</span>
Ns1                         <span style="color:#75715e">; (3)</span>
(<span style="color:#a6e22e">deepR1</span> <span style="color:#ae81ff">0</span>)                  <span style="color:#75715e">; &#39;pizza</span>
Ns1                         <span style="color:#75715e">; (0 3)</span>

<span style="color:#75715e">; The deepR function remembers the numbers and the results</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>Ns <span style="color:#f92672">&#39;</span>())
(<span style="color:#66d9ef">define </span>Rs <span style="color:#f92672">&#39;</span>())
(<span style="color:#66d9ef">define </span>deepR
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> (<span style="color:#a6e22e">deep</span> n)))
      (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
      (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
      result)))

<span style="color:#75715e">; Examples of deepR</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepR</span> <span style="color:#ae81ff">3</span>)                   <span style="color:#75715e">; &#39;(((pizza)))</span>
Ns                          <span style="color:#75715e">; &#39;(3)</span>
Rs                          <span style="color:#75715e">; &#39;((((pizza))))</span>
(<span style="color:#a6e22e">deepR</span> <span style="color:#ae81ff">5</span>)                   <span style="color:#75715e">; &#39;(((((pizza)))))</span>
Ns                          <span style="color:#75715e">; &#39;(5 3)</span>
Rs                          <span style="color:#75715e">; &#39;((((((pizza))))) (((pizza))))</span>
(<span style="color:#a6e22e">deepR</span> <span style="color:#ae81ff">3</span>)                   <span style="color:#75715e">; &#39;(((pizza)))</span>
Ns                          <span style="color:#75715e">; &#39;(3 5 3)</span>
Rs                          <span style="color:#75715e">; &#39;((((pizza))) (((((pizza))))) (((pizza))))</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The nineteenth commandment                                                 ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; Use (set! ...) to remember valuable things between two distinct uses of a  ;</span>
<span style="color:#75715e">; function.                                                                  ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; The find function finds pizza in Rs</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>find
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> Ns Rs)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">A</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">ns</span> rs)
            (<span style="color:#a6e22e">cond</span>
              ((= (car ns) n) (car rs))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">A</span> (cdr ns) (cdr rs)))))))
      (<span style="color:#a6e22e">A</span> Ns Rs))))

<span style="color:#75715e">; Examples of find</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">find</span> <span style="color:#ae81ff">3</span> Ns Rs)              <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">find</span> <span style="color:#ae81ff">5</span> Ns Rs)              <span style="color:#75715e">; &#39;(((((pizza)))))</span>
<span style="color:#75715e">;(find 7 Ns Rs)             ; not applicable at this time</span>

<span style="color:#75715e">; The deepM function either uses find or computes pizza (temporary version)</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM-tmp
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">member?</span> n Ns)
      (<span style="color:#a6e22e">find</span> n Ns Rs)
      (<span style="color:#a6e22e">deepR</span> n))))

Ns                          <span style="color:#75715e">; &#39;(3 5 3)</span>
Rs                          <span style="color:#75715e">; &#39;((((pizza))) (((((pizza))))) (((pizza))))</span>

(<span style="color:#66d9ef">set! </span>Ns (cdr Ns))
(<span style="color:#66d9ef">set! </span>Rs (cdr Rs))

Ns                          <span style="color:#75715e">; &#39;(5 3)</span>
Rs                          <span style="color:#75715e">; &#39;((((((pizza))))) (((pizza))))</span>

<span style="color:#75715e">; The final deepM version</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">member?</span> n Ns)
      (<span style="color:#a6e22e">find</span> n Ns Rs)
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> (<span style="color:#a6e22e">deep</span> n)))
        (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
        (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
        result))))

<span style="color:#75715e">; Examples of deepM</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">3</span>)                   <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">6</span>)                   <span style="color:#75715e">; &#39;((((((pizza))))))</span>

<span style="color:#75715e">; Redefining deep</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deep
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m) <span style="color:#e6db74">&#39;pizza</span>)
      (<span style="color:#66d9ef">else </span>(cons (<span style="color:#a6e22e">deepM</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>())))))

(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">9</span>)                   <span style="color:#75715e">; &#39;(((((((((pizza)))))))))</span>

Ns                          <span style="color:#75715e">; &#39;(9 8 7 6 5 3)</span>

<span style="color:#75715e">; Redefining deepM to folow 16th commandment</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">Rs</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">Ns</span> <span style="color:#f92672">&#39;</span>()))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
      (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">member?</span> n Ns)
        (<span style="color:#a6e22e">find</span> n Ns Rs)
        (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> (<span style="color:#a6e22e">deep</span> n)))
          (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
          (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
          result)))))

<span style="color:#75715e">; Tests of the new deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">10</span>)                  <span style="color:#75715e">; &#39;((((((((((pizza))))))))))</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">16</span>)                  <span style="color:#75715e">; &#39;((((((((((((((((pizza))))))))))))))))</span>

<span style="color:#75715e">; Better answer for find on empty lists</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>find
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> Ns Rs)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">A</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">ns</span> rs)
            (<span style="color:#a6e22e">cond</span>
              ((null? ns) <span style="color:#66d9ef">#f</span>)
              ((= (car ns) n) (car rs))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">A</span> (cdr ns) (cdr rs)))))))
      (<span style="color:#a6e22e">A</span> Ns Rs))))

<span style="color:#75715e">; And a better deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">Rs</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">Ns</span> <span style="color:#f92672">&#39;</span>()))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">exists</span> (<span style="color:#a6e22e">find</span> n Ns Rs)))
        (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> exists)
          (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> (<span style="color:#a6e22e">deep</span> n)))
            (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
            (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
            result)
          exists)))))

<span style="color:#75715e">; Example of the new deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">10</span>)                  <span style="color:#75715e">; &#39;((((((((((pizza))))))))))</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">16</span>)                  <span style="color:#75715e">; &#39;((((((((((((((((pizza))))))))))))))))</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">0</span>)                   <span style="color:#75715e">; &#39;pizza</span>


<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;              Take a deep breath or a deep pizza, now.                      ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; Our good, old friend length</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>lengthz
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">lengthz</span> (cdr l)))))))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; length via set!</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>lengthz
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>) <span style="color:#ae81ff">0</span>))

(<span style="color:#66d9ef">set! </span>lengthz
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">lengthz</span> (cdr l)))))))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; length via set! again</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>lengthz
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">h</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>) <span style="color:#ae81ff">0</span>)))
    (<span style="color:#66d9ef">set! </span>h
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
        (<span style="color:#a6e22e">cond</span>
          ((null? l) <span style="color:#ae81ff">0</span>)
          (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">h</span> (cdr l)))))))
    h))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The seventeenth commandment (final version)                                ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; Use (set! x ...) for (let ((x ...)) ...) only if there is at least one     ;</span>
<span style="color:#75715e">; (lambda ... between it and the (let ...), or if the new value for x is a   ;</span>
<span style="color:#75715e">; function that refers to x                                                  ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; Another way to write length</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>h1              <span style="color:#75715e">; h1 is actually an anonymous name</span>
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>) <span style="color:#ae81ff">0</span>))

(<span style="color:#66d9ef">define </span>lengthz
  (<span style="color:#66d9ef">let </span>()
    (<span style="color:#66d9ef">set! </span>h1
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
        (<span style="color:#a6e22e">cond</span>
          ((null? l) <span style="color:#ae81ff">0</span>)
          (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">h1</span> (cdr l)))))))
    h1))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; Another way</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>h2              <span style="color:#75715e">; h2 is actually an anonymous name</span>
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">h2</span> (cdr l)))))))

(<span style="color:#66d9ef">define </span>lengthz
  (<span style="color:#66d9ef">let </span>() h2))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; length again</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>lengthz
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">h</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>) <span style="color:#ae81ff">0</span>)))
    (<span style="color:#66d9ef">set! </span>h
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
        (<span style="color:#a6e22e">cond</span>
          ((null? l) <span style="color:#ae81ff">0</span>)
          (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">h</span> (cdr l)))))))
    h))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; Let&#39;s eliminate parts that are specific to length</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>L
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lengthz</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#a6e22e">cond</span>
        ((null? l) <span style="color:#ae81ff">0</span>)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">lengthz</span> (cdr l))))))))

(<span style="color:#66d9ef">define </span>lengthz
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">h</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>) <span style="color:#ae81ff">0</span>)))
    (<span style="color:#66d9ef">set! </span>h
      (<span style="color:#a6e22e">L</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">arg</span>) (<span style="color:#a6e22e">h</span> arg))))
    h))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; Y-bang - the applicative-order imperative y-combinator</span>
<span style="color:#75715e">; (discovered by Peter Landin)</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>Y-bang
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">h</span> (<span style="color:#a6e22e">f</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">arg</span>) (<span style="color:#a6e22e">h</span> arg)))))
      h)))

(<span style="color:#66d9ef">define </span>lengthz (<span style="color:#a6e22e">Y-bang</span> L))

<span style="color:#75715e">; Test length</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>())        <span style="color:#75715e">; 0</span>
(<span style="color:#a6e22e">lengthz</span> <span style="color:#f92672">&#39;</span>(a b x))   <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; depth* via Y-bang</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>D
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">depth*</span>)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s</span>)
      (<span style="color:#a6e22e">cond</span>
        ((null? s) <span style="color:#ae81ff">1</span>)
        ((<span style="color:#a6e22e">atom?</span> (car s)) (<span style="color:#a6e22e">depth*</span> (cdr s)))
        (<span style="color:#a6e22e">else</span>
          (max (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">depth*</span> (car s))) (<span style="color:#a6e22e">depth*</span> (cdr s))))))))

(<span style="color:#66d9ef">define </span>depth* (<span style="color:#a6e22e">Y-bang</span> D))

<span style="color:#75715e">; Test depth*</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">depth*</span> <span style="color:#f92672">&#39;</span>())                <span style="color:#75715e">; 1</span>
(<span style="color:#a6e22e">depth*</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">pizza</span>)) ()))    <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; The bizarre function</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>biz
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">x</span> <span style="color:#ae81ff">0</span>))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
      (<span style="color:#66d9ef">set! </span>x (<span style="color:#a6e22e">add1</span> x))
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span>)
        (<span style="color:#66d9ef">if </span>(= a x)
          <span style="color:#ae81ff">0</span>
          (<span style="color:#a6e22e">f</span> a))))))

<span style="color:#75715e">; Another way to write bizarre</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>x1 <span style="color:#ae81ff">0</span>)               <span style="color:#75715e">; anonymous var</span>
(<span style="color:#66d9ef">define </span>biz
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
    (<span style="color:#66d9ef">set! </span>x1 (<span style="color:#a6e22e">add1</span> x1))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span>)
      (<span style="color:#66d9ef">if </span>(= a x1)
        <span style="color:#ae81ff">0</span>
        (<span style="color:#a6e22e">f</span> a)))))

<span style="color:#75715e">; The Y-Combinator</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>Y
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">le</span>)
    ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>) (<span style="color:#a6e22e">f</span> f))
     (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
       (<span style="color:#a6e22e">le</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) ((<span style="color:#a6e22e">f</span> f) x)))))))

((<span style="color:#a6e22e">Y</span> biz) <span style="color:#ae81ff">5</span>)

<span style="color:#75715e">; ((Y-bang biz) 5)          ; doesn&#39;t compute... why?</span>


<span style="color:#75715e">;</span>
<span style="color:#75715e">; Chapter 17 of The Seasoned Schemer:</span>
<span style="color:#75715e">; We Change, Therefore We Are!</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
<span style="color:#75715e">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
<span style="color:#75715e">;</span>

<span style="color:#75715e">; The atom? primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
   (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))  

<span style="color:#75715e">; The sub1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sub1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (- n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; The add1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>add1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (+ n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; The deep function wraps pizza in m parenthesis</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deep
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
    (<span style="color:#66d9ef">if </span>(zero? m)
      <span style="color:#e6db74">&#39;pizza</span>
      (cons (<span style="color:#a6e22e">deep</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>()))))

<span style="color:#75715e">; Examples of deep</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">3</span>)                <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">0</span>)                <span style="color:#75715e">; &#39;pizza</span>

<span style="color:#75715e">; The deepM function remembers calls to deep</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; The deepM function uses find function to find n in Ns and return </span>
<span style="color:#75715e">; the correct value from Rs</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>find
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span> Ns Rs)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">A</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">ns</span> rs)
            (<span style="color:#a6e22e">cond</span>
              ((null? ns) <span style="color:#66d9ef">#f</span>)
              ((= (car Ns) n) (car Rs))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">A</span> (cdr ns) (cdr rs)))))))
      (<span style="color:#a6e22e">A</span> Ns Rs))))

(<span style="color:#66d9ef">define </span>deepM
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">Rs</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">Ns</span> <span style="color:#f92672">&#39;</span>()))
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">D</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
            (<span style="color:#66d9ef">if </span>(zero? m)
              <span style="color:#e6db74">&#39;pizza</span>
              (cons (<span style="color:#a6e22e">deepM</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>())))))
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
        (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">exists</span> (<span style="color:#a6e22e">find</span> n Ns Rs)))
          (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> exists)
            (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> (<span style="color:#a6e22e">D</span> n)))
              (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
              (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
              result)
            exists))))))

<span style="color:#75715e">; Examples of deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">3</span>)               <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">0</span>)               <span style="color:#75715e">; &#39;pizza</span>

<span style="color:#75715e">; No need to use letrec in deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM-letrec
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">Rs</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">Ns</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">D</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
              (<span style="color:#66d9ef">if </span>(zero? m)
                <span style="color:#e6db74">&#39;pizza</span>
                (cons (<span style="color:#a6e22e">deepM-letrec</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>())))))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">exists</span> (<span style="color:#a6e22e">find</span> n Ns Rs)))
        (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> exists)
          (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> (<span style="color:#a6e22e">D</span> n)))
            (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
            (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
            result)
          exists)))))

<span style="color:#75715e">; Test of the new deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepM-letrec</span> <span style="color:#ae81ff">3</span>)               <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">deepM-letrec</span> <span style="color:#ae81ff">0</span>)               <span style="color:#75715e">; &#39;pizza</span>

<span style="color:#75715e">; No need for D in deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM-D
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">Rs</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">Ns</span> <span style="color:#f92672">&#39;</span>()))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">exists</span> (<span style="color:#a6e22e">find</span> n Ns Rs)))
        (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> exists)
          (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> ((<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
                           (<span style="color:#66d9ef">if </span>(zero? m)
                             <span style="color:#e6db74">&#39;pizza</span>
                             (cons (<span style="color:#a6e22e">deepM-D</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>()))) n)))
            (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
            (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
            result)
          exists)))))

<span style="color:#75715e">; Test of the new deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepM-D</span> <span style="color:#ae81ff">3</span>)               <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">deepM-D</span> <span style="color:#ae81ff">0</span>)               <span style="color:#75715e">; &#39;pizza</span>

<span style="color:#75715e">; No need for the 2nd lambda </span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM-2nd
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">Rs</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">Ns</span> <span style="color:#f92672">&#39;</span>()))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">exists</span> (<span style="color:#a6e22e">find</span> n Ns Rs)))
        (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> exists)
          (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span> (<span style="color:#66d9ef">if </span>(zero? n)
                            <span style="color:#e6db74">&#39;pizza</span>
                            (cons (<span style="color:#a6e22e">deepM-2nd</span> (<span style="color:#a6e22e">sub1</span> n)) <span style="color:#f92672">&#39;</span>()))))
            (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
            (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
            result)
          exists)))))

<span style="color:#75715e">; Test of the new deepM</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepM-2nd</span> <span style="color:#ae81ff">3</span>)               <span style="color:#75715e">; &#39;(((pizza)))</span>
(<span style="color:#a6e22e">deepM-2nd</span> <span style="color:#ae81ff">0</span>)               <span style="color:#75715e">; &#39;pizza</span>

<span style="color:#75715e">; The consC function counts number of conses needed to build</span>
<span style="color:#75715e">; n-deep pizza</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>consC
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">N</span> <span style="color:#ae81ff">0</span>))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span> y)
      (<span style="color:#66d9ef">set! </span>N (<span style="color:#a6e22e">add1</span> N))
      (cons x y))))

<span style="color:#75715e">; No way to get N out of this consC, so we need the counter</span>
<span style="color:#75715e">; function that will hold the count</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>counter <span style="color:#ae81ff">0</span>)

<span style="color:#75715e">; And a modification of consC</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>consC
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">N</span> <span style="color:#ae81ff">0</span>))
    (<span style="color:#66d9ef">set! </span>counter (<span style="color:#a6e22e">lambda</span>() N))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span> y)
      (<span style="color:#66d9ef">set! </span>N (<span style="color:#a6e22e">add1</span> N))
      (cons x y))))
        
<span style="color:#75715e">; And we need to modify deep</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deep
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
    (<span style="color:#66d9ef">if </span>(zero? m)
      <span style="color:#e6db74">&#39;pizza</span>
      (<span style="color:#a6e22e">consC</span> (<span style="color:#a6e22e">deep</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>()))))

(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">5</span>)            <span style="color:#75715e">; &#39;(((((pizza)))))</span>
(<span style="color:#a6e22e">counter</span>)           <span style="color:#75715e">; 5</span>

(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">7</span>)            <span style="color:#75715e">; &#39;(((pizza))</span>
(<span style="color:#a6e22e">counter</span>)           <span style="color:#75715e">; 12                ;;; (5 + 7) </span>

<span style="color:#75715e">; Let&#39;s determine how many cons&#39;es are necessary to find</span>
<span style="color:#75715e">; values of (deep 0) ... (deep 1000).</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>supercounter
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">f</span>)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">S</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
            (<span style="color:#66d9ef">if </span>(zero? n)
              (<span style="color:#a6e22e">f</span> n)
              (<span style="color:#66d9ef">let </span>()
                (<span style="color:#a6e22e">f</span> n)
                (<span style="color:#a6e22e">S</span> (<span style="color:#a6e22e">sub1</span> n)))))))
      (<span style="color:#a6e22e">S</span> <span style="color:#ae81ff">1000</span>)
      (<span style="color:#a6e22e">counter</span>))))

<span style="color:#75715e">; Try out supercounter</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">supercounter</span> deep)         <span style="color:#75715e">; 500512    ;;; not 500500 as expected</span>

<span style="color:#75715e">; Need to wipe out counter before using it again</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>set-counter <span style="color:#ae81ff">0</span>)

(<span style="color:#66d9ef">define </span>consC
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">N</span> <span style="color:#ae81ff">0</span>))
    (<span style="color:#66d9ef">set! </span>counter (<span style="color:#a6e22e">lambda</span>() N))
    (<span style="color:#66d9ef">set! </span>set-counter
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) (<span style="color:#66d9ef">set! </span>N x)))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span> y)
      (<span style="color:#66d9ef">set! </span>N (<span style="color:#a6e22e">add1</span> N))
      (cons x y))))

(<span style="color:#a6e22e">set-counter</span> <span style="color:#ae81ff">0</span>)

<span style="color:#75715e">; Try out supercounter again</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">supercounter</span> deep)

<span style="color:#75715e">; How many conses are used by (deepM 5)?</span>
<span style="color:#75715e">; Need to modify deepM to use consC first.</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deepM-consC
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">Rs</span> <span style="color:#f92672">&#39;</span>())
        (<span style="color:#a6e22e">Ns</span> <span style="color:#f92672">&#39;</span>()))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">exists</span> (<span style="color:#a6e22e">find</span> n Ns Rs)))
        (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> exists)
          (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">result</span>
                  (<span style="color:#66d9ef">if </span>(zero? n)
                    <span style="color:#e6db74">&#39;pizza</span>
                    (<span style="color:#a6e22e">consC</span> (<span style="color:#a6e22e">deepM-consC</span> (<span style="color:#a6e22e">sub1</span> n)) <span style="color:#f92672">&#39;</span>()))))
            (<span style="color:#66d9ef">set! </span>Rs (cons result Rs))
            (<span style="color:#66d9ef">set! </span>Ns (cons n Ns))
            result)
          exists)))))

<span style="color:#75715e">; How many conses are used by (deepM 5)?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepM</span> <span style="color:#ae81ff">5</span>)           <span style="color:#75715e">; &#39;(((((pizza)))))</span>
(<span style="color:#a6e22e">counter</span>)           <span style="color:#75715e">; 500505    ;;; because we forgot to reset counter</span>

(<span style="color:#a6e22e">set-counter</span> <span style="color:#ae81ff">0</span>)
(<span style="color:#a6e22e">deepM-consC</span> <span style="color:#ae81ff">5</span>)     <span style="color:#75715e">; &#39;(((((pizza)))))</span>
(<span style="color:#a6e22e">counter</span>)           <span style="color:#75715e">; 5</span>

(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">7</span>)            <span style="color:#75715e">;</span>
(<span style="color:#a6e22e">counter</span>)           <span style="color:#75715e">; ??? the book says it should be 0, I get 12, why?</span>

(<span style="color:#a6e22e">supercounter</span> deepM-consC)  <span style="color:#75715e">; ??? how did this work? it didn&#39;t take an argument?</span>

<span style="color:#75715e">; Book has also talks about conses in rember* function but I am not interested</span>
<span style="color:#75715e">; in it at the moment.</span>



<span style="color:#75715e">;</span>
<span style="color:#75715e">; Chapter 18 of The Seasoned Schemer:</span>
<span style="color:#75715e">; We Change, Therefore We Are the Same!</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
<span style="color:#75715e">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
<span style="color:#75715e">;</span>

<span style="color:#75715e">; The atom? primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
   (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))  

<span style="color:#75715e">; The sub1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sub1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (- n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; The add1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>add1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (+ n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; The lots function creates lots of eggs</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>lots
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (<span style="color:#a6e22e">cond</span>
      ((zero? n) <span style="color:#f92672">&#39;</span>())
      (<span style="color:#a6e22e">else</span>
        (cons <span style="color:#e6db74">&#39;egg</span> (<span style="color:#a6e22e">lots</span> (<span style="color:#a6e22e">sub1</span> n)))))))

<span style="color:#75715e">; The lenkth function counts the eggs</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>lenkth
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#ae81ff">0</span>)
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">lenkth</span> (cdr l)))))))

<span style="color:#75715e">; Examples of lots and lenkth</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">3</span>)                <span style="color:#75715e">; &#39;(egg egg egg)</span>
(<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">5</span>)                <span style="color:#75715e">; &#39;(egg egg egg egg egg)</span>
(<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">12</span>)               <span style="color:#75715e">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)</span>
(<span style="color:#a6e22e">lenkth</span> (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">3</span>))       <span style="color:#75715e">; 3</span>
(<span style="color:#a6e22e">lenkth</span> (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">5</span>))       <span style="color:#75715e">; 5</span>
(<span style="color:#a6e22e">lenkth</span> (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">15</span>))      <span style="color:#75715e">; 15</span>

<span style="color:#75715e">; Create 4 eggs from 3 eggs</span>
<span style="color:#75715e">;</span>
(cons <span style="color:#e6db74">&#39;egg</span> (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">3</span>))    <span style="color:#75715e">; &#39;(egg egg egg egg)</span>

<span style="color:#75715e">; consC, counter, set-counter from chapter 17</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>counter (<span style="color:#a6e22e">lambda</span>() <span style="color:#ae81ff">0</span>))
(<span style="color:#66d9ef">define </span>set-counter (<span style="color:#66d9ef">lambda </span>() <span style="color:#ae81ff">0</span>))
(<span style="color:#66d9ef">define </span>consC
  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">N</span> <span style="color:#ae81ff">0</span>))
    (<span style="color:#66d9ef">set! </span>counter (<span style="color:#a6e22e">lambda</span>() N))
    (<span style="color:#66d9ef">set! </span>set-counter
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) (<span style="color:#66d9ef">set! </span>N x)))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span> y)
      (<span style="color:#66d9ef">set! </span>N (<span style="color:#a6e22e">add1</span> N))
      (cons x y))))

<span style="color:#75715e">; Add an egg at the end</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>add-at-end
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? (cdr l))
       (<span style="color:#a6e22e">consC</span> (car l) (cons <span style="color:#e6db74">&#39;egg-end</span> <span style="color:#f92672">&#39;</span>())))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">consC</span> (car l) (<span style="color:#a6e22e">add-at-end</span> (cdr l)))))))

<span style="color:#75715e">; Example of add-at-end</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">add-at-end</span> (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">3</span>))   <span style="color:#75715e">; &#39;(egg egg egg egg-end)</span>

(<span style="color:#a6e22e">counter</span>)               <span style="color:#75715e">; 3</span>

<span style="color:#75715e">; Add an egg at the end without making any new conses except for the last one</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>add-at-end-too
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">letrec</span>
      ((<span style="color:#a6e22e">A</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">ls</span>)
            (<span style="color:#a6e22e">cond</span>
              ((null? (cdr ls))
               (set-cdr! ls (cons <span style="color:#e6db74">&#39;egg-end2</span> <span style="color:#f92672">&#39;</span>())))
              (<span style="color:#a6e22e">else</span>
                (<span style="color:#a6e22e">A</span> (cdr ls)))))))
      (<span style="color:#a6e22e">A</span> l)
      l)))

<span style="color:#75715e">; Example of add-at-end-too</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">set-counter</span> <span style="color:#ae81ff">0</span>)
(<span style="color:#a6e22e">add-at-end-too</span> (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">3</span>))   <span style="color:#75715e">; &#39;(egg egg egg egg-end2)</span>
(<span style="color:#a6e22e">counter</span>)                   <span style="color:#75715e">; 0</span>

<span style="color:#75715e">; kons the magnificent</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>kons
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">kar</span> kdr)
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">selector</span>)          <span style="color:#75715e">; returns lambda (selector)</span>
      (<span style="color:#a6e22e">selector</span> kar kdr))))     <span style="color:#75715e">; calls selector with kar and kdr arguments</span>

<span style="color:#75715e">; kar</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>kar
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">c</span>)                   <span style="color:#75715e">; applies selector on (a d) and returns &#39;a (car)</span>
    (<span style="color:#a6e22e">c</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> d) a))))

<span style="color:#75715e">; kdr</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>kdr
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">c</span>)                   <span style="color:#75715e">; applies selector on (a d) and returns d (cdr)</span>
    (<span style="color:#a6e22e">c</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> d) d))))

<span style="color:#75715e">; Examples of kons kar kdr</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">kar</span> (<span style="color:#a6e22e">kons</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>()))                 <span style="color:#75715e">; &#39;a</span>
(<span style="color:#a6e22e">kdr</span> (<span style="color:#a6e22e">kons</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>()))                 <span style="color:#75715e">; &#39;()</span>
(<span style="color:#a6e22e">kar</span> (<span style="color:#a6e22e">kdr</span> (<span style="color:#a6e22e">kons</span> <span style="color:#e6db74">&#39;a</span> (<span style="color:#a6e22e">kons</span> <span style="color:#e6db74">&#39;b</span> <span style="color:#f92672">&#39;</span>())))) <span style="color:#75715e">; &#39;b</span>
(<span style="color:#a6e22e">kar</span> (<span style="color:#a6e22e">kons</span> <span style="color:#e6db74">&#39;a</span> (<span style="color:#a6e22e">kons</span> <span style="color:#e6db74">&#39;b</span> <span style="color:#f92672">&#39;</span>())))       <span style="color:#75715e">; &#39;a</span>

<span style="color:#75715e">; Another cons</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>bons
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">kar</span>)
    (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">kdr</span> <span style="color:#f92672">&#39;</span>()))
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">selector</span>)
        (<span style="color:#a6e22e">selector</span>
          (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) (<span style="color:#66d9ef">set! </span>kdr x))
          kar
          kdr)))))

<span style="color:#75715e">; Another kar</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>bar
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">c</span>)
    (<span style="color:#a6e22e">c</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s</span> a d) a))))

<span style="color:#75715e">; Another kdr</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>bdr
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">c</span>)
    (<span style="color:#a6e22e">c</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s</span> a d) d))))

<span style="color:#75715e">; set-kdr</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>set-kdr
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">c</span> x)
    ((<span style="color:#a6e22e">c</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">s</span> a d) s)) x)))

<span style="color:#75715e">; create kons using set-kdr and bons</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>kons2
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> d)
    (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">c</span> (<span style="color:#a6e22e">bons</span> a)))
      (<span style="color:#a6e22e">set-kdr</span> c d)
      c)))

<span style="color:#75715e">; Example of kons2 bar and bdr</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">bar</span> (<span style="color:#a6e22e">kons2</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>)))       <span style="color:#75715e">; &#39;a</span>
(<span style="color:#a6e22e">bdr</span> (<span style="color:#a6e22e">kons2</span> <span style="color:#e6db74">&#39;a</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>)))       <span style="color:#75715e">; &#39;(1 2 3)</span>

<span style="color:#75715e">; Now eggs again</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>dozen (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">12</span>))

dozen           <span style="color:#75715e">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)</span>
                <span style="color:#75715e">; used 12 conses</span>

(<span style="color:#66d9ef">define </span>bakers-dozen (<span style="color:#a6e22e">add-at-end</span> dozen))

bakers-dozen    <span style="color:#75715e">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end)</span>
                <span style="color:#75715e">; used 13 conses (25 total now)</span>

(<span style="color:#66d9ef">define </span>bakers-dozen-too (<span style="color:#a6e22e">add-at-end-too</span> dozen))

bakers-dozen-too    <span style="color:#75715e">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end egg-end2)</span>
                    <span style="color:#75715e">; used 1 cons (26 total)</span>

(<span style="color:#66d9ef">define </span>bakers-dozen-again (<span style="color:#a6e22e">add-at-end</span> dozen))

bakers-dozen-again  <span style="color:#75715e">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end egg-end2 egg-end)</span>
                    <span style="color:#75715e">; used 14 conses (40 total)</span>

(<span style="color:#66d9ef">define </span>same?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">c1</span> c2)
    (<span style="color:#a6e22e">cond</span>
      ((<span style="color:#66d9ef">and </span>(null? c1) (null? c2)) <span style="color:#66d9ef">#t</span>)
      ((<span style="color:#66d9ef">or </span>(null? c1) (null? c2)) <span style="color:#66d9ef">#f</span>)
      (<span style="color:#a6e22e">else</span>
       (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">t1</span> (cdr c1))
             (<span style="color:#a6e22e">t2</span> (cdr c2)))
         (set-cdr! c1 <span style="color:#ae81ff">1</span>)
         (set-cdr! c2 <span style="color:#ae81ff">2</span>)
         (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">v</span> (= (cdr c1) (cdr c2))))
           (set-cdr! c1 t1)
           (set-cdr! c2 t2)
           v))))))

(<span style="color:#a6e22e">same?</span> dozen dozen)                     <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">same?</span> dozen bakers-dozen)              <span style="color:#75715e">; #f</span>
(<span style="color:#a6e22e">same?</span> dozen bakers-dozen-too)          <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">same?</span> dozen bakers-dozen-again)        <span style="color:#75715e">; #f</span>
(<span style="color:#a6e22e">same?</span> bakers-dozen bakers-dozen-too)   <span style="color:#75715e">; #f   ;;; the book says #t???</span>

<span style="color:#75715e">; The last-kons function returns the last cons in a non-empty kons-list</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>last-kons
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">ls</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? (cdr ls)) ls)
      (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">last-kons</span> (cdr ls))))))

(<span style="color:#66d9ef">define </span>long (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">12</span>))                 <span style="color:#75715e">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)</span>

(set-cdr! (<span style="color:#a6e22e">last-kons</span> long) long)        <span style="color:#75715e">; #0 = &#39;(egg egg egg egg egg egg egg egg egg egg egg . #0#) </span>

<span style="color:#75715e">; The finite-lenkth function returns length of a list</span>
<span style="color:#75715e">; or #f if it&#39;s an infinite list</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>finite-lenkth
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">infinite</span>)
        (<span style="color:#a6e22e">letrec</span>
          ((<span style="color:#a6e22e">C</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span> q)
                (<span style="color:#a6e22e">cond</span>
                  ((<span style="color:#a6e22e">same?</span> p q) (<span style="color:#a6e22e">infinite</span> <span style="color:#66d9ef">#f</span>))
                  ((null? q) <span style="color:#ae81ff">0</span>)
                  ((null? (cdr q)) <span style="color:#ae81ff">1</span>)
                  (<span style="color:#a6e22e">else</span>
                    (+ (<span style="color:#a6e22e">C</span> (<span style="color:#a6e22e">sl</span> p) (<span style="color:#a6e22e">qk</span> q)) <span style="color:#ae81ff">2</span>)))))
           (<span style="color:#a6e22e">qk</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) (cdr (cdr x))))
           (<span style="color:#a6e22e">sl</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) (cdr x))))
          (<span style="color:#a6e22e">cond</span>
            ((null? p) <span style="color:#ae81ff">0</span>)
            (<span style="color:#a6e22e">else</span>
              (<span style="color:#a6e22e">add1</span> (<span style="color:#a6e22e">C</span> p (cdr p))))))))))

<span style="color:#75715e">; Examples of finite-lenkth</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>not-so-long (<span style="color:#a6e22e">lots</span> <span style="color:#ae81ff">5</span>))         <span style="color:#75715e">; &#39;(egg egg egg egg egg)</span>
(<span style="color:#a6e22e">finite-lenkth</span> not-so-long)           <span style="color:#75715e">; 5</span>
(<span style="color:#a6e22e">finite-lenkth</span> long)                  <span style="color:#75715e">; #f</span>

<span style="color:#75715e">; Guy&#39;s Favorite Pie</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>mongo
  (cons <span style="color:#e6db74">&#39;pie</span>
   (cons <span style="color:#e6db74">&#39;a</span>
    (cons <span style="color:#e6db74">&#39;la</span>
     (cons <span style="color:#e6db74">&#39;mode</span> <span style="color:#f92672">&#39;</span>())))))
(set-cdr! (cdr (cdr (cdr mongo))) (cdr mongo))

<span style="color:#75715e">; mongo</span>

<span style="color:#75715e">;</span>
<span style="color:#75715e">; Chapter 19 of The Seasoned Schemer:</span>
<span style="color:#75715e">; Absconding with the Jewels</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
<span style="color:#75715e">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
<span style="color:#75715e">;</span>
<span style="color:#75715e">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
<span style="color:#75715e">;</span>

<span style="color:#75715e">; The atom? primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>atom?
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
   (<span style="color:#66d9ef">and </span>(not (pair? x)) (not (null? x)))))  

<span style="color:#75715e">; The sub1 primitive</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>sub1
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">n</span>)
    (- n <span style="color:#ae81ff">1</span>)))

<span style="color:#75715e">; Our friend deep</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deep
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m) <span style="color:#e6db74">&#39;pizza</span>)
      (<span style="color:#66d9ef">else </span>(cons (<span style="color:#a6e22e">deep</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>())))))

<span style="color:#75715e">; Example of deep</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deep</span> <span style="color:#ae81ff">6</span>)                    <span style="color:#75715e">; &#39;((((((pizza))))))</span>

<span style="color:#75715e">; Six layers creates six layered pizza</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>six-layers
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (cons (cons (<span style="color:#a6e22e">cons</span>
    (cons (cons (cons p <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>())))

<span style="color:#75715e">; Example of six-layers</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">six-layers</span> <span style="color:#e6db74">&#39;pizza</span>)         <span style="color:#75715e">; &#39;((((((pizza))))))</span>

<span style="color:#75715e">; Four layers makes a four layered pizza</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>four-layers
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">p</span>)
    (cons (cons (<span style="color:#a6e22e">cons</span>
    (cons p <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>()) <span style="color:#f92672">&#39;</span>())))

<span style="color:#75715e">; Example of four-layers</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">four-layers</span> <span style="color:#e6db74">&#39;pizza</span>)        <span style="color:#75715e">; &#39;((((pizza))))</span>

<span style="color:#75715e">; The deepB function does layering</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>toppings <span style="color:#ae81ff">0</span>)
(<span style="color:#66d9ef">define </span>deepB
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span>)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m)
       (<span style="color:#a6e22e">call-with-current-continuation</span>
         (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">jump</span>)
           (<span style="color:#66d9ef">set! </span>toppings jump)
           <span style="color:#e6db74">&#39;pizza</span>)))
      (<span style="color:#a6e22e">else</span>
        (cons (<span style="color:#a6e22e">deepB</span> (<span style="color:#a6e22e">sub1</span> m)) <span style="color:#f92672">&#39;</span>())))))

<span style="color:#75715e">; Example of deepB</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deepB</span> <span style="color:#ae81ff">6</span>)                   <span style="color:#75715e">; &#39;((((((pizza)))))), but what does jump do?</span>

<span style="color:#75715e">; Six layers again</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">six-layers</span> <span style="color:#e6db74">&#39;mozzarella</span>)    <span style="color:#75715e">; &#39;((((((mozarella))))))</span>

<span style="color:#75715e">; Now the toppings</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">toppings</span> <span style="color:#e6db74">&#39;mozzarella</span>)      <span style="color:#75715e">; &#39;((((((mozarella))))))</span>
(<span style="color:#a6e22e">toppings</span> <span style="color:#e6db74">&#39;cake</span>)            <span style="color:#75715e">; &#39;((((((cake))))))</span>
(<span style="color:#a6e22e">toppings</span> <span style="color:#e6db74">&#39;pizza</span>)           <span style="color:#75715e">; &#39;((((((pizza))))))</span>

<span style="color:#75715e">; What about his</span>
<span style="color:#75715e">;</span>
(cons (<span style="color:#a6e22e">toppings</span> <span style="color:#e6db74">&#39;cake</span>) <span style="color:#f92672">&#39;</span>()) <span style="color:#75715e">; it&#39;s still &#39;((((((cake)))))) and not &#39;(((((((cake)))))))</span>

<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; The twentieth commandment                                                  ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">; When thinking about a value created with (letcc ...), write down the       ;</span>
<span style="color:#75715e">; function that is equivalent but does not forget. Then, when you use it,    ;</span>
<span style="color:#75715e">; remember to forget.                                                        ;</span>
<span style="color:#75715e">;                                                                            ;</span>
<span style="color:#75715e">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color:#75715e">; Deep&amp;co</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deep&amp;co
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span> k)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m) (<span style="color:#a6e22e">k</span> <span style="color:#e6db74">&#39;pizza</span>))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">deep&amp;co</span> (<span style="color:#a6e22e">sub1</span> m)
         (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) (<span style="color:#a6e22e">k</span> (cons x <span style="color:#f92672">&#39;</span>()))))))))

<span style="color:#75715e">; Examples of deep&amp;co</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deep&amp;co</span> <span style="color:#ae81ff">0</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) x))          <span style="color:#75715e">; &#39;pizza</span>
(<span style="color:#a6e22e">deep&amp;co</span> <span style="color:#ae81ff">6</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) x))          <span style="color:#75715e">; &#39;((((((pizza))))))</span>
(<span style="color:#a6e22e">deep&amp;co</span> <span style="color:#ae81ff">2</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) x))          <span style="color:#75715e">; &#39;((pizza))</span>

<span style="color:#75715e">; Deep&amp;coB</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>deep&amp;coB
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">m</span> k)
    (<span style="color:#a6e22e">cond</span>
      ((zero? m)
       (<span style="color:#66d9ef">let </span>()
         (<span style="color:#66d9ef">set! </span>toppings k)
         (<span style="color:#a6e22e">k</span> <span style="color:#e6db74">&#39;pizza</span>)))
    (<span style="color:#a6e22e">else</span>
      (<span style="color:#a6e22e">deep&amp;coB</span> (<span style="color:#a6e22e">sub1</span> m)
        (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
          (<span style="color:#a6e22e">k</span> (cons x <span style="color:#f92672">&#39;</span>()))))))))

<span style="color:#75715e">; Examples of deep&amp;coB</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">deep&amp;coB</span> <span style="color:#ae81ff">6</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) x))         <span style="color:#75715e">; &#39;((((((pizza))))))</span>
(<span style="color:#a6e22e">deep&amp;coB</span> <span style="color:#ae81ff">4</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) x))         <span style="color:#75715e">; &#39;((((pizza))))</span>

<span style="color:#75715e">; toppings is now four-layers</span>

(<span style="color:#a6e22e">toppings</span> <span style="color:#e6db74">&#39;cake</span>)                    <span style="color:#75715e">; &#39;((((cake))))</span>
(<span style="color:#a6e22e">cons</span>
  (<span style="color:#a6e22e">toppings</span> <span style="color:#e6db74">&#39;cake</span>)
  (<span style="color:#a6e22e">toppings</span> <span style="color:#e6db74">&#39;cake</span>))                 <span style="color:#75715e">; &#39;(((((cake)))) (((cake))))</span>

<span style="color:#75715e">; Remember two-in-a-row?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row?
  (<span style="color:#a6e22e">letrec</span>
    ((<span style="color:#a6e22e">W</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span> lat)
          (<span style="color:#a6e22e">cond</span>
            ((null? lat) <span style="color:#66d9ef">#f</span>)
            (<span style="color:#a6e22e">else</span>
              (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">nxt</span> (car lat)))
                (<span style="color:#a6e22e">or</span>
                  (eq? nxt a)
                  (<span style="color:#a6e22e">W</span> nxt (cdr lat)))))))))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">lat</span>)
      (<span style="color:#a6e22e">cond</span>
        ((null? lat) <span style="color:#66d9ef">#f</span>)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">W</span> (car lat) (cdr lat)))))))

<span style="color:#75715e">; Examples of two-in-a-row?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(mozzarella cake mozzarella))      <span style="color:#75715e">; #f</span>
(<span style="color:#a6e22e">two-in-a-row?</span> <span style="color:#f92672">&#39;</span>(mozzarella mozzarella cake))      <span style="color:#75715e">; #t</span>

<span style="color:#75715e">; walk</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>leave <span style="color:#e6db74">&#39;0</span>)
(<span style="color:#66d9ef">define </span>walk
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#a6e22e">leave</span> (car l)))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">begin</span>
          (<span style="color:#a6e22e">walk</span> (car l))
          (<span style="color:#a6e22e">walk</span> (cdr l)))))))

<span style="color:#75715e">; we need leave</span>
(<span style="color:#66d9ef">define </span>start-it
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">here</span>)
        (<span style="color:#66d9ef">set! </span>leave here)
        (<span style="color:#a6e22e">walk</span> l)))))

<span style="color:#75715e">; Example of start-it</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">start-it</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">potato</span>) (<span style="color:#a6e22e">chips</span> (<span style="color:#a6e22e">chips</span> (<span style="color:#a6e22e">with</span>))) fish))  <span style="color:#75715e">; &#39;potato</span>

<span style="color:#75715e">; waddle, just like walk but remembers where it left</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>fill <span style="color:#ae81ff">0</span>)
(<span style="color:#66d9ef">define </span>waddle
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">cond</span>
      ((null? l) <span style="color:#f92672">&#39;</span>())
      ((<span style="color:#a6e22e">atom?</span> (car l))
       (<span style="color:#a6e22e">begin</span>
         (<span style="color:#a6e22e">call-with-current-continuation</span>
           (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">rest</span>)
             (<span style="color:#66d9ef">set! </span>fill rest)
             (<span style="color:#a6e22e">leave</span> (car l))))
         (<span style="color:#a6e22e">waddle</span> (cdr l))))
      (<span style="color:#a6e22e">else</span>
        (<span style="color:#a6e22e">begin</span>
          (<span style="color:#a6e22e">waddle</span> (car l))
          (<span style="color:#a6e22e">waddle</span> (cdr l)))))))

<span style="color:#75715e">; A new start</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>start-it2
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">here</span>)
        (<span style="color:#66d9ef">set! </span>leave here)
        (<span style="color:#a6e22e">waddle</span> l)))))

<span style="color:#75715e">; Example of start-it2</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">start-it2</span> <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">donuts</span>) (<span style="color:#a6e22e">cheerios</span> (<span style="color:#a6e22e">cheerios</span> (<span style="color:#a6e22e">spaghettios</span>))) donuts))
<span style="color:#75715e">; ===&gt; &#39;donuts</span>

<span style="color:#75715e">; get-next gets the next atom</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>get-next
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">here-again</span>)
        (<span style="color:#66d9ef">set! </span>leave here-again)
        (<span style="color:#a6e22e">fill</span> <span style="color:#e6db74">&#39;go</span>)))))

<span style="color:#75715e">; Examples of get-next</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">get-next</span> <span style="color:#e6db74">&#39;go</span>)      <span style="color:#75715e">; &#39;cheerios</span>
(<span style="color:#a6e22e">get-next</span> <span style="color:#e6db74">&#39;go</span>)      <span style="color:#75715e">; &#39;cheerios</span>
(<span style="color:#a6e22e">get-next</span> <span style="color:#e6db74">&#39;go</span>)      <span style="color:#75715e">; &#39;paghettios</span>
(<span style="color:#a6e22e">get-next</span> <span style="color:#e6db74">&#39;go</span>)      <span style="color:#75715e">; &#39;donuts</span>
(<span style="color:#a6e22e">get-next</span> <span style="color:#e6db74">&#39;go</span>)      <span style="color:#75715e">; &#39;()</span>

<span style="color:#75715e">; get-first</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>get-first
  (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
    (<span style="color:#a6e22e">call-with-current-continuation</span>
      (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">here</span>)
        (<span style="color:#66d9ef">set! </span>leave here)
        (<span style="color:#a6e22e">waddle</span> l)
        (<span style="color:#a6e22e">leave</span> <span style="color:#f92672">&#39;</span>())))))

<span style="color:#75715e">; Examples of get-first and get-next</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">get-first</span> <span style="color:#f92672">&#39;</span>(fish (<span style="color:#a6e22e">chips</span>)))     <span style="color:#75715e">; &#39;fish</span>
(<span style="color:#a6e22e">get-next</span> <span style="color:#e6db74">&#39;go</span>)                  <span style="color:#75715e">; &#39;chips</span>
(<span style="color:#a6e22e">get-next</span> <span style="color:#e6db74">&#39;go</span>)                  <span style="color:#75715e">; &#39;()</span>

<span style="color:#75715e">; And now the two-in-a-row*?</span>
<span style="color:#75715e">;</span>
(<span style="color:#66d9ef">define </span>two-in-a-row*?
  (<span style="color:#a6e22e">letrec</span>
    ((<span style="color:#a6e22e">T?</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">a</span>)
           (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">n</span> (<span style="color:#a6e22e">get-next</span> <span style="color:#ae81ff">0</span>)))
             (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> n)
               (<span style="color:#66d9ef">or </span>(eq? n a) (<span style="color:#a6e22e">T?</span> n))
               <span style="color:#66d9ef">#f</span>))))
     (<span style="color:#a6e22e">get-next</span>
       (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>)
         (<span style="color:#a6e22e">call-with-current-continuation</span>
           (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">here-again</span>)
             (<span style="color:#66d9ef">set! </span>leave here-again)
             (<span style="color:#a6e22e">fill</span> <span style="color:#e6db74">&#39;go</span>)))))
     (<span style="color:#a6e22e">fill</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) x))
     (<span style="color:#a6e22e">waddle</span>
       (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
         (<span style="color:#a6e22e">cond</span>
           ((null? l) <span style="color:#f92672">&#39;</span>())
           ((<span style="color:#a6e22e">atom?</span> (car l))
            (<span style="color:#66d9ef">begin </span>             <span style="color:#75715e">; or (let() ...</span>
              (<span style="color:#a6e22e">call-with-current-continuation</span>
                (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">rest</span>)
                  (<span style="color:#66d9ef">set! </span>fill rest)
                  (<span style="color:#a6e22e">leave</span> (car l))))
              (<span style="color:#a6e22e">waddle</span> (cdr l))))
           (<span style="color:#a6e22e">else</span>
             (<span style="color:#a6e22e">begin</span>
               (<span style="color:#a6e22e">waddle</span> (car l))
               (<span style="color:#a6e22e">waddle</span> (cdr l)))))))
     (<span style="color:#a6e22e">leave</span> (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">x</span>) x)))
    (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">l</span>)
      (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">fst</span> (<span style="color:#a6e22e">call-with-current-continuation</span>
                   (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">here</span>)
                     (<span style="color:#66d9ef">set! </span>leave here)
                     (<span style="color:#a6e22e">waddle</span> l)
                     (<span style="color:#a6e22e">leave</span> <span style="color:#f92672">&#39;</span>())))))
        (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">atom?</span> fst) (<span style="color:#a6e22e">T?</span> fst) <span style="color:#66d9ef">#f</span>)))))

<span style="color:#75715e">; Examples of two-in-a-row*?</span>
<span style="color:#75715e">;</span>
(<span style="color:#a6e22e">two-in-a-row*?</span> <span style="color:#f92672">&#39;</span>(((<span style="color:#a6e22e">food</span>) ()) (((<span style="color:#a6e22e">food</span>)))))      <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">two-in-a-row*?</span> <span style="color:#f92672">&#39;</span>(a (<span style="color:#a6e22e">b</span> (<span style="color:#a6e22e">c</span> (<span style="color:#a6e22e">d</span>))) () () (<span style="color:#a6e22e">d</span>)))     <span style="color:#75715e">; #t</span>
(<span style="color:#a6e22e">two-in-a-row*?</span> <span style="color:#f92672">&#39;</span>())                            <span style="color:#75715e">; #f</span>
(<span style="color:#a6e22e">two-in-a-row*?</span> <span style="color:#f92672">&#39;</span>(((((<span style="color:#a6e22e">a</span>))))))                   <span style="color:#75715e">; #f</span>


</code></pre></div>
    </div>
 <div class="nav-links" style="padding:10;">
        
        <div align="left">
        <a href="https://jueqingsizhe66.github.io/blog/2015/05/17/jia-fa-zhi-hou-ye-xu-jian-fa/"><span class="arrow">←</span> <strong>上一篇:加法之后也需减法</strong></a>
        </div>
        
        


       <div align="right"> <a href="https://jueqingsizhe66.github.io/blog/2015/05/18/vim-haskell/" ><strong>下一篇:vim-haskell </strong><span class="arrow">→</span></a></div>
        
      </div>
    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/scheme/">scheme</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/&amp;text=The-Little-Scheme-And-Part-Of-TSS" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/&amp;t=The-Little-Scheme-And-Part-Of-TSS" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=The-Little-Scheme-And-Part-Of-TSS&amp;body=https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/&amp;title=The-Little-Scheme-And-Part-Of-TSS" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=The-Little-Scheme-And-Part-Of-TSS%20https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/&amp;title=The-Little-Scheme-And-Part-Of-TSS" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu52a603635ecebd45650b162dadabb4e5_12861_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jueqingsizhe66.github.io/">Ye Zhaoliang</a></h5>
      <h6 class="card-subtitle">Engineer of offshore wind turbine technique research</h6>
      <p class="card-text">My research interests include distributed energy, wind turbine power generation technique , Computational fluid dynamic and programmable matter.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=7VyEMyQAAAAJ&amp;hl=zh-CN" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/blog/2015/05/17/cong-lambdadao-simple-plus-complexjie-shi-qi-zai-dao-shu-xing-chou-xiang/">从lambda到simple&#43;complex解释器再到树形抽象</a></li>
      
      <li><a href="/blog/2015/05/14/yu-yan-chou-xiang/">语言抽象</a></li>
      
      <li><a href="/blog/2015/05/13/wei-di-gui/">尾递归</a></li>
      
      <li><a href="/blog/2015/05/13/qiu-ding-ji-fen/">求定积分</a></li>
      
      <li><a href="/blog/2015/05/12/zhao-chu-han-shu-de-bu-dong-dian-navier-stokesfang-cheng/">找出函数的不动点--Navier-Stokes方程</a></li>
      
    </ul>


         <span id="busuanzi_container_site_pv"> 
             本站访问量：<span id="busuanzi_value_site_pv"></span>次 
         </span> 
         &nbsp; 
   </div> 


  </div>

</article>
<script src="https://utteranc.es/client.js"
        repo="jueqingsizhe66/jueqingsizhe66.github.io"
        issue-term="pathname"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/go.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/vim.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/matlab.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/sql.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/c.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/scheme.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/racket.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/perl.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/awk.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/clojure.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.d6bd04fdad2ad213aa8111c5a3b72fc5.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    ©2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
