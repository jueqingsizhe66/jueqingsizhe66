<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ye Zhaoliang">

  
  
  
    
  
  <meta name="description" content="最近，有做一个图像处理的项目，总结出一些有用的maltlab小工具。

Numsubplot
windRose
多项式拟合
箭头
误差带
matlab编程配置
cell and array
">

  
  <link rel="alternate" hreflang="en-us" href="https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.e8d4d5fd376e67b34452ebe1cae16341.css">

  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jueqingsizhe66">
  <meta property="twitter:creator" content="@jueqingsizhe66">
  
  <meta property="og:site_name" content="简约派">
  <meta property="og:url" content="https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/">
  <meta property="og:title" content="matlab小结 | 简约派">
  <meta property="og:description" content="最近，有做一个图像处理的项目，总结出一些有用的maltlab小工具。

Numsubplot
windRose
多项式拟合
箭头
误差带
matlab编程配置
cell and array
"><meta property="og:image" content="https://jueqingsizhe66.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://jueqingsizhe66.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2016-07-19T18:41:57&#43;08:00">
    
    <meta property="article:modified_time" content="2016-07-19T18:41:57&#43;08:00">
  

  



  


  


  





  <title>matlab小结 | 简约派</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">简约派</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>概要</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>博文</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>项目</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>课程</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/categories/"><span>分类</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/archives"><span>归档</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>标签</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  








  
 <script async src="//cdn.busuanzi.ibruce.info/cdn/busuanzi/2.3/busuanzi.pure.mini.js"></script> 
 <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> 
 <script> 
     $(document).ready(function() { 
         var int = setInterval(fixCount, 100); 
         var busuanziSiteOffset =  100000  
         function fixCount() { 
             if ($("#busuanzi_container_site_pv").css("display") != "none") { 
                 clearInterval(int); 
                 $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + busuanziSiteOffset); 
             } 
         } 
     }); 
 </script> 
  






  

  
  
  
<div class="article-container pt-3">
  <h1>matlab小结</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jul 19, 2016
  </span>

  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/programme/">programme</a></span>

  
</div>

    














  
</div>





<span class="article-metadata" >Reading time: 40 minutes and    5 seconds with 8820 words. 本文总阅读量<span id="busuanzi_value_page_pv"></span>次 </span>
    <aside>
        <nav id="TableOfContents"></nav>
    </aside>
  <div class="article-container">


    <div class="article-style">
      <p>最近，有做一个图像处理的项目，总结出一些有用的maltlab小工具。</p>
<ol>
<li><a href="#1">Numsubplot</a></li>
<li><a href="#2">windRose</a></li>
<li><a href="#3">多项式拟合</a></li>
<li><a href="#4">箭头</a></li>
<li><a href="#5">误差带</a></li>
<li><a href="#6">matlab编程配置</a></li>
<li><a href="#7">cell and array</a></li>
</ol>
<!-- raw HTML omitted -->
<p>在进行分析的时候，有时候可能需要多图打印，numsubplot还是挺方便的。使用可以看注释部分</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-matlab" data-lang="matlab"><span style="color:#66d9ef">    function</span> [p,n]=<span style="color:#a6e22e">numSubplots</span>(n)
<span style="color:#75715e">% function [p,n]=numSubplots(n)</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">% Purpose</span>
    <span style="color:#75715e">% Calculate how many rows and columns of sub-plots are needed to</span>
    <span style="color:#75715e">% neatly display n subplots. </span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">% Inputs</span>
    <span style="color:#75715e">% n - the desired number of subplots.     </span>
    <span style="color:#75715e">%  </span>
    <span style="color:#75715e">% Outputs</span>
    <span style="color:#75715e">% p - a vector length 2 defining the number of rows and number of</span>
    <span style="color:#75715e">%     columns required to show n plots.     </span>
    <span style="color:#75715e">% [ n - the current number of subplots. This output is used only by</span>
    <span style="color:#75715e">%       this function for a recursive call.]</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">% Example: neatly lay out 13 sub-plots</span>
<span style="color:#75715e">% &gt;&gt; p=numSubplots(13)</span>
    <span style="color:#75715e">% p = </span>
    <span style="color:#75715e">%     3   5</span>
    <span style="color:#75715e">% for i=1:13; subplot(p(1),p(2),i), pcolor(rand(10)), end </span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">% Rob Campbell - January 2010</span>


    <span style="color:#66d9ef">while</span> isprime(n) <span style="color:#f92672">&amp;</span> n<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">4</span>, 
    n=n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
<span style="color:#66d9ef">end</span>

p=factor(n);

<span style="color:#66d9ef">if</span> length(p)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
p=[<span style="color:#ae81ff">1</span>,p];
<span style="color:#66d9ef">return</span>
<span style="color:#66d9ef">end</span>


<span style="color:#66d9ef">while</span> length(p)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span>
<span style="color:#66d9ef">if</span> length(p)<span style="color:#f92672">&gt;</span>=<span style="color:#ae81ff">4</span>
p(<span style="color:#ae81ff">1</span>)=p(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>p(<span style="color:#66d9ef">end</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
p(<span style="color:#ae81ff">2</span>)=p(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>p(<span style="color:#66d9ef">end</span>);
p(<span style="color:#66d9ef">end</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:<span style="color:#66d9ef">end</span>)=[];
<span style="color:#66d9ef">else</span>
p(<span style="color:#ae81ff">1</span>)=p(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>p(<span style="color:#ae81ff">2</span>);
p(<span style="color:#ae81ff">2</span>)=[];
<span style="color:#66d9ef">end</span>    
p=sort(p);
<span style="color:#66d9ef">end</span>


<span style="color:#75715e">%Reformat if the column/row ratio is too large: we want a roughly</span>
<span style="color:#75715e">%square design </span>
<span style="color:#66d9ef">while</span> p(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>p(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2.5</span>
N=n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
[p,n]=numSubplots(N); <span style="color:#75715e">%Recursive!</span>
<span style="color:#66d9ef">end</span>

</code></pre></div><!-- raw HTML omitted -->
<p>a. 可以用于绘制风玫瑰图，也就是风向变量和风速变量
b. 也可以用于绘制单一变量的玫瑰图，比如角度玫瑰图</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-matlab" data-lang="matlab"><span style="color:#66d9ef">function</span> [figure_handle,colorSeq,barX,barY,count,speeds,directions,Table] = <span style="color:#a6e22e">WindRose</span>(direction,speed,varargin)
    <span style="color:#75715e">%  WindRose  Draw a Wind Rose knowing direction and speed</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%  [figure_handle,count,speeds,directions,Table] = WindRose(direction,speed);</span>
    <span style="color:#75715e">%  [figure_handle,count,speeds,directions,Table] = WindRose(direction,speed,&#39;parameter1&#39;,value1,...);</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%  figure_handle is the handle of the figure containing the chart</span>
    <span style="color:#75715e">%  count is the frequency for each speed (ncolumns = nspeeds) and for each direction (nrows = ndirections).</span>
    <span style="color:#75715e">%  speeds is a 1 by n vector containing the values for the speed intervals</span>
    <span style="color:#75715e">%  directions is a m by 1 vector containing the values in which direction intervals are centered</span>
    <span style="color:#75715e">%  Table is a (4+m) by (3+m) cell array (excel-ready), containing Frequencies for each direction and for each speed. </span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%  User can specify direction angle meaning North and East winds, so</span>
    <span style="color:#75715e">%  the graphs is shown in the desired reference</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     Example</span>
    <span style="color:#75715e">%     d = 360 * rand(10000,1); % My reference is North = 0? East = 90?</span>
    <span style="color:#75715e">%     v = 30*rand(10000,1);</span>
    <span style="color:#75715e">% </span>
    <span style="color:#75715e">%     [figure_handle,count,speeds,directions,Table] = WindRose(d,v,&#39;anglenorth&#39;,0,&#39;angleeast&#39;,90,&#39;freqlabelangle&#39;,45);</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">% PARAMETER          CLASS         DEFAULT VALUE         DESCRIPTION</span>
    <span style="color:#75715e">%------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
    <span style="color:#75715e">% &#39;centeredin0&#39;      Logical.      true                  Is first angular bin centered in 0 (-5 to 5)? -&gt; CeteredIn0 = true // or does it start in 0 (0 to 10)? -&gt; CeteredIn0 = false.</span>
    <span style="color:#75715e">% &#39;ndirections&#39;      Numeric.      36                    Number of direction bins (subdivisions) to be shown.</span>
    <span style="color:#75715e">% &#39;freqround&#39;        Numeric.      1                     Maximum frquency value will be rounded to the first higher whole multiple of FrequenciesRound. Only applies if &#39;maxfrequency&#39; is specified.</span>
    <span style="color:#75715e">% &#39;nfreq&#39;            Numeric.      5                     Draw this number of circles indicating frequency.</span>
    <span style="color:#75715e">% &#39;speedround&#39;       Numeric.      [] (auto)             Maximum wind speed will be rounded to the first higher whole multiple of WindSpeedRound.</span>
    <span style="color:#75715e">% &#39;nspeeds&#39;          Numeric.      [] (auto)             Draw this number of windspeeds subdivisions (bins). Default is 6 if &#39;speedround&#39; is specified. Otherwise, default is automatic.</span>
    <span style="color:#75715e">% &#39;maxfrequency&#39;     Numeric.      [] (auto) or 6        Set the value of the maximum frequency circle to be displayed. Be careful, because bins radius keep the original size.</span>
    <span style="color:#75715e">% &#39;freqlabelangle&#39;   Numeric.      [] (auto)             Angle in which frequecy labels are shown. If this value is empty, frequency labels will NOT be shown. Trigonometric reference. 0=Right, 90=Up.</span>
    <span style="color:#75715e">% &#39;titlestring&#39;      Cell/String.  {&#39;Wind Rose&#39;;&#39; &#39;}     Figure title. It is recommended to include an empty line below the main string.</span>
    <span style="color:#75715e">% &#39;lablegend&#39;        String.       &#39;Wind speeds in m/s&#39;  String that will appear at the top of the legend. Can be empty.</span>
    <span style="color:#75715e">% &#39;cmap&#39;             String.       &#39;jet&#39;                 String with the name of a colormap function. If you put inv before the name of the funcion, colors will be flipped (e.g. &#39;invjet&#39;, &#39;invautum&#39;, &#39;invbone&#39;, ...). Use any of the built-in functions (autumn, bone, colorcube, cool, copper, flag, gray, hot, hsv, jet, lines, pink, prism, spring, summer, white, winter). See doc colormap for more information.</span>
    <span style="color:#75715e">% &#39;height&#39;           Numeric.      2/3*screensize        Figure inner height in pixels. Default is 2/3 of minimum window dimension;</span>
    <span style="color:#75715e">% &#39;width&#39;            Numeric.      2/3*screensize        Figure inner width in pixels.</span>
    <span style="color:#75715e">% &#39;figcolor&#39;         Color Code.   &#39;w&#39;                   Figure color, any admitted matlab color format. Default is white.</span>
    <span style="color:#75715e">% &#39;textcolor&#39;        Color Code.   &#39;k&#39;                   Text and axis color, any admitted matlab color format. Default is black.</span>
    <span style="color:#75715e">% &#39;labels&#39;           CellString    {&#39;N&#39;,&#39;S&#39;,&#39;E&#39;,&#39;W&#39;}     Specify North South East West in a cell array of strings.</span>
    <span style="color:#75715e">% &#39;labelnorth&#39;       String.       &#39;N&#39;                   Label to indicate North. Be careful if you specify &#39;labels&#39; and &#39;labelnorth&#39;. Last parameter specified will be the one used.</span>
    <span style="color:#75715e">% &#39;labelsouth&#39;       String.       &#39;S&#39;                   Label to indicate South. Be careful if you specify &#39;labels&#39; and &#39;labelsouth&#39;. Last parameter specified will be the one used.</span>
    <span style="color:#75715e">% &#39;labeleast&#39;        String.       &#39;E&#39;                   Label to indicate East.  Be careful if you specify &#39;labels&#39; and &#39;labeleast&#39; . Last parameter specified will be the one used.</span>
    <span style="color:#75715e">% &#39;labelwest&#39;        String.       &#39;W&#39;                   Label to indicate West.  Be careful if you specify &#39;labels&#39; and &#39;labelwest&#39; . Last parameter specified will be the one used.</span>
    <span style="color:#75715e">% &#39;titlefontweight&#39;  String.       &#39;bold&#39;                Title font weight. You can use &#39;normal&#39;,&#39;bold&#39;,&#39;light&#39;,&#39;demi&#39;</span>
    <span style="color:#75715e">% &#39;legendvariable&#39;   String.       &#39;W_S&#39;                 Variable abbreviation that appears inside the legend. You can use TeX sequences.</span>
    <span style="color:#75715e">% &#39;anglenorth&#39;       Numeric.       90                   Direction angle meaning North wind. Default is 90 for North (trigonometric reference). If you specify &#39;north&#39; angle, you need to specify &#39;east&#39; angle, so the script knows how angles are referenced.</span>
    <span style="color:#75715e">% &#39;angleeast&#39;        Numeric.       0                    Direction angle meaning East wind.  Default is  0 for East  (counterclockwise).        If you specify &#39;east&#39; angle, you need to specify &#39;north&#39; angle, so the script knows how angles are referenced.</span>
    <span style="color:#75715e">% &#39;minradius&#39;        Numeric        1/30                 Minimum radius of the wind rose, relative to the maximum frequency radius. An empty circle of this size appears if greater than 0.</span>
    <span style="color:#75715e">% &#39;legendtype&#39;       Numeric        2                    Legend type continuous = 1, separated boxes = 2</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">% by Daniel Pereira - dpereira@s2msolutions.com</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">% 2014/Jul/14 - First version</span>

    <span style="color:#75715e">%% Check funciton call</span>
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">2</span>
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">WindRose needs at least two inputs&#39;</span>);
    <span style="color:#66d9ef">elseif</span> mod(length(varargin),<span style="color:#ae81ff">2</span>)<span style="color:#f92672">~=</span><span style="color:#ae81ff">0</span>
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Inputs must be paired: WindRose(Speed,Direction,&#39;</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PropertyName&#39;</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">,PropertyValue,...)&#39;</span>);
<span style="color:#66d9ef">elseif</span> <span style="color:#f92672">~</span>isnumeric(speed) <span style="color:#f92672">||</span> <span style="color:#f92672">~</span>isnumeric(speed)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Speed and Direction must be numeric arrays.&#39;</span>);
<span style="color:#66d9ef">elseif</span> <span style="color:#f92672">~</span>isequal(size(speed),size(direction))
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Speed and Direction must be the same size.&#39;</span>);
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%% Default parameters</span>
    SCS              = get(<span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">screensize&#39;</span>);

    CeteredIn0       = true;
    ndirections      = <span style="color:#ae81ff">36</span>;
    FrequenciesRound = <span style="color:#ae81ff">1</span>;
    NFrequencies     = <span style="color:#ae81ff">5</span>;
    WindSpeedRound   = [];
    NSpeeds          = [];
    circlemax        = [];
    FreqLabelAngle   = [];
    TitleString      = {<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Wind Rose&#39;</span>;<span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> &#39;</span>};
<span style="color:#75715e">%lablegend        = &#39;Wind Speeds in m/s&#39;;</span>
lablegend        = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">flow angle in °&#39;</span>;
colorfun         = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">jet&#39;</span>;
height           = min(SCS(<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">4</span>))<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>;
width            = min(SCS(<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">4</span>))<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>;
figcolor         = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">[1,1,1]&#39;</span>;
TextColor        = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">[0,0,0]&#39;</span>;
<span style="color:#75715e">% label.N          = &#39;N&#39;;</span>
<span style="color:#75715e">% label.S          = &#39;S&#39;;</span>
<span style="color:#75715e">% label.W          = &#39;W&#39;;</span>
<span style="color:#75715e">% label.E          = &#39;E&#39;;</span>
label.N          = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">90°&#39;</span>;
label.S          = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">270°&#39;</span>;
label.W          = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">180°&#39;</span>;
label.E          = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0°&#39;</span>;
titlefontweight  = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bold&#39;</span>;
legendvariable   = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">W_S&#39;</span>;
RefN             = <span style="color:#ae81ff">90</span>;
RefE             = <span style="color:#ae81ff">0</span>;
min_radius       = <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">30</span>;
LegendType       = <span style="color:#ae81ff">2</span>;

<span style="color:#75715e">%% User-.specified parameters</span>

    <span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">2</span>:numel(varargin)
<span style="color:#66d9ef">switch</span> lower(varargin{i})
    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">centeredin0&#39;</span>
    CeteredIn0       = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ndirections&#39;</span>
ndirections      = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">freqround&#39;</span>
FrequenciesRound = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nfreq&#39;</span>
NFrequencies     = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>}; 
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">speedround&#39;</span>
WindSpeedRound   = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nspeeds&#39;</span>
NSpeeds          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">freqlabelangle&#39;</span>
FreqLabelAngle   = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">titlestring&#39;</span>
TitleString      = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">lablegend&#39;</span>
lablegend        = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">cmap&#39;</span>
colorfun         = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">height&#39;</span>
height           = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">width&#39;</span>
width            = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">figcolor&#39;</span>
figcolor         = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">textcolor&#39;</span>
TextColor        = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">min_radius&#39;</span>
min_radius       = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">maxfrequency&#39;</span>
circlemax = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">titlefontweight&#39;</span>
titlefontweight  = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">legendvariable&#39;</span>
legendvariable   = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">legendtype&#39;</span>
LegendType       = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">labelnorth&#39;</span>
label.N          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">labelsouth&#39;</span>
label.S          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">labeleast&#39;</span>
label.E          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">labelwest&#39;</span>
label.W          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">labels&#39;</span>
label.N          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>}{<span style="color:#ae81ff">1</span>};
label.S          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>}{<span style="color:#ae81ff">2</span>};
label.E          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>}{<span style="color:#ae81ff">3</span>};
label.W          = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>}{<span style="color:#ae81ff">4</span>};
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">anglenorth&#39;</span>
k = any(arrayfun(@(x) strcmpi(x,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">angleeast&#39;</span>),varargin));
<span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>k
error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Reference angles need to be specified for AngleEAST and AngleNORTH directions&#39;</span>);
<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">angleeast&#39;</span>
k = find(arrayfun(@(x) strcmpi(x,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">anglenorth&#39;</span>),varargin));
<span style="color:#66d9ef">if</span> isempty(k)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Reference angles need to be specified for AngleEAST and AngleNORTH directions&#39;</span>);
    <span style="color:#66d9ef">else</span>
    RefE         = varargin{i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
RefN         = varargin{k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>};
<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">if</span> abs(RefN<span style="color:#f92672">-</span>RefE)<span style="color:#f92672">~=</span><span style="color:#ae81ff">90</span>
error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">The angles specified for north and east must differ in 90 degrees&#39;</span>);
<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">otherwise</span>
error([varargin{i} <span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> is not a valid property for WindRose function.&#39;</span>]);
<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

speed            = reshape(speed,[],<span style="color:#ae81ff">1</span>);                                    <span style="color:#75715e">% Convert wind speed into a column vector</span>
direction        = reshape(direction,[],<span style="color:#ae81ff">1</span>);                                <span style="color:#75715e">% Convert wind direction into a column vector</span>
NumberElements   = numel(direction);                                       <span style="color:#75715e">% Coun the actual number of elements, to consider winds = 0 when calculating frequency.</span>
dir              = mod((RefN<span style="color:#f92672">-</span>direction)<span style="color:#f92672">/</span>(RefN<span style="color:#f92672">-</span>RefE)<span style="color:#f92672">*</span><span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">360</span>);               <span style="color:#75715e">% Ensure that the direction is between 0 and 360?</span>
speed            = speed(speed<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>);                                         <span style="color:#75715e">% Only show winds higher than 0. 縒hy? See next comment.</span>
dir              = dir(speed<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>);                                           <span style="color:#75715e">% Wind = 0 does not have direction, so it cannot appear in a wind rose, but the number of appeareances must be considered.</span>

figure_handle = figure(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,figcolor,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">units&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">pixels&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">position&#39;</span>,[SCS(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span>width<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span> SCS(<span style="color:#ae81ff">4</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span>height<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span> width height],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">menubar&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">none&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">toolbar&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">none&#39;</span>);
<span style="color:#75715e">%% Bin Directions</span>
N     = linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">360</span>,ndirections<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);                                     <span style="color:#75715e">% Create ndirections direction intervals (ndirections+1 edges)</span>
N     = N(<span style="color:#ae81ff">1</span>:<span style="color:#66d9ef">end</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);                                                        <span style="color:#75715e">% N is the angles in which direction bins are centered. We do not want the 360 to appear, because 0 is already appearing.</span>
n     = <span style="color:#ae81ff">180</span><span style="color:#f92672">/</span>ndirections;                                                   <span style="color:#75715e">% Angle that should be put backward and forward to create the angular bin, 1st centered in 0</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>CeteredIn0                                                             <span style="color:#75715e">% If user does not want the 1st bin to be centered in 0?</span>
N = N<span style="color:#f92672">+</span>n;                                                               <span style="color:#75715e">% Bin goes from 0 to 2n (N to N+2n), instead of from -n to n (N-n to N+n), so Bin is not centered in 0 (N) angle, but in the n (N+n) angle</span>
<span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%% Wind speeds/velocities</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>isempty(WindSpeedRound)
    <span style="color:#66d9ef">if</span> isempty(NSpeeds); NSpeeds = <span style="color:#ae81ff">6</span>; <span style="color:#66d9ef">end</span>                                  <span style="color:#75715e">% Default value for NSpeeds if not user specified</span>
    vmax      = ceil(max(speed)<span style="color:#f92672">/</span>WindSpeedRound)<span style="color:#f92672">*</span>WindSpeedRound;            <span style="color:#75715e">% Max wind speed rounded to the nearest whole multiple of WindSpeedRound (Use round or ceil as desired)</span>
    <span style="color:#66d9ef">if</span> vmax<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>; vmax=WindSpeedRound; <span style="color:#66d9ef">end</span>;                      <span style="color:#75715e">% If max wind speed is 0, make max wind to be WindSpeedRound, so wind speed bins are correctly shown.</span>
    vwinds    = linspace(<span style="color:#ae81ff">0</span>,vmax,NSpeeds);                                  <span style="color:#75715e">% Wind speeds go from 0 to vmax, creating the desired number of wind speed intervals</span>
    <span style="color:#66d9ef">else</span>
    figure2 = figure(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">visible&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">off&#39;</span>); plot(speed);                        <span style="color:#75715e">% Plot wind speed</span>
    vwinds = get(gca,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ytick&#39;</span>); delete(figure2);                            <span style="color:#75715e">% Yaxis will automatically make divisions or us.</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>isempty(NSpeeds)
    vwinds = linspace(min(vwinds),max(vwinds),NSpeeds);
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%% Histogram in each direction + Draw</span>
    count     = PivotTableCount(N,n,vwinds,speed,dir,NumberElements);          <span style="color:#75715e">% For each direction and for each speed, value of the radius that the windorose must reach (Accumulated in speed).</span>

<span style="color:#66d9ef">if</span> isempty(circlemax)
    circlemax = ceil(max(max(count))<span style="color:#f92672">/</span>FrequenciesRound)<span style="color:#f92672">*</span>FrequenciesRound;   <span style="color:#75715e">% Round highest frequency to closest whole multiple of theFrequenciesRound  (Use round or ceil as desired)</span>
    <span style="color:#66d9ef">end</span>
    min_radius = min_radius<span style="color:#f92672">*</span>circlemax;

    DrawPatches(N,n,vwinds,count,colorfun,figcolor,min_radius);<span style="color:#75715e">% Draw the windrose, knowing the angles, the range for each direction, the speed ranges, the count (frequency) values and the colormap used.</span>

    <span style="color:#75715e">%% Constant frequecy circles and x-y axes + Draw + Labels</span>

    [x,y]     = cylinder(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">50</span>); x = x(<span style="color:#ae81ff">1</span>,:); y = y(<span style="color:#ae81ff">1</span>,:);                        <span style="color:#75715e">% Get x and y for a unit-radius circle</span>
    circles   = linspace(<span style="color:#ae81ff">0</span>,circlemax,NFrequencies<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>); circles = circles(<span style="color:#ae81ff">2</span>:<span style="color:#66d9ef">end</span>);<span style="color:#75715e">% Radii of the circles that must be drawn (frequencies). We do not want to spend time drawing radius=0.</span>

    radius    = circles   <span style="color:#f92672">+</span> min_radius;
    radiusmax = circlemax <span style="color:#f92672">+</span> min_radius;

    plot(x<span style="color:#f92672">&#39;</span><span style="color:#f92672">*</span>radius,y<span style="color:#f92672">&#39;</span><span style="color:#f92672">*</span>radius,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">:&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor);                           <span style="color:#75715e">% Draw circles</span>
    plot(x<span style="color:#f92672">*</span>radiusmax,y<span style="color:#f92672">*</span>radiusmax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor);                       <span style="color:#75715e">% Redraw last circle</span>

    axisangles = <span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">360</span>; axisangles = axisangles(<span style="color:#ae81ff">1</span>:<span style="color:#66d9ef">end</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);                   <span style="color:#75715e">% Angles in which to draw the radial axis (trigonometric reference)</span>
    R = [min_radius;radiusmax];
    plot(R<span style="color:#f92672">*</span>cosd(axisangles),R<span style="color:#f92672">*</span>sind(axisangles),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">:&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor);         <span style="color:#75715e">% Draw radial axis, in the specified angles</span>

    FrequecyLabels(circles,radius,FreqLabelAngle,TextColor);                   <span style="color:#75715e">% Display frequency labels</span>
    CardinalLabels(radiusmax,TextColor,label);                                 <span style="color:#75715e">% Display N, S, E, W</span>

    <span style="color:#75715e">%% Title and Legend</span>
    title(TitleString,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">fontweight&#39;</span>,titlefontweight);         <span style="color:#75715e">% Display a title</span>
    set(gca,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">outerposition&#39;</span>,[<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>]);                                        <span style="color:#75715e">% Check that the current axis fills the figure.</span>
    <span style="color:#66d9ef">if</span> LegendType<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>
    leyenda = CreateLegend(vwinds,lablegend,legendvariable);               <span style="color:#75715e">% Create a legend cell string</span>
    l       = legend(leyenda,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">location&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">southwest&#39;</span>);                      <span style="color:#75715e">% Display the legend wherever (position is corrected)</span>
    PrettyLegend(l,TextColor);                                   <span style="color:#75715e">% Display the legend in a good position</span>
    <span style="color:#66d9ef">elseif</span> LegendType<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
    disp(vwinds);
    caxis([vwinds(<span style="color:#ae81ff">1</span>) vwinds(<span style="color:#66d9ef">end</span>)]);
    colorbar(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">YTick&#39;</span>,vwinds);
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%% Outputs</span>
    [count,speeds,directions,Table,colorSeq,barX,barY] = CreateOutputs(count,vwinds,N,n,RefN,RefE);

<span style="color:#66d9ef">function</span> count = <span style="color:#a6e22e">PivotTableCount</span>(N,n,vwinds,speed,dir,NumberElements)
    count  = zeros(length(N),length(vwinds));
<span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:length(N)
    d1 = mod(N(i)<span style="color:#f92672">-</span>n,<span style="color:#ae81ff">360</span>);                                              <span style="color:#75715e">% Direction 1 is N-n</span>
    d2 = N(i)<span style="color:#f92672">+</span>n;                                                       <span style="color:#75715e">% Direction 2 is N+n</span>
<span style="color:#66d9ef">if</span> d1<span style="color:#f92672">&gt;</span>d2                                                           <span style="color:#75715e">% If direction 1 is greater than direction 2 of the bin (d1 = -5 = 355, d2 = 5)</span>
    cond = or(dir<span style="color:#f92672">&gt;</span>=d1,dir<span style="color:#f92672">&lt;</span>d2);                                     <span style="color:#75715e">% The condition is satisfied whenever d&gt;=d1 or d&lt;d2</span>
    <span style="color:#66d9ef">else</span>                                                               <span style="color:#75715e">% For the rest of the cases,</span>
    cond = and(dir<span style="color:#f92672">&gt;</span>=d1,dir<span style="color:#f92672">&lt;</span>d2);                                    <span style="color:#75715e">% Both conditions must be met for the same bin</span>
    <span style="color:#66d9ef">end</span>
    counter    = histc(speed(cond),vwinds);                            <span style="color:#75715e">% If vmax was for instance 25, counter will have counts for these intervals: [&gt;=0 y &lt;5] [&gt;=5 y &lt;10] [&gt;=10 y &lt;15] [&gt;=15 y &lt;20] [&gt;=20 y &lt;25] [&gt;=25]</span>
    <span style="color:#66d9ef">if</span> isempty(counter); counter = zeros(<span style="color:#ae81ff">1</span>,size(count,<span style="color:#ae81ff">2</span>)); <span style="color:#66d9ef">end</span>         <span style="color:#75715e">% If counter is empty for any reason, set the counts to 0.</span>
    count(i,:) = cumsum(counter);                                      <span style="color:#75715e">% Computing cumsum will make count to have the counts for [&lt;5] [&lt;10] [&lt;15] [&lt;20] [&lt;25] [&gt;=25] (cumulative count, so we have the radius for each speed)</span>
    <span style="color:#66d9ef">end</span>
    count = count<span style="color:#f92672">/</span>NumberElements<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>;                                      <span style="color:#75715e">% Frequency in percentage</span>

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">DrawPatches</span>(N,n,vwinds,count,colorfun,figcolor,min_radius)
    inv = strcmp(colorfun(<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">inv&#39;</span>);                                     <span style="color:#75715e">% INV = First three letters in cmap are inv</span>
    <span style="color:#66d9ef">if</span> inv; colorfun = colorfun(<span style="color:#ae81ff">4</span>:<span style="color:#66d9ef">end</span>); <span style="color:#66d9ef">end</span>                                <span style="color:#75715e">% if INV, cmap is the rest, excluding inv</span>
    color = feval(colorfun,<span style="color:#ae81ff">256</span>);                                           <span style="color:#75715e">% Create color map</span>
    color = interp1(linspace(<span style="color:#ae81ff">1</span>,length(vwinds),<span style="color:#ae81ff">256</span>),color,<span style="color:#ae81ff">1</span>:length(vwinds));<span style="color:#75715e">% Get the needed values.</span>
    <span style="color:#66d9ef">if</span> inv; color = flipud(color); <span style="color:#66d9ef">end</span>;                                    <span style="color:#75715e">% if INV, flip upside down the colormap</span>
    plot(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,figcolor,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">markeredgecolor&#39;</span>,figcolor,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">markerfacecolor&#39;</span>,figcolor); <span style="color:#75715e">% This will create an empty legend entry.</span>
    hold on; axis square; axis off;
<span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:length(N)
    <span style="color:#66d9ef">for</span> j=length(vwinds)👎<span style="color:#ae81ff">1</span>
                          <span style="color:#66d9ef">if</span> j<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>
                          r(<span style="color:#ae81ff">1</span>) = count(i,j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
                          <span style="color:#66d9ef">else</span>
                          r(<span style="color:#ae81ff">1</span>) = <span style="color:#ae81ff">0</span>;                                                  <span style="color:#75715e">% For the first case, radius is 0</span>
                          <span style="color:#66d9ef">end</span>
                          r(<span style="color:#ae81ff">2</span>)  = count(i,j);
                          r     = r<span style="color:#f92672">+</span>min_radius;

                          alpha = linspace(<span style="color:#f92672">-</span>n,n,<span style="color:#ae81ff">100</span>)<span style="color:#f92672">+</span>N(i);
                          x1    = r(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> sind(fliplr(alpha));
                          y1    = r(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> cosd(fliplr(alpha));
                          x     = [x1 r(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>sind(alpha)];                           <span style="color:#75715e">% Create circular sectors</span>
                          y     = [y1 r(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>cosd(alpha)];
                          fill(x,y,color(j,:),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">edgecolor&#39;</span>,hsv2rgb(rgb2hsv(color(j,:))<span style="color:#f92672">.*</span>[<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0.7</span>])); <span style="color:#75715e">% Draw them in the specified coloe. Edge is slightly darker.</span>
                          <span style="color:#75715e">%text(x(1),y(1),num2str(count(i,j)));  %% add label</span>
                          <span style="color:#66d9ef">end</span>
                          <span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">FrequecyLabels</span>(circles,radius,angulo,TextColor)
    s = sind(angulo); c = cosd(angulo);                                      <span style="color:#75715e">% Get the positions in which labels must be placed</span>
    <span style="color:#66d9ef">if</span> c<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>; ha = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>;   <span style="color:#66d9ef">elseif</span> c<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>; ha = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">right&#39;</span>; <span style="color:#66d9ef">else</span> ha = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">center&#39;</span>; <span style="color:#66d9ef">end</span> <span style="color:#75715e">% Depending on the sign of the cosine, horizontal alignment should be one or another</span>
    <span style="color:#66d9ef">if</span> s<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>; va = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bottom&#39;</span>; <span style="color:#66d9ef">elseif</span> s<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>; va = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">top&#39;</span>;   <span style="color:#66d9ef">else</span> va = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>; <span style="color:#66d9ef">end</span> <span style="color:#75715e">% Depending on the sign of the sine  , vertical   alignment should be one or another</span>
<span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:length(circles)
    text(radius(i)<span style="color:#f92672">*</span>c,radius(i)<span style="color:#f92672">*</span>s,[num2str(circles(i)) <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,ha,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,va,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); <span style="color:#75715e">% display the labels for each circle</span>
    <span style="color:#66d9ef">end</span>
    rmin = radius(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">-</span>abs(diff(radius(<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">2</span>)));
    <span style="color:#66d9ef">if</span> rmin<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">if</span> c<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>; ha = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">right&#39;</span>; <span style="color:#66d9ef">elseif</span> c<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>; ha = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>;   <span style="color:#66d9ef">else</span> ha = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">center&#39;</span>; <span style="color:#66d9ef">end</span> <span style="color:#75715e">% Depending on the sign of the cosine, horizontal alignment should be one or another</span>
    <span style="color:#66d9ef">if</span> s<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>; va = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">top&#39;</span>;   <span style="color:#66d9ef">elseif</span> s<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>; va = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bottom&#39;</span>; <span style="color:#66d9ef">else</span> va = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>; <span style="color:#66d9ef">end</span> <span style="color:#75715e">% Depending on the sign of the sine  , vertical   alignment should be one or another</span>
    text(rmin<span style="color:#f92672">*</span>c,rmin<span style="color:#f92672">*</span>s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0%&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,ha,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,va,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); <span style="color:#75715e">% display the labels for each circle</span>
    <span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">CardinalLabels</span>(circlemax,TextColor,labels)
    text( circlemax,<span style="color:#ae81ff">0</span>,[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> &#39;</span> labels.E],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); <span style="color:#75715e">% East  label</span>
    text( circlemax<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">30</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),circlemax<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">30</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> 30°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); <span style="color:#75715e">% East  label</span>
    text( circlemax<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">60</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),circlemax<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">60</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> 60°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); 
    text( (circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">120</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),(circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">120</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">120°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); 
    text( (circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">150</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),(circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">150</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">150°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); 
    text( (circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">210</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),(circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">210</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">210°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); 
    text( (circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">240</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),(circlemax<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">240</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">240°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor);     
    text( circlemax<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">300</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),circlemax<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">300</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> 300°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); 
    text( circlemax<span style="color:#f92672">*</span>cos(<span style="color:#ae81ff">330</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),circlemax<span style="color:#f92672">*</span>sin(<span style="color:#ae81ff">330</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>),[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> 330°&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left&#39;</span>  ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); 
    text(<span style="color:#f92672">-</span>circlemax,<span style="color:#ae81ff">0</span>,[labels.W <span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> &#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">right&#39;</span> ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">middle&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); <span style="color:#75715e">% West  label</span>
    text(<span style="color:#ae81ff">0</span>, circlemax,labels.N      ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">center&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bottom&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); <span style="color:#75715e">% North label</span>
    text(<span style="color:#ae81ff">0</span>,<span style="color:#f92672">-</span>circlemax,labels.S      ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HorizontalAlignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">center&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">verticalalignment&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">top&#39;</span>   ,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,TextColor); <span style="color:#75715e">% South label</span>
    xlim([<span style="color:#f92672">-</span>circlemax circlemax]);
    ylim([<span style="color:#f92672">-</span>circlemax circlemax]);

<span style="color:#66d9ef">function</span> leyenda = <span style="color:#a6e22e">CreateLegend</span>(vwinds,lablegend,legendvariable)
    leyenda = cell(length(vwinds),<span style="color:#ae81ff">1</span>);                                      <span style="color:#75715e">% Initialize legend cell array</span>
<span style="color:#66d9ef">for</span> j=<span style="color:#ae81ff">1</span>:length(vwinds)
    <span style="color:#66d9ef">if</span> j<span style="color:#f92672">==</span>length(vwinds)                                               <span style="color:#75715e">% When last index is reached</span>
    string = sprintf(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s %s %g&#39;</span>,legendvariable,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\geq&#39;</span>,vwinds(j));  <span style="color:#75715e">% Display wind &lt;= max wind</span>
    <span style="color:#66d9ef">else</span>                                                               <span style="color:#75715e">% For the rest of the indices</span>
    string = sprintf(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%g %s %s &lt; %g&#39;</span>,vwinds(j),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\leq&#39;</span>,legendvariable,vwinds(j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)); <span style="color:#75715e">% Set v1 &lt;= v2 &lt; v1</span>
    <span style="color:#66d9ef">end</span>
    string = regexprep(string,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0 \leq&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0 &lt;&#39;</span>);                         <span style="color:#75715e">% Replace &#34;0 &lt;=&#34; by &#34;0 &lt;&#34;, because wind speed = 0 is not displayed in the graph.</span>
    leyenda{length(vwinds)<span style="color:#f92672">-</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>} = string;
    <span style="color:#66d9ef">end</span>
    leyenda = [lablegend; leyenda];                                        <span style="color:#75715e">% Add the title for the legend</span>

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">PrettyLegend</span>(l,TextColor)
    set(l,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">units&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">normalized&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">box&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">off&#39;</span>);                               <span style="color:#75715e">% Do not display the box</span>
    POS = get(l,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">position&#39;</span>);                                               <span style="color:#75715e">% get legend position (width and height)</span>
    set(l,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">position&#39;</span>,[<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>POS(<span style="color:#ae81ff">4</span>) POS(<span style="color:#ae81ff">3</span>) POS(<span style="color:#ae81ff">4</span>)],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">textcolor&#39;</span>,TextColor);    <span style="color:#75715e">% Put the legend in the upper left corner</span>
    uistack(l,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bottom&#39;</span>);                                                   <span style="color:#75715e">% Put the legend below the axis</span>

<span style="color:#66d9ef">function</span> [count,speeds,directions,Table,colorSeq,barX,barY] = <span style="color:#a6e22e">CreateOutputs</span>(count,vwinds,N,n,RefN,RefE)
    count          = [count(:,<span style="color:#ae81ff">1</span>) diff(count,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>)];                         <span style="color:#75715e">% Count had the accumulated frequencies. With this line, we get the frequency for each single direction and each single speed with no accumulation.</span>
    speeds         = vwinds;                                               <span style="color:#75715e">% Speeds are the same as the ones used in the Wind Rose Graph</span>
    directions     = mod(RefN <span style="color:#f92672">-</span> N<span style="color:#f92672">&#39;</span><span style="color:#f92672">/</span><span style="color:#ae81ff">90</span><span style="color:#f92672">*</span>(RefN<span style="color:#f92672">-</span>RefE),<span style="color:#ae81ff">360</span>);                    <span style="color:#75715e">% Directions are the directions in which the sector is centered. Convert function reference to user reference</span>
    vwinds(<span style="color:#66d9ef">end</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)  = inf;                                                  <span style="color:#75715e">% Last wind direction is inf (for creating intervals)</span>

    [directions,i] = sort(directions);                                     <span style="color:#75715e">% Sort directions in ascending order</span>
    count          = count(i,:);                                           <span style="color:#75715e">% Sort count in the same way.</span>

    wspeeds        = cell(<span style="color:#ae81ff">1</span>,length(vwinds)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:(length(vwinds)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">if</span> vwinds(i) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>; s1 = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">(&#39;</span>; <span style="color:#66d9ef">else</span> s1 = <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">[&#39;</span>; <span style="color:#66d9ef">end</span>                     <span style="color:#75715e">% If vwinds(i) =0 interval is open, because count didn&#39;t compute windspeed = 0.</span>
    wspeeds{i} = [s1 num2str(vwinds(i)) <span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> , &#39;</span> num2str(vwinds(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)) <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">)&#39;</span>];<span style="color:#75715e">% Create wind speed intervals</span>
    <span style="color:#66d9ef">end</span>

    wdirs = cell(length(directions),<span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:length(directions)
    wdirs{i} = sprintf(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">[%g , %g)&#39;</span>,mod(directions(i)<span style="color:#f92672">-</span>n,<span style="color:#ae81ff">360</span>),directions(i)<span style="color:#f92672">+</span>n); <span style="color:#75715e">% Create widn direction intervals</span>
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%     countMark         = find(count == max(max(count)));</span>
    <span style="color:#75715e">%     countColumnLength = length(directions);</span>
    <span style="color:#75715e">%     foundIndex        = countMark -countColumnLength * floor(countMark/countColumnLength);</span>
    <span style="color:#75715e">%     colorSeq          = [mod(directions(foundIndex)-n,360),directions(foundIndex)+n];</span>
    WindZeroFreqency = <span style="color:#ae81ff">100</span><span style="color:#f92672">-</span>sum(sum(count));                                <span style="color:#75715e">% Wind speed = 0 appears 100-sum(total) % of the time. It does not have direction.</span>
    WindZeroFreqency = WindZeroFreqency<span style="color:#f92672">*</span>(WindZeroFreqency<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span><span style="color:#f92672">&gt;</span>eps);        <span style="color:#75715e">% If frequency/100% is lower than eps, do not show that value.</span>

    Table            = [{<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Frequencies (%)&#39;</span>},{<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>},{<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Wind Speed Interval&#39;</span>},repmat({<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>},<span style="color:#ae81ff">1</span>,numel(wspeeds));<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Direction Interval (?&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Direction ~&#39;</span>,wspeeds,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">TOTAL&#39;</span>;[wdirs num2cell(directions) num2cell(count) num2cell(sum(count,<span style="color:#ae81ff">2</span>))]]; <span style="color:#75715e">% Create table cell. Ready to xlswrite.</span>
            Table(<span style="color:#66d9ef">end</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,:)   = [{<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">[0 , 360)&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">TOTAL&#39;</span>},num2cell(sum(count,<span style="color:#ae81ff">1</span>)),{sum(sum(count))}];
    Table(<span style="color:#66d9ef">end</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">2</span>) = {<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">No Direction&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Wind Speed = 0&#39;</span>};  <span style="color:#75715e">% Show Wind Speed = 0 on table.</span>
    <span style="color:#75715e">%% find max count</span>
    colorBar1 = sum(count,<span style="color:#ae81ff">2</span>);
    foundIndex       = find(colorBar1 <span style="color:#f92672">==</span> max(colorBar1));
    colorSeq         = [mod(directions(foundIndex)<span style="color:#f92672">-</span>n,<span style="color:#ae81ff">360</span>),directions(foundIndex)<span style="color:#f92672">+</span>n];
    barIndex =  find(colorBar1<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>);
    barX = [];
    barY = [];
<span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span>:length(barIndex)
    barX(i) = directions(i);
    barY(i) = colorBar1(i);
    <span style="color:#66d9ef">end</span>
    <span style="color:#75715e">%bp = bar(barX,barY);</span>
    <span style="color:#75715e">%bp(1).LineWidth = 3;</span>
    <span style="color:#75715e">%bp(foundIndex).EdgeColor = &#39;red&#39;;</span>

    Table{<span style="color:#66d9ef">end</span>,<span style="color:#66d9ef">end</span>}   = WindZeroFreqency;
</code></pre></div><!-- raw HTML omitted -->
<p>可以自己更改n为不同的多项式</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-matlab" data-lang="matlab"><span style="color:#66d9ef">function</span> [t,y1,a]=<span style="color:#a6e22e">getfitLine</span>(x,y,TapeLine)
    n=<span style="color:#ae81ff">5</span>;

    p = polyfit(x,y,n); 
    <span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    a(i)= p(i); 
    <span style="color:#66d9ef">end</span>
    t = linspace(x(<span style="color:#ae81ff">1</span>),x(length(x)),TapeLine);  
    <span style="color:#66d9ef">if</span> n<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>;
    y1=a(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">+</span>a(<span style="color:#ae81ff">2</span>);
    <span style="color:#66d9ef">elseif</span> n<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>;
    y1=a(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span>a(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">+</span>a(<span style="color:#ae81ff">3</span>);
    <span style="color:#66d9ef">elseif</span> n<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span>;
    y1 = a(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> a(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> a(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>t <span style="color:#f92672">+</span> a(<span style="color:#ae81ff">4</span>); 
    <span style="color:#66d9ef">elseif</span> n<span style="color:#f92672">==</span><span style="color:#ae81ff">4</span>;
    y1 = a(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> a(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> a(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> a(<span style="color:#ae81ff">4</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">+</span>a(<span style="color:#ae81ff">5</span>);
    <span style="color:#66d9ef">elseif</span> n<span style="color:#f92672">==</span><span style="color:#ae81ff">5</span>
    y1= a(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">5</span><span style="color:#f92672">+</span>a(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">4</span><span style="color:#f92672">+</span>a(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">3</span><span style="color:#f92672">+</span>a(<span style="color:#ae81ff">4</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">.^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span>a(<span style="color:#ae81ff">5</span>)<span style="color:#f92672">*</span>t<span style="color:#f92672">+</span>a(<span style="color:#ae81ff">6</span>);
    <span style="color:#66d9ef">end</span>


    <span style="color:#66d9ef">end</span>

</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-matlab" data-lang="matlab"><span style="color:#66d9ef">    function</span> hn=<span style="color:#a6e22e">arrow3</span>(p1,p2,s,w,h,ip,alpha,beta)
<span style="color:#75715e">% ARROW3 (R13)</span>
    <span style="color:#75715e">%   ARROW3(P1,P2) draws lines from P1 to P2 with directional arrowheads.</span>
    <span style="color:#75715e">%   P1 and P2 are either nx2 or nx3 matrices.  Each row of P1 is an</span>
    <span style="color:#75715e">%   initial point, and each row of P2 is a terminal point.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ARROW3(P1,P2,S,W,H,IP,ALPHA,BETA) can be used to specify properties</span>
    <span style="color:#75715e">%   of the line, initial point marker, and arrowhead.  S is a character</span>
    <span style="color:#75715e">%   string made with one element from any or all of the following 3</span>
    <span style="color:#75715e">%   columns:</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     Color Switches      LineStyle            LineWidth</span>
    <span style="color:#75715e">%     ------------------  -------------------  --------------------</span>
<span style="color:#75715e">%     k  blacK (default)  -  solid (default)   0.5 points (default)</span>
    <span style="color:#75715e">%     y  Yellow           :  dotted            0   no lines</span>
    <span style="color:#75715e">%     m  Magenta          -. dashdot           /   LineWidthOrder</span>
    <span style="color:#75715e">%     c  Cyan             -- dashed</span>
    <span style="color:#75715e">%     r  Red              *  LineStyleOrder            _______ __  </span>
    <span style="color:#75715e">%     g  Green                                       ^        |    </span>
    <span style="color:#75715e">%     b  Blue                                       / \       |    </span>
    <span style="color:#75715e">%     w  White                        Arrowhead    /   \   Height  </span>
    <span style="color:#75715e">%     a  Asparagus                                /     \     |    </span>
    <span style="color:#75715e">%     d  Dark gray                               /       \    |    </span>
    <span style="color:#75715e">%     e  Evergreen                              /___   ___\ __|__  </span>
    <span style="color:#75715e">%     f  Firebrick                             |    | |    |       </span>
    <span style="color:#75715e">%     h  Hot pink                              |-- Width --|       </span>
    <span style="color:#75715e">%     i  Indigo                                |    | |    |       </span>
    <span style="color:#75715e">%     j  Jade                                       | |            </span>
    <span style="color:#75715e">%     l  Light gray                                 | |            </span>
    <span style="color:#75715e">%     n  Nutbrown                                   | |            </span>
    <span style="color:#75715e">%     p  Pear                                       | |            </span>
    <span style="color:#75715e">%     q  kumQuat                      Line       --&gt;| |&lt;--LineWidth</span>
    <span style="color:#75715e">%     s  Sky blue                                   | |            </span>
    <span style="color:#75715e">%     t  Tawny                                      | |            </span>
    <span style="color:#75715e">%     u  bUrgundy                                   | |            </span>
    <span style="color:#75715e">%     v  Violet                                     | |            </span>
    <span style="color:#75715e">%     z  aZure                                      | |            </span>
    <span style="color:#75715e">%     x  random                       Initial      /   \           </span>
    <span style="color:#75715e">%     o  colorOrder                   Point    --&gt;(     )&lt;--IP     </span>
    <span style="color:#75715e">%     |  magnitude                    Marker       \_ _/           </span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     -------------------------------------------------------------</span>
    <span style="color:#75715e">%                          Color Equivalencies</span>
    <span style="color:#75715e">%     -------------------------------------------------------------</span>
    <span style="color:#75715e">%     ColorOrder     Arrow3         |     Simulink       Arrow3</span>
    <span style="color:#75715e">%     ----------     ----------     |     ----------     ----------</span>
    <span style="color:#75715e">%     Color1         Blue           |     LightBlue      aZure</span>
    <span style="color:#75715e">%     Color2         Evergreen      |     DarkGreen      Asparagus</span>
    <span style="color:#75715e">%     Color3         Red            |     Orange         kumQuat</span>
    <span style="color:#75715e">%     Color4         Sky blue       |     Gray           Light gray</span>
    <span style="color:#75715e">%     Color5         Violet         |</span>
    <span style="color:#75715e">%     Color6         Pear           |</span>
    <span style="color:#75715e">%     Color7         Dark gray      |</span>
    <span style="color:#75715e">%     -------------------------------------------------------------</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   The components of S may be specified in any order.  Invalid</span>
    <span style="color:#75715e">%   characters in S will be ignored and replaced by default settings.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   Prefixing the color code with &#39;_&#39; produces a darker shade, e.g.</span>
    <span style="color:#75715e">%   &#39;_t&#39; is dark tawny; prefixing the color code with &#39;^&#39; produces a</span>
    <span style="color:#75715e">%   lighter shade, e.g. &#39;^q&#39; is light kumquat.  The relative brightness</span>
    <span style="color:#75715e">%   of light and dark color shades is controlled by the scalar parameter</span>
    <span style="color:#75715e">%   BETA.  Color code prefixes do not affect black (k), white (w), or</span>
    <span style="color:#75715e">%   the special color switches (xo|).</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ColorOrder may be achieved in two fashions:  The user may either</span>
    <span style="color:#75715e">%   set the ColorOrder property (using RGB triples) or define the</span>
    <span style="color:#75715e">%   global variable ColorOrder (using a string of valid color codes).</span>
    <span style="color:#75715e">%   If the color switch is specified with &#39;o&#39;, and the global variable</span>
    <span style="color:#75715e">%   ColorOrder is a string of color codes (color switches less &#39;xo|&#39;,</span>
            <span style="color:#75715e">%   optionally prefixed with &#39;_&#39; or &#39;^&#39;), then the ColorOrder property</span>
    <span style="color:#75715e">%   will be set to the sequence of colors indicated by the ColorOrder</span>
    <span style="color:#75715e">%   variable.  The color sequence &#39;bersvpd&#39; matches the default</span>
    <span style="color:#75715e">%   ColorOrder property.  If the color switch is specified with &#39;o&#39;, and</span>
    <span style="color:#75715e">%   the global variable ColorOrder is empty or invalid, then the current</span>
    <span style="color:#75715e">%   ColorOrder property will be used.  Note that the ColorOrder variable</span>
    <span style="color:#75715e">%   takes precedence over the ColorOrder property.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   The magnitude color switch is used to visualize vector magnitudes</span>
    <span style="color:#75715e">%   in conjunction with a colorbar.  If the color switch is specified</span>
    <span style="color:#75715e">%   with &#39;|&#39;, colors are linearly interpolated from the current ColorMap</span>
    <span style="color:#75715e">%   according to the length of the associated line.  This option sets</span>
    <span style="color:#75715e">%   CLim to [MinM,MaxM], where MinM and MaxM are the minimum and maximum</span>
    <span style="color:#75715e">%   magnitudes, respectively.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   The current LineStyleOrder property will be used if LineStyle is</span>
    <span style="color:#75715e">%   specified with &#39;*&#39;.  MATLAB cycles through the line styles defined</span>
    <span style="color:#75715e">%   by the LineStyleOrder property only after using all colors defined</span>
    <span style="color:#75715e">%   by the ColorOrder property.  If however, the global variable</span>
    <span style="color:#75715e">%   LineWidthOrder is defined, and LineWidth is specified with &#39;/&#39;,</span>
    <span style="color:#75715e">%   then each line will be drawn with sequential color, linestyle, and</span>
    <span style="color:#75715e">%   linewidth.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   W (default = 1) is a vector of arrowhead widths; use W = 0 for no</span>
    <span style="color:#75715e">%   arrowheads.  H (default = 3W) is a vector of arrowhead heights.  If</span>
    <span style="color:#75715e">%   vector IP is neither empty nor negative, initial point markers will</span>
    <span style="color:#75715e">%   be plotted with diameter IP; for default diameter W, use IP = 0.</span>
    <span style="color:#75715e">%   The units of W, H and IP are 1/72 of the PlotBox diagonal.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ALPHA (default = 1) is a vector of FaceAlpha values ranging between</span>
    <span style="color:#75715e">%   0 (clear) and 1 (opaque).  FaceAlpha is a surface (arrowhead and</span>
            <span style="color:#75715e">%   initial point marker) property and does not affect lines.  FaceAlpha</span>
    <span style="color:#75715e">%   is not supported for 2D rendering.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   BETA (default = 0.4) is a scalar that controls the relative</span>
    <span style="color:#75715e">%   brightness of light and dark color shades, ranging between 0 (no</span>
            <span style="color:#75715e">%   contrast) and 1 (maximum contrast).</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   Plotting lines with a single color, linestyle, and linewidth is</span>
    <span style="color:#75715e">%   faster than plotting lines with multiple colors and/or linestyles.</span>
    <span style="color:#75715e">%   Plotting lines with multiple linewidths is slower still.  ARROW3</span>
    <span style="color:#75715e">%   chooses renderers that produce the best screen images; exported</span>
    <span style="color:#75715e">%   or printed plots may benefit from different choices.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ARROW3(P1,P2,S,W,H,&#39;cone&#39;,...) will plot cones with bases centered</span>
    <span style="color:#75715e">%   on P1 in the direction given by P2.  In this instance, P2 is</span>
    <span style="color:#75715e">%   interpreted as a direction vector instead of a terminal point.</span>
    <span style="color:#75715e">%   Neither initial point markers nor lines are plotted with the &#39;cone&#39;</span>
    <span style="color:#75715e">%   option.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   HN = ARROW3(P1,P2,...) returns a vector of handles to line and</span>
    <span style="color:#75715e">%   surface objects created by ARROW3.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ARROW3 COLORS will plot a table of named colors with default</span>
    <span style="color:#75715e">%   brightness.  ARROW3(&#39;colors&#39;,BETA) will plot a table of named</span>
    <span style="color:#75715e">%   colors with brightness BETA.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ARROW3 attempts to preserve the appearance of existing axes.  In</span>
    <span style="color:#75715e">%   particular, ARROW3 will not change XYZLim, View, or CameraViewAngle.</span>
    <span style="color:#75715e">%   ARROW3 does not, however, support stretch-to-fill scaling.  AXIS</span>
    <span style="color:#75715e">%   NORMAL will restore the current axis box to full size and remove any</span>
    <span style="color:#75715e">%   restrictions on the scaling of units, but will likely result in</span>
    <span style="color:#75715e">%   distorted arrowheads and initial point markers.  See</span>
    <span style="color:#75715e">%   (arrow3_messes_up_my_plots.html).</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   If a particular aspect ratio or variable limit is required, use</span>
    <span style="color:#75715e">%   DASPECT, PBASPECT, AXIS, or XYZLIM commands before calling ARROW3.</span>
    <span style="color:#75715e">%   Changing limits or aspect ratios after calling ARROW3 may alter the</span>
    <span style="color:#75715e">%   appearance of arrowheads and initial point markers.  ARROW3 sets</span>
    <span style="color:#75715e">%   XYZCLimMode to manual for all plots, sets DataAspectRatioMode to</span>
    <span style="color:#75715e">%   manual for linear plots, and sets PlotBoxAspectRatioMode to manual</span>
    <span style="color:#75715e">%   for log plots and 3D plots.  CameraViewAngleMode is also set to</span>
    <span style="color:#75715e">%   manual for 3D plots.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ARROW3 UPDATE will restore the appearance of arrowheads and</span>
    <span style="color:#75715e">%   initial point markers that have become corrupted by changes to</span>
    <span style="color:#75715e">%   limits or aspect ratios.  ARROW3(&#39;update&#39;,SF) will redraw initial</span>
    <span style="color:#75715e">%   point markers and arrowheads with scale factor SF.  If SF has one</span>
<span style="color:#75715e">%   element, SF scales W, H and IP.  If SF has two elements, SF(1)</span>
    <span style="color:#75715e">%   scales W and IP, and SF(2) scales H.  If SF has three elements,</span>
    <span style="color:#75715e">%   SF(1) scales W, SF(2) scales H, and SF(3) scales IP.  All sizes are</span>
    <span style="color:#75715e">%   relative to the current PlotBox diagonal.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   ARROW3 UPDATE COLORS will update the magnitude coloring of</span>
    <span style="color:#75715e">%   arrowheads, initial point markers, and lines to conform to the</span>
    <span style="color:#75715e">%   current ColorMap.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   HN = ARROW3(&#39;update&#39;,...) returns a vector of handles to updated</span>
    <span style="color:#75715e">%   objects.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   EXAMPLES:</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % 2D vectors</span>
<span style="color:#75715e">%     arrow3([0 0],[1 3])</span>
    <span style="color:#75715e">%     arrow3([0 0],[1 2],&#39;-.e&#39;)</span>
    <span style="color:#75715e">%     arrow3([0 0],[10 10],&#39;--x2&#39;,1)</span>
    <span style="color:#75715e">%     arrow3(zeros(10,2),50*rand(10,2),&#39;x&#39;,1,3)</span>
    <span style="color:#75715e">%     arrow3(zeros(10,2),[10*rand(10,1),500*rand(10,1)],&#39;u&#39;)</span>
    <span style="color:#75715e">%     arrow3(10*rand(10,2),50*rand(10,2),&#39;x&#39;,1,[],1)</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % 3D vectors</span>
<span style="color:#75715e">%     arrow3([0 0 0],[1 1 1])</span>
    <span style="color:#75715e">%     arrow3(zeros(20,3),50*rand(20,3),&#39;--x1.5&#39;,2)</span>
    <span style="color:#75715e">%     arrow3(zeros(100,3),50*rand(100,3),&#39;x&#39;,1,3)</span>
    <span style="color:#75715e">%     arrow3(zeros(10,3),[10*rand(10,1),500*rand(10,1),50*rand(10,1)],&#39;a&#39;)</span>
    <span style="color:#75715e">%     arrow3(10*rand(10,3),50*rand(10,3),&#39;x&#39;,[],[],0)</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % 3D animation</span>
    <span style="color:#75715e">%     t=(0:pi/40:8*pi)&#39;; u=cos(t); v=sin(t);</span>
    <span style="color:#75715e">%     plot3(20*t,u,v)</span>
    <span style="color:#75715e">%     axis([0,600,-1.5,1.5,-1.5,1.5])</span>
<span style="color:#75715e">%     grid on, view(35,25)</span>
    <span style="color:#75715e">%     hold on</span>
<span style="color:#75715e">%     pbaspect([1.8,1.4,1])</span>
    <span style="color:#75715e">%     arrow3(zeros(3),diag([500,1.5,1.5]),&#39;l&#39;,0.7,[],0)</span>
    <span style="color:#75715e">%     p=[20*t,u,v]; inc=4:1:length(t);</span>
    <span style="color:#75715e">%     p2=p(inc,:); p1=p(inc-1,:);</span>
    <span style="color:#75715e">%     hn=arrow3(p1(1,:),p2(1,:),&#39;0_b&#39;,0.7);</span>
    <span style="color:#75715e">%     for i=2:1:length(p1)</span>
<span style="color:#75715e">%       delete(hn)</span>
    <span style="color:#75715e">%       hn=arrow3(p1(i,:),p2(i,:),&#39;0_b&#39;,0.7);</span>
<span style="color:#75715e">%       pause(0.01)</span>
    <span style="color:#75715e">%     end</span>
    <span style="color:#75715e">%     hold off</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % Cone plot</span>
    <span style="color:#75715e">%     t=(pi/8:pi/8:2*pi)&#39;; p1=[cos(t) sin(t) t]; p2=repmat([0 0 1],16,1);</span>
    <span style="color:#75715e">%     arrow3(p1,p2,&#39;x&#39;,2,4,&#39;cone&#39;), hold on</span>
    <span style="color:#75715e">%     plot3(p1(:,1),p1(:,2),p1(:,3)), hold off</span>
    <span style="color:#75715e">%     pause % change cone size</span>
    <span style="color:#75715e">%     arrow3(&#39;update&#39;,[1,2])</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % Just for fun</span>
    <span style="color:#75715e">%     arrow3(zeros(100,3),50*rand(100,3),&#39;x&#39;,8,4,[],0.95)</span>
    <span style="color:#75715e">%     light(&#39;position&#39;,[-10 -10 -10],&#39;style&#39;,&#39;local&#39;)</span>
    <span style="color:#75715e">%     light(&#39;position&#39;,[60,60,60]), lighting gouraud</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % ColorOrder variable, color code prefixes, and Beta</span>
    <span style="color:#75715e">%     global ColorOrder, ColorOrder=&#39;^ui^e_hq^v&#39;;</span>
    <span style="color:#75715e">%     theta=[0:pi/22:pi/2]&#39;;</span>
    <span style="color:#75715e">%     arrow3(zeros(12,2),[cos(theta),sin(theta)],&#39;1.5o&#39;,1.5,[],[],[],0.5)</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % ColorOrder property, LineStyleOrder, and LineWidthOrder</span>
    <span style="color:#75715e">%     global ColorOrder, ColorOrder=[];</span>
    <span style="color:#75715e">%     set(gca,&#39;ColorOrder&#39;,[1,0,0;0,0,1;0.25,0.75,0.25;0,0,0])</span>
    <span style="color:#75715e">%     set(gca,&#39;LineStyleOrder&#39;,{&#39;-&#39;,&#39;--&#39;,&#39;-.&#39;,&#39;:&#39;})</span>
    <span style="color:#75715e">%     global LineWidthOrder, LineWidthOrder=[1,2,4,8];</span>
    <span style="color:#75715e">%     w=[1,2,3,4]; h=[4,6,4,2];</span>
    <span style="color:#75715e">%     arrow3(zeros(4,2),[10*rand(4,1),500*rand(4,1)],&#39;o*/&#39;,w,h,0)</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % Magnitude coloring</span>
    <span style="color:#75715e">%     colormap spring</span>
    <span style="color:#75715e">%     arrow3(20*randn(20,3),50*randn(20,3),&#39;|&#39;,[],[],0)</span>
    <span style="color:#75715e">%     set(gca,&#39;color&#39;,0.7*[1,1,1])</span>
    <span style="color:#75715e">%     set(gcf,&#39;color&#39;,0.5*[1,1,1]), grid on, colorbar</span>
    <span style="color:#75715e">%     pause % change the ColorMap and update colors</span>
    <span style="color:#75715e">%     colormap hot</span>
    <span style="color:#75715e">%     arrow3(&#39;update&#39;,&#39;colors&#39;)</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % LogLog plot</span>
    <span style="color:#75715e">%     set(gca,&#39;xscale&#39;,&#39;log&#39;,&#39;yscale&#39;,&#39;log&#39;);</span>
    <span style="color:#75715e">%     axis([1e2,1e8,1e-2,1e-1]); hold on</span>
    <span style="color:#75715e">%     p1=repmat([1e3,2e-2],15,1);</span>
    <span style="color:#75715e">%     q1=[1e7,1e6,1e5,1e4,1e3,1e7,1e7,1e7,1e7,1e7,1e7,1e6,1e5,1e4,1e3];</span>
    <span style="color:#75715e">%     q2=1e-2*[9,9,9,9,9,7,5,4,3,2,1,1,1,1,1]; p2=[q1&#39;,q2&#39;];</span>
    <span style="color:#75715e">%     global ColorOrder, ColorOrder=[];</span>
    <span style="color:#75715e">%     set(gca,&#39;ColorOrder&#39;,rand(15,3))</span>
    <span style="color:#75715e">%     arrow3(p1,p2,&#39;o&#39;), grid on, hold off</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % SemiLogX plot</span>
    <span style="color:#75715e">%     set(gca,&#39;xscale&#39;,&#39;log&#39;,&#39;yscale&#39;,&#39;linear&#39;);</span>
    <span style="color:#75715e">%     axis([1e2,1e8,1e-2,1e-1]); hold on</span>
    <span style="color:#75715e">%     p1=repmat([1e3,0.05],15,1);</span>
    <span style="color:#75715e">%     q1=[1e7,1e6,1e5,1e4,1e3,1e7,1e7,1e7,1e7,1e7,1e7,1e6,1e5,1e4,1e3];</span>
    <span style="color:#75715e">%     q2=1e-2*[9,9,9,9,9,7,5,4,3,2,1,1,1,1,1]; p2=[q1&#39;,q2&#39;];</span>
    <span style="color:#75715e">%     arrow3(p1,p2,&#39;x&#39;), grid on, hold off</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % SemiLogY plot</span>
    <span style="color:#75715e">%     set(gca,&#39;xscale&#39;,&#39;linear&#39;,&#39;yscale&#39;,&#39;log&#39;);</span>
    <span style="color:#75715e">%     axis([2,8,1e-2,1e-1]); hold on</span>
    <span style="color:#75715e">%     p1=repmat([3,2e-2],17,1);</span>
    <span style="color:#75715e">%     q1=[7,6,5,4,3,7,7,7,7,7,7,7,7,6,5,4,3];</span>
    <span style="color:#75715e">%     q2=1e-2*[9,9,9,9,9,8,7,6,5,4,3,2,1,1,1,1,1]; p2=[q1&#39;,q2&#39;];</span>
    <span style="color:#75715e">%     set(gca,&#39;LineStyleOrder&#39;,{&#39;-&#39;,&#39;--&#39;,&#39;-.&#39;,&#39;:&#39;})</span>
    <span style="color:#75715e">%     arrow3(p1,p2,&#39;*&#39;,1,[],0), grid on, hold off</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % Color tables</span>
    <span style="color:#75715e">%     arrow3(&#39;colors&#39;)           % default color table</span>
    <span style="color:#75715e">%     arrow3(&#39;colors&#39;,0.3)       % low contrast color table</span>
    <span style="color:#75715e">%     arrow3(&#39;colors&#39;,0.5)       % high contrast color table</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     % Update initial point markers and arrowheads</span>
    <span style="color:#75715e">%     % relative to the current PlotBox diagonal</span>
    <span style="color:#75715e">%     arrow3(&#39;update&#39;)           % redraw same size</span>
    <span style="color:#75715e">%     arrow3(&#39;update&#39;,2)         % redraw double size</span>
    <span style="color:#75715e">%     arrow3(&#39;update&#39;,0.5)       % redraw half size</span>
    <span style="color:#75715e">%     arrow3(&#39;update&#39;,[0.5,2,1]) % redraw W half size,</span>
    <span style="color:#75715e">%                                %        H double size, and</span>
    <span style="color:#75715e">%                                %        IP same size</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     See also (arrow3_examples.html), (arrow3_messes_up_my_plots.html).</span>

    <span style="color:#75715e">%   Copyright(c)2002-2011 Version 5.14</span>
<span style="color:#75715e">%     Tom Davis (tdavis@metzgerwillard.com)</span>
    <span style="color:#75715e">%     Jeff Chang</span>

    <span style="color:#75715e">%   Revision History:</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%     07/27/11 - Added animation example. (TD)</span>
    <span style="color:#75715e">%     05/13/09 - Corrected spelling errors (TD)</span>
    <span style="color:#75715e">%     03/16/08 - Updated contact information (TD)</span>
<span style="color:#75715e">%     10/23/07 - Corrected zero magnitude exclusion (TD)</span>
    <span style="color:#75715e">%     09/08/07 - Added cone plot option; removed adaptive grid</span>
    <span style="color:#75715e">%                spacing; corrected scale factor; removed &#34;nearly&#34;</span>
    <span style="color:#75715e">%                tight limits (TD)</span>
<span style="color:#75715e">%     07/24/07 - Ignore zero-magnitude input (TD)</span>
    <span style="color:#75715e">%     07/08/07 - Modified named colors to match named Simulink</span>
    <span style="color:#75715e">%                colors; added light and dark shades for basic</span>
<span style="color:#75715e">%                colors (ymcrgb) (TD)</span>
    <span style="color:#75715e">%     07/01/07 - Modified named colors to match default ColorOrder</span>
    <span style="color:#75715e">%                colors (TD)</span>
    <span style="color:#75715e">%     06/24/07 - Error checking for empty P1, P2 (TD)</span>
    <span style="color:#75715e">%     06/17/07 - Trim colors,W,H,IP,ALPHA to LENGTH(P1) (TD)</span>
    <span style="color:#75715e">%     05/27/07 - Magnitude coloring and documentation revision (TD)</span>
<span style="color:#75715e">%     03/10/07 - Improved code metrics (TD)</span>
    <span style="color:#75715e">%     02/21/07 - Preserve existing axis appearance;</span>
    <span style="color:#75715e">%                use relative sizes for W, H, and IP;</span>
    <span style="color:#75715e">%                removed version checking; minor bug fixes (TD) </span>
    <span style="color:#75715e">%     01/09/04 - Replaced calls to LINSPACE, INTERP1, and</span>
<span style="color:#75715e">%                COLORMAP (TD)</span>
    <span style="color:#75715e">%     12/17/03 - Semilog examples, CAXIS support, magnitude</span>
    <span style="color:#75715e">%                coloring, and color updating; use CData instead</span>
    <span style="color:#75715e">%                of FaceColor; minor bug fixes (TD)</span>
    <span style="color:#75715e">%     07/17/03 - Changed 2D rendering from OpenGL to ZBuffer;</span>
<span style="color:#75715e">%                defined HN for COLORS and UPDATE options (TD)</span>
    <span style="color:#75715e">%     02/27/03 - Replaced calls to RANDPERM, VIEW, REPMAT, SPHERE,</span>
    <span style="color:#75715e">%                and CYLINDER; added ZBuffer for log plots, RESET</span>
<span style="color:#75715e">%                for CLA and CLF, and ABS for W and H (TD)</span>
    <span style="color:#75715e">%     02/01/03 - Added UPDATE scale factor and MATLAB version</span>
    <span style="color:#75715e">%                checking, replaced call to CROSS (TD)</span>
<span style="color:#75715e">%     12/26/02 - Added UserData and UPDATE option (TD)</span>
    <span style="color:#75715e">%     11/16/02 - Added more named colors, color code prefix,</span>
    <span style="color:#75715e">%                global ColorOrder, ALPHA , and BETA (TD)</span>
    <span style="color:#75715e">%     10/12/02 - Added global LineWidthOrder,</span>
    <span style="color:#75715e">%                vectorized W, H and IP (TD)</span>
    <span style="color:#75715e">%     10/05/02 - Changed CLF to CLA for subplot support,</span>
    <span style="color:#75715e">%                added ColorOrder and LineStyleOrder support (TD)</span>
    <span style="color:#75715e">%     04/27/02 - Minor log plot revisions (TD)</span>
<span style="color:#75715e">%     03/26/02 - Added log plot support (TD)</span>
    <span style="color:#75715e">%     03/24/02 - Adaptive grid spacing control to trade off</span>
<span style="color:#75715e">%                appearance vs. speed based on size of matrix (JC)</span>
    <span style="color:#75715e">%     03/16/02 - Added &#34;axis tight&#34; for improved appearance (JC)</span>
    <span style="color:#75715e">%     03/12/02 - Added initial point marker (TD)</span>
<span style="color:#75715e">%     03/03/02 - Added aspect ratio support (TD)</span>
    <span style="color:#75715e">%     03/02/02 - Enhanced program&#39;s user friendliness (JC)</span>
    <span style="color:#75715e">%                (lump Color, LineStyle, and LineWidth together)</span>
<span style="color:#75715e">%     03/01/02 - Replaced call to ROTATE (TD)</span>
    <span style="color:#75715e">%     02/28/02 - Modified line plotting,</span>
    <span style="color:#75715e">%                added linewidth and linestyle (TD)</span>
    <span style="color:#75715e">%     02/27/02 - Minor enhancements on 3D appearance (JC)</span>
    <span style="color:#75715e">%     02/26/02 - Minor enhancements for speed (TD&amp;JC)</span>
<span style="color:#75715e">%     02/26/02 - Optimize PLOT3 and SURF for speed (TD)</span>
    <span style="color:#75715e">%     02/25/02 - Return handler, error handling, color effect,</span>
    <span style="color:#75715e">%                generalize for 2D/3D vectors (JC)</span>
    <span style="color:#75715e">%     02/24/02 - Optimize PLOT3 and SURF for speed (TD)</span>
<span style="color:#75715e">%     02/23/02 - First release (JC&amp;TD)</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Error Checking</span>
    <span style="color:#66d9ef">global</span> LineWidthOrder ColorOrder
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">||</span> isempty(beta), beta=<span style="color:#ae81ff">0.4</span>; <span style="color:#66d9ef">end</span>
    beta=abs(beta(<span style="color:#ae81ff">1</span>)); <span style="color:#66d9ef">if</span> nargout, hn=[]; <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> strcmpi(p1,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">colors&#39;</span>)                            <span style="color:#75715e">% plot color table</span>
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>, beta=abs(p2(<span style="color:#ae81ff">1</span>)); <span style="color:#66d9ef">end</span>
    LocalColorTable(<span style="color:#ae81ff">1</span>,beta); <span style="color:#66d9ef">return</span>
    <span style="color:#66d9ef">end</span>
    fig=gcf; ax=gca;
    <span style="color:#66d9ef">if</span> strcmpi(p1,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">update&#39;</span>), ud=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">UserData&#39;</span>);    <span style="color:#75715e">% update</span>
    LocalLogCheck(ax);
    <span style="color:#66d9ef">if</span> size(ud,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">13</span>, error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Invalid UserData&#39;</span>), <span style="color:#66d9ef">end</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">UserData&#39;</span>,[]); sf=[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]; flag=<span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">if</span> strcmpi(p2,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">colors&#39;</span>), flag=<span style="color:#ae81ff">1</span>;               <span style="color:#75715e">% update colors</span>
    <span style="color:#66d9ef">elseif</span> <span style="color:#f92672">~</span>isempty(p2)                            <span style="color:#75715e">% update surfaces</span>
    sf=p2(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>sf; n=length(p2(:));
    <span style="color:#66d9ef">if</span> n<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>, sf(<span style="color:#ae81ff">2</span>)=p2(<span style="color:#ae81ff">2</span>); <span style="color:#66d9ef">if</span> n<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span>, sf(<span style="color:#ae81ff">3</span>)=p2(<span style="color:#ae81ff">3</span>); <span style="color:#66d9ef">end</span>, <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    H=LocalUpdate(fig,ax,ud,sf,flag); <span style="color:#66d9ef">if</span> nargout, hn=H; <span style="color:#66d9ef">end</span>, <span style="color:#66d9ef">return</span>
    <span style="color:#66d9ef">end</span>
    InputError=[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Invalid input, type HELP &#39;</span>,upper(mfilename),<span style="color:#75715e">...</span>
    <span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> for usage examples&#39;</span>];
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">2</span>, error(InputError), <span style="color:#66d9ef">end</span>
    [r1,c1]=size(p1); [r2,c2]=size(p2);
    <span style="color:#66d9ef">if</span> c1<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">||</span> c1<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">||</span> r1<span style="color:#f92672">*</span>r2<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>, error(InputError), <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> r1<span style="color:#f92672">~=</span>r2, error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">P1 and P2 must have same number of rows&#39;</span>), <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> c1<span style="color:#f92672">~=</span>c2, error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">P1 and P2 must have same number of columns&#39;</span>), <span style="color:#66d9ef">end</span>
    p=sum(abs(p2<span style="color:#f92672">-</span>p1),<span style="color:#ae81ff">2</span>)<span style="color:#f92672">~=</span><span style="color:#ae81ff">0</span>; cone=<span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">~</span>isempty(ip) <span style="color:#f92672">&amp;&amp;</span> strcmpi(ip,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">cone&#39;</span>)  <span style="color:#75715e">% cone plot</span>
    cone=<span style="color:#ae81ff">1</span>; p=sum(p2,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">~=</span><span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>any(p), error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">P2 cannot equal 0&#39;</span>), <span style="color:#66d9ef">end</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tag&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3ConePlot&#39;</span>);
    <span style="color:#66d9ef">elseif</span> <span style="color:#f92672">~</span>any(p), error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">P1 cannot equal P2&#39;</span>)
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>all(p)
    warning(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3:ZeroMagnitude&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Zero magnitude ignored&#39;</span>)
    p1=p1(p,:); p2=p2(p,:); [r1,c1]=size(p1);
    <span style="color:#66d9ef">end</span>
    n=r1; Zeros=zeros(n,<span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">if</span> c1<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>, p1=[p1,Zeros]; p2=[p2,Zeros];
    <span style="color:#66d9ef">elseif</span> <span style="color:#f92672">~</span>any([p1(:,<span style="color:#ae81ff">3</span>);p2(:,<span style="color:#ae81ff">3</span>)]), c1=<span style="color:#ae81ff">2</span>; <span style="color:#66d9ef">end</span>
    L=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">LineStyleOrder&#39;</span>); C=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ColorOrder&#39;</span>);
    ST=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultSurfaceTag&#39;</span>); LT=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultLineTag&#39;</span>);
    EC=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultSurfaceEdgeColor&#39;</span>);
    <span style="color:#66d9ef">if</span> strcmp(get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">add&#39;</span>) <span style="color:#f92672">&amp;&amp;</span> strcmp(get(fig,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">add&#39;</span>)
    Xr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">xlim&#39;</span>); Yr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ylim&#39;</span>); Zr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">zlim&#39;</span>);
    [xs,ys,xys]=LocalLogCheck(ax); restore=<span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">if</span> xys, mode=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">auto&#39;</span>;
    <span style="color:#66d9ef">if</span> any([p1(:,<span style="color:#ae81ff">3</span>);p2(:,<span style="color:#ae81ff">3</span>)]), error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">3D log plot not supported&#39;</span>), <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> (xs <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">~</span>all([p1(:,<span style="color:#ae81ff">1</span>);p2(:,<span style="color:#ae81ff">1</span>)]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>)) <span style="color:#f92672">||</span> <span style="color:#75715e">...</span>
    (ys <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">~</span>all([p1(:,<span style="color:#ae81ff">2</span>);p2(:,<span style="color:#ae81ff">2</span>)]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>))
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Nonpositive log data not supported&#39;</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">else</span> mode=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">manual&#39;</span>;
    <span style="color:#66d9ef">if</span> strcmp(get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">WarpToFill&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">on&#39;</span>)
    warning(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3:WarpToFill&#39;</span>,[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Stretch-to-fill scaling not &#39;</span>,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">supported;\nuse DASPECT or PBASPECT before calling ARROW3.&#39;</span>]);
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">XLimMode&#39;</span>,mode,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">YLimMode&#39;</span>,mode,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ZLimMode&#39;</span>,mode,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">CLimMode&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">manual&#39;</span>);
    <span style="color:#66d9ef">else</span> restore=<span style="color:#ae81ff">0</span>; cla reset; xys=<span style="color:#ae81ff">0</span>; set(fig,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">add&#39;</span>);
    <span style="color:#66d9ef">if</span> c1<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>, azel=[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">90</span>]; <span style="color:#66d9ef">else</span> azel=[<span style="color:#f92672">-</span><span style="color:#ae81ff">37.5</span>,<span style="color:#ae81ff">30</span>]; <span style="color:#66d9ef">end</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">UserData&#39;</span>,[],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">add&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">View&#39;</span>,azel);
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Style Control</span>
    [vc,cn]=LocalColorTable(<span style="color:#ae81ff">0</span>); prefix=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>; OneColor=<span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">3</span>, [c,ls,lw]=LocalValidateCLSW;<span style="color:#75715e">% default color, linestyle/width</span>
    <span style="color:#66d9ef">else</span> 
    [c,ls,lw]=LocalValidateCLSW(s);
    <span style="color:#66d9ef">if</span> length(c)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">if</span> sum(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_^&#39;</span><span style="color:#f92672">==</span>c(<span style="color:#ae81ff">1</span>)), prefix=c(<span style="color:#ae81ff">1</span>); <span style="color:#66d9ef">end</span>, c=c(<span style="color:#ae81ff">2</span>); <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> c<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">x&#39;</span>                              <span style="color:#75715e">% random named color (less white)</span>
    [ignore,i]=sort(rand(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">23</span>)); c=cn(i,:);        <span style="color:#75715e">%#ok</span>
    <span style="color:#66d9ef">elseif</span> c<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">o&#39;</span>                                    <span style="color:#75715e">% ColorOrder</span>
<span style="color:#66d9ef">if</span> length(ColorOrder)
    [c,failed]=LocalColorMap(lower(ColorOrder),vc,cn,beta);
    <span style="color:#66d9ef">if</span> failed, ColorOrderWarning=[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Invalid ColorOrder &#39;</span>,<span style="color:#75715e">...</span>
    <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">variable, current ColorOrder property will be used&#39;</span>];
    warning(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3:ColorOrder&#39;</span>,ColorOrderWarning)
    <span style="color:#66d9ef">else</span> C=c;
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>, c=C;
    <span style="color:#66d9ef">elseif</span> c<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">|&#39;</span>, map=get(fig,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">colormap&#39;</span>);          <span style="color:#75715e">% magnitude coloring</span>
    M=(p1<span style="color:#f92672">-</span>p2); M=sqrt(sum(M<span style="color:#f92672">.*</span>M,<span style="color:#ae81ff">2</span>)); minM=min(M); maxM=max(M);
    <span style="color:#66d9ef">if</span> maxM<span style="color:#f92672">-</span>minM<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">1</span>, minM=<span style="color:#ae81ff">0</span>; <span style="color:#66d9ef">end</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">clim&#39;</span>,[minM,maxM]); c=LocalInterp(minM,maxM,map,M);
    <span style="color:#66d9ef">elseif</span> <span style="color:#f92672">~</span>sum(vc<span style="color:#f92672">==</span>c), c=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">k&#39;</span>; ColorWarning=[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Invalid color switch, &#39;</span>,<span style="color:#75715e">...</span>
    <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">default color (black) will be used&#39;</span>];
    warning(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3:Color&#39;</span>,ColorWarning)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> length(c)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>                                    <span style="color:#75715e">% single color</span>
    c=LocalColorMap([prefix,c],vc,cn,beta); OneColor=<span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">end</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ColorOrder&#39;</span>,c); c=LocalRepmat(c,[ceil(n<span style="color:#f92672">/</span>size(c,<span style="color:#ae81ff">1</span>)),<span style="color:#ae81ff">1</span>]);
    <span style="color:#66d9ef">if</span> ls<span style="color:#f92672">~=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">*&#39;</span>, set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">LineStyleOrder&#39;</span>,ls); <span style="color:#66d9ef">end</span>       <span style="color:#75715e">% LineStyleOrder</span>
    <span style="color:#66d9ef">if</span> lw<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/&#39;</span>                                         <span style="color:#75715e">% LineWidthOrder</span>
<span style="color:#66d9ef">if</span> length(LineWidthOrder)
    lw=LocalRepmat(LineWidthOrder(:),[ceil(n<span style="color:#f92672">/</span>length(LineWidthOrder)),<span style="color:#ae81ff">1</span>]);
    <span style="color:#66d9ef">else</span> lw=<span style="color:#ae81ff">0.5</span>; LineWidthOrderWarning=[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Undefined LineWidthOrder, &#39;</span>,<span style="color:#75715e">...</span>
    <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">default width (0.5) will be used&#39;</span>];
    warning(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3:LineWidthOrder&#39;</span>,LineWidthOrderWarning)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4</span> <span style="color:#f92672">||</span> isempty(w), w=<span style="color:#ae81ff">1</span>; <span style="color:#66d9ef">end</span>                <span style="color:#75715e">% width</span>
    w=LocalRepmat(abs(w(:)),[ceil(n<span style="color:#f92672">/</span>length(w)),<span style="color:#ae81ff">1</span>]);
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">||</span> isempty(h), h=<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>w; <span style="color:#66d9ef">end</span>              <span style="color:#75715e">% height</span>
    h=LocalRepmat(abs(h(:)),[ceil(n<span style="color:#f92672">/</span>length(h)),<span style="color:#ae81ff">1</span>]);
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">~</span>isempty(ip) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">~</span>cone               <span style="color:#75715e">% ip</span>
    ip=LocalRepmat(ip(:),[ceil(n<span style="color:#f92672">/</span>length(ip)),<span style="color:#ae81ff">1</span>]);
    i=find(ip<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>); ip(i)=w(i);
    <span style="color:#66d9ef">else</span> ip=<span style="color:#f92672">-</span>ones(n,<span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">7</span> <span style="color:#f92672">||</span> isempty(alpha), alpha=<span style="color:#ae81ff">1</span>; <span style="color:#66d9ef">end</span>
    a=LocalRepmat(alpha(:),[ceil(n<span style="color:#f92672">/</span>length(alpha)),<span style="color:#ae81ff">1</span>]); <span style="color:#75715e">% FaceAlpha</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Log Plot</span>
    <span style="color:#66d9ef">if</span> xys
    units=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">units&#39;</span>); set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">units&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">points&#39;</span>);
    pos=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">position&#39;</span>); set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">units&#39;</span>,units);
    <span style="color:#66d9ef">if</span> strcmp(get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PlotBoxAspectRatioMode&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">auto&#39;</span>)
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PlotBoxAspectRatio&#39;</span>,[pos(<span style="color:#ae81ff">3</span>),pos(<span style="color:#ae81ff">4</span>),<span style="color:#ae81ff">1</span>]);
    <span style="color:#66d9ef">end</span>
    par=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PlotBoxAspectRatio&#39;</span>);
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DataAspectRatio&#39;</span>,[par(<span style="color:#ae81ff">2</span>),par(<span style="color:#ae81ff">1</span>),par(<span style="color:#ae81ff">3</span>)]);
    <span style="color:#75715e">% map coordinates onto unit square</span>
    q=[p1;p2]; xr=Xr; yr=Yr;
    <span style="color:#66d9ef">if</span> xs, xr=log10(xr); q(:,<span style="color:#ae81ff">1</span>)=log10(q(:,<span style="color:#ae81ff">1</span>)); <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> ys, yr=log10(yr); q(:,<span style="color:#ae81ff">2</span>)=log10(q(:,<span style="color:#ae81ff">2</span>)); <span style="color:#66d9ef">end</span>
    q=q<span style="color:#f92672">-</span>LocalRepmat([xr(<span style="color:#ae81ff">1</span>),yr(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">0</span>],[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n,<span style="color:#ae81ff">1</span>]);
    dx=xr(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">-</span>xr(<span style="color:#ae81ff">1</span>); dy=yr(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">-</span>yr(<span style="color:#ae81ff">1</span>);
    q=q<span style="color:#f92672">*</span>diag([<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>dx,<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>dy,<span style="color:#ae81ff">1</span>]);
    q1=q(<span style="color:#ae81ff">1</span>:n,:); q2=q(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:<span style="color:#66d9ef">end</span>,:);
    <span style="color:#66d9ef">else</span> xs=<span style="color:#ae81ff">0</span>; ys=<span style="color:#ae81ff">0</span>; dx=<span style="color:#ae81ff">0</span>; dy=<span style="color:#ae81ff">0</span>; xr=<span style="color:#ae81ff">0</span>; yr=<span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Line</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>cone
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultLineTag&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">arrow3&#39;</span>);
    <span style="color:#66d9ef">if</span> length(lw)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">if</span> lw<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">if</span> OneColor <span style="color:#f92672">&amp;&amp;</span> ls(<span style="color:#66d9ef">end</span>)<span style="color:#f92672">~=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">*&#39;</span> <span style="color:#f92672">&amp;&amp;</span> n<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span> <span style="color:#75715e">% single color, linestyle/width</span>
    P=zeros(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>n,<span style="color:#ae81ff">3</span>); i=<span style="color:#ae81ff">1</span>:n;
    P(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>i<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>,:)=p1(i,:); P(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,:)=p2(i,:); P(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>i,<span style="color:#ae81ff">1</span>)=NaN;
    H1=plot3(P(:,<span style="color:#ae81ff">1</span>),P(:,<span style="color:#ae81ff">2</span>),P(:,<span style="color:#ae81ff">3</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">LineWidth&#39;</span>,lw);
    <span style="color:#66d9ef">else</span>                               <span style="color:#75715e">% single linewidth</span>
    H1=plot3([p1(:,<span style="color:#ae81ff">1</span>),p2(:,<span style="color:#ae81ff">1</span>)]<span style="color:#f92672">&#39;</span>,[p1(:,<span style="color:#ae81ff">2</span>),p2(:,<span style="color:#ae81ff">2</span>)]<span style="color:#f92672">&#39;</span>,<span style="color:#75715e">...</span>
            [p1(:,<span style="color:#ae81ff">3</span>),p2(:,<span style="color:#ae81ff">3</span>)]<span style="color:#f92672">&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">LineWidth&#39;</span>,lw);
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">else</span> H1=[];
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">else</span>                                   <span style="color:#75715e">% use LineWidthOrder</span>
    ls=LocalRepmat(cellstr(L),[ceil(n<span style="color:#f92672">/</span>size(L,<span style="color:#ae81ff">1</span>)),<span style="color:#ae81ff">1</span>]);
    H1=Zeros;
    <span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:n
    H1(i)=plot3([p1(i,<span style="color:#ae81ff">1</span>),p2(i,<span style="color:#ae81ff">1</span>)],[p1(i,<span style="color:#ae81ff">2</span>),p2(i,<span style="color:#ae81ff">2</span>)],<span style="color:#75715e">...</span>
            [p1(i,<span style="color:#ae81ff">3</span>),p2(i,<span style="color:#ae81ff">3</span>)],ls{i},<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Color&#39;</span>,c(i,:),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">LineWidth&#39;</span>,lw(i));
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">else</span>                                     <span style="color:#75715e">% cone plot</span>
    P=zeros(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>n,<span style="color:#ae81ff">3</span>); i=<span style="color:#ae81ff">1</span>:n;
    P(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>i<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>,:)=p1(i,:); P(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,:)=p1(i,:); P(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>i,<span style="color:#ae81ff">1</span>)=NaN;
    H1=plot3(P(:,<span style="color:#ae81ff">1</span>),P(:,<span style="color:#ae81ff">2</span>),P(:,<span style="color:#ae81ff">3</span>));
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Scale</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>restore, axis tight, <span style="color:#66d9ef">end</span>
    ar=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DataAspectRatio&#39;</span>); ar=sqrt(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>ar<span style="color:#f92672">/</span>norm(ar);
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DataAspectRatioMode&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">manual&#39;</span>);
    <span style="color:#66d9ef">if</span> xys, sf=<span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">else</span> xr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">xlim&#39;</span>); yr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ylim&#39;</span>); zr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">zlim&#39;</span>);
    sf=norm(diff([xr;yr;zr],<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">./</span>ar<span style="color:#f92672">&#39;</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">72</span>;
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% UserData</span>
    c=c(<span style="color:#ae81ff">1</span>:n,:); w=w(<span style="color:#ae81ff">1</span>:n); h=h(<span style="color:#ae81ff">1</span>:n); ip=ip(<span style="color:#ae81ff">1</span>:n); a=a(<span style="color:#ae81ff">1</span>:n);
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">UserData&#39;</span>,[get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">UserData&#39;</span>);p1,p2,c,w,h,ip,a]);

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Arrowhead</span>
    whip=sf<span style="color:#f92672">*</span>[w,h,ip];
    <span style="color:#66d9ef">if</span> xys, whip=whip<span style="color:#f92672">*</span>sqrt(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">72</span>; p1=q1; p2=q2; <span style="color:#66d9ef">end</span>
    w=whip(:,<span style="color:#ae81ff">1</span>); h=whip(:,<span style="color:#ae81ff">2</span>); ip=whip(:,<span style="color:#ae81ff">3</span>);
    <span style="color:#66d9ef">if</span> cone                                            <span style="color:#75715e">% cone plot</span>
    delete(H1), H1=[];
    p2=p2<span style="color:#f92672">./</span>LocalRepmat(sqrt(sum(p2<span style="color:#f92672">.*</span>p2,<span style="color:#ae81ff">2</span>)),[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>]);
    p2=p1<span style="color:#f92672">+</span>p2<span style="color:#f92672">.*</span>LocalRepmat(ar,[n,<span style="color:#ae81ff">1</span>])<span style="color:#f92672">.*</span>LocalRepmat(h,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>]);
    <span style="color:#66d9ef">end</span>
    W=(p1<span style="color:#f92672">-</span>p2)<span style="color:#f92672">./</span>LocalRepmat(ar,[n,<span style="color:#ae81ff">1</span>]);
    W=W<span style="color:#f92672">./</span>LocalRepmat(sqrt(sum(W<span style="color:#f92672">.*</span>W,<span style="color:#ae81ff">2</span>)),[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>]);         <span style="color:#75715e">% new z direction</span>
    U=[<span style="color:#f92672">-</span>W(:,<span style="color:#ae81ff">2</span>),W(:,<span style="color:#ae81ff">1</span>),Zeros];
    N=sqrt(sum(U<span style="color:#f92672">.*</span>U,<span style="color:#ae81ff">2</span>)); i=find(N<span style="color:#f92672">&lt;</span>eps); j=length(i);
    U(i,:)=LocalRepmat([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],[j,<span style="color:#ae81ff">1</span>]); N(i)=ones(j,<span style="color:#ae81ff">1</span>);
    U=U<span style="color:#f92672">./</span>LocalRepmat(N,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>]);                         <span style="color:#75715e">% new x direction</span>
    V=[W(:,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">.*</span>U(:,<span style="color:#ae81ff">3</span>)<span style="color:#f92672">-</span>W(:,<span style="color:#ae81ff">3</span>)<span style="color:#f92672">.*</span>U(:,<span style="color:#ae81ff">2</span>),<span style="color:#75715e">...               % new y direction</span>
    W(:,<span style="color:#ae81ff">3</span>)<span style="color:#f92672">.*</span>U(:,<span style="color:#ae81ff">1</span>)<span style="color:#f92672">-</span>W(:,<span style="color:#ae81ff">1</span>)<span style="color:#f92672">.*</span>U(:,<span style="color:#ae81ff">3</span>),<span style="color:#75715e">...</span>
    W(:,<span style="color:#ae81ff">1</span>)<span style="color:#f92672">.*</span>U(:,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">-</span>W(:,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">.*</span>U(:,<span style="color:#ae81ff">1</span>)];

    m=<span style="color:#ae81ff">20</span>;                               <span style="color:#75715e">% surface grid spacing</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultSurfaceTag&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">arrow3&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultSurfaceEdgeColor&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">none&#39;</span>);
    r=[<span style="color:#ae81ff">0</span>;<span style="color:#ae81ff">1</span>]; theta=(<span style="color:#ae81ff">0</span>:m)<span style="color:#f92672">/</span>m<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>pi; Ones=ones(<span style="color:#ae81ff">1</span>,m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
    x=r<span style="color:#f92672">*</span>cos(theta); y=r<span style="color:#f92672">*</span>sin(theta); z=r<span style="color:#f92672">*</span>Ones;
    G=surface(x<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>,y<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>,z); dar=diag(ar);
    X=get(G,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">XData&#39;</span>); Y=get(G,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">YData&#39;</span>); Z=get(G,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ZData&#39;</span>);
    H2=Zeros; [j,k]=size(X);
    <span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:n                           <span style="color:#75715e">% translate, rotate, and scale</span>
    H2(i)=copyobj(G,ax);
    xyz=[w(i)<span style="color:#f92672">*</span>X(:),w(i)<span style="color:#f92672">*</span>Y(:),h(i)<span style="color:#f92672">*</span>Z(:)]<span style="color:#f92672">*</span>[U(i,:);V(i,:);W(i,:)]<span style="color:#f92672">*</span>dar;
    x=reshape(xyz(:,<span style="color:#ae81ff">1</span>),j,k)<span style="color:#f92672">+</span>p2(i,<span style="color:#ae81ff">1</span>);
    y=reshape(xyz(:,<span style="color:#ae81ff">2</span>),j,k)<span style="color:#f92672">+</span>p2(i,<span style="color:#ae81ff">2</span>);
    z=reshape(xyz(:,<span style="color:#ae81ff">3</span>),j,k)<span style="color:#f92672">+</span>p2(i,<span style="color:#ae81ff">3</span>);
    LocalSetSurface(xys,xs,ys,dx,dy,xr,yr,<span style="color:#75715e">...</span>
            x,y,z,a(i),c(i,:),H2(i),<span style="color:#ae81ff">2</span>,m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">end</span>
    delete(G);

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Initial Point Marker</span>
<span style="color:#66d9ef">if</span> any(ip<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>)
    theta=(<span style="color:#f92672">-</span>m:<span style="color:#ae81ff">2</span>:m)<span style="color:#f92672">/</span>m<span style="color:#f92672">*</span>pi; phi=(<span style="color:#f92672">-</span>m:<span style="color:#ae81ff">2</span>:m)<span style="color:#f92672">&#39;</span><span style="color:#f92672">/</span>m<span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>; cosphi=cos(phi);
    x=cosphi<span style="color:#f92672">*</span>cos(theta); y=cosphi<span style="color:#f92672">*</span>sin(theta); z=sin(phi)<span style="color:#f92672">*</span>Ones;
    G=surface(x<span style="color:#f92672">*</span>ar(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>,y<span style="color:#f92672">*</span>ar(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>,z<span style="color:#f92672">*</span>ar(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>);
    X=get(G,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">XData&#39;</span>); Y=get(G,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">YData&#39;</span>); Z=get(G,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ZData&#39;</span>);
    H3=zeros(n,<span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:n                                        <span style="color:#75715e">% translate</span>
    <span style="color:#66d9ef">if</span> ip(i)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>
    H3(i)=copyobj(G,ax);
    x=p1(i,<span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span>X<span style="color:#f92672">*</span>ip(i); y=p1(i,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">+</span>Y<span style="color:#f92672">*</span>ip(i); z=p1(i,<span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>Z<span style="color:#f92672">*</span>ip(i);
    LocalSetSurface(xys,xs,ys,dx,dy,xr,yr,<span style="color:#75715e">...</span>
            x,y,z,a(i),c(i,:),H3(i),m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>, delete(G);
    <span style="color:#66d9ef">else</span> H3=[];
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Finish</span>
    <span style="color:#66d9ef">if</span> restore, xr=Xr; yr=Yr; zr=Zr;
    <span style="color:#66d9ef">if</span> xys, set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DataAspectRatioMode&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">auto&#39;</span>); <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">else</span>
    axis tight
    xr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">xlim&#39;</span>); yr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ylim&#39;</span>); zr=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">zlim&#39;</span>);
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">replace&#39;</span>);
    <span style="color:#66d9ef">end</span>
    azel=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">view&#39;</span>);
    <span style="color:#66d9ef">if</span> abs(azel(<span style="color:#ae81ff">2</span>))<span style="color:#f92672">==</span><span style="color:#ae81ff">90</span>, renderer=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ZBuffer&#39;</span>; <span style="color:#66d9ef">else</span> renderer=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">OpenGL&#39;</span>; c1=<span style="color:#ae81ff">3</span>; <span style="color:#66d9ef">end</span>
    set(fig,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Renderer&#39;</span>,renderer);
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">LineStyleOrder&#39;</span>,L,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ColorOrder&#39;</span>,C,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultLineTag&#39;</span>,LT,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultSurfaceTag&#39;</span>,ST,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultSurfaceEdgeColor&#39;</span>,EC,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">xlim&#39;</span>,xr,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ylim&#39;</span>,yr,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">zlim&#39;</span>,zr,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">clim&#39;</span>,get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">CLim&#39;</span>));
    <span style="color:#66d9ef">if</span> c1<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span>, set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">CameraViewAngle&#39;</span>,get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">CameraViewAngle&#39;</span>),<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PlotBoxAspectRatio&#39;</span>,get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PlotBoxAspectRatio&#39;</span>));
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> nargout, hn=[H1(:);H2(:);H3(:)]; <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Local Functions</span>
    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Update</span>
<span style="color:#66d9ef">function</span> H=<span style="color:#a6e22e">LocalUpdate</span>(fig,ax,ud,sf,flag)
    <span style="color:#66d9ef">global</span> ColorOrder
    p1=ud(:,<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>); p2=ud(:,<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">6</span>); c=ud(:,<span style="color:#ae81ff">7</span>:<span style="color:#ae81ff">9</span>); a=ud(:,<span style="color:#ae81ff">13</span>);
    w=sf(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>ud(:,<span style="color:#ae81ff">10</span>); h=sf(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>ud(:,<span style="color:#ae81ff">11</span>); ip=sf(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">*</span>ud(:,<span style="color:#ae81ff">12</span>);
    H=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">children&#39;</span>); tag=get(H,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tag&#39;</span>); type=get(H,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">type&#39;</span>);
    delete(H(strcmp(tag,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">arrow3&#39;</span>) <span style="color:#f92672">&amp;</span> strcmp(type,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">surface&#39;</span>)));
    set(fig,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">add&#39;</span>); set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">add&#39;</span>); H1=[];
    <span style="color:#66d9ef">if</span> flag, map=get(fig,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">colormap&#39;</span>);                  <span style="color:#75715e">% update colors</span>
    M=(p1<span style="color:#f92672">-</span>p2); M=sqrt(sum(M<span style="color:#f92672">.*</span>M,<span style="color:#ae81ff">2</span>)); minM=min(M); maxM=max(M);
    H1=H(strcmp(tag,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">arrow3&#39;</span>) <span style="color:#f92672">&amp;</span> strcmp(type,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">line&#39;</span>));
    MagnitudeWarning=[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Cannot perform magnitude coloring on lines &#39;</span>,<span style="color:#75715e">...</span>
    <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">that\nwere drawn with a single color, linestyle, and linewidth&#39;</span>];
    <span style="color:#66d9ef">if</span> length(H1)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:length(H1)                             <span style="color:#75715e">% update line colors</span>
    x=get(H1(i),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">xdata&#39;</span>); y=get(H1(i),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ydata&#39;</span>); z=get(H1(i),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">zdata&#39;</span>);
    <span style="color:#66d9ef">if</span> length(x)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span>                               <span style="color:#75715e">% multiple lines</span>
    warning(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3:Magnitude&#39;</span>,MagnitudeWarning), <span style="color:#66d9ef">continue</span>
    <span style="color:#66d9ef">end</span>
    m=sqrt((x(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">-</span>x(<span style="color:#ae81ff">2</span>))^<span style="color:#ae81ff">2</span><span style="color:#f92672">+</span>(y(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">-</span>y(<span style="color:#ae81ff">2</span>))^<span style="color:#ae81ff">2</span><span style="color:#f92672">+</span>(z(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">-</span>z(<span style="color:#ae81ff">2</span>))^<span style="color:#ae81ff">2</span>);
    c=LocalInterp(minM,maxM,map,m); set(H1(i),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">color&#39;</span>,c);
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">elseif</span> length(H1)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
    warning(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3:Magnitude&#39;</span>,MagnitudeWarning)
    <span style="color:#66d9ef">end</span>
    c=LocalInterp(minM,maxM,map,M);
    <span style="color:#66d9ef">end</span>
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ColorOrder&#39;</span>,c);                            <span style="color:#75715e">% update surfaces</span>
    ColorOrder=[];
    <span style="color:#66d9ef">if</span> strcmp(get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tag&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Arrow3ConePlot&#39;</span>)
    H=arrow3(p1,p2,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">o&#39;</span> ,w,h,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">cone&#39;</span>,a);            <span style="color:#75715e">% update cones</span>
    <span style="color:#66d9ef">else</span> H=arrow3(p1,p2,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">o0&#39;</span>,w,h,    ip,a);
    <span style="color:#66d9ef">end</span>, H=[H1(:);H(:)];
    set(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nextplot&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">replace&#39;</span>);

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% SetSurface</span>
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">LocalSetSurface</span>(xys,xs,ys,dx,dy,xr,yr,x,y,z,a,c,H,n,m)
    <span style="color:#66d9ef">if</span> xys
    x=x<span style="color:#f92672">*</span>dx<span style="color:#f92672">+</span>xr(<span style="color:#ae81ff">1</span>); y=y<span style="color:#f92672">*</span>dy<span style="color:#f92672">+</span>yr(<span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">if</span> xs, x=<span style="color:#ae81ff">10.</span>^x; <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> ys, y=<span style="color:#ae81ff">10.</span>^y; <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    cd=zeros(n,m,<span style="color:#ae81ff">3</span>); cd(:,:,<span style="color:#ae81ff">1</span>)=c(<span style="color:#ae81ff">1</span>); cd(:,:,<span style="color:#ae81ff">2</span>)=c(<span style="color:#ae81ff">2</span>); cd(:,:,<span style="color:#ae81ff">3</span>)=c(<span style="color:#ae81ff">3</span>);
    set(H,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">XData&#39;</span>,x,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">YData&#39;</span>,y,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ZData&#39;</span>,z,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">CData&#39;</span>,cd,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">FaceAlpha&#39;</span>,a);

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% ColorTable</span>
<span style="color:#66d9ef">function</span> [vc,cn]=<span style="color:#a6e22e">LocalColorTable</span>(n,beta)
    vc=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">kymcrgbadefhijlnpqstuvzw&#39;</span>;                     <span style="color:#75715e">% valid color codes</span>
    <span style="color:#75715e">%                k               y               m               c</span>
    cn=[<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.00</span>; <span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">0.00</span>; <span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">1.00</span>; <span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">1.00</span>;
    <span style="color:#75715e">%                r               g               b               a</span>
    <span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.00</span>; <span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">0.00</span>; <span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">1.00</span>; <span style="color:#ae81ff">0.42</span>,<span style="color:#ae81ff">0.59</span>,<span style="color:#ae81ff">0.24</span>;
    <span style="color:#75715e">%                d               e               f               h</span>
    <span style="color:#ae81ff">0.25</span>,<span style="color:#ae81ff">0.25</span>,<span style="color:#ae81ff">0.25</span>; <span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.50</span>,<span style="color:#ae81ff">0.00</span>; <span style="color:#ae81ff">0.70</span>,<span style="color:#ae81ff">0.13</span>,<span style="color:#ae81ff">0.13</span>; <span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">0.41</span>,<span style="color:#ae81ff">0.71</span>;
    <span style="color:#75715e">%                i               j               l               n</span>
    <span style="color:#ae81ff">0.29</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.51</span>; <span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.66</span>,<span style="color:#ae81ff">0.42</span>; <span style="color:#ae81ff">0.50</span>,<span style="color:#ae81ff">0.50</span>,<span style="color:#ae81ff">0.50</span>; <span style="color:#ae81ff">0.50</span>,<span style="color:#ae81ff">0.20</span>,<span style="color:#ae81ff">0.00</span>;
    <span style="color:#75715e">%                p               q               s               t</span>
    <span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.00</span>; <span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">0.50</span>,<span style="color:#ae81ff">0.00</span>; <span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.75</span>; <span style="color:#ae81ff">0.80</span>,<span style="color:#ae81ff">0.34</span>,<span style="color:#ae81ff">0.00</span>;
    <span style="color:#75715e">%                u               v               z               w</span>
    <span style="color:#ae81ff">0.50</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.13</span>; <span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.75</span>; <span style="color:#ae81ff">0.38</span>,<span style="color:#ae81ff">0.74</span>,<span style="color:#ae81ff">0.99</span>; <span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">1.00</span>,<span style="color:#ae81ff">1.00</span>];

<span style="color:#75715e">% Named Simulink Colors (zaql)</span>
    <span style="color:#75715e">% LightBlue = 0.38  0.74  0.99 = aZure</span>
    <span style="color:#75715e">% DarkGreen = 0.42  0.59  0.24 = Asparagus</span>
    <span style="color:#75715e">% Orange    = 1.00  0.50  0.00 = kumQuat</span>
    <span style="color:#75715e">% Gray      = 0.50  0.50  0.50 = Light gray</span>
    <span style="color:#75715e">%</span>
<span style="color:#75715e">% Default ColorOrder Property Colors (bersvpd)</span>
    <span style="color:#75715e">% Color1    = 0.00  0.00  1.00 = Blue</span>
    <span style="color:#75715e">% Color2    = 0.00  0.50  0.00 = Evergreen</span>
    <span style="color:#75715e">% Color3    = 1.00  0.00  0.00 = Red</span>
    <span style="color:#75715e">% Color4    = 0.00  0.75  0.75 = Sky blue</span>
    <span style="color:#75715e">% Color5    = 0.75  0.00  0.75 = Violet</span>
    <span style="color:#75715e">% Color6    = 0.75  0.75  0.00 = Pear</span>
    <span style="color:#75715e">% Color7    = 0.25  0.25  0.25 = Dark gray</span>

    <span style="color:#66d9ef">if</span> n, clf reset                                    <span style="color:#75715e">% plot color table</span>
    name={<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">blacK&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Yellow&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Magenta&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Cyan&#39;</span>,<span style="color:#75715e">...</span>
        <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Red&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Green&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Blue&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Asparagus&#39;</span>,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Dark gray&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Evergreen&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Firebrick&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Hot pink&#39;</span>,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Indigo&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Jade&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Light gray&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Nutbrown&#39;</span>,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Pear&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">kumQuat&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Sky blue&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Tawny&#39;</span>,<span style="color:#75715e">...</span>
            <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bUrgundy&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Violet&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">aZure&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">White&#39;</span>};
c=[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">yptn&#39;</span>;<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">gjae&#39;</span>;<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">czsb&#39;</span>;<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">hmvi&#39;</span>;<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">qrfu&#39;</span>;<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">wldk&#39;</span>];
set(gcf,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultAxesXTick&#39;</span>,[],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultAxesYTick&#39;</span>,[],<span style="color:#75715e">...</span>
        <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultAxesXTickLabel&#39;</span>,[],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultAxesYTickLabel&#39;</span>,[],<span style="color:#75715e">...</span>
        <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultAxesXLim&#39;</span>,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.75</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultAxesYLim&#39;</span>,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.75</span>],<span style="color:#75715e">...</span>
        <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DefaultRectangleEdgeColor&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">none&#39;</span>);
<span style="color:#66d9ef">for</span> i=<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">24</span>, subplot(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">6</span>,i); box on
j=find(vc<span style="color:#f92672">==</span>c(i)); title(name{j});
dark=LocalBrighten(cn(j,:),<span style="color:#f92672">-</span>beta);
light=LocalBrighten(cn(j,:),beta);
rectangle(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Position&#39;</span>,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.25</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">FaceColor&#39;</span>,dark);
rectangle(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Position&#39;</span>,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.25</span>,<span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.25</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">FaceColor&#39;</span>,cn(j,:));
rectangle(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Position&#39;</span>,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.50</span>,<span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.25</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">FaceColor&#39;</span>,light);
rectangle(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Position&#39;</span>,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.00</span>,<span style="color:#ae81ff">0.75</span>,<span style="color:#ae81ff">0.75</span>],<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">EdgeColor&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">k&#39;</span>);
<span style="color:#66d9ef">if</span> rem(i,<span style="color:#ae81ff">6</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
set(gca,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">YTickLabel&#39;</span>,{<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dark&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">normal&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">light&#39;</span>},<span style="color:#75715e">...</span>
        <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">YTick&#39;</span>,[<span style="color:#ae81ff">0.125</span>,<span style="color:#ae81ff">0.375</span>,<span style="color:#ae81ff">0.625</span>]);
<span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span><span style="color:#ae81ff">19</span>
text(<span style="color:#ae81ff">0</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">0.25</span>,[<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{\bf\itARROW3}  Named Color Table  &#39;</span>,<span style="color:#75715e">...</span>
        <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">( \beta = &#39;</span>,num2str(beta),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> )&#39;</span>]);
<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% ColorMap</span>
<span style="color:#66d9ef">function</span> [C,failed]=<span style="color:#a6e22e">LocalColorMap</span>(c,vc,cn,beta)
    n=length(c); failed=<span style="color:#ae81ff">0</span>; C=zeros(n,<span style="color:#ae81ff">3</span>); i=<span style="color:#ae81ff">1</span>; j=<span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>sum([vc,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_^&#39;</span>]<span style="color:#f92672">==</span>c(i)), failed=<span style="color:#ae81ff">1</span>; <span style="color:#66d9ef">break</span>, <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> sum(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_^&#39;</span><span style="color:#f92672">==</span>c(i))
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;</span>n, failed=<span style="color:#ae81ff">1</span>; <span style="color:#66d9ef">break</span>, <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>sum(vc<span style="color:#f92672">==</span>c(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)), failed=<span style="color:#ae81ff">1</span>; <span style="color:#66d9ef">break</span>, <span style="color:#66d9ef">end</span>
    cc=cn(vc<span style="color:#f92672">==</span>c(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>),:); gamma=beta;
    <span style="color:#66d9ef">if</span> c(i)<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_&#39;</span>, gamma=<span style="color:#f92672">-</span>beta; <span style="color:#66d9ef">end</span>
    C(j,:)=LocalBrighten(cc,gamma); i=i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>;
    <span style="color:#66d9ef">else</span> C(j,:)=cn(vc<span style="color:#f92672">==</span>c(i),:); i=i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">&gt;</span>n, <span style="color:#66d9ef">break</span>, <span style="color:#66d9ef">end</span>, j=j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> n<span style="color:#f92672">&gt;</span>j, C(j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:n,:)=[]; <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Brighten</span>
<span style="color:#66d9ef">function</span> C=<span style="color:#a6e22e">LocalBrighten</span>(c,beta)
    <span style="color:#66d9ef">if</span> sum([c<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>,c<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> sum(c<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> sum(c<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">3</span>
    <span style="color:#66d9ef">if</span> beta<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>
    C=(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>beta)<span style="color:#f92672">*</span>c;
    <span style="color:#66d9ef">else</span>
    C=c;  C(C<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>)=beta;
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">else</span>
    C=c<span style="color:#f92672">.^</span>((<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>min(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>sqrt(eps),abs(beta)))^sign(beta));
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Repmat</span>
<span style="color:#66d9ef">function</span> B=<span style="color:#a6e22e">LocalRepmat</span>(A,siz)
    <span style="color:#66d9ef">if</span> length(A)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>, B(prod(siz))=A; B(:)=A; B=reshape(B,siz);
    <span style="color:#66d9ef">else</span> [m,n]=size(A); mind=(<span style="color:#ae81ff">1</span>:m)<span style="color:#f92672">&#39;</span>; nind=(<span style="color:#ae81ff">1</span>:n)<span style="color:#f92672">&#39;</span>;
    mind=mind(:,ones(<span style="color:#ae81ff">1</span>,siz(<span style="color:#ae81ff">1</span>))); nind=nind(:,ones(<span style="color:#ae81ff">1</span>,siz(<span style="color:#ae81ff">2</span>)));
    B=A(mind,nind);
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Interp</span>
<span style="color:#66d9ef">function</span> v=<span style="color:#a6e22e">LocalInterp</span>(xmin,xmax,y,u)
    [m,n]=size(y); h=(xmax<span style="color:#f92672">-</span>xmin)<span style="color:#f92672">/</span>(m<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>); p=length(u); v=zeros(p,n);
    k=min(max(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>floor((u<span style="color:#f92672">-</span>xmin)<span style="color:#f92672">/</span>h),<span style="color:#ae81ff">1</span>),m<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>); s=(u<span style="color:#f92672">-</span>xmin)<span style="color:#f92672">/</span>h<span style="color:#f92672">-</span>k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">for</span> j=<span style="color:#ae81ff">1</span>:n, v(:,j)=y(k,j)<span style="color:#f92672">+</span>s<span style="color:#f92672">.*</span>(y(k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,j)<span style="color:#f92672">-</span>y(k,j)); <span style="color:#66d9ef">end</span>
    v(v<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>)=<span style="color:#ae81ff">0</span>; v(v<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>)=<span style="color:#ae81ff">1</span>;

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Check for supported log scales</span>
<span style="color:#66d9ef">function</span> [xs,ys,xys]=<span style="color:#a6e22e">LocalLogCheck</span>(ax)
    xs=strcmp(get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">xscale&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">log&#39;</span>);
    ys=strcmp(get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">yscale&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">log&#39;</span>);
    zs=strcmp(get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">zscale&#39;</span>),<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">log&#39;</span>);
    <span style="color:#66d9ef">if</span> zs, error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Z log scale not supported&#39;</span>), <span style="color:#66d9ef">end</span>
    xys=xs<span style="color:#f92672">+</span>ys;
    <span style="color:#66d9ef">if</span> xys, azel=get(ax,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">view&#39;</span>);
    <span style="color:#66d9ef">if</span> abs(azel(<span style="color:#ae81ff">2</span>))<span style="color:#f92672">~=</span><span style="color:#ae81ff">90</span>, error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">3D log plot not supported&#39;</span>), <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%-------------------------------------------------------------------------</span>
    <span style="color:#75715e">% Generate valid value for color, linestyle and linewidth</span>
<span style="color:#66d9ef">function</span> [c,ls,lw]=<span style="color:#a6e22e">LocalValidateCLSW</span>(s)
    <span style="color:#66d9ef">if</span> nargin<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">1</span>, c=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">k&#39;</span>; ls=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-&#39;</span>; lw=<span style="color:#ae81ff">0.5</span>;
    <span style="color:#66d9ef">else</span>
    <span style="color:#75715e">% identify linestyle</span>
    <span style="color:#66d9ef">if</span> findstr(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">--&#39;</span>), ls=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">--&#39;</span>; s=strrep(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">--&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>);
    <span style="color:#66d9ef">elseif</span> findstr(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-.&#39;</span>), ls=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-.&#39;</span>; s=strrep(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-.&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>);
    <span style="color:#66d9ef">elseif</span> findstr(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-&#39;</span>), ls=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-&#39;</span>; s=strrep(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>);
    <span style="color:#66d9ef">elseif</span> findstr(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">:&#39;</span>), ls=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">:&#39;</span>; s=strrep(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">:&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>);
    <span style="color:#66d9ef">elseif</span> findstr(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">*&#39;</span>), ls=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">*&#39;</span>; s=strrep(s,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">*&#39;</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>);
    <span style="color:#66d9ef">else</span> ls=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-&#39;</span>;
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">% identify linewidth</span>
    tmp=double(s);
    tmp=find(tmp<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">45</span> <span style="color:#f92672">&amp;</span> tmp<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">58</span>);
<span style="color:#66d9ef">if</span> length(tmp)
    <span style="color:#66d9ef">if</span> any(s(tmp)<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/&#39;</span>), lw=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/&#39;</span>; <span style="color:#66d9ef">else</span> lw=str2double(s(tmp)); <span style="color:#66d9ef">end</span>
    s(tmp)=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>;
    <span style="color:#66d9ef">else</span> lw=<span style="color:#ae81ff">0.5</span>;
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">% identify color</span>
    <span style="color:#66d9ef">if</span> length(s), s=lower(s);
    <span style="color:#66d9ef">if</span> length(s)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>, c=s(<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">2</span>);
    <span style="color:#66d9ef">else</span> c=s(<span style="color:#ae81ff">1</span>); <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">else</span> c=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">k&#39;</span>;
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>

</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-matlab" data-lang="matlab"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">errorbare</span>(sty,x,y,xbar,ybar,symbol)

    <span style="color:#75715e">% ERRORBARE Enhanced Errorbar Function.</span>
<span style="color:#75715e">%   ERRORBARE(STY,X,Y,Xbar,Ybar,symbol) </span>
    <span style="color:#75715e">%   It can draw errorbar along X/Y/Dual axis </span>
    <span style="color:#75715e">%   in normal,semilog,loglog coordinate system,</span>
    <span style="color:#75715e">%   and adjust length of top line automatically,</span>
    <span style="color:#75715e">%   can also control dotstyle and color in the same way with errorbar.</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   If the lower and upper error range of x/y is different, they should be</span>
    <span style="color:#75715e">%   input as [lower,upper] if x/y is a column vector; </span>
    <span style="color:#75715e">%   for a row vector, they should be [lower;uper].</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   parameter STY include 12 types: </span>
    <span style="color:#75715e">%   v,h,d,vlogx,hlogx,dlogx,vlogy,hlogy,</span>
    <span style="color:#75715e">%       dlogy,vlogd,hlogd,dlogd </span>
    <span style="color:#75715e">%   where</span>
    <span style="color:#75715e">%   v stands for vertical errorbar，</span>
    <span style="color:#75715e">%   h draws horizontal errorbar，</span>
    <span style="color:#75715e">%   d means dual direction,</span>
    <span style="color:#75715e">%   logx corresponding to semilogx，can use preffix v/h/d</span>
    <span style="color:#75715e">%   logy corresponding to semilogy，can use preffix v/h/d</span>
    <span style="color:#75715e">%   logd corresponding to loglog，can use preffix v/h/d</span>

    <span style="color:#75715e">%   误差棒函数增强版</span>
<span style="color:#75715e">%   ERRORBARE(STY,X,Y,Xbar,Ybar,symbol) </span>
    <span style="color:#75715e">%   可在各个坐标系中沿X轴，Y轴方向，或者两轴方向绘制误差棒，</span>
    <span style="color:#75715e">%   能够根据所选坐标类型调整端点线长。</span>
    <span style="color:#75715e">%   增加对误差棒的线型控制，用法与原errorbar函数中相同</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   若上下限范围不同，X为列向量时应按照</span>
    <span style="color:#75715e">%   [下限,上限] 的格式输入，若为行向量则为 [下限;上限]</span>
    <span style="color:#75715e">%</span>
    <span style="color:#75715e">%   STY 参数包括 v,h,d,vlogx,hlogx,dlogx,vlogy,hlogy,</span>
    <span style="color:#75715e">%	dlogy,vlogd,hlogd,dlogd 共12种</span>
    <span style="color:#75715e">%   v 表示误差棒垂直，</span>
    <span style="color:#75715e">%   h 表示误差棒水平，</span>
    <span style="color:#75715e">%   d (dual) 显示双轴误差，</span>
    <span style="color:#75715e">%   logx 对应 semilogx，前缀 v,h,d 意义同上</span>
    <span style="color:#75715e">%   logy 对应 semilogy，前缀 v,h,d 意义同上</span>
    <span style="color:#75715e">%   logd 对应 loglog，前缀 v,h,d 意义同上</span>

    <span style="color:#75715e">%   For example,</span>
    <span style="color:#75715e">%	x = 1:10;</span>
<span style="color:#75715e">%	y = sin(x)+2;</span>
<span style="color:#75715e">%	e = std(y)*ones(size(x));</span>
<span style="color:#75715e">%	errorbare(x,y,e)	% use function &#34;errorbar&#34; directly</span>
<span style="color:#75715e">%	errorbare(x,y,e,&#39;or&#39;)</span>
<span style="color:#75715e">%	errorbare(&#39;v&#39;,x,y,e)	% &#34;e&#34; is error of &#34;y&#34;</span>
<span style="color:#75715e">%	errorbare(&#39;v&#39;,x,y,[e;2*e])  % try different error limits</span>
<span style="color:#75715e">%	errorbare(&#39;hlogx&#39;,x,y,e)    % &#34;e&#34; is error of &#34;x&#34; here，</span>
<span style="color:#75715e">%	errorbare(&#39;d&#39;,x,y,e,e)</span>
<span style="color:#75715e">%	errorbare(&#39;d&#39;,x,y,e,e,&#39;or&#39;)</span>
<span style="color:#75715e">%	errorbare(&#39;dlogd&#39;,x,y,e,e)</span>
<span style="color:#75715e">%</span>
<span style="color:#75715e">%   by Henry Sting  Email: henrysting@hotmail.com</span>
<span style="color:#75715e">%   $Revision: 1.2 $  $Date: 2010-2-8 $</span>

lx=[];ux=[];ly=[];uy=[]; <span style="color:#75715e">% 误差棒上下限</span>
xl=[];xr=[];yl=[];yr=[]; <span style="color:#75715e">% 端点短线左右限</span>

<span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>isstr(sty)
    <span style="color:#66d9ef">if</span> nargin <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
errorbar(sty,x,y)
    <span style="color:#66d9ef">return</span>
    <span style="color:#66d9ef">elseif</span> nargin <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>
errorbar(sty,x,y,xbar)
    <span style="color:#66d9ef">return</span>
    <span style="color:#66d9ef">elseif</span> nargin <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">4</span>
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Please assign adopted coordinate system with symbol parameters.&#39;</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">elseif</span> isstr(sty)
<span style="color:#66d9ef">if</span> size(x)<span style="color:#f92672">~=</span>size(y)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Coordinate array should be equal.&#39;</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> nargin <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>
    symbol=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ob&#39;</span>;
<span style="color:#66d9ef">if</span> length(x)<span style="color:#f92672">~=</span>length(xbar)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Format of Xbar is illegal.&#39;</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">v&#39;</span>
    ybar=xbar;xbar=[];
    <span style="color:#66d9ef">elseif</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">h&#39;</span>
    ybar=[];
    <span style="color:#66d9ef">elseif</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">d&#39;</span>
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Parameters are not enough.&#39;</span>)
    <span style="color:#66d9ef">else</span>
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Symbol parameter is illegal.&#39;</span>)
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">elseif</span> nargin <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span>isstr(ybar)
    symbol=<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ob&#39;</span>;
<span style="color:#66d9ef">if</span> length(x)<span style="color:#f92672">~=</span>length(xbar)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Format of Xbar is illegal.&#39;</span>)
<span style="color:#66d9ef">elseif</span> length(y)<span style="color:#f92672">~=</span>length(ybar)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Format of Ybar is illegal.&#39;</span>)
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">elseif</span> nargin <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">&amp;</span> isstr(ybar)
    symbol=ybar;ybar=[];
<span style="color:#66d9ef">if</span> length(x)<span style="color:#f92672">~=</span>length(xbar)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Format of Xbar is illegal.&#39;</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">v&#39;</span>
    ybar=xbar;xbar=[];
    <span style="color:#66d9ef">elseif</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">h&#39;</span>
    ybar=[];
    <span style="color:#66d9ef">elseif</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">d&#39;</span>
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Parameters are not enough.&#39;</span>)
    <span style="color:#66d9ef">else</span>
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Symbol parameter is illegal.&#39;</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">elseif</span> nargin <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>
<span style="color:#66d9ef">if</span> length(x)<span style="color:#f92672">~=</span>length(xbar)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Format of Xbar is illegal.&#39;</span>)
<span style="color:#66d9ef">elseif</span> length(y)<span style="color:#f92672">~=</span>length(ybar)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Format of Ybar is illegal.&#39;</span>)
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>isstr(symbol)
    error(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Symbol should be string&#39;</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>


    [ls,col,mark,msg] = colstyle(symbol); <span style="color:#66d9ef">if</span> <span style="color:#f92672">~</span>isempty(msg), error(msg); <span style="color:#66d9ef">end</span>
    symbol = [ls mark col]; <span style="color:#75715e">% Use marker only on data part</span>
    esymbol = [<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-&#39;</span> col]; <span style="color:#75715e">% Make sure bars are solid</span>


    <span style="color:#75715e">% 转换为列距阵</span>
    [a,b]=size(x);
    <span style="color:#66d9ef">if</span> a <span style="color:#f92672">&lt;</span> b
    x=x<span style="color:#f92672">&#39;</span>;y=y<span style="color:#f92672">&#39;</span>;xbar=xbar<span style="color:#f92672">&#39;</span>;ybar=ybar<span style="color:#f92672">&#39;</span>;
    c=a;a=b;b=c;
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%% 处理上下限不等</span>
    [xa,xb]=size(xbar);
    <span style="color:#66d9ef">if</span> xb<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
    ux=xbar;lx=xbar; 
    <span style="color:#66d9ef">elseif</span> xb<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>
    lx=xbar(:,<span style="color:#ae81ff">1</span>);ux=xbar(:,<span style="color:#ae81ff">2</span>);
    <span style="color:#66d9ef">end</span>

    [ya,yb]=size(ybar);
    <span style="color:#66d9ef">if</span> yb<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
    uy=ybar;ly=ybar; 
    <span style="color:#66d9ef">elseif</span> yb<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>
    ly=ybar(:,<span style="color:#ae81ff">1</span>);uy=ybar(:,<span style="color:#ae81ff">2</span>);
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%% 描点</span>
    dx=(max(x(:))<span style="color:#f92672">-</span>min(x(:)))<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>;
    dy=(max(y(:))<span style="color:#f92672">-</span>min(y(:)))<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>;
    logn=<span style="color:#ae81ff">10</span>;
    <span style="color:#66d9ef">if</span> length(sty) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
    xl = x<span style="color:#f92672">-</span>dx; xr = x<span style="color:#f92672">+</span>dx; yl = y<span style="color:#f92672">-</span>dy; yr = y<span style="color:#f92672">+</span>dy; <span style="color:#75715e">% 定义端点短线长度</span>
    plot(x,y,symbol);hold on
    <span style="color:#66d9ef">elseif</span> length(sty) <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">&amp;</span> sty(<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">5</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">logx&#39;</span> 
    dx=(log(max(x(:)))<span style="color:#f92672">-</span>log(min(x(:))))<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>;
    xl = x<span style="color:#f92672">/</span>logn^dx;xr = x<span style="color:#f92672">*</span>logn^dx;yl = y<span style="color:#f92672">-</span>dy; yr = y<span style="color:#f92672">+</span>dy; 
    semilogx(x,y,symbol);hold on
    <span style="color:#66d9ef">elseif</span> length(sty) <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">&amp;</span> sty(<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">5</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">logy&#39;</span> 
    dy=(log(max(y(:)))<span style="color:#f92672">-</span>log(min(y(:))))<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>;
    yl = y<span style="color:#f92672">/</span>logn^dy;yr = y<span style="color:#f92672">*</span>logn^dy;xl = x<span style="color:#f92672">-</span>dx; xr = x<span style="color:#f92672">+</span>dx; 
    semilogy(x,y,symbol);hold on
    <span style="color:#66d9ef">elseif</span> length(sty) <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">&amp;</span> sty(<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">5</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">logd&#39;</span> 
    dx=(log(max(x(:)))<span style="color:#f92672">-</span>log(min(x(:))))<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>;
    dy=(log(max(y(:)))<span style="color:#f92672">-</span>log(min(y(:))))<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>;
    xl = x<span style="color:#f92672">/</span>logn^dx;xr = x<span style="color:#f92672">*</span>logn^dx; yl = y<span style="color:#f92672">/</span>logn^dy;yr = y<span style="color:#f92672">*</span>logn^dy;
    loglog(x,y,symbol);hold on
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">%% 纵向</span>
    <span style="color:#66d9ef">if</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">v&#39;</span> <span style="color:#f92672">|</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">d&#39;</span>
    vx = zeros(a<span style="color:#f92672">*</span><span style="color:#ae81ff">9</span>,b);
    vx(<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x;
    vx(<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x;
    vx(<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    vx(<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = xl;
    vx(<span style="color:#ae81ff">5</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = xr;
    vx(<span style="color:#ae81ff">6</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    vx(<span style="color:#ae81ff">7</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = xl;
    vx(<span style="color:#ae81ff">8</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = xr;
    vx(<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;

    vy = zeros(a<span style="color:#f92672">*</span><span style="color:#ae81ff">9</span>,b);
    vy(<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y<span style="color:#f92672">-</span>ly;
    vy(<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y<span style="color:#f92672">+</span>uy;
    vy(<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    vy(<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y<span style="color:#f92672">-</span>ly;
    vy(<span style="color:#ae81ff">5</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y<span style="color:#f92672">-</span>ly;
    vy(<span style="color:#ae81ff">6</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    vy(<span style="color:#ae81ff">7</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y<span style="color:#f92672">+</span>uy;
    vy(<span style="color:#ae81ff">8</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y<span style="color:#f92672">+</span>uy;
    vy(<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;

    plot(vx,vy,esymbol,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">markersize&#39;</span>,<span style="color:#ae81ff">20</span>)
    <span style="color:#66d9ef">end</span>
    <span style="color:#75715e">%% 横向</span>
    <span style="color:#66d9ef">if</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">h&#39;</span> <span style="color:#f92672">|</span> sty(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">d&#39;</span>
    hx = zeros(a<span style="color:#f92672">*</span><span style="color:#ae81ff">9</span>,b);
    hx(<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x<span style="color:#f92672">-</span>lx;
    hx(<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x<span style="color:#f92672">+</span>ux;
    hx(<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    hx(<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x<span style="color:#f92672">-</span>lx;
    hx(<span style="color:#ae81ff">5</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x<span style="color:#f92672">-</span>lx;
    hx(<span style="color:#ae81ff">6</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    hx(<span style="color:#ae81ff">7</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x<span style="color:#f92672">+</span>ux;
    hx(<span style="color:#ae81ff">8</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = x<span style="color:#f92672">+</span>ux;
    hx(<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;

    hy = zeros(a<span style="color:#f92672">*</span><span style="color:#ae81ff">9</span>,b);
    hy(<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y;
    hy(<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = y;
    hy(<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    hy(<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = yl;
    hy(<span style="color:#ae81ff">5</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = yr;
    hy(<span style="color:#ae81ff">6</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;
    hy(<span style="color:#ae81ff">7</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = yl;
    hy(<span style="color:#ae81ff">8</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = yr;
    hy(<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">9</span>:<span style="color:#66d9ef">end</span>,:) = NaN;

    plot(hx,hy,esymbol,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">markersize&#39;</span>,<span style="color:#ae81ff">20</span>)
    <span style="color:#66d9ef">end</span>
</code></pre></div><!-- raw HTML omitted -->
<p>配置文件
Initial.db</p>
<pre><code>    0%%%%%%Configure
    0.01    
    0.99
    0.01
    0.99
    0%%%%%%getLine
    100
    15
    0
    30
    90
    50
    0%%%%%HSV
    0
    25
    170
    255
    30
    170
    30
    170
    0%%%%pile process cut
    100    %[100~200]
    0.8    %[0~1]
    0.73    %[0~1] 
    0.47   %[0~0.5]
</code></pre><p><img src="/images/matlab/config.png" alt="config">
读取部分的核心部分，最终返回一个x_coordinate.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-matlab" data-lang="matlab"><span style="color:#66d9ef">function</span> [x_coordinate] = <span style="color:#a6e22e">readConfTest</span>(filename)
    RowNumber=getRowFromFile(filename); 
    f = fopen(filename) ; 
    tline = cell(<span style="color:#ae81ff">1</span>, RowNumber) ; 
    <span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : RowNumber 
    tline{i} = fgetl(f);
    y = sscanf( tline{i} , <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%f&#39;</span>) ;
    x_coordinate(i)=y;
    <span style="color:#66d9ef">end</span>

    <span style="color:#66d9ef">end</span>


<span style="color:#66d9ef">function</span> row=<span style="color:#a6e22e">getRowFromFile</span>(filename)
    fid=fopen(filename,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">rt&#39;</span>); <span style="color:#75715e">% t是告诉fread是这里文本文件</span>
    row=<span style="color:#ae81ff">1</span>;
<span style="color:#66d9ef">while</span> <span style="color:#f92672">~</span>feof(fid)
    <span style="color:#75715e">% 一次性读取10000字符，计算其中的回车个数，其中10是回车的ASCII编码</span>
    <span style="color:#75715e">% &#39;*char&#39;表示每次读取一个字符，*表示输出也是字符</span>
    <span style="color:#75715e">% 放心fread现在已经可以自动识别中文了，万一还是识别不了，</span>
    <span style="color:#75715e">% 请在fopen中指定文件编码格式，比如gbk</span>
    row=row<span style="color:#f92672">+</span>sum(fread(fid,<span style="color:#ae81ff">10000</span>,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">*char&#39;</span>)<span style="color:#f92672">==</span>char(<span style="color:#ae81ff">10</span>));
    <span style="color:#75715e">% 下面还有一个类似的方法，但是效率低很多，大概是上面的一半</span>
    <span style="color:#75715e">% &#39;char&#39;表示每次读取一个字符，但是默认输出double，</span>
    <span style="color:#75715e">% 也就是说读取char然后转换double中间有转换能快吗？</span>
    <span style="color:#75715e">% row=row+sum(fread(fid,10000,&#39;char&#39;)==10);</span>
    <span style="color:#66d9ef">end</span>
    fclose(fid);
    <span style="color:#75715e">%row=row+1;</span>
    <span style="color:#66d9ef">end</span>

</code></pre></div><!-- raw HTML omitted -->
<p>a. 调用cell数据的方式是{} 区分于array（使用[]创建array）的()调用数组数据。</p>
    </div>
 <div class="nav-links" style="padding:10;">
        
        <div align="left">
        <a href="https://jueqingsizhe66.github.io/blog/2016/07/19/prologxiao-jie/"><span class="arrow">←</span> <strong>上一篇:prolog小结</strong></a>
        </div>
        
        


       <div align="right"> <a href="https://jueqingsizhe66.github.io/blog/2016/07/19/javaxiao-jie/" ><strong>下一篇:java小结 </strong><span class="arrow">→</span></a></div>
        
      </div>
    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/matlab/">matlab</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/&amp;text=matlab%e5%b0%8f%e7%bb%93" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/&amp;t=matlab%e5%b0%8f%e7%bb%93" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=matlab%e5%b0%8f%e7%bb%93&amp;body=https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/&amp;title=matlab%e5%b0%8f%e7%bb%93" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=matlab%e5%b0%8f%e7%bb%93%20https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://jueqingsizhe66.github.io/blog/2016/07/19/matlabxiao-jie/&amp;title=matlab%e5%b0%8f%e7%bb%93" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu52a603635ecebd45650b162dadabb4e5_12861_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jueqingsizhe66.github.io/">Ye Zhaoliang</a></h5>
      <h6 class="card-subtitle">Engineer of offshore wind turbine technique research</h6>
      <p class="card-text">My research interests include distributed energy, wind turbine power generation technique , Computational fluid dynamic and programmable matter.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=7VyEMyQAAAAJ&amp;hl=zh-CN" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jueqingsizhe66" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/blog/2015/06/10/ubuntuxi-tong-yun-yong/">ubuntu系统运用</a></li>
      
      <li><a href="/blog/2015/06/03/bashming-ling-fen-lei-jia-gou-zai-wen-jian-xi-tong-ji-bie/">bash命令分类--架构在文件系统级别</a></li>
      
      <li><a href="/blog/2015/05/20/haskell-someimportantresource/">Haskell-someImportantResource</a></li>
      
      <li><a href="/blog/2016/07/19/prologxiao-jie/">prolog小结</a></li>
      
      <li><a href="/blog/2016/04/15/neng-zhen-zheng-jiao-hui-ni-bian-cheng-neng-li-de-shi-zhong-xie/">能真正教会你编程能力的是重写</a></li>
      
    </ul>


         <span id="busuanzi_container_site_pv"> 
             本站访问量：<span id="busuanzi_value_site_pv"></span>次 
         </span> 
         &nbsp; 
   </div> 


  </div>

</article>
<script src="https://utteranc.es/client.js"
        repo="jueqingsizhe66/jueqingsizhe66.github.io"
        issue-term="pathname"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/go.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/vim.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/matlab.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/sql.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/c.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/scheme.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/racket.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/perl.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/awk.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/clojure.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.d6bd04fdad2ad213aa8111c5a3b72fc5.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    ©2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
